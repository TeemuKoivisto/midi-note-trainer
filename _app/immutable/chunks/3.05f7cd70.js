import{_ as Ce}from"./preload-helper.a4192956.js";import{S as $e,i as qe,s as We,e as b,n as j,a as k,b as C,p as B,d as _,f as m,Z as Te,N as J,g as R,h as u,_ as et,q as W,t as F,F as Fe,l as q,y as xe,$ as Ye,Q as Ae,R as Se,c as Ls,a0 as de,u as Ds,j as Ps,k as Vs,V as ls,W as Et,X as ns,a1 as rs,a2 as Ve,x as Pe,H as Os,B as Z,C as ee,D as me,r as _e,O as Ue,J as ge,K as ve,L as be,M as ke,m as Ie,T as At,w as Ge,a3 as Nn,o as oe,P as pe,a4 as ds,v as pn,a5 as Ln,a6 as as,a7 as Dn,a8 as Pn,I as Vn}from"./vendor_svelte.bbd2585b.js";import{w as Xt,c as On,e as jn,f as Js,g as Qs,h as Ft,i as os,j as is,k as Bt,l as Gt,m as Bn,a as Ys,n as Cs}from"./vendor.e9b0235c.js";import{a as Gn}from"./modal.da8071a0.js";function Xs(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l[24]=e[t].icon,l[26]=t,l}const Mn=s=>({}),Zs=s=>({});function el(s){let e,t,l,n,a,r,o,i,c,d,f;const g=s[17].header,p=Ls(g,s,s[16],Zs);let h=de(s[0]),v=[];for(let y=0;y<h.length;y+=1)v[y]=sl(Xs(s,h,y));const N=y=>q(v[y],1,1,()=>{v[y]=null});return{c(){e=b("button"),l=j(),n=b("ul"),a=b("li"),p&&p.c(),r=j();for(let y=0;y<v.length;y+=1)v[y].c();this.h()},l(y){e=k(y,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(_),l=B(y),n=k(y,"UL",{class:!0});var w=C(n);a=k(w,"LI",{});var D=C(a);p&&p.l(D),D.forEach(_),r=B(w);for(let V=0;V<v.length;V+=1)v[V].l(w);w.forEach(_),this.h()},h(){m(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),m(e,"tabindex","-1"),m(n,"class",o=Te(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(y,w){R(y,e,w),R(y,l,w),R(y,n,w),u(n,a),p&&p.m(a,null),u(n,r);for(let D=0;D<v.length;D+=1)v[D]&&v[D].m(n,null);c=!0,d||(f=W(e,"click",s[11]),d=!0)},p(y,w){if(s=y,p&&p.p&&(!c||w&65536)&&Ds(p,g,s,s[16],c?Vs(g,s[16],w,Mn):Ps(s[16]),Zs),w&8457){h=de(s[0]);let D;for(D=0;D<h.length;D+=1){const V=Xs(s,h,D);v[D]?(v[D].p(V,w),F(v[D],1)):(v[D]=sl(V),v[D].c(),F(v[D],1),v[D].m(n,null))}for(Fe(),D=h.length;D<v.length;D+=1)N(D);xe()}(!c||w&4&&o!==(o=Te(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&m(n,"class",o)},i(y){if(!c){y&&ls(()=>{c&&(t||(t=Et(e,ns,{duration:Zt},!0)),t.run(1))}),F(p,y);for(let w=0;w<h.length;w+=1)F(v[w]);y&&ls(()=>{c&&(i||(i=Et(n,rs,{duration:Zt},!0)),i.run(1))}),c=!0}},o(y){y&&(t||(t=Et(e,ns,{duration:Zt},!1)),t.run(0)),q(p,y),v=v.filter(Boolean);for(let w=0;w<v.length;w+=1)q(v[w]);y&&(i||(i=Et(n,rs,{duration:Zt},!1)),i.run(0)),c=!1},d(y){y&&(_(e),_(l),_(n)),y&&t&&t.end(),p&&p.d(y),Ve(v,y),y&&i&&i.end(),d=!1,f()}}}function tl(s){let e,t,l,n,a,r,o=s[23]+"",i,c,d,f,g;const p=[Rn,Un],h=[];function v(y,w){return y[24]?0:1}l=v(s),n=h[l]=p[l](s);function N(){return s[20](s[22])}return{c(){e=b("li"),t=b("button"),n.c(),a=j(),r=b("div"),i=Z(o),c=j(),this.h()},l(y){e=k(y,"LI",{});var w=C(e);t=k(w,"BUTTON",{class:!0});var D=C(t);n.l(D),a=B(D),r=k(D,"DIV",{});var V=C(r);i=ee(V,o),V.forEach(_),D.forEach(_),c=B(w),w.forEach(_),this.h()},h(){m(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),J(t,"selected",s[22]===s[3])},m(y,w){R(y,e,w),u(e,t),h[l].m(t,null),u(t,a),u(t,r),u(r,i),u(e,c),d=!0,f||(g=W(t,"click",N),f=!0)},p(y,w){s=y;let D=l;l=v(s),l===D?h[l].p(s,w):(Fe(),q(h[D],1,1,()=>{h[D]=null}),xe(),n=h[l],n?n.p(s,w):(n=h[l]=p[l](s),n.c()),F(n,1),n.m(t,a)),(!d||w&1)&&o!==(o=s[23]+"")&&me(i,o),(!d||w&9)&&J(t,"selected",s[22]===s[3])},i(y){d||(F(n),d=!0)},o(y){q(n),d=!1},d(y){y&&_(e),h[l].d(),f=!1,g()}}}function Un(s){let e;return{c(){e=b("div"),this.h()},l(t){e=k(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){m(e,"class","w-[24px]")},m(t,l){R(t,e,l)},p:_e,i:_e,o:_e,d(t){t&&_(e)}}}function Rn(s){let e,t;return e=new Ue({props:{class:"mr-2",icon:s[24],width:16}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const a={};n&1&&(a.icon=l[24]),e.$set(a)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){q(e.$$.fragment,l),t=!1},d(l){ke(e,l)}}}function sl(s){let e,t,l=!s[8][s[26]]&&tl(s);return{c(){l&&l.c(),e=Pe()},l(n){l&&l.l(n),e=Pe()},m(n,a){l&&l.m(n,a),R(n,e,a),t=!0},p(n,a){n[8][n[26]]?l&&(Fe(),q(l,1,1,()=>{l=null}),xe()):l?(l.p(n,a),a&256&&F(l,1)):(l=tl(n),l.c(),F(l,1),l.m(e.parentNode,e))},i(n){t||(F(l),t=!0)},o(n){q(l),t=!1},d(n){n&&_(e),l&&l.d(n)}}}function Kn(s){let e,t,l,n,a,r,o,i,c,d=s[6]&&el(s);return{c(){e=b("div"),t=b("input"),a=j(),d&&d.c(),this.h()},l(f){e=k(f,"DIV",{class:!0,id:!0});var g=C(e);t=k(g,"INPUT",{class:!0,title:!0}),a=B(g),d&&d.l(g),g.forEach(_),this.h()},h(){m(t,"class",l=Te(`${s[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"),m(t,"title",n=s[14].title||""),J(t,"disabled",s[4]),J(t,"open",s[6]),m(e,"class",r=Te(`relative ${s[2]||""}`)+" svelte-h65upg"),m(e,"id",s[1])},m(f,g){R(f,e,g),u(e,t),et(t,s[7]),u(e,a),d&&d.m(e,null),s[21](e),o=!0,i||(c=[W(t,"input",s[18]),W(t,"click",s[9]),W(t,"focus",s[19]),W(t,"input",s[10]),W(t,"keydown",s[12])],i=!0)},p(f,[g]){(!o||g&16384&&l!==(l=Te(`${f[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"))&&m(t,"class",l),(!o||g&16384&&n!==(n=f[14].title||""))&&m(t,"title",n),g&128&&t.value!==f[7]&&et(t,f[7]),(!o||g&16400)&&J(t,"disabled",f[4]),(!o||g&16448)&&J(t,"open",f[6]),f[6]?d?(d.p(f,g),g&64&&F(d,1)):(d=el(f),d.c(),F(d,1),d.m(e,null)):d&&(Fe(),q(d,1,1,()=>{d=null}),xe()),(!o||g&4&&r!==(r=Te(`relative ${f[2]||""}`)+" svelte-h65upg"))&&m(e,"class",r),(!o||g&2)&&m(e,"id",f[1])},i(f){o||(F(d),o=!0)},o(f){q(d),o=!1},d(f){f&&_(e),d&&d.d(),s[21](null),i=!1,Ye(c)}}}const Zt=400;function Fn(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:a,id:r=void 0,containerClass:o=void 0,selected:i,disabled:c=void 0,onSelect:d}=e,f,g=!1,p=i,h=a.map(A=>!1);function v(){c||t(6,g=!g)}function N(A){t(8,h=a.map(E=>!E.value.toLowerCase().includes(A.currentTarget.value.toLowerCase())))}function y(){t(7,p=i),t(6,g=!1),t(8,h=a.map(A=>!1))}function w(A){if(A.key==="Enter"){const E=h.findIndex(L=>!L);p===i?y():E>-1&&t(6,g=d(a[E].key)),g||(t(8,h=a.map(L=>!1)),A.currentTarget instanceof HTMLElement&&A.currentTarget.blur())}else A.key==="Escape"&&(y(),A.currentTarget instanceof HTMLElement&&A.currentTarget.blur())}function D(A){t(6,g=d(A))}function V(){p=this.value,t(7,p),t(3,i)}const K=()=>t(6,g=!0),S=A=>D(A);function I(A){Os[A?"unshift":"push"](()=>{f=A,t(5,f)})}return s.$$set=A=>{t(14,e=Ae(Ae({},e),Se(A))),"options"in A&&t(0,a=A.options),"id"in A&&t(1,r=A.id),"containerClass"in A&&t(2,o=A.containerClass),"selected"in A&&t(3,i=A.selected),"disabled"in A&&t(4,c=A.disabled),"onSelect"in A&&t(15,d=A.onSelect),"$$scope"in A&&t(16,n=A.$$scope)},s.$$.update=()=>{s.$$.dirty&8&&t(7,p=i),s.$$.dirty&1&&t(8,h=a.map(A=>!1))},e=Se(e),[a,r,o,i,c,f,g,p,h,v,N,y,w,D,e,d,n,l,V,K,S,I]}class gn extends $e{constructor(e){super(),qe(this,e,Fn,Kn,We,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:15})}}const ll={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Ze(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:vn(s,e,t),flats:e,sharps:t}}function vn(s,e,t){return(s<8?ll[s]:ll[s%7])-e+t+Math.floor(s/8)*12}function bn(s){let e,t=0,l=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(l=Math.floor(s/100),e=s%100):e=s;const n=vn(e,t,l);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(l)}`,interval_seq:e,semitones:n,flats:t,sharps:l}}const xn=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let ks=[];function kn(){return xn.map(s=>{const e=s[3].map(bn);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function Ut(s){ks.length===0&&(ks=kn());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return ks.find(t=>t.suffixes.find(l=>l===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function Hn(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const r=Math.min(l,n);l-=r,n-=r}const a=(s.semitones+e)%12;return{...s,semitones:a<0?a+12:a,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function ss(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const a=t[n],r=s+a.semitones,o=e.scaleNotes.find(g=>g.semitones===r%12),i=a.flats>0,c=a.sharps>0,d=(i?r+1:c?r-1:r)%12,f=i?-1:c?1:0;l.push(Hn(o??e.notesMap.get(d),o?0:f,r))}return l}const nl=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],zn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],rl=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function $n(s){let e=0,t=0;for(let l=0;l<nl.length;l+=1){const n=s.find(r=>r.note.slice(0,2)===nl[l]),a=s.find(r=>r.note.slice(0,2)===zn[l]);if(n)e+=1;else if(a)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:rl.get(e*-1)}:{flats:0,sharps:t,majorSignature:rl.get(t)}}function qn(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function yn(s){return s.map(e=>{const t=[Ze(1)];let l;return e.major?(t.push(Ze(3)),e.suffix.startsWith("+")?t.push(Ze(5,0,1)):e.suffix.startsWith("6")?t.push(Ze(6)):e.suffix.startsWith("7")?t.push(Ze(7,1)):e.suffix.startsWith("maj7")?t.push(Ze(7)):l=Ut("maj")):e.minor?(t.push(Ze(3,1)),e.suffix.startsWith("°")?t.push(Ze(5,1)):e.suffix.startsWith("6")?(t.push(Ze(6)),l=Ut("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Ze(7,1)),l=Ut("m"+e.suffix)):l=Ut("m")):e.suffix.startsWith("sus2")?t.push(Ze(2)):e.suffix.startsWith("sus4")&&t.push(Ze(4)),t.length<=2&&t.push(Ze(5)),t.length<=2&&t.push(Ze(8)),l||(l=Ut(e.suffix)),{...l,intervals:t}})}function Wn(s,e){let t=e.has(4)&&e.has(7),l=e.has(3)&&e.has(7);const n=qn(s);let a="";return t||l||(e.has(3)&&e.has(6)?(a="°",l=!0):e.has(4)&&e.has(8)?(a="+",t=!0):e.has(3)&&e.has(10)?(l=!0,a="7"):e.has(4)&&e.has(10)?(a="7",t=!0):e.has(4)&&e.has(11)?(a="maj7",t=!0):e.has(3)&&e.has(8)?(a="6",l=!0):e.has(4)&&e.has(9)?(a="6",t=!0):e.has(2)?a="sus2":e.has(5)?a="sus4":e.has(7)?a="5":a="?"),{degree:s,roman:l?n.toLowerCase():n,suffix:a,major:t,minor:l,semitones:e}}function Jn(s){const e=s.length;return s.map((t,l)=>{const n=t.semitones,a=new Set;for(let r=1;r<e;r+=1){const o=s[(l+r)%e].semitones,i=o<=n?o+12-n:o-n;a.add(i)}return Wn(t.interval_seq,a)})}const Qn=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let ys=[];function hs(){return Qn.map(s=>{const e=s[0],t=s[1].map(bn),l=Jn(t);return{names:e,intervals:t,triads:l}})}function Yn(s){ys.length===0&&(ys=hs());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return ys.find(t=>t.names.find(l=>l.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const Xn=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,Zn=/^[0-9]$/,ot=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function cs(s){const e=s.midi+s.flats-s.sharps;return e===12?1:Math.floor((e-12)/12)}function ft(s){return`${s.note}${cs(s)}`}function al(s){const t=(s-12)%12;return{...ot[t],semitones:t,midi:s}}function er(s,e=!0,t=!1){if(e&&!Xn.test(s))return{err:`Unrecognized note "${s}"`,code:400};const l=s.trim(),n=l.charAt(0).toUpperCase(),a=ot.find(f=>f.note.charAt(0)===n&&f.note.length===1);if(!a)return{err:`Unable to find note ${l}`,code:500};const r=l.slice(1).split("").reduce((f,g)=>f+(g.toLowerCase()==="b"||g==="♭"?-1:g==="#"||g==="♯"?1:0),0);let o;if(Zn.test(l.charAt(l.length-1)))try{o=parseInt(l.charAt(l.length-1),10)}catch{}if(t&&o===void 0)return{err:`No octave provided: ${s}`,code:400};o===void 0&&(o=0);let i=(a.semitones+r)%12;i=i<0?i+12:i;const c=r<0?-r:0,d=r>0?r:0;return{data:{note:`${n}${"♭".repeat(c)}${"♯".repeat(d)}`,semitones:i,midi:12+o*12+i,flats:c,sharps:d}}}function js(s){const e=ot.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((n,a)=>n+(a.toLowerCase()==="b"||a==="♭"?-1:a==="#"||a==="♯"?1:0),0),l=(e.semitones+t)%12;return{note:s,semitones:l<0?l+12:l,flats:t<0?-t:0,sharps:t>0?t:0}}}const tr=/^[a-gA-G][♭b#♯]?$/,Es="ABCDEFG";function sr(s,e){return e.map(t=>Es.charAt((Es.indexOf(s)+t.interval_seq-1)%Es.length))}function lr(s,e,t){return t.map((l,n)=>{const a=e[n],r=(s+l.semitones)%12,o=ot[r],i=o.note.charAt(0);if(i<a&&(i!=="A"||a!=="G")||i==="G"&&a==="A"){let c=1,d=ot[(r+c)%12];for(;d.note.charAt(0)!==a;)c+=1,d=ot[(r+c)%12];return{semitones:r,note:d.note+"♭".repeat(c),flats:c+(d.note.includes("♭")?1:0),sharps:0}}else if(i>a||i==="A"&&a==="G"){let c=1,d=r===0?ot.length-1:r-c,f=ot[d];for(;f.note.charAt(0)!==a;)c+=1,d=d===0?ot.length-1:d-1,f=ot[d];return{semitones:r,note:f.note+"♯".repeat(c),flats:0,sharps:c+(f.note.includes("♯")?1:0)}}else return{semitones:r,note:o.note,flats:o.flats,sharps:o.sharps}})}function Rt(s,e){if(!tr.test(s))return{err:`Unknown key: ${s}`,code:400};const t=Yn(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const l=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,n=js(l);if(!n)return{err:`Unable to find root for note: ${l}`,code:404};const a=sr(l.charAt(0),t.intervals),r=lr(n.semitones,a,t.intervals),o=new Map(ot.map(i=>{const c=r.find(d=>d.semitones===i.semitones);return c?[i.semitones,c]:[i.semitones,{...i}]}));return{data:{key:l,scale:t.names[0],names:t.names,...$n(r),intervals:t.intervals.map(i=>({...i})),triads:t.triads.map(i=>({...i})),scaleNotes:r,notesMap:o}}}const Ts=new Map;function nr(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function rr(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(l){return{err:`Failed to store the value: ${l}`,code:400}}}function _t(s,e){const{key:t,storage:l="local",namespace:n="default"}=e,a=nr(t,l),r=Ie(s);"data"in a?s.set(e.deserialize?e.deserialize(a.data):a.data):"err"in a&&(e!=null&&e.debug)&&console.info(a.err);const o=s.subscribe(c=>{const d=rr(e.serialize?e.serialize(c):c,t,l);"err"in d&&(e!=null&&e.debug)&&console.error(d.err)}),i=Ts.get(n);return i?i.push({key:t,storage:l,value:s,defaultValue:r,unsubscribe:o}):Ts.set(n,[{key:t,storage:l,value:s,defaultValue:r,unsubscribe:o}]),s}function ar(s=["default"],e){s.forEach(t=>{var l;(l=Ts.get(t))==null||l.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function or(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const l=await t.arrayBuffer();return{data:await e.decodeAudioData(l)}}async function ir(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],l=await Promise.all(t.map(a=>or(`${s}${a}`,e))),n=[];return l.forEach(a=>{"err"in a?console.error(`Failed to load audio: ${a.err}`):n.push(a.data)}),n}class cr{constructor(e,t,l,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(l),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(l))}on(e,t,l,n,a,r,o,i){this.noteA.buffer=e,this.noteA.playbackRate.value=l,this.biquadFilter.frequency.value=a,this.gainA.gain.value=r,this.gain.gain.value=i,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=o,this.noteB.start(0)),this.noteA.start(0)}off(e,t,l){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(l),this.noteB.stop(l),(n=this.damp)==null||n.start(0)}}class ur{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,l)=>{this.bufferlists.push(t),l===8?this.damper=t:l===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(l=>{this.noteOn(l,t)})}noteOn(e,t=80){if(e<109&&e>20){const l=this.notes.get(e);l&&(l.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),a=n+1,r=n*12+21,o=2**((e-69)/12)*440,i=t/127;let c=o*(2-(e-21)/50)+3*o*i;e<60&&(c=440*(3-(60-21)/50)+3*o*i);const d=1-(e%12/12+1)/12,f=Math.pow(2,(e-r)/12),g=0,p=0,h=i**1.4,v=new cr(e,this.context,this.directGain,this.damper);v.on(this.bufferlists[n],this.bufferlists[a],f,g,c,d,p,h),this.notes.set(e,v)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const fr="/midi-note-trainer/",Is=_t(Ge(!1),{key:"midi-access"}),us=Ge(void 0),ms=_t(Ge([60,84]),{key:"midi-range",storage:"session"}),Mt=At(ms,s=>[al(s[0]),al(s[1])]),ol=Ge(void 0),lt=Ge(void 0),nt=_t(Ge({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),je={async openMidi(){return Xt.enable().then(()=>(Is.set(!0),Xt.inputs.length>0?(us.set(Xt.inputs[0]),{data:Xt.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(s=>({err:s.toString(),code:403}))},disableMidi(){Is.set(!1),us.set(void 0)},setMidiRange(s){ms.set(s)},setInputValue(s,e){nt.update(t=>({...t,[s]:e})),s==="useSound"&&!e?lt.set(void 0):s==="useSound"&&!Ie(lt)&&this.initAudio()},async initAudio(){let s=Ie(ol);if(s||(s=new AudioContext,ol.set(s)),!Ie(lt)){const e=new ur(s),t=await ir(`${fr}audio`,s);e.load(t),lt.set(e)}}};let at;Nn({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}});const Tt=Ge(["C","Major"]),It=At(Tt,s=>{const e=Rt(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),il=Ge([]),yt=Ge([]);function As(s,e){if(s.length>0){const t=Date.now();let l=t;const n=s.filter(a=>(a.started+e>t&&(l=Math.min(l,a.started)),a.started+e>t));return!at&&n.length>0&&(at=setTimeout(()=>{at=void 0,yt.update(a=>As(a,e))},e-(t-l)+100)),n}return s}const Le={setKey(s){Tt.update(e=>[s,e[1]])},setScale(s){Tt.update(e=>[e[0],s])},setKeyAndScale(s,e){Tt.set([s,e])},setTarget(s=[]){il.set(s)},getNote(s){return{...Ie(It).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const n={...Ie(It).notesMap.get(s%12),midi:s},a=Date.now(),r=e===void 0?"default":e?"correct":"wrong";if(yt.update(o=>{const i=o.findIndex(c=>c.midi===s);return i>=0&&o.splice(i,1),[...o,{...n,color:r,started:a}]}),!at&&t!==-1){const o=t??Ie(nt).keyFadeTimeout;at=setTimeout(()=>{at=void 0,yt.update(i=>As(i,o))},o)}},setPlayed(s,e,t){const l=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(yt.update(a=>[...s.map(r=>({...r,color:n,started:l}))]),!at&&t!==-1){const a=t??Ie(nt).keyFadeTimeout;at=setTimeout(()=>{at=void 0,yt.update(r=>As(r,a))},a)}},clearPlayed(){yt.set([]),clearTimeout(at),at=void 0},clearScore(s=!1){s&&Tt.set(["C","Major"]),il.set([]),yt.set([])}};class Bs{constructor(e,t,l){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=l;const n=[],{count:a}=l,r=t.map(i=>typeof i=="object"&&i!==null?{...i}:i);let o=l.duplicates;!l.duplicates&&a>r.length&&(console.warn(`Trying to create game with count ${a} larger than available unique values ${t.length}`),o=!0);for(let i=0;i<a;i+=1){const c=Math.floor(Math.random()*r.length);if(o)n.push(r[c]);else{const d=r.splice(c,1);d.length>0&&n.push(d[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function dr(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const r=Math.min(l,n);l-=r,n-=r}const a=(s.semitones+e)%12;return{...s,semitones:a<0?a+12:a,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function hr(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const a=t[n],r=s+a.semitones,o=e.scaleNotes.find(g=>g.semitones===r%12),i=a.flats>0,c=a.sharps>0,d=(i?r+1:c?r-1:r)%12,f=i?-1:c?1:0;l.push(dr(o??e.notesMap.get(d),o?0:f,r))}return l}const mr=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function _r(s){const t=(s-12)%12;return{...mr[t],semitones:t,midi:s}}function pr(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class ht extends Bs{constructor(e,t,l){const n=t.range[0],a=t.range[1],r=new Set(t.scale.scaleNotes.map(i=>i.semitones)),o=l.chords.flatMap(i=>{const c=[],d=i.intervals.reduce((f,g)=>g.semitones>f?g.semitones:f,0);for(let f=n;f<=a-d;f+=1)if((!l.onlyScale||r.has(f%12))&&(!i.allowed||i.allowed.has(f%12))){const g=hr(f,t.scale,i.intervals);c.push({...i,rootNote:g[0].note,chord:`${g[0].note}${i.suffixes[0]}`,notes:g})}return c});super(e,o,t),this.played=new Set,this.opts=l}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${pr(e)}${e.chord.toLowerCase()}`,notes:[]};let l=this.current.chord===t.chord;return this.current.chord.slice(-3)==="maj"&&!l&&(l=this.current.chord.slice(0,-3)===t.chord),this.addGuessed(t,l)}guess(){const e=Array.from(this.played.values()).map(n=>_r(n)).sort((n,a)=>n.midi-a.midi);this.played.clear();const t={chord:"",notes:e},l=this.current.notes.every(n=>e.find(a=>a.midi%12===n.midi%12));return this.addGuessed(t,l)}}const gr={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class Kt extends Bs{constructor(e,t){const l=e==="keys-major"?"major":"minor";super(e,Object.keys(gr[l]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class jt extends Bs{constructor(e,t){const l=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-l+1)).map((a,r)=>l+r),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const En={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},dt=Ge("waiting"),mt=_t(Ge(En),{key:"game-options"}),wt=Ge(void 0),Gs=Ge(kn().map(s=>({...s,selected:!0}))),De={play(...[s,e]){var i,c,d;let t;const l=Ie(It),n=Ie(ms),a=Ie(mt),r={scale:l,range:n,duplicates:a.duplicates,count:a.count};let o=[l.key,l.scale];if(s==="notes")t=new jt(s,r),Le.setTarget([Le.getNote(t.current)]),(i=Ie(lt))==null||i.noteOn(t.current);else if(s==="pitches")t=new jt(s,r),Le.setTarget(),je.setInputValue("useSound",!0),(c=Ie(lt))==null||c.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new Kt(s,r),o=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new ht(s,r,e);else if(s==="chords-diatonic"){const f=yn(l.triads).map((g,p)=>({...g,allowed:new Set([l.scaleNotes[p].semitones])}));t=new ht(s,r,{chords:f})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((d=Ie(lt))==null||d.playChord(t.current.notes.map(f=>f.midi)),Le.setTarget(t.current.notes)),Le.setKeyAndScale(o[0],o[1]),Le.clearPlayed(),dt.set("waiting"),wt.set(t),t},updateState(s){dt.set(s)},setOptionValue(s,e){mt.update(t=>({...t,[s]:e}))},toggleChords(s){Gs.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Ie(wt);s!=null&&s.ended?dt.set("ended"):s instanceof jt?(s.type==="notes"?Le.setTarget([Le.getNote(s.current)]):Le.setTarget(),Le.clearPlayed(),(e=Ie(lt))==null||e.noteOn(s.current),De.updateState("waiting"),s.startTime()):s instanceof ht?(Le.setTarget(s.current.notes),Le.clearPlayed(),(t=Ie(lt))==null||t.playChord(s==null?void 0:s.current.notes.map(l=>l.midi)),dt.set("waiting"),s.startTime()):s instanceof Kt&&(Le.setKey(s.current),dt.set("waiting"),s.startTime())},clearGame(s=!1){const e=Ie(wt);e&&Le.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&mt.set(En),wt.set(void 0),dt.set("waiting"),Le.clearScore()}};function cl(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function ul(s,e,t){const l=s.slice();return l[40]=e[t],l}function fl(s,e,t){const l=s.slice();return l[9]=e[t],l}function dl(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function hl(s,e,t){const l=s.slice();return l[40]=e[t],l}function ml(s,e,t){const l=s.slice();return l[9]=e[t],l}function vr(s){let e,t=de(s[35].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=_l(hl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let a=0;a<l.length;a+=1)l[a].l(n);e=Pe()},m(n,a){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,a);R(n,e,a)},p(n,a){if(a[0]&128){t=de(n[35].intervals);let r;for(r=0;r<t.length;r+=1){const o=hl(n,t,r);l[r]?l[r].p(o,a):(l[r]=_l(o),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function br(s){let e,t=de(s[3][s[37]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=pl(ml(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let a=0;a<l.length;a+=1)l[a].l(n);e=Pe()},m(n,a){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,a);R(n,e,a)},p(n,a){if(a[0]&8){t=de(n[3][n[37]]);let r;for(r=0;r<t.length;r+=1){const o=ml(n,t,r);l[r]?l[r].p(o,a):(l[r]=pl(o),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function _l(s){let e,t=s[40].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var a=C(e);l=ee(a,t),a.forEach(_),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,a){R(n,e,a),u(e,l)},p(n,a){a[0]&128&&t!==(t=n[40].interval+"")&&me(l,t)},d(n){n&&_(e)}}}function pl(s){let e,t=s[9].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var a=C(e);l=ee(a,t),a.forEach(_),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,a){R(n,e,a),u(e,l)},p(n,a){a[0]&8&&t!==(t=n[9].note+"")&&me(l,t)},d(n){n&&_(e)}}}function gl(s){let e,t,l,n,a,r,o=s[35].suffixes[0]+"",i,c,d,f,g,p,h,v=s[35].name+"",N,y,w,D,V;n=new Ue({props:{icon:s[35].selected?os:is,width:12}});function K(){return s[25](s[35])}function S(L,P){return L[3][L[37]]&&L[3][L[37]].length>0?br:vr}let I=S(s),A=I(s);function E(){return s[26](s[35])}return{c(){e=b("li"),t=b("button"),l=b("span"),ge(n.$$.fragment),a=j(),r=b("div"),i=Z(o),c=j(),d=b("li"),A.c(),g=j(),p=b("li"),h=b("button"),N=Z(v),y=j(),this.h()},l(L){e=k(L,"LI",{});var P=C(e);t=k(P,"BUTTON",{class:!0});var T=C(t);l=k(T,"SPAN",{class:!0});var O=C(l);ve(n.$$.fragment,O),O.forEach(_),a=B(T),r=k(T,"DIV",{class:!0});var U=C(r);i=ee(U,o),U.forEach(_),T.forEach(_),P.forEach(_),c=B(L),d=k(L,"LI",{class:!0,title:!0});var M=C(d);A.l(M),M.forEach(_),g=B(L),p=k(L,"LI",{class:!0});var x=C(p);h=k(x,"BUTTON",{class:!0});var X=C(h);N=ee(X,v),X.forEach(_),y=B(x),x.forEach(_),this.h()},h(){m(l,"class","px-1 py-1 rounded"),J(l,"text-green-500",s[35].selected),J(l,"text-gray-400",!s[35].selected),m(r,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),m(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),J(t,"hidden",s[8]),m(d,"class","intervals svelte-1rg0xw5"),m(d,"title",f=s[35].intervals.map(yl).join("-")),m(h,"class","text-start"),m(p,"class","text-xs")},m(L,P){R(L,e,P),u(e,t),u(t,l),be(n,l,null),u(t,a),u(t,r),u(r,i),R(L,c,P),R(L,d,P),A.m(d,null),R(L,g,P),R(L,p,P),u(p,h),u(h,N),u(p,y),w=!0,D||(V=[W(t,"click",K),W(h,"click",E)],D=!0)},p(L,P){s=L;const T={};P[0]&128&&(T.icon=s[35].selected?os:is),n.$set(T),(!w||P[0]&128)&&J(l,"text-green-500",s[35].selected),(!w||P[0]&128)&&J(l,"text-gray-400",!s[35].selected),(!w||P[0]&128)&&o!==(o=s[35].suffixes[0]+"")&&me(i,o),(!w||P[0]&256)&&J(t,"hidden",s[8]),I===(I=S(s))&&A?A.p(s,P):(A.d(1),A=I(s),A&&(A.c(),A.m(d,null))),(!w||P[0]&128&&f!==(f=s[35].intervals.map(yl).join("-")))&&m(d,"title",f),(!w||P[0]&128)&&v!==(v=s[35].name+"")&&me(N,v)},i(L){w||(F(n.$$.fragment,L),w=!0)},o(L){q(n.$$.fragment,L),w=!1},d(L){L&&(_(e),_(c),_(d),_(g),_(p)),ke(n),A.d(),D=!1,Ye(V)}}}function kr(s){let e,t=de(s[35].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=vl(ul(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let a=0;a<l.length;a+=1)l[a].l(n);e=Pe()},m(n,a){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,a);R(n,e,a)},p(n,a){if(a[0]&64){t=de(n[35].intervals);let r;for(r=0;r<t.length;r+=1){const o=ul(n,t,r);l[r]?l[r].p(o,a):(l[r]=vl(o),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function yr(s){let e,t=de(s[4][s[37]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=bl(fl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let a=0;a<l.length;a+=1)l[a].l(n);e=Pe()},m(n,a){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,a);R(n,e,a)},p(n,a){if(a[0]&16){t=de(n[4][n[37]]);let r;for(r=0;r<t.length;r+=1){const o=fl(n,t,r);l[r]?l[r].p(o,a):(l[r]=bl(o),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function vl(s){let e,t=s[40].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var a=C(e);l=ee(a,t),a.forEach(_),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,a){R(n,e,a),u(e,l)},p(n,a){a[0]&64&&t!==(t=n[40].interval+"")&&me(l,t)},d(n){n&&_(e)}}}function bl(s){let e,t=s[9].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var a=C(e);l=ee(a,t),a.forEach(_),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,a){R(n,e,a),u(e,l)},p(n,a){a[0]&16&&t!==(t=n[9].note+"")&&me(l,t)},d(n){n&&_(e)}}}function kl(s){let e,t,l,n,a,r,o=s[35].suffixes[0]+"",i,c,d,f,g,p,h,v=s[35].name+"",N,y,w,D,V;n=new Ue({props:{icon:s[35].selected?os:is,width:12}});function K(){return s[27](s[35])}function S(L,P){return L[4][L[37]]&&L[4][L[37]].length>0?yr:kr}let I=S(s),A=I(s);function E(){return s[28](s[35])}return{c(){e=b("li"),t=b("button"),l=b("span"),ge(n.$$.fragment),a=j(),r=b("div"),i=Z(o),c=j(),d=b("li"),A.c(),g=j(),p=b("li"),h=b("button"),N=Z(v),y=j(),this.h()},l(L){e=k(L,"LI",{});var P=C(e);t=k(P,"BUTTON",{class:!0});var T=C(t);l=k(T,"SPAN",{class:!0});var O=C(l);ve(n.$$.fragment,O),O.forEach(_),a=B(T),r=k(T,"DIV",{class:!0});var U=C(r);i=ee(U,o),U.forEach(_),T.forEach(_),P.forEach(_),c=B(L),d=k(L,"LI",{class:!0,title:!0});var M=C(d);A.l(M),M.forEach(_),g=B(L),p=k(L,"LI",{class:!0});var x=C(p);h=k(x,"BUTTON",{class:!0});var X=C(h);N=ee(X,v),X.forEach(_),y=B(x),x.forEach(_),this.h()},h(){m(l,"class","px-1 py-1 rounded"),J(l,"text-green-500",s[35].selected),J(l,"text-gray-400",!s[35].selected),m(r,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),m(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),J(t,"hidden",s[8]),m(d,"class","intervals svelte-1rg0xw5"),m(d,"title",f=s[35].intervals.map(El).join("-")),m(h,"class","text-start"),m(p,"class","text-xs")},m(L,P){R(L,e,P),u(e,t),u(t,l),be(n,l,null),u(t,a),u(t,r),u(r,i),R(L,c,P),R(L,d,P),A.m(d,null),R(L,g,P),R(L,p,P),u(p,h),u(h,N),u(p,y),w=!0,D||(V=[W(t,"click",K),W(h,"click",E)],D=!0)},p(L,P){s=L;const T={};P[0]&64&&(T.icon=s[35].selected?os:is),n.$set(T),(!w||P[0]&64)&&J(l,"text-green-500",s[35].selected),(!w||P[0]&64)&&J(l,"text-gray-400",!s[35].selected),(!w||P[0]&64)&&o!==(o=s[35].suffixes[0]+"")&&me(i,o),(!w||P[0]&256)&&J(t,"hidden",s[8]),I===(I=S(s))&&A?A.p(s,P):(A.d(1),A=I(s),A&&(A.c(),A.m(d,null))),(!w||P[0]&64&&f!==(f=s[35].intervals.map(El).join("-")))&&m(d,"title",f),(!w||P[0]&64)&&v!==(v=s[35].name+"")&&me(N,v)},i(L){w||(F(n.$$.fragment,L),w=!0)},o(L){q(n.$$.fragment,L),w=!1},d(L){L&&(_(e),_(c),_(d),_(g),_(p)),ke(n),A.d(),D=!1,Ye(V)}}}function Er(s){let e,t,l,n,a="Chords",r,o,i,c,d,f,g,p,h,v,N,y,w,D,V,K,S,I="Key",A,E,L,P,T="Scale",O,U,M,x,X="Note",ie,Q,z,G,le,H,se,ce,we,re;c=new Ue({props:{icon:On,width:20}}),g=new Ue({props:{icon:jn,width:16}}),v=new Ue({props:{icon:s[5]?Js:Qs,width:16}}),w=new Ue({props:{icon:Ft,width:16}}),U=new gn({props:{class:"bg-gray-100 w-48",containerClass:"input w-48",selected:s[1],options:s[10],onSelect:s[14]}});let he=de(s[7]),Y=[];for(let $=0;$<he.length;$+=1)Y[$]=gl(dl(s,he,$));const ue=$=>q(Y[$],1,1,()=>{Y[$]=null});let Ee=de(s[6]),fe=[];for(let $=0;$<Ee.length;$+=1)fe[$]=kl(cl(s,Ee,$));const He=$=>q(fe[$],1,1,()=>{fe[$]=null});return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=a,r=j(),o=b("div"),i=b("button"),ge(c.$$.fragment),d=j(),f=b("button"),ge(g.$$.fragment),p=j(),h=b("button"),ge(v.$$.fragment),N=j(),y=b("button"),ge(w.$$.fragment),D=j(),V=b("div"),K=b("div"),S=b("label"),S.textContent=I,A=j(),E=b("input"),L=j(),P=b("label"),P.textContent=T,O=j(),ge(U.$$.fragment),M=j(),x=b("label"),x.textContent=X,ie=j(),Q=b("input"),z=j(),G=b("ul");for(let $=0;$<Y.length;$+=1)Y[$].c();le=j(),H=b("ul");for(let $=0;$<fe.length;$+=1)fe[$].c();this.h()},l($){e=k($,"DIV",{class:!0});var ae=C(e);t=k(ae,"FIELDSET",{class:!0});var ye=C(t);l=k(ye,"LEGEND",{class:!0});var tt=C(l);n=k(tt,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1knqzl6"&&(n.textContent=a),tt.forEach(_),r=B(ye),o=k(ye,"DIV",{class:!0});var ne=C(o);i=k(ne,"BUTTON",{class:!0});var Oe=C(i);ve(c.$$.fragment,Oe),Oe.forEach(_),d=B(ne),f=k(ne,"BUTTON",{class:!0});var Me=C(f);ve(g.$$.fragment,Me),Me.forEach(_),p=B(ne),h=k(ne,"BUTTON",{class:!0});var pt=C(h);ve(v.$$.fragment,pt),pt.forEach(_),N=B(ne),y=k(ne,"BUTTON",{class:!0});var St=C(y);ve(w.$$.fragment,St),St.forEach(_),ne.forEach(_),D=B(ye),V=k(ye,"DIV",{class:!0});var ze=C(V);K=k(ze,"DIV",{class:!0});var Re=C(K);S=k(Re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(S)!=="svelte-14m38zf"&&(S.textContent=I),A=B(Re),E=k(Re,"INPUT",{class:!0,id:!0}),L=B(Re),P=k(Re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(P)!=="svelte-bxhcb0"&&(P.textContent=T),O=B(Re),ve(U.$$.fragment,Re),M=B(Re),x=k(Re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(x)!=="svelte-dmbfli"&&(x.textContent=X),ie=B(Re),Q=k(Re,"INPUT",{class:!0,id:!0}),Re.forEach(_),z=B(ze),G=k(ze,"UL",{class:!0});var Nt=C(G);for(let Je=0;Je<Y.length;Je+=1)Y[Je].l(Nt);Nt.forEach(_),le=B(ze),H=k(ze,"UL",{class:!0});var st=C(H);for(let Je=0;Je<fe.length;Je+=1)fe[Je].l(st);st.forEach(_),ze.forEach(_),ye.forEach(_),ae.forEach(_),this.h()},h(){m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(i,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),J(i,"hidden",s[8]),m(f,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),J(f,"hidden",s[8]),m(h,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),J(h,"hidden",s[8]),m(y,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),J(y,"hidden",s[8]),m(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),m(S,"class","mr-4 font-bold svelte-1rg0xw5"),m(S,"for","scale-key"),m(E,"class","input bg-gray-100 w-12 px-1 rounded"),m(E,"id","scale-key"),E.value=s[0],m(P,"class","font-bold svelte-1rg0xw5"),m(P,"for","scale-key"),m(x,"class","font-bold svelte-1rg0xw5"),m(x,"for","scale-key"),m(Q,"class","input bg-gray-100 w-12 px-1 rounded"),m(Q,"id","scale-key"),Q.value=s[2],m(K,"class","flex mb-2 options svelte-1rg0xw5"),m(G,"class","chord-list w-full svelte-1rg0xw5"),m(H,"class","chord-list w-full svelte-1rg0xw5"),m(V,"class","body svelte-1rg0xw5"),J(V,"hidden",s[8]),m(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1rg0xw5"),J(t,"collapsed",s[8]),m(e,"class",se=Te(`${s[22].class||""}`)+" svelte-1rg0xw5")},m($,ae){R($,e,ae),u(e,t),u(t,l),u(l,n),u(t,r),u(t,o),u(o,i),be(c,i,null),u(o,d),u(o,f),be(g,f,null),u(o,p),u(o,h),be(v,h,null),u(o,N),u(o,y),be(w,y,null),u(t,D),u(t,V),u(V,K),u(K,S),u(K,A),u(K,E),u(K,L),u(K,P),u(K,O),be(U,K,null),u(K,M),u(K,x),u(K,ie),u(K,Q),u(V,z),u(V,G);for(let ye=0;ye<Y.length;ye+=1)Y[ye]&&Y[ye].m(G,null);u(V,le),u(V,H);for(let ye=0;ye<fe.length;ye+=1)fe[ye]&&fe[ye].m(H,null);ce=!0,we||(re=[W(n,"click",s[12]),W(i,"click",s[17]),W(f,"click",s[18]),W(h,"click",s[19]),W(y,"click",s[20]),W(E,"input",s[13]),W(Q,"input",s[15])],we=!0)},p($,ae){(!ce||ae[0]&256)&&J(i,"hidden",$[8]),(!ce||ae[0]&256)&&J(f,"hidden",$[8]);const ye={};ae[0]&32&&(ye.icon=$[5]?Js:Qs),v.$set(ye),(!ce||ae[0]&256)&&J(h,"hidden",$[8]),(!ce||ae[0]&256)&&J(y,"hidden",$[8]),(!ce||ae[0]&1&&E.value!==$[0])&&(E.value=$[0]);const tt={};if(ae[0]&2&&(tt.selected=$[1]),U.$set(tt),(!ce||ae[0]&4&&Q.value!==$[2])&&(Q.value=$[2]),ae[0]&2163080){he=de($[7]);let ne;for(ne=0;ne<he.length;ne+=1){const Oe=dl($,he,ne);Y[ne]?(Y[ne].p(Oe,ae),F(Y[ne],1)):(Y[ne]=gl(Oe),Y[ne].c(),F(Y[ne],1),Y[ne].m(G,null))}for(Fe(),ne=he.length;ne<Y.length;ne+=1)ue(ne);xe()}if(ae[0]&2163024){Ee=de($[6]);let ne;for(ne=0;ne<Ee.length;ne+=1){const Oe=cl($,Ee,ne);fe[ne]?(fe[ne].p(Oe,ae),F(fe[ne],1)):(fe[ne]=kl(Oe),fe[ne].c(),F(fe[ne],1),fe[ne].m(H,null))}for(Fe(),ne=Ee.length;ne<fe.length;ne+=1)He(ne);xe()}(!ce||ae[0]&256)&&J(V,"hidden",$[8]),(!ce||ae[0]&256)&&J(t,"collapsed",$[8]),(!ce||ae[0]&4194304&&se!==(se=Te(`${$[22].class||""}`)+" svelte-1rg0xw5"))&&m(e,"class",se)},i($){if(!ce){F(c.$$.fragment,$),F(g.$$.fragment,$),F(v.$$.fragment,$),F(w.$$.fragment,$),F(U.$$.fragment,$);for(let ae=0;ae<he.length;ae+=1)F(Y[ae]);for(let ae=0;ae<Ee.length;ae+=1)F(fe[ae]);ce=!0}},o($){q(c.$$.fragment,$),q(g.$$.fragment,$),q(v.$$.fragment,$),q(w.$$.fragment,$),q(U.$$.fragment,$),Y=Y.filter(Boolean);for(let ae=0;ae<Y.length;ae+=1)q(Y[ae]);fe=fe.filter(Boolean);for(let ae=0;ae<fe.length;ae+=1)q(fe[ae]);ce=!1},d($){$&&_(e),ke(c),ke(g),ke(v),ke(w),ke(U),Ve(Y,$),Ve(fe,$),we=!1,Ye(re)}}}const yl=s=>s.interval,El=s=>s.interval;function wr(s,e,t){let l,n,a,r,o,i,c,d,f;pe(s,nt,G=>t(30,o=G)),pe(s,lt,G=>t(31,i=G)),pe(s,Mt,G=>t(32,c=G)),pe(s,Gs,G=>t(24,d=G));let g="C",p="Major",h=Rt(g,p),v="",N,y=[],w=[];const V=hs().map(G=>({key:G.names[0],value:G.names[0]})),K=_t(Ge(!0),{key:"chords-hidden"});pe(s,K,G=>t(8,f=G));function S(){K.update(G=>!G)}function I(){const G=N&&60+N.semitones;if("err"in h||!G)t(3,y=[]),t(4,w=[]);else{const le=h.data;t(3,y=n.map(H=>ss(G,le,H.intervals))),t(4,w=a.map(H=>ss(G,le,H.intervals)))}}function A({currentTarget:{value:G}}){t(0,g=`${G.charAt(0).toUpperCase()}${G.charAt(1).toLowerCase()}`),h=Rt(g,p),I()}function E(G){var le;return t(1,p=(le=V.find(H=>G===H.key))==null?void 0:le.value),h=Rt(g,p),I(),!1}function L({currentTarget:{value:G}}){t(2,v=`${G.charAt(0).toUpperCase()}${G.charAt(1).toLowerCase()}`),t(9,N=js(v)),I()}function P(G){De.toggleChords(le=>le.name===G.name?!le.selected:le.selected)}function T(){const G=H=>H.suffixes[0]==="maj"||H.suffixes[0]==="m",le=d.filter(G).every(H=>H.selected);De.toggleChords(H=>G(H)?!le:H.selected)}function O(){const G=H=>H.suffixes[0]==="maj7"||H.suffixes[0]==="m7"||H.suffixes[0]==="7"||H.suffixes[0]==="dim7"||H.suffixes[0]==="aug7",le=d.filter(G).every(H=>H.selected);De.toggleChords(H=>G(H)?!le:H.selected)}function U(){De.toggleChords(G=>!r)}function M(){De.toggleChords(G=>!0)}function x(G){if("err"in h)return;const le=c[0].midi+((N==null?void 0:N.semitones)||0),H=ss(le,h.data,G.intervals);i==null||i.playChord(H.map(se=>se.midi),o.fixedVelocity)}const X=G=>P(G),ie=G=>x(G),Q=G=>P(G),z=G=>x(G);return s.$$set=G=>{t(22,e=Ae(Ae({},e),Se(G)))},s.$$.update=()=>{s.$$.dirty[0]&16777216&&t(23,l=d),s.$$.dirty[0]&8388608&&t(7,n=l.filter((G,le)=>le<l.length/2)),s.$$.dirty[0]&8388608&&t(6,a=l.filter((G,le)=>le>=l.length/2)),s.$$.dirty[0]&8388608&&t(5,r=l.every(G=>G.selected))},e=Se(e),[g,p,v,y,w,r,a,n,f,N,V,K,S,A,E,L,P,T,O,U,M,x,e,l,d,X,ie,Q,z]}class Cr extends $e{constructor(e){super(),qe(this,e,wr,Er,We,{},null,[-1,-1])}}function wl(s,e,t){const l=s.slice();return l[12]=e[t],l}function Tr(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){R(t,e,l)},p:_e,i:_e,o:_e,d(t){t&&_(e)}}}function Ir(s){let e,t,l="Played:",n,a=de(s[2]),r=[];for(let o=0;o<a.length;o+=1)r[o]=Cl(wl(s,a,o));return{c(){e=b("div"),t=b("span"),t.textContent=l,n=j();for(let o=0;o<r.length;o+=1)r[o].c()},l(o){e=k(o,"DIV",{});var i=C(e);t=k(i,"SPAN",{"data-svelte-h":!0}),oe(t)!=="svelte-1g6xxhn"&&(t.textContent=l),n=B(i);for(let c=0;c<r.length;c+=1)r[c].l(i);i.forEach(_)},m(o,i){R(o,e,i),u(e,t),u(e,n);for(let c=0;c<r.length;c+=1)r[c]&&r[c].m(e,null)},p(o,i){if(i&4){a=de(o[2]);let c;for(c=0;c<a.length;c+=1){const d=wl(o,a,c);r[c]?r[c].p(d,i):(r[c]=Cl(d),r[c].c(),r[c].m(e,null))}for(;c<r.length;c+=1)r[c].d(1);r.length=a.length}},i:_e,o:_e,d(o){o&&_(e),Ve(r,o)}}}function Ar(s){let e,t,l="Result:",n,a,r,o=s[0].correct+"",i,c,d=s[0].sampled.length+"",f,g,p,h,v,N=s[0].avgTime+"",y,w;return{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),a=b("span"),r=Z("["),i=Z(o),c=Z(" / "),f=Z(d),g=Z("]"),p=j(),h=b("span"),v=Z("avg "),y=Z(N),w=Z("s"),this.h()},l(D){e=k(D,"DIV",{class:!0});var V=C(e);t=k(V,"SPAN",{"data-svelte-h":!0}),oe(t)!=="svelte-1eqfbgx"&&(t.textContent=l),n=B(V),a=k(V,"SPAN",{class:!0});var K=C(a);r=ee(K,"["),i=ee(K,o),c=ee(K," / "),f=ee(K,d),g=ee(K,"]"),K.forEach(_),p=B(V),h=k(V,"SPAN",{});var S=C(h);v=ee(S,"avg "),y=ee(S,N),w=ee(S,"s"),S.forEach(_),V.forEach(_),this.h()},h(){m(a,"class","mx-2"),m(e,"class","flex")},m(D,V){R(D,e,V),u(e,t),u(e,n),u(e,a),u(a,r),u(a,i),u(a,c),u(a,f),u(a,g),u(e,p),u(e,h),u(h,v),u(h,y),u(h,w)},p(D,V){V&1&&o!==(o=D[0].correct+"")&&me(i,o),V&1&&d!==(d=D[0].sampled.length+"")&&me(f,d),V&1&&N!==(N=D[0].avgTime+"")&&me(y,N)},i:_e,o:_e,d(D){D&&_(e)}}}function Sr(s){var L,P,T,O;let e,t,l="Target:",n,a,r=((L=s[0].latestGuess.target)==null?void 0:L.chord)+"",o,i,c,d=((P=s[0].latestGuess.target)==null?void 0:P.notes.map(Tl).join(" "))+"",f,g,p,h,v,N,y,w,D=((T=s[0].latestGuess.guessed)==null?void 0:T.chord)+"",V,K,S,I=((O=s[0].latestGuess.guessed)==null?void 0:O.notes.map(Il).join(" "))+"",A,E;return v=new Ue({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),a=b("span"),o=Z(r),i=j(),c=b("span"),f=Z(d),g=j(),p=b("span"),h=b("div"),ge(v.$$.fragment),N=Z(`
        Guessed:`),y=j(),w=b("span"),V=Z(D),K=j(),S=b("span"),A=Z(I),this.h()},l(U){e=k(U,"DIV",{class:!0});var M=C(e);t=k(M,"SPAN",{"data-svelte-h":!0}),oe(t)!=="svelte-1pddpsb"&&(t.textContent=l),n=B(M),a=k(M,"SPAN",{});var x=C(a);o=ee(x,r),x.forEach(_),i=B(M),c=k(M,"SPAN",{});var X=C(c);f=ee(X,d),X.forEach(_),g=B(M),p=k(M,"SPAN",{class:!0});var ie=C(p);h=k(ie,"DIV",{class:!0});var Q=C(h);ve(v.$$.fragment,Q),Q.forEach(_),N=ee(ie,`
        Guessed:`),ie.forEach(_),y=B(M),w=k(M,"SPAN",{});var z=C(w);V=ee(z,D),z.forEach(_),K=B(M),S=k(M,"SPAN",{});var G=C(S);A=ee(G,I),G.forEach(_),M.forEach(_),this.h()},h(){m(h,"class","absolute left-[-2rem] p-1"),m(p,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(U,M){R(U,e,M),u(e,t),u(e,n),u(e,a),u(a,o),u(e,i),u(e,c),u(c,f),u(e,g),u(e,p),u(p,h),be(v,h,null),u(p,N),u(e,y),u(e,w),u(w,V),u(e,K),u(e,S),u(S,A),E=!0},p(U,M){var X,ie,Q,z;(!E||M&1)&&r!==(r=((X=U[0].latestGuess.target)==null?void 0:X.chord)+"")&&me(o,r),(!E||M&1)&&d!==(d=((ie=U[0].latestGuess.target)==null?void 0:ie.notes.map(Tl).join(" "))+"")&&me(f,d);const x={};M&2&&(x.icon=U[1]==="correct"?Bt:Gt),v.$set(x),(!E||M&1)&&D!==(D=((Q=U[0].latestGuess.guessed)==null?void 0:Q.chord)+"")&&me(V,D),(!E||M&1)&&I!==(I=((z=U[0].latestGuess.guessed)==null?void 0:z.notes.map(Il).join(" "))+"")&&me(A,I)},i(U){E||(F(v.$$.fragment,U),E=!0)},o(U){q(v.$$.fragment,U),E=!1},d(U){U&&_(e),ke(v)}}}function Nr(s){let e,t,l="Target:",n,a,r=s[0].latestGuess.target+"",o,i,c,d,f,g,p,h,v,N,y=s[0].latestGuess.guessed+"",w,D,V,K;return p=new Ue({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),a=b("span"),o=Z(r),i=j(),c=b("span"),d=j(),f=b("span"),g=b("div"),ge(p.$$.fragment),h=Z(`
        Guessed:`),v=j(),N=b("span"),w=Z(y),D=j(),V=b("span"),this.h()},l(S){e=k(S,"DIV",{class:!0});var I=C(e);t=k(I,"SPAN",{"data-svelte-h":!0}),oe(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=B(I),a=k(I,"SPAN",{});var A=C(a);o=ee(A,r),A.forEach(_),i=B(I),c=k(I,"SPAN",{}),C(c).forEach(_),d=B(I),f=k(I,"SPAN",{class:!0});var E=C(f);g=k(E,"DIV",{class:!0});var L=C(g);ve(p.$$.fragment,L),L.forEach(_),h=ee(E,`
        Guessed:`),E.forEach(_),v=B(I),N=k(I,"SPAN",{});var P=C(N);w=ee(P,y),P.forEach(_),D=B(I),V=k(I,"SPAN",{}),C(V).forEach(_),I.forEach(_),this.h()},h(){m(g,"class","absolute left-[-2rem] p-1"),m(f,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(S,I){R(S,e,I),u(e,t),u(e,n),u(e,a),u(a,o),u(e,i),u(e,c),u(e,d),u(e,f),u(f,g),be(p,g,null),u(f,h),u(e,v),u(e,N),u(N,w),u(e,D),u(e,V),K=!0},p(S,I){(!K||I&1)&&r!==(r=S[0].latestGuess.target+"")&&me(o,r);const A={};I&2&&(A.icon=S[1]==="correct"?Bt:Gt),p.$set(A),(!K||I&1)&&y!==(y=S[0].latestGuess.guessed+"")&&me(w,y)},i(S){K||(F(p.$$.fragment,S),K=!0)},o(S){q(p.$$.fragment,S),K=!1},d(S){S&&_(e),ke(p)}}}function Lr(s){let e,t,l="Target:",n,a,r=s[8](s[0].latestGuess.target||0)+"",o,i,c,d,f,g,p,h,v,N,y=s[8](s[0].latestGuess.guessed||0)+"",w,D,V,K="",S;return p=new Ue({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),a=b("span"),o=Z(r),i=j(),c=b("span"),d=j(),f=b("span"),g=b("div"),ge(p.$$.fragment),h=Z(`
        Guessed:`),v=j(),N=b("span"),w=Z(y),D=j(),V=b("span"),V.innerHTML=K,this.h()},l(I){e=k(I,"DIV",{class:!0});var A=C(e);t=k(A,"SPAN",{"data-svelte-h":!0}),oe(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=B(A),a=k(A,"SPAN",{});var E=C(a);o=ee(E,r),E.forEach(_),i=B(A),c=k(A,"SPAN",{}),C(c).forEach(_),d=B(A),f=k(A,"SPAN",{class:!0});var L=C(f);g=k(L,"DIV",{class:!0});var P=C(g);ve(p.$$.fragment,P),P.forEach(_),h=ee(L,`
        Guessed:`),L.forEach(_),v=B(A),N=k(A,"SPAN",{});var T=C(N);w=ee(T,y),T.forEach(_),D=B(A),V=k(A,"SPAN",{"data-svelte-h":!0}),oe(V)!=="svelte-1qufua2"&&(V.innerHTML=K),A.forEach(_),this.h()},h(){m(g,"class","absolute left-[-2rem] p-1"),m(f,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(I,A){R(I,e,A),u(e,t),u(e,n),u(e,a),u(a,o),u(e,i),u(e,c),u(e,d),u(e,f),u(f,g),be(p,g,null),u(f,h),u(e,v),u(e,N),u(N,w),u(e,D),u(e,V),S=!0},p(I,A){(!S||A&1)&&r!==(r=I[8](I[0].latestGuess.target||0)+"")&&me(o,r);const E={};A&2&&(E.icon=I[1]==="correct"?Bt:Gt),p.$set(E),(!S||A&1)&&y!==(y=I[8](I[0].latestGuess.guessed||0)+"")&&me(w,y)},i(I){S||(F(p.$$.fragment,I),S=!0)},o(I){q(p.$$.fragment,I),S=!1},d(I){I&&_(e),ke(p)}}}function Cl(s){let e,t=ft(s[12])+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var a=C(e);l=ee(a,t),a.forEach(_),this.h()},h(){m(e,"class","mx-1")},m(n,a){R(n,e,a),u(e,l)},p(n,a){a&4&&t!==(t=ft(n[12])+"")&&me(l,t)},d(n){n&&_(e)}}}function Dr(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){R(t,e,l)},p:_e,d(t){t&&_(e)}}}function Pr(s){let e,t="Next",l,n,a="Autoplay",r,o;return{c(){e=b("button"),e.textContent=t,l=j(),n=b("button"),n.textContent=a,this.h()},l(i){e=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(e)!=="svelte-uy473n"&&(e.textContent=t),l=B(i),n=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1cfj1sl"&&(n.textContent=a),this.h()},h(){m(e,"class","btn primary mr-1"),m(n,"class","btn primary")},m(i,c){R(i,e,c),R(i,l,c),R(i,n,c),r||(o=[W(e,"click",s[4]),W(n,"click",s[5])],r=!0)},p:_e,d(i){i&&(_(e),_(l),_(n)),r=!1,Ye(o)}}}function Vr(s){let e,t="Stop autoplay",l,n;return{c(){e=b("button"),e.textContent=t,this.h()},l(a){e=k(a,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){m(e,"class","btn primary")},m(a,r){R(a,e,r),l||(n=W(e,"click",s[10]),l=!0)},p:_e,d(a){a&&_(e),l=!1,n()}}}function Or(s){let e,t="Try Again",l,n,a="Clear",r,o;return{c(){e=b("button"),e.textContent=t,l=j(),n=b("button"),n.textContent=a,this.h()},l(i){e=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(e)!=="svelte-15zs1cu"&&(e.textContent=t),l=B(i),n=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-11mnk9v"&&(n.textContent=a),this.h()},h(){m(e,"class","btn primary mr-1"),m(n,"class","btn primary")},m(i,c){R(i,e,c),R(i,l,c),R(i,n,c),r||(o=[W(e,"click",s[6]),W(n,"click",s[7])],r=!0)},p:_e,d(i){i&&(_(e),_(l),_(n)),r=!1,Ye(o)}}}function jr(s){let e,t,l,n,a,r,o;const i=[Lr,Nr,Sr,Ar,Ir,Tr],c=[];function d(h,v){return h[0]instanceof jt&&(h[1]==="correct"||h[1]==="wrong")?0:h[0]instanceof Kt&&(h[1]==="correct"||h[1]==="wrong")?1:h[0]instanceof ht&&(h[1]==="correct"||h[1]==="wrong")?2:h[0]&&h[1]==="ended"?3:h[2].length>0?4:5}t=d(s),l=c[t]=i[t](s);function f(h,v){return h[0]&&h[1]==="ended"?Or:h[0]&&h[3].autoplay?Vr:h[0]?Pr:Dr}let g=f(s),p=g(s);return{c(){e=b("div"),l.c(),a=j(),r=b("div"),p.c(),this.h()},l(h){e=k(h,"DIV",{class:!0});var v=C(e);l.l(v),v.forEach(_),a=B(h),r=k(h,"DIV",{class:!0});var N=C(r);p.l(N),N.forEach(_),this.h()},h(){m(e,"class",n=Te(`${s[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),m(r,"class","mt-2 h-8 flex items-center")},m(h,v){R(h,e,v),c[t].m(e,null),R(h,a,v),R(h,r,v),p.m(r,null),o=!0},p(h,[v]){let N=t;t=d(h),t===N?c[t].p(h,v):(Fe(),q(c[N],1,1,()=>{c[N]=null}),xe(),l=c[t],l?l.p(h,v):(l=c[t]=i[t](h),l.c()),F(l,1),l.m(e,null)),(!o||v&512&&n!==(n=Te(`${h[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"))&&m(e,"class",n),g===(g=f(h))&&p?p.p(h,v):(p.d(1),p=g(h),p&&(p.c(),p.m(r,null)))},i(h){o||(F(l),o=!0)},o(h){q(l),o=!1},d(h){h&&(_(e),_(a),_(r)),c[t].d(),p.d()}}}const Tl=s=>s.note,Il=s=>s.note;function Br(s,e,t){let l,n,a,r;pe(s,It,h=>t(11,l=h)),pe(s,dt,h=>t(1,n=h)),pe(s,yt,h=>t(2,a=h)),pe(s,mt,h=>t(3,r=h));let{game:o}=e;function i(){De.nextGuess()}function c(){De.setOptionValue("autoplay",!0),De.nextGuess()}function d(){o instanceof ht?De.play(o.type,o.opts):o&&De.play(o.type,void 0)}function f(){De.clearGame()}function g(h){const v=l.notesMap.get(h%12);return ft({midi:h,...v})}const p=()=>De.setOptionValue("autoplay",!1);return s.$$set=h=>{t(9,e=Ae(Ae({},e),Se(h))),"game"in h&&t(0,o=h.game)},e=Se(e),[o,n,a,r,i,c,d,f,g,e,p]}class Gr extends $e{constructor(e){super(),qe(this,e,Br,jr,We,{game:0})}}const Ss={ar:{name:"Arabic",import:Ce(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:Ce(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:Ce(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:Ce(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:Ce(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:Ce(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:Ce(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:Ce(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:Ce(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>Ur)},fa:{name:"Farsi",import:Ce(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:Ce(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:Ce(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:Ce(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:Ce(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:Ce(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:Ce(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:Ce(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:Ce(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:Ce(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:Ce(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:Ce(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:Ce(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:Ce(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:Ce(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:Ce(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:Ce(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:Ce(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:Ce(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:Ce(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:Ce(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:Ce(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:Ce(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:Ce(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function wn(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default,shift:s.layout.shift}}async function Mr(s=["en"]){let e={code:"en",layout:Ss.en,index:99};Object.entries(Ss).forEach(([l,n])=>{for(let a=0;a<s.length;a+=1)l===s[a]&&(!e||e.index>a)&&(e={code:l,layout:n,index:a})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:wn(t.default)}}const Cn={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Ur=Object.freeze(Object.defineProperty({__proto__:null,default:Cn},Symbol.toStringTag,{value:"Module"}));function Ot(s,e,t,l=0){const n=t?[0,2,4,5,7,9,11]:[-1,1,3,-1,6,8,10];let a=-1,r=0;return s.forEach((o,i)=>{const c=o.key.charAt(0)==="{";!c&&a===-1&&(a=i);const d=n[(i-a+l)%n.length];if(a!==-1&&i!==0&&!c&&d>=0){const f=e[d],g=Math.floor((l+i-a)/n.length);o.note={...f,semitones:f.semitones+(g>0?g:0)*12},o.note,r=i-a}}),r}const es=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function Rr(s){let e=[];const t=s.default.map((l,n)=>{if(n===0){const a=l.split(" ").filter(r=>r!=="{bksp}");for(;a.length!==13;)a.length<13?a.unshift("{empty}"):a.shift();return[...a,"{bksp}"]}else if(n===1){const a=l.split(" ");return e=a.slice(13),[...a.slice(0,13),"{enter}"]}else{if(n===2)return[...l.split(" ").slice(0,13).filter(a=>a!=="{enter}"),...e].slice(0,13);if(n===3){const a=["{shift}",...l.split(" ").slice(1,12).filter(o=>o!=="{shift}"),"{shift}"];let r=1;for(;a.length<13;)a.splice(r,0,"{empty}"),r=r===1?-1:1;return a}else return l.split(" ")}});return[t[0].map((l,n)=>({key:l,code:es[0][n]})),t[1].map((l,n)=>({key:l,code:es[1][n]})),t[2].map((l,n)=>({key:l,code:es[2][n]})),t[3].map((l,n)=>({key:l,code:es[3][n]}))]}class fs{constructor(e){return this.rows=[[],[],[],[]],this.opts={hotkeydRows:"middle-row",layout:{code:"en",name:"English",imported:wn(Cn)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=Rr(e),this}setRows(e){return this.rows=e,this}setRowHotkeys(e,t){}setNotes(e){if(this.opts.hotkeydRows==="middle-row")Ot(this.rows[1],e,!1),Ot(this.rows[2],e,!0);else{Ot(this.rows[2],e,!1);const t=Ot(this.rows[3],e,!0);Ot(this.rows[0],e,!1,t),Ot(this.rows[1],e,!0,t+1)}}static createWithRows(e,t){return new fs(e).setRows(t)}}function Al(s,e,t){const l=s.slice();return l[15]=e[t].key,l[16]=e[t].value,l[17]=e[t].icon,l[19]=t,l}const Kr=s=>({}),Sl=s=>({}),Fr=s=>({}),Nl=s=>({});function Ll(s){let e,t,l,n,a,r,o,i,c,d,f;const g=s[12].header,p=Ls(g,s,s[11],Sl);let h=de(s[0]),v=[];for(let y=0;y<h.length;y+=1)v[y]=Dl(Al(s,h,y));const N=y=>q(v[y],1,1,()=>{v[y]=null});return{c(){e=b("button"),l=j(),n=b("ul"),a=b("li"),p&&p.c(),r=j();for(let y=0;y<v.length;y+=1)v[y].c();this.h()},l(y){e=k(y,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(_),l=B(y),n=k(y,"UL",{class:!0});var w=C(n);a=k(w,"LI",{});var D=C(a);p&&p.l(D),D.forEach(_),r=B(w);for(let V=0;V<v.length;V+=1)v[V].l(w);w.forEach(_),this.h()},h(){m(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),m(e,"tabindex","-1"),m(n,"class",o=Te(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(y,w){R(y,e,w),R(y,l,w),R(y,n,w),u(n,a),p&&p.m(a,null),u(n,r);for(let D=0;D<v.length;D+=1)v[D]&&v[D].m(n,null);c=!0,d||(f=W(e,"click",s[7]),d=!0)},p(y,w){if(s=y,p&&p.p&&(!c||w&2048)&&Ds(p,g,s,s[11],c?Vs(g,s[11],w,Kr):Ps(s[11]),Sl),w&265){h=de(s[0]);let D;for(D=0;D<h.length;D+=1){const V=Al(s,h,D);v[D]?(v[D].p(V,w),F(v[D],1)):(v[D]=Dl(V),v[D].c(),F(v[D],1),v[D].m(n,null))}for(Fe(),D=h.length;D<v.length;D+=1)N(D);xe()}(!c||w&4&&o!==(o=Te(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&m(n,"class",o)},i(y){if(!c){y&&ls(()=>{c&&(t||(t=Et(e,ns,{duration:ts},!0)),t.run(1))}),F(p,y);for(let w=0;w<h.length;w+=1)F(v[w]);y&&ls(()=>{c&&(i||(i=Et(n,rs,{duration:ts},!0)),i.run(1))}),c=!0}},o(y){y&&(t||(t=Et(e,ns,{duration:ts},!1)),t.run(0)),q(p,y),v=v.filter(Boolean);for(let w=0;w<v.length;w+=1)q(v[w]);y&&(i||(i=Et(n,rs,{duration:ts},!1)),i.run(0)),c=!1},d(y){y&&(_(e),_(l),_(n)),y&&t&&t.end(),p&&p.d(y),Ve(v,y),y&&i&&i.end(),d=!1,f()}}}function xr(s){let e;return{c(){e=b("div"),this.h()},l(t){e=k(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){m(e,"class","w-[24px]")},m(t,l){R(t,e,l)},p:_e,i:_e,o:_e,d(t){t&&_(e)}}}function Hr(s){let e,t;return e=new Ue({props:{class:"mr-2",icon:s[17],width:16}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const a={};n&1&&(a.icon=l[17]),e.$set(a)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){q(e.$$.fragment,l),t=!1},d(l){ke(e,l)}}}function Dl(s){let e,t,l,n,a,r,o=s[16]+"",i,c,d,f,g;const p=[Hr,xr],h=[];function v(y,w){return y[17]?0:1}l=v(s),n=h[l]=p[l](s);function N(){return s[13](s[15])}return{c(){e=b("li"),t=b("button"),n.c(),a=j(),r=b("div"),i=Z(o),c=j(),this.h()},l(y){e=k(y,"LI",{});var w=C(e);t=k(w,"BUTTON",{class:!0});var D=C(t);n.l(D),a=B(D),r=k(D,"DIV",{});var V=C(r);i=ee(V,o),V.forEach(_),D.forEach(_),c=B(w),w.forEach(_),this.h()},h(){m(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),J(t,"selected",s[15]===s[3])},m(y,w){R(y,e,w),u(e,t),h[l].m(t,null),u(t,a),u(t,r),u(r,i),u(e,c),d=!0,f||(g=W(t,"click",N),f=!0)},p(y,w){s=y;let D=l;l=v(s),l===D?h[l].p(s,w):(Fe(),q(h[D],1,1,()=>{h[D]=null}),xe(),n=h[l],n?n.p(s,w):(n=h[l]=p[l](s),n.c()),F(n,1),n.m(t,a)),(!d||w&1)&&o!==(o=s[16]+"")&&me(i,o),(!d||w&9)&&J(t,"selected",s[15]===s[3])},i(y){d||(F(n),d=!0)},o(y){q(n),d=!1},d(y){y&&_(e),h[l].d(),f=!1,g()}}}function zr(s){let e,t,l,n,a,r,o,i,c;const d=s[12].value,f=Ls(d,s,s[11],Nl);let g=s[6]&&Ll(s);return{c(){e=b("div"),t=b("button"),f&&f.c(),a=j(),g&&g.c(),this.h()},l(p){e=k(p,"DIV",{class:!0,id:!0});var h=C(e);t=k(h,"BUTTON",{class:!0,title:!0});var v=C(t);f&&f.l(v),v.forEach(_),a=B(h),g&&g.l(h),h.forEach(_),this.h()},h(){m(t,"class",l=Te(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),m(t,"title",n=s[9].title||""),J(t,"disabled",s[4]),J(t,"open",s[6]),m(e,"class",r=Te(`relative ${s[2]||""}`)+" svelte-h65upg"),m(e,"id",s[1])},m(p,h){R(p,e,h),u(e,t),f&&f.m(t,null),u(e,a),g&&g.m(e,null),s[14](e),o=!0,i||(c=W(t,"click",s[7]),i=!0)},p(p,[h]){f&&f.p&&(!o||h&2048)&&Ds(f,d,p,p[11],o?Vs(d,p[11],h,Fr):Ps(p[11]),Nl),(!o||h&512&&l!==(l=Te(`${p[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&m(t,"class",l),(!o||h&512&&n!==(n=p[9].title||""))&&m(t,"title",n),(!o||h&528)&&J(t,"disabled",p[4]),(!o||h&576)&&J(t,"open",p[6]),p[6]?g?(g.p(p,h),h&64&&F(g,1)):(g=Ll(p),g.c(),F(g,1),g.m(e,null)):g&&(Fe(),q(g,1,1,()=>{g=null}),xe()),(!o||h&4&&r!==(r=Te(`relative ${p[2]||""}`)+" svelte-h65upg"))&&m(e,"class",r),(!o||h&2)&&m(e,"id",p[1])},i(p){o||(F(f,p),F(g),o=!0)},o(p){q(f,p),q(g),o=!1},d(p){p&&_(e),f&&f.d(p),g&&g.d(),s[14](null),i=!1,c()}}}const ts=400;function $r(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:a,id:r=void 0,containerClass:o=void 0,selected:i=void 0,disabled:c=void 0,onSelect:d}=e,f,g=!1;function p(){c||t(6,g=!g)}function h(y){t(6,g=d(y))}const v=y=>h(y);function N(y){Os[y?"unshift":"push"](()=>{f=y,t(5,f)})}return s.$$set=y=>{t(9,e=Ae(Ae({},e),Se(y))),"options"in y&&t(0,a=y.options),"id"in y&&t(1,r=y.id),"containerClass"in y&&t(2,o=y.containerClass),"selected"in y&&t(3,i=y.selected),"disabled"in y&&t(4,c=y.disabled),"onSelect"in y&&t(10,d=y.onSelect),"$$scope"in y&&t(11,n=y.$$scope)},e=Se(e),[a,r,o,i,c,f,g,p,h,e,d,n,l,v,N]}class qr extends $e{constructor(e){super(),qe(this,e,$r,zr,We,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function Wr(s){let e,t,l,n,a,r,o;return{c(){e=b("label"),t=b("input"),l=j(),n=b("div"),this.h()},l(i){e=k(i,"LABEL",{class:!0});var c=C(e);t=k(c,"INPUT",{type:!0,class:!0}),l=B(c),n=k(c,"DIV",{class:!0}),C(n).forEach(_),c.forEach(_),this.h()},h(){t.checked=s[0],m(t,"type","checkbox"),m(t,"class","svelte-k5zciy"),m(n,"class","slider svelte-k5zciy"),m(e,"class",a=Te(`${s[3].class||""} toggle`)+" svelte-k5zciy")},m(i,c){R(i,e,c),u(e,t),s[5](t),u(e,l),u(e,n),r||(o=[W(t,"change",s[4]),W(t,"keydown",s[2])],r=!0)},p(i,[c]){c&1&&(t.checked=i[0]),c&8&&a!==(a=Te(`${i[3].class||""} toggle`)+" svelte-k5zciy")&&m(e,"class",a)},i:_e,o:_e,d(i){i&&_(e),s[5](null),r=!1,Ye(o)}}}function Jr(s,e,t){let{checked:l}=e,n;function a(i){i.key==="Enter"&&n.click()}function r(i){ds.call(this,s,i)}function o(i){Os[i?"unshift":"push"](()=>{n=i,t(1,n)})}return s.$$set=i=>{t(3,e=Ae(Ae({},e),Se(i))),"checked"in i&&t(0,l=i.checked)},e=Se(e),[l,n,a,e,r,o]}class Qr extends $e{constructor(e){super(),qe(this,e,Jr,Wr,We,{checked:0})}}function Pl(s){let e;return{c(){e=b("li"),this.h()},l(t){e=k(t,"LI",{class:!0}),C(e).forEach(_),this.h()},h(){m(e,"class","m-[0.175rem] mr-0")},m(t,l){R(t,e,l)},d(t){t&&_(e)}}}function Vl(s){let e;return{c(){e=b("div"),this.h()},l(t){e=k(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){m(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,l){R(t,e,l)},d(t){t&&_(e)}}}function Ol(s){let e,t=s[0].note.note+"",l,n;return{c(){e=b("div"),l=Z(t),n=Z(s[2]),this.h()},l(a){e=k(a,"DIV",{class:!0});var r=C(e);l=ee(r,t),n=ee(r,s[2]),r.forEach(_),this.h()},h(){m(e,"class","absolute top-0 left-0")},m(a,r){R(a,e,r),u(e,l),u(e,n)},p(a,r){r&1&&t!==(t=a[0].note.note+"")&&me(l,t),r&4&&me(n,a[2])},d(a){a&&_(e)}}}function Yr(s){let e,t,l,n,a,r,o=Bl(s[0].key)+"",i,c,d,f,g=s[0].key==="{enter}"&&Pl(),p=s[0].key==="{enter}"&&Vl(),h=s[0].note&&Ol(s);return{c(){g&&g.c(),e=j(),t=b("li"),l=b("button"),p&&p.c(),n=j(),h&&h.c(),a=j(),r=b("div"),i=Z(o),this.h()},l(v){g&&g.l(v),e=B(v),t=k(v,"LI",{class:!0});var N=C(t);l=k(N,"BUTTON",{class:!0});var y=C(l);p&&p.l(y),n=B(y),h&&h.l(y),a=B(y),r=k(y,"DIV",{});var w=C(r);i=ee(w,o),w.forEach(_),y.forEach(_),N.forEach(_),this.h()},h(){m(l,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),J(l,"items-center",!s[0].note),J(l,"items-end",s[0].note),m(t,"class",c=Te(`${s[3].class||""} m-[0.175rem] ${jl(s[0].size)}`)+" svelte-1479mcy"),J(t,"enter",s[0].key==="{enter}"),J(t,"captured",s[1])},m(v,N){g&&g.m(v,N),R(v,e,N),R(v,t,N),u(t,l),p&&p.m(l,null),u(l,n),h&&h.m(l,null),u(l,a),u(l,r),u(r,i),d||(f=W(l,"click",s[5]),d=!0)},p(v,[N]){v[0].key==="{enter}"?g||(g=Pl(),g.c(),g.m(e.parentNode,e)):g&&(g.d(1),g=null),v[0].key==="{enter}"?p||(p=Vl(),p.c(),p.m(l,n)):p&&(p.d(1),p=null),v[0].note?h?h.p(v,N):(h=Ol(v),h.c(),h.m(l,a)):h&&(h.d(1),h=null),N&1&&o!==(o=Bl(v[0].key)+"")&&me(i,o),N&1&&J(l,"items-center",!v[0].note),N&1&&J(l,"items-end",v[0].note),N&9&&c!==(c=Te(`${v[3].class||""} m-[0.175rem] ${jl(v[0].size)}`)+" svelte-1479mcy")&&m(t,"class",c),N&9&&J(t,"enter",v[0].key==="{enter}"),N&11&&J(t,"captured",v[1])},i:_e,o:_e,d(v){v&&(_(e),_(t)),g&&g.d(v),p&&p.d(),h&&h.d(),d=!1,f()}}}function jl(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function Bl(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function Xr(s,e,t){let l,n;pe(s,ms,i=>t(4,n=i));let{value:a,captured:r}=e;function o(i){ds.call(this,s,i)}return s.$$set=i=>{t(3,e=Ae(Ae({},e),Se(i))),"value"in i&&t(0,a=i.value),"captured"in i&&t(1,r=i.captured)},s.$$.update=()=>{s.$$.dirty&17&&t(2,l=a.note?cs({midi:a.note.semitones+n[0],flats:0,sharps:0}):0)},e=Se(e),[a,r,l,e,n,o]}class Zr extends $e{constructor(e){super(),qe(this,e,Xr,Yr,We,{value:0,captured:1})}}function ea(s,e,t){return e==="Escape"?{e:"hotkeys-cancel"}:e==="Space"?{e:"hotkeys-captured-key",data:{code:"EMPTY",key:"{empty}"}}:s.has(e)?{e:"hotkeys-no-key"}:(s.add(e),{e:"hotkeys-captured-key",data:{code:e,key:t}})}const Ms=/^[a-gA-G]$/,Tn=/^[♭Bb#♯sS]$/,ta=/^[0-9]$/;let te="",Qe;function sa(s,e){const{useHotkeys:t}=Ie(nt),l=Ie(Rs).get(s);if(t&&te.length===0&&l&&l.note)return te="",{e:"guessed-key",data:l.note.note};if(!t&&te.length===0&&Ms.test(e))return te+=e.toUpperCase(),{e:"string",data:te};if(!t&&te.length>0&&Tn.test(e))return e==="b"||e==="B"?te+="♭":te+="♯",{e:"string",data:te};if(s==="Backspace"&&te.length>0)return te=te.slice(0,-1),{e:"string",data:te};if(s==="Enter"&&te.length>0){const n=te;return te="",{e:"guessed-key",data:n}}return!1}function la(s,e){if(s==="Enter"&&te.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let l=0;l<te.length;l+=1)l===0?t.note+=te[l]:t.chord.length>0?t.chord+=te[l].toLowerCase():te[l]==="♭"?(t.note+=te[l],t.flats+=1):te[l]==="♯"?(t.note+=te[l],t.sharps+=1):t.chord+=te[l].toLowerCase();return te="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&te.length>0)return te=te.slice(0,-1),{e:"string",data:te};if(te.length===0&&Ms.test(e))return te+=e.toUpperCase(),{e:"string",data:te};if(te.length>0&&e.length===1)return te.length===1&&(e==="b"||e==="B")?te+="♭":te.length===1&&e==="#"?te+="♯":te+=e,{e:"string",data:te}}return!1}function na(s,e,t){const{useAutoOctave:l,useHotkeys:n}=Ie(nt);let a;const o=Ie(Rs).get(s),i=(o==null?void 0:o.key)||"";let c=!1;if(!Qe&&n&&(o!=null&&o.note)?(Qe=o.note,l&&(a=cs({midi:Ie(Mt)[0].midi,flats:0,sharps:0})),c="note"):!n&&te.length===0&&Ms.test(e)?(te+=e.toUpperCase(),c="input"):!n&&te.length>0&&Tn.test(e)?(e==="b"||e==="B"?te+="♭":te+="♯",c="input"):!n&&te.length>0&&s==="Enter"&&l&&(a=cs({midi:Ie(Mt)[0].midi,flats:0,sharps:0}),c="octave"),!c&&ta.test(i))try{a=parseInt(i),c="octave"}catch{}if(c&&(Qe||te)&&a!==void 0){const d=(Qe==null?void 0:Qe.note)??te;return t&&(a+=1),Qe&&(Qe==null?void 0:Qe.semitones)>=12&&(a+=Math.floor(Qe.semitones/12)),Qe=void 0,te="",{e:"guessed-note",data:{note:d,octave:a}}}else if(s==="Backspace"&&(Qe||te.length>0))return Qe=void 0,te=te.slice(0,-1),{e:"string",data:te};return c==="note"?{e:"note",data:Qe}:c==="input"?{e:"string",data:te}:!1}const In={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},ws=new Set,Ct=Ge(void 0);At(Ct,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const ct=_t(Ge({useCustom:!1,customLayout:[[],[],[],[]],kbdOpts:{layout:In,hotkeydRows:"middle-row"}}),{key:"keyboard-settings"}),Us=At([It,ct],([s,e])=>{let t;return e.useCustom&&e.customLayout?t=fs.createWithRows(e.kbdOpts,e.customLayout):t=new fs(e.kbdOpts),t.setNotes(Array.from(s.notesMap.values())),t}),ra=At(Us,s=>s.rows.map(e=>e.map((t,l)=>{let n;return t.key==="{bksp}"?n=2:t.key==="{tab}"?n=1.5:t.key==="{enter}"?n=2:t.key==="{lock}"?n=1.75:t.key==="{shift}"&&l===0?n=1.5:t.key==="{shift}"&&(n=2.5),n?{...t,size:n}:t}))),Rs=At(Us,s=>new Map([...s.rows[0].map(e=>[e.code,e]),...s.rows[1].map(e=>[e.code,e]),...s.rows[2].map(e=>[e.code,e]),...s.rows[3].map(e=>[e.code,e])])),aa=At(Rs,s=>Array.from(s.values()).map(e=>e.note).filter(e=>e!==void 0).sort((e,t)=>e.semitones-t.semitones)),ut={async setLayout(s){const e=await Mr(s);ct.update(t=>({...t,kbdOpts:{...t.kbdOpts,layout:e}}))},setCustomLayout(s){if(s){const e=Ie(Us);ct.update(t=>({...t,useCustom:s,customLayout:t.customLayout.map((l,n)=>l.length===0?e.rows[n].map(a=>({...a})):l)}))}else ct.update(e=>({...e,useCustom:s}))},toggleRows(s){ct.update(e=>({...e,kbdOpts:{...e.kbdOpts,hotkeydRows:s??(e.kbdOpts.hotkeydRows==="middle-row"?"two-rows":"middle-row")}}))},captureHotkeyRow(s){let e=-1,t=0;const l=Ie(ct).customLayout[s].map((n,a)=>{const r=n.key.charAt(0)==="{"&&n.key!=="{empty}";return!r&&e===-1&&(e=a),t+=r?0:1,n});console.log("count",t),Ct.set({row:l,nextIndex:e,rowIndex:s,count:t})},findNote(s){return Ie(aa).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((l,n)=>l+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleHotkeyInput(s,e,t){const l=ea(ws,e,t);if(l.e==="hotkeys-cancel")Ct.set(void 0),ws.clear();else if(l.e==="hotkeys-captured-key"){const n=s.row.map((a,r)=>r===s.nextIndex?l.data:a);s.nextIndex===s.count?(ct.update(a=>({...a,customLayout:a.customLayout.map((r,o)=>o!==s.rowIndex?r:n)})),Ct.set(void 0),ws.clear()):n&&Ct.set({...s,nextIndex:s.nextIndex+1,row:n})}return l},handleInput(s,e,t=!1){const l=Ie(wt),n=Ie(Ct);return n?this.handleHotkeyInput(n,s,e):l instanceof Kt?sa(s,e.toUpperCase()):l instanceof ht&&l.type==="chords-write"?la(s,e):Ie(nt).useKeyboard?na(s,e.toUpperCase(),t):!1},reset(){ct.set({useCustom:!1,customLayout:[[],[],[],[]],kbdOpts:{layout:In,hotkeydRows:"middle-row"}})}};function Gl(s,e,t){const l=s.slice();return l[13]=e[t],l[15]=t,l}function Ml(s,e,t){const l=s.slice();return l[16]=e[t],l[18]=t,l}function oa(s){let e,t=s[0].kbdOpts.layout.name+"",l;return{c(){e=b("div"),l=Z(t),this.h()},l(n){e=k(n,"DIV",{slot:!0});var a=C(e);l=ee(a,t),a.forEach(_),this.h()},h(){m(e,"slot","value")},m(n,a){R(n,e,a),u(e,l)},p(n,a){a&1&&t!==(t=n[0].kbdOpts.layout.name+"")&&me(l,t)},d(n){n&&_(e)}}}function Ul(s){let e,t,l,n,a;t=new Ue({props:{icon:Bn,width:20}});function r(){return s[12](s[15])}return{c(){e=b("button"),ge(t.$$.fragment),this.h()},l(o){e=k(o,"BUTTON",{class:!0});var i=C(e);ve(t.$$.fragment,i),i.forEach(_),this.h()},h(){m(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(o,i){R(o,e,i),be(t,e,null),l=!0,n||(a=W(e,"click",r),n=!0)},p(o,i){s=o},i(o){l||(F(t.$$.fragment,o),l=!0)},o(o){q(t.$$.fragment,o),l=!1},d(o){o&&_(e),ke(t),n=!1,a()}}}function Rl(s){let e,t;return e=new Zr({props:{value:s[16],captured:s[4]&&s[4].rowIndex===s[15]&&s[4].nextIndex===s[18]||!1}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const a={};n&2&&(a.value=l[16]),n&16&&(a.captured=l[4]&&l[4].rowIndex===l[15]&&l[4].nextIndex===l[18]||!1),e.$set(a)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){q(e.$$.fragment,l),t=!1},d(l){ke(e,l)}}}function Kl(s){let e,t,l,n,a=s[3][s[15]]&&Ul(s),r=de(s[13]),o=[];for(let c=0;c<r.length;c+=1)o[c]=Rl(Ml(s,r,c));const i=c=>q(o[c],1,1,()=>{o[c]=null});return{c(){e=b("li"),a&&a.c(),t=j();for(let c=0;c<o.length;c+=1)o[c].c();l=Pe(),this.h()},l(c){e=k(c,"LI",{class:!0});var d=C(e);a&&a.l(d),d.forEach(_),t=B(c);for(let f=0;f<o.length;f+=1)o[f].l(c);l=Pe(),this.h()},h(){m(e,"class","col-span-2 svelte-1av9wwd")},m(c,d){R(c,e,d),a&&a.m(e,null),R(c,t,d);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(c,d);R(c,l,d),n=!0},p(c,d){if(c[3][c[15]]?a?(a.p(c,d),d&8&&F(a,1)):(a=Ul(c),a.c(),F(a,1),a.m(e,null)):a&&(Fe(),q(a,1,1,()=>{a=null}),xe()),d&18){r=de(c[13]);let f;for(f=0;f<r.length;f+=1){const g=Ml(c,r,f);o[f]?(o[f].p(g,d),F(o[f],1)):(o[f]=Rl(g),o[f].c(),F(o[f],1),o[f].m(l.parentNode,l))}for(Fe(),f=r.length;f<o.length;f+=1)i(f);xe()}},i(c){if(!n){F(a);for(let d=0;d<r.length;d+=1)F(o[d]);n=!0}},o(c){q(a),o=o.filter(Boolean);for(let d=0;d<o.length;d+=1)q(o[d]);n=!1},d(c){c&&(_(e),_(t),_(l)),a&&a.d(),Ve(o,c)}}}function ia(s){let e,t,l,n,a,r="Layout",o,i,c,d,f,g="Custom",p,h,v,N,y,w,D="One row",V,K,S,I,A="Two rows",E,L,P,T,O,U,M,x,X,ie,Q;i=new qr({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1 w-36",options:s[5],onSelect:s[7],$$slots:{value:[oa]},$$scope:{ctx:s}}}),K=new Qr({props:{checked:!s[2]}}),K.$on("change",s[10]),T=new Ue({props:{icon:Ft,width:16}});let z=de(s[1]),G=[];for(let H=0;H<z.length;H+=1)G[H]=Kl(Gl(s,z,H));const le=H=>q(G[H],1,1,()=>{G[H]=null});return{c(){e=b("div"),t=b("div"),l=b("div"),n=b("div"),a=b("label"),a.textContent=r,o=j(),ge(i.$$.fragment),c=j(),d=b("div"),f=b("label"),f.textContent=g,p=j(),h=b("input"),N=j(),y=b("div"),w=b("label"),w.textContent=D,V=j(),ge(K.$$.fragment),S=j(),I=b("label"),I.textContent=A,E=j(),L=b("div"),P=b("button"),ge(T.$$.fragment),O=j(),U=b("div"),M=b("ul");for(let H=0;H<G.length;H+=1)G[H].c();this.h()},l(H){e=k(H,"DIV",{class:!0});var se=C(e);t=k(se,"DIV",{class:!0});var ce=C(t);l=k(ce,"DIV",{class:!0});var we=C(l);n=k(we,"DIV",{class:!0});var re=C(n);a=k(re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(a)!=="svelte-1xsr9lq"&&(a.textContent=r),o=B(re),ve(i.$$.fragment,re),re.forEach(_),c=B(we),d=k(we,"DIV",{class:!0});var he=C(d);f=k(he,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(f)!=="svelte-11aw8ub"&&(f.textContent=g),p=B(he),h=k(he,"INPUT",{class:!0,id:!0,type:!0}),he.forEach(_),N=B(we),y=k(we,"DIV",{class:!0});var Y=C(y);w=k(Y,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(w)!=="svelte-17p0yvw"&&(w.textContent=D),V=B(Y),ve(K.$$.fragment,Y),S=B(Y),I=k(Y,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(I)!=="svelte-1wr3nwv"&&(I.textContent=A),Y.forEach(_),we.forEach(_),E=B(ce),L=k(ce,"DIV",{class:!0});var ue=C(L);P=k(ue,"BUTTON",{class:!0});var Ee=C(P);ve(T.$$.fragment,Ee),Ee.forEach(_),ue.forEach(_),ce.forEach(_),O=B(se),U=k(se,"DIV",{class:!0});var fe=C(U);M=k(fe,"UL",{class:!0});var He=C(M);for(let $=0;$<G.length;$+=1)G[$].l(He);He.forEach(_),fe.forEach(_),se.forEach(_),this.h()},h(){m(a,"class","font-bold mr-4"),m(a,"for","middle-row"),m(n,"class","my-1 flex items-center justify-between mr-2"),m(f,"class","font-bold mr-4"),m(f,"for","custom-layout"),m(h,"class","h-[20px]"),m(h,"id","custom-layout"),m(h,"type","checkbox"),h.checked=v=s[0].useCustom,m(d,"class","my-1 flex items-center"),m(w,"class","font-bold mr-4"),m(w,"for","two-rows"),m(I,"class","font-bold ml-4"),m(I,"for","two-rows"),m(y,"class","my-1 flex items-center"),m(l,"class","options svelte-1av9wwd"),m(P,"class","rounded px-1 py-1 hover:bg-gray-200"),m(L,"class","flex items-center justify-center"),m(t,"class","flex justify-between"),m(M,"class","keyboard svelte-1av9wwd"),m(U,"class","flex flex-col"),m(e,"class",x=Te(`${s[11].class||""} relative`)+" svelte-1av9wwd")},m(H,se){R(H,e,se),u(e,t),u(t,l),u(l,n),u(n,a),u(n,o),be(i,n,null),u(l,c),u(l,d),u(d,f),u(d,p),u(d,h),u(l,N),u(l,y),u(y,w),u(y,V),be(K,y,null),u(y,S),u(y,I),u(t,E),u(t,L),u(L,P),be(T,P,null),u(e,O),u(e,U),u(U,M);for(let ce=0;ce<G.length;ce+=1)G[ce]&&G[ce].m(M,null);X=!0,ie||(Q=[W(h,"change",s[8]),W(P,"click",s[6])],ie=!0)},p(H,[se]){const ce={};se&524289&&(ce.$$scope={dirty:se,ctx:H}),i.$set(ce),(!X||se&1&&v!==(v=H[0].useCustom))&&(h.checked=v);const we={};if(se&4&&(we.checked=!H[2]),K.$set(we),se&538){z=de(H[1]);let re;for(re=0;re<z.length;re+=1){const he=Gl(H,z,re);G[re]?(G[re].p(he,se),F(G[re],1)):(G[re]=Kl(he),G[re].c(),F(G[re],1),G[re].m(M,null))}for(Fe(),re=z.length;re<G.length;re+=1)le(re);xe()}(!X||se&2048&&x!==(x=Te(`${H[11].class||""} relative`)+" svelte-1av9wwd"))&&m(e,"class",x)},i(H){if(!X){F(i.$$.fragment,H),F(K.$$.fragment,H),F(T.$$.fragment,H);for(let se=0;se<z.length;se+=1)F(G[se]);X=!0}},o(H){q(i.$$.fragment,H),q(K.$$.fragment,H),q(T.$$.fragment,H),G=G.filter(Boolean);for(let se=0;se<G.length;se+=1)q(G[se]);X=!1},d(H){H&&_(e),ke(i),ke(K),ke(T),Ve(G,H),ie=!1,Ye(Q)}}}function ca(s,e,t){let l,n,a,r,o;pe(s,ct,v=>t(0,a=v)),pe(s,ra,v=>t(1,r=v)),pe(s,Ct,v=>t(4,o=v)),pn(()=>{ut.setLayout(navigator.languages)});const i=Object.entries(Ss).map(([v,N])=>({key:v,value:N.name}));function c(){ut.reset(),ut.setLayout(navigator.languages)}function d(v){return ut.setLayout([v]),!1}function f(v){ut.setCustomLayout(v.currentTarget.checked)}function g(v){ut.captureHotkeyRow(v)}function p(){ut.toggleRows()}const h=v=>g(v);return s.$$set=v=>{t(11,e=Ae(Ae({},e),Se(v)))},s.$$.update=()=>{s.$$.dirty&3&&t(3,l=r.map((v,N)=>a.kbdOpts.hotkeydRows==="middle-row"?N===1||N===2:!0)),s.$$.dirty&1&&t(2,n=a.kbdOpts.hotkeydRows==="middle-row")},e=Se(e),[a,r,n,l,o,i,c,d,f,g,p,e,h]}class ua extends $e{constructor(e){super(),qe(this,e,ca,ia,We,{})}}function Fl(s){let e,t;return e=new ua({props:{class:"mt-4"}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){q(e.$$.fragment,l),t=!1},d(l){ke(e,l)}}}function fa(s){let e,t,l,n,a="I/O",r,o,i,c,d,f,g,p,h="Device",v,N,y,w,D,V,K="Prompt",S,I,A="Disable",E,L,P,T,O="Sound",U,M,x,X,ie,Q,z="Fixed velocity",G,le,H,se,ce,we,re="Keyboard",he,Y,ue,Ee,fe,He,$="Hotkeys",ae,ye,tt,ne,Oe,Me,pt="Auto-octave",St,ze,Re,Nt,st,Je,Ks=" ",_s,Lt,gt,Fs="Set hotkeys",ps,vt,bt,xs="Fade timeout",gs,it,vs,xt,Xe,bs,Hs;c=new Ue({props:{icon:Ft,width:16}});let Be=s[2]&&!s[4]&&Fl();return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=a,r=j(),o=b("div"),i=b("button"),ge(c.$$.fragment),d=j(),f=b("div"),g=b("div"),p=b("label"),p.textContent=h,v=j(),N=b("input"),w=j(),D=b("div"),V=b("button"),V.textContent=K,S=j(),I=b("button"),I.textContent=A,E=j(),L=b("div"),P=b("div"),T=b("label"),T.textContent=O,U=j(),M=b("input"),X=j(),ie=b("div"),Q=b("label"),Q.textContent=z,G=j(),le=b("input"),H=j(),se=b("div"),ce=b("div"),we=b("label"),we.textContent=re,he=j(),Y=b("input"),Ee=j(),fe=b("div"),He=b("label"),He.textContent=$,ae=j(),ye=b("input"),ne=j(),Oe=b("div"),Me=b("label"),Me.textContent=pt,St=j(),ze=b("input"),Nt=j(),st=b("div"),Je=b("div"),Je.textContent=Ks,_s=j(),Lt=b("div"),gt=b("button"),gt.textContent=Fs,ps=j(),vt=b("div"),bt=b("label"),bt.textContent=xs,gs=j(),it=b("input"),vs=j(),Be&&Be.c(),this.h()},l(Ne){e=k(Ne,"DIV",{class:!0});var Ke=C(e);t=k(Ke,"FIELDSET",{class:!0});var rt=C(t);l=k(rt,"LEGEND",{class:!0});var zs=C(l);n=k(zs,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1jbbsti"&&(n.textContent=a),zs.forEach(_),r=B(rt),o=k(rt,"DIV",{class:!0});var $s=C(o);i=k($s,"BUTTON",{class:!0});var qs=C(i);ve(c.$$.fragment,qs),qs.forEach(_),$s.forEach(_),d=B(rt),f=k(rt,"DIV",{class:!0});var kt=C(f);g=k(kt,"DIV",{class:!0});var Dt=C(g);p=k(Dt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(p)!=="svelte-crpa7y"&&(p.textContent=h),v=B(Dt),N=k(Dt,"INPUT",{class:!0,id:!0}),w=B(Dt),D=k(Dt,"DIV",{class:!0});var Ht=C(D);V=k(Ht,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(V)!=="svelte-mj6mct"&&(V.textContent=K),S=B(Ht),I=k(Ht,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(I)!=="svelte-1sl6oxh"&&(I.textContent=A),Ht.forEach(_),Dt.forEach(_),E=B(kt),L=k(kt,"DIV",{class:!0});var zt=C(L);P=k(zt,"DIV",{class:!0});var $t=C(P);T=k($t,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(T)!=="svelte-wgxtkw"&&(T.textContent=O),U=B($t),M=k($t,"INPUT",{class:!0,id:!0,type:!0}),$t.forEach(_),X=B(zt),ie=k(zt,"DIV",{class:!0});var qt=C(ie);Q=k(qt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(Q)!=="svelte-1tm2bth"&&(Q.textContent=z),G=B(qt),le=k(qt,"INPUT",{class:!0,id:!0,placeholder:!0}),qt.forEach(_),zt.forEach(_),H=B(kt),se=k(kt,"DIV",{class:!0});var Pt=C(se);ce=k(Pt,"DIV",{class:!0});var Wt=C(ce);we=k(Wt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(we)!=="svelte-1js269u"&&(we.textContent=re),he=B(Wt),Y=k(Wt,"INPUT",{class:!0,id:!0,type:!0}),Wt.forEach(_),Ee=B(Pt),fe=k(Pt,"DIV",{class:!0});var Jt=C(fe);He=k(Jt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(He)!=="svelte-21h39k"&&(He.textContent=$),ae=B(Jt),ye=k(Jt,"INPUT",{class:!0,id:!0,type:!0}),Jt.forEach(_),ne=B(Pt),Oe=k(Pt,"DIV",{class:!0});var Qt=C(Oe);Me=k(Qt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(Me)!=="svelte-33lczu"&&(Me.textContent=pt),St=B(Qt),ze=k(Qt,"INPUT",{class:!0,id:!0,type:!0}),Qt.forEach(_),Pt.forEach(_),Nt=B(kt),st=k(kt,"DIV",{class:!0});var Vt=C(st);Je=k(Vt,"DIV",{class:!0,"data-svelte-h":!0}),oe(Je)!=="svelte-dgefms"&&(Je.textContent=Ks),_s=B(Vt),Lt=k(Vt,"DIV",{class:!0});var Ws=C(Lt);gt=k(Ws,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(gt)!=="svelte-1v9okg9"&&(gt.textContent=Fs),Ws.forEach(_),ps=B(Vt),vt=k(Vt,"DIV",{class:!0});var Yt=C(vt);bt=k(Yt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(bt)!=="svelte-vd5i27"&&(bt.textContent=xs),gs=B(Yt),it=k(Yt,"INPUT",{class:!0,id:!0}),Yt.forEach(_),Vt.forEach(_),kt.forEach(_),vs=B(rt),Be&&Be.l(rt),rt.forEach(_),Ke.forEach(_),this.h()},h(){var Ne;m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(i,"class","rounded px-1 py-1 hover:bg-gray-200"),m(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center"),J(o,"hidden",s[4]),m(p,"class","font-bold"),m(p,"for","device"),m(N,"class","px-1 my-1 rounded w-50"),m(N,"id","device"),N.disabled=!0,N.value=y=((Ne=s[5])==null?void 0:Ne.name)??"No device",m(V,"class","btn-sm primary mr-2"),m(I,"class","btn-sm primary"),m(D,"class","flex my-[auto]"),m(g,"class","h-full flex flex-col"),m(T,"class","font-bold"),m(T,"for","sound"),m(M,"class","h-[20px]"),m(M,"id","sound"),m(M,"type","checkbox"),M.checked=x=s[3].useSound,m(P,"class","my-1 flex justify-between mr-12"),m(Q,"class","font-bold"),m(Q,"for","fixed-velocity"),m(le,"class","h-[20px] w-16"),m(le,"id","fixed-velocity"),m(le,"placeholder","0-127"),m(ie,"class","flex justify-between"),m(L,"class","flex flex-col h-full"),m(we,"class","font-bold"),m(we,"for","keyboard"),m(Y,"class","h-[20px]"),m(Y,"id","keyboard"),m(Y,"type","checkbox"),Y.checked=ue=s[3].useKeyboard,m(ce,"class","my-1 flex justify-between mr-12"),m(He,"class","font-bold"),m(He,"for","hotkeys"),m(ye,"class","h-[20px]"),m(ye,"id","hotkeys"),m(ye,"type","checkbox"),ye.checked=tt=s[3].useHotkeys,m(fe,"class","my-1 flex justify-between mr-12"),m(Me,"class","font-bold"),m(Me,"for","auto-octave"),m(ze,"class","h-[20px]"),m(ze,"id","auto-octave"),m(ze,"type","checkbox"),ze.checked=Re=s[3].useAutoOctave,m(Oe,"class","my-1 flex justify-between mr-12"),m(se,"class","flex flex-col h-full"),m(Je,"class","h-[28px]"),m(gt,"class","w-full btn-sm primary"),m(Lt,"class","my-[2px] flex justify-between"),m(bt,"class","font-bold"),m(bt,"for","fade-timeout"),m(it,"class","h-[20px] w-16"),m(it,"id","fade-timeout"),it.value=s[1],m(vt,"class","my-1 flex justify-between"),m(st,"class","flex flex-col h-full"),m(f,"class","body svelte-1bpw69s"),J(f,"hidden",s[4]),m(t,"class","relative flex flex-col max-w-full rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),J(t,"collapsed",s[4]),m(e,"class",xt=Te(`${s[11].class||""}`)+" svelte-1bpw69s")},m(Ne,Ke){R(Ne,e,Ke),u(e,t),u(t,l),u(l,n),u(t,r),u(t,o),u(o,i),be(c,i,null),u(t,d),u(t,f),u(f,g),u(g,p),u(g,v),u(g,N),u(g,w),u(g,D),u(D,V),u(D,S),u(D,I),u(f,E),u(f,L),u(L,P),u(P,T),u(P,U),u(P,M),u(L,X),u(L,ie),u(ie,Q),u(ie,G),u(ie,le),et(le,s[0]),u(f,H),u(f,se),u(se,ce),u(ce,we),u(ce,he),u(ce,Y),u(se,Ee),u(se,fe),u(fe,He),u(fe,ae),u(fe,ye),u(se,ne),u(se,Oe),u(Oe,Me),u(Oe,St),u(Oe,ze),u(f,Nt),u(f,st),u(st,Je),u(st,_s),u(st,Lt),u(Lt,gt),u(st,ps),u(st,vt),u(vt,bt),u(vt,gs),u(vt,it),u(t,vs),Be&&Be.m(t,null),Xe=!0,bs||(Hs=[W(n,"click",s[7]),W(i,"click",s[10]),W(V,"click",je.openMidi),W(I,"click",je.disableMidi),W(M,"change",s[12]),W(le,"input",s[13]),W(le,"change",s[8]),W(Y,"change",s[14]),W(ye,"change",s[15]),W(ze,"change",s[16]),W(gt,"click",s[17]),W(it,"input",s[9])],bs=!0)},p(Ne,[Ke]){var rt;(!Xe||Ke&16)&&J(o,"hidden",Ne[4]),(!Xe||Ke&32&&y!==(y=((rt=Ne[5])==null?void 0:rt.name)??"No device")&&N.value!==y)&&(N.value=y),(!Xe||Ke&8&&x!==(x=Ne[3].useSound))&&(M.checked=x),Ke&1&&le.value!==Ne[0]&&et(le,Ne[0]),(!Xe||Ke&8&&ue!==(ue=Ne[3].useKeyboard))&&(Y.checked=ue),(!Xe||Ke&8&&tt!==(tt=Ne[3].useHotkeys))&&(ye.checked=tt),(!Xe||Ke&8&&Re!==(Re=Ne[3].useAutoOctave))&&(ze.checked=Re),(!Xe||Ke&2&&it.value!==Ne[1])&&(it.value=Ne[1]),(!Xe||Ke&16)&&J(f,"hidden",Ne[4]),Ne[2]&&!Ne[4]?Be?Ke&20&&F(Be,1):(Be=Fl(),Be.c(),F(Be,1),Be.m(t,null)):Be&&(Fe(),q(Be,1,1,()=>{Be=null}),xe()),(!Xe||Ke&16)&&J(t,"collapsed",Ne[4]),(!Xe||Ke&2048&&xt!==(xt=Te(`${Ne[11].class||""}`)+" svelte-1bpw69s"))&&m(e,"class",xt)},i(Ne){Xe||(F(c.$$.fragment,Ne),F(Be),Xe=!0)},o(Ne){q(c.$$.fragment,Ne),q(Be),Xe=!1},d(Ne){Ne&&_(e),ke(c),Be&&Be.d(),bs=!1,Ye(Hs)}}}function da(s,e,t){let l,n,a;pe(s,nt,V=>t(3,l=V)),pe(s,us,V=>t(5,a=V));const r=_t(Ge(!1),{key:"inputs-hidden"});pe(s,r,V=>t(4,n=V));let o=l.fixedVelocity??"",i=l.keyFadeTimeout,c=!1;nt.subscribe(V=>{t(0,o=V.fixedVelocity??""),t(1,i=V.keyFadeTimeout)});function d(){r.update(V=>!V)}function f(V){const{value:K}=V.currentTarget;let S;if(K)try{S=parseInt(K)}catch{}S!==void 0&&S>=0&&S<=127?je.setInputValue("fixedVelocity",S):K?t(0,o=l.fixedVelocity||""):je.setInputValue("fixedVelocity",void 0)}function g(V){try{const K=parseInt(V.currentTarget.value);je.setInputValue("keyFadeTimeout",K)}catch{t(1,i=l.keyFadeTimeout)}}function p(){je.setInputValue("useSound",!0),je.setInputValue("fixedVelocity",void 0),je.setInputValue("useKeyboard",!0),je.setInputValue("useHotkeys",!0),je.setInputValue("useAutoOctave",!0),je.setInputValue("keyFadeTimeout",1500)}const h=V=>je.setInputValue("useSound",V.currentTarget.checked);function v(){o=this.value,t(0,o)}const N=V=>je.setInputValue("useKeyboard",V.currentTarget.checked),y=V=>je.setInputValue("useHotkeys",V.currentTarget.checked),w=V=>je.setInputValue("useAutoOctave",V.currentTarget.checked),D=()=>t(2,c=!c);return s.$$set=V=>{t(11,e=Ae(Ae({},e),Se(V)))},e=Se(e),[o,i,c,l,n,a,r,d,f,g,p,e,h,v,N,y,w,D]}class ha extends $e{constructor(e){super(),qe(this,e,da,fa,We,{})}}function ma(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){R(t,e,l)},p:_e,d(t){t&&_(e)}}}function _a(s){let e,t=s[1].note+"",l;return{c(){e=Z("Input: "),l=Z(t)},l(n){e=ee(n,"Input: "),l=ee(n,t)},m(n,a){R(n,e,a),R(n,l,a)},p(n,a){a&2&&t!==(t=n[1].note+"")&&me(l,t)},d(n){n&&(_(e),_(l))}}}function pa(s){let e,t;return{c(){e=Z("Input: "),t=Z(s[0])},l(l){e=ee(l,"Input: "),t=ee(l,s[0])},m(l,n){R(l,e,n),R(l,t,n)},p(l,n){n&1&&me(t,l[0])},d(l){l&&(_(e),_(t))}}}function ga(s){let e;return{c(){e=Z(Ns)},l(t){e=ee(t,Ns)},m(t,l){R(t,e,l)},p:_e,d(t){t&&_(e)}}}function va(s){let e,t,l,n;function a(i,c){return i[2].useKeyboard&&Ns?ga:i[2].useKeyboard&&i[0]?pa:i[2].useKeyboard&&i[1]?_a:ma}let r=a(s),o=r(s);return{c(){e=b("div"),o.c(),this.h()},l(i){e=k(i,"DIV",{class:!0});var c=C(e);o.l(c),c.forEach(_),this.h()},h(){m(e,"class",t=`${s[4].class||""}`)},m(i,c){R(i,e,c),o.m(e,null),l||(n=W(window,"keydown",s[3]),l=!0)},p(i,[c]){r===(r=a(i))&&o?o.p(i,c):(o.d(1),o=r(i),o&&(o.c(),o.m(e,null))),c&16&&t!==(t=`${i[4].class||""}`)&&m(e,"class",t)},i:_e,o:_e,d(i){i&&_(e),o.d(),l=!1,n()}}}let Ns="";function ba(s,e,t){let l;pe(s,nt,c=>t(2,l=c));let{debounced:n}=e,a="",r;const o=Ln();function i(c){const d=c.target;if(n||!(d instanceof HTMLElement)||d.tagName==="INPUT")return;const f=ut.handleInput(c.code,c.key,c.shiftKey);f&&f.e==="note"?t(1,r=f.data):f&&f.e==="string"?t(0,a=f.data):f&&(f.e==="guessed-key"||f.e==="guessed-chord"||f.e==="guessed-note")?(t(0,a=""),t(1,r=void 0),o(f.e,f.data),c.code==="Enter"&&c.preventDefault()):f&&c.preventDefault()}return s.$$set=c=>{t(4,e=Ae(Ae({},e),Se(c))),"debounced"in c&&t(5,n=c.debounced)},e=Se(e),[a,r,l,i,e,n]}class ka extends $e{constructor(e){super(),qe(this,e,ba,va,We,{debounced:5})}}function ya(s){let e,t,l,n="Count",a,r,o,i,c,d="Duplicates",f,g,p,h,v,N,y="Autoplay",w,D,V,K,S,I,A="Wait seconds",E,L,P,T,O;return{c(){e=b("ul"),t=b("li"),l=b("label"),l.textContent=n,a=j(),r=b("input"),o=j(),i=b("li"),c=b("label"),c.textContent=d,f=j(),g=b("input"),h=j(),v=b("li"),N=b("label"),N.textContent=y,w=j(),D=b("input"),K=j(),S=b("li"),I=b("label"),I.textContent=A,E=j(),L=b("input"),this.h()},l(U){e=k(U,"UL",{class:!0});var M=C(e);t=k(M,"LI",{class:!0});var x=C(t);l=k(x,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(l)!=="svelte-wgq9fc"&&(l.textContent=n),a=B(x),r=k(x,"INPUT",{class:!0,id:!0,type:!0}),x.forEach(_),o=B(M),i=k(M,"LI",{class:!0});var X=C(i);c=k(X,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(c)!=="svelte-hcg9dq"&&(c.textContent=d),f=B(X),g=k(X,"INPUT",{class:!0,id:!0,type:!0}),X.forEach(_),h=B(M),v=k(M,"LI",{class:!0});var ie=C(v);N=k(ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(N)!=="svelte-lr68n2"&&(N.textContent=y),w=B(ie),D=k(ie,"INPUT",{class:!0,id:!0,type:!0}),ie.forEach(_),K=B(M),S=k(M,"LI",{class:!0});var Q=C(S);I=k(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(I)!=="svelte-1qj2vcy"&&(I.textContent=A),E=B(Q),L=k(Q,"INPUT",{class:!0,id:!0,type:!0}),Q.forEach(_),M.forEach(_),this.h()},h(){m(l,"class","font-bold"),m(l,"for","guess-count"),m(r,"class","h-[20px] w-10"),m(r,"id","guess-count"),m(r,"type","number"),m(t,"class","flex items-center justify-between svelte-1elvih2"),m(c,"class","font-bold"),m(c,"for","duplicates"),m(g,"class","h-[20px]"),m(g,"id","duplicates"),m(g,"type","checkbox"),g.checked=p=s[2].duplicates,m(i,"class","flex items-center justify-between mr-6 svelte-1elvih2"),m(N,"class","font-bold"),m(N,"for","autoplay"),m(D,"class","h-[20px]"),m(D,"id","autoplay"),m(D,"type","checkbox"),D.checked=V=s[2].autoplay,m(v,"class","flex items-center justify-between mr-6 svelte-1elvih2"),m(I,"class","font-bold"),m(I,"for","wait-ms"),m(L,"class","h-[20px] w-10"),m(L,"id","wait-ms"),m(L,"type","number"),m(S,"class","flex items-center justify-between svelte-1elvih2"),m(e,"class",P=Te(`${s[5].class||""}`)+" svelte-1elvih2")},m(U,M){R(U,e,M),u(e,t),u(t,l),u(t,a),u(t,r),et(r,s[0]),u(e,o),u(e,i),u(i,c),u(i,f),u(i,g),u(e,h),u(e,v),u(v,N),u(v,w),u(v,D),u(e,K),u(e,S),u(S,I),u(S,E),u(S,L),et(L,s[1]),T||(O=[W(r,"input",s[6]),W(r,"input",s[3]),W(g,"input",s[7]),W(D,"input",s[8]),W(L,"input",s[9]),W(L,"input",s[4])],T=!0)},p(U,[M]){M&1&&as(r.value)!==U[0]&&et(r,U[0]),M&4&&p!==(p=U[2].duplicates)&&(g.checked=p),M&4&&V!==(V=U[2].autoplay)&&(D.checked=V),M&2&&as(L.value)!==U[1]&&et(L,U[1]),M&32&&P!==(P=Te(`${U[5].class||""}`)+" svelte-1elvih2")&&m(e,"class",P)},i:_e,o:_e,d(U){U&&_(e),T=!1,Ye(O)}}}function Ea(s,e,t){let l;pe(s,mt,g=>t(2,l=g));let n=l.count||"",a=l.waitSeconds||"";mt.subscribe(g=>{t(0,n=g.count||""),t(1,a=g.waitSeconds||"")});function r({currentTarget:{value:g}}){let p;try{p=parseInt(g),p<=0&&(p=1),De.setOptionValue("count",p)}catch{t(0,n=l.count)}}function o({currentTarget:{value:g}}){let p;try{p=parseInt(g),p<0&&(p=0),De.setOptionValue("waitSeconds",p)}catch{t(1,a=l.waitSeconds)}}function i(){n=as(this.value),t(0,n)}const c=g=>De.setOptionValue("duplicates",g.currentTarget.checked),d=g=>De.setOptionValue("autoplay",g.currentTarget.checked);function f(){a=as(this.value),t(1,a)}return s.$$set=g=>{t(5,e=Ae(Ae({},e),Se(g)))},e=Se(e),[n,a,l,r,o,e,i,c,d,f]}class wa extends $e{constructor(e){super(),qe(this,e,Ea,ya,We,{})}}function xl(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l}function Hl(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l}function zl(s){let e,t,l=s[23]+"",n,a,r,o,i,c,d,f;function g(){return s[15](s[22])}o=new Ue({props:{icon:Cs,width:20}});function p(...h){return s[16](s[22],...h)}return{c(){e=b("li"),t=b("button"),n=Z(l),a=j(),r=b("button"),ge(o.$$.fragment),i=j(),this.h()},l(h){e=k(h,"LI",{class:!0});var v=C(e);t=k(v,"BUTTON",{class:!0});var N=C(t);n=ee(N,l),N.forEach(_),a=B(v),r=k(v,"BUTTON",{class:!0});var y=C(r);ve(o.$$.fragment,y),y.forEach(_),i=B(v),v.forEach(_),this.h()},h(){m(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),J(t,"selected",s[22]===s[0]),m(r,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),m(e,"class","flex svelte-1okhpct")},m(h,v){R(h,e,v),u(e,t),u(t,n),u(e,a),u(e,r),be(o,r,null),u(e,i),c=!0,d||(f=[W(t,"click",g),W(r,"click",p)],d=!0)},p(h,v){s=h,(!c||v&17)&&J(t,"selected",s[22]===s[0])},i(h){c||(F(o.$$.fragment,h),c=!0)},o(h){q(o.$$.fragment,h),c=!1},d(h){h&&_(e),ke(o),d=!1,Ye(f)}}}function $l(s){let e,t=de(s[3]),l=[];for(let n=0;n<t.length;n+=1)l[n]=ql(xl(s,t,n));return{c(){e=b("ul");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=k(n,"UL",{class:!0});var a=C(e);for(let r=0;r<l.length;r+=1)l[r].l(a);a.forEach(_),this.h()},h(){m(e,"class","svelte-1okhpct")},m(n,a){R(n,e,a);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null)},p(n,a){if(a&138){t=de(n[3]);let r;for(r=0;r<t.length;r+=1){const o=xl(n,t,r);l[r]?l[r].p(o,a):(l[r]=ql(o),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function ql(s){let e,t,l=s[23]+"",n,a,r,o;function i(){return s[17](s[22])}return{c(){e=b("li"),t=b("button"),n=Z(l),a=j(),this.h()},l(c){e=k(c,"LI",{class:!0});var d=C(e);t=k(d,"BUTTON",{class:!0});var f=C(t);n=ee(f,l),f.forEach(_),a=B(d),d.forEach(_),this.h()},h(){m(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),J(t,"selected",s[22]===s[1]),m(e,"class","svelte-1okhpct")},m(c,d){R(c,e,d),u(e,t),u(t,n),u(e,a),r||(o=W(t,"click",i),r=!0)},p(c,d){s=c,d&8&&l!==(l=s[23]+"")&&me(n,l),d&10&&J(t,"selected",s[22]===s[1])},d(c){c&&_(e),r=!1,o()}}}function Ca(s){let e,t,l="Play",n,a,r,o,i,c,d,f,g,p,h="Reset",v,N,y,w,D=s[2]?"Quit":"Play",V,K,S,I,A,E=de(s[4]),L=[];for(let O=0;O<E.length;O+=1)L[O]=zl(Hl(s,E,O));const P=O=>q(L[O],1,1,()=>{L[O]=null});let T=(s[0]==="chords-write"||s[0]==="chords-play")&&$l(s);return d=new wa({props:{class:"game-options"}}),y=new Ue({props:{class:"mr-1",icon:s[2]?Ys:Cs,width:20}}),{c(){e=b("fieldset"),t=b("legend"),t.textContent=l,n=j(),a=b("div"),r=b("ul");for(let O=0;O<L.length;O+=1)L[O].c();o=j(),i=b("div"),T&&T.c(),c=j(),ge(d.$$.fragment),f=j(),g=b("div"),p=b("button"),p.textContent=h,v=j(),N=b("button"),ge(y.$$.fragment),w=j(),V=Z(D),this.h()},l(O){e=k(O,"FIELDSET",{class:!0});var U=C(e);t=k(U,"LEGEND",{class:!0,"data-svelte-h":!0}),oe(t)!=="svelte-1409tnk"&&(t.textContent=l),n=B(U),a=k(U,"DIV",{class:!0});var M=C(a);r=k(M,"UL",{class:!0});var x=C(r);for(let z=0;z<L.length;z+=1)L[z].l(x);x.forEach(_),o=B(M),i=k(M,"DIV",{class:!0});var X=C(i);T&&T.l(X),X.forEach(_),c=B(M),ve(d.$$.fragment,M),f=B(M),g=k(M,"DIV",{class:!0});var ie=C(g);p=k(ie,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(p)!=="svelte-10rv0bu"&&(p.textContent=h),v=B(ie),N=k(ie,"BUTTON",{class:!0});var Q=C(N);ve(y.$$.fragment,Q),w=B(Q),V=ee(Q,D),Q.forEach(_),ie.forEach(_),M.forEach(_),U.forEach(_),this.h()},h(){m(t,"class","px-1 text-base"),m(r,"class","games svelte-1okhpct"),m(i,"class","options svelte-1okhpct"),m(p,"class","w-full btn hover:bg-gray-200"),m(N,"class","w-full mt-2 flex items-center justify-center btn primary"),m(g,"class","h-full flex flex-col justify-end"),m(a,"class","body pb-2 h-full svelte-1okhpct"),m(e,"class",K=Te(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(O,U){R(O,e,U),u(e,t),u(e,n),u(e,a),u(a,r);for(let M=0;M<L.length;M+=1)L[M]&&L[M].m(r,null);u(a,o),u(a,i),T&&T.m(i,null),u(a,c),be(d,a,null),u(a,f),u(a,g),u(g,p),u(g,v),u(g,N),be(y,N,null),u(N,w),u(N,V),S=!0,I||(A=[W(p,"click",s[8]),W(N,"click",s[9])],I=!0)},p(O,[U]){if(U&113){E=de(O[4]);let x;for(x=0;x<E.length;x+=1){const X=Hl(O,E,x);L[x]?(L[x].p(X,U),F(L[x],1)):(L[x]=zl(X),L[x].c(),F(L[x],1),L[x].m(r,null))}for(Fe(),x=E.length;x<L.length;x+=1)P(x);xe()}O[0]==="chords-write"||O[0]==="chords-play"?T?T.p(O,U):(T=$l(O),T.c(),T.m(i,null)):T&&(T.d(1),T=null);const M={};U&4&&(M.icon=O[2]?Ys:Cs),y.$set(M),(!S||U&4)&&D!==(D=O[2]?"Quit":"Play")&&me(V,D),(!S||U&1024&&K!==(K=Te(`${O[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&m(e,"class",K)},i(O){if(!S){for(let U=0;U<E.length;U+=1)F(L[U]);F(d.$$.fragment,O),F(y.$$.fragment,O),S=!0}},o(O){L=L.filter(Boolean);for(let U=0;U<L.length;U+=1)q(L[U]);q(d.$$.fragment,O),q(y.$$.fragment,O),S=!1},d(O){O&&_(e),Ve(L,O),T&&T.d(),ke(d),ke(y),I=!1,Ye(A)}}}function Ta(s,e,t){let l,n,a,r,o,i,c;pe(s,Gs,S=>t(12,r=S)),pe(s,mt,S=>t(20,o=S)),pe(s,dt,S=>t(13,i=S)),pe(s,wt,S=>t(14,c=S));const d=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let f=d[4].key,g="maj-m";o.count,o.waitSeconds,mt.subscribe(S=>{S.count,S.waitSeconds});function p(S,I){if(I==="chords-write"||I==="chords-play"||I==="chords-diatonic"){let A=[];g==="selected"?A=r.filter(E=>E.selected):g==="all"?A=r:g==="maj-m"?A=r.filter(E=>E.suffixes[0]==="maj"||E.suffixes[0]==="m"):g==="seventh"&&(A=r.filter(E=>E.suffixes[0]==="maj7"||E.suffixes[0]==="m7"||E.suffixes[0]==="7"||E.suffixes[0]==="dim7"||E.suffixes[0]==="aug7")),De.play(I,{chords:A})}else De.play(I,void 0);S.currentTarget instanceof HTMLElement&&S.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function h(S){t(0,f=S)}function v(S,I){t(0,f=I),p(S,I)}function N(S){t(1,g=S)}function y(){De.clearGame(!0)}function w(S){l?De.clearGame():p(S,f)}const D=S=>h(S),V=(S,I)=>v(I,S),K=S=>N(S);return s.$$set=S=>{t(10,e=Ae(Ae({},e),Se(S)))},s.$$.update=()=>{s.$$.dirty&24576&&t(2,l=!!c&&i!=="ended"),s.$$.dirty&4096&&t(11,n=r.reduce((S,I)=>I.selected?S+1:S,0)),s.$$.dirty&2048&&t(3,a=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${n} chords`},{key:"all",value:"All"}])},e=Se(e),[f,g,l,a,d,h,v,N,y,w,e,n,r,i,c,D,V,K]}class Ia extends $e{constructor(e){super(),qe(this,e,Ta,Ca,We,{})}}function Wl(s,e,t){const l=s.slice();return l[7]=e[t],l}function Jl(s,e,t){const l=s.slice();return l[4]=e[t],l}function Aa(s){let e,t=de(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Ql(Wl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let a=0;a<l.length;a+=1)l[a].l(n);e=Pe()},m(n,a){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,a);R(n,e,a)},p(n,a){if(a&2){t=de(n[1]);let r;for(r=0;r<t.length;r+=1){const o=Wl(n,t,r);l[r]?l[r].p(o,a):(l[r]=Ql(o),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function Sa(s){let e,t=de(s[0].scaleNotes||[]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Yl(Jl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let a=0;a<l.length;a+=1)l[a].l(n);e=Pe()},m(n,a){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,a);R(n,e,a)},p(n,a){if(a&1){t=de(n[0].scaleNotes||[]);let r;for(r=0;r<t.length;r+=1){const o=Jl(n,t,r);l[r]?l[r].p(o,a):(l[r]=Yl(o),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function Ql(s){let e,t=s[7].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var a=C(e);l=ee(a,t),a.forEach(_),this.h()},h(){m(e,"class","svelte-my4m0t")},m(n,a){R(n,e,a),u(e,l)},p(n,a){a&2&&t!==(t=n[7].interval+"")&&me(l,t)},d(n){n&&_(e)}}}function Yl(s){let e,t=s[4].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var a=C(e);l=ee(a,t),a.forEach(_),this.h()},h(){m(e,"class","svelte-my4m0t")},m(n,a){R(n,e,a),u(e,l)},p(n,a){a&1&&t!==(t=n[4].note+"")&&me(l,t)},d(n){n&&_(e)}}}function Na(s){let e,t,l,n,a,r;function o(d,f){return d[0]?Sa:Aa}let i=o(s),c=i(s);return{c(){e=b("div"),t=b("button"),c.c(),this.h()},l(d){e=k(d,"DIV",{class:!0,title:!0});var f=C(e);t=k(f,"BUTTON",{class:!0});var g=C(t);c.l(g),g.forEach(_),f.forEach(_),this.h()},h(){m(t,"class","intervals svelte-my4m0t"),m(e,"class",l=`${s[2].class||""} `),m(e,"title",n=s[1].map(Xl).join("-"))},m(d,f){R(d,e,f),u(e,t),c.m(t,null),a||(r=W(t,"click",s[3]),a=!0)},p(d,[f]){i===(i=o(d))&&c?c.p(d,f):(c.d(1),c=i(d),c&&(c.c(),c.m(t,null))),f&4&&l!==(l=`${d[2].class||""} `)&&m(e,"class",l),f&2&&n!==(n=d[1].map(Xl).join("-"))&&m(e,"title",n)},i:_e,o:_e,d(d){d&&_(e),c.d(),a=!1,r()}}}const Xl=s=>s.interval;function La(s,e,t){let{scale:l,intervals:n}=e;function a(r){ds.call(this,s,r)}return s.$$set=r=>{t(2,e=Ae(Ae({},e),Se(r))),"scale"in r&&t(0,l=r.scale),"intervals"in r&&t(1,n=r.intervals)},e=Se(e),[l,n,e,a]}class An extends $e{constructor(e){super(),qe(this,e,La,Na,We,{scale:0,intervals:1})}}function Zl(s,e,t){const l=s.slice();return l[7]=e[t],l}function en(s,e,t){const l=s.slice();return l[4]=e[t],l}function Da(s){let e,t=de(s[0]),l=[];for(let n=0;n<t.length;n+=1)l[n]=tn(Zl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let a=0;a<l.length;a+=1)l[a].l(n);e=Pe()},m(n,a){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,a);R(n,e,a)},p(n,a){if(a&1){t=de(n[0]);let r;for(r=0;r<t.length;r+=1){const o=Zl(n,t,r);l[r]?l[r].p(o,a):(l[r]=tn(o),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function Pa(s){let e,t=de(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=sn(en(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let a=0;a<l.length;a+=1)l[a].l(n);e=Pe()},m(n,a){for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(n,a);R(n,e,a)},p(n,a){if(a&2){t=de(n[1]);let r;for(r=0;r<t.length;r+=1){const o=en(n,t,r);l[r]?l[r].p(o,a):(l[r]=sn(o),l[r].c(),l[r].m(e.parentNode,e))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function tn(s){let e,t,l=s[7].roman+"",n,a,r,o=s[7].suffix+"",i,c;return{c(){e=b("span"),t=b("span"),n=Z(l),a=j(),r=b("sup"),i=Z(o),c=j(),this.h()},l(d){e=k(d,"SPAN",{class:!0});var f=C(e);t=k(f,"SPAN",{class:!0});var g=C(t);n=ee(g,l),g.forEach(_),a=B(f),r=k(f,"SUP",{class:!0});var p=C(r);i=ee(p,o),p.forEach(_),c=B(f),f.forEach(_),this.h()},h(){m(t,"class","block"),m(r,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),J(r,"super-text",s[7].suffix.length>2),m(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(d,f){R(d,e,f),u(e,t),u(t,n),u(e,a),u(e,r),u(r,i),u(e,c)},p(d,f){f&1&&l!==(l=d[7].roman+"")&&me(n,l),f&1&&o!==(o=d[7].suffix+"")&&me(i,o),f&1&&J(r,"super-text",d[7].suffix.length>2)},d(d){d&&_(e)}}}function sn(s){let e,t,l=s[4]+"",n,a;return{c(){e=b("span"),t=b("span"),n=Z(l),a=j(),this.h()},l(r){e=k(r,"SPAN",{class:!0});var o=C(e);t=k(o,"SPAN",{});var i=C(t);n=ee(i,l),i.forEach(_),a=B(o),o.forEach(_),this.h()},h(){m(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(r,o){R(r,e,o),u(e,t),u(t,n),u(e,a)},p(r,o){o&2&&l!==(l=r[4]+"")&&me(n,l)},d(r){r&&_(e)}}}function Va(s){let e,t,l,n,a,r;function o(d,f){return d[1].length>0?Pa:Da}let i=o(s),c=i(s);return{c(){e=b("div"),t=b("button"),c.c(),this.h()},l(d){e=k(d,"DIV",{class:!0,title:!0});var f=C(e);t=k(f,"BUTTON",{class:!0});var g=C(t);c.l(g),g.forEach(_),f.forEach(_),this.h()},h(){m(t,"class","triads flex flex-wrap svelte-1roj1mi"),m(e,"class",l=Te(`${s[2].class||""} `)+" svelte-1roj1mi"),m(e,"title",n=s[0].map(ln).join("-"))},m(d,f){R(d,e,f),u(e,t),c.m(t,null),a||(r=W(t,"click",s[3]),a=!0)},p(d,[f]){i===(i=o(d))&&c?c.p(d,f):(c.d(1),c=i(d),c&&(c.c(),c.m(t,null))),f&4&&l!==(l=Te(`${d[2].class||""} `)+" svelte-1roj1mi")&&m(e,"class",l),f&1&&n!==(n=d[0].map(ln).join("-"))&&m(e,"title",n)},i:_e,o:_e,d(d){d&&_(e),c.d(),a=!1,r()}}}const ln=s=>s.roman+s.suffix;function Oa(s,e,t){let{triads:l,chords:n}=e;function a(r){ds.call(this,s,r)}return s.$$set=r=>{t(2,e=Ae(Ae({},e),Se(r))),"triads"in r&&t(0,l=r.triads),"chords"in r&&t(1,n=r.chords)},e=Se(e),[l,n,e,a]}class Sn extends $e{constructor(e){super(),qe(this,e,Oa,Va,We,{triads:0,chords:1})}}function nn(s,e,t){const l=s.slice();return l[23]=e[t],l}function rn(s,e,t){const l=s.slice();return l[23]=e[t],l}function an(s){let e,t,l=s[23].raw.names[0]+"",n,a,r,o,i,c,d;function f(){return s[11](s[23])}r=new An({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),r.$on("click",f);function g(){return s[12](s[23])}return i=new Sn({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",g),{c(){e=b("li"),t=b("div"),n=Z(l),a=j(),ge(r.$$.fragment),o=j(),ge(i.$$.fragment),c=j(),this.h()},l(p){e=k(p,"LI",{class:!0});var h=C(e);t=k(h,"DIV",{class:!0});var v=C(t);n=ee(v,l),v.forEach(_),a=B(h),ve(r.$$.fragment,h),o=B(h),ve(i.$$.fragment,h),c=B(h),h.forEach(_),this.h()},h(){m(t,"class","text-xs font-bold"),m(e,"class","svelte-4hctsl")},m(p,h){R(p,e,h),u(e,t),u(t,n),u(e,a),be(r,e,null),u(e,o),be(i,e,null),u(e,c),d=!0},p(p,h){s=p,(!d||h&4)&&l!==(l=s[23].raw.names[0]+"")&&me(n,l);const v={};h&4&&(v.scale=s[23].scale),h&4&&(v.intervals=s[23].raw.intervals),r.$set(v);const N={};h&4&&(N.triads=s[23].triads),h&4&&(N.chords=s[23].triadChords),i.$set(N)},i(p){d||(F(r.$$.fragment,p),F(i.$$.fragment,p),d=!0)},o(p){q(r.$$.fragment,p),q(i.$$.fragment,p),d=!1},d(p){p&&_(e),ke(r),ke(i)}}}function on(s){let e,t,l=s[23].raw.names[0]+"",n,a,r,o,i,c,d;function f(){return s[13](s[23])}r=new An({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),r.$on("click",f);function g(){return s[14](s[23])}return i=new Sn({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",g),{c(){e=b("li"),t=b("div"),n=Z(l),a=j(),ge(r.$$.fragment),o=j(),ge(i.$$.fragment),c=j(),this.h()},l(p){e=k(p,"LI",{class:!0});var h=C(e);t=k(h,"DIV",{class:!0});var v=C(t);n=ee(v,l),v.forEach(_),a=B(h),ve(r.$$.fragment,h),o=B(h),ve(i.$$.fragment,h),c=B(h),h.forEach(_),this.h()},h(){m(t,"class","text-xs font-bold"),m(e,"class","svelte-4hctsl")},m(p,h){R(p,e,h),u(e,t),u(t,n),u(e,a),be(r,e,null),u(e,o),be(i,e,null),u(e,c),d=!0},p(p,h){s=p,(!d||h&2)&&l!==(l=s[23].raw.names[0]+"")&&me(n,l);const v={};h&2&&(v.scale=s[23].scale),h&2&&(v.intervals=s[23].raw.intervals),r.$set(v);const N={};h&2&&(N.triads=s[23].triads),h&2&&(N.chords=s[23].triadChords),i.$set(N)},i(p){d||(F(r.$$.fragment,p),F(i.$$.fragment,p),d=!0)},o(p){q(r.$$.fragment,p),q(i.$$.fragment,p),d=!1},d(p){p&&_(e),ke(r),ke(i)}}}function ja(s){let e,t,l,n,a="Scales",r,o,i,c="Key",d,f,g,p,h,v,N,y,w,D,V,K=de(s[2]),S=[];for(let P=0;P<K.length;P+=1)S[P]=an(rn(s,K,P));const I=P=>q(S[P],1,1,()=>{S[P]=null});let A=de(s[1]),E=[];for(let P=0;P<A.length;P+=1)E[P]=on(nn(s,A,P));const L=P=>q(E[P],1,1,()=>{E[P]=null});return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=a,r=j(),o=b("div"),i=b("label"),i.textContent=c,d=j(),f=b("input"),g=j(),p=b("div"),h=b("ul");for(let P=0;P<S.length;P+=1)S[P].c();v=j(),N=b("ul");for(let P=0;P<E.length;P+=1)E[P].c();this.h()},l(P){e=k(P,"DIV",{class:!0});var T=C(e);t=k(T,"FIELDSET",{class:!0});var O=C(t);l=k(O,"LEGEND",{class:!0});var U=C(l);n=k(U,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-lhx60e"&&(n.textContent=a),U.forEach(_),r=B(O),o=k(O,"DIV",{class:!0});var M=C(o);i=k(M,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(i)!=="svelte-14m38zf"&&(i.textContent=c),d=B(M),f=k(M,"INPUT",{class:!0,id:!0}),M.forEach(_),g=B(O),p=k(O,"DIV",{class:!0});var x=C(p);h=k(x,"UL",{class:!0});var X=C(h);for(let Q=0;Q<S.length;Q+=1)S[Q].l(X);X.forEach(_),v=B(x),N=k(x,"UL",{class:!0});var ie=C(N);for(let Q=0;Q<E.length;Q+=1)E[Q].l(ie);ie.forEach(_),x.forEach(_),O.forEach(_),T.forEach(_),this.h()},h(){m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(i,"class","mr-4 font-bold"),m(i,"for","scale-key"),m(f,"class","bg-gray-100 w-16 px-1 rounded"),m(f,"id","scale-key"),f.value=s[0],m(o,"class","flex mb-2 input svelte-4hctsl"),J(o,"hidden",s[3]),m(h,"class","list odd w-full svelte-4hctsl"),m(N,"class","list even w-full svelte-4hctsl"),m(p,"class","body max-h-[30rem] overflow-scroll svelte-4hctsl"),J(p,"hidden",s[3]),m(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),J(t,"collapsed",s[3]),m(e,"class",y=Te(`${s[9].class||""}`)+" svelte-4hctsl")},m(P,T){R(P,e,T),u(e,t),u(t,l),u(l,n),u(t,r),u(t,o),u(o,i),u(o,d),u(o,f),u(t,g),u(t,p),u(p,h);for(let O=0;O<S.length;O+=1)S[O]&&S[O].m(h,null);u(p,v),u(p,N);for(let O=0;O<E.length;O+=1)E[O]&&E[O].m(N,null);w=!0,D||(V=[W(n,"click",s[5]),W(f,"input",s[6])],D=!0)},p(P,[T]){if((!w||T&1&&f.value!==P[0])&&(f.value=P[0]),(!w||T&8)&&J(o,"hidden",P[3]),T&388){K=de(P[2]);let O;for(O=0;O<K.length;O+=1){const U=rn(P,K,O);S[O]?(S[O].p(U,T),F(S[O],1)):(S[O]=an(U),S[O].c(),F(S[O],1),S[O].m(h,null))}for(Fe(),O=K.length;O<S.length;O+=1)I(O);xe()}if(T&386){A=de(P[1]);let O;for(O=0;O<A.length;O+=1){const U=nn(P,A,O);E[O]?(E[O].p(U,T),F(E[O],1)):(E[O]=on(U),E[O].c(),F(E[O],1),E[O].m(N,null))}for(Fe(),O=A.length;O<E.length;O+=1)L(O);xe()}(!w||T&8)&&J(p,"hidden",P[3]),(!w||T&8)&&J(t,"collapsed",P[3]),(!w||T&512&&y!==(y=Te(`${P[9].class||""}`)+" svelte-4hctsl"))&&m(e,"class",y)},i(P){if(!w){for(let T=0;T<K.length;T+=1)F(S[T]);for(let T=0;T<A.length;T+=1)F(E[T]);w=!0}},o(P){S=S.filter(Boolean);for(let T=0;T<S.length;T+=1)q(S[T]);E=E.filter(Boolean);for(let T=0;T<E.length;T+=1)q(E[T]);w=!1},d(P){P&&_(e),Ve(S,P),Ve(E,P),D=!1,Ye(V)}}}function Ba(s,e,t){let l,n,a,r,o,i,c;pe(s,Mt,E=>t(17,a=E)),pe(s,It,E=>t(18,r=E)),pe(s,nt,E=>t(19,o=E)),pe(s,lt,E=>t(20,i=E));let f=hs().map(E=>({key:E.names[0],raw:E,scale:void 0,triads:E.triads,triadChords:[]})),g="",p=[r.key,r.scale],h;const v=_t(Ge(!0),{key:"scales-hidden"});pe(s,v,E=>t(3,c=E));function N(){v.update(E=>!E)}function y({currentTarget:{value:E}}){t(0,g=`${E.charAt(0).toUpperCase()}${E.charAt(1).toLowerCase()}`),t(10,f=f.map(L=>{const P=Rt(g,L.key),T=g&&"data"in P?P.data:void 0;let O=[];return T&&(O=L.triads.map((U,M)=>`${T.scaleNotes[M].note}${!U.suffix.includes("°")&&U.minor?"m":""}${U.suffix}`)),{...L,scale:T,triadChords:O}}))}function w(E,L,P){if(E<L.length){const T=L[E++];Le.setPlayed(T),i==null||i.playChord(T.map(O=>O.midi),o.fixedVelocity),h=setTimeout(()=>w(E,L,P),P)}else Le.setPlayed([]),Le.setKeyAndScale(p[0],p[1])}function D(E){clearTimeout(h);let L,P;E.scale?(P=E.scale,p=[r.key,r.scale],Le.setKeyAndScale(E.scale.key,E.scale.scale)):P=r;const T=a[0].midi+P.scaleNotes[0].semitones;L=E.raw.intervals.map(O=>[{...P.notesMap.get(O.semitones%12),midi:T+O.semitones}]),L[0][0].semitones!==L[L.length-1][0].semitones&&L.push(L[0].map(O=>({...O,midi:O.midi+12}))),w(0,L,500)}function V(E){clearTimeout(h);const{intervals:L}=E.raw;let P,T;E.scale?(T=E.scale,p=[r.key,r.scale],Le.setKeyAndScale(E.scale.key,E.scale.scale)):T=r;const O=a[0].midi+T.scaleNotes[0].semitones;P=yn(E.triads).map((M,x)=>ss(O+T.intervals[x].semitones,T,M.intervals)),L[L.length-1].interval_seq!==1&&P.push(P[0].map(M=>({...M,midi:M.midi+12}))),w(0,P,750)}const K=E=>D(E),S=E=>V(E),I=E=>D(E),A=E=>V(E);return s.$$set=E=>{t(9,e=Ae(Ae({},e),Se(E)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,l=f.filter((E,L)=>L<f.length/2)),s.$$.dirty&1024&&t(1,n=f.filter((E,L)=>L>=f.length/2))},e=Se(e),[g,n,l,c,v,N,y,D,V,e,f,K,S,I,A]}class Ga extends $e{constructor(e){super(),qe(this,e,Ba,ja,We,{})}}function cn(s,e,t){const l=s.slice();return l[26]=e[t],l}function un(s,e,t){const l=s.slice();return l[29]=e[t],l}function fn(s){let e,t;return{c(){e=b("div"),t=Z(s[3]),this.h()},l(l){e=k(l,"DIV",{class:!0});var n=C(e);t=ee(n,s[3]),n.forEach(_),this.h()},h(){m(e,"class","error svelte-1u7ze7x")},m(l,n){R(l,e,n),u(e,t)},p(l,n){n[0]&8&&me(t,l[3])},d(l){l&&_(e)}}}function dn(s){let e,t=de(s[5]),l=[];for(let n=0;n<t.length;n+=1)l[n]=hn(un(s,t,n));return{c(){e=b("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=k(n,"DIV",{class:!0});var a=C(e);for(let r=0;r<l.length;r+=1)l[r].l(a);a.forEach(_),this.h()},h(){m(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,a){R(n,e,a);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null)},p(n,a){if(a[0]&32){t=de(n[5]);let r;for(r=0;r<t.length;r+=1){const o=un(n,t,r);l[r]?l[r].p(o,a):(l[r]=hn(o),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function hn(s){let e,t=s[29].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var a=C(e);l=ee(a,t),a.forEach(_),this.h()},h(){m(e,"class","svelte-1u7ze7x")},m(n,a){R(n,e,a),u(e,l)},p(n,a){a[0]&32&&t!==(t=n[29].interval+"")&&me(l,t)},d(n){n&&_(e)}}}function mn(s){let e,t=de(s[8].scaleNotes),l=[];for(let n=0;n<t.length;n+=1)l[n]=_n(cn(s,t,n));return{c(){e=b("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=k(n,"DIV",{class:!0});var a=C(e);for(let r=0;r<l.length;r+=1)l[r].l(a);a.forEach(_),this.h()},h(){m(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,a){R(n,e,a);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null)},p(n,a){if(a[0]&256){t=de(n[8].scaleNotes);let r;for(r=0;r<t.length;r+=1){const o=cn(n,t,r);l[r]?l[r].p(o,a):(l[r]=_n(o),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(n){n&&_(e),Ve(l,n)}}}function _n(s){let e,t=s[26].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var a=C(e);l=ee(a,t),a.forEach(_),this.h()},h(){m(e,"class","svelte-1u7ze7x")},m(n,a){R(n,e,a),u(e,l)},p(n,a){a[0]&256&&t!==(t=n[26].note+"")&&me(l,t)},d(n){n&&_(e)}}}function Ma(s){let e,t,l,n="Score",a,r,o,i,c,d,f,g="Range",p,h,v,N,y,w="—",D,V,K,S,I,A,E,L="Scale",P,T,O,U,M,x,X,ie="Key",Q,z,G,le,H,se,ce,we;o=new Ue({props:{icon:Ft,width:16}});let re=s[3]&&fn(s);O=new gn({props:{class:"p-1 pl-[2px] w-48",containerClass:"w-48",selected:s[0],options:s[10],onSelect:s[14]}});let he=!s[7]&&dn(s),Y=!s[7]&&mn(s);return{c(){e=b("fieldset"),t=b("legend"),l=b("button"),l.textContent=n,a=j(),r=b("button"),ge(o.$$.fragment),i=j(),c=b("div"),d=b("div"),f=b("label"),f.textContent=g,p=j(),h=b("div"),v=b("input"),N=j(),y=b("span"),y.textContent=w,D=j(),V=b("input"),K=j(),S=b("div"),re&&re.c(),I=j(),A=b("div"),E=b("label"),E.textContent=L,P=j(),T=b("div"),ge(O.$$.fragment),U=j(),he&&he.c(),M=j(),x=b("div"),X=b("label"),X.textContent=ie,Q=j(),z=b("div"),G=b("input"),le=j(),Y&&Y.c(),this.h()},l(ue){e=k(ue,"FIELDSET",{class:!0});var Ee=C(e);t=k(Ee,"LEGEND",{class:!0});var fe=C(t);l=k(fe,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(l)!=="svelte-lqyol"&&(l.textContent=n),fe.forEach(_),a=B(Ee),r=k(Ee,"BUTTON",{class:!0});var He=C(r);ve(o.$$.fragment,He),He.forEach(_),i=B(Ee),c=k(Ee,"DIV",{class:!0});var $=C(c);d=k($,"DIV",{class:!0});var ae=C(d);f=k(ae,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(f)!=="svelte-10u0679"&&(f.textContent=g),p=B(ae),h=k(ae,"DIV",{class:!0});var ye=C(h);v=k(ye,"INPUT",{class:!0,id:!0}),N=B(ye),y=k(ye,"SPAN",{class:!0,"data-svelte-h":!0}),oe(y)!=="svelte-8q1xz4"&&(y.textContent=w),D=B(ye),V=k(ye,"INPUT",{class:!0,id:!0}),ye.forEach(_),K=B(ae),S=k(ae,"DIV",{class:!0});var tt=C(S);re&&re.l(tt),tt.forEach(_),ae.forEach(_),I=B($),A=k($,"DIV",{class:!0});var ne=C(A);E=k(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(E)!=="svelte-ld2d07"&&(E.textContent=L),P=B(ne),T=k(ne,"DIV",{class:!0});var Oe=C(T);ve(O.$$.fragment,Oe),Oe.forEach(_),U=B(ne),he&&he.l(ne),ne.forEach(_),M=B($),x=k($,"DIV",{class:!0});var Me=C(x);X=k(Me,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(X)!=="svelte-17pcm6g"&&(X.textContent=ie),Q=B(Me),z=k(Me,"DIV",{class:!0});var pt=C(z);G=k(pt,"INPUT",{class:!0,id:!0}),pt.forEach(_),le=B(Me),Y&&Y.l(Me),Me.forEach(_),$.forEach(_),Ee.forEach(_),this.h()},h(){m(l,"class","px-1 rounded hover:bg-gray-100"),m(t,"class","text-base"),m(r,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),J(r,"hidden",s[6]),m(f,"class","font-bold"),m(f,"for","range_min"),m(v,"class","h-[28px] w-full"),m(v,"id","range_min"),m(y,"class","mx-2 mt-1"),m(V,"class","h-[28px] w-full"),m(V,"id","range_max"),m(h,"class","my-1 flex w-full"),m(S,"class","flex justify-between my-1"),m(d,"class","flex flex-col h-full"),m(E,"class","font-bold"),m(E,"for","scales"),m(T,"class","my-1 w-full"),m(A,"class","flex flex-col h-full"),m(X,"class","font-bold"),m(X,"for","key"),m(G,"class","h-[28px]"),m(G,"id","key"),m(z,"class","my-1 flex"),m(x,"class","flex flex-col h-full"),m(c,"class","options svelte-1u7ze7x"),J(c,"hidden",s[6]),m(e,"class",H=Te(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),J(e,"collapsed",s[6])},m(ue,Ee){R(ue,e,Ee),u(e,t),u(t,l),u(e,a),u(e,r),be(o,r,null),u(e,i),u(e,c),u(c,d),u(d,f),u(d,p),u(d,h),u(h,v),et(v,s[1]),u(h,N),u(h,y),u(h,D),u(h,V),et(V,s[2]),u(d,K),u(d,S),re&&re.m(S,null),u(c,I),u(c,A),u(A,E),u(A,P),u(A,T),be(O,T,null),u(A,U),he&&he.m(A,null),u(c,M),u(c,x),u(x,X),u(x,Q),u(x,z),u(z,G),et(G,s[4]),u(x,le),Y&&Y.m(x,null),se=!0,ce||(we=[W(l,"click",s[15]),W(r,"click",s[16]),W(v,"input",s[18]),W(v,"change",s[19]),W(v,"focus",s[12]),W(V,"input",s[20]),W(V,"change",s[21]),W(V,"focus",s[12]),W(G,"input",s[22]),W(G,"input",s[13])],ce=!0)},p(ue,Ee){(!se||Ee[0]&64)&&J(r,"hidden",ue[6]),Ee[0]&2&&v.value!==ue[1]&&et(v,ue[1]),Ee[0]&4&&V.value!==ue[2]&&et(V,ue[2]),ue[3]?re?re.p(ue,Ee):(re=fn(ue),re.c(),re.m(S,null)):re&&(re.d(1),re=null);const fe={};Ee[0]&1&&(fe.selected=ue[0]),O.$set(fe),ue[7]?he&&(he.d(1),he=null):he?he.p(ue,Ee):(he=dn(ue),he.c(),he.m(A,null)),Ee[0]&16&&G.value!==ue[4]&&et(G,ue[4]),ue[7]?Y&&(Y.d(1),Y=null):Y?Y.p(ue,Ee):(Y=mn(ue),Y.c(),Y.m(x,null)),(!se||Ee[0]&64)&&J(c,"hidden",ue[6]),(!se||Ee[0]&131072&&H!==(H=Te(`${ue[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&m(e,"class",H),(!se||Ee[0]&131136)&&J(e,"collapsed",ue[6])},i(ue){se||(F(o.$$.fragment,ue),F(O.$$.fragment,ue),se=!0)},o(ue){q(o.$$.fragment,ue),q(O.$$.fragment,ue),se=!1},d(ue){ue&&_(e),ke(o),re&&re.d(),ke(O),he&&he.d(),Y&&Y.d(),ce=!1,Ye(we)}}}function Ua(s,e,t){let l,n,a,r,o,i;pe(s,Mt,T=>t(23,n=T)),pe(s,Tt,T=>t(24,a=T)),pe(s,wt,T=>t(7,o=T)),pe(s,It,T=>t(8,i=T));let c=ft(n[0]),d=ft(n[1]),f="";const g=_t(Ge(!1),{key:"score-options-hidden"});pe(s,g,T=>t(6,r=T));let p=a[0],h=a[1];const v=hs(),N=v.map(T=>({key:T.names[0],value:T.names[0]}));Mt.subscribe(T=>{t(1,c=ft(T[0])),t(2,d=ft(T[1]))}),Tt.subscribe(T=>{t(4,p=T[0]),t(0,h=T[1])});function y(T,O){const U=er(O.currentTarget.value,!0,!0);if("data"in U){const{midi:M}=U.data,x=n,X=[T==="min"?M:x[0].midi,T==="max"?M:x[1].midi];je.setMidiRange(X),t(3,f="")}else t(3,f=U.err),T==="min"?t(1,c=ft(n[0])):t(2,d=ft(n[1]))}function w(){t(3,f="")}function D({currentTarget:{value:T}}){t(4,p=`${T.charAt(0).toUpperCase()}${T.charAt(1).toLowerCase()}`),Le.setKey(p)}function V(T){var O;return t(0,h=(O=N.find(U=>T===U.key))==null?void 0:O.value),Le.setScale(h),!1}function K(){g.update(T=>!T)}function S(){Le.clearScore(!0),je.setMidiRange([60,84])}function I(){c=this.value,t(1,c)}const A=T=>y("min",T);function E(){d=this.value,t(2,d)}const L=T=>y("max",T);function P(){p=this.value,t(4,p)}return s.$$set=T=>{t(17,e=Ae(Ae({},e),Se(T)))},s.$$.update=()=>{var T;s.$$.dirty[0]&1&&t(5,l=((T=v.find(O=>O.names[0]===h))==null?void 0:T.intervals)||[])},e=Se(e),[h,c,d,f,p,l,r,o,i,g,N,y,w,D,V,K,S,e,I,A,E,L,P]}class Ra extends $e{constructor(e){super(),qe(this,e,Ua,Ma,We,{},null,[-1,-1])}}function Ka(s){s[21]=s[22].default}function Fa(s){return{c:_e,l:_e,m:_e,i:_e,o:_e,d:_e}}function xa(s){Ka(s);let e,t,l;var n=s[21];function a(r,o){return{props:{class:"mx-4 md:mx-0"}}}return n&&(e=Vn(n,a())),{c(){e&&ge(e.$$.fragment),t=Pe()},l(r){e&&ve(e.$$.fragment,r),t=Pe()},m(r,o){e&&be(e,r,o),R(r,t,o),l=!0},i(r){l||(e&&F(e.$$.fragment,r),l=!0)},o(r){e&&q(e.$$.fragment,r),l=!1},d(r){r&&_(t),e&&ke(e,r)}}}function Ha(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){R(t,e,l)},i:_e,o:_e,d(t){t&&_(e)}}}function za(s){let e,t,l,n,a="MIDI Note Trainer",r,o,i,c,d,f,g,p="Introduction",h,v,N,y,w,D,V,K,S,I,A,E,L,P,T,O,U,M,x,X,ie;c=new Ue({props:{icon:Ft,width:24}}),N=new ha({}),w=new Ga({}),V=new Cr({}),I=new Ra({props:{class:"score-options mr-4"}}),E=new Ia({props:{class:"play-form"}});let Q={ctx:s,current:null,token:null,hasCatch:!1,pending:Ha,then:xa,catch:Fa,value:22,blocks:[,,,]};return Dn(Ce(()=>import("./Score.e0a5cf83.js"),["./Score.e0a5cf83.js","./vendor_svelte.bbd2585b.js","./vendor.e9b0235c.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),Q),O=new ka({props:{class:"min-h-32",debounced:!!s[0]}}),O.$on("guessed-chord",s[2]),O.$on("guessed-key",s[3]),O.$on("guessed-note",s[4]),M=new Gr({props:{game:s[1]}}),{c(){e=b("meta"),t=j(),l=b("h1"),n=b("a"),n.textContent=a,r=j(),o=b("div"),i=b("button"),ge(c.$$.fragment),d=j(),f=b("div"),g=b("button"),g.textContent=p,h=j(),v=b("section"),ge(N.$$.fragment),y=j(),ge(w.$$.fragment),D=j(),ge(V.$$.fragment),K=j(),S=b("div"),ge(I.$$.fragment),A=j(),ge(E.$$.fragment),L=j(),Q.block.c(),P=j(),T=b("section"),ge(O.$$.fragment),U=j(),ge(M.$$.fragment),this.h()},l(z){const G=Pn("svelte-1w2oado",document.head);e=k(G,"META",{name:!0,content:!0}),G.forEach(_),t=B(z),l=k(z,"H1",{class:!0});var le=C(l);n=k(le,"A",{class:!0,href:!0,"data-svelte-h":!0}),oe(n)!=="svelte-km4jns"&&(n.textContent=a),r=B(le),o=k(le,"DIV",{class:!0});var H=C(o);i=k(H,"BUTTON",{class:!0});var se=C(i);ve(c.$$.fragment,se),se.forEach(_),H.forEach(_),le.forEach(_),d=B(z),f=k(z,"DIV",{class:!0});var ce=C(f);g=k(ce,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(g)!=="svelte-f34gar"&&(g.textContent=p),ce.forEach(_),h=B(z),v=k(z,"SECTION",{class:!0});var we=C(v);ve(N.$$.fragment,we),y=B(we),ve(w.$$.fragment,we),D=B(we),ve(V.$$.fragment,we),K=B(we),S=k(we,"DIV",{class:!0});var re=C(S);ve(I.$$.fragment,re),A=B(re),ve(E.$$.fragment,re),re.forEach(_),we.forEach(_),L=B(z),Q.block.l(z),P=B(z),T=k(z,"SECTION",{class:!0});var he=C(T);ve(O.$$.fragment,he),U=B(he),ve(M.$$.fragment,he),he.forEach(_),this.h()},h(){m(e,"name","description"),m(e,"content","App to practise music notation, scales and chords using MIDI"),m(n,"class","hover:underline"),m(n,"href","https://github.com/TeemuKoivisto/midi-note-trainer"),m(i,"class","rounded p-2 hover:bg-gray-200"),m(o,"class","flex items-center justify-center"),m(l,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight flex items-center justify-between"),m(g,"class","btn-pill border-2 border-gray-300 hover:bg-gray-200"),m(f,"class","px-4 md:px-0"),m(S,"class","play svelte-qjpqy3"),m(v,"class","mx-4 md:mx-0"),m(T,"class","mb-8 ml-16 flex flex-col")},m(z,G){u(document.head,e),R(z,t,G),R(z,l,G),u(l,n),u(l,r),u(l,o),u(o,i),be(c,i,null),R(z,d,G),R(z,f,G),u(f,g),R(z,h,G),R(z,v,G),be(N,v,null),u(v,y),be(w,v,null),u(v,D),be(V,v,null),u(v,K),u(v,S),be(I,S,null),u(S,A),be(E,S,null),R(z,L,G),Q.block.m(z,Q.anchor=G),Q.mount=()=>P.parentNode,Q.anchor=P,R(z,P,G),R(z,T,G),be(O,T,null),u(T,U),be(M,T,null),x=!0,X||(ie=[W(i,"click",s[5]),W(g,"click",s[6])],X=!0)},p(z,[G]){s=z;const le={};G&1&&(le.debounced=!!s[0]),O.$set(le);const H={};G&2&&(H.game=s[1]),M.$set(H)},i(z){x||(F(c.$$.fragment,z),F(N.$$.fragment,z),F(w.$$.fragment,z),F(V.$$.fragment,z),F(I.$$.fragment,z),F(E.$$.fragment,z),F(Q.block),F(O.$$.fragment,z),F(M.$$.fragment,z),x=!0)},o(z){q(c.$$.fragment,z),q(N.$$.fragment,z),q(w.$$.fragment,z),q(V.$$.fragment,z),q(I.$$.fragment,z),q(E.$$.fragment,z);for(let G=0;G<3;G+=1){const le=Q.blocks[G];q(le)}q(O.$$.fragment,z),q(M.$$.fragment,z),x=!1},d(z){z&&(_(t),_(l),_(d),_(f),_(h),_(v),_(L),_(P),_(T)),_(e),ke(c),ke(N),ke(w),ke(V),ke(I),ke(E),Q.block.d(z),Q.token=null,Q=null,ke(O),ke(M),X=!1,Ye(ie)}}}function $a(s,e,t){let l,n,a,r,o,i;pe(s,dt,I=>t(9,l=I)),pe(s,wt,I=>t(1,n=I)),pe(s,mt,I=>t(10,a=I)),pe(s,nt,I=>t(11,r=I)),pe(s,lt,I=>t(12,o=I)),pe(s,Is,I=>t(13,i=I));let c,d;pn(()=>(i&&V(),window.addEventListener("keydown",f),window.addEventListener("mousedown",f),window.addEventListener("touchstart",f),()=>{window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)})),us.subscribe(I=>{I&&I.channels[1].addListener("noteon",g)});function f(){je.initAudio(),window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)}function g(I){if(c)return;const A=I.rawData;p(A[1],A[2])}function p(I,A){const E=n;E instanceof jt&&!(E!=null&&E.ended)&&l==="waiting"?N(I):E instanceof ht&&!(E!=null&&E.ended)&&l==="waiting"?(E.addPlayedNote(I),d||(d=setTimeout(v,2e3))):E||Le.pushPlayed(I),o&&o.noteOn(I,r.fixedVelocity??A)}function h(){a.autoplay&&a.waitSeconds>0?t(0,c=setTimeout(()=>{a.autoplay&&De.nextGuess(),t(0,c=void 0)},a.waitSeconds*1e3)):a.autoplay?De.nextGuess():t(0,c=void 0)}function v(){var A;const I=n;if(I instanceof ht){const E=I.guess();Le.setPlayed(((A=I.latestGuess.guessed)==null?void 0:A.notes)||[],E,-1),De.updateState(E?"correct":"wrong"),h()}d=void 0}function N(I){const A=n;if(A instanceof jt&&l==="waiting"){Le.setTarget([Le.getNote(A.current)]);const E=A.guess(I);De.updateState(E?"correct":"wrong"),Le.pushPlayed(I,E,4e3),h()}}function y(I){const A=n;if(A instanceof ht&&l==="waiting"){const E=A.guessWrittenChord(I.detail);De.updateState(E?"correct":"wrong"),h()}}function w(I){const A=n;if(A instanceof Kt&&l==="waiting"){const E=I.detail.replaceAll("♭","b").replaceAll("♯","#"),L=A.guess(E);De.updateState(L?"correct":"wrong"),h()}}function D(I){const A=ut.findNote(I.detail.note)??js(I.detail.note);A&&p(A.semitones+12+I.detail.octave*12,80)}async function V(){const I=await je.openMidi();"data"in I?I.data.name:(I.err,console.error(I.err))}function K(){ar(),window.location.reload()}return[c,n,y,w,D,K,()=>Gn.open("introduction",void 0)]}class Ya extends $e{constructor(e){super(),qe(this,e,$a,za,We,{})}}export{nl as F,ht as G,Ya as P,zn as S,jt as a,De as b,wt as c,yt as d,cs as e,dt as g,lt as p,It as s,il as t};
