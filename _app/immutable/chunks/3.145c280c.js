import{_ as Ce}from"./preload-helper.a4192956.js";import{S as We,i as qe,s as Je,e as b,n as j,a as y,b as C,p as B,d as p,f as m,Z as Te,N as $,g as U,h as u,_ as et,q as J,t as x,F as xe,l as q,y as Fe,$ as Qe,Q as Ae,R as Se,c as Vs,a0 as de,u as Os,j as js,k as Bs,V as ns,W as wt,X as os,a1 as rs,a2 as Ve,x as Pe,H as Gs,B as Z,C as ee,D as pe,r as me,O as Re,J as ge,K as ve,L as be,M as ye,m as Ie,T as Rt,w as Oe,a3 as Pn,o as ae,P as _e,a4 as hs,v as bn,a5 as Vn,a6 as as,a7 as On,a8 as jn,I as Bn}from"./vendor_svelte.a22c6d08.js";import{w as Zt,c as Gn,e as Mn,f as Qs,g as Xs,h as Ft,i as is,j as cs,k as Bt,l as Gt,m as Rn,a as Zs,n as As}from"./vendor.e9b0235c.js";import{a as Un}from"./modal.53615654.js";function el(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l[24]=e[t].icon,l[26]=t,l}const Kn=s=>({}),tl=s=>({});function sl(s){let e,t,l,n,r,o,a,c,i,d,f;const g=s[17].header,_=Vs(g,s,s[16],tl);let h=de(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=nl(el(s,h,k));const N=k=>q(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),l=j(),n=b("ul"),r=b("li"),_&&_.c(),o=j();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(p),l=B(k),n=y(k,"UL",{class:!0});var E=C(n);r=y(E,"LI",{});var L=C(r);_&&_.l(L),L.forEach(p),o=B(E);for(let V=0;V<v.length;V+=1)v[V].l(E);E.forEach(p),this.h()},h(){m(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),m(e,"tabindex","-1"),m(n,"class",a=Te(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,E){U(k,e,E),U(k,l,E),U(k,n,E),u(n,r),_&&_.m(r,null),u(n,o);for(let L=0;L<v.length;L+=1)v[L]&&v[L].m(n,null);i=!0,d||(f=J(e,"click",s[11]),d=!0)},p(k,E){if(s=k,_&&_.p&&(!i||E&65536)&&Os(_,g,s,s[16],i?Bs(g,s[16],E,Kn):js(s[16]),tl),E&8457){h=de(s[0]);let L;for(L=0;L<h.length;L+=1){const V=el(s,h,L);v[L]?(v[L].p(V,E),x(v[L],1)):(v[L]=nl(V),v[L].c(),x(v[L],1),v[L].m(n,null))}for(xe(),L=h.length;L<v.length;L+=1)N(L);Fe()}(!i||E&4&&a!==(a=Te(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&m(n,"class",a)},i(k){if(!i){k&&ns(()=>{i&&(t||(t=wt(e,os,{duration:es},!0)),t.run(1))}),x(_,k);for(let E=0;E<h.length;E+=1)x(v[E]);k&&ns(()=>{i&&(c||(c=wt(n,rs,{duration:es},!0)),c.run(1))}),i=!0}},o(k){k&&(t||(t=wt(e,os,{duration:es},!1)),t.run(0)),q(_,k),v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)q(v[E]);k&&(c||(c=wt(n,rs,{duration:es},!1)),c.run(0)),i=!1},d(k){k&&(p(e),p(l),p(n)),k&&t&&t.end(),_&&_.d(k),Ve(v,k),k&&c&&c.end(),d=!1,f()}}}function ll(s){let e,t,l,n,r,o,a=s[23]+"",c,i,d,f,g;const _=[Fn,xn],h=[];function v(k,E){return k[24]?0:1}l=v(s),n=h[l]=_[l](s);function N(){return s[20](s[22])}return{c(){e=b("li"),t=b("button"),n.c(),r=j(),o=b("div"),c=Z(a),i=j(),this.h()},l(k){e=y(k,"LI",{});var E=C(e);t=y(E,"BUTTON",{class:!0});var L=C(t);n.l(L),r=B(L),o=y(L,"DIV",{});var V=C(o);c=ee(V,a),V.forEach(p),L.forEach(p),i=B(E),E.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),$(t,"selected",s[22]===s[3])},m(k,E){U(k,e,E),u(e,t),h[l].m(t,null),u(t,r),u(t,o),u(o,c),u(e,i),d=!0,f||(g=J(t,"click",N),f=!0)},p(k,E){s=k;let L=l;l=v(s),l===L?h[l].p(s,E):(xe(),q(h[L],1,1,()=>{h[L]=null}),Fe(),n=h[l],n?n.p(s,E):(n=h[l]=_[l](s),n.c()),x(n,1),n.m(t,r)),(!d||E&1)&&a!==(a=s[23]+"")&&pe(c,a),(!d||E&9)&&$(t,"selected",s[22]===s[3])},i(k){d||(x(n),d=!0)},o(k){q(n),d=!1},d(k){k&&p(e),h[l].d(),f=!1,g()}}}function xn(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","w-[24px]")},m(t,l){U(t,e,l)},p:me,i:me,o:me,d(t){t&&p(e)}}}function Fn(s){let e,t;return e=new Re({props:{class:"mr-2",icon:s[24],width:16}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const r={};n&1&&(r.icon=l[24]),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){q(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function nl(s){let e,t,l=!s[8][s[26]]&&ll(s);return{c(){l&&l.c(),e=Pe()},l(n){l&&l.l(n),e=Pe()},m(n,r){l&&l.m(n,r),U(n,e,r),t=!0},p(n,r){n[8][n[26]]?l&&(xe(),q(l,1,1,()=>{l=null}),Fe()):l?(l.p(n,r),r&256&&x(l,1)):(l=ll(n),l.c(),x(l,1),l.m(e.parentNode,e))},i(n){t||(x(l),t=!0)},o(n){q(l),t=!1},d(n){n&&p(e),l&&l.d(n)}}}function Hn(s){let e,t,l,n,r,o,a,c,i,d=s[6]&&sl(s);return{c(){e=b("div"),t=b("input"),r=j(),d&&d.c(),this.h()},l(f){e=y(f,"DIV",{class:!0,id:!0});var g=C(e);t=y(g,"INPUT",{class:!0,title:!0}),r=B(g),d&&d.l(g),g.forEach(p),this.h()},h(){m(t,"class",l=Te(`${s[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"),m(t,"title",n=s[14].title||""),$(t,"disabled",s[4]),$(t,"open",s[6]),m(e,"class",o=Te(`relative ${s[2]||""}`)+" svelte-h65upg"),m(e,"id",s[1])},m(f,g){U(f,e,g),u(e,t),et(t,s[7]),u(e,r),d&&d.m(e,null),s[21](e),a=!0,c||(i=[J(t,"input",s[18]),J(t,"click",s[9]),J(t,"focus",s[19]),J(t,"input",s[10]),J(t,"keydown",s[12])],c=!0)},p(f,[g]){(!a||g&16384&&l!==(l=Te(`${f[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"))&&m(t,"class",l),(!a||g&16384&&n!==(n=f[14].title||""))&&m(t,"title",n),g&128&&t.value!==f[7]&&et(t,f[7]),(!a||g&16400)&&$(t,"disabled",f[4]),(!a||g&16448)&&$(t,"open",f[6]),f[6]?d?(d.p(f,g),g&64&&x(d,1)):(d=sl(f),d.c(),x(d,1),d.m(e,null)):d&&(xe(),q(d,1,1,()=>{d=null}),Fe()),(!a||g&4&&o!==(o=Te(`relative ${f[2]||""}`)+" svelte-h65upg"))&&m(e,"class",o),(!a||g&2)&&m(e,"id",f[1])},i(f){a||(x(d),a=!0)},o(f){q(d),a=!1},d(f){f&&p(e),d&&d.d(),s[21](null),c=!1,Qe(i)}}}const es=400;function zn(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:r,id:o=void 0,containerClass:a=void 0,selected:c,disabled:i=void 0,onSelect:d}=e,f,g=!1,_=c,h=r.map(A=>!1);function v(){i||t(6,g=!g)}function N(A){t(8,h=r.map(w=>!w.value.toLowerCase().includes(A.currentTarget.value.toLowerCase())))}function k(){t(7,_=c),t(6,g=!1),t(8,h=r.map(A=>!1))}function E(A){if(A.key==="Enter"){const w=h.findIndex(D=>!D);_===c?k():w>-1&&t(6,g=d(r[w].key)),g||(t(8,h=r.map(D=>!1)),A.currentTarget instanceof HTMLElement&&A.currentTarget.blur())}else A.key==="Escape"&&(k(),A.currentTarget instanceof HTMLElement&&A.currentTarget.blur())}function L(A){t(6,g=d(A))}function V(){_=this.value,t(7,_),t(3,c)}const K=()=>t(6,g=!0),S=A=>L(A);function T(A){Gs[A?"unshift":"push"](()=>{f=A,t(5,f)})}return s.$$set=A=>{t(14,e=Ae(Ae({},e),Se(A))),"options"in A&&t(0,r=A.options),"id"in A&&t(1,o=A.id),"containerClass"in A&&t(2,a=A.containerClass),"selected"in A&&t(3,c=A.selected),"disabled"in A&&t(4,i=A.disabled),"onSelect"in A&&t(15,d=A.onSelect),"$$scope"in A&&t(16,n=A.$$scope)},s.$$.update=()=>{s.$$.dirty&8&&t(7,_=c),s.$$.dirty&1&&t(8,h=r.map(A=>!1))},e=Se(e),[r,o,a,c,i,f,g,_,h,v,N,k,E,L,e,d,n,l,V,K,S,T]}class yn extends We{constructor(e){super(),qe(this,e,zn,Hn,Je,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:15})}}const ol={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Ze(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:kn(s,e,t),flats:e,sharps:t}}function kn(s,e,t){return(s<8?ol[s]:ol[s%7])-e+t+Math.floor(s/8)*12}function wn(s){let e,t=0,l=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(l=Math.floor(s/100),e=s%100):e=s;const n=kn(e,t,l);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(l)}`,interval_seq:e,semitones:n,flats:t,sharps:l}}const Wn=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let Es=[];function En(){return Wn.map(s=>{const e=s[3].map(wn);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function Ut(s){Es.length===0&&(Es=En());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return Es.find(t=>t.suffixes.find(l=>l===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function qn(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const o=Math.min(l,n);l-=o,n-=o}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function ls(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const r=t[n],o=s+r.semitones,a=e.scaleNotes.find(g=>g.semitones===o%12),c=r.flats>0,i=r.sharps>0,d=(c?o+1:i?o-1:o)%12,f=c?-1:i?1:0;l.push(qn(a??e.notesMap.get(d),a?0:f,o))}return l}const rl=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],Jn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],al=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function $n(s){let e=0,t=0;for(let l=0;l<rl.length;l+=1){const n=s.find(o=>o.note.slice(0,2)===rl[l]),r=s.find(o=>o.note.slice(0,2)===Jn[l]);if(n)e+=1;else if(r)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:al.get(e*-1)}:{flats:0,sharps:t,majorSignature:al.get(t)}}function Yn(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function Cn(s){return s.map(e=>{const t=[Ze(1)];let l;return e.major?(t.push(Ze(3)),e.suffix.startsWith("+")?t.push(Ze(5,0,1)):e.suffix.startsWith("6")?t.push(Ze(6)):e.suffix.startsWith("7")?t.push(Ze(7,1)):e.suffix.startsWith("maj7")?t.push(Ze(7)):l=Ut("maj")):e.minor?(t.push(Ze(3,1)),e.suffix.startsWith("°")?t.push(Ze(5,1)):e.suffix.startsWith("6")?(t.push(Ze(6)),l=Ut("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Ze(7,1)),l=Ut("m"+e.suffix)):l=Ut("m")):e.suffix.startsWith("sus2")?t.push(Ze(2)):e.suffix.startsWith("sus4")&&t.push(Ze(4)),t.length<=2&&t.push(Ze(5)),t.length<=2&&t.push(Ze(8)),l||(l=Ut(e.suffix)),{...l,intervals:t}})}function Qn(s,e){let t=e.has(4)&&e.has(7),l=e.has(3)&&e.has(7);const n=Yn(s);let r="";return t||l||(e.has(3)&&e.has(6)?(r="°",l=!0):e.has(4)&&e.has(8)?(r="+",t=!0):e.has(3)&&e.has(10)?(l=!0,r="7"):e.has(4)&&e.has(10)?(r="7",t=!0):e.has(4)&&e.has(11)?(r="maj7",t=!0):e.has(3)&&e.has(8)?(r="6",l=!0):e.has(4)&&e.has(9)?(r="6",t=!0):e.has(2)?r="sus2":e.has(5)?r="sus4":e.has(7)?r="5":r="?"),{degree:s,roman:l?n.toLowerCase():n,suffix:r,major:t,minor:l,semitones:e}}function Xn(s){const e=s.length;return s.map((t,l)=>{const n=t.semitones,r=new Set;for(let o=1;o<e;o+=1){const a=s[(l+o)%e].semitones,c=a<=n?a+12-n:a-n;r.add(c)}return Qn(t.interval_seq,r)})}const Zn=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let Cs=[];function ms(){return Zn.map(s=>{const e=s[0],t=s[1].map(wn),l=Xn(t);return{names:e,intervals:t,triads:l}})}function eo(s){Cs.length===0&&(Cs=ms());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return Cs.find(t=>t.names.find(l=>l.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const to=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,so=/^[0-9]$/,at=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function us(s){const e=s.midi+s.flats-s.sharps;return e===12?1:Math.floor((e-12)/12)}function ft(s){return`${s.note}${us(s)}`}function il(s){const t=(s-12)%12;return{...at[t],semitones:t,midi:s}}function lo(s,e=!0,t=!1){if(e&&!to.test(s))return{err:`Unrecognized note "${s}"`,code:400};const l=s.trim(),n=l.charAt(0).toUpperCase(),r=at.find(f=>f.note.charAt(0)===n&&f.note.length===1);if(!r)return{err:`Unable to find note ${l}`,code:500};const o=l.slice(1).split("").reduce((f,g)=>f+(g.toLowerCase()==="b"||g==="♭"?-1:g==="#"||g==="♯"?1:0),0);let a;if(so.test(l.charAt(l.length-1)))try{a=parseInt(l.charAt(l.length-1),10)}catch{}if(t&&a===void 0)return{err:`No octave provided: ${s}`,code:400};a===void 0&&(a=0);let c=(r.semitones+o)%12;c=c<0?c+12:c;const i=o<0?-o:0,d=o>0?o:0;return{data:{note:`${n}${"♭".repeat(i)}${"♯".repeat(d)}`,semitones:c,midi:12+a*12+c,flats:i,sharps:d}}}function Ms(s){const e=at.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((n,r)=>n+(r.toLowerCase()==="b"||r==="♭"?-1:r==="#"||r==="♯"?1:0),0),l=(e.semitones+t)%12;return{note:s,semitones:l<0?l+12:l,flats:t<0?-t:0,sharps:t>0?t:0}}}const no=/^[a-gA-G][♭b#♯]?$/,Is="ABCDEFG";function oo(s,e){return e.map(t=>Is.charAt((Is.indexOf(s)+t.interval_seq-1)%Is.length))}function ro(s,e,t){return t.map((l,n)=>{const r=e[n],o=(s+l.semitones)%12,a=at[o],c=a.note.charAt(0);if(c<r&&(c!=="A"||r!=="G")||c==="G"&&r==="A"){let i=1,d=at[(o+i)%12];for(;d.note.charAt(0)!==r;)i+=1,d=at[(o+i)%12];return{semitones:o,note:d.note+"♭".repeat(i),flats:i+(d.note.includes("♭")?1:0),sharps:0}}else if(c>r||c==="A"&&r==="G"){let i=1,d=o===0?at.length-1:o-i,f=at[d];for(;f.note.charAt(0)!==r;)i+=1,d=d===0?at.length-1:d-1,f=at[d];return{semitones:o,note:f.note+"♯".repeat(i),flats:0,sharps:i+(f.note.includes("♯")?1:0)}}else return{semitones:o,note:a.note,flats:a.flats,sharps:a.sharps}})}function Kt(s,e){if(!no.test(s))return{err:`Unknown key: ${s}`,code:400};const t=eo(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const l=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,n=Ms(l);if(!n)return{err:`Unable to find root for note: ${l}`,code:404};const r=oo(l.charAt(0),t.intervals),o=ro(n.semitones,r,t.intervals),a=new Map(at.map(c=>{const i=o.find(d=>d.semitones===c.semitones);return i?[c.semitones,i]:[c.semitones,{...c}]}));return{data:{key:l,scale:t.names[0],names:t.names,...$n(o),intervals:t.intervals.map(c=>({...c})),triads:t.triads.map(c=>({...c})),scaleNotes:o,notesMap:a}}}const Ss=new Map;function ao(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function io(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(l){return{err:`Failed to store the value: ${l}`,code:400}}}function _t(s,e){const{key:t,storage:l="local",namespace:n="default"}=e,r=ao(t,l),o=Ie(s);"data"in r?s.set(e.deserialize?e.deserialize(r.data):r.data):"err"in r&&(e!=null&&e.debug)&&console.info(r.err);const a=s.subscribe(i=>{const d=io(e.serialize?e.serialize(i):i,t,l);"err"in d&&(e!=null&&e.debug)&&console.error(d.err)}),c=Ss.get(n);return c?c.push({key:t,storage:l,value:s,defaultValue:o,unsubscribe:a}):Ss.set(n,[{key:t,storage:l,value:s,defaultValue:o,unsubscribe:a}]),s}function co(s=["default"],e){s.forEach(t=>{var l;(l=Ss.get(t))==null||l.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function uo(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const l=await t.arrayBuffer();return{data:await e.decodeAudioData(l)}}async function fo(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],l=await Promise.all(t.map(r=>uo(`${s}${r}`,e))),n=[];return l.forEach(r=>{"err"in r?console.error(`Failed to load audio: ${r.err}`):n.push(r.data)}),n}class ho{constructor(e,t,l,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(l),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(l))}on(e,t,l,n,r,o,a,c){this.noteA.buffer=e,this.noteA.playbackRate.value=l,this.biquadFilter.frequency.value=r,this.gainA.gain.value=o,this.gain.gain.value=c,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=a,this.noteB.start(0)),this.noteA.start(0)}off(e,t,l){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(l),this.noteB.stop(l),(n=this.damp)==null||n.start(0)}}class mo{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,l)=>{this.bufferlists.push(t),l===8?this.damper=t:l===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(l=>{this.noteOn(l,t)})}noteOn(e,t=80){if(e<109&&e>20){const l=this.notes.get(e);l&&(l.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),r=n+1,o=n*12+21,a=2**((e-69)/12)*440,c=t/127;let i=a*(2-(e-21)/50)+3*a*c;e<60&&(i=440*(3-(60-21)/50)+3*a*c);const d=1-(e%12/12+1)/12,f=Math.pow(2,(e-o)/12),g=0,_=0,h=c**1.4,v=new ho(e,this.context,this.directGain,this.damper);v.on(this.bufferlists[n],this.bufferlists[r],f,g,i,d,_,h),this.notes.set(e,v)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const _o="/midi-note-trainer/",Ns=_t(Oe(!1),{key:"midi-access"}),fs=Oe(void 0),_s=_t(Oe([60,84]),{key:"midi-range",storage:"session"}),Mt=Rt(_s,s=>[il(s[0]),il(s[1])]),cl=Oe(void 0),lt=Oe(void 0),nt=_t(Oe({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),Be={async openMidi(){return Zt.enable().then(()=>(Ns.set(!0),Zt.inputs.length>0?(fs.set(Zt.inputs[0]),{data:Zt.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(s=>({err:s.toString(),code:403}))},disableMidi(){Ns.set(!1),fs.set(void 0)},setMidiRange(s){_s.set(s)},setInputValue(s,e){nt.update(t=>({...t,[s]:e})),s==="useSound"&&!e?lt.set(void 0):s==="useSound"&&!Ie(lt)&&this.initAudio()},async initAudio(){let s=Ie(cl);if(s||(s=new AudioContext,cl.set(s)),!Ie(lt)){const e=new mo(s),t=await fo(`${_o}audio`,s);e.load(t),lt.set(e)}}};let rt;Pn({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}});const Tt=Oe(["C","Major"]),Ct=Rt(Tt,s=>{const e=Kt(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),ul=Oe([]),kt=Oe([]);function Ds(s,e){if(s.length>0){const t=Date.now();let l=t;const n=s.filter(r=>(r.started+e>t&&(l=Math.min(l,r.started)),r.started+e>t));return!rt&&n.length>0&&(rt=setTimeout(()=>{rt=void 0,kt.update(r=>Ds(r,e))},e-(t-l)+100)),n}return s}const De={setKey(s){Tt.update(e=>[s,e[1]])},setScale(s){Tt.update(e=>[e[0],s])},setKeyAndScale(s,e){Tt.set([s,e])},setTarget(s=[]){ul.set(s)},getNote(s){return{...Ie(Ct).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const n={...Ie(Ct).notesMap.get(s%12),midi:s},r=Date.now(),o=e===void 0?"default":e?"correct":"wrong";if(kt.update(a=>{const c=a.findIndex(i=>i.midi===s);return c>=0&&a.splice(c,1),[...a,{...n,color:o,started:r}]}),!rt&&t!==-1){const a=t??Ie(nt).keyFadeTimeout;rt=setTimeout(()=>{rt=void 0,kt.update(c=>Ds(c,a))},a)}},setPlayed(s,e,t){const l=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(kt.update(r=>[...s.map(o=>({...o,color:n,started:l}))]),!rt&&t!==-1){const r=t??Ie(nt).keyFadeTimeout;rt=setTimeout(()=>{rt=void 0,kt.update(o=>Ds(o,r))},r)}},clearPlayed(){kt.set([]),clearTimeout(rt),rt=void 0},clearScore(s=!1){s&&Tt.set(["C","Major"]),ul.set([]),kt.set([])}};class Rs{constructor(e,t,l){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=l;const n=[],{count:r}=l,o=t.map(c=>typeof c=="object"&&c!==null?{...c}:c);let a=l.duplicates;!l.duplicates&&r>o.length&&(console.warn(`Trying to create game with count ${r} larger than available unique values ${t.length}`),a=!0);for(let c=0;c<r;c+=1){const i=Math.floor(Math.random()*o.length);if(a)n.push(o[i]);else{const d=o.splice(i,1);d.length>0&&n.push(d[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function po(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const o=Math.min(l,n);l-=o,n-=o}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function go(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const r=t[n],o=s+r.semitones,a=e.scaleNotes.find(g=>g.semitones===o%12),c=r.flats>0,i=r.sharps>0,d=(c?o+1:i?o-1:o)%12,f=c?-1:i?1:0;l.push(po(a??e.notesMap.get(d),a?0:f,o))}return l}const vo=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function bo(s){const t=(s-12)%12;return{...vo[t],semitones:t,midi:s}}function yo(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class ht extends Rs{constructor(e,t,l){const n=t.range[0],r=t.range[1],o=new Set(t.scale.scaleNotes.map(c=>c.semitones)),a=l.chords.flatMap(c=>{const i=[],d=c.intervals.reduce((f,g)=>g.semitones>f?g.semitones:f,0);for(let f=n;f<=r-d;f+=1)if((!l.onlyScale||o.has(f%12))&&(!c.allowed||c.allowed.has(f%12))){const g=go(f,t.scale,c.intervals);i.push({...c,rootNote:g[0].note,chord:`${g[0].note}${c.suffixes[0]}`,notes:g})}return i});super(e,a,t),this.played=new Set,this.opts=l}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${yo(e)}${e.chord.toLowerCase()}`,notes:[]};let l=this.current.chord===t.chord;return this.current.chord.slice(-3)==="maj"&&!l&&(l=this.current.chord.slice(0,-3)===t.chord),this.addGuessed(t,l)}guess(){const e=Array.from(this.played.values()).map(n=>bo(n)).sort((n,r)=>n.midi-r.midi);this.played.clear();const t={chord:"",notes:e},l=this.current.notes.every(n=>e.find(r=>r.midi%12===n.midi%12));return this.addGuessed(t,l)}}const ko={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class xt extends Rs{constructor(e,t){const l=e==="keys-major"?"major":"minor";super(e,Object.keys(ko[l]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class Ot extends Rs{constructor(e,t){const l=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-l+1)).map((r,o)=>l+o),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const In={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},dt=Oe("waiting"),mt=_t(Oe(In),{key:"game-options"}),Et=Oe(void 0),Us=Oe(En().map(s=>({...s,selected:!0}))),Le={play(...[s,e]){var c,i,d;let t;const l=Ie(Ct),n=Ie(_s),r=Ie(mt),o={scale:l,range:n,duplicates:r.duplicates,count:r.count};let a=[l.key,l.scale];if(s==="notes")t=new Ot(s,o),De.setTarget([De.getNote(t.current)]),(c=Ie(lt))==null||c.noteOn(t.current);else if(s==="pitches")t=new Ot(s,o),De.setTarget(),Be.setInputValue("useSound",!0),(i=Ie(lt))==null||i.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new xt(s,o),a=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new ht(s,o,e);else if(s==="chords-diatonic"){const f=Cn(l.triads).map((g,_)=>({...g,allowed:new Set([l.scaleNotes[_].semitones])}));t=new ht(s,o,{chords:f})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((d=Ie(lt))==null||d.playChord(t.current.notes.map(f=>f.midi)),De.setTarget(t.current.notes)),De.setKeyAndScale(a[0],a[1]),De.clearPlayed(),dt.set("waiting"),Et.set(t),t},updateState(s){dt.set(s)},setOptionValue(s,e){mt.update(t=>({...t,[s]:e}))},toggleChords(s){Us.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Ie(Et);s!=null&&s.ended?dt.set("ended"):s instanceof Ot?(s.type==="notes"?De.setTarget([De.getNote(s.current)]):De.setTarget(),De.clearPlayed(),(e=Ie(lt))==null||e.noteOn(s.current),Le.updateState("waiting"),s.startTime()):s instanceof ht?(De.setTarget(s.current.notes),De.clearPlayed(),(t=Ie(lt))==null||t.playChord(s==null?void 0:s.current.notes.map(l=>l.midi)),dt.set("waiting"),s.startTime()):s instanceof xt&&(De.setKey(s.current),dt.set("waiting"),s.startTime())},clearGame(s=!1){const e=Ie(Et);e&&De.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&mt.set(In),Et.set(void 0),dt.set("waiting"),De.clearScore()}};function fl(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function dl(s,e,t){const l=s.slice();return l[40]=e[t],l}function hl(s,e,t){const l=s.slice();return l[9]=e[t],l}function ml(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function _l(s,e,t){const l=s.slice();return l[40]=e[t],l}function pl(s,e,t){const l=s.slice();return l[9]=e[t],l}function wo(s){let e,t=de(s[35].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=gl(_l(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r[0]&128){t=de(n[35].intervals);let o;for(o=0;o<t.length;o+=1){const a=_l(n,t,o);l[o]?l[o].p(a,r):(l[o]=gl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function Eo(s){let e,t=de(s[3][s[37]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=vl(pl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r[0]&8){t=de(n[3][n[37]]);let o;for(o=0;o<t.length;o+=1){const a=pl(n,t,o);l[o]?l[o].p(a,r):(l[o]=vl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function gl(s){let e,t=s[40].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&128&&t!==(t=n[40].interval+"")&&pe(l,t)},d(n){n&&p(e)}}}function vl(s){let e,t=s[9].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&8&&t!==(t=n[9].note+"")&&pe(l,t)},d(n){n&&p(e)}}}function bl(s){let e,t,l,n,r,o,a=s[35].suffixes[0]+"",c,i,d,f,g,_,h,v=s[35].name+"",N,k,E,L,V;n=new Re({props:{icon:s[35].selected?is:cs,width:12}});function K(){return s[25](s[35])}function S(D,P){return D[3][D[37]]&&D[3][D[37]].length>0?Eo:wo}let T=S(s),A=T(s);function w(){return s[26](s[35])}return{c(){e=b("li"),t=b("button"),l=b("span"),ge(n.$$.fragment),r=j(),o=b("div"),c=Z(a),i=j(),d=b("li"),A.c(),g=j(),_=b("li"),h=b("button"),N=Z(v),k=j(),this.h()},l(D){e=y(D,"LI",{});var P=C(e);t=y(P,"BUTTON",{class:!0});var I=C(t);l=y(I,"SPAN",{class:!0});var O=C(l);ve(n.$$.fragment,O),O.forEach(p),r=B(I),o=y(I,"DIV",{class:!0});var R=C(o);c=ee(R,a),R.forEach(p),I.forEach(p),P.forEach(p),i=B(D),d=y(D,"LI",{class:!0,title:!0});var M=C(d);A.l(M),M.forEach(p),g=B(D),_=y(D,"LI",{class:!0});var F=C(_);h=y(F,"BUTTON",{class:!0});var X=C(h);N=ee(X,v),X.forEach(p),k=B(F),F.forEach(p),this.h()},h(){m(l,"class","px-1 py-1 rounded"),$(l,"text-green-500",s[35].selected),$(l,"text-gray-400",!s[35].selected),m(o,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),m(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),$(t,"hidden",s[8]),m(d,"class","intervals svelte-1rg0xw5"),m(d,"title",f=s[35].intervals.map(El).join("-")),m(h,"class","text-start"),m(_,"class","text-xs")},m(D,P){U(D,e,P),u(e,t),u(t,l),be(n,l,null),u(t,r),u(t,o),u(o,c),U(D,i,P),U(D,d,P),A.m(d,null),U(D,g,P),U(D,_,P),u(_,h),u(h,N),u(_,k),E=!0,L||(V=[J(t,"click",K),J(h,"click",w)],L=!0)},p(D,P){s=D;const I={};P[0]&128&&(I.icon=s[35].selected?is:cs),n.$set(I),(!E||P[0]&128)&&$(l,"text-green-500",s[35].selected),(!E||P[0]&128)&&$(l,"text-gray-400",!s[35].selected),(!E||P[0]&128)&&a!==(a=s[35].suffixes[0]+"")&&pe(c,a),(!E||P[0]&256)&&$(t,"hidden",s[8]),T===(T=S(s))&&A?A.p(s,P):(A.d(1),A=T(s),A&&(A.c(),A.m(d,null))),(!E||P[0]&128&&f!==(f=s[35].intervals.map(El).join("-")))&&m(d,"title",f),(!E||P[0]&128)&&v!==(v=s[35].name+"")&&pe(N,v)},i(D){E||(x(n.$$.fragment,D),E=!0)},o(D){q(n.$$.fragment,D),E=!1},d(D){D&&(p(e),p(i),p(d),p(g),p(_)),ye(n),A.d(),L=!1,Qe(V)}}}function Co(s){let e,t=de(s[35].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=yl(dl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r[0]&64){t=de(n[35].intervals);let o;for(o=0;o<t.length;o+=1){const a=dl(n,t,o);l[o]?l[o].p(a,r):(l[o]=yl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function Io(s){let e,t=de(s[4][s[37]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=kl(hl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r[0]&16){t=de(n[4][n[37]]);let o;for(o=0;o<t.length;o+=1){const a=hl(n,t,o);l[o]?l[o].p(a,r):(l[o]=kl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function yl(s){let e,t=s[40].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&64&&t!==(t=n[40].interval+"")&&pe(l,t)},d(n){n&&p(e)}}}function kl(s){let e,t=s[9].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&16&&t!==(t=n[9].note+"")&&pe(l,t)},d(n){n&&p(e)}}}function wl(s){let e,t,l,n,r,o,a=s[35].suffixes[0]+"",c,i,d,f,g,_,h,v=s[35].name+"",N,k,E,L,V;n=new Re({props:{icon:s[35].selected?is:cs,width:12}});function K(){return s[27](s[35])}function S(D,P){return D[4][D[37]]&&D[4][D[37]].length>0?Io:Co}let T=S(s),A=T(s);function w(){return s[28](s[35])}return{c(){e=b("li"),t=b("button"),l=b("span"),ge(n.$$.fragment),r=j(),o=b("div"),c=Z(a),i=j(),d=b("li"),A.c(),g=j(),_=b("li"),h=b("button"),N=Z(v),k=j(),this.h()},l(D){e=y(D,"LI",{});var P=C(e);t=y(P,"BUTTON",{class:!0});var I=C(t);l=y(I,"SPAN",{class:!0});var O=C(l);ve(n.$$.fragment,O),O.forEach(p),r=B(I),o=y(I,"DIV",{class:!0});var R=C(o);c=ee(R,a),R.forEach(p),I.forEach(p),P.forEach(p),i=B(D),d=y(D,"LI",{class:!0,title:!0});var M=C(d);A.l(M),M.forEach(p),g=B(D),_=y(D,"LI",{class:!0});var F=C(_);h=y(F,"BUTTON",{class:!0});var X=C(h);N=ee(X,v),X.forEach(p),k=B(F),F.forEach(p),this.h()},h(){m(l,"class","px-1 py-1 rounded"),$(l,"text-green-500",s[35].selected),$(l,"text-gray-400",!s[35].selected),m(o,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),m(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),$(t,"hidden",s[8]),m(d,"class","intervals svelte-1rg0xw5"),m(d,"title",f=s[35].intervals.map(Cl).join("-")),m(h,"class","text-start"),m(_,"class","text-xs")},m(D,P){U(D,e,P),u(e,t),u(t,l),be(n,l,null),u(t,r),u(t,o),u(o,c),U(D,i,P),U(D,d,P),A.m(d,null),U(D,g,P),U(D,_,P),u(_,h),u(h,N),u(_,k),E=!0,L||(V=[J(t,"click",K),J(h,"click",w)],L=!0)},p(D,P){s=D;const I={};P[0]&64&&(I.icon=s[35].selected?is:cs),n.$set(I),(!E||P[0]&64)&&$(l,"text-green-500",s[35].selected),(!E||P[0]&64)&&$(l,"text-gray-400",!s[35].selected),(!E||P[0]&64)&&a!==(a=s[35].suffixes[0]+"")&&pe(c,a),(!E||P[0]&256)&&$(t,"hidden",s[8]),T===(T=S(s))&&A?A.p(s,P):(A.d(1),A=T(s),A&&(A.c(),A.m(d,null))),(!E||P[0]&64&&f!==(f=s[35].intervals.map(Cl).join("-")))&&m(d,"title",f),(!E||P[0]&64)&&v!==(v=s[35].name+"")&&pe(N,v)},i(D){E||(x(n.$$.fragment,D),E=!0)},o(D){q(n.$$.fragment,D),E=!1},d(D){D&&(p(e),p(i),p(d),p(g),p(_)),ye(n),A.d(),L=!1,Qe(V)}}}function To(s){let e,t,l,n,r="Chords",o,a,c,i,d,f,g,_,h,v,N,k,E,L,V,K,S,T="Key",A,w,D,P,I="Scale",O,R,M,F,X="Note",ie,Y,z,G,le,H,se,ce,Ee,oe;i=new Re({props:{icon:Gn,width:20}}),g=new Re({props:{icon:Mn,width:16}}),v=new Re({props:{icon:s[5]?Qs:Xs,width:16}}),E=new Re({props:{icon:Ft,width:16}}),R=new yn({props:{class:"bg-gray-100 w-48",containerClass:"input w-48",selected:s[1],options:s[10],onSelect:s[14]}});let he=de(s[7]),Q=[];for(let W=0;W<he.length;W+=1)Q[W]=bl(ml(s,he,W));const ue=W=>q(Q[W],1,1,()=>{Q[W]=null});let we=de(s[6]),fe=[];for(let W=0;W<we.length;W+=1)fe[W]=wl(fl(s,we,W));const He=W=>q(fe[W],1,1,()=>{fe[W]=null});return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,o=j(),a=b("div"),c=b("button"),ge(i.$$.fragment),d=j(),f=b("button"),ge(g.$$.fragment),_=j(),h=b("button"),ge(v.$$.fragment),N=j(),k=b("button"),ge(E.$$.fragment),L=j(),V=b("div"),K=b("div"),S=b("label"),S.textContent=T,A=j(),w=b("input"),D=j(),P=b("label"),P.textContent=I,O=j(),ge(R.$$.fragment),M=j(),F=b("label"),F.textContent=X,ie=j(),Y=b("input"),z=j(),G=b("ul");for(let W=0;W<Q.length;W+=1)Q[W].c();le=j(),H=b("ul");for(let W=0;W<fe.length;W+=1)fe[W].c();this.h()},l(W){e=y(W,"DIV",{class:!0});var re=C(e);t=y(re,"FIELDSET",{class:!0});var ke=C(t);l=y(ke,"LEGEND",{class:!0});var tt=C(l);n=y(tt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-1knqzl6"&&(n.textContent=r),tt.forEach(p),o=B(ke),a=y(ke,"DIV",{class:!0});var ne=C(a);c=y(ne,"BUTTON",{class:!0});var je=C(c);ve(i.$$.fragment,je),je.forEach(p),d=B(ne),f=y(ne,"BUTTON",{class:!0});var Me=C(f);ve(g.$$.fragment,Me),Me.forEach(p),_=B(ne),h=y(ne,"BUTTON",{class:!0});var pt=C(h);ve(v.$$.fragment,pt),pt.forEach(p),N=B(ne),k=y(ne,"BUTTON",{class:!0});var At=C(k);ve(E.$$.fragment,At),At.forEach(p),ne.forEach(p),L=B(ke),V=y(ke,"DIV",{class:!0});var ze=C(V);K=y(ze,"DIV",{class:!0});var Ue=C(K);S=y(Ue,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(S)!=="svelte-14m38zf"&&(S.textContent=T),A=B(Ue),w=y(Ue,"INPUT",{class:!0,id:!0}),D=B(Ue),P=y(Ue,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(P)!=="svelte-bxhcb0"&&(P.textContent=I),O=B(Ue),ve(R.$$.fragment,Ue),M=B(Ue),F=y(Ue,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(F)!=="svelte-dmbfli"&&(F.textContent=X),ie=B(Ue),Y=y(Ue,"INPUT",{class:!0,id:!0}),Ue.forEach(p),z=B(ze),G=y(ze,"UL",{class:!0});var St=C(G);for(let $e=0;$e<Q.length;$e+=1)Q[$e].l(St);St.forEach(p),le=B(ze),H=y(ze,"UL",{class:!0});var st=C(H);for(let $e=0;$e<fe.length;$e+=1)fe[$e].l(st);st.forEach(p),ze.forEach(p),ke.forEach(p),re.forEach(p),this.h()},h(){m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(c,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),$(c,"hidden",s[8]),m(f,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(f,"hidden",s[8]),m(h,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(h,"hidden",s[8]),m(k,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(k,"hidden",s[8]),m(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),m(S,"class","mr-4 font-bold svelte-1rg0xw5"),m(S,"for","scale-key"),m(w,"class","input bg-gray-100 w-12 px-1 rounded"),m(w,"id","scale-key"),w.value=s[0],m(P,"class","font-bold svelte-1rg0xw5"),m(P,"for","scale-key"),m(F,"class","font-bold svelte-1rg0xw5"),m(F,"for","scale-key"),m(Y,"class","input bg-gray-100 w-12 px-1 rounded"),m(Y,"id","scale-key"),Y.value=s[2],m(K,"class","flex mb-2 options svelte-1rg0xw5"),m(G,"class","chord-list w-full svelte-1rg0xw5"),m(H,"class","chord-list w-full svelte-1rg0xw5"),m(V,"class","body svelte-1rg0xw5"),$(V,"hidden",s[8]),m(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1rg0xw5"),$(t,"collapsed",s[8]),m(e,"class",se=Te(`${s[22].class||""}`)+" svelte-1rg0xw5")},m(W,re){U(W,e,re),u(e,t),u(t,l),u(l,n),u(t,o),u(t,a),u(a,c),be(i,c,null),u(a,d),u(a,f),be(g,f,null),u(a,_),u(a,h),be(v,h,null),u(a,N),u(a,k),be(E,k,null),u(t,L),u(t,V),u(V,K),u(K,S),u(K,A),u(K,w),u(K,D),u(K,P),u(K,O),be(R,K,null),u(K,M),u(K,F),u(K,ie),u(K,Y),u(V,z),u(V,G);for(let ke=0;ke<Q.length;ke+=1)Q[ke]&&Q[ke].m(G,null);u(V,le),u(V,H);for(let ke=0;ke<fe.length;ke+=1)fe[ke]&&fe[ke].m(H,null);ce=!0,Ee||(oe=[J(n,"click",s[12]),J(c,"click",s[17]),J(f,"click",s[18]),J(h,"click",s[19]),J(k,"click",s[20]),J(w,"input",s[13]),J(Y,"input",s[15])],Ee=!0)},p(W,re){(!ce||re[0]&256)&&$(c,"hidden",W[8]),(!ce||re[0]&256)&&$(f,"hidden",W[8]);const ke={};re[0]&32&&(ke.icon=W[5]?Qs:Xs),v.$set(ke),(!ce||re[0]&256)&&$(h,"hidden",W[8]),(!ce||re[0]&256)&&$(k,"hidden",W[8]),(!ce||re[0]&1&&w.value!==W[0])&&(w.value=W[0]);const tt={};if(re[0]&2&&(tt.selected=W[1]),R.$set(tt),(!ce||re[0]&4&&Y.value!==W[2])&&(Y.value=W[2]),re[0]&2163080){he=de(W[7]);let ne;for(ne=0;ne<he.length;ne+=1){const je=ml(W,he,ne);Q[ne]?(Q[ne].p(je,re),x(Q[ne],1)):(Q[ne]=bl(je),Q[ne].c(),x(Q[ne],1),Q[ne].m(G,null))}for(xe(),ne=he.length;ne<Q.length;ne+=1)ue(ne);Fe()}if(re[0]&2163024){we=de(W[6]);let ne;for(ne=0;ne<we.length;ne+=1){const je=fl(W,we,ne);fe[ne]?(fe[ne].p(je,re),x(fe[ne],1)):(fe[ne]=wl(je),fe[ne].c(),x(fe[ne],1),fe[ne].m(H,null))}for(xe(),ne=we.length;ne<fe.length;ne+=1)He(ne);Fe()}(!ce||re[0]&256)&&$(V,"hidden",W[8]),(!ce||re[0]&256)&&$(t,"collapsed",W[8]),(!ce||re[0]&4194304&&se!==(se=Te(`${W[22].class||""}`)+" svelte-1rg0xw5"))&&m(e,"class",se)},i(W){if(!ce){x(i.$$.fragment,W),x(g.$$.fragment,W),x(v.$$.fragment,W),x(E.$$.fragment,W),x(R.$$.fragment,W);for(let re=0;re<he.length;re+=1)x(Q[re]);for(let re=0;re<we.length;re+=1)x(fe[re]);ce=!0}},o(W){q(i.$$.fragment,W),q(g.$$.fragment,W),q(v.$$.fragment,W),q(E.$$.fragment,W),q(R.$$.fragment,W),Q=Q.filter(Boolean);for(let re=0;re<Q.length;re+=1)q(Q[re]);fe=fe.filter(Boolean);for(let re=0;re<fe.length;re+=1)q(fe[re]);ce=!1},d(W){W&&p(e),ye(i),ye(g),ye(v),ye(E),ye(R),Ve(Q,W),Ve(fe,W),Ee=!1,Qe(oe)}}}const El=s=>s.interval,Cl=s=>s.interval;function Ao(s,e,t){let l,n,r,o,a,c,i,d,f;_e(s,nt,G=>t(30,a=G)),_e(s,lt,G=>t(31,c=G)),_e(s,Mt,G=>t(32,i=G)),_e(s,Us,G=>t(24,d=G));let g="C",_="Major",h=Kt(g,_),v="",N,k=[],E=[];const V=ms().map(G=>({key:G.names[0],value:G.names[0]})),K=_t(Oe(!0),{key:"chords-hidden"});_e(s,K,G=>t(8,f=G));function S(){K.update(G=>!G)}function T(){const G=N&&60+N.semitones;if("err"in h||!G)t(3,k=[]),t(4,E=[]);else{const le=h.data;t(3,k=n.map(H=>ls(G,le,H.intervals))),t(4,E=r.map(H=>ls(G,le,H.intervals)))}}function A({currentTarget:{value:G}}){t(0,g=`${G.charAt(0).toUpperCase()}${G.charAt(1).toLowerCase()}`),h=Kt(g,_),T()}function w(G){var le;return t(1,_=(le=V.find(H=>G===H.key))==null?void 0:le.value),h=Kt(g,_),T(),!1}function D({currentTarget:{value:G}}){t(2,v=`${G.charAt(0).toUpperCase()}${G.charAt(1).toLowerCase()}`),t(9,N=Ms(v)),T()}function P(G){Le.toggleChords(le=>le.name===G.name?!le.selected:le.selected)}function I(){const G=H=>H.suffixes[0]==="maj"||H.suffixes[0]==="m",le=d.filter(G).every(H=>H.selected);Le.toggleChords(H=>G(H)?!le:H.selected)}function O(){const G=H=>H.suffixes[0]==="maj7"||H.suffixes[0]==="m7"||H.suffixes[0]==="7"||H.suffixes[0]==="dim7"||H.suffixes[0]==="aug7",le=d.filter(G).every(H=>H.selected);Le.toggleChords(H=>G(H)?!le:H.selected)}function R(){Le.toggleChords(G=>!o)}function M(){Le.toggleChords(G=>!0)}function F(G){if("err"in h)return;const le=i[0].midi+((N==null?void 0:N.semitones)||0),H=ls(le,h.data,G.intervals);c==null||c.playChord(H.map(se=>se.midi),a.fixedVelocity)}const X=G=>P(G),ie=G=>F(G),Y=G=>P(G),z=G=>F(G);return s.$$set=G=>{t(22,e=Ae(Ae({},e),Se(G)))},s.$$.update=()=>{s.$$.dirty[0]&16777216&&t(23,l=d),s.$$.dirty[0]&8388608&&t(7,n=l.filter((G,le)=>le<l.length/2)),s.$$.dirty[0]&8388608&&t(6,r=l.filter((G,le)=>le>=l.length/2)),s.$$.dirty[0]&8388608&&t(5,o=l.every(G=>G.selected))},e=Se(e),[g,_,v,k,E,o,r,n,f,N,V,K,S,A,w,D,P,I,O,R,M,F,e,l,d,X,ie,Y,z]}class So extends We{constructor(e){super(),qe(this,e,Ao,To,Je,{},null,[-1,-1])}}function Il(s,e,t){const l=s.slice();return l[12]=e[t],l}function No(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){U(t,e,l)},p:me,i:me,o:me,d(t){t&&p(e)}}}function Do(s){let e,t,l="Played:",n,r=de(s[2]),o=[];for(let a=0;a<r.length;a+=1)o[a]=Tl(Il(s,r,a));return{c(){e=b("div"),t=b("span"),t.textContent=l,n=j();for(let a=0;a<o.length;a+=1)o[a].c()},l(a){e=y(a,"DIV",{});var c=C(e);t=y(c,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1g6xxhn"&&(t.textContent=l),n=B(c);for(let i=0;i<o.length;i+=1)o[i].l(c);c.forEach(p)},m(a,c){U(a,e,c),u(e,t),u(e,n);for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(e,null)},p(a,c){if(c&4){r=de(a[2]);let i;for(i=0;i<r.length;i+=1){const d=Il(a,r,i);o[i]?o[i].p(d,c):(o[i]=Tl(d),o[i].c(),o[i].m(e,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=r.length}},i:me,o:me,d(a){a&&p(e),Ve(o,a)}}}function Lo(s){let e,t,l="Result:",n,r,o,a=s[0].correct+"",c,i,d=s[0].sampled.length+"",f,g,_,h,v,N=s[0].avgTime+"",k,E;return{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),o=Z("["),c=Z(a),i=Z(" / "),f=Z(d),g=Z("]"),_=j(),h=b("span"),v=Z("avg "),k=Z(N),E=Z("s"),this.h()},l(L){e=y(L,"DIV",{class:!0});var V=C(e);t=y(V,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1eqfbgx"&&(t.textContent=l),n=B(V),r=y(V,"SPAN",{class:!0});var K=C(r);o=ee(K,"["),c=ee(K,a),i=ee(K," / "),f=ee(K,d),g=ee(K,"]"),K.forEach(p),_=B(V),h=y(V,"SPAN",{});var S=C(h);v=ee(S,"avg "),k=ee(S,N),E=ee(S,"s"),S.forEach(p),V.forEach(p),this.h()},h(){m(r,"class","mx-2"),m(e,"class","flex")},m(L,V){U(L,e,V),u(e,t),u(e,n),u(e,r),u(r,o),u(r,c),u(r,i),u(r,f),u(r,g),u(e,_),u(e,h),u(h,v),u(h,k),u(h,E)},p(L,V){V&1&&a!==(a=L[0].correct+"")&&pe(c,a),V&1&&d!==(d=L[0].sampled.length+"")&&pe(f,d),V&1&&N!==(N=L[0].avgTime+"")&&pe(k,N)},i:me,o:me,d(L){L&&p(e)}}}function Po(s){var D,P,I,O;let e,t,l="Target:",n,r,o=((D=s[0].latestGuess.target)==null?void 0:D.chord)+"",a,c,i,d=((P=s[0].latestGuess.target)==null?void 0:P.notes.map(Al).join(" "))+"",f,g,_,h,v,N,k,E,L=((I=s[0].latestGuess.guessed)==null?void 0:I.chord)+"",V,K,S,T=((O=s[0].latestGuess.guessed)==null?void 0:O.notes.map(Sl).join(" "))+"",A,w;return v=new Re({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),a=Z(o),c=j(),i=b("span"),f=Z(d),g=j(),_=b("span"),h=b("div"),ge(v.$$.fragment),N=Z(`
        Guessed:`),k=j(),E=b("span"),V=Z(L),K=j(),S=b("span"),A=Z(T),this.h()},l(R){e=y(R,"DIV",{class:!0});var M=C(e);t=y(M,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1pddpsb"&&(t.textContent=l),n=B(M),r=y(M,"SPAN",{});var F=C(r);a=ee(F,o),F.forEach(p),c=B(M),i=y(M,"SPAN",{});var X=C(i);f=ee(X,d),X.forEach(p),g=B(M),_=y(M,"SPAN",{class:!0});var ie=C(_);h=y(ie,"DIV",{class:!0});var Y=C(h);ve(v.$$.fragment,Y),Y.forEach(p),N=ee(ie,`
        Guessed:`),ie.forEach(p),k=B(M),E=y(M,"SPAN",{});var z=C(E);V=ee(z,L),z.forEach(p),K=B(M),S=y(M,"SPAN",{});var G=C(S);A=ee(G,T),G.forEach(p),M.forEach(p),this.h()},h(){m(h,"class","absolute left-[-2rem] p-1"),m(_,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(R,M){U(R,e,M),u(e,t),u(e,n),u(e,r),u(r,a),u(e,c),u(e,i),u(i,f),u(e,g),u(e,_),u(_,h),be(v,h,null),u(_,N),u(e,k),u(e,E),u(E,V),u(e,K),u(e,S),u(S,A),w=!0},p(R,M){var X,ie,Y,z;(!w||M&1)&&o!==(o=((X=R[0].latestGuess.target)==null?void 0:X.chord)+"")&&pe(a,o),(!w||M&1)&&d!==(d=((ie=R[0].latestGuess.target)==null?void 0:ie.notes.map(Al).join(" "))+"")&&pe(f,d);const F={};M&2&&(F.icon=R[1]==="correct"?Bt:Gt),v.$set(F),(!w||M&1)&&L!==(L=((Y=R[0].latestGuess.guessed)==null?void 0:Y.chord)+"")&&pe(V,L),(!w||M&1)&&T!==(T=((z=R[0].latestGuess.guessed)==null?void 0:z.notes.map(Sl).join(" "))+"")&&pe(A,T)},i(R){w||(x(v.$$.fragment,R),w=!0)},o(R){q(v.$$.fragment,R),w=!1},d(R){R&&p(e),ye(v)}}}function Vo(s){let e,t,l="Target:",n,r,o=s[0].latestGuess.target+"",a,c,i,d,f,g,_,h,v,N,k=s[0].latestGuess.guessed+"",E,L,V,K;return _=new Re({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),a=Z(o),c=j(),i=b("span"),d=j(),f=b("span"),g=b("div"),ge(_.$$.fragment),h=Z(`
        Guessed:`),v=j(),N=b("span"),E=Z(k),L=j(),V=b("span"),this.h()},l(S){e=y(S,"DIV",{class:!0});var T=C(e);t=y(T,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=B(T),r=y(T,"SPAN",{});var A=C(r);a=ee(A,o),A.forEach(p),c=B(T),i=y(T,"SPAN",{}),C(i).forEach(p),d=B(T),f=y(T,"SPAN",{class:!0});var w=C(f);g=y(w,"DIV",{class:!0});var D=C(g);ve(_.$$.fragment,D),D.forEach(p),h=ee(w,`
        Guessed:`),w.forEach(p),v=B(T),N=y(T,"SPAN",{});var P=C(N);E=ee(P,k),P.forEach(p),L=B(T),V=y(T,"SPAN",{}),C(V).forEach(p),T.forEach(p),this.h()},h(){m(g,"class","absolute left-[-2rem] p-1"),m(f,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(S,T){U(S,e,T),u(e,t),u(e,n),u(e,r),u(r,a),u(e,c),u(e,i),u(e,d),u(e,f),u(f,g),be(_,g,null),u(f,h),u(e,v),u(e,N),u(N,E),u(e,L),u(e,V),K=!0},p(S,T){(!K||T&1)&&o!==(o=S[0].latestGuess.target+"")&&pe(a,o);const A={};T&2&&(A.icon=S[1]==="correct"?Bt:Gt),_.$set(A),(!K||T&1)&&k!==(k=S[0].latestGuess.guessed+"")&&pe(E,k)},i(S){K||(x(_.$$.fragment,S),K=!0)},o(S){q(_.$$.fragment,S),K=!1},d(S){S&&p(e),ye(_)}}}function Oo(s){let e,t,l="Target:",n,r,o=s[8](s[0].latestGuess.target||0)+"",a,c,i,d,f,g,_,h,v,N,k=s[8](s[0].latestGuess.guessed||0)+"",E,L,V,K="",S;return _=new Re({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),a=Z(o),c=j(),i=b("span"),d=j(),f=b("span"),g=b("div"),ge(_.$$.fragment),h=Z(`
        Guessed:`),v=j(),N=b("span"),E=Z(k),L=j(),V=b("span"),V.innerHTML=K,this.h()},l(T){e=y(T,"DIV",{class:!0});var A=C(e);t=y(A,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=B(A),r=y(A,"SPAN",{});var w=C(r);a=ee(w,o),w.forEach(p),c=B(A),i=y(A,"SPAN",{}),C(i).forEach(p),d=B(A),f=y(A,"SPAN",{class:!0});var D=C(f);g=y(D,"DIV",{class:!0});var P=C(g);ve(_.$$.fragment,P),P.forEach(p),h=ee(D,`
        Guessed:`),D.forEach(p),v=B(A),N=y(A,"SPAN",{});var I=C(N);E=ee(I,k),I.forEach(p),L=B(A),V=y(A,"SPAN",{"data-svelte-h":!0}),ae(V)!=="svelte-1qufua2"&&(V.innerHTML=K),A.forEach(p),this.h()},h(){m(g,"class","absolute left-[-2rem] p-1"),m(f,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(T,A){U(T,e,A),u(e,t),u(e,n),u(e,r),u(r,a),u(e,c),u(e,i),u(e,d),u(e,f),u(f,g),be(_,g,null),u(f,h),u(e,v),u(e,N),u(N,E),u(e,L),u(e,V),S=!0},p(T,A){(!S||A&1)&&o!==(o=T[8](T[0].latestGuess.target||0)+"")&&pe(a,o);const w={};A&2&&(w.icon=T[1]==="correct"?Bt:Gt),_.$set(w),(!S||A&1)&&k!==(k=T[8](T[0].latestGuess.guessed||0)+"")&&pe(E,k)},i(T){S||(x(_.$$.fragment,T),S=!0)},o(T){q(_.$$.fragment,T),S=!1},d(T){T&&p(e),ye(_)}}}function Tl(s){let e,t=ft(s[12])+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","mx-1")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r&4&&t!==(t=ft(n[12])+"")&&pe(l,t)},d(n){n&&p(e)}}}function jo(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){U(t,e,l)},p:me,d(t){t&&p(e)}}}function Bo(s){let e,t="Next",l,n,r="Autoplay",o,a;return{c(){e=b("button"),e.textContent=t,l=j(),n=b("button"),n.textContent=r,this.h()},l(c){e=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-uy473n"&&(e.textContent=t),l=B(c),n=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-1cfj1sl"&&(n.textContent=r),this.h()},h(){m(e,"class","btn primary mr-1"),m(n,"class","btn primary")},m(c,i){U(c,e,i),U(c,l,i),U(c,n,i),o||(a=[J(e,"click",s[4]),J(n,"click",s[5])],o=!0)},p:me,d(c){c&&(p(e),p(l),p(n)),o=!1,Qe(a)}}}function Go(s){let e,t="Stop autoplay",l,n;return{c(){e=b("button"),e.textContent=t,this.h()},l(r){e=y(r,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){m(e,"class","btn primary")},m(r,o){U(r,e,o),l||(n=J(e,"click",s[10]),l=!0)},p:me,d(r){r&&p(e),l=!1,n()}}}function Mo(s){let e,t="Try Again",l,n,r="Clear",o,a;return{c(){e=b("button"),e.textContent=t,l=j(),n=b("button"),n.textContent=r,this.h()},l(c){e=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-15zs1cu"&&(e.textContent=t),l=B(c),n=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-11mnk9v"&&(n.textContent=r),this.h()},h(){m(e,"class","btn primary mr-1"),m(n,"class","btn primary")},m(c,i){U(c,e,i),U(c,l,i),U(c,n,i),o||(a=[J(e,"click",s[6]),J(n,"click",s[7])],o=!0)},p:me,d(c){c&&(p(e),p(l),p(n)),o=!1,Qe(a)}}}function Ro(s){let e,t,l,n,r,o,a;const c=[Oo,Vo,Po,Lo,Do,No],i=[];function d(h,v){return h[0]instanceof Ot&&(h[1]==="correct"||h[1]==="wrong")?0:h[0]instanceof xt&&(h[1]==="correct"||h[1]==="wrong")?1:h[0]instanceof ht&&(h[1]==="correct"||h[1]==="wrong")?2:h[0]&&h[1]==="ended"?3:h[2].length>0?4:5}t=d(s),l=i[t]=c[t](s);function f(h,v){return h[0]&&h[1]==="ended"?Mo:h[0]&&h[3].autoplay?Go:h[0]?Bo:jo}let g=f(s),_=g(s);return{c(){e=b("div"),l.c(),r=j(),o=b("div"),_.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var v=C(e);l.l(v),v.forEach(p),r=B(h),o=y(h,"DIV",{class:!0});var N=C(o);_.l(N),N.forEach(p),this.h()},h(){m(e,"class",n=Te(`${s[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),m(o,"class","mt-2 h-8 flex items-center")},m(h,v){U(h,e,v),i[t].m(e,null),U(h,r,v),U(h,o,v),_.m(o,null),a=!0},p(h,[v]){let N=t;t=d(h),t===N?i[t].p(h,v):(xe(),q(i[N],1,1,()=>{i[N]=null}),Fe(),l=i[t],l?l.p(h,v):(l=i[t]=c[t](h),l.c()),x(l,1),l.m(e,null)),(!a||v&512&&n!==(n=Te(`${h[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"))&&m(e,"class",n),g===(g=f(h))&&_?_.p(h,v):(_.d(1),_=g(h),_&&(_.c(),_.m(o,null)))},i(h){a||(x(l),a=!0)},o(h){q(l),a=!1},d(h){h&&(p(e),p(r),p(o)),i[t].d(),_.d()}}}const Al=s=>s.note,Sl=s=>s.note;function Uo(s,e,t){let l,n,r,o;_e(s,Ct,h=>t(11,l=h)),_e(s,dt,h=>t(1,n=h)),_e(s,kt,h=>t(2,r=h)),_e(s,mt,h=>t(3,o=h));let{game:a}=e;function c(){Le.nextGuess()}function i(){Le.setOptionValue("autoplay",!0),Le.nextGuess()}function d(){a instanceof ht?Le.play(a.type,a.opts):a&&Le.play(a.type,void 0)}function f(){Le.clearGame()}function g(h){const v=l.notesMap.get(h%12);return ft({midi:h,...v})}const _=()=>Le.setOptionValue("autoplay",!1);return s.$$set=h=>{t(9,e=Ae(Ae({},e),Se(h))),"game"in h&&t(0,a=h.game)},e=Se(e),[a,n,r,o,c,i,d,f,g,e,_]}class Ko extends We{constructor(e){super(),qe(this,e,Uo,Ro,Je,{game:0})}}const Ls={ar:{name:"Arabic",import:Ce(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:Ce(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:Ce(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:Ce(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:Ce(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:Ce(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:Ce(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:Ce(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:Ce(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>Fo)},fa:{name:"Farsi",import:Ce(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:Ce(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:Ce(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:Ce(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:Ce(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:Ce(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:Ce(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:Ce(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:Ce(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:Ce(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:Ce(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:Ce(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:Ce(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:Ce(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:Ce(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:Ce(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:Ce(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:Ce(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:Ce(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:Ce(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:Ce(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:Ce(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:Ce(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:Ce(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function Tn(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default,shift:s.layout.shift}}async function xo(s=["en"]){let e={code:"en",layout:Ls.en,index:99};Object.entries(Ls).forEach(([l,n])=>{for(let r=0;r<s.length;r+=1)l===s[r]&&(!e||e.index>r)&&(e={code:l,layout:n,index:r})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:Tn(t.default)}}const An={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Fo=Object.freeze(Object.defineProperty({__proto__:null,default:An},Symbol.toStringTag,{value:"Module"})),Ho=[0,2,4,5,7,9,11],zo=[1,3,-1,6,8,10,-1];function Wo(s,e,t){const l=t?[0,2,4,5,7,9,11]:[-1,1,3,-1,6,8,10],n=l[s%l.length];if(n>=0){const r=e[n],o=Math.floor(s/l.length);return{...r,semitones:r.semitones+(o>0?o:0)*12}}}function Vt(s,e,t,l=0,n=0){const r=t?Ho:zo;let o=-1,a=0,c=0;return s.forEach((i,d)=>{if(i.key.charAt(0)!=="{"&&d>=l&&o===-1?o=d:o!==-1&&i.key==="{empty}"&&(a+=1),o!==-1&&i.key.charAt(0)!=="{"){const f=d-a-o+n,g=r[f%r.length];if(g>=0){const _=e[g],h=Math.floor(f/r.length);i.note={..._,semitones:_.semitones+(h>0?h:0)*12},i.note,c=d-o}}}),{firstIndex:o,lastIndex:c}}const ts=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function qo(s){let e=[];const t=s.default.map((l,n)=>{if(n===0){const r=l.split(" ").filter(o=>o!=="{bksp}");for(;r.length!==13;)r.length<13?r.unshift("{empty}"):r.shift();return[...r,"{bksp}"]}else if(n===1){const r=l.split(" ");return e=r.slice(13),[...r.slice(0,13),"{enter}"]}else{if(n===2)return[...l.split(" ").slice(0,13).filter(r=>r!=="{enter}"),...e].slice(0,13);if(n===3){const r=["{shift}",...l.split(" ").slice(1,12).filter(a=>a!=="{shift}"),"{shift}"];let o=1;for(;r.length<13;)r.splice(o,0,"{empty}"),o=o===1?-1:1;return r}else return l.split(" ")}});return[t[0].map((l,n)=>({key:l,code:ts[0][n]})),t[1].map((l,n)=>({key:l,code:ts[1][n]})),t[2].map((l,n)=>({key:l,code:ts[2][n]})),t[3].map((l,n)=>({key:l,code:ts[3][n]}))]}class ps{constructor(e){return this.rows=[[],[],[],[]],this.setCustomRow={row:[],rowIndex:0,startKeyIndex:0,nextKeyIdx:-1,nextNoteOffset:0,whiteKeys:!1},this.opts={hotkeydRows:"middle-row",isCustom:!1,layout:{code:"en",name:"English",imported:Tn(An)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=qo(e),this}setRows(e){return this.rows=e,this}setNotes(e){if(this.opts.hotkeydRows==="middle-row"){const{firstIndex:t}=Vt(this.rows[2],e,!0);Vt(this.rows[1],e,!1,1+t)}else{const{firstIndex:t,lastIndex:l}=Vt(this.rows[3],e,!0);Vt(this.rows[2],e,!1,t);const{firstIndex:n}=Vt(this.rows[1],e,!0,0,l+1);Vt(this.rows[0],e,!1,1+n,l+1)}}startSetCustomRow(e){let t=-1,l=0;const n=this.rows[e].map(a=>({...a}));for(let a=0;a<n.length;a+=1){const c=n[a].key.charAt(0)==="{"&&n[a].key!=="{empty}";!c&&t===-1&&(t=a),l+=c?0:1}if(t===-1)throw console.error(n),Error("No valid keyboard key found!");const{hotkeydRows:r}=this.opts,o=r==="two-rows"?e===1||e===3:e===2;return this.setCustomRow={row:n,rowIndex:e,startKeyIndex:t,nextKeyIdx:t,nextNoteOffset:0,whiteKeys:o},{first:t,count:l}}setNextCustomNote(e,t,l){let n;const{startKeyIndex:r,nextKeyIdx:o,nextNoteOffset:a,whiteKeys:c}=this.setCustomRow,i=Wo(o-a-r,l,c);return i?n={key:e,code:t,note:i}:n={key:e,code:t},this.setCustomRow.nextKeyIdx+=1,{index:this.setCustomRow.nextKeyIdx,key:n}}skipNextCustomNote(){return this.setCustomRow.nextKeyIdx+=1,this.setCustomRow.nextNoteOffset+=1,{index:this.setCustomRow.nextKeyIdx,key:{code:"EMPTY",key:"{empty}"}}}static createWithRows(e,t){return new ps(e).setRows(t)}}function Jo(s){const e=[...s.map(t=>t.map(l=>l.key).join(" ")),""];return{default:e,shift:e}}function Nl(s,e,t){const l=s.slice();return l[15]=e[t].key,l[16]=e[t].value,l[17]=e[t].icon,l[19]=t,l}const $o=s=>({}),Dl=s=>({}),Yo=s=>({}),Ll=s=>({});function Pl(s){let e,t,l,n,r,o,a,c,i,d,f;const g=s[12].header,_=Vs(g,s,s[11],Dl);let h=de(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=Vl(Nl(s,h,k));const N=k=>q(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),l=j(),n=b("ul"),r=b("li"),_&&_.c(),o=j();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(p),l=B(k),n=y(k,"UL",{class:!0});var E=C(n);r=y(E,"LI",{});var L=C(r);_&&_.l(L),L.forEach(p),o=B(E);for(let V=0;V<v.length;V+=1)v[V].l(E);E.forEach(p),this.h()},h(){m(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),m(e,"tabindex","-1"),m(n,"class",a=Te(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,E){U(k,e,E),U(k,l,E),U(k,n,E),u(n,r),_&&_.m(r,null),u(n,o);for(let L=0;L<v.length;L+=1)v[L]&&v[L].m(n,null);i=!0,d||(f=J(e,"click",s[7]),d=!0)},p(k,E){if(s=k,_&&_.p&&(!i||E&2048)&&Os(_,g,s,s[11],i?Bs(g,s[11],E,$o):js(s[11]),Dl),E&265){h=de(s[0]);let L;for(L=0;L<h.length;L+=1){const V=Nl(s,h,L);v[L]?(v[L].p(V,E),x(v[L],1)):(v[L]=Vl(V),v[L].c(),x(v[L],1),v[L].m(n,null))}for(xe(),L=h.length;L<v.length;L+=1)N(L);Fe()}(!i||E&4&&a!==(a=Te(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&m(n,"class",a)},i(k){if(!i){k&&ns(()=>{i&&(t||(t=wt(e,os,{duration:ss},!0)),t.run(1))}),x(_,k);for(let E=0;E<h.length;E+=1)x(v[E]);k&&ns(()=>{i&&(c||(c=wt(n,rs,{duration:ss},!0)),c.run(1))}),i=!0}},o(k){k&&(t||(t=wt(e,os,{duration:ss},!1)),t.run(0)),q(_,k),v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)q(v[E]);k&&(c||(c=wt(n,rs,{duration:ss},!1)),c.run(0)),i=!1},d(k){k&&(p(e),p(l),p(n)),k&&t&&t.end(),_&&_.d(k),Ve(v,k),k&&c&&c.end(),d=!1,f()}}}function Qo(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","w-[24px]")},m(t,l){U(t,e,l)},p:me,i:me,o:me,d(t){t&&p(e)}}}function Xo(s){let e,t;return e=new Re({props:{class:"mr-2",icon:s[17],width:16}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const r={};n&1&&(r.icon=l[17]),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){q(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function Vl(s){let e,t,l,n,r,o,a=s[16]+"",c,i,d,f,g;const _=[Xo,Qo],h=[];function v(k,E){return k[17]?0:1}l=v(s),n=h[l]=_[l](s);function N(){return s[13](s[15])}return{c(){e=b("li"),t=b("button"),n.c(),r=j(),o=b("div"),c=Z(a),i=j(),this.h()},l(k){e=y(k,"LI",{});var E=C(e);t=y(E,"BUTTON",{class:!0});var L=C(t);n.l(L),r=B(L),o=y(L,"DIV",{});var V=C(o);c=ee(V,a),V.forEach(p),L.forEach(p),i=B(E),E.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),$(t,"selected",s[15]===s[3])},m(k,E){U(k,e,E),u(e,t),h[l].m(t,null),u(t,r),u(t,o),u(o,c),u(e,i),d=!0,f||(g=J(t,"click",N),f=!0)},p(k,E){s=k;let L=l;l=v(s),l===L?h[l].p(s,E):(xe(),q(h[L],1,1,()=>{h[L]=null}),Fe(),n=h[l],n?n.p(s,E):(n=h[l]=_[l](s),n.c()),x(n,1),n.m(t,r)),(!d||E&1)&&a!==(a=s[16]+"")&&pe(c,a),(!d||E&9)&&$(t,"selected",s[15]===s[3])},i(k){d||(x(n),d=!0)},o(k){q(n),d=!1},d(k){k&&p(e),h[l].d(),f=!1,g()}}}function Zo(s){let e,t,l,n,r,o,a,c,i;const d=s[12].value,f=Vs(d,s,s[11],Ll);let g=s[6]&&Pl(s);return{c(){e=b("div"),t=b("button"),f&&f.c(),r=j(),g&&g.c(),this.h()},l(_){e=y(_,"DIV",{class:!0,id:!0});var h=C(e);t=y(h,"BUTTON",{class:!0,title:!0});var v=C(t);f&&f.l(v),v.forEach(p),r=B(h),g&&g.l(h),h.forEach(p),this.h()},h(){m(t,"class",l=Te(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),m(t,"title",n=s[9].title||""),$(t,"disabled",s[4]),$(t,"open",s[6]),m(e,"class",o=Te(`relative ${s[2]||""}`)+" svelte-h65upg"),m(e,"id",s[1])},m(_,h){U(_,e,h),u(e,t),f&&f.m(t,null),u(e,r),g&&g.m(e,null),s[14](e),a=!0,c||(i=J(t,"click",s[7]),c=!0)},p(_,[h]){f&&f.p&&(!a||h&2048)&&Os(f,d,_,_[11],a?Bs(d,_[11],h,Yo):js(_[11]),Ll),(!a||h&512&&l!==(l=Te(`${_[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&m(t,"class",l),(!a||h&512&&n!==(n=_[9].title||""))&&m(t,"title",n),(!a||h&528)&&$(t,"disabled",_[4]),(!a||h&576)&&$(t,"open",_[6]),_[6]?g?(g.p(_,h),h&64&&x(g,1)):(g=Pl(_),g.c(),x(g,1),g.m(e,null)):g&&(xe(),q(g,1,1,()=>{g=null}),Fe()),(!a||h&4&&o!==(o=Te(`relative ${_[2]||""}`)+" svelte-h65upg"))&&m(e,"class",o),(!a||h&2)&&m(e,"id",_[1])},i(_){a||(x(f,_),x(g),a=!0)},o(_){q(f,_),q(g),a=!1},d(_){_&&p(e),f&&f.d(_),g&&g.d(),s[14](null),c=!1,i()}}}const ss=400;function er(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:r,id:o=void 0,containerClass:a=void 0,selected:c=void 0,disabled:i=void 0,onSelect:d}=e,f,g=!1;function _(){i||t(6,g=!g)}function h(k){t(6,g=d(k))}const v=k=>h(k);function N(k){Gs[k?"unshift":"push"](()=>{f=k,t(5,f)})}return s.$$set=k=>{t(9,e=Ae(Ae({},e),Se(k))),"options"in k&&t(0,r=k.options),"id"in k&&t(1,o=k.id),"containerClass"in k&&t(2,a=k.containerClass),"selected"in k&&t(3,c=k.selected),"disabled"in k&&t(4,i=k.disabled),"onSelect"in k&&t(10,d=k.onSelect),"$$scope"in k&&t(11,n=k.$$scope)},e=Se(e),[r,o,a,c,i,f,g,_,h,e,d,n,l,v,N]}class tr extends We{constructor(e){super(),qe(this,e,er,Zo,Je,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function sr(s){let e,t,l,n,r,o,a;return{c(){e=b("label"),t=b("input"),l=j(),n=b("div"),this.h()},l(c){e=y(c,"LABEL",{class:!0});var i=C(e);t=y(i,"INPUT",{type:!0,class:!0}),l=B(i),n=y(i,"DIV",{class:!0}),C(n).forEach(p),i.forEach(p),this.h()},h(){t.checked=s[0],m(t,"type","checkbox"),m(t,"class","svelte-k5zciy"),m(n,"class","slider svelte-k5zciy"),m(e,"class",r=Te(`${s[3].class||""} toggle`)+" svelte-k5zciy")},m(c,i){U(c,e,i),u(e,t),s[5](t),u(e,l),u(e,n),o||(a=[J(t,"change",s[4]),J(t,"keydown",s[2])],o=!0)},p(c,[i]){i&1&&(t.checked=c[0]),i&8&&r!==(r=Te(`${c[3].class||""} toggle`)+" svelte-k5zciy")&&m(e,"class",r)},i:me,o:me,d(c){c&&p(e),s[5](null),o=!1,Qe(a)}}}function lr(s,e,t){let{checked:l}=e,n;function r(c){c.key==="Enter"&&n.click()}function o(c){hs.call(this,s,c)}function a(c){Gs[c?"unshift":"push"](()=>{n=c,t(1,n)})}return s.$$set=c=>{t(3,e=Ae(Ae({},e),Se(c))),"checked"in c&&t(0,l=c.checked)},e=Se(e),[l,n,r,e,o,a]}class nr extends We{constructor(e){super(),qe(this,e,lr,sr,Je,{checked:0})}}function or(s,e,t){return e==="Escape"?{e:"hotkeys-cancel"}:e==="Space"?{e:"hotkeys-skip-key"}:s.has(e)?{e:"hotkeys-no-key"}:(s.add(e),{e:"hotkeys-captured-key",data:{code:e,key:t}})}const Ks=/^[a-gA-G]$/,Sn=/^[♭Bb#♯sS]$/,rr=/^[0-9]$/;let te="",Ye;function ar(s,e){const{useHotkeys:t}=Ie(nt),l=Ie(xs).get(s);if(t&&te.length===0&&l&&l.note)return te="",{e:"guessed-key",data:l.note.note};if(!t&&te.length===0&&Ks.test(e))return te+=e.toUpperCase(),{e:"string",data:te};if(!t&&te.length>0&&Sn.test(e))return e==="b"||e==="B"?te+="♭":te+="♯",{e:"string",data:te};if(s==="Backspace"&&te.length>0)return te=te.slice(0,-1),{e:"string",data:te};if(s==="Enter"&&te.length>0){const n=te;return te="",{e:"guessed-key",data:n}}return!1}function ir(s,e){if(s==="Enter"&&te.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let l=0;l<te.length;l+=1)l===0?t.note+=te[l]:t.chord.length>0?t.chord+=te[l].toLowerCase():te[l]==="♭"?(t.note+=te[l],t.flats+=1):te[l]==="♯"?(t.note+=te[l],t.sharps+=1):t.chord+=te[l].toLowerCase();return te="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&te.length>0)return te=te.slice(0,-1),{e:"string",data:te};if(te.length===0&&Ks.test(e))return te+=e.toUpperCase(),{e:"string",data:te};if(te.length>0&&e.length===1)return te.length===1&&(e==="b"||e==="B")?te+="♭":te.length===1&&e==="#"?te+="♯":te+=e,{e:"string",data:te}}return!1}function cr(s,e,t){const{useAutoOctave:l,useHotkeys:n}=Ie(nt);let r;const a=Ie(xs).get(s),c=(a==null?void 0:a.key)||"";let i=!1;if(!Ye&&n&&(a!=null&&a.note)?(Ye=a.note,l&&(r=us({midi:Ie(Mt)[0].midi,flats:0,sharps:0})),i="note"):!n&&te.length===0&&Ks.test(e)?(te+=e.toUpperCase(),i="input"):!n&&te.length>0&&Sn.test(e)?(e==="b"||e==="B"?te+="♭":te+="♯",i="input"):!n&&te.length>0&&s==="Enter"&&l&&(r=us({midi:Ie(Mt)[0].midi,flats:0,sharps:0}),i="octave"),!i&&rr.test(c))try{r=parseInt(c),i="octave"}catch{}if(i&&(Ye||te)&&r!==void 0){const d=(Ye==null?void 0:Ye.note)??te;return t&&(r+=1),Ye&&(Ye==null?void 0:Ye.semitones)>=12&&(r+=Math.floor(Ye.semitones/12)),Ye=void 0,te="",{e:"guessed-note",data:{note:d,octave:r}}}else if(s==="Backspace"&&(Ye||te.length>0))return Ye=void 0,te=te.slice(0,-1),{e:"string",data:te};return i==="note"?{e:"note",data:Ye}:i==="input"?{e:"string",data:te}:!1}const gs={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Ts=new Set,Nn=new ps({layout:gs}),It=Oe(void 0);Rt(It,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const Ol=Oe(gs),ct=_t(Oe({isCustom:!1,layout:gs,hotkeydRows:"middle-row"}),{key:"keyboard-options"}),jt=Oe(Nn.rows),ds=Rt([Ct,ct],([s,e])=>{const t=new ps(e);return t.setNotes(Array.from(s.notesMap.values())),jt.set(t.rows),t}),xs=Rt(ds,s=>new Map([...s.rows[0].map(e=>[e.code,e]),...s.rows[1].map(e=>[e.code,e]),...s.rows[2].map(e=>[e.code,e]),...s.rows[3].map(e=>[e.code,e])])),ur=Rt(xs,s=>Array.from(s.values()).map(e=>e.note).filter(e=>e!==void 0).sort((e,t)=>e.semitones-t.semitones)),ut={async setLayout(s){const e=await xo(s),t=Ie(ct);e.code!==t.layout.code&&(ct.update(l=>({...l,isCustom:!1,layout:e})),Ol.set(e))},setCustomLayout(s){if(s)ct.update(e=>({...e,isCustom:s,layout:{code:"custom",name:"Custom",imported:{...e.layout.imported}}}));else{const e=Ie(Ol);ct.update(t=>({...t,isCustom:s,layout:e}))}},toggleRows(s){ct.update(e=>({...e,hotkeydRows:s??(e.hotkeydRows==="middle-row"?"two-rows":"middle-row")}))},captureHotkeyRow(s){const e=Ie(ds),t=Ie(Ct),{first:l,count:n}=e.startSetCustomRow(s);It.set({nextIndex:l,rowIndex:s,count:n,scaleNotes:Array.from(t.notesMap.values())})},findNote(s){return Ie(ur).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((l,n)=>l+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleHotkeyInput(s,e,t){const l=or(Ts,e,t),n=Ie(ds);let r;const o=n.setCustomRow.nextKeyIdx;l.e==="hotkeys-cancel"?(It.set(void 0),Ts.clear()):l.e==="hotkeys-skip-key"?r=n.skipNextCustomNote():l.e==="hotkeys-captured-key"&&(r=n.setNextCustomNote(l.data.key,l.data.code,s.scaleNotes));const a=Ie(jt);if(r&&(a[s.rowIndex][o]=r.key,jt.set(a),It.update(c=>c?{...c,nextIndex:r.index}:void 0)),s.count===o){const c=Jo(a);ct.update(i=>({...i,layout:{...i.layout,imported:c}})),It.set(void 0),Ts.clear()}return l},handleInput(s,e,t=!1){const l=Ie(Et),n=Ie(It);return n?this.handleHotkeyInput(n,s,e):l instanceof xt?ar(s,e.toUpperCase()):l instanceof ht&&l.type==="chords-write"?ir(s,e):Ie(nt).useKeyboard?cr(s,e.toUpperCase(),t):!1},reset(){ct.set({isCustom:!1,layout:gs,hotkeydRows:"middle-row"}),jt.set(Nn.rows)}};function jl(s){let e;return{c(){e=b("li"),this.h()},l(t){e=y(t,"LI",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","m-[0.175rem] mr-0")},m(t,l){U(t,e,l)},d(t){t&&p(e)}}}function Bl(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,l){U(t,e,l)},d(t){t&&p(e)}}}function Gl(s){let e,t=s[0].note.note+"",l,n;return{c(){e=b("div"),l=Z(t),n=Z(s[3]),this.h()},l(r){e=y(r,"DIV",{class:!0});var o=C(e);l=ee(o,t),n=ee(o,s[3]),o.forEach(p),this.h()},h(){m(e,"class","absolute top-0 left-0")},m(r,o){U(r,e,o),u(e,l),u(e,n)},p(r,o){o&1&&t!==(t=r[0].note.note+"")&&pe(l,t),o&8&&pe(n,r[3])},d(r){r&&p(e)}}}function fr(s){let e,t,l,n,r,o,a=Rl(s[0].key)+"",c,i,d,f,g=s[0].key==="{enter}"&&jl(),_=s[0].key==="{enter}"&&Bl(),h=s[0].note&&Gl(s);return{c(){g&&g.c(),e=j(),t=b("li"),l=b("button"),_&&_.c(),n=j(),h&&h.c(),r=j(),o=b("div"),c=Z(a),this.h()},l(v){g&&g.l(v),e=B(v),t=y(v,"LI",{class:!0});var N=C(t);l=y(N,"BUTTON",{class:!0});var k=C(l);_&&_.l(k),n=B(k),h&&h.l(k),r=B(k),o=y(k,"DIV",{});var E=C(o);c=ee(E,a),E.forEach(p),k.forEach(p),N.forEach(p),this.h()},h(){m(l,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),$(l,"items-center",!s[0].note),$(l,"items-end",s[0].note),m(t,"class",i=Te(`${s[4].class||""} m-[0.175rem] ${Ml(s[1])} min-w-[32px]`)+" svelte-1479mcy"),$(t,"enter",s[0].key==="{enter}"),$(t,"captured",s[2])},m(v,N){g&&g.m(v,N),U(v,e,N),U(v,t,N),u(t,l),_&&_.m(l,null),u(l,n),h&&h.m(l,null),u(l,r),u(l,o),u(o,c),d||(f=J(l,"click",s[10]),d=!0)},p(v,[N]){v[0].key==="{enter}"?g||(g=jl(),g.c(),g.m(e.parentNode,e)):g&&(g.d(1),g=null),v[0].key==="{enter}"?_||(_=Bl(),_.c(),_.m(l,n)):_&&(_.d(1),_=null),v[0].note?h?h.p(v,N):(h=Gl(v),h.c(),h.m(l,r)):h&&(h.d(1),h=null),N&1&&a!==(a=Rl(v[0].key)+"")&&pe(c,a),N&1&&$(l,"items-center",!v[0].note),N&1&&$(l,"items-end",v[0].note),N&18&&i!==(i=Te(`${v[4].class||""} m-[0.175rem] ${Ml(v[1])} min-w-[32px]`)+" svelte-1479mcy")&&m(t,"class",i),N&19&&$(t,"enter",v[0].key==="{enter}"),N&22&&$(t,"captured",v[2])},i:me,o:me,d(v){v&&(p(e),p(t)),g&&g.d(v),_&&_.d(),h&&h.d(),d=!1,f()}}}function Ml(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function Rl(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function dr(s,e,t){let l,n,r,o,a,c;_e(s,It,_=>t(7,o=_)),_e(s,_s,_=>t(8,a=_)),_e(s,jt,_=>t(9,c=_));let{rowIndex:i,keyIndex:d}=e,f;function g(_){hs.call(this,s,_)}return s.$$set=_=>{t(4,e=Ae(Ae({},e),Se(_))),"rowIndex"in _&&t(5,i=_.rowIndex),"keyIndex"in _&&t(6,d=_.keyIndex)},s.$$.update=()=>{s.$$.dirty&608&&t(0,l=c[i][d]),s.$$.dirty&257&&t(3,n=l.note?us({midi:l.note.semitones+a[0],flats:0,sharps:0}):0),s.$$.dirty&224&&t(2,r=o&&o.rowIndex===i&&o.nextIndex===d),s.$$.dirty&65&&(l.key==="{bksp}"?t(1,f=2):l.key==="{tab}"?t(1,f=1.5):l.key==="{enter}"?t(1,f=2):l.key==="{lock}"?t(1,f=1.75):l.key==="{shift}"&&d===0?t(1,f=1.5):l.key==="{shift}"?t(1,f=2.5):t(1,f=1))},e=Se(e),[l,f,r,n,e,i,d,o,a,c,g]}class hr extends We{constructor(e){super(),qe(this,e,dr,fr,Je,{rowIndex:5,keyIndex:6})}}function Ul(s,e,t){const l=s.slice();return l[13]=e[t],l[15]=t,l}function Kl(s,e,t){const l=s.slice();return l[16]=e[t],l[18]=t,l}function mr(s){let e,t=s[0].layout.name+"",l;return{c(){e=b("div"),l=Z(t),this.h()},l(n){e=y(n,"DIV",{slot:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"slot","value")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r&1&&t!==(t=n[0].layout.name+"")&&pe(l,t)},d(n){n&&p(e)}}}function xl(s){let e,t,l,n,r;t=new Re({props:{icon:Rn,width:20}});function o(){return s[12](s[15])}return{c(){e=b("button"),ge(t.$$.fragment),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var c=C(e);ve(t.$$.fragment,c),c.forEach(p),this.h()},h(){m(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(a,c){U(a,e,c),be(t,e,null),l=!0,n||(r=J(e,"click",o),n=!0)},p(a,c){s=a},i(a){l||(x(t.$$.fragment,a),l=!0)},o(a){q(t.$$.fragment,a),l=!1},d(a){a&&p(e),ye(t),n=!1,r()}}}function Fl(s){let e,t;return e=new hr({props:{rowIndex:s[15],keyIndex:s[18]}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p:me,i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){q(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function Hl(s){let e,t,l,n,r=s[2][s[15]]&&s[0].isCustom&&xl(s),o=de(s[13]),a=[];for(let i=0;i<o.length;i+=1)a[i]=Fl(Kl(s,o,i));const c=i=>q(a[i],1,1,()=>{a[i]=null});return{c(){e=b("li"),r&&r.c(),t=j();for(let i=0;i<a.length;i+=1)a[i].c();l=Pe(),this.h()},l(i){e=y(i,"LI",{class:!0});var d=C(e);r&&r.l(d),d.forEach(p),t=B(i);for(let f=0;f<a.length;f+=1)a[f].l(i);l=Pe(),this.h()},h(){m(e,"class","col-span-2 svelte-1av9wwd")},m(i,d){U(i,e,d),r&&r.m(e,null),U(i,t,d);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(i,d);U(i,l,d),n=!0},p(i,d){if(i[2][i[15]]&&i[0].isCustom?r?(r.p(i,d),d&5&&x(r,1)):(r=xl(i),r.c(),x(r,1),r.m(e,null)):r&&(xe(),q(r,1,1,()=>{r=null}),Fe()),d&8){o=de(i[13]);let f;for(f=0;f<o.length;f+=1){const g=Kl(i,o,f);a[f]?(a[f].p(g,d),x(a[f],1)):(a[f]=Fl(g),a[f].c(),x(a[f],1),a[f].m(l.parentNode,l))}for(xe(),f=o.length;f<a.length;f+=1)c(f);Fe()}},i(i){if(!n){x(r);for(let d=0;d<o.length;d+=1)x(a[d]);n=!0}},o(i){q(r),a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)q(a[d]);n=!1},d(i){i&&(p(e),p(t),p(l)),r&&r.d(),Ve(a,i)}}}function _r(s){let e,t,l,n,r,o="Layout",a,c,i,d,f,g="Custom",_,h,v,N,k,E,L="One row",V,K,S,T,A="Two rows",w,D,P,I,O,R,M,F,X,ie,Y;c=new tr({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1 w-36",options:s[4],onSelect:s[6],$$slots:{value:[mr]},$$scope:{ctx:s}}}),K=new nr({props:{checked:!s[1]}}),K.$on("change",s[9]),I=new Re({props:{icon:Ft,width:16}});let z=de(s[3].rows),G=[];for(let H=0;H<z.length;H+=1)G[H]=Hl(Ul(s,z,H));const le=H=>q(G[H],1,1,()=>{G[H]=null});return{c(){e=b("div"),t=b("div"),l=b("div"),n=b("div"),r=b("label"),r.textContent=o,a=j(),ge(c.$$.fragment),i=j(),d=b("div"),f=b("label"),f.textContent=g,_=j(),h=b("input"),N=j(),k=b("div"),E=b("label"),E.textContent=L,V=j(),ge(K.$$.fragment),S=j(),T=b("label"),T.textContent=A,w=j(),D=b("div"),P=b("button"),ge(I.$$.fragment),O=j(),R=b("div"),M=b("ul");for(let H=0;H<G.length;H+=1)G[H].c();this.h()},l(H){e=y(H,"DIV",{class:!0});var se=C(e);t=y(se,"DIV",{class:!0});var ce=C(t);l=y(ce,"DIV",{class:!0});var Ee=C(l);n=y(Ee,"DIV",{class:!0});var oe=C(n);r=y(oe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(r)!=="svelte-1xsr9lq"&&(r.textContent=o),a=B(oe),ve(c.$$.fragment,oe),oe.forEach(p),i=B(Ee),d=y(Ee,"DIV",{class:!0});var he=C(d);f=y(he,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(f)!=="svelte-11aw8ub"&&(f.textContent=g),_=B(he),h=y(he,"INPUT",{class:!0,id:!0,type:!0}),he.forEach(p),N=B(Ee),k=y(Ee,"DIV",{class:!0});var Q=C(k);E=y(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(E)!=="svelte-17p0yvw"&&(E.textContent=L),V=B(Q),ve(K.$$.fragment,Q),S=B(Q),T=y(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(T)!=="svelte-1wr3nwv"&&(T.textContent=A),Q.forEach(p),Ee.forEach(p),w=B(ce),D=y(ce,"DIV",{class:!0});var ue=C(D);P=y(ue,"BUTTON",{class:!0});var we=C(P);ve(I.$$.fragment,we),we.forEach(p),ue.forEach(p),ce.forEach(p),O=B(se),R=y(se,"DIV",{class:!0});var fe=C(R);M=y(fe,"UL",{class:!0});var He=C(M);for(let W=0;W<G.length;W+=1)G[W].l(He);He.forEach(p),fe.forEach(p),se.forEach(p),this.h()},h(){m(r,"class","font-bold mr-4"),m(r,"for","middle-row"),m(n,"class","my-1 flex items-center justify-between mr-2"),m(f,"class","font-bold mr-4"),m(f,"for","custom-layout"),m(h,"class","h-[20px]"),m(h,"id","custom-layout"),m(h,"type","checkbox"),h.checked=v=s[0].isCustom,m(d,"class","my-1 flex items-center"),m(E,"class","font-bold mr-4"),m(E,"for","two-rows"),m(T,"class","font-bold ml-4"),m(T,"for","two-rows"),m(k,"class","my-1 flex items-center"),m(l,"class","options svelte-1av9wwd"),m(P,"class","rounded px-1 py-1 hover:bg-gray-200"),m(D,"class","flex items-center justify-center"),m(t,"class","flex justify-between"),m(M,"class","keyboard svelte-1av9wwd"),m(R,"class","flex flex-col"),m(e,"class",F=Te(`${s[10].class||""} relative`)+" svelte-1av9wwd")},m(H,se){U(H,e,se),u(e,t),u(t,l),u(l,n),u(n,r),u(n,a),be(c,n,null),u(l,i),u(l,d),u(d,f),u(d,_),u(d,h),u(l,N),u(l,k),u(k,E),u(k,V),be(K,k,null),u(k,S),u(k,T),u(t,w),u(t,D),u(D,P),be(I,P,null),u(e,O),u(e,R),u(R,M);for(let ce=0;ce<G.length;ce+=1)G[ce]&&G[ce].m(M,null);X=!0,ie||(Y=[J(h,"change",s[7]),J(P,"click",s[5])],ie=!0)},p(H,[se]){const ce={};se&524289&&(ce.$$scope={dirty:se,ctx:H}),c.$set(ce),(!X||se&1&&v!==(v=H[0].isCustom))&&(h.checked=v);const Ee={};if(se&2&&(Ee.checked=!H[1]),K.$set(Ee),se&269){z=de(H[3].rows);let oe;for(oe=0;oe<z.length;oe+=1){const he=Ul(H,z,oe);G[oe]?(G[oe].p(he,se),x(G[oe],1)):(G[oe]=Hl(he),G[oe].c(),x(G[oe],1),G[oe].m(M,null))}for(xe(),oe=z.length;oe<G.length;oe+=1)le(oe);Fe()}(!X||se&1024&&F!==(F=Te(`${H[10].class||""} relative`)+" svelte-1av9wwd"))&&m(e,"class",F)},i(H){if(!X){x(c.$$.fragment,H),x(K.$$.fragment,H),x(I.$$.fragment,H);for(let se=0;se<z.length;se+=1)x(G[se]);X=!0}},o(H){q(c.$$.fragment,H),q(K.$$.fragment,H),q(I.$$.fragment,H),G=G.filter(Boolean);for(let se=0;se<G.length;se+=1)q(G[se]);X=!1},d(H){H&&p(e),ye(c),ye(K),ye(I),Ve(G,H),ie=!1,Qe(Y)}}}function pr(s,e,t){let l,n,r,o,a;_e(s,ct,v=>t(0,r=v)),_e(s,jt,v=>t(11,o=v)),_e(s,ds,v=>t(3,a=v)),bn(()=>{a.opts.isCustom||ut.setLayout(navigator.languages)});const c=Object.entries(Ls).map(([v,N])=>({key:v,value:N.name}));function i(){ut.reset(),ut.setLayout(navigator.languages)}function d(v){return ut.setLayout([v]),!1}function f(v){ut.setCustomLayout(v.currentTarget.checked)}function g(v){ut.captureHotkeyRow(v)}function _(){ut.toggleRows()}const h=v=>g(v);return s.$$set=v=>{t(10,e=Ae(Ae({},e),Se(v)))},s.$$.update=()=>{s.$$.dirty&2049&&t(2,l=o.map((v,N)=>r.hotkeydRows==="middle-row"?N===1||N===2:!0)),s.$$.dirty&1&&t(1,n=r.hotkeydRows==="middle-row")},e=Se(e),[r,n,l,a,c,i,d,f,g,_,e,o,h]}class gr extends We{constructor(e){super(),qe(this,e,pr,_r,Je,{})}}function zl(s){let e,t;return e=new gr({props:{class:"mt-4"}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){q(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function vr(s){let e,t,l,n,r="I/O",o,a,c,i,d,f,g,_,h="Device",v,N,k,E,L,V,K="Prompt",S,T,A="Disable",w,D,P,I,O="Sound",R,M,F,X,ie,Y,z="Fixed velocity",G,le,H,se,ce,Ee,oe="Keyboard",he,Q,ue,we,fe,He,W="Hotkeys",re,ke,tt,ne,je,Me,pt="Auto-octave",At,ze,Ue,St,st,$e,Fs=" ",vs,Nt,gt,Hs="Set hotkeys",bs,vt,bt,zs="Fade timeout",ys,it,ks,Ht,Xe,ws,Ws;i=new Re({props:{icon:Ft,width:16}});let Ge=s[2]&&!s[4]&&zl();return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,o=j(),a=b("div"),c=b("button"),ge(i.$$.fragment),d=j(),f=b("div"),g=b("div"),_=b("label"),_.textContent=h,v=j(),N=b("input"),E=j(),L=b("div"),V=b("button"),V.textContent=K,S=j(),T=b("button"),T.textContent=A,w=j(),D=b("div"),P=b("div"),I=b("label"),I.textContent=O,R=j(),M=b("input"),X=j(),ie=b("div"),Y=b("label"),Y.textContent=z,G=j(),le=b("input"),H=j(),se=b("div"),ce=b("div"),Ee=b("label"),Ee.textContent=oe,he=j(),Q=b("input"),we=j(),fe=b("div"),He=b("label"),He.textContent=W,re=j(),ke=b("input"),ne=j(),je=b("div"),Me=b("label"),Me.textContent=pt,At=j(),ze=b("input"),St=j(),st=b("div"),$e=b("div"),$e.textContent=Fs,vs=j(),Nt=b("div"),gt=b("button"),gt.textContent=Hs,bs=j(),vt=b("div"),bt=b("label"),bt.textContent=zs,ys=j(),it=b("input"),ks=j(),Ge&&Ge.c(),this.h()},l(Ne){e=y(Ne,"DIV",{class:!0});var Ke=C(e);t=y(Ke,"FIELDSET",{class:!0});var ot=C(t);l=y(ot,"LEGEND",{class:!0});var qs=C(l);n=y(qs,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-1jbbsti"&&(n.textContent=r),qs.forEach(p),o=B(ot),a=y(ot,"DIV",{class:!0});var Js=C(a);c=y(Js,"BUTTON",{class:!0});var $s=C(c);ve(i.$$.fragment,$s),$s.forEach(p),Js.forEach(p),d=B(ot),f=y(ot,"DIV",{class:!0});var yt=C(f);g=y(yt,"DIV",{class:!0});var Dt=C(g);_=y(Dt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(_)!=="svelte-crpa7y"&&(_.textContent=h),v=B(Dt),N=y(Dt,"INPUT",{class:!0,id:!0}),E=B(Dt),L=y(Dt,"DIV",{class:!0});var zt=C(L);V=y(zt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(V)!=="svelte-mj6mct"&&(V.textContent=K),S=B(zt),T=y(zt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(T)!=="svelte-1sl6oxh"&&(T.textContent=A),zt.forEach(p),Dt.forEach(p),w=B(yt),D=y(yt,"DIV",{class:!0});var Wt=C(D);P=y(Wt,"DIV",{class:!0});var qt=C(P);I=y(qt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(I)!=="svelte-wgxtkw"&&(I.textContent=O),R=B(qt),M=y(qt,"INPUT",{class:!0,id:!0,type:!0}),qt.forEach(p),X=B(Wt),ie=y(Wt,"DIV",{class:!0});var Jt=C(ie);Y=y(Jt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Y)!=="svelte-1tm2bth"&&(Y.textContent=z),G=B(Jt),le=y(Jt,"INPUT",{class:!0,id:!0,placeholder:!0}),Jt.forEach(p),Wt.forEach(p),H=B(yt),se=y(yt,"DIV",{class:!0});var Lt=C(se);ce=y(Lt,"DIV",{class:!0});var $t=C(ce);Ee=y($t,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Ee)!=="svelte-1js269u"&&(Ee.textContent=oe),he=B($t),Q=y($t,"INPUT",{class:!0,id:!0,type:!0}),$t.forEach(p),we=B(Lt),fe=y(Lt,"DIV",{class:!0});var Yt=C(fe);He=y(Yt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(He)!=="svelte-21h39k"&&(He.textContent=W),re=B(Yt),ke=y(Yt,"INPUT",{class:!0,id:!0,type:!0}),Yt.forEach(p),ne=B(Lt),je=y(Lt,"DIV",{class:!0});var Qt=C(je);Me=y(Qt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Me)!=="svelte-33lczu"&&(Me.textContent=pt),At=B(Qt),ze=y(Qt,"INPUT",{class:!0,id:!0,type:!0}),Qt.forEach(p),Lt.forEach(p),St=B(yt),st=y(yt,"DIV",{class:!0});var Pt=C(st);$e=y(Pt,"DIV",{class:!0,"data-svelte-h":!0}),ae($e)!=="svelte-dgefms"&&($e.textContent=Fs),vs=B(Pt),Nt=y(Pt,"DIV",{class:!0});var Ys=C(Nt);gt=y(Ys,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(gt)!=="svelte-1v9okg9"&&(gt.textContent=Hs),Ys.forEach(p),bs=B(Pt),vt=y(Pt,"DIV",{class:!0});var Xt=C(vt);bt=y(Xt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(bt)!=="svelte-vd5i27"&&(bt.textContent=zs),ys=B(Xt),it=y(Xt,"INPUT",{class:!0,id:!0}),Xt.forEach(p),Pt.forEach(p),yt.forEach(p),ks=B(ot),Ge&&Ge.l(ot),ot.forEach(p),Ke.forEach(p),this.h()},h(){var Ne;m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(c,"class","rounded px-1 py-1 hover:bg-gray-200"),m(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center"),$(a,"hidden",s[4]),m(_,"class","font-bold"),m(_,"for","device"),m(N,"class","px-1 my-1 rounded w-50"),m(N,"id","device"),N.disabled=!0,N.value=k=((Ne=s[5])==null?void 0:Ne.name)??"No device",m(V,"class","btn-sm primary mr-2"),m(T,"class","btn-sm primary"),m(L,"class","flex my-[auto]"),m(g,"class","h-full flex flex-col"),m(I,"class","font-bold"),m(I,"for","sound"),m(M,"class","h-[20px]"),m(M,"id","sound"),m(M,"type","checkbox"),M.checked=F=s[3].useSound,m(P,"class","my-1 flex justify-between mr-12"),m(Y,"class","font-bold"),m(Y,"for","fixed-velocity"),m(le,"class","h-[20px] w-16"),m(le,"id","fixed-velocity"),m(le,"placeholder","0-127"),m(ie,"class","flex justify-between"),m(D,"class","flex flex-col h-full"),m(Ee,"class","font-bold"),m(Ee,"for","keyboard"),m(Q,"class","h-[20px]"),m(Q,"id","keyboard"),m(Q,"type","checkbox"),Q.checked=ue=s[3].useKeyboard,m(ce,"class","my-1 flex justify-between mr-12"),m(He,"class","font-bold"),m(He,"for","hotkeys"),m(ke,"class","h-[20px]"),m(ke,"id","hotkeys"),m(ke,"type","checkbox"),ke.checked=tt=s[3].useHotkeys,m(fe,"class","my-1 flex justify-between mr-12"),m(Me,"class","font-bold"),m(Me,"for","auto-octave"),m(ze,"class","h-[20px]"),m(ze,"id","auto-octave"),m(ze,"type","checkbox"),ze.checked=Ue=s[3].useAutoOctave,m(je,"class","my-1 flex justify-between mr-12"),m(se,"class","flex flex-col h-full"),m($e,"class","h-[28px]"),m(gt,"class","w-full btn-sm primary"),m(Nt,"class","my-[2px] flex justify-between"),m(bt,"class","font-bold"),m(bt,"for","fade-timeout"),m(it,"class","h-[20px] w-16"),m(it,"id","fade-timeout"),it.value=s[1],m(vt,"class","my-1 flex justify-between"),m(st,"class","flex flex-col h-full"),m(f,"class","body svelte-1bpw69s"),$(f,"hidden",s[4]),m(t,"class","relative flex flex-col max-w-full rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),$(t,"collapsed",s[4]),m(e,"class",Ht=Te(`${s[11].class||""}`)+" svelte-1bpw69s")},m(Ne,Ke){U(Ne,e,Ke),u(e,t),u(t,l),u(l,n),u(t,o),u(t,a),u(a,c),be(i,c,null),u(t,d),u(t,f),u(f,g),u(g,_),u(g,v),u(g,N),u(g,E),u(g,L),u(L,V),u(L,S),u(L,T),u(f,w),u(f,D),u(D,P),u(P,I),u(P,R),u(P,M),u(D,X),u(D,ie),u(ie,Y),u(ie,G),u(ie,le),et(le,s[0]),u(f,H),u(f,se),u(se,ce),u(ce,Ee),u(ce,he),u(ce,Q),u(se,we),u(se,fe),u(fe,He),u(fe,re),u(fe,ke),u(se,ne),u(se,je),u(je,Me),u(je,At),u(je,ze),u(f,St),u(f,st),u(st,$e),u(st,vs),u(st,Nt),u(Nt,gt),u(st,bs),u(st,vt),u(vt,bt),u(vt,ys),u(vt,it),u(t,ks),Ge&&Ge.m(t,null),Xe=!0,ws||(Ws=[J(n,"click",s[7]),J(c,"click",s[10]),J(V,"click",Be.openMidi),J(T,"click",Be.disableMidi),J(M,"change",s[12]),J(le,"input",s[13]),J(le,"change",s[8]),J(Q,"change",s[14]),J(ke,"change",s[15]),J(ze,"change",s[16]),J(gt,"click",s[17]),J(it,"input",s[9])],ws=!0)},p(Ne,[Ke]){var ot;(!Xe||Ke&16)&&$(a,"hidden",Ne[4]),(!Xe||Ke&32&&k!==(k=((ot=Ne[5])==null?void 0:ot.name)??"No device")&&N.value!==k)&&(N.value=k),(!Xe||Ke&8&&F!==(F=Ne[3].useSound))&&(M.checked=F),Ke&1&&le.value!==Ne[0]&&et(le,Ne[0]),(!Xe||Ke&8&&ue!==(ue=Ne[3].useKeyboard))&&(Q.checked=ue),(!Xe||Ke&8&&tt!==(tt=Ne[3].useHotkeys))&&(ke.checked=tt),(!Xe||Ke&8&&Ue!==(Ue=Ne[3].useAutoOctave))&&(ze.checked=Ue),(!Xe||Ke&2&&it.value!==Ne[1])&&(it.value=Ne[1]),(!Xe||Ke&16)&&$(f,"hidden",Ne[4]),Ne[2]&&!Ne[4]?Ge?Ke&20&&x(Ge,1):(Ge=zl(),Ge.c(),x(Ge,1),Ge.m(t,null)):Ge&&(xe(),q(Ge,1,1,()=>{Ge=null}),Fe()),(!Xe||Ke&16)&&$(t,"collapsed",Ne[4]),(!Xe||Ke&2048&&Ht!==(Ht=Te(`${Ne[11].class||""}`)+" svelte-1bpw69s"))&&m(e,"class",Ht)},i(Ne){Xe||(x(i.$$.fragment,Ne),x(Ge),Xe=!0)},o(Ne){q(i.$$.fragment,Ne),q(Ge),Xe=!1},d(Ne){Ne&&p(e),ye(i),Ge&&Ge.d(),ws=!1,Qe(Ws)}}}function br(s,e,t){let l,n,r;_e(s,nt,V=>t(3,l=V)),_e(s,fs,V=>t(5,r=V));const o=_t(Oe(!1),{key:"inputs-hidden"});_e(s,o,V=>t(4,n=V));let a=l.fixedVelocity??"",c=l.keyFadeTimeout,i=!1;nt.subscribe(V=>{t(0,a=V.fixedVelocity??""),t(1,c=V.keyFadeTimeout)});function d(){o.update(V=>!V)}function f(V){const{value:K}=V.currentTarget;let S;if(K)try{S=parseInt(K)}catch{}S!==void 0&&S>=0&&S<=127?Be.setInputValue("fixedVelocity",S):K?t(0,a=l.fixedVelocity||""):Be.setInputValue("fixedVelocity",void 0)}function g(V){try{const K=parseInt(V.currentTarget.value);Be.setInputValue("keyFadeTimeout",K)}catch{t(1,c=l.keyFadeTimeout)}}function _(){Be.setInputValue("useSound",!0),Be.setInputValue("fixedVelocity",void 0),Be.setInputValue("useKeyboard",!0),Be.setInputValue("useHotkeys",!0),Be.setInputValue("useAutoOctave",!0),Be.setInputValue("keyFadeTimeout",1500)}const h=V=>Be.setInputValue("useSound",V.currentTarget.checked);function v(){a=this.value,t(0,a)}const N=V=>Be.setInputValue("useKeyboard",V.currentTarget.checked),k=V=>Be.setInputValue("useHotkeys",V.currentTarget.checked),E=V=>Be.setInputValue("useAutoOctave",V.currentTarget.checked),L=()=>t(2,i=!i);return s.$$set=V=>{t(11,e=Ae(Ae({},e),Se(V)))},e=Se(e),[a,c,i,l,n,r,o,d,f,g,_,e,h,v,N,k,E,L]}class yr extends We{constructor(e){super(),qe(this,e,br,vr,Je,{})}}function kr(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){U(t,e,l)},p:me,d(t){t&&p(e)}}}function wr(s){let e,t=s[1].note+"",l;return{c(){e=Z("Input: "),l=Z(t)},l(n){e=ee(n,"Input: "),l=ee(n,t)},m(n,r){U(n,e,r),U(n,l,r)},p(n,r){r&2&&t!==(t=n[1].note+"")&&pe(l,t)},d(n){n&&(p(e),p(l))}}}function Er(s){let e,t;return{c(){e=Z("Input: "),t=Z(s[0])},l(l){e=ee(l,"Input: "),t=ee(l,s[0])},m(l,n){U(l,e,n),U(l,t,n)},p(l,n){n&1&&pe(t,l[0])},d(l){l&&(p(e),p(t))}}}function Cr(s){let e;return{c(){e=Z(Ps)},l(t){e=ee(t,Ps)},m(t,l){U(t,e,l)},p:me,d(t){t&&p(e)}}}function Ir(s){let e,t,l,n;function r(c,i){return c[2].useKeyboard&&Ps?Cr:c[2].useKeyboard&&c[0]?Er:c[2].useKeyboard&&c[1]?wr:kr}let o=r(s),a=o(s);return{c(){e=b("div"),a.c(),this.h()},l(c){e=y(c,"DIV",{class:!0});var i=C(e);a.l(i),i.forEach(p),this.h()},h(){m(e,"class",t=`${s[4].class||""}`)},m(c,i){U(c,e,i),a.m(e,null),l||(n=J(window,"keydown",s[3]),l=!0)},p(c,[i]){o===(o=r(c))&&a?a.p(c,i):(a.d(1),a=o(c),a&&(a.c(),a.m(e,null))),i&16&&t!==(t=`${c[4].class||""}`)&&m(e,"class",t)},i:me,o:me,d(c){c&&p(e),a.d(),l=!1,n()}}}let Ps="";function Tr(s,e,t){let l;_e(s,nt,i=>t(2,l=i));let{debounced:n}=e,r="",o;const a=Vn();function c(i){const d=i.target;if(n||!(d instanceof HTMLElement)||d.tagName==="INPUT")return;const f=ut.handleInput(i.code,i.key,i.shiftKey);f&&f.e==="note"?t(1,o=f.data):f&&f.e==="string"?t(0,r=f.data):f&&(f.e==="guessed-key"||f.e==="guessed-chord"||f.e==="guessed-note")?(t(0,r=""),t(1,o=void 0),a(f.e,f.data),i.code==="Enter"&&i.preventDefault()):f&&i.preventDefault()}return s.$$set=i=>{t(4,e=Ae(Ae({},e),Se(i))),"debounced"in i&&t(5,n=i.debounced)},e=Se(e),[r,o,l,c,e,n]}class Ar extends We{constructor(e){super(),qe(this,e,Tr,Ir,Je,{debounced:5})}}function Sr(s){let e,t,l,n="Count",r,o,a,c,i,d="Duplicates",f,g,_,h,v,N,k="Autoplay",E,L,V,K,S,T,A="Wait seconds",w,D,P,I,O;return{c(){e=b("ul"),t=b("li"),l=b("label"),l.textContent=n,r=j(),o=b("input"),a=j(),c=b("li"),i=b("label"),i.textContent=d,f=j(),g=b("input"),h=j(),v=b("li"),N=b("label"),N.textContent=k,E=j(),L=b("input"),K=j(),S=b("li"),T=b("label"),T.textContent=A,w=j(),D=b("input"),this.h()},l(R){e=y(R,"UL",{class:!0});var M=C(e);t=y(M,"LI",{class:!0});var F=C(t);l=y(F,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(l)!=="svelte-wgq9fc"&&(l.textContent=n),r=B(F),o=y(F,"INPUT",{class:!0,id:!0,type:!0}),F.forEach(p),a=B(M),c=y(M,"LI",{class:!0});var X=C(c);i=y(X,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(i)!=="svelte-hcg9dq"&&(i.textContent=d),f=B(X),g=y(X,"INPUT",{class:!0,id:!0,type:!0}),X.forEach(p),h=B(M),v=y(M,"LI",{class:!0});var ie=C(v);N=y(ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(N)!=="svelte-lr68n2"&&(N.textContent=k),E=B(ie),L=y(ie,"INPUT",{class:!0,id:!0,type:!0}),ie.forEach(p),K=B(M),S=y(M,"LI",{class:!0});var Y=C(S);T=y(Y,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(T)!=="svelte-1qj2vcy"&&(T.textContent=A),w=B(Y),D=y(Y,"INPUT",{class:!0,id:!0,type:!0}),Y.forEach(p),M.forEach(p),this.h()},h(){m(l,"class","font-bold"),m(l,"for","guess-count"),m(o,"class","h-[20px] w-10"),m(o,"id","guess-count"),m(o,"type","number"),m(t,"class","flex items-center justify-between svelte-1elvih2"),m(i,"class","font-bold"),m(i,"for","duplicates"),m(g,"class","h-[20px]"),m(g,"id","duplicates"),m(g,"type","checkbox"),g.checked=_=s[2].duplicates,m(c,"class","flex items-center justify-between mr-6 svelte-1elvih2"),m(N,"class","font-bold"),m(N,"for","autoplay"),m(L,"class","h-[20px]"),m(L,"id","autoplay"),m(L,"type","checkbox"),L.checked=V=s[2].autoplay,m(v,"class","flex items-center justify-between mr-6 svelte-1elvih2"),m(T,"class","font-bold"),m(T,"for","wait-ms"),m(D,"class","h-[20px] w-10"),m(D,"id","wait-ms"),m(D,"type","number"),m(S,"class","flex items-center justify-between svelte-1elvih2"),m(e,"class",P=Te(`${s[5].class||""}`)+" svelte-1elvih2")},m(R,M){U(R,e,M),u(e,t),u(t,l),u(t,r),u(t,o),et(o,s[0]),u(e,a),u(e,c),u(c,i),u(c,f),u(c,g),u(e,h),u(e,v),u(v,N),u(v,E),u(v,L),u(e,K),u(e,S),u(S,T),u(S,w),u(S,D),et(D,s[1]),I||(O=[J(o,"input",s[6]),J(o,"input",s[3]),J(g,"input",s[7]),J(L,"input",s[8]),J(D,"input",s[9]),J(D,"input",s[4])],I=!0)},p(R,[M]){M&1&&as(o.value)!==R[0]&&et(o,R[0]),M&4&&_!==(_=R[2].duplicates)&&(g.checked=_),M&4&&V!==(V=R[2].autoplay)&&(L.checked=V),M&2&&as(D.value)!==R[1]&&et(D,R[1]),M&32&&P!==(P=Te(`${R[5].class||""}`)+" svelte-1elvih2")&&m(e,"class",P)},i:me,o:me,d(R){R&&p(e),I=!1,Qe(O)}}}function Nr(s,e,t){let l;_e(s,mt,g=>t(2,l=g));let n=l.count||"",r=l.waitSeconds||"";mt.subscribe(g=>{t(0,n=g.count||""),t(1,r=g.waitSeconds||"")});function o({currentTarget:{value:g}}){let _;try{_=parseInt(g),_<=0&&(_=1),Le.setOptionValue("count",_)}catch{t(0,n=l.count)}}function a({currentTarget:{value:g}}){let _;try{_=parseInt(g),_<0&&(_=0),Le.setOptionValue("waitSeconds",_)}catch{t(1,r=l.waitSeconds)}}function c(){n=as(this.value),t(0,n)}const i=g=>Le.setOptionValue("duplicates",g.currentTarget.checked),d=g=>Le.setOptionValue("autoplay",g.currentTarget.checked);function f(){r=as(this.value),t(1,r)}return s.$$set=g=>{t(5,e=Ae(Ae({},e),Se(g)))},e=Se(e),[n,r,l,o,a,e,c,i,d,f]}class Dr extends We{constructor(e){super(),qe(this,e,Nr,Sr,Je,{})}}function Wl(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l}function ql(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l}function Jl(s){let e,t,l=s[23]+"",n,r,o,a,c,i,d,f;function g(){return s[15](s[22])}a=new Re({props:{icon:As,width:20}});function _(...h){return s[16](s[22],...h)}return{c(){e=b("li"),t=b("button"),n=Z(l),r=j(),o=b("button"),ge(a.$$.fragment),c=j(),this.h()},l(h){e=y(h,"LI",{class:!0});var v=C(e);t=y(v,"BUTTON",{class:!0});var N=C(t);n=ee(N,l),N.forEach(p),r=B(v),o=y(v,"BUTTON",{class:!0});var k=C(o);ve(a.$$.fragment,k),k.forEach(p),c=B(v),v.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),$(t,"selected",s[22]===s[0]),m(o,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),m(e,"class","flex svelte-1okhpct")},m(h,v){U(h,e,v),u(e,t),u(t,n),u(e,r),u(e,o),be(a,o,null),u(e,c),i=!0,d||(f=[J(t,"click",g),J(o,"click",_)],d=!0)},p(h,v){s=h,(!i||v&17)&&$(t,"selected",s[22]===s[0])},i(h){i||(x(a.$$.fragment,h),i=!0)},o(h){q(a.$$.fragment,h),i=!1},d(h){h&&p(e),ye(a),d=!1,Qe(f)}}}function $l(s){let e,t=de(s[3]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Yl(Wl(s,t,n));return{c(){e=b("ul");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=y(n,"UL",{class:!0});var r=C(e);for(let o=0;o<l.length;o+=1)l[o].l(r);r.forEach(p),this.h()},h(){m(e,"class","svelte-1okhpct")},m(n,r){U(n,e,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null)},p(n,r){if(r&138){t=de(n[3]);let o;for(o=0;o<t.length;o+=1){const a=Wl(n,t,o);l[o]?l[o].p(a,r):(l[o]=Yl(a),l[o].c(),l[o].m(e,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function Yl(s){let e,t,l=s[23]+"",n,r,o,a;function c(){return s[17](s[22])}return{c(){e=b("li"),t=b("button"),n=Z(l),r=j(),this.h()},l(i){e=y(i,"LI",{class:!0});var d=C(e);t=y(d,"BUTTON",{class:!0});var f=C(t);n=ee(f,l),f.forEach(p),r=B(d),d.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),$(t,"selected",s[22]===s[1]),m(e,"class","svelte-1okhpct")},m(i,d){U(i,e,d),u(e,t),u(t,n),u(e,r),o||(a=J(t,"click",c),o=!0)},p(i,d){s=i,d&8&&l!==(l=s[23]+"")&&pe(n,l),d&10&&$(t,"selected",s[22]===s[1])},d(i){i&&p(e),o=!1,a()}}}function Lr(s){let e,t,l="Play",n,r,o,a,c,i,d,f,g,_,h="Reset",v,N,k,E,L=s[2]?"Quit":"Play",V,K,S,T,A,w=de(s[4]),D=[];for(let O=0;O<w.length;O+=1)D[O]=Jl(ql(s,w,O));const P=O=>q(D[O],1,1,()=>{D[O]=null});let I=(s[0]==="chords-write"||s[0]==="chords-play")&&$l(s);return d=new Dr({props:{class:"game-options"}}),k=new Re({props:{class:"mr-1",icon:s[2]?Zs:As,width:20}}),{c(){e=b("fieldset"),t=b("legend"),t.textContent=l,n=j(),r=b("div"),o=b("ul");for(let O=0;O<D.length;O+=1)D[O].c();a=j(),c=b("div"),I&&I.c(),i=j(),ge(d.$$.fragment),f=j(),g=b("div"),_=b("button"),_.textContent=h,v=j(),N=b("button"),ge(k.$$.fragment),E=j(),V=Z(L),this.h()},l(O){e=y(O,"FIELDSET",{class:!0});var R=C(e);t=y(R,"LEGEND",{class:!0,"data-svelte-h":!0}),ae(t)!=="svelte-1409tnk"&&(t.textContent=l),n=B(R),r=y(R,"DIV",{class:!0});var M=C(r);o=y(M,"UL",{class:!0});var F=C(o);for(let z=0;z<D.length;z+=1)D[z].l(F);F.forEach(p),a=B(M),c=y(M,"DIV",{class:!0});var X=C(c);I&&I.l(X),X.forEach(p),i=B(M),ve(d.$$.fragment,M),f=B(M),g=y(M,"DIV",{class:!0});var ie=C(g);_=y(ie,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(_)!=="svelte-10rv0bu"&&(_.textContent=h),v=B(ie),N=y(ie,"BUTTON",{class:!0});var Y=C(N);ve(k.$$.fragment,Y),E=B(Y),V=ee(Y,L),Y.forEach(p),ie.forEach(p),M.forEach(p),R.forEach(p),this.h()},h(){m(t,"class","px-1 text-base"),m(o,"class","games svelte-1okhpct"),m(c,"class","options svelte-1okhpct"),m(_,"class","w-full btn hover:bg-gray-200"),m(N,"class","w-full mt-2 flex items-center justify-center btn primary"),m(g,"class","h-full flex flex-col justify-end"),m(r,"class","body pb-2 h-full svelte-1okhpct"),m(e,"class",K=Te(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(O,R){U(O,e,R),u(e,t),u(e,n),u(e,r),u(r,o);for(let M=0;M<D.length;M+=1)D[M]&&D[M].m(o,null);u(r,a),u(r,c),I&&I.m(c,null),u(r,i),be(d,r,null),u(r,f),u(r,g),u(g,_),u(g,v),u(g,N),be(k,N,null),u(N,E),u(N,V),S=!0,T||(A=[J(_,"click",s[8]),J(N,"click",s[9])],T=!0)},p(O,[R]){if(R&113){w=de(O[4]);let F;for(F=0;F<w.length;F+=1){const X=ql(O,w,F);D[F]?(D[F].p(X,R),x(D[F],1)):(D[F]=Jl(X),D[F].c(),x(D[F],1),D[F].m(o,null))}for(xe(),F=w.length;F<D.length;F+=1)P(F);Fe()}O[0]==="chords-write"||O[0]==="chords-play"?I?I.p(O,R):(I=$l(O),I.c(),I.m(c,null)):I&&(I.d(1),I=null);const M={};R&4&&(M.icon=O[2]?Zs:As),k.$set(M),(!S||R&4)&&L!==(L=O[2]?"Quit":"Play")&&pe(V,L),(!S||R&1024&&K!==(K=Te(`${O[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&m(e,"class",K)},i(O){if(!S){for(let R=0;R<w.length;R+=1)x(D[R]);x(d.$$.fragment,O),x(k.$$.fragment,O),S=!0}},o(O){D=D.filter(Boolean);for(let R=0;R<D.length;R+=1)q(D[R]);q(d.$$.fragment,O),q(k.$$.fragment,O),S=!1},d(O){O&&p(e),Ve(D,O),I&&I.d(),ye(d),ye(k),T=!1,Qe(A)}}}function Pr(s,e,t){let l,n,r,o,a,c,i;_e(s,Us,S=>t(12,o=S)),_e(s,mt,S=>t(20,a=S)),_e(s,dt,S=>t(13,c=S)),_e(s,Et,S=>t(14,i=S));const d=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let f=d[4].key,g="maj-m";a.count,a.waitSeconds,mt.subscribe(S=>{S.count,S.waitSeconds});function _(S,T){if(T==="chords-write"||T==="chords-play"||T==="chords-diatonic"){let A=[];g==="selected"?A=o.filter(w=>w.selected):g==="all"?A=o:g==="maj-m"?A=o.filter(w=>w.suffixes[0]==="maj"||w.suffixes[0]==="m"):g==="seventh"&&(A=o.filter(w=>w.suffixes[0]==="maj7"||w.suffixes[0]==="m7"||w.suffixes[0]==="7"||w.suffixes[0]==="dim7"||w.suffixes[0]==="aug7")),Le.play(T,{chords:A})}else Le.play(T,void 0);S.currentTarget instanceof HTMLElement&&S.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function h(S){t(0,f=S)}function v(S,T){t(0,f=T),_(S,T)}function N(S){t(1,g=S)}function k(){Le.clearGame(!0)}function E(S){l?Le.clearGame():_(S,f)}const L=S=>h(S),V=(S,T)=>v(T,S),K=S=>N(S);return s.$$set=S=>{t(10,e=Ae(Ae({},e),Se(S)))},s.$$.update=()=>{s.$$.dirty&24576&&t(2,l=!!i&&c!=="ended"),s.$$.dirty&4096&&t(11,n=o.reduce((S,T)=>T.selected?S+1:S,0)),s.$$.dirty&2048&&t(3,r=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${n} chords`},{key:"all",value:"All"}])},e=Se(e),[f,g,l,r,d,h,v,N,k,E,e,n,o,c,i,L,V,K]}class Vr extends We{constructor(e){super(),qe(this,e,Pr,Lr,Je,{})}}function Ql(s,e,t){const l=s.slice();return l[7]=e[t],l}function Xl(s,e,t){const l=s.slice();return l[4]=e[t],l}function Or(s){let e,t=de(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Zl(Ql(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r&2){t=de(n[1]);let o;for(o=0;o<t.length;o+=1){const a=Ql(n,t,o);l[o]?l[o].p(a,r):(l[o]=Zl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function jr(s){let e,t=de(s[0].scaleNotes||[]),l=[];for(let n=0;n<t.length;n+=1)l[n]=en(Xl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r&1){t=de(n[0].scaleNotes||[]);let o;for(o=0;o<t.length;o+=1){const a=Xl(n,t,o);l[o]?l[o].p(a,r):(l[o]=en(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function Zl(s){let e,t=s[7].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-my4m0t")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r&2&&t!==(t=n[7].interval+"")&&pe(l,t)},d(n){n&&p(e)}}}function en(s){let e,t=s[4].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-my4m0t")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r&1&&t!==(t=n[4].note+"")&&pe(l,t)},d(n){n&&p(e)}}}function Br(s){let e,t,l,n,r,o;function a(d,f){return d[0]?jr:Or}let c=a(s),i=c(s);return{c(){e=b("div"),t=b("button"),i.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,title:!0});var f=C(e);t=y(f,"BUTTON",{class:!0});var g=C(t);i.l(g),g.forEach(p),f.forEach(p),this.h()},h(){m(t,"class","intervals svelte-my4m0t"),m(e,"class",l=`${s[2].class||""} `),m(e,"title",n=s[1].map(tn).join("-"))},m(d,f){U(d,e,f),u(e,t),i.m(t,null),r||(o=J(t,"click",s[3]),r=!0)},p(d,[f]){c===(c=a(d))&&i?i.p(d,f):(i.d(1),i=c(d),i&&(i.c(),i.m(t,null))),f&4&&l!==(l=`${d[2].class||""} `)&&m(e,"class",l),f&2&&n!==(n=d[1].map(tn).join("-"))&&m(e,"title",n)},i:me,o:me,d(d){d&&p(e),i.d(),r=!1,o()}}}const tn=s=>s.interval;function Gr(s,e,t){let{scale:l,intervals:n}=e;function r(o){hs.call(this,s,o)}return s.$$set=o=>{t(2,e=Ae(Ae({},e),Se(o))),"scale"in o&&t(0,l=o.scale),"intervals"in o&&t(1,n=o.intervals)},e=Se(e),[l,n,e,r]}class Dn extends We{constructor(e){super(),qe(this,e,Gr,Br,Je,{scale:0,intervals:1})}}function sn(s,e,t){const l=s.slice();return l[7]=e[t],l}function ln(s,e,t){const l=s.slice();return l[4]=e[t],l}function Mr(s){let e,t=de(s[0]),l=[];for(let n=0;n<t.length;n+=1)l[n]=nn(sn(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r&1){t=de(n[0]);let o;for(o=0;o<t.length;o+=1){const a=sn(n,t,o);l[o]?l[o].p(a,r):(l[o]=nn(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function Rr(s){let e,t=de(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=on(ln(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r&2){t=de(n[1]);let o;for(o=0;o<t.length;o+=1){const a=ln(n,t,o);l[o]?l[o].p(a,r):(l[o]=on(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function nn(s){let e,t,l=s[7].roman+"",n,r,o,a=s[7].suffix+"",c,i;return{c(){e=b("span"),t=b("span"),n=Z(l),r=j(),o=b("sup"),c=Z(a),i=j(),this.h()},l(d){e=y(d,"SPAN",{class:!0});var f=C(e);t=y(f,"SPAN",{class:!0});var g=C(t);n=ee(g,l),g.forEach(p),r=B(f),o=y(f,"SUP",{class:!0});var _=C(o);c=ee(_,a),_.forEach(p),i=B(f),f.forEach(p),this.h()},h(){m(t,"class","block"),m(o,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),$(o,"super-text",s[7].suffix.length>2),m(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(d,f){U(d,e,f),u(e,t),u(t,n),u(e,r),u(e,o),u(o,c),u(e,i)},p(d,f){f&1&&l!==(l=d[7].roman+"")&&pe(n,l),f&1&&a!==(a=d[7].suffix+"")&&pe(c,a),f&1&&$(o,"super-text",d[7].suffix.length>2)},d(d){d&&p(e)}}}function on(s){let e,t,l=s[4]+"",n,r;return{c(){e=b("span"),t=b("span"),n=Z(l),r=j(),this.h()},l(o){e=y(o,"SPAN",{class:!0});var a=C(e);t=y(a,"SPAN",{});var c=C(t);n=ee(c,l),c.forEach(p),r=B(a),a.forEach(p),this.h()},h(){m(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(o,a){U(o,e,a),u(e,t),u(t,n),u(e,r)},p(o,a){a&2&&l!==(l=o[4]+"")&&pe(n,l)},d(o){o&&p(e)}}}function Ur(s){let e,t,l,n,r,o;function a(d,f){return d[1].length>0?Rr:Mr}let c=a(s),i=c(s);return{c(){e=b("div"),t=b("button"),i.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,title:!0});var f=C(e);t=y(f,"BUTTON",{class:!0});var g=C(t);i.l(g),g.forEach(p),f.forEach(p),this.h()},h(){m(t,"class","triads flex flex-wrap svelte-1roj1mi"),m(e,"class",l=Te(`${s[2].class||""} `)+" svelte-1roj1mi"),m(e,"title",n=s[0].map(rn).join("-"))},m(d,f){U(d,e,f),u(e,t),i.m(t,null),r||(o=J(t,"click",s[3]),r=!0)},p(d,[f]){c===(c=a(d))&&i?i.p(d,f):(i.d(1),i=c(d),i&&(i.c(),i.m(t,null))),f&4&&l!==(l=Te(`${d[2].class||""} `)+" svelte-1roj1mi")&&m(e,"class",l),f&1&&n!==(n=d[0].map(rn).join("-"))&&m(e,"title",n)},i:me,o:me,d(d){d&&p(e),i.d(),r=!1,o()}}}const rn=s=>s.roman+s.suffix;function Kr(s,e,t){let{triads:l,chords:n}=e;function r(o){hs.call(this,s,o)}return s.$$set=o=>{t(2,e=Ae(Ae({},e),Se(o))),"triads"in o&&t(0,l=o.triads),"chords"in o&&t(1,n=o.chords)},e=Se(e),[l,n,e,r]}class Ln extends We{constructor(e){super(),qe(this,e,Kr,Ur,Je,{triads:0,chords:1})}}function an(s,e,t){const l=s.slice();return l[23]=e[t],l}function cn(s,e,t){const l=s.slice();return l[23]=e[t],l}function un(s){let e,t,l=s[23].raw.names[0]+"",n,r,o,a,c,i,d;function f(){return s[11](s[23])}o=new Dn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),o.$on("click",f);function g(){return s[12](s[23])}return c=new Ln({props:{triads:s[23].triads,chords:s[23].triadChords}}),c.$on("click",g),{c(){e=b("li"),t=b("div"),n=Z(l),r=j(),ge(o.$$.fragment),a=j(),ge(c.$$.fragment),i=j(),this.h()},l(_){e=y(_,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);n=ee(v,l),v.forEach(p),r=B(h),ve(o.$$.fragment,h),a=B(h),ve(c.$$.fragment,h),i=B(h),h.forEach(p),this.h()},h(){m(t,"class","text-xs font-bold"),m(e,"class","svelte-4hctsl")},m(_,h){U(_,e,h),u(e,t),u(t,n),u(e,r),be(o,e,null),u(e,a),be(c,e,null),u(e,i),d=!0},p(_,h){s=_,(!d||h&4)&&l!==(l=s[23].raw.names[0]+"")&&pe(n,l);const v={};h&4&&(v.scale=s[23].scale),h&4&&(v.intervals=s[23].raw.intervals),o.$set(v);const N={};h&4&&(N.triads=s[23].triads),h&4&&(N.chords=s[23].triadChords),c.$set(N)},i(_){d||(x(o.$$.fragment,_),x(c.$$.fragment,_),d=!0)},o(_){q(o.$$.fragment,_),q(c.$$.fragment,_),d=!1},d(_){_&&p(e),ye(o),ye(c)}}}function fn(s){let e,t,l=s[23].raw.names[0]+"",n,r,o,a,c,i,d;function f(){return s[13](s[23])}o=new Dn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),o.$on("click",f);function g(){return s[14](s[23])}return c=new Ln({props:{triads:s[23].triads,chords:s[23].triadChords}}),c.$on("click",g),{c(){e=b("li"),t=b("div"),n=Z(l),r=j(),ge(o.$$.fragment),a=j(),ge(c.$$.fragment),i=j(),this.h()},l(_){e=y(_,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);n=ee(v,l),v.forEach(p),r=B(h),ve(o.$$.fragment,h),a=B(h),ve(c.$$.fragment,h),i=B(h),h.forEach(p),this.h()},h(){m(t,"class","text-xs font-bold"),m(e,"class","svelte-4hctsl")},m(_,h){U(_,e,h),u(e,t),u(t,n),u(e,r),be(o,e,null),u(e,a),be(c,e,null),u(e,i),d=!0},p(_,h){s=_,(!d||h&2)&&l!==(l=s[23].raw.names[0]+"")&&pe(n,l);const v={};h&2&&(v.scale=s[23].scale),h&2&&(v.intervals=s[23].raw.intervals),o.$set(v);const N={};h&2&&(N.triads=s[23].triads),h&2&&(N.chords=s[23].triadChords),c.$set(N)},i(_){d||(x(o.$$.fragment,_),x(c.$$.fragment,_),d=!0)},o(_){q(o.$$.fragment,_),q(c.$$.fragment,_),d=!1},d(_){_&&p(e),ye(o),ye(c)}}}function xr(s){let e,t,l,n,r="Scales",o,a,c,i="Key",d,f,g,_,h,v,N,k,E,L,V,K=de(s[2]),S=[];for(let P=0;P<K.length;P+=1)S[P]=un(cn(s,K,P));const T=P=>q(S[P],1,1,()=>{S[P]=null});let A=de(s[1]),w=[];for(let P=0;P<A.length;P+=1)w[P]=fn(an(s,A,P));const D=P=>q(w[P],1,1,()=>{w[P]=null});return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,o=j(),a=b("div"),c=b("label"),c.textContent=i,d=j(),f=b("input"),g=j(),_=b("div"),h=b("ul");for(let P=0;P<S.length;P+=1)S[P].c();v=j(),N=b("ul");for(let P=0;P<w.length;P+=1)w[P].c();this.h()},l(P){e=y(P,"DIV",{class:!0});var I=C(e);t=y(I,"FIELDSET",{class:!0});var O=C(t);l=y(O,"LEGEND",{class:!0});var R=C(l);n=y(R,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-lhx60e"&&(n.textContent=r),R.forEach(p),o=B(O),a=y(O,"DIV",{class:!0});var M=C(a);c=y(M,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(c)!=="svelte-14m38zf"&&(c.textContent=i),d=B(M),f=y(M,"INPUT",{class:!0,id:!0}),M.forEach(p),g=B(O),_=y(O,"DIV",{class:!0});var F=C(_);h=y(F,"UL",{class:!0});var X=C(h);for(let Y=0;Y<S.length;Y+=1)S[Y].l(X);X.forEach(p),v=B(F),N=y(F,"UL",{class:!0});var ie=C(N);for(let Y=0;Y<w.length;Y+=1)w[Y].l(ie);ie.forEach(p),F.forEach(p),O.forEach(p),I.forEach(p),this.h()},h(){m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(c,"class","mr-4 font-bold"),m(c,"for","scale-key"),m(f,"class","bg-gray-100 w-16 px-1 rounded"),m(f,"id","scale-key"),f.value=s[0],m(a,"class","flex mb-2 input svelte-4hctsl"),$(a,"hidden",s[3]),m(h,"class","list odd w-full svelte-4hctsl"),m(N,"class","list even w-full svelte-4hctsl"),m(_,"class","body max-h-[30rem] overflow-scroll svelte-4hctsl"),$(_,"hidden",s[3]),m(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),$(t,"collapsed",s[3]),m(e,"class",k=Te(`${s[9].class||""}`)+" svelte-4hctsl")},m(P,I){U(P,e,I),u(e,t),u(t,l),u(l,n),u(t,o),u(t,a),u(a,c),u(a,d),u(a,f),u(t,g),u(t,_),u(_,h);for(let O=0;O<S.length;O+=1)S[O]&&S[O].m(h,null);u(_,v),u(_,N);for(let O=0;O<w.length;O+=1)w[O]&&w[O].m(N,null);E=!0,L||(V=[J(n,"click",s[5]),J(f,"input",s[6])],L=!0)},p(P,[I]){if((!E||I&1&&f.value!==P[0])&&(f.value=P[0]),(!E||I&8)&&$(a,"hidden",P[3]),I&388){K=de(P[2]);let O;for(O=0;O<K.length;O+=1){const R=cn(P,K,O);S[O]?(S[O].p(R,I),x(S[O],1)):(S[O]=un(R),S[O].c(),x(S[O],1),S[O].m(h,null))}for(xe(),O=K.length;O<S.length;O+=1)T(O);Fe()}if(I&386){A=de(P[1]);let O;for(O=0;O<A.length;O+=1){const R=an(P,A,O);w[O]?(w[O].p(R,I),x(w[O],1)):(w[O]=fn(R),w[O].c(),x(w[O],1),w[O].m(N,null))}for(xe(),O=A.length;O<w.length;O+=1)D(O);Fe()}(!E||I&8)&&$(_,"hidden",P[3]),(!E||I&8)&&$(t,"collapsed",P[3]),(!E||I&512&&k!==(k=Te(`${P[9].class||""}`)+" svelte-4hctsl"))&&m(e,"class",k)},i(P){if(!E){for(let I=0;I<K.length;I+=1)x(S[I]);for(let I=0;I<A.length;I+=1)x(w[I]);E=!0}},o(P){S=S.filter(Boolean);for(let I=0;I<S.length;I+=1)q(S[I]);w=w.filter(Boolean);for(let I=0;I<w.length;I+=1)q(w[I]);E=!1},d(P){P&&p(e),Ve(S,P),Ve(w,P),L=!1,Qe(V)}}}function Fr(s,e,t){let l,n,r,o,a,c,i;_e(s,Mt,w=>t(17,r=w)),_e(s,Ct,w=>t(18,o=w)),_e(s,nt,w=>t(19,a=w)),_e(s,lt,w=>t(20,c=w));let f=ms().map(w=>({key:w.names[0],raw:w,scale:void 0,triads:w.triads,triadChords:[]})),g="",_=[o.key,o.scale],h;const v=_t(Oe(!0),{key:"scales-hidden"});_e(s,v,w=>t(3,i=w));function N(){v.update(w=>!w)}function k({currentTarget:{value:w}}){t(0,g=`${w.charAt(0).toUpperCase()}${w.charAt(1).toLowerCase()}`),t(10,f=f.map(D=>{const P=Kt(g,D.key),I=g&&"data"in P?P.data:void 0;let O=[];return I&&(O=D.triads.map((R,M)=>`${I.scaleNotes[M].note}${!R.suffix.includes("°")&&R.minor?"m":""}${R.suffix}`)),{...D,scale:I,triadChords:O}}))}function E(w,D,P){if(w<D.length){const I=D[w++];De.setPlayed(I),c==null||c.playChord(I.map(O=>O.midi),a.fixedVelocity),h=setTimeout(()=>E(w,D,P),P)}else De.setPlayed([]),De.setKeyAndScale(_[0],_[1])}function L(w){clearTimeout(h);let D,P;w.scale?(P=w.scale,_=[o.key,o.scale],De.setKeyAndScale(w.scale.key,w.scale.scale)):P=o;const I=r[0].midi+P.scaleNotes[0].semitones;D=w.raw.intervals.map(O=>[{...P.notesMap.get(O.semitones%12),midi:I+O.semitones}]),D[0][0].semitones!==D[D.length-1][0].semitones&&D.push(D[0].map(O=>({...O,midi:O.midi+12}))),E(0,D,500)}function V(w){clearTimeout(h);const{intervals:D}=w.raw;let P,I;w.scale?(I=w.scale,_=[o.key,o.scale],De.setKeyAndScale(w.scale.key,w.scale.scale)):I=o;const O=r[0].midi+I.scaleNotes[0].semitones;P=Cn(w.triads).map((M,F)=>ls(O+I.intervals[F].semitones,I,M.intervals)),D[D.length-1].interval_seq!==1&&P.push(P[0].map(M=>({...M,midi:M.midi+12}))),E(0,P,750)}const K=w=>L(w),S=w=>V(w),T=w=>L(w),A=w=>V(w);return s.$$set=w=>{t(9,e=Ae(Ae({},e),Se(w)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,l=f.filter((w,D)=>D<f.length/2)),s.$$.dirty&1024&&t(1,n=f.filter((w,D)=>D>=f.length/2))},e=Se(e),[g,n,l,i,v,N,k,L,V,e,f,K,S,T,A]}class Hr extends We{constructor(e){super(),qe(this,e,Fr,xr,Je,{})}}function dn(s,e,t){const l=s.slice();return l[26]=e[t],l}function hn(s,e,t){const l=s.slice();return l[29]=e[t],l}function mn(s){let e,t;return{c(){e=b("div"),t=Z(s[3]),this.h()},l(l){e=y(l,"DIV",{class:!0});var n=C(e);t=ee(n,s[3]),n.forEach(p),this.h()},h(){m(e,"class","error svelte-1u7ze7x")},m(l,n){U(l,e,n),u(e,t)},p(l,n){n[0]&8&&pe(t,l[3])},d(l){l&&p(e)}}}function _n(s){let e,t=de(s[5]),l=[];for(let n=0;n<t.length;n+=1)l[n]=pn(hn(s,t,n));return{c(){e=b("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=y(n,"DIV",{class:!0});var r=C(e);for(let o=0;o<l.length;o+=1)l[o].l(r);r.forEach(p),this.h()},h(){m(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){U(n,e,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null)},p(n,r){if(r[0]&32){t=de(n[5]);let o;for(o=0;o<t.length;o+=1){const a=hn(n,t,o);l[o]?l[o].p(a,r):(l[o]=pn(a),l[o].c(),l[o].m(e,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function pn(s){let e,t=s[29].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1u7ze7x")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&32&&t!==(t=n[29].interval+"")&&pe(l,t)},d(n){n&&p(e)}}}function gn(s){let e,t=de(s[8].scaleNotes),l=[];for(let n=0;n<t.length;n+=1)l[n]=vn(dn(s,t,n));return{c(){e=b("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=y(n,"DIV",{class:!0});var r=C(e);for(let o=0;o<l.length;o+=1)l[o].l(r);r.forEach(p),this.h()},h(){m(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){U(n,e,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null)},p(n,r){if(r[0]&256){t=de(n[8].scaleNotes);let o;for(o=0;o<t.length;o+=1){const a=dn(n,t,o);l[o]?l[o].p(a,r):(l[o]=vn(a),l[o].c(),l[o].m(e,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Ve(l,n)}}}function vn(s){let e,t=s[26].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1u7ze7x")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&256&&t!==(t=n[26].note+"")&&pe(l,t)},d(n){n&&p(e)}}}function zr(s){let e,t,l,n="Score",r,o,a,c,i,d,f,g="Range",_,h,v,N,k,E="—",L,V,K,S,T,A,w,D="Scale",P,I,O,R,M,F,X,ie="Key",Y,z,G,le,H,se,ce,Ee;a=new Re({props:{icon:Ft,width:16}});let oe=s[3]&&mn(s);O=new yn({props:{class:"p-1 pl-[2px] w-48",containerClass:"w-48",selected:s[0],options:s[10],onSelect:s[14]}});let he=!s[7]&&_n(s),Q=!s[7]&&gn(s);return{c(){e=b("fieldset"),t=b("legend"),l=b("button"),l.textContent=n,r=j(),o=b("button"),ge(a.$$.fragment),c=j(),i=b("div"),d=b("div"),f=b("label"),f.textContent=g,_=j(),h=b("div"),v=b("input"),N=j(),k=b("span"),k.textContent=E,L=j(),V=b("input"),K=j(),S=b("div"),oe&&oe.c(),T=j(),A=b("div"),w=b("label"),w.textContent=D,P=j(),I=b("div"),ge(O.$$.fragment),R=j(),he&&he.c(),M=j(),F=b("div"),X=b("label"),X.textContent=ie,Y=j(),z=b("div"),G=b("input"),le=j(),Q&&Q.c(),this.h()},l(ue){e=y(ue,"FIELDSET",{class:!0});var we=C(e);t=y(we,"LEGEND",{class:!0});var fe=C(t);l=y(fe,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-lqyol"&&(l.textContent=n),fe.forEach(p),r=B(we),o=y(we,"BUTTON",{class:!0});var He=C(o);ve(a.$$.fragment,He),He.forEach(p),c=B(we),i=y(we,"DIV",{class:!0});var W=C(i);d=y(W,"DIV",{class:!0});var re=C(d);f=y(re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(f)!=="svelte-10u0679"&&(f.textContent=g),_=B(re),h=y(re,"DIV",{class:!0});var ke=C(h);v=y(ke,"INPUT",{class:!0,id:!0}),N=B(ke),k=y(ke,"SPAN",{class:!0,"data-svelte-h":!0}),ae(k)!=="svelte-8q1xz4"&&(k.textContent=E),L=B(ke),V=y(ke,"INPUT",{class:!0,id:!0}),ke.forEach(p),K=B(re),S=y(re,"DIV",{class:!0});var tt=C(S);oe&&oe.l(tt),tt.forEach(p),re.forEach(p),T=B(W),A=y(W,"DIV",{class:!0});var ne=C(A);w=y(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(w)!=="svelte-ld2d07"&&(w.textContent=D),P=B(ne),I=y(ne,"DIV",{class:!0});var je=C(I);ve(O.$$.fragment,je),je.forEach(p),R=B(ne),he&&he.l(ne),ne.forEach(p),M=B(W),F=y(W,"DIV",{class:!0});var Me=C(F);X=y(Me,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(X)!=="svelte-17pcm6g"&&(X.textContent=ie),Y=B(Me),z=y(Me,"DIV",{class:!0});var pt=C(z);G=y(pt,"INPUT",{class:!0,id:!0}),pt.forEach(p),le=B(Me),Q&&Q.l(Me),Me.forEach(p),W.forEach(p),we.forEach(p),this.h()},h(){m(l,"class","px-1 rounded hover:bg-gray-100"),m(t,"class","text-base"),m(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(o,"hidden",s[6]),m(f,"class","font-bold"),m(f,"for","range_min"),m(v,"class","h-[28px] w-full"),m(v,"id","range_min"),m(k,"class","mx-2 mt-1"),m(V,"class","h-[28px] w-full"),m(V,"id","range_max"),m(h,"class","my-1 flex w-full"),m(S,"class","flex justify-between my-1"),m(d,"class","flex flex-col h-full"),m(w,"class","font-bold"),m(w,"for","scales"),m(I,"class","my-1 w-full"),m(A,"class","flex flex-col h-full"),m(X,"class","font-bold"),m(X,"for","key"),m(G,"class","h-[28px]"),m(G,"id","key"),m(z,"class","my-1 flex"),m(F,"class","flex flex-col h-full"),m(i,"class","options svelte-1u7ze7x"),$(i,"hidden",s[6]),m(e,"class",H=Te(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),$(e,"collapsed",s[6])},m(ue,we){U(ue,e,we),u(e,t),u(t,l),u(e,r),u(e,o),be(a,o,null),u(e,c),u(e,i),u(i,d),u(d,f),u(d,_),u(d,h),u(h,v),et(v,s[1]),u(h,N),u(h,k),u(h,L),u(h,V),et(V,s[2]),u(d,K),u(d,S),oe&&oe.m(S,null),u(i,T),u(i,A),u(A,w),u(A,P),u(A,I),be(O,I,null),u(A,R),he&&he.m(A,null),u(i,M),u(i,F),u(F,X),u(F,Y),u(F,z),u(z,G),et(G,s[4]),u(F,le),Q&&Q.m(F,null),se=!0,ce||(Ee=[J(l,"click",s[15]),J(o,"click",s[16]),J(v,"input",s[18]),J(v,"change",s[19]),J(v,"focus",s[12]),J(V,"input",s[20]),J(V,"change",s[21]),J(V,"focus",s[12]),J(G,"input",s[22]),J(G,"input",s[13])],ce=!0)},p(ue,we){(!se||we[0]&64)&&$(o,"hidden",ue[6]),we[0]&2&&v.value!==ue[1]&&et(v,ue[1]),we[0]&4&&V.value!==ue[2]&&et(V,ue[2]),ue[3]?oe?oe.p(ue,we):(oe=mn(ue),oe.c(),oe.m(S,null)):oe&&(oe.d(1),oe=null);const fe={};we[0]&1&&(fe.selected=ue[0]),O.$set(fe),ue[7]?he&&(he.d(1),he=null):he?he.p(ue,we):(he=_n(ue),he.c(),he.m(A,null)),we[0]&16&&G.value!==ue[4]&&et(G,ue[4]),ue[7]?Q&&(Q.d(1),Q=null):Q?Q.p(ue,we):(Q=gn(ue),Q.c(),Q.m(F,null)),(!se||we[0]&64)&&$(i,"hidden",ue[6]),(!se||we[0]&131072&&H!==(H=Te(`${ue[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&m(e,"class",H),(!se||we[0]&131136)&&$(e,"collapsed",ue[6])},i(ue){se||(x(a.$$.fragment,ue),x(O.$$.fragment,ue),se=!0)},o(ue){q(a.$$.fragment,ue),q(O.$$.fragment,ue),se=!1},d(ue){ue&&p(e),ye(a),oe&&oe.d(),ye(O),he&&he.d(),Q&&Q.d(),ce=!1,Qe(Ee)}}}function Wr(s,e,t){let l,n,r,o,a,c;_e(s,Mt,I=>t(23,n=I)),_e(s,Tt,I=>t(24,r=I)),_e(s,Et,I=>t(7,a=I)),_e(s,Ct,I=>t(8,c=I));let i=ft(n[0]),d=ft(n[1]),f="";const g=_t(Oe(!1),{key:"score-options-hidden"});_e(s,g,I=>t(6,o=I));let _=r[0],h=r[1];const v=ms(),N=v.map(I=>({key:I.names[0],value:I.names[0]}));Mt.subscribe(I=>{t(1,i=ft(I[0])),t(2,d=ft(I[1]))}),Tt.subscribe(I=>{t(4,_=I[0]),t(0,h=I[1])});function k(I,O){const R=lo(O.currentTarget.value,!0,!0);if("data"in R){const{midi:M}=R.data,F=n,X=[I==="min"?M:F[0].midi,I==="max"?M:F[1].midi];Be.setMidiRange(X),t(3,f="")}else t(3,f=R.err),I==="min"?t(1,i=ft(n[0])):t(2,d=ft(n[1]))}function E(){t(3,f="")}function L({currentTarget:{value:I}}){t(4,_=`${I.charAt(0).toUpperCase()}${I.charAt(1).toLowerCase()}`),De.setKey(_)}function V(I){var O;return t(0,h=(O=N.find(R=>I===R.key))==null?void 0:O.value),De.setScale(h),!1}function K(){g.update(I=>!I)}function S(){De.clearScore(!0),Be.setMidiRange([60,84])}function T(){i=this.value,t(1,i)}const A=I=>k("min",I);function w(){d=this.value,t(2,d)}const D=I=>k("max",I);function P(){_=this.value,t(4,_)}return s.$$set=I=>{t(17,e=Ae(Ae({},e),Se(I)))},s.$$.update=()=>{var I;s.$$.dirty[0]&1&&t(5,l=((I=v.find(O=>O.names[0]===h))==null?void 0:I.intervals)||[])},e=Se(e),[h,i,d,f,_,l,o,a,c,g,N,k,E,L,V,K,S,e,T,A,w,D,P]}class qr extends We{constructor(e){super(),qe(this,e,Wr,zr,Je,{},null,[-1,-1])}}function Jr(s){s[21]=s[22].default}function $r(s){return{c:me,l:me,m:me,i:me,o:me,d:me}}function Yr(s){Jr(s);let e,t,l;var n=s[21];function r(o,a){return{props:{class:"mx-4 md:mx-0"}}}return n&&(e=Bn(n,r())),{c(){e&&ge(e.$$.fragment),t=Pe()},l(o){e&&ve(e.$$.fragment,o),t=Pe()},m(o,a){e&&be(e,o,a),U(o,t,a),l=!0},i(o){l||(e&&x(e.$$.fragment,o),l=!0)},o(o){e&&q(e.$$.fragment,o),l=!1},d(o){o&&p(t),e&&ye(e,o)}}}function Qr(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){U(t,e,l)},i:me,o:me,d(t){t&&p(e)}}}function Xr(s){let e,t,l,n,r="MIDI Note Trainer",o,a,c,i,d,f,g,_="Introduction",h,v,N,k,E,L,V,K,S,T,A,w,D,P,I,O,R,M,F,X,ie;i=new Re({props:{icon:Ft,width:24}}),N=new yr({}),E=new Hr({}),V=new So({}),T=new qr({props:{class:"score-options mr-4"}}),w=new Vr({props:{class:"play-form"}});let Y={ctx:s,current:null,token:null,hasCatch:!1,pending:Qr,then:Yr,catch:$r,value:22,blocks:[,,,]};return On(Ce(()=>import("./Score.4db519a5.js"),["./Score.4db519a5.js","./vendor_svelte.a22c6d08.js","./vendor.e9b0235c.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),Y),O=new Ar({props:{class:"min-h-32",debounced:!!s[0]}}),O.$on("guessed-chord",s[2]),O.$on("guessed-key",s[3]),O.$on("guessed-note",s[4]),M=new Ko({props:{game:s[1]}}),{c(){e=b("meta"),t=j(),l=b("h1"),n=b("a"),n.textContent=r,o=j(),a=b("div"),c=b("button"),ge(i.$$.fragment),d=j(),f=b("div"),g=b("button"),g.textContent=_,h=j(),v=b("section"),ge(N.$$.fragment),k=j(),ge(E.$$.fragment),L=j(),ge(V.$$.fragment),K=j(),S=b("div"),ge(T.$$.fragment),A=j(),ge(w.$$.fragment),D=j(),Y.block.c(),P=j(),I=b("section"),ge(O.$$.fragment),R=j(),ge(M.$$.fragment),this.h()},l(z){const G=jn("svelte-1w2oado",document.head);e=y(G,"META",{name:!0,content:!0}),G.forEach(p),t=B(z),l=y(z,"H1",{class:!0});var le=C(l);n=y(le,"A",{class:!0,href:!0,"data-svelte-h":!0}),ae(n)!=="svelte-km4jns"&&(n.textContent=r),o=B(le),a=y(le,"DIV",{class:!0});var H=C(a);c=y(H,"BUTTON",{class:!0});var se=C(c);ve(i.$$.fragment,se),se.forEach(p),H.forEach(p),le.forEach(p),d=B(z),f=y(z,"DIV",{class:!0});var ce=C(f);g=y(ce,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(g)!=="svelte-f34gar"&&(g.textContent=_),ce.forEach(p),h=B(z),v=y(z,"SECTION",{class:!0});var Ee=C(v);ve(N.$$.fragment,Ee),k=B(Ee),ve(E.$$.fragment,Ee),L=B(Ee),ve(V.$$.fragment,Ee),K=B(Ee),S=y(Ee,"DIV",{class:!0});var oe=C(S);ve(T.$$.fragment,oe),A=B(oe),ve(w.$$.fragment,oe),oe.forEach(p),Ee.forEach(p),D=B(z),Y.block.l(z),P=B(z),I=y(z,"SECTION",{class:!0});var he=C(I);ve(O.$$.fragment,he),R=B(he),ve(M.$$.fragment,he),he.forEach(p),this.h()},h(){m(e,"name","description"),m(e,"content","App to practise music notation, scales and chords using MIDI"),m(n,"class","hover:underline"),m(n,"href","https://github.com/TeemuKoivisto/midi-note-trainer"),m(c,"class","rounded p-2 hover:bg-gray-200"),m(a,"class","flex items-center justify-center"),m(l,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight flex items-center justify-between"),m(g,"class","btn-pill border-2 border-gray-300 hover:bg-gray-200"),m(f,"class","px-4 md:px-0"),m(S,"class","play svelte-qjpqy3"),m(v,"class","mx-4 md:mx-0"),m(I,"class","mb-8 ml-16 flex flex-col")},m(z,G){u(document.head,e),U(z,t,G),U(z,l,G),u(l,n),u(l,o),u(l,a),u(a,c),be(i,c,null),U(z,d,G),U(z,f,G),u(f,g),U(z,h,G),U(z,v,G),be(N,v,null),u(v,k),be(E,v,null),u(v,L),be(V,v,null),u(v,K),u(v,S),be(T,S,null),u(S,A),be(w,S,null),U(z,D,G),Y.block.m(z,Y.anchor=G),Y.mount=()=>P.parentNode,Y.anchor=P,U(z,P,G),U(z,I,G),be(O,I,null),u(I,R),be(M,I,null),F=!0,X||(ie=[J(c,"click",s[5]),J(g,"click",s[6])],X=!0)},p(z,[G]){s=z;const le={};G&1&&(le.debounced=!!s[0]),O.$set(le);const H={};G&2&&(H.game=s[1]),M.$set(H)},i(z){F||(x(i.$$.fragment,z),x(N.$$.fragment,z),x(E.$$.fragment,z),x(V.$$.fragment,z),x(T.$$.fragment,z),x(w.$$.fragment,z),x(Y.block),x(O.$$.fragment,z),x(M.$$.fragment,z),F=!0)},o(z){q(i.$$.fragment,z),q(N.$$.fragment,z),q(E.$$.fragment,z),q(V.$$.fragment,z),q(T.$$.fragment,z),q(w.$$.fragment,z);for(let G=0;G<3;G+=1){const le=Y.blocks[G];q(le)}q(O.$$.fragment,z),q(M.$$.fragment,z),F=!1},d(z){z&&(p(t),p(l),p(d),p(f),p(h),p(v),p(D),p(P),p(I)),p(e),ye(i),ye(N),ye(E),ye(V),ye(T),ye(w),Y.block.d(z),Y.token=null,Y=null,ye(O),ye(M),X=!1,Qe(ie)}}}function Zr(s,e,t){let l,n,r,o,a,c;_e(s,dt,T=>t(9,l=T)),_e(s,Et,T=>t(1,n=T)),_e(s,mt,T=>t(10,r=T)),_e(s,nt,T=>t(11,o=T)),_e(s,lt,T=>t(12,a=T)),_e(s,Ns,T=>t(13,c=T));let i,d;bn(()=>(c&&V(),window.addEventListener("keydown",f),window.addEventListener("mousedown",f),window.addEventListener("touchstart",f),()=>{window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)})),fs.subscribe(T=>{T&&T.channels[1].addListener("noteon",g)});function f(){Be.initAudio(),window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)}function g(T){if(i)return;const A=T.rawData;_(A[1],A[2])}function _(T,A){const w=n;w instanceof Ot&&!(w!=null&&w.ended)&&l==="waiting"?N(T):w instanceof ht&&!(w!=null&&w.ended)&&l==="waiting"?(w.addPlayedNote(T),d||(d=setTimeout(v,2e3))):w||De.pushPlayed(T),a&&a.noteOn(T,o.fixedVelocity??A)}function h(){r.autoplay&&r.waitSeconds>0?t(0,i=setTimeout(()=>{r.autoplay&&Le.nextGuess(),t(0,i=void 0)},r.waitSeconds*1e3)):r.autoplay?Le.nextGuess():t(0,i=void 0)}function v(){var A;const T=n;if(T instanceof ht){const w=T.guess();De.setPlayed(((A=T.latestGuess.guessed)==null?void 0:A.notes)||[],w,-1),Le.updateState(w?"correct":"wrong"),h()}d=void 0}function N(T){const A=n;if(A instanceof Ot&&l==="waiting"){De.setTarget([De.getNote(A.current)]);const w=A.guess(T);Le.updateState(w?"correct":"wrong"),De.pushPlayed(T,w,4e3),h()}}function k(T){const A=n;if(A instanceof ht&&l==="waiting"){const w=A.guessWrittenChord(T.detail);Le.updateState(w?"correct":"wrong"),h()}}function E(T){const A=n;if(A instanceof xt&&l==="waiting"){const w=T.detail.replaceAll("♭","b").replaceAll("♯","#"),D=A.guess(w);Le.updateState(D?"correct":"wrong"),h()}}function L(T){const A=ut.findNote(T.detail.note)??Ms(T.detail.note);A&&_(A.semitones+12+T.detail.octave*12,80)}async function V(){const T=await Be.openMidi();"data"in T?T.data.name:(T.err,console.error(T.err))}function K(){co(),window.location.reload()}return[i,n,k,E,L,K,()=>Un.open("introduction",void 0)]}class na extends We{constructor(e){super(),qe(this,e,Zr,Xr,Je,{})}}export{rl as F,ht as G,na as P,Jn as S,Ot as a,Le as b,Et as c,kt as d,us as e,dt as g,lt as p,Ct as s,ul as t};
