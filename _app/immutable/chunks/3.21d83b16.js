import{_ as fe}from"./preload-helper.a4192956.js";import{R as Ee,Q as Ct,T as Ue,U as yn,S as $e,i as He,s as ze,O as Ze,V as ne,e as _,m as P,H as ve,a as v,b as I,n as ee,d as m,o as V,I as ge,f as h,L as H,W as Ce,g as M,h as u,J as be,p as $,t as F,C as et,w as tt,l as z,K as ye,X as Be,Y as ot,M as de,N as Te,P as Ae,z as J,A as Y,B as ae,v as Ge,q as me,c as en,u as tn,j as sn,k as ln,Z as Bs,_ as Wt,F as nn,$ as Gs,a0 as Ms,a1 as as,r as an,a2 as Qe,a3 as kn,a4 as Xt,a5 as En,a6 as wn,G as Cn}from"./vendor_svelte.a32d144a.js";import{w as Jt,b as Tn,c as An,e as Rs,f as Us,g as Cs,h as Zt,i as es,j as In,a as xs,k as vs}from"./vendor.13a9dfeb.js";const Ks={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function qe(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:on(s,e,t),flats:e,sharps:t}}function on(s,e,t){return(s<8?Ks[s]:Ks[s%7])-e+t+Math.floor(s/8)*12}function rn(s){let e,t=0,l=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(l=Math.floor(s/100),e=s%100):e=s;const n=on(e,t,l);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(l)}`,interval_seq:e,semitones:n,flats:t,sharps:l}}const Sn=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let hs=[];function cn(){return Sn.map(s=>{const e=s[3].map(rn);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function Ot(s){hs.length===0&&(hs=cn());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return hs.find(t=>t.suffixes.find(l=>l===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function Nn(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const a=Math.min(l,n);l-=a,n-=a}const o=(s.semitones+e)%12;return{...s,semitones:o<0?o+12:o,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function gs(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const o=t[n],a=s+o.semitones,r=e.scaleNotes.find(p=>p.semitones===a%12),i=o.flats>0,c=o.sharps>0,d=(i?a+1:c?a-1:a)%12,f=i?-1:c?1:0;l.push(Nn(r??e.notesMap.get(d),r?0:f,a))}return l}const Fs=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],Ln=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],$s=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Dn(s){let e=0,t=0;for(let l=0;l<Fs.length;l+=1){const n=s.find(a=>a.note.slice(0,2)===Fs[l]),o=s.find(a=>a.note.slice(0,2)===Ln[l]);if(n)e+=1;else if(o)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:$s.get(e*-1)}:{flats:0,sharps:t,majorSignature:$s.get(t)}}function jn(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function un(s){return s.map(e=>{const t=[qe(1)];let l;return e.major?(t.push(qe(3)),e.suffix.startsWith("+")?t.push(qe(5,0,1)):e.suffix.startsWith("6")?t.push(qe(6)):e.suffix.startsWith("7")?t.push(qe(7,1)):e.suffix.startsWith("maj7")?t.push(qe(7)):l=Ot("maj")):e.minor?(t.push(qe(3,1)),e.suffix.startsWith("°")?t.push(qe(5,1)):e.suffix.startsWith("6")?(t.push(qe(6)),l=Ot("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(qe(7,1)),l=Ot("m"+e.suffix)):l=Ot("m")):e.suffix.startsWith("sus2")?t.push(qe(2)):e.suffix.startsWith("sus4")&&t.push(qe(4)),t.length<=2&&t.push(qe(5)),t.length<=2&&t.push(qe(8)),l||(l=Ot(e.suffix)),{...l,intervals:t}})}function Pn(s,e){let t=e.has(4)&&e.has(7),l=e.has(3)&&e.has(7);const n=jn(s);let o="";return t||l||(e.has(3)&&e.has(6)?(o="°",l=!0):e.has(4)&&e.has(8)?(o="+",t=!0):e.has(3)&&e.has(10)?(l=!0,o="7"):e.has(4)&&e.has(10)?(o="7",t=!0):e.has(4)&&e.has(11)?(o="maj7",t=!0):e.has(3)&&e.has(8)?(o="6",l=!0):e.has(4)&&e.has(9)?(o="6",t=!0):e.has(2)?o="sus2":e.has(5)?o="sus4":e.has(7)?o="5":o="?"),{degree:s,roman:l?n.toLowerCase():n,suffix:o,major:t,minor:l,semitones:e}}function Vn(s){const e=s.length;return s.map((t,l)=>{const n=t.semitones,o=new Set;for(let a=1;a<e;a+=1){const r=s[(l+a)%e].semitones,i=r<=n?r+12-n:r-n;o.add(i)}return Pn(t.interval_seq,o)})}const On=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let ms=[];function Ts(){return On.map(s=>{const e=s[0],t=s[1].map(rn),l=Vn(t);return{names:e,intervals:t,triads:l}})}function Bn(s){ms.length===0&&(ms=Ts());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return ms.find(t=>t.names.find(l=>l.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const Gn=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,Mn=/^[0-9]$/,lt=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function As(s){return s===12?1:Math.floor((s-12)/12)}function Xe(s){return`${s.note}${As(s.midi)}`}function Lt(s){const t=(s-12)%12;return{...lt[t],semitones:t,midi:s}}function Rn(s,e=!0,t=!1){if(e&&!Gn.test(s))return{err:`Unrecognized note "${s}"`,code:400};const l=s.trim(),n=l.charAt(0).toUpperCase(),o=lt.find(f=>f.note.charAt(0)===n&&f.note.length===1);if(!o)return{err:`Unable to find note ${l}`,code:500};const a=l.slice(1).split("").reduce((f,p)=>f+(p.toLowerCase()==="b"||p==="♭"?-1:p==="#"||p==="♯"?1:0),0);let r;if(Mn.test(l.charAt(l.length-1)))try{r=parseInt(l.charAt(l.length-1),10)}catch{}if(t&&r===void 0)return{err:`No octave provided: ${s}`,code:400};r===void 0&&(r=0);let i=(o.semitones+a)%12;i=i<0?i+12:i;const c=a<0?-a:0,d=a>0?a:0;return{data:{note:`${n}${"♭".repeat(c)}${"♯".repeat(d)}`,semitones:i,midi:12+r*12+i,flats:c,sharps:d}}}function fn(s){const e=lt.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((n,o)=>n+(o.toLowerCase()==="b"||o==="♭"?-1:o==="#"||o==="♯"?1:0),0),l=(e.semitones+t)%12;return{note:s,semitones:l<0?l+12:l,flats:t<0?-t:0,sharps:t>0?t:0}}}const Un=/^[a-gA-G][♭b#♯]?$/,ps="ABCDEFG";function xn(s,e){return e.map(t=>ps.charAt((ps.indexOf(s)+t.interval_seq-1)%ps.length))}function Kn(s,e,t){return t.map((l,n)=>{const o=e[n],a=(s+l.semitones)%12,r=lt[a],i=r.note.charAt(0);if(i<o&&(i!=="A"||o!=="G")||i==="G"&&o==="A"){let c=1,d=lt[(a+c)%12];for(;d.note.charAt(0)!==o;)c+=1,d=lt[(a+c)%12];return{semitones:a,note:d.note+"♭".repeat(c),flats:c+(d.note.includes("♭")?1:0),sharps:0}}else if(i>o||i==="A"&&o==="G"){let c=1,d=a===0?lt.length-1:a-c,f=lt[d];for(;f.note.charAt(0)!==o;)c+=1,d=d===0?lt.length-1:d-1,f=lt[d];return{semitones:a,note:f.note+"♯".repeat(c),flats:0,sharps:c+(f.note.includes("♯")?1:0)}}else return{semitones:a,note:r.note,flats:r.flats,sharps:r.sharps}})}function ts(s,e){if(!Un.test(s))return{err:`Unknown key: ${s}`,code:400};const t=Bn(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const l=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,n=fn(l);if(!n)return{err:`Unable to find root for note: ${l}`,code:404};const o=xn(l.charAt(0),t.intervals),a=Kn(n.semitones,o,t.intervals),r=new Map(lt.map(i=>{const c=a.find(d=>d.semitones===i.semitones);return c?[i.semitones,c]:[i.semitones,{...i}]}));return{data:{key:l,scale:t.names[0],names:t.names,...Dn(a),intervals:t.intervals.map(i=>({...i})),triads:t.triads.map(i=>({...i})),scaleNotes:a,notesMap:r}}}const bs=new Map;function Fn(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function $n(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(l){return{err:`Failed to store the value: ${l}`,code:400}}}function ht(s,e){const{key:t,storage:l="local",namespace:n="default"}=e,o=Fn(t,l),a=Ee(s);"data"in o?s.set(e.deserialize?e.deserialize(o.data):o.data):"err"in o&&(e!=null&&e.debug)&&console.info(o.err);const r=s.subscribe(c=>{const d=$n(e.serialize?e.serialize(c):c,t,l);"err"in d&&(e!=null&&e.debug)&&console.error(d.err)}),i=bs.get(n);return i?i.push({key:t,storage:l,value:s,defaultValue:a,unsubscribe:r}):bs.set(n,[{key:t,storage:l,value:s,defaultValue:a,unsubscribe:r}]),s}function Hn(s=["default"],e){s.forEach(t=>{var l;(l=bs.get(t))==null||l.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function zn(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const l=await t.arrayBuffer();return{data:await e.decodeAudioData(l)}}async function qn(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],l=await Promise.all(t.map(o=>zn(`${s}${o}`,e))),n=[];return l.forEach(o=>{"err"in o?console.error(`Failed to load audio: ${o.err}`):n.push(o.data)}),n}class Wn{constructor(e,t,l,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(l),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(l))}on(e,t,l,n,o,a,r,i){this.noteA.buffer=e,this.noteA.playbackRate.value=l,this.biquadFilter.frequency.value=o,this.gainA.gain.value=a,this.gain.gain.value=i,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=r,this.noteB.start(0)),this.noteA.start(0)}off(e,t,l){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(l),this.noteB.stop(l),(n=this.damp)==null||n.start(0)}}class Jn{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,l)=>{this.bufferlists.push(t),l===8?this.damper=t:l===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(l=>{this.noteOn(l,t)})}noteOn(e,t=80){if(e<109&&e>20){const l=this.notes.get(e);l&&(l.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),o=n+1,a=n*12+21,r=2**((e-69)/12)*440,i=t/127;let c=r*(2-(e-21)/50)+3*r*i;e<60&&(c=440*(3-(60-21)/50)+3*r*i);const d=1-(e%12/12+1)/12,f=Math.pow(2,(e-a)/12),p=0,b=0,g=i**1.4,y=new Wn(e,this.context,this.directGain,this.damper);y.on(this.bufferlists[n],this.bufferlists[o],f,p,c,d,b,g),this.notes.set(e,y)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const Yn="/midi-note-trainer/",ys=ht(Ue(!1),{key:"midi-access"}),ss=Ue(void 0),os=ht(Ue([60,84]),{key:"midi-range",storage:"session"}),ls=Ct(os,s=>[Lt(s[0]),Lt(s[1])]),Hs=Ue(void 0),nt=Ue(void 0),at=ht(Ue({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),We={async openMidi(){return Jt.enable().then(()=>(ys.set(!0),Jt.inputs.length>0?(ss.set(Jt.inputs[0]),{data:Jt.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(s=>({err:s.toString(),code:403}))},disableMidi(){ys.set(!1),ss.set(void 0)},setMidiRange(s){os.set(s)},setInputValue(s,e){at.update(t=>({...t,[s]:e})),s==="useSound"&&!e?nt.set(void 0):s==="useSound"&&!Ee(nt)&&this.initAudio()},async initAudio(){let s=Ee(Hs);if(s||(s=new AudioContext,Hs.set(s)),!Ee(nt)){const e=new Jn(s),t=await qn(`${Yn}audio`,s);e.load(t),nt.set(e)}}};let st;yn({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}});const wt=Ue(["C","Major"]),Pt=Ct(wt,s=>{const e=ts(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),zs=Ue([]),gt=Ue([]);function ks(s,e){if(s.length>0){const t=Date.now();let l=t;const n=s.filter(o=>(o.started+e>t&&(l=Math.min(l,o.started)),o.started+e>t));return!st&&n.length>0&&(st=setTimeout(()=>{st=void 0,gt.update(o=>ks(o,e))},e-(t-l)+100)),n}return s}const we={setKey(s){wt.update(e=>[s,e[1]])},setScale(s){wt.update(e=>[e[0],s])},setKeyAndScale(s,e){wt.set([s,e])},setTarget(s=[]){zs.set(s)},getNote(s){return{...Ee(Pt).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const n={...Ee(Pt).notesMap.get(s%12),midi:s},o=Date.now(),a=e===void 0?"default":e?"correct":"wrong";if(gt.update(r=>{const i=r.findIndex(c=>c.midi===s);return i>=0&&r.splice(i,1),[...r,{...n,color:a,started:o}]}),!st&&t!==-1){const r=t??Ee(at).keyFadeTimeout;st=setTimeout(()=>{st=void 0,gt.update(i=>ks(i,r))},r)}},setPlayed(s,e,t){const l=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(gt.update(o=>[...s.map(a=>({...a,color:n,started:l}))]),!st&&t!==-1){const o=t??Ee(at).keyFadeTimeout;st=setTimeout(()=>{st=void 0,gt.update(a=>ks(a,o))},o)}},clearPlayed(){gt.set([]),clearTimeout(st),st=void 0},clearScore(s=!1){s&&wt.set(["C","Major"]),zs.set([]),gt.set([])}};class Is{constructor(e,t,l){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=l;const n=[],{count:o}=l,a=t.map(i=>typeof i=="object"&&i!==null?{...i}:i);let r=l.duplicates;!l.duplicates&&o>a.length&&(console.warn(`Trying to create game with count ${o} larger than available unique values ${t.length}`),r=!0);for(let i=0;i<o;i+=1){const c=Math.floor(Math.random()*a.length);if(r)n.push(a[c]);else{const d=a.splice(c,1);d.length>0&&n.push(d[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function Qn(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const a=Math.min(l,n);l-=a,n-=a}const o=(s.semitones+e)%12;return{...s,semitones:o<0?o+12:o,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function Xn(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const o=t[n],a=s+o.semitones,r=e.scaleNotes.find(p=>p.semitones===a%12),i=o.flats>0,c=o.sharps>0,d=(i?a+1:c?a-1:a)%12,f=i?-1:c?1:0;l.push(Qn(r??e.notesMap.get(d),r?0:f,a))}return l}const Zn=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function ea(s){const t=(s-12)%12;return{...Zn[t],semitones:t,midi:s}}function ta(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class ft extends Is{constructor(e,t,l){const n=t.range[0],o=t.range[1],a=new Set(t.scale.scaleNotes.map(i=>i.semitones)),r=l.chords.flatMap(i=>{const c=[],d=i.intervals.reduce((f,p)=>p.semitones>f?p.semitones:f,0);for(let f=n;f<=o-d;f+=1)if((!l.onlyScale||a.has(f%12))&&(!i.allowed||i.allowed.has(f%12))){const p=Xn(f,t.scale,i.intervals);c.push({...i,rootNote:p[0].note,chord:`${p[0].note}${i.suffixes[0]}`,notes:p})}return c});super(e,r,t),this.played=new Set,this.opts=l}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${ta(e)}${e.chord.toLowerCase()}`,notes:[]};let l=this.current.chord===t.chord;return this.current.chord.slice(-3)==="maj"&&!l&&(l=this.current.chord.slice(0,-3)===t.chord),this.addGuessed(t,l)}guess(){const e=Array.from(this.played.values()).map(n=>ea(n)).sort((n,o)=>n.midi-o.midi);this.played.clear();const t={chord:"",notes:e},l=this.current.notes.every(n=>e.find(o=>o.midi%12===n.midi%12));return this.addGuessed(t,l)}}const sa={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class Bt extends Is{constructor(e,t){const l=e==="keys-major"?"major":"minor";super(e,Object.keys(sa[l]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class jt extends Is{constructor(e,t){const l=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-l+1)).map((o,a)=>l+a),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const dn={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},bt=Ue("waiting"),dt=ht(Ue(dn),{key:"game-options"}),kt=Ue(void 0),Ss=Ue(cn().map(s=>({...s,selected:!0}))),Se={play(...[s,e]){var i,c,d;let t;const l=Ee(Pt),n=Ee(os),o=Ee(dt),a={scale:l,range:n,duplicates:o.duplicates,count:o.count};let r=[l.key,l.scale];if(s==="notes")t=new jt(s,a),we.setTarget([we.getNote(t.current)]),(i=Ee(nt))==null||i.noteOn(t.current);else if(s==="pitches")t=new jt(s,a),we.setTarget(),We.setInputValue("useSound",!0),(c=Ee(nt))==null||c.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new Bt(s,a),r=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new ft(s,a,e);else if(s==="chords-diatonic"){const f=un(l.triads).map((p,b)=>({...p,allowed:new Set([l.scaleNotes[b].semitones])}));t=new ft(s,a,{chords:f})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((d=Ee(nt))==null||d.playChord(t.current.notes.map(f=>f.midi)),we.setTarget(t.current.notes)),we.setKeyAndScale(r[0],r[1]),we.clearPlayed(),bt.set("waiting"),kt.set(t),t},updateState(s){bt.set(s)},setOptionValue(s,e){dt.update(t=>({...t,[s]:e}))},toggleChords(s){Ss.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Ee(kt);s!=null&&s.ended?bt.set("ended"):s instanceof jt?(s.type==="notes"?we.setTarget([we.getNote(s.current)]):we.setTarget(),we.clearPlayed(),(e=Ee(nt))==null||e.noteOn(s.current),Se.updateState("waiting"),s.startTime()):s instanceof ft?(we.setTarget(s.current.notes),we.clearPlayed(),(t=Ee(nt))==null||t.playChord(s==null?void 0:s.current.notes.map(l=>l.midi)),bt.set("waiting"),s.startTime()):s instanceof Bt&&(we.setKey(s.current),bt.set("waiting"),s.startTime())},clearGame(s=!1){const e=Ee(kt);e&&we.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&dt.set(dn),kt.set(void 0),bt.set("waiting"),we.clearScore()}};function qs(s,e,t){const l=s.slice();return l[25]=e[t],l[27]=t,l}function Ws(s,e,t){const l=s.slice();return l[30]=e[t],l}function Js(s,e,t){const l=s.slice();return l[8]=e[t],l}function Ys(s,e,t){const l=s.slice();return l[25]=e[t],l[27]=t,l}function Qs(s,e,t){const l=s.slice();return l[30]=e[t],l}function Xs(s,e,t){const l=s.slice();return l[8]=e[t],l}function la(s){let e,t=ne(s[25].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=Zs(Qs(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let o=0;o<l.length;o+=1)l[o].l(n);e=Ge()},m(n,o){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,o);M(n,e,o)},p(n,o){if(o[0]&64){t=ne(n[25].intervals);let a;for(a=0;a<t.length;a+=1){const r=Qs(n,t,a);l[a]?l[a].p(r,o):(l[a]=Zs(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function na(s){let e,t=ne(s[2][s[27]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=el(Xs(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let o=0;o<l.length;o+=1)l[o].l(n);e=Ge()},m(n,o){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,o);M(n,e,o)},p(n,o){if(o[0]&4){t=ne(n[2][n[27]]);let a;for(a=0;a<t.length;a+=1){const r=Xs(n,t,a);l[a]?l[a].p(r,o):(l[a]=el(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Zs(s){let e,t=s[30].interval+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var o=I(e);l=Y(o,t),o.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,o){M(n,e,o),u(e,l)},p(n,o){o[0]&64&&t!==(t=n[30].interval+"")&&ae(l,t)},d(n){n&&m(e)}}}function el(s){let e,t=s[8].note+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var o=I(e);l=Y(o,t),o.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,o){M(n,e,o),u(e,l)},p(n,o){o[0]&4&&t!==(t=n[8].note+"")&&ae(l,t)},d(n){n&&m(e)}}}function tl(s){let e,t,l,n,o,a,r=s[25].suffixes[0]+"",i,c,d,f,p,b,g=s[25].name+"",y,N,E,O;n=new Ze({props:{icon:s[25].selected?Zt:es,width:12}});function D(){return s[21](s[25])}function k(j,G){return j[2][j[27]]&&j[2][j[27]].length>0?na:la}let L=k(s),S=L(s);return{c(){e=_("li"),t=_("button"),l=_("span"),ve(n.$$.fragment),o=P(),a=_("div"),i=J(r),c=P(),d=_("li"),S.c(),p=P(),b=_("li"),y=J(g),this.h()},l(j){e=v(j,"LI",{});var G=I(e);t=v(G,"BUTTON",{class:!0});var w=I(t);l=v(w,"SPAN",{class:!0});var B=I(l);ge(n.$$.fragment,B),B.forEach(m),o=V(w),a=v(w,"DIV",{class:!0});var A=I(a);i=Y(A,r),A.forEach(m),w.forEach(m),G.forEach(m),c=V(j),d=v(j,"LI",{class:!0,title:!0});var C=I(d);S.l(C),C.forEach(m),p=V(j),b=v(j,"LI",{class:!0});var T=I(b);y=Y(T,g),T.forEach(m),this.h()},h(){h(l,"class","px-1 py-1 rounded"),H(l,"text-green-500",s[25].selected),H(l,"text-gray-400",!s[25].selected),h(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),h(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),H(t,"hidden",s[7]),h(d,"class","intervals svelte-1j99daw"),h(d,"title",f=s[25].intervals.map(ol).join("-")),h(b,"class","text-xs")},m(j,G){M(j,e,G),u(e,t),u(t,l),be(n,l,null),u(t,o),u(t,a),u(a,i),M(j,c,G),M(j,d,G),S.m(d,null),M(j,p,G),M(j,b,G),u(b,y),N=!0,E||(O=$(t,"click",D),E=!0)},p(j,G){s=j;const w={};G[0]&64&&(w.icon=s[25].selected?Zt:es),n.$set(w),(!N||G[0]&64)&&H(l,"text-green-500",s[25].selected),(!N||G[0]&64)&&H(l,"text-gray-400",!s[25].selected),(!N||G[0]&64)&&r!==(r=s[25].suffixes[0]+"")&&ae(i,r),(!N||G[0]&128)&&H(t,"hidden",s[7]),L===(L=k(s))&&S?S.p(s,G):(S.d(1),S=L(s),S&&(S.c(),S.m(d,null))),(!N||G[0]&64&&f!==(f=s[25].intervals.map(ol).join("-")))&&h(d,"title",f),(!N||G[0]&64)&&g!==(g=s[25].name+"")&&ae(y,g)},i(j){N||(F(n.$$.fragment,j),N=!0)},o(j){z(n.$$.fragment,j),N=!1},d(j){j&&(m(e),m(c),m(d),m(p),m(b)),ye(n),S.d(),E=!1,O()}}}function aa(s){let e,t=ne(s[25].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=sl(Ws(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let o=0;o<l.length;o+=1)l[o].l(n);e=Ge()},m(n,o){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,o);M(n,e,o)},p(n,o){if(o[0]&32){t=ne(n[25].intervals);let a;for(a=0;a<t.length;a+=1){const r=Ws(n,t,a);l[a]?l[a].p(r,o):(l[a]=sl(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function oa(s){let e,t=ne(s[3][s[27]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=ll(Js(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let o=0;o<l.length;o+=1)l[o].l(n);e=Ge()},m(n,o){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,o);M(n,e,o)},p(n,o){if(o[0]&8){t=ne(n[3][n[27]]);let a;for(a=0;a<t.length;a+=1){const r=Js(n,t,a);l[a]?l[a].p(r,o):(l[a]=ll(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function sl(s){let e,t=s[30].interval+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var o=I(e);l=Y(o,t),o.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,o){M(n,e,o),u(e,l)},p(n,o){o[0]&32&&t!==(t=n[30].interval+"")&&ae(l,t)},d(n){n&&m(e)}}}function ll(s){let e,t=s[8].note+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var o=I(e);l=Y(o,t),o.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,o){M(n,e,o),u(e,l)},p(n,o){o[0]&8&&t!==(t=n[8].note+"")&&ae(l,t)},d(n){n&&m(e)}}}function nl(s){let e,t,l,n,o,a,r=s[25].suffixes[0]+"",i,c,d,f,p,b,g=s[25].name+"",y,N,E,O;n=new Ze({props:{icon:s[25].selected?Zt:es,width:12}});function D(){return s[22](s[25])}function k(j,G){return j[3][j[27]]&&j[3][j[27]].length>0?oa:aa}let L=k(s),S=L(s);return{c(){e=_("li"),t=_("button"),l=_("span"),ve(n.$$.fragment),o=P(),a=_("div"),i=J(r),c=P(),d=_("li"),S.c(),p=P(),b=_("li"),y=J(g),this.h()},l(j){e=v(j,"LI",{});var G=I(e);t=v(G,"BUTTON",{class:!0});var w=I(t);l=v(w,"SPAN",{class:!0});var B=I(l);ge(n.$$.fragment,B),B.forEach(m),o=V(w),a=v(w,"DIV",{class:!0});var A=I(a);i=Y(A,r),A.forEach(m),w.forEach(m),G.forEach(m),c=V(j),d=v(j,"LI",{class:!0,title:!0});var C=I(d);S.l(C),C.forEach(m),p=V(j),b=v(j,"LI",{class:!0});var T=I(b);y=Y(T,g),T.forEach(m),this.h()},h(){h(l,"class","px-1 py-1 rounded"),H(l,"text-green-500",s[25].selected),H(l,"text-gray-400",!s[25].selected),h(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),h(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),H(t,"hidden",s[7]),h(d,"class","intervals svelte-1j99daw"),h(d,"title",f=s[25].intervals.map(rl).join("-")),h(b,"class","text-xs")},m(j,G){M(j,e,G),u(e,t),u(t,l),be(n,l,null),u(t,o),u(t,a),u(a,i),M(j,c,G),M(j,d,G),S.m(d,null),M(j,p,G),M(j,b,G),u(b,y),N=!0,E||(O=$(t,"click",D),E=!0)},p(j,G){s=j;const w={};G[0]&32&&(w.icon=s[25].selected?Zt:es),n.$set(w),(!N||G[0]&32)&&H(l,"text-green-500",s[25].selected),(!N||G[0]&32)&&H(l,"text-gray-400",!s[25].selected),(!N||G[0]&32)&&r!==(r=s[25].suffixes[0]+"")&&ae(i,r),(!N||G[0]&128)&&H(t,"hidden",s[7]),L===(L=k(s))&&S?S.p(s,G):(S.d(1),S=L(s),S&&(S.c(),S.m(d,null))),(!N||G[0]&32&&f!==(f=s[25].intervals.map(rl).join("-")))&&h(d,"title",f),(!N||G[0]&32)&&g!==(g=s[25].name+"")&&ae(y,g)},i(j){N||(F(n.$$.fragment,j),N=!0)},o(j){z(n.$$.fragment,j),N=!1},d(j){j&&(m(e),m(c),m(d),m(p),m(b)),ye(n),S.d(),E=!1,O()}}}function ra(s){let e,t,l,n,o="Chords",a,r,i,c,d,f,p,b,g,y,N,E,O,D,k,L,S,j="Key",G,w,B,A,C="Scale",T,R,x,K,ce="Note",ue,se,Q,ke,X,oe,Ie,he,ie,Ve;c=new Ze({props:{icon:Tn,width:20}}),p=new Ze({props:{icon:An,width:16}}),y=new Ze({props:{icon:s[4]?Rs:Us,width:16}}),O=new Ze({props:{icon:Cs,width:16}});let Ne=ne(s[6]),le=[];for(let U=0;U<Ne.length;U+=1)le[U]=tl(Ys(s,Ne,U));const De=U=>z(le[U],1,1,()=>{le[U]=null});let pe=ne(s[5]),q=[];for(let U=0;U<pe.length;U+=1)q[U]=nl(qs(s,pe,U));const re=U=>z(q[U],1,1,()=>{q[U]=null});return{c(){e=_("div"),t=_("fieldset"),l=_("legend"),n=_("button"),n.textContent=o,a=P(),r=_("div"),i=_("button"),ve(c.$$.fragment),d=P(),f=_("button"),ve(p.$$.fragment),b=P(),g=_("button"),ve(y.$$.fragment),N=P(),E=_("button"),ve(O.$$.fragment),D=P(),k=_("div"),L=_("div"),S=_("label"),S.textContent=j,G=P(),w=_("input"),B=P(),A=_("label"),A.textContent=C,T=P(),R=_("input"),x=P(),K=_("label"),K.textContent=ce,ue=P(),se=_("input"),Q=P(),ke=_("ul");for(let U=0;U<le.length;U+=1)le[U].c();X=P(),oe=_("ul");for(let U=0;U<q.length;U+=1)q[U].c();this.h()},l(U){e=v(U,"DIV",{class:!0});var Z=I(e);t=v(Z,"FIELDSET",{class:!0});var _e=I(t);l=v(_e,"LEGEND",{class:!0});var te=I(l);n=v(te,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1knqzl6"&&(n.textContent=o),te.forEach(m),a=V(_e),r=v(_e,"DIV",{class:!0});var Le=I(r);i=v(Le,"BUTTON",{class:!0});var Me=I(i);ge(c.$$.fragment,Me),Me.forEach(m),d=V(Le),f=v(Le,"BUTTON",{class:!0});var rt=I(f);ge(p.$$.fragment,rt),rt.forEach(m),b=V(Le),g=v(Le,"BUTTON",{class:!0});var Je=I(g);ge(y.$$.fragment,Je),Je.forEach(m),N=V(Le),E=v(Le,"BUTTON",{class:!0});var xe=I(E);ge(O.$$.fragment,xe),xe.forEach(m),Le.forEach(m),D=V(_e),k=v(_e,"DIV",{class:!0});var Oe=I(k);L=v(Oe,"DIV",{class:!0});var je=I(L);S=v(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(S)!=="svelte-14m38zf"&&(S.textContent=j),G=V(je),w=v(je,"INPUT",{class:!0,id:!0}),B=V(je),A=v(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(A)!=="svelte-bxhcb0"&&(A.textContent=C),T=V(je),R=v(je,"INPUT",{class:!0,id:!0}),x=V(je),K=v(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(K)!=="svelte-dmbfli"&&(K.textContent=ce),ue=V(je),se=v(je,"INPUT",{class:!0,id:!0}),je.forEach(m),Q=V(Oe),ke=v(Oe,"UL",{class:!0});var Vt=I(ke);for(let Ke=0;Ke<le.length;Ke+=1)le[Ke].l(Vt);Vt.forEach(m),X=V(Oe),oe=v(Oe,"UL",{class:!0});var Tt=I(oe);for(let Ke=0;Ke<q.length;Ke+=1)q[Ke].l(Tt);Tt.forEach(m),Oe.forEach(m),_e.forEach(m),Z.forEach(m),this.h()},h(){h(n,"class","px-1 rounded hover:bg-gray-100"),h(l,"class","text-base"),h(i,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),H(i,"hidden",s[7]),h(f,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),H(f,"hidden",s[7]),h(g,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),H(g,"hidden",s[7]),h(E,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),H(E,"hidden",s[7]),h(r,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),h(S,"class","mr-4 font-bold svelte-1j99daw"),h(S,"for","scale-key"),h(w,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(w,"id","scale-key"),w.value=s[0],h(A,"class","font-bold svelte-1j99daw"),h(A,"for","scale-key"),h(R,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(R,"id","scale-key"),R.value="Major",R.disabled=!0,h(K,"class","font-bold svelte-1j99daw"),h(K,"for","scale-key"),h(se,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(se,"id","scale-key"),se.value=s[1],h(L,"class","flex mb-2 input svelte-1j99daw"),h(ke,"class","chord-list w-full svelte-1j99daw"),h(oe,"class","chord-list w-full svelte-1j99daw"),h(k,"class","body svelte-1j99daw"),H(k,"hidden",s[7]),h(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1j99daw"),H(t,"collapsed",s[7]),h(e,"class",Ie=Ce(`${s[18].class||""}`)+" svelte-1j99daw")},m(U,Z){M(U,e,Z),u(e,t),u(t,l),u(l,n),u(t,a),u(t,r),u(r,i),be(c,i,null),u(r,d),u(r,f),be(p,f,null),u(r,b),u(r,g),be(y,g,null),u(r,N),u(r,E),be(O,E,null),u(t,D),u(t,k),u(k,L),u(L,S),u(L,G),u(L,w),u(L,B),u(L,A),u(L,T),u(L,R),u(L,x),u(L,K),u(L,ue),u(L,se),u(k,Q),u(k,ke);for(let _e=0;_e<le.length;_e+=1)le[_e]&&le[_e].m(ke,null);u(k,X),u(k,oe);for(let _e=0;_e<q.length;_e+=1)q[_e]&&q[_e].m(oe,null);he=!0,ie||(Ve=[$(n,"click",s[10]),$(i,"click",s[14]),$(f,"click",s[15]),$(g,"click",s[16]),$(E,"click",s[17]),$(w,"input",s[11]),$(se,"input",s[12])],ie=!0)},p(U,Z){(!he||Z[0]&128)&&H(i,"hidden",U[7]),(!he||Z[0]&128)&&H(f,"hidden",U[7]);const _e={};if(Z[0]&16&&(_e.icon=U[4]?Rs:Us),y.$set(_e),(!he||Z[0]&128)&&H(g,"hidden",U[7]),(!he||Z[0]&128)&&H(E,"hidden",U[7]),(!he||Z[0]&1&&w.value!==U[0])&&(w.value=U[0]),(!he||Z[0]&2&&se.value!==U[1])&&(se.value=U[1]),Z[0]&8388){Ne=ne(U[6]);let te;for(te=0;te<Ne.length;te+=1){const Le=Ys(U,Ne,te);le[te]?(le[te].p(Le,Z),F(le[te],1)):(le[te]=tl(Le),le[te].c(),F(le[te],1),le[te].m(ke,null))}for(et(),te=Ne.length;te<le.length;te+=1)De(te);tt()}if(Z[0]&8360){pe=ne(U[5]);let te;for(te=0;te<pe.length;te+=1){const Le=qs(U,pe,te);q[te]?(q[te].p(Le,Z),F(q[te],1)):(q[te]=nl(Le),q[te].c(),F(q[te],1),q[te].m(oe,null))}for(et(),te=pe.length;te<q.length;te+=1)re(te);tt()}(!he||Z[0]&128)&&H(k,"hidden",U[7]),(!he||Z[0]&128)&&H(t,"collapsed",U[7]),(!he||Z[0]&262144&&Ie!==(Ie=Ce(`${U[18].class||""}`)+" svelte-1j99daw"))&&h(e,"class",Ie)},i(U){if(!he){F(c.$$.fragment,U),F(p.$$.fragment,U),F(y.$$.fragment,U),F(O.$$.fragment,U);for(let Z=0;Z<Ne.length;Z+=1)F(le[Z]);for(let Z=0;Z<pe.length;Z+=1)F(q[Z]);he=!0}},o(U){z(c.$$.fragment,U),z(p.$$.fragment,U),z(y.$$.fragment,U),z(O.$$.fragment,U),le=le.filter(Boolean);for(let Z=0;Z<le.length;Z+=1)z(le[Z]);q=q.filter(Boolean);for(let Z=0;Z<q.length;Z+=1)z(q[Z]);he=!1},d(U){U&&m(e),ye(c),ye(p),ye(y),ye(O),Be(le,U),Be(q,U),ie=!1,ot(Ve)}}}let al="Major";const ol=s=>s.interval,rl=s=>s.interval;function ia(s,e,t){let l,n,o,a,r,i;de(s,Ss,A=>t(20,r=A));let c="C",d=ts(c,al),f="",p,b=[],g=[];const y=ht(Ue(!0),{key:"chords-hidden"});de(s,y,A=>t(7,i=A));function N(){y.update(A=>!A)}function E(){const A=p&&60+p.semitones;if("err"in d||!A)t(2,b=[]),t(3,g=[]);else{const C=d.data;t(2,b=n.map(T=>gs(A,C,T.intervals))),t(3,g=o.map(T=>gs(A,C,T.intervals)))}}function O({currentTarget:{value:A}}){t(0,c=`${A.charAt(0).toUpperCase()}${A.charAt(1).toLowerCase()}`),d=ts(c,al),E()}function D({currentTarget:{value:A}}){t(1,f=`${A.charAt(0).toUpperCase()}${A.charAt(1).toLowerCase()}`),t(8,p=fn(f)),E()}function k(A){Se.toggleChords(C=>C.name===A.name?!C.selected:C.selected)}function L(){const A=T=>T.suffixes[0]==="maj"||T.suffixes[0]==="m",C=r.filter(A).every(T=>T.selected);Se.toggleChords(T=>A(T)?!C:T.selected)}function S(){const A=T=>T.suffixes[0]==="maj7"||T.suffixes[0]==="m7"||T.suffixes[0]==="7"||T.suffixes[0]==="dim7"||T.suffixes[0]==="aug7",C=r.filter(A).every(T=>T.selected);Se.toggleChords(T=>A(T)?!C:T.selected)}function j(){Se.toggleChords(A=>!a)}function G(){Se.toggleChords(A=>!0)}const w=A=>k(A),B=A=>k(A);return s.$$set=A=>{t(18,e=Te(Te({},e),Ae(A)))},s.$$.update=()=>{s.$$.dirty[0]&1048576&&t(19,l=r),s.$$.dirty[0]&524288&&t(6,n=l.filter((A,C)=>C<l.length/2)),s.$$.dirty[0]&524288&&t(5,o=l.filter((A,C)=>C>=l.length/2)),s.$$.dirty[0]&524288&&t(4,a=l.every(A=>A.selected))},e=Ae(e),[c,f,b,g,a,o,n,i,p,y,N,O,D,k,L,S,j,G,e,l,r,w,B]}class ca extends $e{constructor(e){super(),He(this,e,ia,ra,ze,{},null,[-1,-1])}}function il(s,e,t){const l=s.slice();return l[10]=e[t],l}function ua(s){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,l){M(t,e,l)},p:me,d(t){t&&m(e)}}}function fa(s){let e,t,l="Played:",n,o=ne(s[2]),a=[];for(let r=0;r<o.length;r+=1)a[r]=cl(il(s,o,r));return{c(){e=_("div"),t=_("span"),t.textContent=l,n=P();for(let r=0;r<a.length;r+=1)a[r].c()},l(r){e=v(r,"DIV",{});var i=I(e);t=v(i,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1g6xxhn"&&(t.textContent=l),n=V(i);for(let c=0;c<a.length;c+=1)a[c].l(i);i.forEach(m)},m(r,i){M(r,e,i),u(e,t),u(e,n);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(e,null)},p(r,i){if(i&4){o=ne(r[2]);let c;for(c=0;c<o.length;c+=1){const d=il(r,o,c);a[c]?a[c].p(d,i):(a[c]=cl(d),a[c].c(),a[c].m(e,null))}for(;c<a.length;c+=1)a[c].d(1);a.length=o.length}},d(r){r&&m(e),Be(a,r)}}}function da(s){let e,t,l="Result:",n,o,a,r=s[0].correct+"",i,c,d=s[0].sampled.length+"",f,p,b,g,y,N=s[0].avgTime+"",E,O;return{c(){e=_("div"),t=_("span"),t.textContent=l,n=P(),o=_("span"),a=J("["),i=J(r),c=J(" / "),f=J(d),p=J("]"),b=P(),g=_("span"),y=J("avg "),E=J(N),O=J("s"),this.h()},l(D){e=v(D,"DIV",{class:!0});var k=I(e);t=v(k,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1eqfbgx"&&(t.textContent=l),n=V(k),o=v(k,"SPAN",{class:!0});var L=I(o);a=Y(L,"["),i=Y(L,r),c=Y(L," / "),f=Y(L,d),p=Y(L,"]"),L.forEach(m),b=V(k),g=v(k,"SPAN",{});var S=I(g);y=Y(S,"avg "),E=Y(S,N),O=Y(S,"s"),S.forEach(m),k.forEach(m),this.h()},h(){h(o,"class","mx-2"),h(e,"class","flex")},m(D,k){M(D,e,k),u(e,t),u(e,n),u(e,o),u(o,a),u(o,i),u(o,c),u(o,f),u(o,p),u(e,b),u(e,g),u(g,y),u(g,E),u(g,O)},p(D,k){k&1&&r!==(r=D[0].correct+"")&&ae(i,r),k&1&&d!==(d=D[0].sampled.length+"")&&ae(f,d),k&1&&N!==(N=D[0].avgTime+"")&&ae(E,N)},d(D){D&&m(e)}}}function ha(s){var j,G,w,B;let e,t,l="Target:",n,o,a=((j=s[0].latestGuess.target)==null?void 0:j.chord)+"",r,i,c,d=((G=s[0].latestGuess.target)==null?void 0:G.notes.map(ul).join(" "))+"",f,p,b,g="Guessed:",y,N,E=((w=s[0].latestGuess.guessed)==null?void 0:w.chord)+"",O,D,k,L=((B=s[0].latestGuess.guessed)==null?void 0:B.notes.map(fl).join(" "))+"",S;return{c(){e=_("div"),t=_("span"),t.textContent=l,n=P(),o=_("span"),r=J(a),i=P(),c=_("span"),f=J(d),p=P(),b=_("span"),b.textContent=g,y=P(),N=_("span"),O=J(E),D=P(),k=_("span"),S=J(L),this.h()},l(A){e=v(A,"DIV",{class:!0});var C=I(e);t=v(C,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=V(C),o=v(C,"SPAN",{});var T=I(o);r=Y(T,a),T.forEach(m),i=V(C),c=v(C,"SPAN",{});var R=I(c);f=Y(R,d),R.forEach(m),p=V(C),b=v(C,"SPAN",{"data-svelte-h":!0}),ee(b)!=="svelte-104368"&&(b.textContent=g),y=V(C),N=v(C,"SPAN",{});var x=I(N);O=Y(x,E),x.forEach(m),D=V(C),k=v(C,"SPAN",{});var K=I(k);S=Y(K,L),K.forEach(m),C.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(A,C){M(A,e,C),u(e,t),u(e,n),u(e,o),u(o,r),u(e,i),u(e,c),u(c,f),u(e,p),u(e,b),u(e,y),u(e,N),u(N,O),u(e,D),u(e,k),u(k,S)},p(A,C){var T,R,x,K;C&1&&a!==(a=((T=A[0].latestGuess.target)==null?void 0:T.chord)+"")&&ae(r,a),C&1&&d!==(d=((R=A[0].latestGuess.target)==null?void 0:R.notes.map(ul).join(" "))+"")&&ae(f,d),C&1&&E!==(E=((x=A[0].latestGuess.guessed)==null?void 0:x.chord)+"")&&ae(O,E),C&1&&L!==(L=((K=A[0].latestGuess.guessed)==null?void 0:K.notes.map(fl).join(" "))+"")&&ae(S,L)},d(A){A&&m(e)}}}function ma(s){let e,t,l="Target:",n,o,a=s[0].latestGuess.target+"",r,i,c,d,f,p="Guessed:",b,g,y=s[0].latestGuess.guessed+"",N,E,O;return{c(){e=_("div"),t=_("span"),t.textContent=l,n=P(),o=_("span"),r=J(a),i=P(),c=_("span"),d=P(),f=_("span"),f.textContent=p,b=P(),g=_("span"),N=J(y),E=P(),O=_("span"),this.h()},l(D){e=v(D,"DIV",{class:!0});var k=I(e);t=v(k,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=V(k),o=v(k,"SPAN",{});var L=I(o);r=Y(L,a),L.forEach(m),i=V(k),c=v(k,"SPAN",{}),I(c).forEach(m),d=V(k),f=v(k,"SPAN",{"data-svelte-h":!0}),ee(f)!=="svelte-104368"&&(f.textContent=p),b=V(k),g=v(k,"SPAN",{});var S=I(g);N=Y(S,y),S.forEach(m),E=V(k),O=v(k,"SPAN",{}),I(O).forEach(m),k.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(D,k){M(D,e,k),u(e,t),u(e,n),u(e,o),u(o,r),u(e,i),u(e,c),u(e,d),u(e,f),u(e,b),u(e,g),u(g,N),u(e,E),u(e,O)},p(D,k){k&1&&a!==(a=D[0].latestGuess.target+"")&&ae(r,a),k&1&&y!==(y=D[0].latestGuess.guessed+"")&&ae(N,y)},d(D){D&&m(e)}}}function pa(s){let e,t,l="Target:",n,o,a=Xe(Lt(s[0].latestGuess.target||0))+"",r,i,c,d,f,p="Guessed:",b,g,y=Xe(Lt(s[0].latestGuess.guessed||0))+"",N,E,O;return{c(){e=_("div"),t=_("span"),t.textContent=l,n=P(),o=_("span"),r=J(a),i=P(),c=_("span"),d=P(),f=_("span"),f.textContent=p,b=P(),g=_("span"),N=J(y),E=P(),O=_("span"),this.h()},l(D){e=v(D,"DIV",{class:!0});var k=I(e);t=v(k,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=V(k),o=v(k,"SPAN",{});var L=I(o);r=Y(L,a),L.forEach(m),i=V(k),c=v(k,"SPAN",{}),I(c).forEach(m),d=V(k),f=v(k,"SPAN",{"data-svelte-h":!0}),ee(f)!=="svelte-104368"&&(f.textContent=p),b=V(k),g=v(k,"SPAN",{});var S=I(g);N=Y(S,y),S.forEach(m),E=V(k),O=v(k,"SPAN",{}),I(O).forEach(m),k.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(D,k){M(D,e,k),u(e,t),u(e,n),u(e,o),u(o,r),u(e,i),u(e,c),u(e,d),u(e,f),u(e,b),u(e,g),u(g,N),u(e,E),u(e,O)},p(D,k){k&1&&a!==(a=Xe(Lt(D[0].latestGuess.target||0))+"")&&ae(r,a),k&1&&y!==(y=Xe(Lt(D[0].latestGuess.guessed||0))+"")&&ae(N,y)},d(D){D&&m(e)}}}function cl(s){let e,t=Xe(s[10])+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var o=I(e);l=Y(o,t),o.forEach(m),this.h()},h(){h(e,"class","mx-1")},m(n,o){M(n,e,o),u(e,l)},p(n,o){o&4&&t!==(t=Xe(n[10])+"")&&ae(l,t)},d(n){n&&m(e)}}}function _a(s){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,l){M(t,e,l)},p:me,d(t){t&&m(e)}}}function va(s){let e,t="Next",l,n,o="Autoplay",a,r;return{c(){e=_("button"),e.textContent=t,l=P(),n=_("button"),n.textContent=o,this.h()},l(i){e=v(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-1nvnoba"&&(e.textContent=t),l=V(i),n=v(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1cfj1sl"&&(n.textContent=o),this.h()},h(){h(e,"class","btn primary"),h(n,"class","btn primary")},m(i,c){M(i,e,c),M(i,l,c),M(i,n,c),a||(r=[$(e,"click",s[4]),$(n,"click",s[5])],a=!0)},p:me,d(i){i&&(m(e),m(l),m(n)),a=!1,ot(r)}}}function ga(s){let e,t="Stop autoplay",l,n;return{c(){e=_("button"),e.textContent=t,this.h()},l(o){e=v(o,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){h(e,"class","btn primary")},m(o,a){M(o,e,a),l||(n=$(e,"click",s[9]),l=!0)},p:me,d(o){o&&m(e),l=!1,n()}}}function ba(s){let e,t="Try Again",l,n,o="Clear",a,r;return{c(){e=_("button"),e.textContent=t,l=P(),n=_("button"),n.textContent=o,this.h()},l(i){e=v(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-y911ux"&&(e.textContent=t),l=V(i),n=v(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-11mnk9v"&&(n.textContent=o),this.h()},h(){h(e,"class","btn primary"),h(n,"class","btn primary")},m(i,c){M(i,e,c),M(i,l,c),M(i,n,c),a||(r=[$(e,"click",s[6]),$(n,"click",s[7])],a=!0)},p:me,d(i){i&&(m(e),m(l),m(n)),a=!1,ot(r)}}}function ya(s){let e,t,l,n;function o(f,p){return f[0]instanceof jt&&(f[1]==="correct"||f[1]==="wrong")?pa:f[0]instanceof Bt&&(f[1]==="correct"||f[1]==="wrong")?ma:f[0]instanceof ft&&(f[1]==="correct"||f[1]==="wrong")?ha:f[0]&&f[1]==="ended"?da:f[2].length>0?fa:ua}let a=o(s),r=a(s);function i(f,p){return f[0]&&f[1]==="ended"?ba:f[0]&&f[3].autoplay?ga:f[0]?va:_a}let c=i(s),d=c(s);return{c(){e=_("div"),r.c(),l=P(),n=_("div"),d.c(),this.h()},l(f){e=v(f,"DIV",{class:!0});var p=I(e);r.l(p),p.forEach(m),l=V(f),n=v(f,"DIV",{class:!0});var b=I(n);d.l(b),b.forEach(m),this.h()},h(){h(e,"class",t=Ce(`${s[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),h(n,"class","mt-2 h-8")},m(f,p){M(f,e,p),r.m(e,null),M(f,l,p),M(f,n,p),d.m(n,null)},p(f,[p]){a===(a=o(f))&&r?r.p(f,p):(r.d(1),r=a(f),r&&(r.c(),r.m(e,null))),p&256&&t!==(t=Ce(`${f[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs")&&h(e,"class",t),c===(c=i(f))&&d?d.p(f,p):(d.d(1),d=c(f),d&&(d.c(),d.m(n,null)))},i:me,o:me,d(f){f&&(m(e),m(l),m(n)),r.d(),d.d()}}}const ul=s=>s.note,fl=s=>s.note;function ka(s,e,t){let l,n,o;de(s,bt,p=>t(1,l=p)),de(s,gt,p=>t(2,n=p)),de(s,dt,p=>t(3,o=p));let{game:a}=e;function r(){Se.nextGuess()}function i(){Se.setOptionValue("autoplay",!0),Se.nextGuess()}function c(){a instanceof ft?Se.play(a.type,a.opts):a&&Se.play(a.type,void 0)}function d(){Se.clearGame()}const f=()=>Se.setOptionValue("autoplay",!1);return s.$$set=p=>{t(8,e=Te(Te({},e),Ae(p))),"game"in p&&t(0,a=p.game)},e=Ae(e),[a,l,n,o,r,i,c,d,e,f]}class Ea extends $e{constructor(e){super(),He(this,e,ka,ya,ze,{game:0})}}function dl(s,e,t){const l=s.slice();return l[15]=e[t].key,l[16]=e[t].value,l[17]=e[t].icon,l[19]=t,l}const wa=s=>({}),hl=s=>({}),Ca=s=>({}),ml=s=>({});function pl(s){let e,t,l,n,o,a,r,i,c,d,f;const p=s[12].header,b=en(p,s,s[11],hl);let g=ne(s[0]),y=[];for(let E=0;E<g.length;E+=1)y[E]=_l(dl(s,g,E));const N=E=>z(y[E],1,1,()=>{y[E]=null});return{c(){e=_("button"),l=P(),n=_("ul"),o=_("li"),b&&b.c(),a=P();for(let E=0;E<y.length;E+=1)y[E].c();this.h()},l(E){e=v(E,"BUTTON",{class:!0,tabindex:!0}),I(e).forEach(m),l=V(E),n=v(E,"UL",{class:!0});var O=I(n);o=v(O,"LI",{});var D=I(o);b&&b.l(D),D.forEach(m),a=V(O);for(let k=0;k<y.length;k+=1)y[k].l(O);O.forEach(m),this.h()},h(){h(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),h(e,"tabindex","-1"),h(n,"class",r=Ce(`items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(E,O){M(E,e,O),M(E,l,O),M(E,n,O),u(n,o),b&&b.m(o,null),u(n,a);for(let D=0;D<y.length;D+=1)y[D]&&y[D].m(n,null);c=!0,d||(f=$(e,"click",s[7]),d=!0)},p(E,O){if(s=E,b&&b.p&&(!c||O&2048)&&tn(b,p,s,s[11],c?ln(p,s[11],O,wa):sn(s[11]),hl),O&265){g=ne(s[0]);let D;for(D=0;D<g.length;D+=1){const k=dl(s,g,D);y[D]?(y[D].p(k,O),F(y[D],1)):(y[D]=_l(k),y[D].c(),F(y[D],1),y[D].m(n,null))}for(et(),D=g.length;D<y.length;D+=1)N(D);tt()}(!c||O&4&&r!==(r=Ce(`items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&h(n,"class",r)},i(E){if(!c){E&&Bs(()=>{c&&(t||(t=Wt(e,Gs,{duration:Yt},!0)),t.run(1))}),F(b,E);for(let O=0;O<g.length;O+=1)F(y[O]);E&&Bs(()=>{c&&(i||(i=Wt(n,Ms,{duration:Yt},!0)),i.run(1))}),c=!0}},o(E){E&&(t||(t=Wt(e,Gs,{duration:Yt},!1)),t.run(0)),z(b,E),y=y.filter(Boolean);for(let O=0;O<y.length;O+=1)z(y[O]);E&&(i||(i=Wt(n,Ms,{duration:Yt},!1)),i.run(0)),c=!1},d(E){E&&(m(e),m(l),m(n)),E&&t&&t.end(),b&&b.d(E),Be(y,E),E&&i&&i.end(),d=!1,f()}}}function Ta(s){let e;return{c(){e=_("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),I(e).forEach(m),this.h()},h(){h(e,"class","w-[24px]")},m(t,l){M(t,e,l)},p:me,i:me,o:me,d(t){t&&m(e)}}}function Aa(s){let e,t;return e=new Ze({props:{class:"mr-2",icon:s[17],width:16}}),{c(){ve(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const o={};n&1&&(o.icon=l[17]),e.$set(o)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){z(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function _l(s){let e,t,l,n,o,a,r=s[16]+"",i,c,d,f,p;const b=[Aa,Ta],g=[];function y(E,O){return E[17]?0:1}l=y(s),n=g[l]=b[l](s);function N(){return s[13](s[15])}return{c(){e=_("li"),t=_("button"),n.c(),o=P(),a=_("div"),i=J(r),c=P(),this.h()},l(E){e=v(E,"LI",{});var O=I(e);t=v(O,"BUTTON",{class:!0});var D=I(t);n.l(D),o=V(D),a=v(D,"DIV",{});var k=I(a);i=Y(k,r),k.forEach(m),D.forEach(m),c=V(O),O.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),H(t,"selected",s[15]===s[3])},m(E,O){M(E,e,O),u(e,t),g[l].m(t,null),u(t,o),u(t,a),u(a,i),u(e,c),d=!0,f||(p=$(t,"click",N),f=!0)},p(E,O){s=E;let D=l;l=y(s),l===D?g[l].p(s,O):(et(),z(g[D],1,1,()=>{g[D]=null}),tt(),n=g[l],n?n.p(s,O):(n=g[l]=b[l](s),n.c()),F(n,1),n.m(t,o)),(!d||O&1)&&r!==(r=s[16]+"")&&ae(i,r),(!d||O&9)&&H(t,"selected",s[15]===s[3])},i(E){d||(F(n),d=!0)},o(E){z(n),d=!1},d(E){E&&m(e),g[l].d(),f=!1,p()}}}function Ia(s){let e,t,l,n,o,a,r,i,c;const d=s[12].value,f=en(d,s,s[11],ml);let p=s[6]&&pl(s);return{c(){e=_("div"),t=_("button"),f&&f.c(),o=P(),p&&p.c(),this.h()},l(b){e=v(b,"DIV",{class:!0,id:!0});var g=I(e);t=v(g,"BUTTON",{class:!0,title:!0});var y=I(t);f&&f.l(y),y.forEach(m),o=V(g),p&&p.l(g),g.forEach(m),this.h()},h(){h(t,"class",l=Ce(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),h(t,"title",n=s[9].title||""),H(t,"disabled",s[4]),H(t,"open",s[6]),h(e,"class",a=Ce(`relative ${s[2]||""}`)+" svelte-h65upg"),h(e,"id",s[1])},m(b,g){M(b,e,g),u(e,t),f&&f.m(t,null),u(e,o),p&&p.m(e,null),s[14](e),r=!0,i||(c=$(t,"click",s[7]),i=!0)},p(b,[g]){f&&f.p&&(!r||g&2048)&&tn(f,d,b,b[11],r?ln(d,b[11],g,Ca):sn(b[11]),ml),(!r||g&512&&l!==(l=Ce(`${b[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&h(t,"class",l),(!r||g&512&&n!==(n=b[9].title||""))&&h(t,"title",n),(!r||g&528)&&H(t,"disabled",b[4]),(!r||g&576)&&H(t,"open",b[6]),b[6]?p?(p.p(b,g),g&64&&F(p,1)):(p=pl(b),p.c(),F(p,1),p.m(e,null)):p&&(et(),z(p,1,1,()=>{p=null}),tt()),(!r||g&4&&a!==(a=Ce(`relative ${b[2]||""}`)+" svelte-h65upg"))&&h(e,"class",a),(!r||g&2)&&h(e,"id",b[1])},i(b){r||(F(f,b),F(p),r=!0)},o(b){z(f,b),z(p),r=!1},d(b){b&&m(e),f&&f.d(b),p&&p.d(),s[14](null),i=!1,c()}}}const Yt=400;function Sa(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:o,id:a=void 0,containerClass:r=void 0,selected:i=void 0,disabled:c=void 0,onSelect:d}=e,f,p=!1;function b(){c||t(6,p=!p)}function g(E){t(6,p=d(E))}const y=E=>g(E);function N(E){nn[E?"unshift":"push"](()=>{f=E,t(5,f)})}return s.$$set=E=>{t(9,e=Te(Te({},e),Ae(E))),"options"in E&&t(0,o=E.options),"id"in E&&t(1,a=E.id),"containerClass"in E&&t(2,r=E.containerClass),"selected"in E&&t(3,i=E.selected),"disabled"in E&&t(4,c=E.disabled),"onSelect"in E&&t(10,d=E.onSelect),"$$scope"in E&&t(11,n=E.$$scope)},e=Ae(e),[o,a,r,i,c,f,p,b,g,e,d,n,l,y,N]}class hn extends $e{constructor(e){super(),He(this,e,Sa,Ia,ze,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function Na(s){let e,t,l,n,o,a,r;return{c(){e=_("label"),t=_("input"),l=P(),n=_("div"),this.h()},l(i){e=v(i,"LABEL",{class:!0});var c=I(e);t=v(c,"INPUT",{type:!0,class:!0}),l=V(c),n=v(c,"DIV",{class:!0}),I(n).forEach(m),c.forEach(m),this.h()},h(){t.checked=s[0],h(t,"type","checkbox"),h(t,"class","svelte-3nm794"),h(n,"class","slider svelte-3nm794"),h(e,"class",o=Ce(`${s[3].class||""} toggle`)+" svelte-3nm794")},m(i,c){M(i,e,c),u(e,t),s[5](t),u(e,l),u(e,n),a||(r=[$(t,"change",s[4]),$(t,"keydown",s[2])],a=!0)},p(i,[c]){c&1&&(t.checked=i[0]),c&8&&o!==(o=Ce(`${i[3].class||""} toggle`)+" svelte-3nm794")&&h(e,"class",o)},i:me,o:me,d(i){i&&m(e),s[5](null),a=!1,ot(r)}}}function La(s,e,t){let{checked:l}=e,n;function o(i){i.key==="Enter"&&n.click()}function a(i){as.call(this,s,i)}function r(i){nn[i?"unshift":"push"](()=>{n=i,t(1,n)})}return s.$$set=i=>{t(3,e=Te(Te({},e),Ae(i))),"checked"in i&&t(0,l=i.checked)},e=Ae(e),[l,n,o,e,a,r]}class Da extends $e{constructor(e){super(),He(this,e,La,Na,ze,{checked:0})}}function vl(s){let e;return{c(){e=_("li"),this.h()},l(t){e=v(t,"LI",{class:!0}),I(e).forEach(m),this.h()},h(){h(e,"class","m-[0.175rem] mr-0")},m(t,l){M(t,e,l)},d(t){t&&m(e)}}}function gl(s){let e;return{c(){e=_("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),I(e).forEach(m),this.h()},h(){h(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,l){M(t,e,l)},d(t){t&&m(e)}}}function bl(s){let e,t=s[0].note.note+"",l,n;return{c(){e=_("div"),l=J(t),n=J(s[2]),this.h()},l(o){e=v(o,"DIV",{class:!0});var a=I(e);l=Y(a,t),n=Y(a,s[2]),a.forEach(m),this.h()},h(){h(e,"class","absolute top-0 left-0")},m(o,a){M(o,e,a),u(e,l),u(e,n)},p(o,a){a&1&&t!==(t=o[0].note.note+"")&&ae(l,t),a&4&&ae(n,o[2])},d(o){o&&m(e)}}}function ja(s){let e,t,l,n,o,a,r=kl(s[0].key)+"",i,c,d,f,p=s[0].key==="{enter}"&&vl(),b=s[0].key==="{enter}"&&gl(),g=s[0].note&&bl(s);return{c(){p&&p.c(),e=P(),t=_("li"),l=_("button"),b&&b.c(),n=P(),g&&g.c(),o=P(),a=_("div"),i=J(r),this.h()},l(y){p&&p.l(y),e=V(y),t=v(y,"LI",{class:!0});var N=I(t);l=v(N,"BUTTON",{class:!0});var E=I(l);b&&b.l(E),n=V(E),g&&g.l(E),o=V(E),a=v(E,"DIV",{});var O=I(a);i=Y(O,r),O.forEach(m),E.forEach(m),N.forEach(m),this.h()},h(){h(l,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),H(l,"items-center",!s[0].note),H(l,"items-end",s[0].note),h(t,"class",c=Ce(`${s[3].class||""} m-[0.175rem] ${yl(s[0].size)}`)+" svelte-1479mcy"),H(t,"enter",s[0].key==="{enter}"),H(t,"captured",s[1])},m(y,N){p&&p.m(y,N),M(y,e,N),M(y,t,N),u(t,l),b&&b.m(l,null),u(l,n),g&&g.m(l,null),u(l,o),u(l,a),u(a,i),d||(f=$(l,"click",s[5]),d=!0)},p(y,[N]){y[0].key==="{enter}"?p||(p=vl(),p.c(),p.m(e.parentNode,e)):p&&(p.d(1),p=null),y[0].key==="{enter}"?b||(b=gl(),b.c(),b.m(l,n)):b&&(b.d(1),b=null),y[0].note?g?g.p(y,N):(g=bl(y),g.c(),g.m(l,o)):g&&(g.d(1),g=null),N&1&&r!==(r=kl(y[0].key)+"")&&ae(i,r),N&1&&H(l,"items-center",!y[0].note),N&1&&H(l,"items-end",y[0].note),N&9&&c!==(c=Ce(`${y[3].class||""} m-[0.175rem] ${yl(y[0].size)}`)+" svelte-1479mcy")&&h(t,"class",c),N&9&&H(t,"enter",y[0].key==="{enter}"),N&11&&H(t,"captured",y[1])},i:me,o:me,d(y){y&&(m(e),m(t)),p&&p.d(y),b&&b.d(),g&&g.d(),d=!1,f()}}}function yl(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function kl(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function Pa(s,e,t){let l,n;de(s,os,i=>t(4,n=i));let{value:o,captured:a}=e;function r(i){as.call(this,s,i)}return s.$$set=i=>{t(3,e=Te(Te({},e),Ae(i))),"value"in i&&t(0,o=i.value),"captured"in i&&t(1,a=i.captured)},s.$$.update=()=>{s.$$.dirty&17&&t(2,l=As(o.note?o.note.semitones+n[0]:0))},e=Ae(e),[o,a,l,e,n,r]}class Va extends $e{constructor(e){super(),He(this,e,Pa,ja,ze,{value:0,captured:1})}}const Es={ar:{name:"Arabic",import:fe(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:fe(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:fe(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:fe(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:fe(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:fe(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:fe(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:fe(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:fe(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>Oa)},fa:{name:"Farsi",import:fe(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:fe(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:fe(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:fe(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:fe(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:fe(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:fe(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:fe(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:fe(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:fe(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:fe(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:fe(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:fe(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:fe(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:fe(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:fe(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:fe(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:fe(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:fe(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:fe(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:fe(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:fe(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:fe(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:fe(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function mn(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default,shift:s.layout.shift}}async function pn(s=["en"]){let e={code:"en",layout:Es.en,index:99};Object.entries(Es).forEach(([l,n])=>{for(let o=0;o<s.length;o+=1)l===s[o]&&(!e||e.index>o)&&(e={code:l,layout:n,index:o})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:mn(t.default)}}const _n={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Oa=Object.freeze(Object.defineProperty({__proto__:null,default:_n},Symbol.toStringTag,{value:"Module"}));function Nt(s,e,t,l=0){const n=t?[0,2,4,5,7,9,11]:[-1,1,3,-1,6,8,10];let o=-1,a=0;return s.forEach((r,i)=>{const c=r.key.charAt(0)==="{";!c&&o===-1&&(o=i);const d=n[(i-o+l)%n.length];if(o!==-1&&i!==0&&!c&&d>=0){const f=e[d],p=Math.floor((l+i-o)/n.length);r.note={...f,semitones:f.semitones+(p>0?p:0)*12},r.note,a=i-o}}),a}const Qt=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function Ba(s){let e=[];const t=s.default.map((l,n)=>{if(n===0){const o=l.split(" ").filter(a=>a!=="{bksp}");for(;o.length!==13;)o.length<13?o.unshift("{empty}"):o.shift();return[...o,"{bksp}"]}else if(n===1){const o=l.split(" ");return e=o.slice(13),[...o.slice(0,13),"{enter}"]}else{if(n===2)return[...l.split(" ").slice(0,13).filter(o=>o!=="{enter}"),...e].slice(0,13);if(n===3){const o=["{shift}",...l.split(" ").slice(1,12).filter(r=>r!=="{shift}"),"{shift}"];let a=1;for(;o.length<13;)o.splice(a,0,"{empty}"),a=a===1?-1:1;return o}else return l.split(" ")}});return[t[0].map((l,n)=>({key:l,code:Qt[0][n]})),t[1].map((l,n)=>({key:l,code:Qt[1][n]})),t[2].map((l,n)=>({key:l,code:Qt[2][n]})),t[3].map((l,n)=>({key:l,code:Qt[3][n]}))]}class ns{constructor(e){return this.rows=[[],[],[],[]],this.opts={hotkeydRows:"middle-row",layout:{code:"en",name:"English",imported:mn(_n)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=Ba(e),this}setRows(e){return this.rows=e,this}setRowHotkeys(e,t){}setNotes(e){if(this.opts.hotkeydRows==="middle-row")Nt(this.rows[1],e,!1),Nt(this.rows[2],e,!0);else{Nt(this.rows[2],e,!1);const t=Nt(this.rows[3],e,!0);Nt(this.rows[0],e,!1,t),Nt(this.rows[1],e,!0,t+1)}}static createWithRows(e,t){return new ns(e).setRows(t)}}const Ns=/^[a-gA-G]$/,vn=/^[♭Bb#♯sS]$/,Ga=/^[0-9]$/;let W="",ut;function Ma(s,e){const{useHotkeys:t}=Ee(at),l=Ee(rs).get(s);if(t&&W.length===0&&l&&l.note)return W="",{e:"guessed-key",data:l.note.note};if(!t&&W.length===0&&Ns.test(e))return W+=e.toUpperCase(),{e:"string",data:W};if(!t&&W.length>0&&vn.test(e))return e==="b"||e==="B"?W+="♭":W+="♯",{e:"string",data:W};if(s==="Backspace"&&W.length>0)return W=W.slice(0,-1),{e:"string",data:W};if(s==="Enter"&&W.length>0){const n=W;return W="",{e:"guessed-key",data:n}}return!1}function Ra(s,e){if(s==="Enter"&&W.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let l=0;l<W.length;l+=1)l===0?t.note+=W[l]:t.chord.length>0?t.chord+=W[l].toLowerCase():W[l]==="♭"?(t.note+=W[l],t.flats+=1):W[l]==="♯"?(t.note+=W[l],t.sharps+=1):t.chord+=W[l].toLowerCase();return W="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&W.length>0)return W=W.slice(0,-1),{e:"string",data:W};if(W.length===0&&Ns.test(e))return W+=e.toUpperCase(),{e:"string",data:W};if(W.length>0&&e.length===1)return W.length===1&&(e==="b"||e==="B")?W+="♭":W.length===1&&e==="#"?W+="♯":W+=e,{e:"string",data:W}}return!1}function Ua(s,e,t){const{useAutoOctave:l,useHotkeys:n}=Ee(at);let o;const r=Ee(rs).get(s),i=(r==null?void 0:r.key)||"";let c=!1;if(!ut&&n&&(r!=null&&r.note)?(ut=r.note,l&&(o=As(Ee(ls)[0].midi)),c="note"):!n&&W.length===0&&Ns.test(e)?(W+=e.toUpperCase(),c="input"):!n&&W.length>0&&vn.test(e)&&(e==="b"||e==="B"?W+="♭":W+="♯",c="input"),!c&&Ga.test(i))try{o=parseInt(i)}catch{}if(ut&&o!==void 0){const d=ut.semitones+(o+1+(t?1:0))*12;return ut=void 0,{e:"guessed-note",data:d}}else if(W&&o!==void 0){const d=Dt.findNote(W),f=d?d.semitones+(o+1)*12:void 0;return ut=void 0,W="",f!==void 0?{e:"guessed-note",data:f}:{e:"string",data:W}}else if(s==="Backspace"&&(ut||W.length>0))return ut=void 0,W=W.slice(0,-1),{e:"string",data:W};return c==="note"?{e:"note",data:ut}:c==="input"?{e:"string",data:W}:!1}const xa={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},_s=[],Et=Ue(void 0);Ct(Et,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const yt=ht(Ue({useCustom:!1,customLayout:[[],[],[],[]],kbdOpts:{layout:xa,hotkeydRows:"middle-row"}}),{key:"keyboard-settings"}),Ls=Ct([Pt,yt],([s,e])=>{let t;return e.useCustom&&e.customLayout?t=ns.createWithRows(e.kbdOpts,e.customLayout):t=new ns(e.kbdOpts),t.setNotes(Array.from(s.notesMap.values())),t}),Ka=Ct(Ls,s=>s.rows.map(e=>e.map((t,l)=>{let n;return t.key==="{bksp}"?n=2:t.key==="{tab}"?n=1.5:t.key==="{enter}"?n=2:t.key==="{lock}"?n=1.75:t.key==="{shift}"&&l===0?n=1.5:t.key==="{shift}"&&(n=2.5),n?{...t,size:n}:t}))),rs=Ct(Ls,s=>new Map([...s.rows[0].map(e=>[e.code,e]),...s.rows[1].map(e=>[e.code,e]),...s.rows[2].map(e=>[e.code,e]),...s.rows[3].map(e=>[e.code,e])])),Fa=Ct(rs,s=>Array.from(s.values()).map(e=>e.note).filter(e=>e!==void 0)),Dt={async setLayout(s){const e=await pn([s]);yt.update(t=>({...t,layout:e}))},setCustomLayout(s){if(s){const e=Ee(Ls);yt.update(t=>({...t,useCustom:s,customLayout:t.customLayout.map((l,n)=>l.length===0?e.rows[n].map(o=>({...o})):l)}))}else yt.update(e=>({...e,useCustom:s}))},toggleRows(s){yt.update(e=>({...e,kbdOpts:{...e.kbdOpts,hotkeydRows:s??(e.kbdOpts.hotkeydRows==="middle-row"?"two-rows":"middle-row")}}))},captureHotkeyRow(s){let e=-1,t=0;const l=Ee(yt).customLayout[s].map((n,o)=>(n.key.charAt(0)!=="{"&&e===-1&&(e=o),t+=n.key.charAt(0)!=="{"?1:0,n));console.log("count",t),Et.set({row:l,nextIndex:e,rowIndex:s,count:t})},findNote(s){return Ee(Fa).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((l,n)=>l+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleInput(s,e,t=!1){const l=Ee(kt),n=Ee(Et);if(n){console.log("capturing ",_s.length);const{nextIndex:o,row:a}=n;return s==="Escape"?Et.set(void 0):_s.find(i=>i.code===s)||(_s.push({code:s,key:e}),a[o]={...a[o],code:s,key:e},o===n.count?(yt.update(i=>({...i,customLayout:i.customLayout.map((c,d)=>d!==n.rowIndex?c:a)})),Et.set(void 0)):Et.set({...n,nextIndex:o+1,row:a})),!1}else{if(l instanceof Bt)return Ma(s,e.toUpperCase());if(l instanceof ft&&l.type==="chords-write")return Ra(s,e);if(Ee(at).useKeyboard)return Ua(s,e.toUpperCase(),t)}return!1}};function El(s,e,t){const l=s.slice();return l[13]=e[t],l[15]=t,l}function wl(s,e,t){const l=s.slice();return l[16]=e[t],l[18]=t,l}function $a(s){let e,t=s[0].kbdOpts.layout.name+"",l;return{c(){e=_("div"),l=J(t),this.h()},l(n){e=v(n,"DIV",{slot:!0});var o=I(e);l=Y(o,t),o.forEach(m),this.h()},h(){h(e,"slot","value")},m(n,o){M(n,e,o),u(e,l)},p(n,o){o&1&&t!==(t=n[0].kbdOpts.layout.name+"")&&ae(l,t)},d(n){n&&m(e)}}}function Cl(s){let e,t,l,n,o;t=new Ze({props:{icon:In,width:20}});function a(){return s[11](s[15])}return{c(){e=_("button"),ve(t.$$.fragment),this.h()},l(r){e=v(r,"BUTTON",{class:!0});var i=I(e);ge(t.$$.fragment,i),i.forEach(m),this.h()},h(){h(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(r,i){M(r,e,i),be(t,e,null),l=!0,n||(o=$(e,"click",a),n=!0)},p(r,i){s=r},i(r){l||(F(t.$$.fragment,r),l=!0)},o(r){z(t.$$.fragment,r),l=!1},d(r){r&&m(e),ye(t),n=!1,o()}}}function Tl(s){let e,t;return e=new Va({props:{value:s[16],captured:s[4]&&s[4].rowIndex===s[15]&&s[4].nextIndex===s[18]||!1}}),{c(){ve(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const o={};n&2&&(o.value=l[16]),n&16&&(o.captured=l[4]&&l[4].rowIndex===l[15]&&l[4].nextIndex===l[18]||!1),e.$set(o)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){z(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function Al(s){let e,t,l,n,o=s[3][s[15]]&&Cl(s),a=ne(s[13]),r=[];for(let c=0;c<a.length;c+=1)r[c]=Tl(wl(s,a,c));const i=c=>z(r[c],1,1,()=>{r[c]=null});return{c(){e=_("li"),o&&o.c(),t=P();for(let c=0;c<r.length;c+=1)r[c].c();l=Ge(),this.h()},l(c){e=v(c,"LI",{class:!0});var d=I(e);o&&o.l(d),d.forEach(m),t=V(c);for(let f=0;f<r.length;f+=1)r[f].l(c);l=Ge(),this.h()},h(){h(e,"class","col-span-2 svelte-12ix7fc")},m(c,d){M(c,e,d),o&&o.m(e,null),M(c,t,d);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(c,d);M(c,l,d),n=!0},p(c,d){if(c[3][c[15]]?o?(o.p(c,d),d&8&&F(o,1)):(o=Cl(c),o.c(),F(o,1),o.m(e,null)):o&&(et(),z(o,1,1,()=>{o=null}),tt()),d&18){a=ne(c[13]);let f;for(f=0;f<a.length;f+=1){const p=wl(c,a,f);r[f]?(r[f].p(p,d),F(r[f],1)):(r[f]=Tl(p),r[f].c(),F(r[f],1),r[f].m(l.parentNode,l))}for(et(),f=a.length;f<r.length;f+=1)i(f);tt()}},i(c){if(!n){F(o);for(let d=0;d<a.length;d+=1)F(r[d]);n=!0}},o(c){z(o),r=r.filter(Boolean);for(let d=0;d<r.length;d+=1)z(r[d]);n=!1},d(c){c&&(m(e),m(t),m(l)),o&&o.d(),Be(r,c)}}}function Ha(s){let e,t,l,n,o,a,r,i,c="Layout",d,f,p,b,g,y="Custom",N,E,O,D,k,L,S="One row",j,G,w,B,A="Two rows",C,T,R,x,K,ce,ue;n=new Ze({props:{icon:Cs,width:16}}),f=new hn({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1",options:s[5],onSelect:s[6],$$slots:{value:[$a]},$$scope:{ctx:s}}}),G=new Da({props:{checked:!s[2]}}),G.$on("change",s[9]);let se=ne(s[1]),Q=[];for(let X=0;X<se.length;X+=1)Q[X]=Al(El(s,se,X));const ke=X=>z(Q[X],1,1,()=>{Q[X]=null});return{c(){e=_("div"),t=_("div"),l=_("button"),ve(n.$$.fragment),o=P(),a=_("div"),r=_("div"),i=_("label"),i.textContent=c,d=P(),ve(f.$$.fragment),p=P(),b=_("div"),g=_("label"),g.textContent=y,N=P(),E=_("input"),D=P(),k=_("div"),L=_("label"),L.textContent=S,j=P(),ve(G.$$.fragment),w=P(),B=_("label"),B.textContent=A,C=P(),T=_("div"),R=_("ul");for(let X=0;X<Q.length;X+=1)Q[X].c();this.h()},l(X){e=v(X,"DIV",{class:!0});var oe=I(e);t=v(oe,"DIV",{class:!0});var Ie=I(t);l=v(Ie,"BUTTON",{class:!0});var he=I(l);ge(n.$$.fragment,he),he.forEach(m),Ie.forEach(m),o=V(oe),a=v(oe,"DIV",{class:!0});var ie=I(a);r=v(ie,"DIV",{class:!0});var Ve=I(r);i=v(Ve,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(i)!=="svelte-1xsr9lq"&&(i.textContent=c),d=V(Ve),ge(f.$$.fragment,Ve),Ve.forEach(m),p=V(ie),b=v(ie,"DIV",{class:!0});var Ne=I(b);g=v(Ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(g)!=="svelte-11aw8ub"&&(g.textContent=y),N=V(Ne),E=v(Ne,"INPUT",{class:!0,id:!0,type:!0}),Ne.forEach(m),D=V(ie),k=v(ie,"DIV",{class:!0});var le=I(k);L=v(le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(L)!=="svelte-17p0yvw"&&(L.textContent=S),j=V(le),ge(G.$$.fragment,le),w=V(le),B=v(le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(B)!=="svelte-1wr3nwv"&&(B.textContent=A),le.forEach(m),ie.forEach(m),C=V(oe),T=v(oe,"DIV",{class:!0});var De=I(T);R=v(De,"UL",{class:!0});var pe=I(R);for(let q=0;q<Q.length;q+=1)Q[q].l(pe);pe.forEach(m),De.forEach(m),oe.forEach(m),this.h()},h(){h(l,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),h(t,"class","absolute top-[0] right-[0] flex"),h(i,"class","font-bold mr-4"),h(i,"for","middle-row"),h(r,"class","my-1 flex items-center justify-between mr-2"),h(g,"class","font-bold mr-4"),h(g,"for","custom-layout"),h(E,"class","h-[20px]"),h(E,"id","custom-layout"),h(E,"type","checkbox"),E.checked=O=s[0].useCustom,h(b,"class","my-1 flex items-center justify-between mr-12"),h(L,"class","font-bold mr-4"),h(L,"for","two-rows"),h(B,"class","font-bold ml-4"),h(B,"for","two-rows"),h(k,"class","my-1 flex items-center justify-between mr-12"),h(a,"class","flex"),h(R,"class","keyboard svelte-12ix7fc"),h(T,"class","flex flex-col gap-1.5"),h(e,"class",x=Ce(`${s[10].class||""} relative`)+" svelte-12ix7fc")},m(X,oe){M(X,e,oe),u(e,t),u(t,l),be(n,l,null),u(e,o),u(e,a),u(a,r),u(r,i),u(r,d),be(f,r,null),u(a,p),u(a,b),u(b,g),u(b,N),u(b,E),u(a,D),u(a,k),u(k,L),u(k,j),be(G,k,null),u(k,w),u(k,B),u(e,C),u(e,T),u(T,R);for(let Ie=0;Ie<Q.length;Ie+=1)Q[Ie]&&Q[Ie].m(R,null);K=!0,ce||(ue=[$(l,"click",za),$(E,"change",s[7])],ce=!0)},p(X,[oe]){const Ie={};oe&524289&&(Ie.$$scope={dirty:oe,ctx:X}),f.$set(Ie),(!K||oe&1&&O!==(O=X[0].useCustom))&&(E.checked=O);const he={};if(oe&4&&(he.checked=!X[2]),G.$set(he),oe&282){se=ne(X[1]);let ie;for(ie=0;ie<se.length;ie+=1){const Ve=El(X,se,ie);Q[ie]?(Q[ie].p(Ve,oe),F(Q[ie],1)):(Q[ie]=Al(Ve),Q[ie].c(),F(Q[ie],1),Q[ie].m(R,null))}for(et(),ie=se.length;ie<Q.length;ie+=1)ke(ie);tt()}(!K||oe&1024&&x!==(x=Ce(`${X[10].class||""} relative`)+" svelte-12ix7fc"))&&h(e,"class",x)},i(X){if(!K){F(n.$$.fragment,X),F(f.$$.fragment,X),F(G.$$.fragment,X);for(let oe=0;oe<se.length;oe+=1)F(Q[oe]);K=!0}},o(X){z(n.$$.fragment,X),z(f.$$.fragment,X),z(G.$$.fragment,X),Q=Q.filter(Boolean);for(let oe=0;oe<Q.length;oe+=1)z(Q[oe]);K=!1},d(X){X&&m(e),ye(n),ye(f),ye(G),Be(Q,X),ce=!1,ot(ue)}}}function za(){}function qa(s,e,t){let l,n,o,a,r,i;de(s,yt,y=>t(0,o=y)),de(s,Ka,y=>t(1,a=y)),de(s,rs,y=>t(12,r=y)),de(s,Et,y=>t(4,i=y)),an(async()=>{console.log(r);const y=await pn(["sw"]);console.log(y),window.layout=y});const c=Object.entries(Es).map(([y,N])=>({key:y,value:N.name}));function d(y){return Dt.setLayout(y),!1}function f(y){Dt.setCustomLayout(y.currentTarget.checked)}function p(y){Dt.captureHotkeyRow(y)}function b(){Dt.toggleRows()}const g=y=>p(y);return s.$$set=y=>{t(10,e=Te(Te({},e),Ae(y)))},s.$$.update=()=>{s.$$.dirty&3&&t(3,l=a.map((y,N)=>o.kbdOpts.hotkeydRows==="middle-row"?N===1||N===2:!0)),s.$$.dirty&1&&t(2,n=o.kbdOpts.hotkeydRows==="middle-row")},e=Ae(e),[o,a,n,l,i,c,d,f,p,b,e,g]}class Wa extends $e{constructor(e){super(),He(this,e,qa,Ha,ze,{})}}function Il(s){let e,t;return e=new Wa({props:{class:"mt-4"}}),{c(){ve(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){z(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function Ja(s){let e,t,l,n,o="I/O",a,r,i,c,d="Device",f,p,b,g,y,N,E="Prompt",O,D,k="Disable",L,S,j,G,w="Sound",B,A,C,T,R,x,K="Fixed velocity",ce,ue,se,Q,ke,X,oe="Keyboard",Ie,he,ie,Ve,Ne,le,De="Hotkeys",pe,q,re,U,Z,_e,te="Auto-octave",Le,Me,rt,Je,xe,Oe,je,Vt="Set hotkeys",Tt,Ke,mt,Ds="Fade timeout",is,it,cs,pt,Gt,us,_t,js="Reset all",fs,Mt,Ye,ds,Ps,Re=s[2]&&Il();return{c(){e=_("div"),t=_("fieldset"),l=_("legend"),n=_("button"),n.textContent=o,a=P(),r=_("div"),i=_("div"),c=_("label"),c.textContent=d,f=P(),p=_("input"),g=P(),y=_("div"),N=_("button"),N.textContent=E,O=P(),D=_("button"),D.textContent=k,L=P(),S=_("div"),j=_("div"),G=_("label"),G.textContent=w,B=P(),A=_("input"),T=P(),R=_("div"),x=_("label"),x.textContent=K,ce=P(),ue=_("input"),se=P(),Q=_("div"),ke=_("div"),X=_("label"),X.textContent=oe,Ie=P(),he=_("input"),Ve=P(),Ne=_("div"),le=_("label"),le.textContent=De,pe=P(),q=_("input"),U=P(),Z=_("div"),_e=_("label"),_e.textContent=te,Le=P(),Me=_("input"),Je=P(),xe=_("div"),Oe=_("div"),je=_("button"),je.textContent=Vt,Tt=P(),Ke=_("div"),mt=_("label"),mt.textContent=Ds,is=P(),it=_("input"),cs=P(),pt=_("div"),Gt=_("div"),us=P(),_t=_("button"),_t.textContent=js,fs=P(),Re&&Re.c(),this.h()},l(Pe){e=v(Pe,"DIV",{class:!0});var Fe=I(e);t=v(Fe,"FIELDSET",{class:!0});var ct=I(t);l=v(ct,"LEGEND",{class:!0});var Vs=I(l);n=v(Vs,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1jbbsti"&&(n.textContent=o),Vs.forEach(m),a=V(ct),r=v(ct,"DIV",{class:!0});var vt=I(r);i=v(vt,"DIV",{class:!0});var At=I(i);c=v(At,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(c)!=="svelte-crpa7y"&&(c.textContent=d),f=V(At),p=v(At,"INPUT",{class:!0,id:!0}),g=V(At),y=v(At,"DIV",{class:!0});var Rt=I(y);N=v(Rt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(N)!=="svelte-mj6mct"&&(N.textContent=E),O=V(Rt),D=v(Rt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(D)!=="svelte-1sl6oxh"&&(D.textContent=k),Rt.forEach(m),At.forEach(m),L=V(vt),S=v(vt,"DIV",{class:!0});var Ut=I(S);j=v(Ut,"DIV",{class:!0});var xt=I(j);G=v(xt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(G)!=="svelte-wgxtkw"&&(G.textContent=w),B=V(xt),A=v(xt,"INPUT",{class:!0,id:!0,type:!0}),xt.forEach(m),T=V(Ut),R=v(Ut,"DIV",{class:!0});var Kt=I(R);x=v(Kt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(x)!=="svelte-1tm2bth"&&(x.textContent=K),ce=V(Kt),ue=v(Kt,"INPUT",{class:!0,id:!0,placeholder:!0}),Kt.forEach(m),Ut.forEach(m),se=V(vt),Q=v(vt,"DIV",{class:!0});var It=I(Q);ke=v(It,"DIV",{class:!0});var Ft=I(ke);X=v(Ft,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(X)!=="svelte-1js269u"&&(X.textContent=oe),Ie=V(Ft),he=v(Ft,"INPUT",{class:!0,id:!0,type:!0}),Ft.forEach(m),Ve=V(It),Ne=v(It,"DIV",{class:!0});var $t=I(Ne);le=v($t,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(le)!=="svelte-21h39k"&&(le.textContent=De),pe=V($t),q=v($t,"INPUT",{class:!0,id:!0,type:!0}),$t.forEach(m),U=V(It),Z=v(It,"DIV",{class:!0});var Ht=I(Z);_e=v(Ht,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(_e)!=="svelte-33lczu"&&(_e.textContent=te),Le=V(Ht),Me=v(Ht,"INPUT",{class:!0,id:!0,type:!0}),Ht.forEach(m),It.forEach(m),Je=V(vt),xe=v(vt,"DIV",{class:!0});var St=I(xe);Oe=v(St,"DIV",{class:!0});var Os=I(Oe);je=v(Os,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(je)!=="svelte-1v9okg9"&&(je.textContent=Vt),Os.forEach(m),Tt=V(St),Ke=v(St,"DIV",{class:!0});var zt=I(Ke);mt=v(zt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(mt)!=="svelte-vd5i27"&&(mt.textContent=Ds),is=V(zt),it=v(zt,"INPUT",{class:!0,id:!0}),zt.forEach(m),cs=V(St),pt=v(St,"DIV",{class:!0});var qt=I(pt);Gt=v(qt,"DIV",{}),I(Gt).forEach(m),us=V(qt),_t=v(qt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(_t)!=="svelte-jjt0c3"&&(_t.textContent=js),qt.forEach(m),St.forEach(m),vt.forEach(m),fs=V(ct),Re&&Re.l(ct),ct.forEach(m),Fe.forEach(m),this.h()},h(){var Pe;h(n,"class","px-1 rounded hover:bg-gray-100"),h(l,"class","text-base"),h(c,"class","font-bold"),h(c,"for","device"),h(p,"class","px-1 my-1 rounded w-50"),h(p,"id","device"),p.disabled=!0,p.value=b=((Pe=s[5])==null?void 0:Pe.name)??"No device",h(N,"class","btn-sm primary mr-2"),h(D,"class","btn-sm primary"),h(y,"class","flex my-[auto]"),h(i,"class","h-full flex flex-col"),h(G,"class","font-bold"),h(G,"for","sound"),h(A,"class","h-[20px]"),h(A,"id","sound"),h(A,"type","checkbox"),A.checked=C=s[3].useSound,h(j,"class","my-1 flex justify-between mr-12"),h(x,"class","font-bold"),h(x,"for","fixed-velocity"),h(ue,"class","h-[20px] w-16"),h(ue,"id","fixed-velocity"),h(ue,"placeholder","0-127"),h(R,"class","flex justify-between"),h(S,"class","flex flex-col h-full"),h(X,"class","font-bold"),h(X,"for","keyboard"),h(he,"class","h-[20px]"),h(he,"id","keyboard"),h(he,"type","checkbox"),he.checked=ie=s[3].useKeyboard,h(ke,"class","my-1 flex justify-between mr-12"),h(le,"class","font-bold"),h(le,"for","hotkeys"),h(q,"class","h-[20px]"),h(q,"id","hotkeys"),h(q,"type","checkbox"),q.checked=re=s[3].useHotkeys,h(Ne,"class","my-1 flex justify-between mr-12"),h(_e,"class","font-bold"),h(_e,"for","auto-octave"),h(Me,"class","h-[20px]"),h(Me,"id","auto-octave"),h(Me,"type","checkbox"),Me.checked=rt=s[3].useAutoOctave,h(Z,"class","my-1 flex justify-between mr-12"),h(Q,"class","flex flex-col h-full"),h(je,"class","w-full btn-sm primary"),h(Oe,"class","flex justify-between"),h(mt,"class","font-bold"),h(mt,"for","fade-timeout"),h(it,"class","h-[20px] w-16"),h(it,"id","fade-timeout"),it.value=s[1],h(Ke,"class","flex justify-between"),h(_t,"class","btn-sm primary"),h(pt,"class","flex justify-between"),h(xe,"class","flex flex-col justify-between h-full"),h(r,"class","body svelte-1bpw69s"),H(r,"hidden",s[4]),h(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),H(t,"collapsed",s[4]),h(e,"class",Mt=Ce(`${s[11].class||""}`)+" svelte-1bpw69s")},m(Pe,Fe){M(Pe,e,Fe),u(e,t),u(t,l),u(l,n),u(t,a),u(t,r),u(r,i),u(i,c),u(i,f),u(i,p),u(i,g),u(i,y),u(y,N),u(y,O),u(y,D),u(r,L),u(r,S),u(S,j),u(j,G),u(j,B),u(j,A),u(S,T),u(S,R),u(R,x),u(R,ce),u(R,ue),Qe(ue,s[0]),u(r,se),u(r,Q),u(Q,ke),u(ke,X),u(ke,Ie),u(ke,he),u(Q,Ve),u(Q,Ne),u(Ne,le),u(Ne,pe),u(Ne,q),u(Q,U),u(Q,Z),u(Z,_e),u(Z,Le),u(Z,Me),u(r,Je),u(r,xe),u(xe,Oe),u(Oe,je),u(xe,Tt),u(xe,Ke),u(Ke,mt),u(Ke,is),u(Ke,it),u(xe,cs),u(xe,pt),u(pt,Gt),u(pt,us),u(pt,_t),u(t,fs),Re&&Re.m(t,null),Ye=!0,ds||(Ps=[$(n,"click",s[7]),$(N,"click",We.openMidi),$(D,"click",We.disableMidi),$(A,"change",s[12]),$(ue,"input",s[13]),$(ue,"change",s[8]),$(he,"change",s[14]),$(q,"change",s[15]),$(Me,"change",s[16]),$(je,"click",s[17]),$(it,"input",s[9]),$(_t,"click",s[10])],ds=!0)},p(Pe,[Fe]){var ct;(!Ye||Fe&32&&b!==(b=((ct=Pe[5])==null?void 0:ct.name)??"No device")&&p.value!==b)&&(p.value=b),(!Ye||Fe&8&&C!==(C=Pe[3].useSound))&&(A.checked=C),Fe&1&&ue.value!==Pe[0]&&Qe(ue,Pe[0]),(!Ye||Fe&8&&ie!==(ie=Pe[3].useKeyboard))&&(he.checked=ie),(!Ye||Fe&8&&re!==(re=Pe[3].useHotkeys))&&(q.checked=re),(!Ye||Fe&8&&rt!==(rt=Pe[3].useAutoOctave))&&(Me.checked=rt),(!Ye||Fe&2&&it.value!==Pe[1])&&(it.value=Pe[1]),(!Ye||Fe&16)&&H(r,"hidden",Pe[4]),Pe[2]?Re?Fe&4&&F(Re,1):(Re=Il(),Re.c(),F(Re,1),Re.m(t,null)):Re&&(et(),z(Re,1,1,()=>{Re=null}),tt()),(!Ye||Fe&16)&&H(t,"collapsed",Pe[4]),(!Ye||Fe&2048&&Mt!==(Mt=Ce(`${Pe[11].class||""}`)+" svelte-1bpw69s"))&&h(e,"class",Mt)},i(Pe){Ye||(F(Re),Ye=!0)},o(Pe){z(Re),Ye=!1},d(Pe){Pe&&m(e),Re&&Re.d(),ds=!1,ot(Ps)}}}function Ya(s,e,t){let l,n,o;de(s,at,k=>t(3,l=k)),de(s,ss,k=>t(5,o=k));const a=ht(Ue(!1),{key:"inputs-hidden"});de(s,a,k=>t(4,n=k));let r=l.fixedVelocity??"",i=l.keyFadeTimeout,c=!1;at.subscribe(k=>{t(0,r=k.fixedVelocity??""),t(1,i=k.keyFadeTimeout)});function d(){a.update(k=>!k)}function f(k){const{value:L}=k.currentTarget;let S;if(L)try{S=parseInt(L)}catch{}S!==void 0&&S>=0&&S<=127?We.setInputValue("fixedVelocity",S):L?t(0,r=l.fixedVelocity||""):We.setInputValue("fixedVelocity",void 0)}function p(k){try{const L=parseInt(k.currentTarget.value);We.setInputValue("keyFadeTimeout",L)}catch{t(1,i=l.keyFadeTimeout)}}function b(){Hn()}const g=k=>We.setInputValue("useSound",k.currentTarget.checked);function y(){r=this.value,t(0,r)}const N=k=>We.setInputValue("useKeyboard",k.currentTarget.checked),E=k=>We.setInputValue("useHotkeys",k.currentTarget.checked),O=k=>We.setInputValue("useAutoOctave",k.currentTarget.checked),D=()=>t(2,c=!c);return s.$$set=k=>{t(11,e=Te(Te({},e),Ae(k)))},e=Ae(e),[r,i,c,l,n,o,a,d,f,p,b,e,g,y,N,E,O,D]}class Qa extends $e{constructor(e){super(),He(this,e,Ya,Ja,ze,{})}}function Xa(s){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,l){M(t,e,l)},p:me,d(t){t&&m(e)}}}function Za(s){let e,t=s[1].note+"",l;return{c(){e=J("Input: "),l=J(t)},l(n){e=Y(n,"Input: "),l=Y(n,t)},m(n,o){M(n,e,o),M(n,l,o)},p(n,o){o&2&&t!==(t=n[1].note+"")&&ae(l,t)},d(n){n&&(m(e),m(l))}}}function eo(s){let e,t;return{c(){e=J("Input: "),t=J(s[0])},l(l){e=Y(l,"Input: "),t=Y(l,s[0])},m(l,n){M(l,e,n),M(l,t,n)},p(l,n){n&1&&ae(t,l[0])},d(l){l&&(m(e),m(t))}}}function to(s){let e;return{c(){e=J(ws)},l(t){e=Y(t,ws)},m(t,l){M(t,e,l)},p:me,d(t){t&&m(e)}}}function so(s){let e,t,l,n;function o(i,c){return i[2].useKeyboard&&ws?to:i[2].useKeyboard&&i[0]?eo:i[2].useKeyboard&&i[1]?Za:Xa}let a=o(s),r=a(s);return{c(){e=_("div"),r.c(),this.h()},l(i){e=v(i,"DIV",{class:!0});var c=I(e);r.l(c),c.forEach(m),this.h()},h(){h(e,"class",t=`${s[4].class||""}`)},m(i,c){M(i,e,c),r.m(e,null),l||(n=$(window,"keydown",s[3]),l=!0)},p(i,[c]){a===(a=o(i))&&r?r.p(i,c):(r.d(1),r=a(i),r&&(r.c(),r.m(e,null))),c&16&&t!==(t=`${i[4].class||""}`)&&h(e,"class",t)},i:me,o:me,d(i){i&&m(e),r.d(),l=!1,n()}}}let ws="";function lo(s,e,t){let l;de(s,at,c=>t(2,l=c));let{debounced:n}=e,o="",a;const r=kn();function i(c){const d=c.target;if(n||!(d instanceof HTMLElement)||d.tagName==="INPUT")return;const f=Dt.handleInput(c.code,c.key,c.shiftKey);f&&f.e==="note"?t(1,a=f.data):f&&f.e==="string"?t(0,o=f.data):f&&(t(0,o=""),t(1,a=void 0),r(f.e,f.data))}return s.$$set=c=>{t(4,e=Te(Te({},e),Ae(c))),"debounced"in c&&t(5,n=c.debounced)},e=Ae(e),[o,a,l,i,e,n]}class no extends $e{constructor(e){super(),He(this,e,lo,so,ze,{debounced:5})}}function ao(s){let e,t,l,n="Count",o,a,r,i,c,d="Duplicates",f,p,b,g,y,N,E="Autoplay",O,D,k,L,S,j,G="Wait seconds",w,B,A,C,T;return{c(){e=_("ul"),t=_("li"),l=_("label"),l.textContent=n,o=P(),a=_("input"),r=P(),i=_("li"),c=_("label"),c.textContent=d,f=P(),p=_("input"),g=P(),y=_("li"),N=_("label"),N.textContent=E,O=P(),D=_("input"),L=P(),S=_("li"),j=_("label"),j.textContent=G,w=P(),B=_("input"),this.h()},l(R){e=v(R,"UL",{class:!0});var x=I(e);t=v(x,"LI",{class:!0});var K=I(t);l=v(K,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(l)!=="svelte-wgq9fc"&&(l.textContent=n),o=V(K),a=v(K,"INPUT",{class:!0,id:!0,type:!0}),K.forEach(m),r=V(x),i=v(x,"LI",{class:!0});var ce=I(i);c=v(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(c)!=="svelte-hcg9dq"&&(c.textContent=d),f=V(ce),p=v(ce,"INPUT",{class:!0,id:!0,type:!0}),ce.forEach(m),g=V(x),y=v(x,"LI",{class:!0});var ue=I(y);N=v(ue,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(N)!=="svelte-lr68n2"&&(N.textContent=E),O=V(ue),D=v(ue,"INPUT",{class:!0,id:!0,type:!0}),ue.forEach(m),L=V(x),S=v(x,"LI",{class:!0});var se=I(S);j=v(se,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(j)!=="svelte-1qj2vcy"&&(j.textContent=G),w=V(se),B=v(se,"INPUT",{class:!0,id:!0,type:!0}),se.forEach(m),x.forEach(m),this.h()},h(){h(l,"class","font-bold"),h(l,"for","guess-count"),h(a,"class","h-[20px] w-10"),h(a,"id","guess-count"),h(a,"type","number"),h(t,"class","flex items-center justify-between svelte-1elvih2"),h(c,"class","font-bold"),h(c,"for","duplicates"),h(p,"class","h-[20px]"),h(p,"id","duplicates"),h(p,"type","checkbox"),p.checked=b=s[2].duplicates,h(i,"class","flex items-center justify-between mr-6 svelte-1elvih2"),h(N,"class","font-bold"),h(N,"for","autoplay"),h(D,"class","h-[20px]"),h(D,"id","autoplay"),h(D,"type","checkbox"),D.checked=k=s[2].autoplay,h(y,"class","flex items-center justify-between mr-6 svelte-1elvih2"),h(j,"class","font-bold"),h(j,"for","wait-ms"),h(B,"class","h-[20px] w-10"),h(B,"id","wait-ms"),h(B,"type","number"),h(S,"class","flex items-center justify-between svelte-1elvih2"),h(e,"class",A=Ce(`${s[5].class||""}`)+" svelte-1elvih2")},m(R,x){M(R,e,x),u(e,t),u(t,l),u(t,o),u(t,a),Qe(a,s[0]),u(e,r),u(e,i),u(i,c),u(i,f),u(i,p),u(e,g),u(e,y),u(y,N),u(y,O),u(y,D),u(e,L),u(e,S),u(S,j),u(S,w),u(S,B),Qe(B,s[1]),C||(T=[$(a,"input",s[6]),$(a,"input",s[3]),$(p,"input",s[7]),$(D,"input",s[8]),$(B,"input",s[9]),$(B,"input",s[4])],C=!0)},p(R,[x]){x&1&&Xt(a.value)!==R[0]&&Qe(a,R[0]),x&4&&b!==(b=R[2].duplicates)&&(p.checked=b),x&4&&k!==(k=R[2].autoplay)&&(D.checked=k),x&2&&Xt(B.value)!==R[1]&&Qe(B,R[1]),x&32&&A!==(A=Ce(`${R[5].class||""}`)+" svelte-1elvih2")&&h(e,"class",A)},i:me,o:me,d(R){R&&m(e),C=!1,ot(T)}}}function oo(s,e,t){let l;de(s,dt,p=>t(2,l=p));let n=l.count||"",o=l.waitSeconds||"";dt.subscribe(p=>{t(0,n=p.count||""),t(1,o=p.waitSeconds||"")});function a({currentTarget:{value:p}}){let b;try{b=parseInt(p),b<=0&&(b=1),Se.setOptionValue("count",b)}catch{t(0,n=l.count)}}function r({currentTarget:{value:p}}){let b;try{b=parseInt(p),b<0&&(b=0),Se.setOptionValue("waitSeconds",b)}catch{t(1,o=l.waitSeconds)}}function i(){n=Xt(this.value),t(0,n)}const c=p=>Se.setOptionValue("duplicates",p.currentTarget.checked),d=p=>Se.setOptionValue("autoplay",p.currentTarget.checked);function f(){o=Xt(this.value),t(1,o)}return s.$$set=p=>{t(5,e=Te(Te({},e),Ae(p)))},e=Ae(e),[n,o,l,a,r,e,i,c,d,f]}class ro extends $e{constructor(e){super(),He(this,e,oo,ao,ze,{})}}function Sl(s,e,t){const l=s.slice();return l[20]=e[t].key,l[21]=e[t].value,l}function Nl(s,e,t){const l=s.slice();return l[20]=e[t].key,l[21]=e[t].value,l}function Ll(s){let e,t,l=s[21]+"",n,o,a,r,i,c,d,f;function p(){return s[13](s[20])}r=new Ze({props:{icon:vs,width:20}});function b(...g){return s[14](s[20],...g)}return{c(){e=_("li"),t=_("button"),n=J(l),o=P(),a=_("button"),ve(r.$$.fragment),i=P(),this.h()},l(g){e=v(g,"LI",{class:!0});var y=I(e);t=v(y,"BUTTON",{class:!0});var N=I(t);n=Y(N,l),N.forEach(m),o=V(y),a=v(y,"BUTTON",{class:!0});var E=I(a);ge(r.$$.fragment,E),E.forEach(m),i=V(y),y.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),H(t,"selected",s[20]===s[0]),h(a,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),h(e,"class","flex svelte-1okhpct")},m(g,y){M(g,e,y),u(e,t),u(t,n),u(e,o),u(e,a),be(r,a,null),u(e,i),c=!0,d||(f=[$(t,"click",p),$(a,"click",b)],d=!0)},p(g,y){s=g,(!c||y&17)&&H(t,"selected",s[20]===s[0])},i(g){c||(F(r.$$.fragment,g),c=!0)},o(g){z(r.$$.fragment,g),c=!1},d(g){g&&m(e),ye(r),d=!1,ot(f)}}}function Dl(s){let e,t=ne(s[2]),l=[];for(let n=0;n<t.length;n+=1)l[n]=jl(Sl(s,t,n));return{c(){e=_("ul");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=v(n,"UL",{class:!0});var o=I(e);for(let a=0;a<l.length;a+=1)l[a].l(o);o.forEach(m),this.h()},h(){h(e,"class","svelte-1okhpct")},m(n,o){M(n,e,o);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(n,o){if(o&518){t=ne(n[2]);let a;for(a=0;a<t.length;a+=1){const r=Sl(n,t,a);l[a]?l[a].p(r,o):(l[a]=jl(r),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function jl(s){let e,t,l=s[21]+"",n,o,a,r;function i(){return s[15](s[20])}return{c(){e=_("li"),t=_("button"),n=J(l),o=P(),this.h()},l(c){e=v(c,"LI",{class:!0});var d=I(e);t=v(d,"BUTTON",{class:!0});var f=I(t);n=Y(f,l),f.forEach(m),o=V(d),d.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),H(t,"selected",s[20]===s[1]),h(e,"class","svelte-1okhpct")},m(c,d){M(c,e,d),u(e,t),u(t,n),u(e,o),a||(r=$(t,"click",i),a=!0)},p(c,d){s=c,d&4&&l!==(l=s[21]+"")&&ae(n,l),d&6&&H(t,"selected",s[20]===s[1])},d(c){c&&m(e),a=!1,r()}}}function io(s){let e,t,l="Play",n,o,a,r,i,c,d,f,p,b,g="Reset",y,N,E,O,D=s[3]?"Quit":"Play",k,L,S,j,G,w=ne(s[4]),B=[];for(let T=0;T<w.length;T+=1)B[T]=Ll(Nl(s,w,T));const A=T=>z(B[T],1,1,()=>{B[T]=null});let C=(s[0]==="chords-write"||s[0]==="chords-play")&&Dl(s);return d=new ro({props:{class:"game-options"}}),E=new Ze({props:{class:"mr-1",icon:s[3]?xs:vs,width:20}}),{c(){e=_("fieldset"),t=_("legend"),t.textContent=l,n=P(),o=_("div"),a=_("ul");for(let T=0;T<B.length;T+=1)B[T].c();r=P(),i=_("div"),C&&C.c(),c=P(),ve(d.$$.fragment),f=P(),p=_("div"),b=_("button"),b.textContent=g,y=P(),N=_("button"),ve(E.$$.fragment),O=P(),k=J(D),this.h()},l(T){e=v(T,"FIELDSET",{class:!0});var R=I(e);t=v(R,"LEGEND",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-1409tnk"&&(t.textContent=l),n=V(R),o=v(R,"DIV",{class:!0});var x=I(o);a=v(x,"UL",{class:!0});var K=I(a);for(let Q=0;Q<B.length;Q+=1)B[Q].l(K);K.forEach(m),r=V(x),i=v(x,"DIV",{class:!0});var ce=I(i);C&&C.l(ce),ce.forEach(m),c=V(x),ge(d.$$.fragment,x),f=V(x),p=v(x,"DIV",{class:!0});var ue=I(p);b=v(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(b)!=="svelte-10rv0bu"&&(b.textContent=g),y=V(ue),N=v(ue,"BUTTON",{class:!0});var se=I(N);ge(E.$$.fragment,se),O=V(se),k=Y(se,D),se.forEach(m),ue.forEach(m),x.forEach(m),R.forEach(m),this.h()},h(){h(t,"class","px-1 text-base"),h(a,"class","games svelte-1okhpct"),h(i,"class","options svelte-1okhpct"),h(b,"class","w-full btn hover:bg-gray-200"),h(N,"class","w-full mt-2 flex items-center justify-center btn primary"),h(p,"class","h-full flex flex-col justify-end"),h(o,"class","body pb-2 h-full svelte-1okhpct"),h(e,"class",L=Ce(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(T,R){M(T,e,R),u(e,t),u(e,n),u(e,o),u(o,a);for(let x=0;x<B.length;x+=1)B[x]&&B[x].m(a,null);u(o,r),u(o,i),C&&C.m(i,null),u(o,c),be(d,o,null),u(o,f),u(o,p),u(p,b),u(p,y),u(p,N),be(E,N,null),u(N,O),u(N,k),S=!0,j||(G=[$(b,"click",s[5]),$(N,"click",s[16])],j=!0)},p(T,[R]){if(R&401){w=ne(T[4]);let K;for(K=0;K<w.length;K+=1){const ce=Nl(T,w,K);B[K]?(B[K].p(ce,R),F(B[K],1)):(B[K]=Ll(ce),B[K].c(),F(B[K],1),B[K].m(a,null))}for(et(),K=w.length;K<B.length;K+=1)A(K);tt()}T[0]==="chords-write"||T[0]==="chords-play"?C?C.p(T,R):(C=Dl(T),C.c(),C.m(i,null)):C&&(C.d(1),C=null);const x={};R&8&&(x.icon=T[3]?xs:vs),E.$set(x),(!S||R&8)&&D!==(D=T[3]?"Quit":"Play")&&ae(k,D),(!S||R&1024&&L!==(L=Ce(`${T[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&h(e,"class",L)},i(T){if(!S){for(let R=0;R<w.length;R+=1)F(B[R]);F(d.$$.fragment,T),F(E.$$.fragment,T),S=!0}},o(T){B=B.filter(Boolean);for(let R=0;R<B.length;R+=1)z(B[R]);z(d.$$.fragment,T),z(E.$$.fragment,T),S=!1},d(T){T&&m(e),Be(B,T),C&&C.d(),ye(d),ye(E),j=!1,ot(G)}}}function co(s,e,t){let l,n,o,a,r;de(s,Ss,k=>t(12,o=k)),de(s,dt,k=>t(19,a=k)),de(s,kt,k=>t(3,r=k));const i=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let c=i[4].key,d="maj-m";a.count,a.waitSeconds,dt.subscribe(k=>{k.count,k.waitSeconds});function f(){Se.clearGame(!0)}function p(k,L){if(L==="chords-write"||L==="chords-play"||L==="chords-diatonic"){let S=[];d==="selected"?S=o.filter(j=>j.selected):d==="all"?S=o:d==="maj-m"?S=o.filter(j=>j.suffixes[0]==="maj"||j.suffixes[0]==="m"):d==="seventh"&&(S=o.filter(j=>j.suffixes[0]==="maj7"||j.suffixes[0]==="m7"||j.suffixes[0]==="7"||j.suffixes[0]==="dim7"||j.suffixes[0]==="aug7")),Se.play(L,{chords:S})}else Se.play(L,void 0);k.currentTarget instanceof HTMLElement&&k.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function b(k){t(0,c=k)}function g(k,L){t(0,c=L),p(k,L)}function y(k){t(1,d=k)}const N=k=>b(k),E=(k,L)=>g(L,k),O=k=>y(k),D=k=>p(k,c);return s.$$set=k=>{t(10,e=Te(Te({},e),Ae(k)))},s.$$.update=()=>{s.$$.dirty&4096&&t(11,l=o.reduce((k,L)=>L.selected?k+1:k,0)),s.$$.dirty&2048&&t(2,n=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${l} chords`},{key:"all",value:"All"}])},e=Ae(e),[c,d,n,r,i,f,p,b,g,y,e,l,o,N,E,O,D]}class uo extends $e{constructor(e){super(),He(this,e,co,io,ze,{})}}function Pl(s,e,t){const l=s.slice();return l[7]=e[t],l}function Vl(s,e,t){const l=s.slice();return l[4]=e[t],l}function fo(s){let e,t=ne(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Ol(Pl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let o=0;o<l.length;o+=1)l[o].l(n);e=Ge()},m(n,o){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,o);M(n,e,o)},p(n,o){if(o&2){t=ne(n[1]);let a;for(a=0;a<t.length;a+=1){const r=Pl(n,t,a);l[a]?l[a].p(r,o):(l[a]=Ol(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function ho(s){let e,t=ne(s[0].scaleNotes||[]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Bl(Vl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let o=0;o<l.length;o+=1)l[o].l(n);e=Ge()},m(n,o){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,o);M(n,e,o)},p(n,o){if(o&1){t=ne(n[0].scaleNotes||[]);let a;for(a=0;a<t.length;a+=1){const r=Vl(n,t,a);l[a]?l[a].p(r,o):(l[a]=Bl(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Ol(s){let e,t=s[7].interval+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var o=I(e);l=Y(o,t),o.forEach(m),this.h()},h(){h(e,"class","svelte-my4m0t")},m(n,o){M(n,e,o),u(e,l)},p(n,o){o&2&&t!==(t=n[7].interval+"")&&ae(l,t)},d(n){n&&m(e)}}}function Bl(s){let e,t=s[4].note+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var o=I(e);l=Y(o,t),o.forEach(m),this.h()},h(){h(e,"class","svelte-my4m0t")},m(n,o){M(n,e,o),u(e,l)},p(n,o){o&1&&t!==(t=n[4].note+"")&&ae(l,t)},d(n){n&&m(e)}}}function mo(s){let e,t,l,n,o,a;function r(d,f){return d[0]?ho:fo}let i=r(s),c=i(s);return{c(){e=_("div"),t=_("button"),c.c(),this.h()},l(d){e=v(d,"DIV",{class:!0,title:!0});var f=I(e);t=v(f,"BUTTON",{class:!0});var p=I(t);c.l(p),p.forEach(m),f.forEach(m),this.h()},h(){h(t,"class","intervals svelte-my4m0t"),h(e,"class",l=`${s[2].class||""} `),h(e,"title",n=s[1].map(Gl).join("-"))},m(d,f){M(d,e,f),u(e,t),c.m(t,null),o||(a=$(t,"click",s[3]),o=!0)},p(d,[f]){i===(i=r(d))&&c?c.p(d,f):(c.d(1),c=i(d),c&&(c.c(),c.m(t,null))),f&4&&l!==(l=`${d[2].class||""} `)&&h(e,"class",l),f&2&&n!==(n=d[1].map(Gl).join("-"))&&h(e,"title",n)},i:me,o:me,d(d){d&&m(e),c.d(),o=!1,a()}}}const Gl=s=>s.interval;function po(s,e,t){let{scale:l,intervals:n}=e;function o(a){as.call(this,s,a)}return s.$$set=a=>{t(2,e=Te(Te({},e),Ae(a))),"scale"in a&&t(0,l=a.scale),"intervals"in a&&t(1,n=a.intervals)},e=Ae(e),[l,n,e,o]}class gn extends $e{constructor(e){super(),He(this,e,po,mo,ze,{scale:0,intervals:1})}}function Ml(s,e,t){const l=s.slice();return l[7]=e[t],l}function Rl(s,e,t){const l=s.slice();return l[4]=e[t],l}function _o(s){let e,t=ne(s[0]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Ul(Ml(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let o=0;o<l.length;o+=1)l[o].l(n);e=Ge()},m(n,o){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,o);M(n,e,o)},p(n,o){if(o&1){t=ne(n[0]);let a;for(a=0;a<t.length;a+=1){const r=Ml(n,t,a);l[a]?l[a].p(r,o):(l[a]=Ul(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function vo(s){let e,t=ne(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=xl(Rl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let o=0;o<l.length;o+=1)l[o].l(n);e=Ge()},m(n,o){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,o);M(n,e,o)},p(n,o){if(o&2){t=ne(n[1]);let a;for(a=0;a<t.length;a+=1){const r=Rl(n,t,a);l[a]?l[a].p(r,o):(l[a]=xl(r),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Ul(s){let e,t,l=s[7].roman+"",n,o,a,r=s[7].suffix+"",i,c;return{c(){e=_("span"),t=_("span"),n=J(l),o=P(),a=_("sup"),i=J(r),c=P(),this.h()},l(d){e=v(d,"SPAN",{class:!0});var f=I(e);t=v(f,"SPAN",{class:!0});var p=I(t);n=Y(p,l),p.forEach(m),o=V(f),a=v(f,"SUP",{class:!0});var b=I(a);i=Y(b,r),b.forEach(m),c=V(f),f.forEach(m),this.h()},h(){h(t,"class","block"),h(a,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),H(a,"super-text",s[7].suffix.length>2),h(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(d,f){M(d,e,f),u(e,t),u(t,n),u(e,o),u(e,a),u(a,i),u(e,c)},p(d,f){f&1&&l!==(l=d[7].roman+"")&&ae(n,l),f&1&&r!==(r=d[7].suffix+"")&&ae(i,r),f&1&&H(a,"super-text",d[7].suffix.length>2)},d(d){d&&m(e)}}}function xl(s){let e,t,l=s[4]+"",n,o;return{c(){e=_("span"),t=_("span"),n=J(l),o=P(),this.h()},l(a){e=v(a,"SPAN",{class:!0});var r=I(e);t=v(r,"SPAN",{});var i=I(t);n=Y(i,l),i.forEach(m),o=V(r),r.forEach(m),this.h()},h(){h(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(a,r){M(a,e,r),u(e,t),u(t,n),u(e,o)},p(a,r){r&2&&l!==(l=a[4]+"")&&ae(n,l)},d(a){a&&m(e)}}}function go(s){let e,t,l,n,o,a;function r(d,f){return d[1].length>0?vo:_o}let i=r(s),c=i(s);return{c(){e=_("div"),t=_("button"),c.c(),this.h()},l(d){e=v(d,"DIV",{class:!0,title:!0});var f=I(e);t=v(f,"BUTTON",{class:!0});var p=I(t);c.l(p),p.forEach(m),f.forEach(m),this.h()},h(){h(t,"class","triads flex flex-wrap svelte-1roj1mi"),h(e,"class",l=Ce(`${s[2].class||""} `)+" svelte-1roj1mi"),h(e,"title",n=s[0].map(Kl).join("-"))},m(d,f){M(d,e,f),u(e,t),c.m(t,null),o||(a=$(t,"click",s[3]),o=!0)},p(d,[f]){i===(i=r(d))&&c?c.p(d,f):(c.d(1),c=i(d),c&&(c.c(),c.m(t,null))),f&4&&l!==(l=Ce(`${d[2].class||""} `)+" svelte-1roj1mi")&&h(e,"class",l),f&1&&n!==(n=d[0].map(Kl).join("-"))&&h(e,"title",n)},i:me,o:me,d(d){d&&m(e),c.d(),o=!1,a()}}}const Kl=s=>s.roman+s.suffix;function bo(s,e,t){let{triads:l,chords:n}=e;function o(a){as.call(this,s,a)}return s.$$set=a=>{t(2,e=Te(Te({},e),Ae(a))),"triads"in a&&t(0,l=a.triads),"chords"in a&&t(1,n=a.chords)},e=Ae(e),[l,n,e,o]}class bn extends $e{constructor(e){super(),He(this,e,bo,go,ze,{triads:0,chords:1})}}function Fl(s,e,t){const l=s.slice();return l[23]=e[t],l}function $l(s,e,t){const l=s.slice();return l[23]=e[t],l}function Hl(s){let e,t,l=s[23].raw.names[0]+"",n,o,a,r,i,c,d;function f(){return s[11](s[23])}a=new gn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),a.$on("click",f);function p(){return s[12](s[23])}return i=new bn({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",p),{c(){e=_("li"),t=_("div"),n=J(l),o=P(),ve(a.$$.fragment),r=P(),ve(i.$$.fragment),c=P(),this.h()},l(b){e=v(b,"LI",{class:!0});var g=I(e);t=v(g,"DIV",{class:!0});var y=I(t);n=Y(y,l),y.forEach(m),o=V(g),ge(a.$$.fragment,g),r=V(g),ge(i.$$.fragment,g),c=V(g),g.forEach(m),this.h()},h(){h(t,"class","text-xs font-bold"),h(e,"class","svelte-4hctsl")},m(b,g){M(b,e,g),u(e,t),u(t,n),u(e,o),be(a,e,null),u(e,r),be(i,e,null),u(e,c),d=!0},p(b,g){s=b,(!d||g&4)&&l!==(l=s[23].raw.names[0]+"")&&ae(n,l);const y={};g&4&&(y.scale=s[23].scale),g&4&&(y.intervals=s[23].raw.intervals),a.$set(y);const N={};g&4&&(N.triads=s[23].triads),g&4&&(N.chords=s[23].triadChords),i.$set(N)},i(b){d||(F(a.$$.fragment,b),F(i.$$.fragment,b),d=!0)},o(b){z(a.$$.fragment,b),z(i.$$.fragment,b),d=!1},d(b){b&&m(e),ye(a),ye(i)}}}function zl(s){let e,t,l=s[23].raw.names[0]+"",n,o,a,r,i,c,d;function f(){return s[13](s[23])}a=new gn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),a.$on("click",f);function p(){return s[14](s[23])}return i=new bn({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",p),{c(){e=_("li"),t=_("div"),n=J(l),o=P(),ve(a.$$.fragment),r=P(),ve(i.$$.fragment),c=P(),this.h()},l(b){e=v(b,"LI",{class:!0});var g=I(e);t=v(g,"DIV",{class:!0});var y=I(t);n=Y(y,l),y.forEach(m),o=V(g),ge(a.$$.fragment,g),r=V(g),ge(i.$$.fragment,g),c=V(g),g.forEach(m),this.h()},h(){h(t,"class","text-xs font-bold"),h(e,"class","svelte-4hctsl")},m(b,g){M(b,e,g),u(e,t),u(t,n),u(e,o),be(a,e,null),u(e,r),be(i,e,null),u(e,c),d=!0},p(b,g){s=b,(!d||g&2)&&l!==(l=s[23].raw.names[0]+"")&&ae(n,l);const y={};g&2&&(y.scale=s[23].scale),g&2&&(y.intervals=s[23].raw.intervals),a.$set(y);const N={};g&2&&(N.triads=s[23].triads),g&2&&(N.chords=s[23].triadChords),i.$set(N)},i(b){d||(F(a.$$.fragment,b),F(i.$$.fragment,b),d=!0)},o(b){z(a.$$.fragment,b),z(i.$$.fragment,b),d=!1},d(b){b&&m(e),ye(a),ye(i)}}}function yo(s){let e,t,l,n,o="Scales",a,r,i,c,d="Key",f,p,b,g,y,N,E,O,D,k,L=ne(s[2]),S=[];for(let A=0;A<L.length;A+=1)S[A]=Hl($l(s,L,A));const j=A=>z(S[A],1,1,()=>{S[A]=null});let G=ne(s[1]),w=[];for(let A=0;A<G.length;A+=1)w[A]=zl(Fl(s,G,A));const B=A=>z(w[A],1,1,()=>{w[A]=null});return{c(){e=_("div"),t=_("fieldset"),l=_("legend"),n=_("button"),n.textContent=o,a=P(),r=_("div"),i=_("div"),c=_("label"),c.textContent=d,f=P(),p=_("input"),b=P(),g=_("ul");for(let A=0;A<S.length;A+=1)S[A].c();y=P(),N=_("ul");for(let A=0;A<w.length;A+=1)w[A].c();this.h()},l(A){e=v(A,"DIV",{class:!0});var C=I(e);t=v(C,"FIELDSET",{class:!0});var T=I(t);l=v(T,"LEGEND",{class:!0});var R=I(l);n=v(R,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-lhx60e"&&(n.textContent=o),R.forEach(m),a=V(T),r=v(T,"DIV",{class:!0});var x=I(r);i=v(x,"DIV",{class:!0});var K=I(i);c=v(K,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(c)!=="svelte-14m38zf"&&(c.textContent=d),f=V(K),p=v(K,"INPUT",{class:!0,id:!0}),K.forEach(m),b=V(x),g=v(x,"UL",{class:!0});var ce=I(g);for(let se=0;se<S.length;se+=1)S[se].l(ce);ce.forEach(m),y=V(x),N=v(x,"UL",{class:!0});var ue=I(N);for(let se=0;se<w.length;se+=1)w[se].l(ue);ue.forEach(m),x.forEach(m),T.forEach(m),C.forEach(m),this.h()},h(){h(n,"class","px-1 rounded hover:bg-gray-100"),h(l,"class","text-base"),h(c,"class","mr-4 font-bold"),h(c,"for","scale-key"),h(p,"class","bg-gray-100 w-16 px-1 rounded"),h(p,"id","scale-key"),p.value=s[0],h(i,"class","flex w-1/2 mb-2 input svelte-4hctsl"),h(g,"class","list odd w-full svelte-4hctsl"),h(N,"class","list even w-full svelte-4hctsl"),h(r,"class","body svelte-4hctsl"),H(r,"hidden",s[3]),h(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),H(t,"collapsed",s[3]),h(e,"class",E=Ce(`${s[9].class||""}`)+" svelte-4hctsl")},m(A,C){M(A,e,C),u(e,t),u(t,l),u(l,n),u(t,a),u(t,r),u(r,i),u(i,c),u(i,f),u(i,p),u(r,b),u(r,g);for(let T=0;T<S.length;T+=1)S[T]&&S[T].m(g,null);u(r,y),u(r,N);for(let T=0;T<w.length;T+=1)w[T]&&w[T].m(N,null);O=!0,D||(k=[$(n,"click",s[5]),$(p,"input",s[6])],D=!0)},p(A,[C]){if((!O||C&1&&p.value!==A[0])&&(p.value=A[0]),C&388){L=ne(A[2]);let T;for(T=0;T<L.length;T+=1){const R=$l(A,L,T);S[T]?(S[T].p(R,C),F(S[T],1)):(S[T]=Hl(R),S[T].c(),F(S[T],1),S[T].m(g,null))}for(et(),T=L.length;T<S.length;T+=1)j(T);tt()}if(C&386){G=ne(A[1]);let T;for(T=0;T<G.length;T+=1){const R=Fl(A,G,T);w[T]?(w[T].p(R,C),F(w[T],1)):(w[T]=zl(R),w[T].c(),F(w[T],1),w[T].m(N,null))}for(et(),T=G.length;T<w.length;T+=1)B(T);tt()}(!O||C&8)&&H(r,"hidden",A[3]),(!O||C&8)&&H(t,"collapsed",A[3]),(!O||C&512&&E!==(E=Ce(`${A[9].class||""}`)+" svelte-4hctsl"))&&h(e,"class",E)},i(A){if(!O){for(let C=0;C<L.length;C+=1)F(S[C]);for(let C=0;C<G.length;C+=1)F(w[C]);O=!0}},o(A){S=S.filter(Boolean);for(let C=0;C<S.length;C+=1)z(S[C]);w=w.filter(Boolean);for(let C=0;C<w.length;C+=1)z(w[C]);O=!1},d(A){A&&m(e),Be(S,A),Be(w,A),D=!1,ot(k)}}}function ko(s,e,t){let l,n,o,a,r,i,c;de(s,ls,w=>t(17,o=w)),de(s,Pt,w=>t(18,a=w)),de(s,at,w=>t(19,r=w)),de(s,nt,w=>t(20,i=w));let f=Ts().map(w=>({key:w.names[0],raw:w,scale:void 0,triads:w.triads,triadChords:[]})),p="",b=[a.key,a.scale],g;const y=ht(Ue(!0),{key:"scales-hidden"});de(s,y,w=>t(3,c=w));function N(){y.update(w=>!w)}function E({currentTarget:{value:w}}){t(0,p=`${w.charAt(0).toUpperCase()}${w.charAt(1).toLowerCase()}`),t(10,f=f.map(B=>{const A=ts(p,B.key),C=p&&"data"in A?A.data:void 0;let T=[];return C&&(T=B.triads.map((R,x)=>`${C.scaleNotes[x].note}${!R.suffix.includes("°")&&R.minor?"m":""}${R.suffix}`)),{...B,scale:C,triadChords:T}}))}function O(w,B,A){if(w<B.length){const C=B[w++];we.setPlayed(C),i==null||i.playChord(C.map(T=>T.midi),r.fixedVelocity),g=setTimeout(()=>O(w,B,A),A)}else we.setPlayed([]),we.setKeyAndScale(b[0],b[1])}function D(w){clearTimeout(g);let B,A;w.scale?(A=w.scale,b=[a.key,a.scale],we.setKeyAndScale(w.scale.key,w.scale.scale)):A=a;const C=o[0].midi+A.scaleNotes[0].semitones;B=w.raw.intervals.map(T=>[{...A.notesMap.get(T.semitones%12),midi:C+T.semitones}]),B[0][0].semitones!==B[B.length-1][0].semitones&&B.push(B[0].map(T=>({...T,midi:T.midi+12}))),O(0,B,500)}function k(w){clearTimeout(g);const{intervals:B}=w.raw;let A,C;w.scale?(C=w.scale,b=[a.key,a.scale],we.setKeyAndScale(w.scale.key,w.scale.scale)):C=a;const T=o[0].midi+C.scaleNotes[0].semitones;A=un(w.triads).map((x,K)=>gs(T+C.intervals[K].semitones,C,x.intervals)),B[B.length-1].interval_seq!==1&&A.push(A[0].map(x=>({...x,midi:x.midi+12}))),O(0,A,750)}const L=w=>D(w),S=w=>k(w),j=w=>D(w),G=w=>k(w);return s.$$set=w=>{t(9,e=Te(Te({},e),Ae(w)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,l=f.filter((w,B)=>B<f.length/2)),s.$$.dirty&1024&&t(1,n=f.filter((w,B)=>B>=f.length/2))},e=Ae(e),[p,n,l,c,y,N,E,D,k,e,f,L,S,j,G]}class Eo extends $e{constructor(e){super(),He(this,e,ko,yo,ze,{})}}function ql(s,e,t){const l=s.slice();return l[26]=e[t],l}function Wl(s,e,t){const l=s.slice();return l[29]=e[t],l}function Jl(s){let e,t;return{c(){e=_("div"),t=J(s[3]),this.h()},l(l){e=v(l,"DIV",{class:!0});var n=I(e);t=Y(n,s[3]),n.forEach(m),this.h()},h(){h(e,"class","error svelte-1u7ze7x")},m(l,n){M(l,e,n),u(e,t)},p(l,n){n[0]&8&&ae(t,l[3])},d(l){l&&m(e)}}}function wo(s){let e,t;return{c(){e=_("div"),t=J(s[0]),this.h()},l(l){e=v(l,"DIV",{slot:!0});var n=I(e);t=Y(n,s[0]),n.forEach(m),this.h()},h(){h(e,"slot","value")},m(l,n){M(l,e,n),u(e,t)},p(l,n){n[0]&1&&ae(t,l[0])},d(l){l&&m(e)}}}function Yl(s){let e,t=ne(s[5]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Ql(Wl(s,t,n));return{c(){e=_("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var o=I(e);for(let a=0;a<l.length;a+=1)l[a].l(o);o.forEach(m),this.h()},h(){h(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,o){M(n,e,o);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(n,o){if(o[0]&32){t=ne(n[5]);let a;for(a=0;a<t.length;a+=1){const r=Wl(n,t,a);l[a]?l[a].p(r,o):(l[a]=Ql(r),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Ql(s){let e,t=s[29].interval+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var o=I(e);l=Y(o,t),o.forEach(m),this.h()},h(){h(e,"class","svelte-1u7ze7x")},m(n,o){M(n,e,o),u(e,l)},p(n,o){o[0]&32&&t!==(t=n[29].interval+"")&&ae(l,t)},d(n){n&&m(e)}}}function Xl(s){let e,t=ne(s[8].scaleNotes),l=[];for(let n=0;n<t.length;n+=1)l[n]=Zl(ql(s,t,n));return{c(){e=_("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var o=I(e);for(let a=0;a<l.length;a+=1)l[a].l(o);o.forEach(m),this.h()},h(){h(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,o){M(n,e,o);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(n,o){if(o[0]&256){t=ne(n[8].scaleNotes);let a;for(a=0;a<t.length;a+=1){const r=ql(n,t,a);l[a]?l[a].p(r,o):(l[a]=Zl(r),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Zl(s){let e,t=s[26].note+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var o=I(e);l=Y(o,t),o.forEach(m),this.h()},h(){h(e,"class","svelte-1u7ze7x")},m(n,o){M(n,e,o),u(e,l)},p(n,o){o[0]&256&&t!==(t=n[26].note+"")&&ae(l,t)},d(n){n&&m(e)}}}function Co(s){let e,t,l,n="Score",o,a,r,i,c,d,f,p="Range",b,g,y,N,E,O="—",D,k,L,S,j,G,w,B="Scale",A,C,T,R,x,K,ce,ue="Key",se,Q,ke,X,oe,Ie,he="",ie,Ve,Ne,le;r=new Ze({props:{icon:Cs,width:16}});let De=s[3]&&Jl(s);T=new hn({props:{id:"scales",class:"p-1",options:s[10],onSelect:s[14],$$slots:{value:[wo]},$$scope:{ctx:s}}});let pe=!s[7]&&Yl(s),q=!s[7]&&Xl(s);return{c(){e=_("fieldset"),t=_("legend"),l=_("button"),l.textContent=n,o=P(),a=_("button"),ve(r.$$.fragment),i=P(),c=_("div"),d=_("div"),f=_("label"),f.textContent=p,b=P(),g=_("div"),y=_("input"),N=P(),E=_("span"),E.textContent=O,D=P(),k=_("input"),L=P(),S=_("div"),De&&De.c(),j=P(),G=_("div"),w=_("label"),w.textContent=B,A=P(),C=_("div"),ve(T.$$.fragment),R=P(),pe&&pe.c(),x=P(),K=_("div"),ce=_("label"),ce.textContent=ue,se=P(),Q=_("div"),ke=_("input"),X=P(),q&&q.c(),oe=P(),Ie=_("div"),Ie.innerHTML=he,this.h()},l(re){e=v(re,"FIELDSET",{class:!0});var U=I(e);t=v(U,"LEGEND",{class:!0});var Z=I(t);l=v(Z,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-lqyol"&&(l.textContent=n),Z.forEach(m),o=V(U),a=v(U,"BUTTON",{class:!0});var _e=I(a);ge(r.$$.fragment,_e),_e.forEach(m),i=V(U),c=v(U,"DIV",{class:!0});var te=I(c);d=v(te,"DIV",{class:!0});var Le=I(d);f=v(Le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(f)!=="svelte-10u0679"&&(f.textContent=p),b=V(Le),g=v(Le,"DIV",{class:!0});var Me=I(g);y=v(Me,"INPUT",{class:!0,id:!0}),N=V(Me),E=v(Me,"SPAN",{class:!0,"data-svelte-h":!0}),ee(E)!=="svelte-8q1xz4"&&(E.textContent=O),D=V(Me),k=v(Me,"INPUT",{class:!0,id:!0}),Me.forEach(m),L=V(Le),S=v(Le,"DIV",{class:!0});var rt=I(S);De&&De.l(rt),rt.forEach(m),Le.forEach(m),j=V(te),G=v(te,"DIV",{class:!0});var Je=I(G);w=v(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(w)!=="svelte-ld2d07"&&(w.textContent=B),A=V(Je),C=v(Je,"DIV",{class:!0});var xe=I(C);ge(T.$$.fragment,xe),xe.forEach(m),R=V(Je),pe&&pe.l(Je),Je.forEach(m),x=V(te),K=v(te,"DIV",{class:!0});var Oe=I(K);ce=v(Oe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(ce)!=="svelte-17pcm6g"&&(ce.textContent=ue),se=V(Oe),Q=v(Oe,"DIV",{class:!0});var je=I(Q);ke=v(je,"INPUT",{class:!0,id:!0}),je.forEach(m),X=V(Oe),q&&q.l(Oe),Oe.forEach(m),oe=V(te),Ie=v(te,"DIV",{class:!0,"data-svelte-h":!0}),ee(Ie)!=="svelte-hp3bkp"&&(Ie.innerHTML=he),te.forEach(m),U.forEach(m),this.h()},h(){h(l,"class","px-1 rounded hover:bg-gray-100"),h(t,"class","px-1 text-base"),h(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),H(a,"hidden",s[6]),h(f,"class","font-bold"),h(f,"for","range_min"),h(y,"class","h-[28px] w-full"),h(y,"id","range_min"),h(E,"class","mx-2 mt-1"),h(k,"class","h-[28px] w-full"),h(k,"id","range_max"),h(g,"class","my-1 flex w-full"),h(S,"class","flex justify-between my-1"),h(d,"class","flex flex-col h-full"),h(w,"class","font-bold"),h(w,"for","scales"),h(C,"class","my-1 w-full"),h(G,"class","flex flex-col h-full"),h(ce,"class","font-bold"),h(ce,"for","key"),h(ke,"class","h-[28px]"),h(ke,"id","key"),h(Q,"class","my-1 flex"),h(K,"class","flex flex-col h-full"),h(Ie,"class","h-full flex flex-col justify-between"),h(c,"class","options svelte-1u7ze7x"),H(c,"hidden",s[6]),h(e,"class",ie=Ce(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),H(e,"collapsed",s[6])},m(re,U){M(re,e,U),u(e,t),u(t,l),u(e,o),u(e,a),be(r,a,null),u(e,i),u(e,c),u(c,d),u(d,f),u(d,b),u(d,g),u(g,y),Qe(y,s[1]),u(g,N),u(g,E),u(g,D),u(g,k),Qe(k,s[2]),u(d,L),u(d,S),De&&De.m(S,null),u(c,j),u(c,G),u(G,w),u(G,A),u(G,C),be(T,C,null),u(G,R),pe&&pe.m(G,null),u(c,x),u(c,K),u(K,ce),u(K,se),u(K,Q),u(Q,ke),Qe(ke,s[4]),u(K,X),q&&q.m(K,null),u(c,oe),u(c,Ie),Ve=!0,Ne||(le=[$(l,"click",s[15]),$(a,"click",s[16]),$(y,"input",s[18]),$(y,"change",s[19]),$(y,"focus",s[12]),$(k,"input",s[20]),$(k,"change",s[21]),$(k,"focus",s[12]),$(ke,"input",s[22]),$(ke,"input",s[13])],Ne=!0)},p(re,U){(!Ve||U[0]&64)&&H(a,"hidden",re[6]),U[0]&2&&y.value!==re[1]&&Qe(y,re[1]),U[0]&4&&k.value!==re[2]&&Qe(k,re[2]),re[3]?De?De.p(re,U):(De=Jl(re),De.c(),De.m(S,null)):De&&(De.d(1),De=null);const Z={};U[0]&1|U[1]&2&&(Z.$$scope={dirty:U,ctx:re}),T.$set(Z),re[7]?pe&&(pe.d(1),pe=null):pe?pe.p(re,U):(pe=Yl(re),pe.c(),pe.m(G,null)),U[0]&16&&ke.value!==re[4]&&Qe(ke,re[4]),re[7]?q&&(q.d(1),q=null):q?q.p(re,U):(q=Xl(re),q.c(),q.m(K,null)),(!Ve||U[0]&64)&&H(c,"hidden",re[6]),(!Ve||U[0]&131072&&ie!==(ie=Ce(`${re[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&h(e,"class",ie),(!Ve||U[0]&131136)&&H(e,"collapsed",re[6])},i(re){Ve||(F(r.$$.fragment,re),F(T.$$.fragment,re),Ve=!0)},o(re){z(r.$$.fragment,re),z(T.$$.fragment,re),Ve=!1},d(re){re&&m(e),ye(r),De&&De.d(),ye(T),pe&&pe.d(),q&&q.d(),Ne=!1,ot(le)}}}function To(s,e,t){let l,n,o,a,r,i;de(s,ls,C=>t(23,n=C)),de(s,wt,C=>t(24,o=C)),de(s,kt,C=>t(7,r=C)),de(s,Pt,C=>t(8,i=C));let c=Xe(n[0]),d=Xe(n[1]),f="";const p=ht(Ue(!1),{key:"score-options-hidden"});de(s,p,C=>t(6,a=C));let b=o[0],g=o[1];const y=Ts(),N=y.map(C=>({key:C.names[0],value:C.names[0]}));ls.subscribe(C=>{t(1,c=Xe(C[0])),t(2,d=Xe(C[1]))}),wt.subscribe(C=>{t(4,b=C[0]),t(0,g=C[1])});function E(C,T){const R=Rn(T.currentTarget.value,!0,!0);if("data"in R){const{midi:x}=R.data,K=n,ce=[C==="min"?x:K[0].midi,C==="max"?x:K[1].midi];We.setMidiRange(ce),t(3,f="")}else t(3,f=R.err),C==="min"?t(1,c=Xe(n[0])):t(2,d=Xe(n[1]))}function O(){t(3,f="")}function D({currentTarget:{value:C}}){t(4,b=`${C.charAt(0).toUpperCase()}${C.charAt(1).toLowerCase()}`),we.setKey(b)}function k(C){var T;return t(0,g=(T=N.find(R=>C===R.key))==null?void 0:T.value),we.setScale(g),!1}function L(){p.update(C=>!C)}function S(){we.clearScore(!0),We.setMidiRange([60,84])}function j(){c=this.value,t(1,c)}const G=C=>E("min",C);function w(){d=this.value,t(2,d)}const B=C=>E("max",C);function A(){b=this.value,t(4,b)}return s.$$set=C=>{t(17,e=Te(Te({},e),Ae(C)))},s.$$.update=()=>{var C;s.$$.dirty[0]&1&&t(5,l=((C=y.find(T=>T.names[0]===g))==null?void 0:C.intervals)||[])},e=Ae(e),[g,c,d,f,b,l,a,r,i,p,N,E,O,D,k,L,S,e,j,G,w,B,A]}class Ao extends $e{constructor(e){super(),He(this,e,To,Co,ze,{},null,[-1,-1])}}function Io(s){s[19]=s[20].default}function So(s){return{c:me,l:me,m:me,i:me,o:me,d:me}}function No(s){Io(s);let e,t,l;var n=s[19];function o(a,r){return{props:{class:"px-4 md:px-0"}}}return n&&(e=Cn(n,o())),{c(){e&&ve(e.$$.fragment),t=Ge()},l(a){e&&ge(e.$$.fragment,a),t=Ge()},m(a,r){e&&be(e,a,r),M(a,t,r),l=!0},i(a){l||(e&&F(e.$$.fragment,a),l=!0)},o(a){e&&z(e.$$.fragment,a),l=!1},d(a){a&&m(t),e&&ye(e,a)}}}function Lo(s){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,l){M(t,e,l)},i:me,o:me,d(t){t&&m(e)}}}function Do(s){let e,t,l,n='<a class="hover:underline" href="https://github.com/TeemuKoivisto/midi-note-trainer">MIDI Note Trainer</a>',o,a,r,i,c,d,f,p,b,g,y,N,E,O,D,k,L,S,j;r=new Qa({}),c=new Eo({}),f=new ca({}),g=new Ao({props:{class:"score-options mr-4"}}),N=new uo({props:{class:"play-form"}});let G={ctx:s,current:null,token:null,hasCatch:!1,pending:Lo,then:No,catch:So,value:20,blocks:[,,,]};return En(fe(()=>import("./Score.df838095.js"),["./Score.df838095.js","./vendor_svelte.a32d144a.js","./vendor.13a9dfeb.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),G),k=new no({props:{class:"min-h-32",debounced:!!s[0]}}),k.$on("guessed-chord",s[2]),k.$on("guessed-key",s[3]),k.$on("guessed-note",s[4]),S=new Ea({props:{game:s[1]}}),{c(){e=_("meta"),t=P(),l=_("h1"),l.innerHTML=n,o=P(),a=_("section"),ve(r.$$.fragment),i=P(),ve(c.$$.fragment),d=P(),ve(f.$$.fragment),p=P(),b=_("div"),ve(g.$$.fragment),y=P(),ve(N.$$.fragment),E=P(),G.block.c(),O=P(),D=_("section"),ve(k.$$.fragment),L=P(),ve(S.$$.fragment),this.h()},l(w){const B=wn("svelte-1w2oado",document.head);e=v(B,"META",{name:!0,content:!0}),B.forEach(m),t=V(w),l=v(w,"H1",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-1l8ebwf"&&(l.innerHTML=n),o=V(w),a=v(w,"SECTION",{class:!0});var A=I(a);ge(r.$$.fragment,A),i=V(A),ge(c.$$.fragment,A),d=V(A),ge(f.$$.fragment,A),p=V(A),b=v(A,"DIV",{class:!0});var C=I(b);ge(g.$$.fragment,C),y=V(C),ge(N.$$.fragment,C),C.forEach(m),A.forEach(m),E=V(w),G.block.l(w),O=V(w),D=v(w,"SECTION",{class:!0});var T=I(D);ge(k.$$.fragment,T),L=V(T),ge(S.$$.fragment,T),T.forEach(m),this.h()},h(){h(e,"name","description"),h(e,"content","App to practise music notation, scales and chords using MIDI"),h(l,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight"),h(b,"class","play svelte-qjpqy3"),h(a,"class","px-4 md:px-0"),h(D,"class","mb-8 px-4 md:px-0 flex flex-col")},m(w,B){u(document.head,e),M(w,t,B),M(w,l,B),M(w,o,B),M(w,a,B),be(r,a,null),u(a,i),be(c,a,null),u(a,d),be(f,a,null),u(a,p),u(a,b),be(g,b,null),u(b,y),be(N,b,null),M(w,E,B),G.block.m(w,G.anchor=B),G.mount=()=>O.parentNode,G.anchor=O,M(w,O,B),M(w,D,B),be(k,D,null),u(D,L),be(S,D,null),j=!0},p(w,[B]){s=w;const A={};B&1&&(A.debounced=!!s[0]),k.$set(A);const C={};B&2&&(C.game=s[1]),S.$set(C)},i(w){j||(F(r.$$.fragment,w),F(c.$$.fragment,w),F(f.$$.fragment,w),F(g.$$.fragment,w),F(N.$$.fragment,w),F(G.block),F(k.$$.fragment,w),F(S.$$.fragment,w),j=!0)},o(w){z(r.$$.fragment,w),z(c.$$.fragment,w),z(f.$$.fragment,w),z(g.$$.fragment,w),z(N.$$.fragment,w);for(let B=0;B<3;B+=1){const A=G.blocks[B];z(A)}z(k.$$.fragment,w),z(S.$$.fragment,w),j=!1},d(w){w&&(m(t),m(l),m(o),m(a),m(E),m(O),m(D)),m(e),ye(r),ye(c),ye(f),ye(g),ye(N),G.block.d(w),G.token=null,G=null,ye(k),ye(S)}}}function jo(s,e,t){let l,n,o,a,r,i;de(s,bt,L=>t(7,l=L)),de(s,kt,L=>t(1,n=L)),de(s,dt,L=>t(8,o=L)),de(s,at,L=>t(9,a=L)),de(s,nt,L=>t(10,r=L)),de(s,ys,L=>t(11,i=L));let c,d;an(()=>(i&&k(),window.addEventListener("keydown",f),window.addEventListener("mousedown",f),window.addEventListener("touchstart",f),()=>{window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)})),ss.subscribe(L=>{L&&L.channels[1].addListener("noteon",p)});function f(){We.initAudio(),window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)}function p(L){if(c)return;const S=L.rawData;b(S[1],S[2])}function b(L,S){const j=n;j instanceof jt&&!(j!=null&&j.ended)&&l==="waiting"?N(L):j instanceof ft&&!(j!=null&&j.ended)&&l==="waiting"?(j.addPlayedNote(L),d||(d=setTimeout(y,2e3))):j||we.pushPlayed(L),r&&r.noteOn(L,a.fixedVelocity??S)}function g(){o.autoplay&&o.waitSeconds>0?t(0,c=setTimeout(()=>{o.autoplay&&Se.nextGuess(),t(0,c=void 0)},o.waitSeconds*1e3)):o.autoplay?Se.nextGuess():t(0,c=void 0)}function y(){var S;const L=n;if(L instanceof ft){const j=L.guess();we.setPlayed(((S=L.latestGuess.guessed)==null?void 0:S.notes)||[],j,-1),Se.updateState(j?"correct":"wrong"),g()}d=void 0}function N(L){const S=n;if(S instanceof jt&&l==="waiting"){we.setTarget([we.getNote(S.current)]);const j=S.guess(L);Se.updateState(j?"correct":"wrong"),we.pushPlayed(L,j,4e3),g()}}function E(L){const S=n;if(S instanceof ft&&l==="waiting"){const j=S.guessWrittenChord(L.detail);Se.updateState(j?"correct":"wrong"),g()}}function O(L){const S=n;if(S instanceof Bt&&l==="waiting"){const j=L.detail.replaceAll("♭","b").replaceAll("♯","#"),G=S.guess(j);Se.updateState(G?"correct":"wrong"),g()}}function D(L){b(L.detail,80)}async function k(){const L=await We.openMidi();"data"in L?L.data.name:(L.err,console.error(L.err))}return[c,n,E,O,D]}class Bo extends $e{constructor(e){super(),He(this,e,jo,Do,ze,{})}}export{Fs as F,ft as G,Bo as P,Ln as S,jt as a,Se as b,kt as c,gt as d,As as e,bt as g,nt as p,Pt as s,zs as t};
