import{_ as fe}from"./preload-helper.a4192956.js";import{R as Ee,Q as Ct,T as Ue,U as bn,S as $e,i as He,s as ze,O as Ze,V as ne,e as _,m as P,H as ve,a as v,b as I,n as ee,d as m,o as V,I as ge,f as d,L as H,W as Ce,g as M,h as u,J as be,p as $,t as x,C as et,w as tt,l as z,K as ye,X as Be,Y as rt,M as de,N as Te,P as Ae,z as J,A as Y,B as ae,v as Ge,q as me,c as Zl,u as en,j as tn,k as sn,Z as Os,_ as qt,F as ln,$ as Bs,a0 as Gs,a1 as ns,r as nn,a2 as Qe,a3 as yn,a4 as Qt,a5 as kn,a6 as En,G as wn}from"./vendor_svelte.a6fd78f9.js";import{w as Wt,b as Cn,c as Tn,e as Ms,f as Rs,g as ws,h as Xt,i as Zt,j as An,a as Us,k as _s}from"./vendor.13a9dfeb.js";const Ks={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function qe(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:an(s,e,t),flats:e,sharps:t}}function an(s,e,t){return(s<8?Ks[s]:Ks[s%7])-e+t+Math.floor(s/8)*12}function rn(s){let e,t=0,l=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(l=Math.floor(s/100),e=s%100):e=s;const n=an(e,t,l);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(l)}`,interval_seq:e,semitones:n,flats:t,sharps:l}}const In=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let ds=[];function on(){return In.map(s=>{const e=s[3].map(rn);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function Vt(s){ds.length===0&&(ds=on());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return ds.find(t=>t.suffixes.find(l=>l===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function Sn(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const a=Math.min(l,n);l-=a,n-=a}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function vs(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const r=t[n],a=s+r.semitones,o=e.scaleNotes.find(p=>p.semitones===a%12),c=r.flats>0,i=r.sharps>0,h=(c?a+1:i?a-1:a)%12,f=c?-1:i?1:0;l.push(Sn(o??e.notesMap.get(h),o?0:f,a))}return l}const Fs=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],Nn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],xs=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Ln(s){let e=0,t=0;for(let l=0;l<Fs.length;l+=1){const n=s.find(a=>a.note.slice(0,2)===Fs[l]),r=s.find(a=>a.note.slice(0,2)===Nn[l]);if(n)e+=1;else if(r)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:xs.get(e*-1)}:{flats:0,sharps:t,majorSignature:xs.get(t)}}function Dn(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function cn(s){return s.map(e=>{const t=[qe(1)];let l;return e.major?(t.push(qe(3)),e.suffix.startsWith("+")?t.push(qe(5,0,1)):e.suffix.startsWith("6")?t.push(qe(6)):e.suffix.startsWith("7")?t.push(qe(7,1)):e.suffix.startsWith("maj7")?t.push(qe(7)):l=Vt("maj")):e.minor?(t.push(qe(3,1)),e.suffix.startsWith("°")?t.push(qe(5,1)):e.suffix.startsWith("6")?(t.push(qe(6)),l=Vt("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(qe(7,1)),l=Vt("m"+e.suffix)):l=Vt("m")):e.suffix.startsWith("sus2")?t.push(qe(2)):e.suffix.startsWith("sus4")&&t.push(qe(4)),t.length<=2&&t.push(qe(5)),t.length<=2&&t.push(qe(8)),l||(l=Vt(e.suffix)),{...l,intervals:t}})}function jn(s,e){let t=e.has(4)&&e.has(7),l=e.has(3)&&e.has(7);const n=Dn(s);let r="";return t||l||(e.has(3)&&e.has(6)?(r="°",l=!0):e.has(4)&&e.has(8)?(r="+",t=!0):e.has(3)&&e.has(10)?(l=!0,r="7"):e.has(4)&&e.has(10)?(r="7",t=!0):e.has(4)&&e.has(11)?(r="maj7",t=!0):e.has(3)&&e.has(8)?(r="6",l=!0):e.has(4)&&e.has(9)?(r="6",t=!0):e.has(2)?r="sus2":e.has(5)?r="sus4":e.has(7)?r="5":r="?"),{degree:s,roman:l?n.toLowerCase():n,suffix:r,major:t,minor:l,semitones:e}}function Pn(s){const e=s.length;return s.map((t,l)=>{const n=t.semitones,r=new Set;for(let a=1;a<e;a+=1){const o=s[(l+a)%e].semitones,c=o<=n?o+12-n:o-n;r.add(c)}return jn(t.interval_seq,r)})}const Vn=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let hs=[];function Cs(){return Vn.map(s=>{const e=s[0],t=s[1].map(rn),l=Pn(t);return{names:e,intervals:t,triads:l}})}function On(s){hs.length===0&&(hs=Cs());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return hs.find(t=>t.names.find(l=>l.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const Bn=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,Gn=/^[0-9]$/,lt=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function Ts(s){return s===12?1:Math.floor((s-12)/12)}function Xe(s){return`${s.note}${Ts(s.midi)}`}function Nt(s){const t=(s-12)%12;return{...lt[t],semitones:t,midi:s}}function Mn(s,e=!0,t=!1){if(e&&!Bn.test(s))return{err:`Unrecognized note "${s}"`,code:400};const l=s.trim(),n=l.charAt(0).toUpperCase(),r=lt.find(f=>f.note.charAt(0)===n&&f.note.length===1);if(!r)return{err:`Unable to find note ${l}`,code:500};const a=l.slice(1).split("").reduce((f,p)=>f+(p.toLowerCase()==="b"||p==="♭"?-1:p==="#"||p==="♯"?1:0),0);let o;if(Gn.test(l.charAt(l.length-1)))try{o=parseInt(l.charAt(l.length-1),10)}catch{}if(t&&o===void 0)return{err:`No octave provided: ${s}`,code:400};o===void 0&&(o=0);let c=(r.semitones+a)%12;c=c<0?c+12:c;const i=a<0?-a:0,h=a>0?a:0;return{data:{note:`${n}${"♭".repeat(i)}${"♯".repeat(h)}`,semitones:c,midi:12+o*12+c,flats:i,sharps:h}}}function un(s){const e=lt.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((n,r)=>n+(r.toLowerCase()==="b"||r==="♭"?-1:r==="#"||r==="♯"?1:0),0),l=(e.semitones+t)%12;return{note:s,semitones:l<0?l+12:l,flats:t<0?-t:0,sharps:t>0?t:0}}}const Rn=/^[a-gA-G][♭b#♯]?$/,ms="ABCDEFG";function Un(s,e){return e.map(t=>ms.charAt((ms.indexOf(s)+t.interval_seq-1)%ms.length))}function Kn(s,e,t){return t.map((l,n)=>{const r=e[n],a=(s+l.semitones)%12,o=lt[a],c=o.note.charAt(0);if(c<r&&(c!=="A"||r!=="G")||c==="G"&&r==="A"){let i=1,h=lt[(a+i)%12];for(;h.note.charAt(0)!==r;)i+=1,h=lt[(a+i)%12];return{semitones:a,note:h.note+"♭".repeat(i),flats:i+(h.note.includes("♭")?1:0),sharps:0}}else if(c>r||c==="A"&&r==="G"){let i=1,h=a===0?lt.length-1:a-i,f=lt[h];for(;f.note.charAt(0)!==r;)i+=1,h=h===0?lt.length-1:h-1,f=lt[h];return{semitones:a,note:f.note+"♯".repeat(i),flats:0,sharps:i+(f.note.includes("♯")?1:0)}}else return{semitones:a,note:o.note,flats:o.flats,sharps:o.sharps}})}function es(s,e){if(!Rn.test(s))return{err:`Unknown key: ${s}`,code:400};const t=On(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const l=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,n=un(l);if(!n)return{err:`Unable to find root for note: ${l}`,code:404};const r=Un(l.charAt(0),t.intervals),a=Kn(n.semitones,r,t.intervals),o=new Map(lt.map(c=>{const i=a.find(h=>h.semitones===c.semitones);return i?[c.semitones,i]:[c.semitones,{...c}]}));return{data:{key:l,scale:t.names[0],names:t.names,...Ln(a),intervals:t.intervals.map(c=>({...c})),triads:t.triads.map(c=>({...c})),scaleNotes:a,notesMap:o}}}const gs=new Map;function Fn(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function xn(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(l){return{err:`Failed to store the value: ${l}`,code:400}}}function ht(s,e){const{key:t,storage:l="local",namespace:n="default"}=e,r=Fn(t,l),a=Ee(s);"data"in r?s.set(e.deserialize?e.deserialize(r.data):r.data):"err"in r&&(e!=null&&e.debug)&&console.info(r.err);const o=s.subscribe(i=>{const h=xn(e.serialize?e.serialize(i):i,t,l);"err"in h&&(e!=null&&e.debug)&&console.error(h.err)}),c=gs.get(n);return c?c.push({key:t,storage:l,value:s,defaultValue:a,unsubscribe:o}):gs.set(n,[{key:t,storage:l,value:s,defaultValue:a,unsubscribe:o}]),s}function $n(s=["default"],e){s.forEach(t=>{var l;(l=gs.get(t))==null||l.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function Hn(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const l=await t.arrayBuffer();return{data:await e.decodeAudioData(l)}}async function zn(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],l=await Promise.all(t.map(r=>Hn(`${s}${r}`,e))),n=[];return l.forEach(r=>{"err"in r?console.error(`Failed to load audio: ${r.err}`):n.push(r.data)}),n}class qn{constructor(e,t,l,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(l),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(l))}on(e,t,l,n,r,a,o,c){this.noteA.buffer=e,this.noteA.playbackRate.value=l,this.biquadFilter.frequency.value=r,this.gainA.gain.value=a,this.gain.gain.value=c,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=o,this.noteB.start(0)),this.noteA.start(0)}off(e,t,l){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(l),this.noteB.stop(l),(n=this.damp)==null||n.start(0)}}class Wn{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,l)=>{this.bufferlists.push(t),l===8?this.damper=t:l===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(l=>{this.noteOn(l,t)})}noteOn(e,t=80){if(e<109&&e>20){const l=this.notes.get(e);l&&(l.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),r=n+1,a=n*12+21,o=2**((e-69)/12)*440,c=t/127;let i=o*(2-(e-21)/50)+3*o*c;e<60&&(i=440*(3-(60-21)/50)+3*o*c);const h=1-(e%12/12+1)/12,f=Math.pow(2,(e-a)/12),p=0,b=0,g=c**1.4,y=new qn(e,this.context,this.directGain,this.damper);y.on(this.bufferlists[n],this.bufferlists[r],f,p,i,h,b,g),this.notes.set(e,y)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const Jn="/midi-note-trainer/",bs=ht(Ue(!1),{key:"midi-access"}),ts=Ue(void 0),as=ht(Ue([60,84]),{key:"midi-range",storage:"session"}),ss=Ct(as,s=>[Nt(s[0]),Nt(s[1])]),$s=Ue(void 0),nt=Ue(void 0),at=ht(Ue({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),We={async openMidi(){return Wt.enable().then(()=>(bs.set(!0),Wt.inputs.length>0?(ts.set(Wt.inputs[0]),{data:Wt.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(s=>({err:s.toString(),code:403}))},disableMidi(){bs.set(!1),ts.set(void 0)},setMidiRange(s){as.set(s)},setInputValue(s,e){at.update(t=>({...t,[s]:e})),s==="useSound"&&!e?nt.set(void 0):s==="useSound"&&!Ee(nt)&&this.initAudio()},async initAudio(){let s=Ee($s);if(s||(s=new AudioContext,$s.set(s)),!Ee(nt)){const e=new Wn(s),t=await zn(`${Jn}audio`,s);e.load(t),nt.set(e)}}};let st;bn({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}});const wt=Ue(["C","Major"]),jt=Ct(wt,s=>{const e=es(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),Hs=Ue([]),gt=Ue([]);function ys(s,e){if(s.length>0){const t=Date.now();let l=t;const n=s.filter(r=>(r.started+e>t&&(l=Math.min(l,r.started)),r.started+e>t));return!st&&n.length>0&&(st=setTimeout(()=>{st=void 0,gt.update(r=>ys(r,e))},e-(t-l)+100)),n}return s}const we={setKey(s){wt.update(e=>[s,e[1]])},setScale(s){wt.update(e=>[e[0],s])},setKeyAndScale(s,e){wt.set([s,e])},setTarget(s=[]){Hs.set(s)},getNote(s){return{...Ee(jt).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const n={...Ee(jt).notesMap.get(s%12),midi:s},r=Date.now(),a=e===void 0?"default":e?"correct":"wrong";if(gt.update(o=>{const c=o.findIndex(i=>i.midi===s);return c>=0&&o.splice(c,1),[...o,{...n,color:a,started:r}]}),!st&&t!==-1){const o=t??Ee(at).keyFadeTimeout;st=setTimeout(()=>{st=void 0,gt.update(c=>ys(c,o))},o)}},setPlayed(s,e,t){const l=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(gt.update(r=>[...s.map(a=>({...a,color:n,started:l}))]),!st&&t!==-1){const r=t??Ee(at).keyFadeTimeout;st=setTimeout(()=>{st=void 0,gt.update(a=>ys(a,r))},r)}},clearPlayed(){gt.set([]),clearTimeout(st),st=void 0},clearScore(s=!1){s&&wt.set(["C","Major"]),Hs.set([]),gt.set([])}};class As{constructor(e,t,l){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=l;const n=[],{count:r}=l,a=t.map(c=>typeof c=="object"&&c!==null?{...c}:c);let o=l.duplicates;!l.duplicates&&r>a.length&&(console.warn(`Trying to create game with count ${r} larger than available unique values ${t.length}`),o=!0);for(let c=0;c<r;c+=1){const i=Math.floor(Math.random()*a.length);if(o)n.push(a[i]);else{const h=a.splice(i,1);h.length>0&&n.push(h[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function Yn(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const a=Math.min(l,n);l-=a,n-=a}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function Qn(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const r=t[n],a=s+r.semitones,o=e.scaleNotes.find(p=>p.semitones===a%12),c=r.flats>0,i=r.sharps>0,h=(c?a+1:i?a-1:a)%12,f=c?-1:i?1:0;l.push(Yn(o??e.notesMap.get(h),o?0:f,a))}return l}const Xn=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function Zn(s){const t=(s-12)%12;return{...Xn[t],semitones:t,midi:s}}function ea(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class ft extends As{constructor(e,t,l){const n=t.range[0],r=t.range[1],a=new Set(t.scale.scaleNotes.map(c=>c.semitones)),o=l.chords.flatMap(c=>{const i=[],h=c.intervals.reduce((f,p)=>p.semitones>f?p.semitones:f,0);for(let f=n;f<=r-h;f+=1)if((!l.onlyScale||a.has(f%12))&&(!c.allowed||c.allowed.has(f%12))){const p=Qn(f,t.scale,c.intervals);i.push({...c,rootNote:p[0].note,chord:`${p[0].note}${c.suffixes[0]}`,notes:p})}return i});super(e,o,t),this.played=new Set,this.opts=l}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${ea(e)}${e.chord.toLowerCase()}`,notes:[]},l=this.current.chord===t.chord;return this.addGuessed(t,l)}guess(){const e=Array.from(this.played.values()).map(n=>Zn(n)).sort((n,r)=>n.midi-r.midi);this.played.clear();const t={chord:"",notes:e},l=this.current.notes.every(n=>e.find(r=>r.midi%12===n.midi%12));return this.addGuessed(t,l)}}const ta={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class Ot extends As{constructor(e,t){const l=e==="keys-major"?"major":"minor";super(e,Object.keys(ta[l]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class Dt extends As{constructor(e,t){const l=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-l+1)).map((r,a)=>l+a),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const fn={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},bt=Ue("waiting"),dt=ht(Ue(fn),{key:"game-options"}),kt=Ue(void 0),Is=Ue(on().map(s=>({...s,selected:!0}))),Se={play(...[s,e]){var c,i,h;let t;const l=Ee(jt),n=Ee(as),r=Ee(dt),a={scale:l,range:n,duplicates:r.duplicates,count:r.count};let o=[l.key,l.scale];if(s==="notes")t=new Dt(s,a),we.setTarget([we.getNote(t.current)]),(c=Ee(nt))==null||c.noteOn(t.current);else if(s==="pitches")t=new Dt(s,a),we.setTarget(),We.setInputValue("useSound",!0),(i=Ee(nt))==null||i.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new Ot(s,a),o=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new ft(s,a,e);else if(s==="chords-diatonic"){const f=cn(l.triads).map((p,b)=>({...p,allowed:new Set([l.scaleNotes[b].semitones])}));t=new ft(s,a,{chords:f})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((h=Ee(nt))==null||h.playChord(t.current.notes.map(f=>f.midi)),we.setTarget(t.current.notes)),we.setKeyAndScale(o[0],o[1]),we.clearPlayed(),bt.set("waiting"),kt.set(t),t},updateState(s){bt.set(s)},setOptionValue(s,e){dt.update(t=>({...t,[s]:e}))},toggleChords(s){Is.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Ee(kt);s!=null&&s.ended?bt.set("ended"):s instanceof Dt?(s.type==="notes"?we.setTarget([we.getNote(s.current)]):we.setTarget(),we.clearPlayed(),(e=Ee(nt))==null||e.noteOn(s.current),Se.updateState("waiting"),s.startTime()):s instanceof ft?(we.setTarget(s.current.notes),we.clearPlayed(),(t=Ee(nt))==null||t.playChord(s==null?void 0:s.current.notes.map(l=>l.midi)),bt.set("waiting"),s.startTime()):s instanceof Ot&&(we.setKey(s.current),bt.set("waiting"),s.startTime())},clearGame(s=!1){const e=Ee(kt);e&&we.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&dt.set(fn),kt.set(void 0),bt.set("waiting"),we.clearScore()}};function zs(s,e,t){const l=s.slice();return l[25]=e[t],l[27]=t,l}function qs(s,e,t){const l=s.slice();return l[30]=e[t],l}function Ws(s,e,t){const l=s.slice();return l[8]=e[t],l}function Js(s,e,t){const l=s.slice();return l[25]=e[t],l[27]=t,l}function Ys(s,e,t){const l=s.slice();return l[30]=e[t],l}function Qs(s,e,t){const l=s.slice();return l[8]=e[t],l}function sa(s){let e,t=ne(s[25].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=Xs(Ys(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Ge()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&64){t=ne(n[25].intervals);let a;for(a=0;a<t.length;a+=1){const o=Ys(n,t,a);l[a]?l[a].p(o,r):(l[a]=Xs(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function la(s){let e,t=ne(s[2][s[27]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Zs(Qs(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Ge()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&4){t=ne(n[2][n[27]]);let a;for(a=0;a<t.length;a+=1){const o=Qs(n,t,a);l[a]?l[a].p(o,r):(l[a]=Zs(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Xs(s){let e,t=s[30].interval+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=I(e);l=Y(r,t),r.forEach(m),this.h()},h(){d(e,"class","svelte-1j99daw")},m(n,r){M(n,e,r),u(e,l)},p(n,r){r[0]&64&&t!==(t=n[30].interval+"")&&ae(l,t)},d(n){n&&m(e)}}}function Zs(s){let e,t=s[8].note+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=I(e);l=Y(r,t),r.forEach(m),this.h()},h(){d(e,"class","svelte-1j99daw")},m(n,r){M(n,e,r),u(e,l)},p(n,r){r[0]&4&&t!==(t=n[8].note+"")&&ae(l,t)},d(n){n&&m(e)}}}function el(s){let e,t,l,n,r,a,o=s[25].suffixes[0]+"",c,i,h,f,p,b,g=s[25].name+"",y,N,E,O;n=new Ze({props:{icon:s[25].selected?Xt:Zt,width:12}});function D(){return s[21](s[25])}function k(j,G){return j[2][j[27]]&&j[2][j[27]].length>0?la:sa}let L=k(s),S=L(s);return{c(){e=_("li"),t=_("button"),l=_("span"),ve(n.$$.fragment),r=P(),a=_("div"),c=J(o),i=P(),h=_("li"),S.c(),p=P(),b=_("li"),y=J(g),this.h()},l(j){e=v(j,"LI",{});var G=I(e);t=v(G,"BUTTON",{class:!0});var w=I(t);l=v(w,"SPAN",{class:!0});var B=I(l);ge(n.$$.fragment,B),B.forEach(m),r=V(w),a=v(w,"DIV",{class:!0});var A=I(a);c=Y(A,o),A.forEach(m),w.forEach(m),G.forEach(m),i=V(j),h=v(j,"LI",{class:!0,title:!0});var C=I(h);S.l(C),C.forEach(m),p=V(j),b=v(j,"LI",{class:!0});var T=I(b);y=Y(T,g),T.forEach(m),this.h()},h(){d(l,"class","px-1 py-1 rounded"),H(l,"text-green-500",s[25].selected),H(l,"text-gray-400",!s[25].selected),d(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),d(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),H(t,"hidden",s[7]),d(h,"class","intervals svelte-1j99daw"),d(h,"title",f=s[25].intervals.map(al).join("-")),d(b,"class","text-xs")},m(j,G){M(j,e,G),u(e,t),u(t,l),be(n,l,null),u(t,r),u(t,a),u(a,c),M(j,i,G),M(j,h,G),S.m(h,null),M(j,p,G),M(j,b,G),u(b,y),N=!0,E||(O=$(t,"click",D),E=!0)},p(j,G){s=j;const w={};G[0]&64&&(w.icon=s[25].selected?Xt:Zt),n.$set(w),(!N||G[0]&64)&&H(l,"text-green-500",s[25].selected),(!N||G[0]&64)&&H(l,"text-gray-400",!s[25].selected),(!N||G[0]&64)&&o!==(o=s[25].suffixes[0]+"")&&ae(c,o),(!N||G[0]&128)&&H(t,"hidden",s[7]),L===(L=k(s))&&S?S.p(s,G):(S.d(1),S=L(s),S&&(S.c(),S.m(h,null))),(!N||G[0]&64&&f!==(f=s[25].intervals.map(al).join("-")))&&d(h,"title",f),(!N||G[0]&64)&&g!==(g=s[25].name+"")&&ae(y,g)},i(j){N||(x(n.$$.fragment,j),N=!0)},o(j){z(n.$$.fragment,j),N=!1},d(j){j&&(m(e),m(i),m(h),m(p),m(b)),ye(n),S.d(),E=!1,O()}}}function na(s){let e,t=ne(s[25].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=tl(qs(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Ge()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&32){t=ne(n[25].intervals);let a;for(a=0;a<t.length;a+=1){const o=qs(n,t,a);l[a]?l[a].p(o,r):(l[a]=tl(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function aa(s){let e,t=ne(s[3][s[27]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=sl(Ws(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Ge()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&8){t=ne(n[3][n[27]]);let a;for(a=0;a<t.length;a+=1){const o=Ws(n,t,a);l[a]?l[a].p(o,r):(l[a]=sl(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function tl(s){let e,t=s[30].interval+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=I(e);l=Y(r,t),r.forEach(m),this.h()},h(){d(e,"class","svelte-1j99daw")},m(n,r){M(n,e,r),u(e,l)},p(n,r){r[0]&32&&t!==(t=n[30].interval+"")&&ae(l,t)},d(n){n&&m(e)}}}function sl(s){let e,t=s[8].note+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=I(e);l=Y(r,t),r.forEach(m),this.h()},h(){d(e,"class","svelte-1j99daw")},m(n,r){M(n,e,r),u(e,l)},p(n,r){r[0]&8&&t!==(t=n[8].note+"")&&ae(l,t)},d(n){n&&m(e)}}}function ll(s){let e,t,l,n,r,a,o=s[25].suffixes[0]+"",c,i,h,f,p,b,g=s[25].name+"",y,N,E,O;n=new Ze({props:{icon:s[25].selected?Xt:Zt,width:12}});function D(){return s[22](s[25])}function k(j,G){return j[3][j[27]]&&j[3][j[27]].length>0?aa:na}let L=k(s),S=L(s);return{c(){e=_("li"),t=_("button"),l=_("span"),ve(n.$$.fragment),r=P(),a=_("div"),c=J(o),i=P(),h=_("li"),S.c(),p=P(),b=_("li"),y=J(g),this.h()},l(j){e=v(j,"LI",{});var G=I(e);t=v(G,"BUTTON",{class:!0});var w=I(t);l=v(w,"SPAN",{class:!0});var B=I(l);ge(n.$$.fragment,B),B.forEach(m),r=V(w),a=v(w,"DIV",{class:!0});var A=I(a);c=Y(A,o),A.forEach(m),w.forEach(m),G.forEach(m),i=V(j),h=v(j,"LI",{class:!0,title:!0});var C=I(h);S.l(C),C.forEach(m),p=V(j),b=v(j,"LI",{class:!0});var T=I(b);y=Y(T,g),T.forEach(m),this.h()},h(){d(l,"class","px-1 py-1 rounded"),H(l,"text-green-500",s[25].selected),H(l,"text-gray-400",!s[25].selected),d(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),d(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),H(t,"hidden",s[7]),d(h,"class","intervals svelte-1j99daw"),d(h,"title",f=s[25].intervals.map(rl).join("-")),d(b,"class","text-xs")},m(j,G){M(j,e,G),u(e,t),u(t,l),be(n,l,null),u(t,r),u(t,a),u(a,c),M(j,i,G),M(j,h,G),S.m(h,null),M(j,p,G),M(j,b,G),u(b,y),N=!0,E||(O=$(t,"click",D),E=!0)},p(j,G){s=j;const w={};G[0]&32&&(w.icon=s[25].selected?Xt:Zt),n.$set(w),(!N||G[0]&32)&&H(l,"text-green-500",s[25].selected),(!N||G[0]&32)&&H(l,"text-gray-400",!s[25].selected),(!N||G[0]&32)&&o!==(o=s[25].suffixes[0]+"")&&ae(c,o),(!N||G[0]&128)&&H(t,"hidden",s[7]),L===(L=k(s))&&S?S.p(s,G):(S.d(1),S=L(s),S&&(S.c(),S.m(h,null))),(!N||G[0]&32&&f!==(f=s[25].intervals.map(rl).join("-")))&&d(h,"title",f),(!N||G[0]&32)&&g!==(g=s[25].name+"")&&ae(y,g)},i(j){N||(x(n.$$.fragment,j),N=!0)},o(j){z(n.$$.fragment,j),N=!1},d(j){j&&(m(e),m(i),m(h),m(p),m(b)),ye(n),S.d(),E=!1,O()}}}function ra(s){let e,t,l,n,r="Chords",a,o,c,i,h,f,p,b,g,y,N,E,O,D,k,L,S,j="Key",G,w,B,A,C="Scale",T,R,K,F,ce="Note",ue,se,Q,ke,X,re,Ie,he,ie,Ve;i=new Ze({props:{icon:Cn,width:20}}),p=new Ze({props:{icon:Tn,width:16}}),y=new Ze({props:{icon:s[4]?Ms:Rs,width:16}}),O=new Ze({props:{icon:ws,width:16}});let Ne=ne(s[6]),le=[];for(let U=0;U<Ne.length;U+=1)le[U]=el(Js(s,Ne,U));const De=U=>z(le[U],1,1,()=>{le[U]=null});let pe=ne(s[5]),q=[];for(let U=0;U<pe.length;U+=1)q[U]=ll(zs(s,pe,U));const oe=U=>z(q[U],1,1,()=>{q[U]=null});return{c(){e=_("div"),t=_("fieldset"),l=_("legend"),n=_("button"),n.textContent=r,a=P(),o=_("div"),c=_("button"),ve(i.$$.fragment),h=P(),f=_("button"),ve(p.$$.fragment),b=P(),g=_("button"),ve(y.$$.fragment),N=P(),E=_("button"),ve(O.$$.fragment),D=P(),k=_("div"),L=_("div"),S=_("label"),S.textContent=j,G=P(),w=_("input"),B=P(),A=_("label"),A.textContent=C,T=P(),R=_("input"),K=P(),F=_("label"),F.textContent=ce,ue=P(),se=_("input"),Q=P(),ke=_("ul");for(let U=0;U<le.length;U+=1)le[U].c();X=P(),re=_("ul");for(let U=0;U<q.length;U+=1)q[U].c();this.h()},l(U){e=v(U,"DIV",{class:!0});var Z=I(e);t=v(Z,"FIELDSET",{class:!0});var _e=I(t);l=v(_e,"LEGEND",{class:!0});var te=I(l);n=v(te,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1knqzl6"&&(n.textContent=r),te.forEach(m),a=V(_e),o=v(_e,"DIV",{class:!0});var Le=I(o);c=v(Le,"BUTTON",{class:!0});var Me=I(c);ge(i.$$.fragment,Me),Me.forEach(m),h=V(Le),f=v(Le,"BUTTON",{class:!0});var ot=I(f);ge(p.$$.fragment,ot),ot.forEach(m),b=V(Le),g=v(Le,"BUTTON",{class:!0});var Je=I(g);ge(y.$$.fragment,Je),Je.forEach(m),N=V(Le),E=v(Le,"BUTTON",{class:!0});var Ke=I(E);ge(O.$$.fragment,Ke),Ke.forEach(m),Le.forEach(m),D=V(_e),k=v(_e,"DIV",{class:!0});var Oe=I(k);L=v(Oe,"DIV",{class:!0});var je=I(L);S=v(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(S)!=="svelte-14m38zf"&&(S.textContent=j),G=V(je),w=v(je,"INPUT",{class:!0,id:!0}),B=V(je),A=v(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(A)!=="svelte-bxhcb0"&&(A.textContent=C),T=V(je),R=v(je,"INPUT",{class:!0,id:!0}),K=V(je),F=v(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(F)!=="svelte-dmbfli"&&(F.textContent=ce),ue=V(je),se=v(je,"INPUT",{class:!0,id:!0}),je.forEach(m),Q=V(Oe),ke=v(Oe,"UL",{class:!0});var Pt=I(ke);for(let Fe=0;Fe<le.length;Fe+=1)le[Fe].l(Pt);Pt.forEach(m),X=V(Oe),re=v(Oe,"UL",{class:!0});var Tt=I(re);for(let Fe=0;Fe<q.length;Fe+=1)q[Fe].l(Tt);Tt.forEach(m),Oe.forEach(m),_e.forEach(m),Z.forEach(m),this.h()},h(){d(n,"class","px-1 rounded hover:bg-gray-100"),d(l,"class","text-base"),d(c,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),H(c,"hidden",s[7]),d(f,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),H(f,"hidden",s[7]),d(g,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),H(g,"hidden",s[7]),d(E,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),H(E,"hidden",s[7]),d(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),d(S,"class","mr-4 font-bold svelte-1j99daw"),d(S,"for","scale-key"),d(w,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),d(w,"id","scale-key"),w.value=s[0],d(A,"class","font-bold svelte-1j99daw"),d(A,"for","scale-key"),d(R,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),d(R,"id","scale-key"),R.value="Major",R.disabled=!0,d(F,"class","font-bold svelte-1j99daw"),d(F,"for","scale-key"),d(se,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),d(se,"id","scale-key"),se.value=s[1],d(L,"class","flex mb-2 input svelte-1j99daw"),d(ke,"class","chord-list w-full svelte-1j99daw"),d(re,"class","chord-list w-full svelte-1j99daw"),d(k,"class","body svelte-1j99daw"),H(k,"hidden",s[7]),d(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1j99daw"),H(t,"collapsed",s[7]),d(e,"class",Ie=Ce(`${s[18].class||""}`)+" svelte-1j99daw")},m(U,Z){M(U,e,Z),u(e,t),u(t,l),u(l,n),u(t,a),u(t,o),u(o,c),be(i,c,null),u(o,h),u(o,f),be(p,f,null),u(o,b),u(o,g),be(y,g,null),u(o,N),u(o,E),be(O,E,null),u(t,D),u(t,k),u(k,L),u(L,S),u(L,G),u(L,w),u(L,B),u(L,A),u(L,T),u(L,R),u(L,K),u(L,F),u(L,ue),u(L,se),u(k,Q),u(k,ke);for(let _e=0;_e<le.length;_e+=1)le[_e]&&le[_e].m(ke,null);u(k,X),u(k,re);for(let _e=0;_e<q.length;_e+=1)q[_e]&&q[_e].m(re,null);he=!0,ie||(Ve=[$(n,"click",s[10]),$(c,"click",s[14]),$(f,"click",s[15]),$(g,"click",s[16]),$(E,"click",s[17]),$(w,"input",s[11]),$(se,"input",s[12])],ie=!0)},p(U,Z){(!he||Z[0]&128)&&H(c,"hidden",U[7]),(!he||Z[0]&128)&&H(f,"hidden",U[7]);const _e={};if(Z[0]&16&&(_e.icon=U[4]?Ms:Rs),y.$set(_e),(!he||Z[0]&128)&&H(g,"hidden",U[7]),(!he||Z[0]&128)&&H(E,"hidden",U[7]),(!he||Z[0]&1&&w.value!==U[0])&&(w.value=U[0]),(!he||Z[0]&2&&se.value!==U[1])&&(se.value=U[1]),Z[0]&8388){Ne=ne(U[6]);let te;for(te=0;te<Ne.length;te+=1){const Le=Js(U,Ne,te);le[te]?(le[te].p(Le,Z),x(le[te],1)):(le[te]=el(Le),le[te].c(),x(le[te],1),le[te].m(ke,null))}for(et(),te=Ne.length;te<le.length;te+=1)De(te);tt()}if(Z[0]&8360){pe=ne(U[5]);let te;for(te=0;te<pe.length;te+=1){const Le=zs(U,pe,te);q[te]?(q[te].p(Le,Z),x(q[te],1)):(q[te]=ll(Le),q[te].c(),x(q[te],1),q[te].m(re,null))}for(et(),te=pe.length;te<q.length;te+=1)oe(te);tt()}(!he||Z[0]&128)&&H(k,"hidden",U[7]),(!he||Z[0]&128)&&H(t,"collapsed",U[7]),(!he||Z[0]&262144&&Ie!==(Ie=Ce(`${U[18].class||""}`)+" svelte-1j99daw"))&&d(e,"class",Ie)},i(U){if(!he){x(i.$$.fragment,U),x(p.$$.fragment,U),x(y.$$.fragment,U),x(O.$$.fragment,U);for(let Z=0;Z<Ne.length;Z+=1)x(le[Z]);for(let Z=0;Z<pe.length;Z+=1)x(q[Z]);he=!0}},o(U){z(i.$$.fragment,U),z(p.$$.fragment,U),z(y.$$.fragment,U),z(O.$$.fragment,U),le=le.filter(Boolean);for(let Z=0;Z<le.length;Z+=1)z(le[Z]);q=q.filter(Boolean);for(let Z=0;Z<q.length;Z+=1)z(q[Z]);he=!1},d(U){U&&m(e),ye(i),ye(p),ye(y),ye(O),Be(le,U),Be(q,U),ie=!1,rt(Ve)}}}let nl="Major";const al=s=>s.interval,rl=s=>s.interval;function oa(s,e,t){let l,n,r,a,o,c;de(s,Is,A=>t(20,o=A));let i="C",h=es(i,nl),f="",p,b=[],g=[];const y=ht(Ue(!0),{key:"chords-hidden"});de(s,y,A=>t(7,c=A));function N(){y.update(A=>!A)}function E(){const A=p&&60+p.semitones;if("err"in h||!A)t(2,b=[]),t(3,g=[]);else{const C=h.data;t(2,b=n.map(T=>vs(A,C,T.intervals))),t(3,g=r.map(T=>vs(A,C,T.intervals)))}}function O({currentTarget:{value:A}}){t(0,i=`${A.charAt(0).toUpperCase()}${A.charAt(1).toLowerCase()}`),h=es(i,nl),E()}function D({currentTarget:{value:A}}){t(1,f=`${A.charAt(0).toUpperCase()}${A.charAt(1).toLowerCase()}`),t(8,p=un(f)),E()}function k(A){Se.toggleChords(C=>C.name===A.name?!C.selected:C.selected)}function L(){const A=T=>T.suffixes[0]==="maj"||T.suffixes[0]==="m",C=o.filter(A).every(T=>T.selected);Se.toggleChords(T=>A(T)?!C:T.selected)}function S(){const A=T=>T.suffixes[0]==="maj7"||T.suffixes[0]==="m7"||T.suffixes[0]==="7"||T.suffixes[0]==="dim7"||T.suffixes[0]==="aug7",C=o.filter(A).every(T=>T.selected);Se.toggleChords(T=>A(T)?!C:T.selected)}function j(){Se.toggleChords(A=>!a)}function G(){Se.toggleChords(A=>!0)}const w=A=>k(A),B=A=>k(A);return s.$$set=A=>{t(18,e=Te(Te({},e),Ae(A)))},s.$$.update=()=>{s.$$.dirty[0]&1048576&&t(19,l=o),s.$$.dirty[0]&524288&&t(6,n=l.filter((A,C)=>C<l.length/2)),s.$$.dirty[0]&524288&&t(5,r=l.filter((A,C)=>C>=l.length/2)),s.$$.dirty[0]&524288&&t(4,a=l.every(A=>A.selected))},e=Ae(e),[i,f,b,g,a,r,n,c,p,y,N,O,D,k,L,S,j,G,e,l,o,w,B]}class ia extends $e{constructor(e){super(),He(this,e,oa,ra,ze,{},null,[-1,-1])}}function ol(s,e,t){const l=s.slice();return l[10]=e[t],l}function ca(s){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,l){M(t,e,l)},p:me,d(t){t&&m(e)}}}function ua(s){let e,t,l="Played:",n,r=ne(s[2]),a=[];for(let o=0;o<r.length;o+=1)a[o]=il(ol(s,r,o));return{c(){e=_("div"),t=_("span"),t.textContent=l,n=P();for(let o=0;o<a.length;o+=1)a[o].c()},l(o){e=v(o,"DIV",{});var c=I(e);t=v(c,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1g6xxhn"&&(t.textContent=l),n=V(c);for(let i=0;i<a.length;i+=1)a[i].l(c);c.forEach(m)},m(o,c){M(o,e,c),u(e,t),u(e,n);for(let i=0;i<a.length;i+=1)a[i]&&a[i].m(e,null)},p(o,c){if(c&4){r=ne(o[2]);let i;for(i=0;i<r.length;i+=1){const h=ol(o,r,i);a[i]?a[i].p(h,c):(a[i]=il(h),a[i].c(),a[i].m(e,null))}for(;i<a.length;i+=1)a[i].d(1);a.length=r.length}},d(o){o&&m(e),Be(a,o)}}}function fa(s){let e,t,l="Result:",n,r,a,o=s[0].correct+"",c,i,h=s[0].sampled.length+"",f,p,b,g,y,N=s[0].avgTime+"",E,O;return{c(){e=_("div"),t=_("span"),t.textContent=l,n=P(),r=_("span"),a=J("["),c=J(o),i=J(" / "),f=J(h),p=J("]"),b=P(),g=_("span"),y=J("avg "),E=J(N),O=J("s"),this.h()},l(D){e=v(D,"DIV",{class:!0});var k=I(e);t=v(k,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1eqfbgx"&&(t.textContent=l),n=V(k),r=v(k,"SPAN",{class:!0});var L=I(r);a=Y(L,"["),c=Y(L,o),i=Y(L," / "),f=Y(L,h),p=Y(L,"]"),L.forEach(m),b=V(k),g=v(k,"SPAN",{});var S=I(g);y=Y(S,"avg "),E=Y(S,N),O=Y(S,"s"),S.forEach(m),k.forEach(m),this.h()},h(){d(r,"class","mx-2"),d(e,"class","flex")},m(D,k){M(D,e,k),u(e,t),u(e,n),u(e,r),u(r,a),u(r,c),u(r,i),u(r,f),u(r,p),u(e,b),u(e,g),u(g,y),u(g,E),u(g,O)},p(D,k){k&1&&o!==(o=D[0].correct+"")&&ae(c,o),k&1&&h!==(h=D[0].sampled.length+"")&&ae(f,h),k&1&&N!==(N=D[0].avgTime+"")&&ae(E,N)},d(D){D&&m(e)}}}function da(s){var j,G,w,B;let e,t,l="Target:",n,r,a=((j=s[0].latestGuess.target)==null?void 0:j.chord)+"",o,c,i,h=((G=s[0].latestGuess.target)==null?void 0:G.notes.map(cl).join(" "))+"",f,p,b,g="Guessed:",y,N,E=((w=s[0].latestGuess.guessed)==null?void 0:w.chord)+"",O,D,k,L=((B=s[0].latestGuess.guessed)==null?void 0:B.notes.map(ul).join(" "))+"",S;return{c(){e=_("div"),t=_("span"),t.textContent=l,n=P(),r=_("span"),o=J(a),c=P(),i=_("span"),f=J(h),p=P(),b=_("span"),b.textContent=g,y=P(),N=_("span"),O=J(E),D=P(),k=_("span"),S=J(L),this.h()},l(A){e=v(A,"DIV",{class:!0});var C=I(e);t=v(C,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=V(C),r=v(C,"SPAN",{});var T=I(r);o=Y(T,a),T.forEach(m),c=V(C),i=v(C,"SPAN",{});var R=I(i);f=Y(R,h),R.forEach(m),p=V(C),b=v(C,"SPAN",{"data-svelte-h":!0}),ee(b)!=="svelte-104368"&&(b.textContent=g),y=V(C),N=v(C,"SPAN",{});var K=I(N);O=Y(K,E),K.forEach(m),D=V(C),k=v(C,"SPAN",{});var F=I(k);S=Y(F,L),F.forEach(m),C.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(A,C){M(A,e,C),u(e,t),u(e,n),u(e,r),u(r,o),u(e,c),u(e,i),u(i,f),u(e,p),u(e,b),u(e,y),u(e,N),u(N,O),u(e,D),u(e,k),u(k,S)},p(A,C){var T,R,K,F;C&1&&a!==(a=((T=A[0].latestGuess.target)==null?void 0:T.chord)+"")&&ae(o,a),C&1&&h!==(h=((R=A[0].latestGuess.target)==null?void 0:R.notes.map(cl).join(" "))+"")&&ae(f,h),C&1&&E!==(E=((K=A[0].latestGuess.guessed)==null?void 0:K.chord)+"")&&ae(O,E),C&1&&L!==(L=((F=A[0].latestGuess.guessed)==null?void 0:F.notes.map(ul).join(" "))+"")&&ae(S,L)},d(A){A&&m(e)}}}function ha(s){let e,t,l="Target:",n,r,a=s[0].latestGuess.target+"",o,c,i,h,f,p="Guessed:",b,g,y=s[0].latestGuess.guessed+"",N,E,O;return{c(){e=_("div"),t=_("span"),t.textContent=l,n=P(),r=_("span"),o=J(a),c=P(),i=_("span"),h=P(),f=_("span"),f.textContent=p,b=P(),g=_("span"),N=J(y),E=P(),O=_("span"),this.h()},l(D){e=v(D,"DIV",{class:!0});var k=I(e);t=v(k,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=V(k),r=v(k,"SPAN",{});var L=I(r);o=Y(L,a),L.forEach(m),c=V(k),i=v(k,"SPAN",{}),I(i).forEach(m),h=V(k),f=v(k,"SPAN",{"data-svelte-h":!0}),ee(f)!=="svelte-104368"&&(f.textContent=p),b=V(k),g=v(k,"SPAN",{});var S=I(g);N=Y(S,y),S.forEach(m),E=V(k),O=v(k,"SPAN",{}),I(O).forEach(m),k.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(D,k){M(D,e,k),u(e,t),u(e,n),u(e,r),u(r,o),u(e,c),u(e,i),u(e,h),u(e,f),u(e,b),u(e,g),u(g,N),u(e,E),u(e,O)},p(D,k){k&1&&a!==(a=D[0].latestGuess.target+"")&&ae(o,a),k&1&&y!==(y=D[0].latestGuess.guessed+"")&&ae(N,y)},d(D){D&&m(e)}}}function ma(s){let e,t,l="Target:",n,r,a=Xe(Nt(s[0].latestGuess.target||0))+"",o,c,i,h,f,p="Guessed:",b,g,y=Xe(Nt(s[0].latestGuess.guessed||0))+"",N,E,O;return{c(){e=_("div"),t=_("span"),t.textContent=l,n=P(),r=_("span"),o=J(a),c=P(),i=_("span"),h=P(),f=_("span"),f.textContent=p,b=P(),g=_("span"),N=J(y),E=P(),O=_("span"),this.h()},l(D){e=v(D,"DIV",{class:!0});var k=I(e);t=v(k,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=V(k),r=v(k,"SPAN",{});var L=I(r);o=Y(L,a),L.forEach(m),c=V(k),i=v(k,"SPAN",{}),I(i).forEach(m),h=V(k),f=v(k,"SPAN",{"data-svelte-h":!0}),ee(f)!=="svelte-104368"&&(f.textContent=p),b=V(k),g=v(k,"SPAN",{});var S=I(g);N=Y(S,y),S.forEach(m),E=V(k),O=v(k,"SPAN",{}),I(O).forEach(m),k.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(D,k){M(D,e,k),u(e,t),u(e,n),u(e,r),u(r,o),u(e,c),u(e,i),u(e,h),u(e,f),u(e,b),u(e,g),u(g,N),u(e,E),u(e,O)},p(D,k){k&1&&a!==(a=Xe(Nt(D[0].latestGuess.target||0))+"")&&ae(o,a),k&1&&y!==(y=Xe(Nt(D[0].latestGuess.guessed||0))+"")&&ae(N,y)},d(D){D&&m(e)}}}function il(s){let e,t=Xe(s[10])+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=I(e);l=Y(r,t),r.forEach(m),this.h()},h(){d(e,"class","mx-1")},m(n,r){M(n,e,r),u(e,l)},p(n,r){r&4&&t!==(t=Xe(n[10])+"")&&ae(l,t)},d(n){n&&m(e)}}}function pa(s){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,l){M(t,e,l)},p:me,d(t){t&&m(e)}}}function _a(s){let e,t="Next",l,n,r="Autoplay",a,o;return{c(){e=_("button"),e.textContent=t,l=P(),n=_("button"),n.textContent=r,this.h()},l(c){e=v(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-1nvnoba"&&(e.textContent=t),l=V(c),n=v(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1cfj1sl"&&(n.textContent=r),this.h()},h(){d(e,"class","btn primary"),d(n,"class","btn primary")},m(c,i){M(c,e,i),M(c,l,i),M(c,n,i),a||(o=[$(e,"click",s[4]),$(n,"click",s[5])],a=!0)},p:me,d(c){c&&(m(e),m(l),m(n)),a=!1,rt(o)}}}function va(s){let e,t="Stop autoplay",l,n;return{c(){e=_("button"),e.textContent=t,this.h()},l(r){e=v(r,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){d(e,"class","btn primary")},m(r,a){M(r,e,a),l||(n=$(e,"click",s[9]),l=!0)},p:me,d(r){r&&m(e),l=!1,n()}}}function ga(s){let e,t="Try Again",l,n,r="Clear",a,o;return{c(){e=_("button"),e.textContent=t,l=P(),n=_("button"),n.textContent=r,this.h()},l(c){e=v(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-y911ux"&&(e.textContent=t),l=V(c),n=v(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-11mnk9v"&&(n.textContent=r),this.h()},h(){d(e,"class","btn primary"),d(n,"class","btn primary")},m(c,i){M(c,e,i),M(c,l,i),M(c,n,i),a||(o=[$(e,"click",s[6]),$(n,"click",s[7])],a=!0)},p:me,d(c){c&&(m(e),m(l),m(n)),a=!1,rt(o)}}}function ba(s){let e,t,l,n;function r(f,p){return f[0]instanceof Dt&&(f[1]==="correct"||f[1]==="wrong")?ma:f[0]instanceof Ot&&(f[1]==="correct"||f[1]==="wrong")?ha:f[0]instanceof ft&&(f[1]==="correct"||f[1]==="wrong")?da:f[0]&&f[1]==="ended"?fa:f[2].length>0?ua:ca}let a=r(s),o=a(s);function c(f,p){return f[0]&&f[1]==="ended"?ga:f[0]&&f[3].autoplay?va:f[0]?_a:pa}let i=c(s),h=i(s);return{c(){e=_("div"),o.c(),l=P(),n=_("div"),h.c(),this.h()},l(f){e=v(f,"DIV",{class:!0});var p=I(e);o.l(p),p.forEach(m),l=V(f),n=v(f,"DIV",{class:!0});var b=I(n);h.l(b),b.forEach(m),this.h()},h(){d(e,"class",t=Ce(`${s[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),d(n,"class","mt-2 h-8")},m(f,p){M(f,e,p),o.m(e,null),M(f,l,p),M(f,n,p),h.m(n,null)},p(f,[p]){a===(a=r(f))&&o?o.p(f,p):(o.d(1),o=a(f),o&&(o.c(),o.m(e,null))),p&256&&t!==(t=Ce(`${f[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs")&&d(e,"class",t),i===(i=c(f))&&h?h.p(f,p):(h.d(1),h=i(f),h&&(h.c(),h.m(n,null)))},i:me,o:me,d(f){f&&(m(e),m(l),m(n)),o.d(),h.d()}}}const cl=s=>s.note,ul=s=>s.note;function ya(s,e,t){let l,n,r;de(s,bt,p=>t(1,l=p)),de(s,gt,p=>t(2,n=p)),de(s,dt,p=>t(3,r=p));let{game:a}=e;function o(){Se.nextGuess()}function c(){Se.setOptionValue("autoplay",!0),Se.nextGuess()}function i(){a instanceof ft?Se.play(a.type,a.opts):a&&Se.play(a.type,void 0)}function h(){Se.clearGame()}const f=()=>Se.setOptionValue("autoplay",!1);return s.$$set=p=>{t(8,e=Te(Te({},e),Ae(p))),"game"in p&&t(0,a=p.game)},e=Ae(e),[a,l,n,r,o,c,i,h,e,f]}class ka extends $e{constructor(e){super(),He(this,e,ya,ba,ze,{game:0})}}function fl(s,e,t){const l=s.slice();return l[15]=e[t].key,l[16]=e[t].value,l[17]=e[t].icon,l[19]=t,l}const Ea=s=>({}),dl=s=>({}),wa=s=>({}),hl=s=>({});function ml(s){let e,t,l,n,r,a,o,c,i,h,f;const p=s[12].header,b=Zl(p,s,s[11],dl);let g=ne(s[0]),y=[];for(let E=0;E<g.length;E+=1)y[E]=pl(fl(s,g,E));const N=E=>z(y[E],1,1,()=>{y[E]=null});return{c(){e=_("button"),l=P(),n=_("ul"),r=_("li"),b&&b.c(),a=P();for(let E=0;E<y.length;E+=1)y[E].c();this.h()},l(E){e=v(E,"BUTTON",{class:!0,tabindex:!0}),I(e).forEach(m),l=V(E),n=v(E,"UL",{class:!0});var O=I(n);r=v(O,"LI",{});var D=I(r);b&&b.l(D),D.forEach(m),a=V(O);for(let k=0;k<y.length;k+=1)y[k].l(O);O.forEach(m),this.h()},h(){d(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),d(e,"tabindex","-1"),d(n,"class",o=Ce(`items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(E,O){M(E,e,O),M(E,l,O),M(E,n,O),u(n,r),b&&b.m(r,null),u(n,a);for(let D=0;D<y.length;D+=1)y[D]&&y[D].m(n,null);i=!0,h||(f=$(e,"click",s[7]),h=!0)},p(E,O){if(s=E,b&&b.p&&(!i||O&2048)&&en(b,p,s,s[11],i?sn(p,s[11],O,Ea):tn(s[11]),dl),O&265){g=ne(s[0]);let D;for(D=0;D<g.length;D+=1){const k=fl(s,g,D);y[D]?(y[D].p(k,O),x(y[D],1)):(y[D]=pl(k),y[D].c(),x(y[D],1),y[D].m(n,null))}for(et(),D=g.length;D<y.length;D+=1)N(D);tt()}(!i||O&4&&o!==(o=Ce(`items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&d(n,"class",o)},i(E){if(!i){E&&Os(()=>{i&&(t||(t=qt(e,Bs,{duration:Jt},!0)),t.run(1))}),x(b,E);for(let O=0;O<g.length;O+=1)x(y[O]);E&&Os(()=>{i&&(c||(c=qt(n,Gs,{duration:Jt},!0)),c.run(1))}),i=!0}},o(E){E&&(t||(t=qt(e,Bs,{duration:Jt},!1)),t.run(0)),z(b,E),y=y.filter(Boolean);for(let O=0;O<y.length;O+=1)z(y[O]);E&&(c||(c=qt(n,Gs,{duration:Jt},!1)),c.run(0)),i=!1},d(E){E&&(m(e),m(l),m(n)),E&&t&&t.end(),b&&b.d(E),Be(y,E),E&&c&&c.end(),h=!1,f()}}}function Ca(s){let e;return{c(){e=_("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),I(e).forEach(m),this.h()},h(){d(e,"class","w-[24px]")},m(t,l){M(t,e,l)},p:me,i:me,o:me,d(t){t&&m(e)}}}function Ta(s){let e,t;return e=new Ze({props:{class:"mr-2",icon:s[17],width:16}}),{c(){ve(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const r={};n&1&&(r.icon=l[17]),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){z(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function pl(s){let e,t,l,n,r,a,o=s[16]+"",c,i,h,f,p;const b=[Ta,Ca],g=[];function y(E,O){return E[17]?0:1}l=y(s),n=g[l]=b[l](s);function N(){return s[13](s[15])}return{c(){e=_("li"),t=_("button"),n.c(),r=P(),a=_("div"),c=J(o),i=P(),this.h()},l(E){e=v(E,"LI",{});var O=I(e);t=v(O,"BUTTON",{class:!0});var D=I(t);n.l(D),r=V(D),a=v(D,"DIV",{});var k=I(a);c=Y(k,o),k.forEach(m),D.forEach(m),i=V(O),O.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),H(t,"selected",s[15]===s[3])},m(E,O){M(E,e,O),u(e,t),g[l].m(t,null),u(t,r),u(t,a),u(a,c),u(e,i),h=!0,f||(p=$(t,"click",N),f=!0)},p(E,O){s=E;let D=l;l=y(s),l===D?g[l].p(s,O):(et(),z(g[D],1,1,()=>{g[D]=null}),tt(),n=g[l],n?n.p(s,O):(n=g[l]=b[l](s),n.c()),x(n,1),n.m(t,r)),(!h||O&1)&&o!==(o=s[16]+"")&&ae(c,o),(!h||O&9)&&H(t,"selected",s[15]===s[3])},i(E){h||(x(n),h=!0)},o(E){z(n),h=!1},d(E){E&&m(e),g[l].d(),f=!1,p()}}}function Aa(s){let e,t,l,n,r,a,o,c,i;const h=s[12].value,f=Zl(h,s,s[11],hl);let p=s[6]&&ml(s);return{c(){e=_("div"),t=_("button"),f&&f.c(),r=P(),p&&p.c(),this.h()},l(b){e=v(b,"DIV",{class:!0,id:!0});var g=I(e);t=v(g,"BUTTON",{class:!0,title:!0});var y=I(t);f&&f.l(y),y.forEach(m),r=V(g),p&&p.l(g),g.forEach(m),this.h()},h(){d(t,"class",l=Ce(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),d(t,"title",n=s[9].title||""),H(t,"disabled",s[4]),H(t,"open",s[6]),d(e,"class",a=Ce(`relative ${s[2]||""}`)+" svelte-h65upg"),d(e,"id",s[1])},m(b,g){M(b,e,g),u(e,t),f&&f.m(t,null),u(e,r),p&&p.m(e,null),s[14](e),o=!0,c||(i=$(t,"click",s[7]),c=!0)},p(b,[g]){f&&f.p&&(!o||g&2048)&&en(f,h,b,b[11],o?sn(h,b[11],g,wa):tn(b[11]),hl),(!o||g&512&&l!==(l=Ce(`${b[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&d(t,"class",l),(!o||g&512&&n!==(n=b[9].title||""))&&d(t,"title",n),(!o||g&528)&&H(t,"disabled",b[4]),(!o||g&576)&&H(t,"open",b[6]),b[6]?p?(p.p(b,g),g&64&&x(p,1)):(p=ml(b),p.c(),x(p,1),p.m(e,null)):p&&(et(),z(p,1,1,()=>{p=null}),tt()),(!o||g&4&&a!==(a=Ce(`relative ${b[2]||""}`)+" svelte-h65upg"))&&d(e,"class",a),(!o||g&2)&&d(e,"id",b[1])},i(b){o||(x(f,b),x(p),o=!0)},o(b){z(f,b),z(p),o=!1},d(b){b&&m(e),f&&f.d(b),p&&p.d(),s[14](null),c=!1,i()}}}const Jt=400;function Ia(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:r,id:a=void 0,containerClass:o=void 0,selected:c=void 0,disabled:i=void 0,onSelect:h}=e,f,p=!1;function b(){i||t(6,p=!p)}function g(E){t(6,p=h(E))}const y=E=>g(E);function N(E){ln[E?"unshift":"push"](()=>{f=E,t(5,f)})}return s.$$set=E=>{t(9,e=Te(Te({},e),Ae(E))),"options"in E&&t(0,r=E.options),"id"in E&&t(1,a=E.id),"containerClass"in E&&t(2,o=E.containerClass),"selected"in E&&t(3,c=E.selected),"disabled"in E&&t(4,i=E.disabled),"onSelect"in E&&t(10,h=E.onSelect),"$$scope"in E&&t(11,n=E.$$scope)},e=Ae(e),[r,a,o,c,i,f,p,b,g,e,h,n,l,y,N]}class dn extends $e{constructor(e){super(),He(this,e,Ia,Aa,ze,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function Sa(s){let e,t,l,n,r,a,o;return{c(){e=_("label"),t=_("input"),l=P(),n=_("div"),this.h()},l(c){e=v(c,"LABEL",{class:!0});var i=I(e);t=v(i,"INPUT",{type:!0,class:!0}),l=V(i),n=v(i,"DIV",{class:!0}),I(n).forEach(m),i.forEach(m),this.h()},h(){t.checked=s[0],d(t,"type","checkbox"),d(t,"class","svelte-1d3k63a"),d(n,"class","slider svelte-1d3k63a"),d(e,"class",r=Ce(`${s[3].class||""} toggle`)+" svelte-1d3k63a")},m(c,i){M(c,e,i),u(e,t),s[5](t),u(e,l),u(e,n),a||(o=[$(t,"change",s[4]),$(t,"keydown",s[2])],a=!0)},p(c,[i]){i&1&&(t.checked=c[0]),i&8&&r!==(r=Ce(`${c[3].class||""} toggle`)+" svelte-1d3k63a")&&d(e,"class",r)},i:me,o:me,d(c){c&&m(e),s[5](null),a=!1,rt(o)}}}function Na(s,e,t){let{checked:l}=e,n;function r(c){c.key==="Enter"&&n.click()}function a(c){ns.call(this,s,c)}function o(c){ln[c?"unshift":"push"](()=>{n=c,t(1,n)})}return s.$$set=c=>{t(3,e=Te(Te({},e),Ae(c))),"checked"in c&&t(0,l=c.checked)},e=Ae(e),[l,n,r,e,a,o]}class La extends $e{constructor(e){super(),He(this,e,Na,Sa,ze,{checked:0})}}function _l(s){let e;return{c(){e=_("li"),this.h()},l(t){e=v(t,"LI",{class:!0}),I(e).forEach(m),this.h()},h(){d(e,"class","m-[0.175rem] mr-0")},m(t,l){M(t,e,l)},d(t){t&&m(e)}}}function vl(s){let e;return{c(){e=_("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),I(e).forEach(m),this.h()},h(){d(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,l){M(t,e,l)},d(t){t&&m(e)}}}function gl(s){let e,t=s[0].note.note+"",l,n;return{c(){e=_("div"),l=J(t),n=J(s[2]),this.h()},l(r){e=v(r,"DIV",{class:!0});var a=I(e);l=Y(a,t),n=Y(a,s[2]),a.forEach(m),this.h()},h(){d(e,"class","absolute top-0 left-0")},m(r,a){M(r,e,a),u(e,l),u(e,n)},p(r,a){a&1&&t!==(t=r[0].note.note+"")&&ae(l,t),a&4&&ae(n,r[2])},d(r){r&&m(e)}}}function Da(s){let e,t,l,n,r,a,o=yl(s[0].key)+"",c,i,h,f,p=s[0].key==="{enter}"&&_l(),b=s[0].key==="{enter}"&&vl(),g=s[0].note&&gl(s);return{c(){p&&p.c(),e=P(),t=_("li"),l=_("button"),b&&b.c(),n=P(),g&&g.c(),r=P(),a=_("div"),c=J(o),this.h()},l(y){p&&p.l(y),e=V(y),t=v(y,"LI",{class:!0});var N=I(t);l=v(N,"BUTTON",{class:!0});var E=I(l);b&&b.l(E),n=V(E),g&&g.l(E),r=V(E),a=v(E,"DIV",{});var O=I(a);c=Y(O,o),O.forEach(m),E.forEach(m),N.forEach(m),this.h()},h(){d(l,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),H(l,"items-center",!s[0].note),H(l,"items-end",s[0].note),d(t,"class",i=Ce(`${s[3].class||""} m-[0.175rem] ${bl(s[0].size)}`)+" svelte-1479mcy"),H(t,"enter",s[0].key==="{enter}"),H(t,"captured",s[1])},m(y,N){p&&p.m(y,N),M(y,e,N),M(y,t,N),u(t,l),b&&b.m(l,null),u(l,n),g&&g.m(l,null),u(l,r),u(l,a),u(a,c),h||(f=$(l,"click",s[5]),h=!0)},p(y,[N]){y[0].key==="{enter}"?p||(p=_l(),p.c(),p.m(e.parentNode,e)):p&&(p.d(1),p=null),y[0].key==="{enter}"?b||(b=vl(),b.c(),b.m(l,n)):b&&(b.d(1),b=null),y[0].note?g?g.p(y,N):(g=gl(y),g.c(),g.m(l,r)):g&&(g.d(1),g=null),N&1&&o!==(o=yl(y[0].key)+"")&&ae(c,o),N&1&&H(l,"items-center",!y[0].note),N&1&&H(l,"items-end",y[0].note),N&9&&i!==(i=Ce(`${y[3].class||""} m-[0.175rem] ${bl(y[0].size)}`)+" svelte-1479mcy")&&d(t,"class",i),N&9&&H(t,"enter",y[0].key==="{enter}"),N&11&&H(t,"captured",y[1])},i:me,o:me,d(y){y&&(m(e),m(t)),p&&p.d(y),b&&b.d(),g&&g.d(),h=!1,f()}}}function bl(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function yl(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function ja(s,e,t){let l,n;de(s,as,c=>t(4,n=c));let{value:r,captured:a}=e;function o(c){ns.call(this,s,c)}return s.$$set=c=>{t(3,e=Te(Te({},e),Ae(c))),"value"in c&&t(0,r=c.value),"captured"in c&&t(1,a=c.captured)},s.$$.update=()=>{s.$$.dirty&17&&t(2,l=Ts(r.note?r.note.semitones+n[0]:0))},e=Ae(e),[r,a,l,e,n,o]}class Pa extends $e{constructor(e){super(),He(this,e,ja,Da,ze,{value:0,captured:1})}}const ks={ar:{name:"Arabic",import:fe(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:fe(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:fe(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:fe(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:fe(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:fe(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:fe(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:fe(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:fe(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>Va)},fa:{name:"Farsi",import:fe(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:fe(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:fe(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:fe(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:fe(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:fe(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:fe(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:fe(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:fe(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:fe(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:fe(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:fe(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:fe(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:fe(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:fe(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:fe(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:fe(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:fe(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:fe(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:fe(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:fe(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:fe(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:fe(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:fe(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function hn(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default,shift:s.layout.shift}}async function mn(s=["en"]){let e={code:"en",layout:ks.en,index:99};Object.entries(ks).forEach(([l,n])=>{for(let r=0;r<s.length;r+=1)l===s[r]&&(!e||e.index>r)&&(e={code:l,layout:n,index:r})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:hn(t.default)}}const pn={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Va=Object.freeze(Object.defineProperty({__proto__:null,default:pn},Symbol.toStringTag,{value:"Module"}));function Oa(s,e){return s[1].forEach((t,l)=>{let n;l===2?n={...e[1]}:l===3?n={...e[3]}:l===5?n={...e[6]}:l===6?n={...e[8]}:l===7?n={...e[10]}:l===9?(n={...e[1]},n.semitones+=12):l===10?(n={...e[3]},n.semitones+=12):l===12&&(n={...e[6]},n.semitones+=12),s[1][l].note=n}),s[2].forEach((t,l)=>{let n;l===1?n={...e[0]}:l===2?n={...e[2]}:l===3?n={...e[4]}:l===4?n={...e[5]}:l===5?n={...e[7]}:l===6?n={...e[9]}:l===7?n={...e[11]}:l===8?(n={...e[0]},n.semitones+=12):l===9?(n={...e[2]},n.semitones+=12):l===10?(n={...e[4]},n.semitones+=12):l===11?(n={...e[5]},n.semitones+=12):l===12&&(n={...e[7]},n.semitones+=12),s[2][l].note=n}),s}const Yt=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function Ba(s){let e=[];const t=s.default.map((l,n)=>{if(n===0){const r=l.split(" ").filter(a=>a!=="{bksp}");for(;r.length!==13;)r.length<13?r.unshift("{empty}"):r.shift();return[...r,"{bksp}"]}else if(n===1){const r=l.split(" ");return e=r.slice(13),[...r.slice(0,13),"{enter}"]}else{if(n===2)return[...l.split(" ").slice(0,13).filter(r=>r!=="{enter}"),...e].slice(0,13);if(n===3){const r=["{shift}",...l.split(" ").slice(1,12).filter(o=>o!=="{shift}"),"{shift}"];let a=1;for(;r.length<13;)r.splice(a,0,"{empty}"),a=a===1?-1:1;return r}else return l.split(" ")}});return[t[0].map((l,n)=>({key:l,code:Yt[0][n]})),t[1].map((l,n)=>({key:l,code:Yt[1][n]})),t[2].map((l,n)=>({key:l,code:Yt[2][n]})),t[3].map((l,n)=>({key:l,code:Yt[3][n]}))]}class ls{constructor(e){return this.rows=[[],[],[],[]],this.opts={hotkeydRows:"middle-row",layout:{code:"en",name:"English",imported:hn(pn)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=Ba(e),this}setRows(e){return this.rows=e,this}setRowHotkeys(e,t){}setNotes(e){if(this.opts.hotkeydRows==="middle-row")this.rows=Oa(this.rows,e);else throw Error("not implemented")}static createWithRows(e,t){return new ls(e).setRows(t)}}const Ss=/^[a-gA-G]$/,_n=/^[♭Bb#♯sS]$/,Ga=/^[0-9]$/;let W="",ut;function Ma(s,e){const{useHotkeys:t}=Ee(at),l=Ee(rs).get(s);if(t&&W.length===0&&l&&l.note)return W="",{e:"guessed-key",data:l.note.note};if(!t&&W.length===0&&Ss.test(e))return W+=e.toUpperCase(),{e:"string",data:W};if(!t&&W.length>0&&_n.test(e))return e==="b"||e==="B"?W+="♭":W+="♯",{e:"string",data:W};if(s==="Backspace"&&W.length>0)return W=W.slice(0,-1),{e:"string",data:W};if(s==="Enter"&&W.length>0){const n=W;return W="",{e:"guessed-key",data:n}}return!1}function Ra(s,e){if(s==="Enter"&&W.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let l=0;l<W.length;l+=1)l===0?t.note+=W[l]:t.chord.length>0?t.chord+=W[l].toLowerCase():W[l]==="♭"?(t.note+=W[l],t.flats+=1):W[l]==="♯"?(t.note+=W[l],t.sharps+=1):t.chord+=W[l].toLowerCase();return W="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&W.length>0)return W=W.slice(0,-1),{e:"string",data:W};if(W.length===0&&Ss.test(e))return W+=e.toUpperCase(),{e:"string",data:W};if(W.length>0&&e.length===1)return W.length===1&&(e==="b"||e==="B")?W+="♭":W.length===1&&e==="#"?W+="♯":W+=e,{e:"string",data:W}}return!1}function Ua(s,e,t){const{useAutoOctave:l,useHotkeys:n}=Ee(at);let r;const o=Ee(rs).get(s),c=(o==null?void 0:o.key)||"";let i=!1;if(!ut&&n&&(o!=null&&o.note)?(ut=o.note,l&&(r=Ts(Ee(ss)[0].midi)),i="note"):!n&&W.length===0&&Ss.test(e)?(W+=e.toUpperCase(),i="input"):!n&&W.length>0&&_n.test(e)&&(e==="b"||e==="B"?W+="♭":W+="♯",i="input"),Ga.test(c))try{r=parseInt(c)}catch{}if(ut&&r!==void 0){const h=ut.semitones+(r+1+(t?1:0))*12;return ut=void 0,{e:"guessed-note",data:h}}else if(W&&r!==void 0){const h=Lt.findNote(W),f=h?h.semitones+(r+1)*12:void 0;return ut=void 0,W="",f!==void 0?{e:"guessed-note",data:f}:{e:"string",data:W}}else if(s==="Backspace"&&(ut||W.length>0))return ut=void 0,W=W.slice(0,-1),{e:"string",data:W};return i==="note"?{e:"note",data:ut}:i==="input"?{e:"string",data:W}:!1}const Ka={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},ps=[],Et=Ue(void 0);Ct(Et,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const yt=ht(Ue({useCustom:!1,customLayout:[[],[],[],[]],kbdOpts:{layout:Ka,hotkeydRows:"middle-row"}}),{key:"keyboard-settings"}),Ns=Ct([jt,yt],([s,e])=>{let t;return e.useCustom&&e.customLayout?t=ls.createWithRows(e.kbdOpts,e.customLayout):t=new ls(e.kbdOpts),t.setNotes(Array.from(s.notesMap.values())),t}),Fa=Ct(Ns,s=>s.rows.map(e=>e.map((t,l)=>{let n;return t.key==="{bksp}"?n=2:t.key==="{tab}"?n=1.5:t.key==="{enter}"?n=2:t.key==="{lock}"?n=1.75:t.key==="{shift}"&&l===0?n=1.5:t.key==="{shift}"&&(n=2.5),n?{...t,size:n}:t}))),rs=Ct(Ns,s=>new Map([...s.rows[0].map(e=>[e.code,e]),...s.rows[1].map(e=>[e.code,e]),...s.rows[2].map(e=>[e.code,e]),...s.rows[3].map(e=>[e.code,e])])),xa=Ct(rs,s=>Array.from(s.values()).map(e=>e.note).filter(e=>e!==void 0)),Lt={async setLayout(s){const e=await mn([s]);yt.update(t=>({...t,layout:e}))},setCustomLayout(s){if(s){const e=Ee(Ns);yt.update(t=>({...t,useCustom:s,customLayout:t.customLayout.map((l,n)=>l.length===0?e.rows[n].map(r=>({...r})):l)}))}else yt.update(e=>({...e,useCustom:s}))},toggleRows(){yt.update(s=>({...s,kbdOpts:{...s.kbdOpts,hotkeydRows:s.kbdOpts.hotkeydRows==="middle-row"?"two-rows":"middle-row"}}))},captureHotkeyRow(s){let e=-1,t=0;const l=Ee(yt).customLayout[s].map((n,r)=>(n.key.charAt(0)!=="{"&&e===-1&&(e=r),t+=n.key.charAt(0)!=="{"?1:0,n));console.log("count",t),Et.set({row:l,nextIndex:e,rowIndex:s,count:t})},findNote(s){return Ee(xa).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((l,n)=>l+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleInput(s,e,t=!1){const l=Ee(kt),n=Ee(Et);if(n){console.log("capturing ",ps.length);const{nextIndex:r,row:a}=n;return s==="Escape"?Et.set(void 0):ps.find(c=>c.code===s)||(ps.push({code:s,key:e}),a[r]={...a[r],code:s,key:e},r===n.count?(yt.update(c=>({...c,customLayout:c.customLayout.map((i,h)=>h!==n.rowIndex?i:a)})),Et.set(void 0)):Et.set({...n,nextIndex:r+1,row:a})),!1}else{if(l instanceof Ot)return Ma(s,e.toUpperCase());if(l instanceof ft&&l.type==="chords-write")return Ra(s,e);if(Ee(at).useKeyboard)return Ua(s,e.toUpperCase(),t)}return!1}};function kl(s,e,t){const l=s.slice();return l[13]=e[t],l[15]=t,l}function El(s,e,t){const l=s.slice();return l[16]=e[t],l[18]=t,l}function $a(s){let e,t=s[0].kbdOpts.layout.name+"",l;return{c(){e=_("div"),l=J(t),this.h()},l(n){e=v(n,"DIV",{slot:!0});var r=I(e);l=Y(r,t),r.forEach(m),this.h()},h(){d(e,"slot","value")},m(n,r){M(n,e,r),u(e,l)},p(n,r){r&1&&t!==(t=n[0].kbdOpts.layout.name+"")&&ae(l,t)},d(n){n&&m(e)}}}function wl(s){let e,t,l,n,r;t=new Ze({props:{icon:An,width:20}});function a(){return s[11](s[15])}return{c(){e=_("button"),ve(t.$$.fragment),this.h()},l(o){e=v(o,"BUTTON",{class:!0});var c=I(e);ge(t.$$.fragment,c),c.forEach(m),this.h()},h(){d(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(o,c){M(o,e,c),be(t,e,null),l=!0,n||(r=$(e,"click",a),n=!0)},p(o,c){s=o},i(o){l||(x(t.$$.fragment,o),l=!0)},o(o){z(t.$$.fragment,o),l=!1},d(o){o&&m(e),ye(t),n=!1,r()}}}function Cl(s){let e,t;return e=new Pa({props:{value:s[16],captured:s[4]&&s[4].rowIndex===s[15]&&s[4].nextIndex===s[18]||!1}}),{c(){ve(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const r={};n&2&&(r.value=l[16]),n&16&&(r.captured=l[4]&&l[4].rowIndex===l[15]&&l[4].nextIndex===l[18]||!1),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){z(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function Tl(s){let e,t,l,n,r=s[3][s[15]]&&wl(s),a=ne(s[13]),o=[];for(let i=0;i<a.length;i+=1)o[i]=Cl(El(s,a,i));const c=i=>z(o[i],1,1,()=>{o[i]=null});return{c(){e=_("li"),r&&r.c(),t=P();for(let i=0;i<o.length;i+=1)o[i].c();l=Ge(),this.h()},l(i){e=v(i,"LI",{class:!0});var h=I(e);r&&r.l(h),h.forEach(m),t=V(i);for(let f=0;f<o.length;f+=1)o[f].l(i);l=Ge(),this.h()},h(){d(e,"class","col-span-2 svelte-12ix7fc")},m(i,h){M(i,e,h),r&&r.m(e,null),M(i,t,h);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(i,h);M(i,l,h),n=!0},p(i,h){if(i[3][i[15]]?r?(r.p(i,h),h&8&&x(r,1)):(r=wl(i),r.c(),x(r,1),r.m(e,null)):r&&(et(),z(r,1,1,()=>{r=null}),tt()),h&18){a=ne(i[13]);let f;for(f=0;f<a.length;f+=1){const p=El(i,a,f);o[f]?(o[f].p(p,h),x(o[f],1)):(o[f]=Cl(p),o[f].c(),x(o[f],1),o[f].m(l.parentNode,l))}for(et(),f=a.length;f<o.length;f+=1)c(f);tt()}},i(i){if(!n){x(r);for(let h=0;h<a.length;h+=1)x(o[h]);n=!0}},o(i){z(r),o=o.filter(Boolean);for(let h=0;h<o.length;h+=1)z(o[h]);n=!1},d(i){i&&(m(e),m(t),m(l)),r&&r.d(),Be(o,i)}}}function Ha(s){let e,t,l,n,r,a,o,c,i="Layout",h,f,p,b,g,y="Custom",N,E,O,D,k,L,S="One row",j,G,w,B,A="Two rows",C,T,R,K,F,ce,ue;n=new Ze({props:{icon:ws,width:16}}),f=new dn({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1",options:s[5],onSelect:s[6],$$slots:{value:[$a]},$$scope:{ctx:s}}}),G=new La({props:{checked:!s[2]}}),G.$on("change",s[9]);let se=ne(s[1]),Q=[];for(let X=0;X<se.length;X+=1)Q[X]=Tl(kl(s,se,X));const ke=X=>z(Q[X],1,1,()=>{Q[X]=null});return{c(){e=_("div"),t=_("div"),l=_("button"),ve(n.$$.fragment),r=P(),a=_("div"),o=_("div"),c=_("label"),c.textContent=i,h=P(),ve(f.$$.fragment),p=P(),b=_("div"),g=_("label"),g.textContent=y,N=P(),E=_("input"),D=P(),k=_("div"),L=_("label"),L.textContent=S,j=P(),ve(G.$$.fragment),w=P(),B=_("label"),B.textContent=A,C=P(),T=_("div"),R=_("ul");for(let X=0;X<Q.length;X+=1)Q[X].c();this.h()},l(X){e=v(X,"DIV",{class:!0});var re=I(e);t=v(re,"DIV",{class:!0});var Ie=I(t);l=v(Ie,"BUTTON",{class:!0});var he=I(l);ge(n.$$.fragment,he),he.forEach(m),Ie.forEach(m),r=V(re),a=v(re,"DIV",{class:!0});var ie=I(a);o=v(ie,"DIV",{class:!0});var Ve=I(o);c=v(Ve,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(c)!=="svelte-1xsr9lq"&&(c.textContent=i),h=V(Ve),ge(f.$$.fragment,Ve),Ve.forEach(m),p=V(ie),b=v(ie,"DIV",{class:!0});var Ne=I(b);g=v(Ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(g)!=="svelte-11aw8ub"&&(g.textContent=y),N=V(Ne),E=v(Ne,"INPUT",{class:!0,id:!0,type:!0}),Ne.forEach(m),D=V(ie),k=v(ie,"DIV",{class:!0});var le=I(k);L=v(le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(L)!=="svelte-17p0yvw"&&(L.textContent=S),j=V(le),ge(G.$$.fragment,le),w=V(le),B=v(le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(B)!=="svelte-1wr3nwv"&&(B.textContent=A),le.forEach(m),ie.forEach(m),C=V(re),T=v(re,"DIV",{class:!0});var De=I(T);R=v(De,"UL",{class:!0});var pe=I(R);for(let q=0;q<Q.length;q+=1)Q[q].l(pe);pe.forEach(m),De.forEach(m),re.forEach(m),this.h()},h(){d(l,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),d(t,"class","absolute top-[0] right-[0] flex"),d(c,"class","font-bold mr-4"),d(c,"for","middle-row"),d(o,"class","my-1 flex items-center justify-between mr-2"),d(g,"class","font-bold mr-4"),d(g,"for","custom-layout"),d(E,"class","h-[20px]"),d(E,"id","custom-layout"),d(E,"type","checkbox"),E.checked=O=s[0].useCustom,d(b,"class","my-1 flex items-center justify-between mr-12"),d(L,"class","font-bold mr-4"),d(L,"for","two-rows"),d(B,"class","font-bold ml-4"),d(B,"for","two-rows"),d(k,"class","my-1 flex items-center justify-between mr-12"),d(a,"class","flex"),d(R,"class","keyboard svelte-12ix7fc"),d(T,"class","flex flex-col gap-1.5"),d(e,"class",K=Ce(`${s[10].class||""} relative`)+" svelte-12ix7fc")},m(X,re){M(X,e,re),u(e,t),u(t,l),be(n,l,null),u(e,r),u(e,a),u(a,o),u(o,c),u(o,h),be(f,o,null),u(a,p),u(a,b),u(b,g),u(b,N),u(b,E),u(a,D),u(a,k),u(k,L),u(k,j),be(G,k,null),u(k,w),u(k,B),u(e,C),u(e,T),u(T,R);for(let Ie=0;Ie<Q.length;Ie+=1)Q[Ie]&&Q[Ie].m(R,null);F=!0,ce||(ue=[$(l,"click",za),$(E,"change",s[7])],ce=!0)},p(X,[re]){const Ie={};re&524289&&(Ie.$$scope={dirty:re,ctx:X}),f.$set(Ie),(!F||re&1&&O!==(O=X[0].useCustom))&&(E.checked=O);const he={};if(re&4&&(he.checked=!X[2]),G.$set(he),re&282){se=ne(X[1]);let ie;for(ie=0;ie<se.length;ie+=1){const Ve=kl(X,se,ie);Q[ie]?(Q[ie].p(Ve,re),x(Q[ie],1)):(Q[ie]=Tl(Ve),Q[ie].c(),x(Q[ie],1),Q[ie].m(R,null))}for(et(),ie=se.length;ie<Q.length;ie+=1)ke(ie);tt()}(!F||re&1024&&K!==(K=Ce(`${X[10].class||""} relative`)+" svelte-12ix7fc"))&&d(e,"class",K)},i(X){if(!F){x(n.$$.fragment,X),x(f.$$.fragment,X),x(G.$$.fragment,X);for(let re=0;re<se.length;re+=1)x(Q[re]);F=!0}},o(X){z(n.$$.fragment,X),z(f.$$.fragment,X),z(G.$$.fragment,X),Q=Q.filter(Boolean);for(let re=0;re<Q.length;re+=1)z(Q[re]);F=!1},d(X){X&&m(e),ye(n),ye(f),ye(G),Be(Q,X),ce=!1,rt(ue)}}}function za(){}function qa(s,e,t){let l,n,r,a,o,c;de(s,yt,y=>t(0,r=y)),de(s,Fa,y=>t(1,a=y)),de(s,rs,y=>t(12,o=y)),de(s,Et,y=>t(4,c=y)),nn(async()=>{console.log(o);const y=await mn(["sw"]);console.log(y),window.layout=y});const i=Object.entries(ks).map(([y,N])=>({key:y,value:N.name}));function h(y){return Lt.setLayout(y),!1}function f(y){Lt.setCustomLayout(y.currentTarget.checked)}function p(y){Lt.captureHotkeyRow(y)}function b(){Lt.toggleRows()}const g=y=>p(y);return s.$$set=y=>{t(10,e=Te(Te({},e),Ae(y)))},s.$$.update=()=>{s.$$.dirty&3&&t(3,l=a.map((y,N)=>r.kbdOpts.hotkeydRows==="middle-row"?N===1||N===2:!0)),s.$$.dirty&1&&t(2,n=r.kbdOpts.hotkeydRows==="middle-row")},e=Ae(e),[r,a,n,l,c,i,h,f,p,b,e,g]}class Wa extends $e{constructor(e){super(),He(this,e,qa,Ha,ze,{})}}function Al(s){let e,t;return e=new Wa({props:{class:"mt-4"}}),{c(){ve(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){z(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function Ja(s){let e,t,l,n,r="I/O",a,o,c,i,h="Device",f,p,b,g,y,N,E="Prompt",O,D,k="Disable",L,S,j,G,w="Sound",B,A,C,T,R,K,F="Fixed velocity",ce,ue,se,Q,ke,X,re="Keyboard",Ie,he,ie,Ve,Ne,le,De="Hotkeys",pe,q,oe,U,Z,_e,te="Auto-octave",Le,Me,ot,Je,Ke,Oe,je,Pt="Set hotkeys",Tt,Fe,mt,Ls="Fade timeout",os,it,is,pt,Bt,cs,_t,Ds="Reset all",us,Gt,Ye,fs,js,Re=s[2]&&Al();return{c(){e=_("div"),t=_("fieldset"),l=_("legend"),n=_("button"),n.textContent=r,a=P(),o=_("div"),c=_("div"),i=_("label"),i.textContent=h,f=P(),p=_("input"),g=P(),y=_("div"),N=_("button"),N.textContent=E,O=P(),D=_("button"),D.textContent=k,L=P(),S=_("div"),j=_("div"),G=_("label"),G.textContent=w,B=P(),A=_("input"),T=P(),R=_("div"),K=_("label"),K.textContent=F,ce=P(),ue=_("input"),se=P(),Q=_("div"),ke=_("div"),X=_("label"),X.textContent=re,Ie=P(),he=_("input"),Ve=P(),Ne=_("div"),le=_("label"),le.textContent=De,pe=P(),q=_("input"),U=P(),Z=_("div"),_e=_("label"),_e.textContent=te,Le=P(),Me=_("input"),Je=P(),Ke=_("div"),Oe=_("div"),je=_("button"),je.textContent=Pt,Tt=P(),Fe=_("div"),mt=_("label"),mt.textContent=Ls,os=P(),it=_("input"),is=P(),pt=_("div"),Bt=_("div"),cs=P(),_t=_("button"),_t.textContent=Ds,us=P(),Re&&Re.c(),this.h()},l(Pe){e=v(Pe,"DIV",{class:!0});var xe=I(e);t=v(xe,"FIELDSET",{class:!0});var ct=I(t);l=v(ct,"LEGEND",{class:!0});var Ps=I(l);n=v(Ps,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1jbbsti"&&(n.textContent=r),Ps.forEach(m),a=V(ct),o=v(ct,"DIV",{class:!0});var vt=I(o);c=v(vt,"DIV",{class:!0});var At=I(c);i=v(At,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(i)!=="svelte-crpa7y"&&(i.textContent=h),f=V(At),p=v(At,"INPUT",{class:!0,id:!0}),g=V(At),y=v(At,"DIV",{class:!0});var Mt=I(y);N=v(Mt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(N)!=="svelte-mj6mct"&&(N.textContent=E),O=V(Mt),D=v(Mt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(D)!=="svelte-1sl6oxh"&&(D.textContent=k),Mt.forEach(m),At.forEach(m),L=V(vt),S=v(vt,"DIV",{class:!0});var Rt=I(S);j=v(Rt,"DIV",{class:!0});var Ut=I(j);G=v(Ut,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(G)!=="svelte-wgxtkw"&&(G.textContent=w),B=V(Ut),A=v(Ut,"INPUT",{class:!0,id:!0,type:!0}),Ut.forEach(m),T=V(Rt),R=v(Rt,"DIV",{class:!0});var Kt=I(R);K=v(Kt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(K)!=="svelte-1tm2bth"&&(K.textContent=F),ce=V(Kt),ue=v(Kt,"INPUT",{class:!0,id:!0,placeholder:!0}),Kt.forEach(m),Rt.forEach(m),se=V(vt),Q=v(vt,"DIV",{class:!0});var It=I(Q);ke=v(It,"DIV",{class:!0});var Ft=I(ke);X=v(Ft,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(X)!=="svelte-1js269u"&&(X.textContent=re),Ie=V(Ft),he=v(Ft,"INPUT",{class:!0,id:!0,type:!0}),Ft.forEach(m),Ve=V(It),Ne=v(It,"DIV",{class:!0});var xt=I(Ne);le=v(xt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(le)!=="svelte-21h39k"&&(le.textContent=De),pe=V(xt),q=v(xt,"INPUT",{class:!0,id:!0,type:!0}),xt.forEach(m),U=V(It),Z=v(It,"DIV",{class:!0});var $t=I(Z);_e=v($t,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(_e)!=="svelte-33lczu"&&(_e.textContent=te),Le=V($t),Me=v($t,"INPUT",{class:!0,id:!0,type:!0}),$t.forEach(m),It.forEach(m),Je=V(vt),Ke=v(vt,"DIV",{class:!0});var St=I(Ke);Oe=v(St,"DIV",{class:!0});var Vs=I(Oe);je=v(Vs,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(je)!=="svelte-1v9okg9"&&(je.textContent=Pt),Vs.forEach(m),Tt=V(St),Fe=v(St,"DIV",{class:!0});var Ht=I(Fe);mt=v(Ht,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(mt)!=="svelte-vd5i27"&&(mt.textContent=Ls),os=V(Ht),it=v(Ht,"INPUT",{class:!0,id:!0}),Ht.forEach(m),is=V(St),pt=v(St,"DIV",{class:!0});var zt=I(pt);Bt=v(zt,"DIV",{}),I(Bt).forEach(m),cs=V(zt),_t=v(zt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(_t)!=="svelte-jjt0c3"&&(_t.textContent=Ds),zt.forEach(m),St.forEach(m),vt.forEach(m),us=V(ct),Re&&Re.l(ct),ct.forEach(m),xe.forEach(m),this.h()},h(){var Pe;d(n,"class","px-1 rounded hover:bg-gray-100"),d(l,"class","text-base"),d(i,"class","font-bold"),d(i,"for","device"),d(p,"class","px-1 my-1 rounded w-50"),d(p,"id","device"),p.disabled=!0,p.value=b=((Pe=s[5])==null?void 0:Pe.name)??"No device",d(N,"class","btn-sm primary mr-2"),d(D,"class","btn-sm primary"),d(y,"class","flex my-[auto]"),d(c,"class","h-full flex flex-col"),d(G,"class","font-bold"),d(G,"for","sound"),d(A,"class","h-[20px]"),d(A,"id","sound"),d(A,"type","checkbox"),A.checked=C=s[3].useSound,d(j,"class","my-1 flex justify-between mr-12"),d(K,"class","font-bold"),d(K,"for","fixed-velocity"),d(ue,"class","h-[20px] w-16"),d(ue,"id","fixed-velocity"),d(ue,"placeholder","0-127"),d(R,"class","flex justify-between"),d(S,"class","flex flex-col h-full"),d(X,"class","font-bold"),d(X,"for","keyboard"),d(he,"class","h-[20px]"),d(he,"id","keyboard"),d(he,"type","checkbox"),he.checked=ie=s[3].useKeyboard,d(ke,"class","my-1 flex justify-between mr-12"),d(le,"class","font-bold"),d(le,"for","hotkeys"),d(q,"class","h-[20px]"),d(q,"id","hotkeys"),d(q,"type","checkbox"),q.checked=oe=s[3].useHotkeys,d(Ne,"class","my-1 flex justify-between mr-12"),d(_e,"class","font-bold"),d(_e,"for","auto-octave"),d(Me,"class","h-[20px]"),d(Me,"id","auto-octave"),d(Me,"type","checkbox"),Me.checked=ot=s[3].useAutoOctave,d(Z,"class","my-1 flex justify-between mr-12"),d(Q,"class","flex flex-col h-full"),d(je,"class","w-full btn-sm primary"),d(Oe,"class","flex justify-between"),d(mt,"class","font-bold"),d(mt,"for","fade-timeout"),d(it,"class","h-[20px] w-16"),d(it,"id","fade-timeout"),it.value=s[1],d(Fe,"class","flex justify-between"),d(_t,"class","btn-sm primary"),d(pt,"class","flex justify-between"),d(Ke,"class","flex flex-col justify-between h-full"),d(o,"class","body svelte-1bpw69s"),H(o,"hidden",s[4]),d(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),H(t,"collapsed",s[4]),d(e,"class",Gt=Ce(`${s[11].class||""}`)+" svelte-1bpw69s")},m(Pe,xe){M(Pe,e,xe),u(e,t),u(t,l),u(l,n),u(t,a),u(t,o),u(o,c),u(c,i),u(c,f),u(c,p),u(c,g),u(c,y),u(y,N),u(y,O),u(y,D),u(o,L),u(o,S),u(S,j),u(j,G),u(j,B),u(j,A),u(S,T),u(S,R),u(R,K),u(R,ce),u(R,ue),Qe(ue,s[0]),u(o,se),u(o,Q),u(Q,ke),u(ke,X),u(ke,Ie),u(ke,he),u(Q,Ve),u(Q,Ne),u(Ne,le),u(Ne,pe),u(Ne,q),u(Q,U),u(Q,Z),u(Z,_e),u(Z,Le),u(Z,Me),u(o,Je),u(o,Ke),u(Ke,Oe),u(Oe,je),u(Ke,Tt),u(Ke,Fe),u(Fe,mt),u(Fe,os),u(Fe,it),u(Ke,is),u(Ke,pt),u(pt,Bt),u(pt,cs),u(pt,_t),u(t,us),Re&&Re.m(t,null),Ye=!0,fs||(js=[$(n,"click",s[7]),$(N,"click",We.openMidi),$(D,"click",We.disableMidi),$(A,"change",s[12]),$(ue,"input",s[13]),$(ue,"change",s[8]),$(he,"change",s[14]),$(q,"change",s[15]),$(Me,"change",s[16]),$(je,"click",s[17]),$(it,"input",s[9]),$(_t,"click",s[10])],fs=!0)},p(Pe,[xe]){var ct;(!Ye||xe&32&&b!==(b=((ct=Pe[5])==null?void 0:ct.name)??"No device")&&p.value!==b)&&(p.value=b),(!Ye||xe&8&&C!==(C=Pe[3].useSound))&&(A.checked=C),xe&1&&ue.value!==Pe[0]&&Qe(ue,Pe[0]),(!Ye||xe&8&&ie!==(ie=Pe[3].useKeyboard))&&(he.checked=ie),(!Ye||xe&8&&oe!==(oe=Pe[3].useHotkeys))&&(q.checked=oe),(!Ye||xe&8&&ot!==(ot=Pe[3].useAutoOctave))&&(Me.checked=ot),(!Ye||xe&2&&it.value!==Pe[1])&&(it.value=Pe[1]),(!Ye||xe&16)&&H(o,"hidden",Pe[4]),Pe[2]?Re?xe&4&&x(Re,1):(Re=Al(),Re.c(),x(Re,1),Re.m(t,null)):Re&&(et(),z(Re,1,1,()=>{Re=null}),tt()),(!Ye||xe&16)&&H(t,"collapsed",Pe[4]),(!Ye||xe&2048&&Gt!==(Gt=Ce(`${Pe[11].class||""}`)+" svelte-1bpw69s"))&&d(e,"class",Gt)},i(Pe){Ye||(x(Re),Ye=!0)},o(Pe){z(Re),Ye=!1},d(Pe){Pe&&m(e),Re&&Re.d(),fs=!1,rt(js)}}}function Ya(s,e,t){let l,n,r;de(s,at,k=>t(3,l=k)),de(s,ts,k=>t(5,r=k));const a=ht(Ue(!1),{key:"inputs-hidden"});de(s,a,k=>t(4,n=k));let o=l.fixedVelocity??"",c=l.keyFadeTimeout,i=!1;at.subscribe(k=>{t(0,o=k.fixedVelocity??""),t(1,c=k.keyFadeTimeout)});function h(){a.update(k=>!k)}function f(k){const{value:L}=k.currentTarget;let S;if(L)try{S=parseInt(L)}catch{}S!==void 0&&S>=0&&S<=127?We.setInputValue("fixedVelocity",S):L?t(0,o=l.fixedVelocity||""):We.setInputValue("fixedVelocity",void 0)}function p(k){try{const L=parseInt(k.currentTarget.value);We.setInputValue("keyFadeTimeout",L)}catch{t(1,c=l.keyFadeTimeout)}}function b(){$n()}const g=k=>We.setInputValue("useSound",k.currentTarget.checked);function y(){o=this.value,t(0,o)}const N=k=>We.setInputValue("useKeyboard",k.currentTarget.checked),E=k=>We.setInputValue("useHotkeys",k.currentTarget.checked),O=k=>We.setInputValue("useAutoOctave",k.currentTarget.checked),D=()=>t(2,i=!i);return s.$$set=k=>{t(11,e=Te(Te({},e),Ae(k)))},e=Ae(e),[o,c,i,l,n,r,a,h,f,p,b,e,g,y,N,E,O,D]}class Qa extends $e{constructor(e){super(),He(this,e,Ya,Ja,ze,{})}}function Xa(s){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,l){M(t,e,l)},p:me,d(t){t&&m(e)}}}function Za(s){let e,t=s[1].note+"",l;return{c(){e=J("Input: "),l=J(t)},l(n){e=Y(n,"Input: "),l=Y(n,t)},m(n,r){M(n,e,r),M(n,l,r)},p(n,r){r&2&&t!==(t=n[1].note+"")&&ae(l,t)},d(n){n&&(m(e),m(l))}}}function er(s){let e,t;return{c(){e=J("Input: "),t=J(s[0])},l(l){e=Y(l,"Input: "),t=Y(l,s[0])},m(l,n){M(l,e,n),M(l,t,n)},p(l,n){n&1&&ae(t,l[0])},d(l){l&&(m(e),m(t))}}}function tr(s){let e;return{c(){e=J(Es)},l(t){e=Y(t,Es)},m(t,l){M(t,e,l)},p:me,d(t){t&&m(e)}}}function sr(s){let e,t,l,n;function r(c,i){return c[2].useKeyboard&&Es?tr:c[2].useKeyboard&&c[0]?er:c[2].useKeyboard&&c[1]?Za:Xa}let a=r(s),o=a(s);return{c(){e=_("div"),o.c(),this.h()},l(c){e=v(c,"DIV",{class:!0});var i=I(e);o.l(i),i.forEach(m),this.h()},h(){d(e,"class",t=`${s[4].class||""}`)},m(c,i){M(c,e,i),o.m(e,null),l||(n=$(window,"keydown",s[3]),l=!0)},p(c,[i]){a===(a=r(c))&&o?o.p(c,i):(o.d(1),o=a(c),o&&(o.c(),o.m(e,null))),i&16&&t!==(t=`${c[4].class||""}`)&&d(e,"class",t)},i:me,o:me,d(c){c&&m(e),o.d(),l=!1,n()}}}let Es="";function lr(s,e,t){let l;de(s,at,i=>t(2,l=i));let{debounced:n}=e,r="",a;const o=yn();function c(i){const h=i.target;if(n||!(h instanceof HTMLElement)||h.tagName==="INPUT")return;const f=Lt.handleInput(i.code,i.key,i.shiftKey);f&&f.e==="note"?t(1,a=f.data):f&&f.e==="string"?t(0,r=f.data):f&&(t(0,r=""),t(1,a=void 0),o(f.e,f.data))}return s.$$set=i=>{t(4,e=Te(Te({},e),Ae(i))),"debounced"in i&&t(5,n=i.debounced)},e=Ae(e),[r,a,l,c,e,n]}class nr extends $e{constructor(e){super(),He(this,e,lr,sr,ze,{debounced:5})}}function ar(s){let e,t,l,n="Count",r,a,o,c,i,h="Duplicates",f,p,b,g,y,N,E="Autoplay",O,D,k,L,S,j,G="Wait seconds",w,B,A,C,T;return{c(){e=_("ul"),t=_("li"),l=_("label"),l.textContent=n,r=P(),a=_("input"),o=P(),c=_("li"),i=_("label"),i.textContent=h,f=P(),p=_("input"),g=P(),y=_("li"),N=_("label"),N.textContent=E,O=P(),D=_("input"),L=P(),S=_("li"),j=_("label"),j.textContent=G,w=P(),B=_("input"),this.h()},l(R){e=v(R,"UL",{class:!0});var K=I(e);t=v(K,"LI",{class:!0});var F=I(t);l=v(F,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(l)!=="svelte-wgq9fc"&&(l.textContent=n),r=V(F),a=v(F,"INPUT",{class:!0,id:!0,type:!0}),F.forEach(m),o=V(K),c=v(K,"LI",{class:!0});var ce=I(c);i=v(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(i)!=="svelte-hcg9dq"&&(i.textContent=h),f=V(ce),p=v(ce,"INPUT",{class:!0,id:!0,type:!0}),ce.forEach(m),g=V(K),y=v(K,"LI",{class:!0});var ue=I(y);N=v(ue,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(N)!=="svelte-lr68n2"&&(N.textContent=E),O=V(ue),D=v(ue,"INPUT",{class:!0,id:!0,type:!0}),ue.forEach(m),L=V(K),S=v(K,"LI",{class:!0});var se=I(S);j=v(se,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(j)!=="svelte-1qj2vcy"&&(j.textContent=G),w=V(se),B=v(se,"INPUT",{class:!0,id:!0,type:!0}),se.forEach(m),K.forEach(m),this.h()},h(){d(l,"class","font-bold"),d(l,"for","guess-count"),d(a,"class","h-[20px] w-10"),d(a,"id","guess-count"),d(a,"type","number"),d(t,"class","flex items-center justify-between svelte-1elvih2"),d(i,"class","font-bold"),d(i,"for","duplicates"),d(p,"class","h-[20px]"),d(p,"id","duplicates"),d(p,"type","checkbox"),p.checked=b=s[2].duplicates,d(c,"class","flex items-center justify-between mr-6 svelte-1elvih2"),d(N,"class","font-bold"),d(N,"for","autoplay"),d(D,"class","h-[20px]"),d(D,"id","autoplay"),d(D,"type","checkbox"),D.checked=k=s[2].autoplay,d(y,"class","flex items-center justify-between mr-6 svelte-1elvih2"),d(j,"class","font-bold"),d(j,"for","wait-ms"),d(B,"class","h-[20px] w-10"),d(B,"id","wait-ms"),d(B,"type","number"),d(S,"class","flex items-center justify-between svelte-1elvih2"),d(e,"class",A=Ce(`${s[5].class||""}`)+" svelte-1elvih2")},m(R,K){M(R,e,K),u(e,t),u(t,l),u(t,r),u(t,a),Qe(a,s[0]),u(e,o),u(e,c),u(c,i),u(c,f),u(c,p),u(e,g),u(e,y),u(y,N),u(y,O),u(y,D),u(e,L),u(e,S),u(S,j),u(S,w),u(S,B),Qe(B,s[1]),C||(T=[$(a,"input",s[6]),$(a,"input",s[3]),$(p,"input",s[7]),$(D,"input",s[8]),$(B,"input",s[9]),$(B,"input",s[4])],C=!0)},p(R,[K]){K&1&&Qt(a.value)!==R[0]&&Qe(a,R[0]),K&4&&b!==(b=R[2].duplicates)&&(p.checked=b),K&4&&k!==(k=R[2].autoplay)&&(D.checked=k),K&2&&Qt(B.value)!==R[1]&&Qe(B,R[1]),K&32&&A!==(A=Ce(`${R[5].class||""}`)+" svelte-1elvih2")&&d(e,"class",A)},i:me,o:me,d(R){R&&m(e),C=!1,rt(T)}}}function rr(s,e,t){let l;de(s,dt,p=>t(2,l=p));let n=l.count||"",r=l.waitSeconds||"";dt.subscribe(p=>{t(0,n=p.count||""),t(1,r=p.waitSeconds||"")});function a({currentTarget:{value:p}}){let b;try{b=parseInt(p),b<=0&&(b=1),Se.setOptionValue("count",b)}catch{t(0,n=l.count)}}function o({currentTarget:{value:p}}){let b;try{b=parseInt(p),b<0&&(b=0),Se.setOptionValue("waitSeconds",b)}catch{t(1,r=l.waitSeconds)}}function c(){n=Qt(this.value),t(0,n)}const i=p=>Se.setOptionValue("duplicates",p.currentTarget.checked),h=p=>Se.setOptionValue("autoplay",p.currentTarget.checked);function f(){r=Qt(this.value),t(1,r)}return s.$$set=p=>{t(5,e=Te(Te({},e),Ae(p)))},e=Ae(e),[n,r,l,a,o,e,c,i,h,f]}class or extends $e{constructor(e){super(),He(this,e,rr,ar,ze,{})}}function Il(s,e,t){const l=s.slice();return l[20]=e[t].key,l[21]=e[t].value,l}function Sl(s,e,t){const l=s.slice();return l[20]=e[t].key,l[21]=e[t].value,l}function Nl(s){let e,t,l=s[21]+"",n,r,a,o,c,i,h,f;function p(){return s[13](s[20])}o=new Ze({props:{icon:_s,width:20}});function b(...g){return s[14](s[20],...g)}return{c(){e=_("li"),t=_("button"),n=J(l),r=P(),a=_("button"),ve(o.$$.fragment),c=P(),this.h()},l(g){e=v(g,"LI",{class:!0});var y=I(e);t=v(y,"BUTTON",{class:!0});var N=I(t);n=Y(N,l),N.forEach(m),r=V(y),a=v(y,"BUTTON",{class:!0});var E=I(a);ge(o.$$.fragment,E),E.forEach(m),c=V(y),y.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),H(t,"selected",s[20]===s[0]),d(a,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),d(e,"class","flex svelte-1okhpct")},m(g,y){M(g,e,y),u(e,t),u(t,n),u(e,r),u(e,a),be(o,a,null),u(e,c),i=!0,h||(f=[$(t,"click",p),$(a,"click",b)],h=!0)},p(g,y){s=g,(!i||y&17)&&H(t,"selected",s[20]===s[0])},i(g){i||(x(o.$$.fragment,g),i=!0)},o(g){z(o.$$.fragment,g),i=!1},d(g){g&&m(e),ye(o),h=!1,rt(f)}}}function Ll(s){let e,t=ne(s[2]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Dl(Il(s,t,n));return{c(){e=_("ul");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=v(n,"UL",{class:!0});var r=I(e);for(let a=0;a<l.length;a+=1)l[a].l(r);r.forEach(m),this.h()},h(){d(e,"class","svelte-1okhpct")},m(n,r){M(n,e,r);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(n,r){if(r&518){t=ne(n[2]);let a;for(a=0;a<t.length;a+=1){const o=Il(n,t,a);l[a]?l[a].p(o,r):(l[a]=Dl(o),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Dl(s){let e,t,l=s[21]+"",n,r,a,o;function c(){return s[15](s[20])}return{c(){e=_("li"),t=_("button"),n=J(l),r=P(),this.h()},l(i){e=v(i,"LI",{class:!0});var h=I(e);t=v(h,"BUTTON",{class:!0});var f=I(t);n=Y(f,l),f.forEach(m),r=V(h),h.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),H(t,"selected",s[20]===s[1]),d(e,"class","svelte-1okhpct")},m(i,h){M(i,e,h),u(e,t),u(t,n),u(e,r),a||(o=$(t,"click",c),a=!0)},p(i,h){s=i,h&4&&l!==(l=s[21]+"")&&ae(n,l),h&6&&H(t,"selected",s[20]===s[1])},d(i){i&&m(e),a=!1,o()}}}function ir(s){let e,t,l="Play",n,r,a,o,c,i,h,f,p,b,g="Reset",y,N,E,O,D=s[3]?"Quit":"Play",k,L,S,j,G,w=ne(s[4]),B=[];for(let T=0;T<w.length;T+=1)B[T]=Nl(Sl(s,w,T));const A=T=>z(B[T],1,1,()=>{B[T]=null});let C=(s[0]==="chords-write"||s[0]==="chords-play")&&Ll(s);return h=new or({props:{class:"game-options"}}),E=new Ze({props:{class:"mr-1",icon:s[3]?Us:_s,width:20}}),{c(){e=_("fieldset"),t=_("legend"),t.textContent=l,n=P(),r=_("div"),a=_("ul");for(let T=0;T<B.length;T+=1)B[T].c();o=P(),c=_("div"),C&&C.c(),i=P(),ve(h.$$.fragment),f=P(),p=_("div"),b=_("button"),b.textContent=g,y=P(),N=_("button"),ve(E.$$.fragment),O=P(),k=J(D),this.h()},l(T){e=v(T,"FIELDSET",{class:!0});var R=I(e);t=v(R,"LEGEND",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-1409tnk"&&(t.textContent=l),n=V(R),r=v(R,"DIV",{class:!0});var K=I(r);a=v(K,"UL",{class:!0});var F=I(a);for(let Q=0;Q<B.length;Q+=1)B[Q].l(F);F.forEach(m),o=V(K),c=v(K,"DIV",{class:!0});var ce=I(c);C&&C.l(ce),ce.forEach(m),i=V(K),ge(h.$$.fragment,K),f=V(K),p=v(K,"DIV",{class:!0});var ue=I(p);b=v(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(b)!=="svelte-10rv0bu"&&(b.textContent=g),y=V(ue),N=v(ue,"BUTTON",{class:!0});var se=I(N);ge(E.$$.fragment,se),O=V(se),k=Y(se,D),se.forEach(m),ue.forEach(m),K.forEach(m),R.forEach(m),this.h()},h(){d(t,"class","px-1 text-base"),d(a,"class","games svelte-1okhpct"),d(c,"class","options svelte-1okhpct"),d(b,"class","w-full btn hover:bg-gray-200"),d(N,"class","w-full mt-2 flex items-center justify-center btn primary"),d(p,"class","h-full flex flex-col justify-end"),d(r,"class","body pb-2 h-full svelte-1okhpct"),d(e,"class",L=Ce(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(T,R){M(T,e,R),u(e,t),u(e,n),u(e,r),u(r,a);for(let K=0;K<B.length;K+=1)B[K]&&B[K].m(a,null);u(r,o),u(r,c),C&&C.m(c,null),u(r,i),be(h,r,null),u(r,f),u(r,p),u(p,b),u(p,y),u(p,N),be(E,N,null),u(N,O),u(N,k),S=!0,j||(G=[$(b,"click",s[5]),$(N,"click",s[16])],j=!0)},p(T,[R]){if(R&401){w=ne(T[4]);let F;for(F=0;F<w.length;F+=1){const ce=Sl(T,w,F);B[F]?(B[F].p(ce,R),x(B[F],1)):(B[F]=Nl(ce),B[F].c(),x(B[F],1),B[F].m(a,null))}for(et(),F=w.length;F<B.length;F+=1)A(F);tt()}T[0]==="chords-write"||T[0]==="chords-play"?C?C.p(T,R):(C=Ll(T),C.c(),C.m(c,null)):C&&(C.d(1),C=null);const K={};R&8&&(K.icon=T[3]?Us:_s),E.$set(K),(!S||R&8)&&D!==(D=T[3]?"Quit":"Play")&&ae(k,D),(!S||R&1024&&L!==(L=Ce(`${T[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&d(e,"class",L)},i(T){if(!S){for(let R=0;R<w.length;R+=1)x(B[R]);x(h.$$.fragment,T),x(E.$$.fragment,T),S=!0}},o(T){B=B.filter(Boolean);for(let R=0;R<B.length;R+=1)z(B[R]);z(h.$$.fragment,T),z(E.$$.fragment,T),S=!1},d(T){T&&m(e),Be(B,T),C&&C.d(),ye(h),ye(E),j=!1,rt(G)}}}function cr(s,e,t){let l,n,r,a,o;de(s,Is,k=>t(12,r=k)),de(s,dt,k=>t(19,a=k)),de(s,kt,k=>t(3,o=k));const c=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let i=c[4].key,h="maj-m";a.count,a.waitSeconds,dt.subscribe(k=>{k.count,k.waitSeconds});function f(){Se.clearGame(!0)}function p(k,L){if(L==="chords-write"||L==="chords-play"||L==="chords-diatonic"){let S=[];h==="selected"?S=r.filter(j=>j.selected):h==="all"?S=r:h==="maj-m"?S=r.filter(j=>j.suffixes[0]==="maj"||j.suffixes[0]==="m"):h==="seventh"&&(S=r.filter(j=>j.suffixes[0]==="maj7"||j.suffixes[0]==="m7"||j.suffixes[0]==="7"||j.suffixes[0]==="dim7"||j.suffixes[0]==="aug7")),Se.play(L,{chords:S})}else Se.play(L,void 0);k.currentTarget instanceof HTMLElement&&k.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function b(k){t(0,i=k)}function g(k,L){t(0,i=L),p(k,L)}function y(k){t(1,h=k)}const N=k=>b(k),E=(k,L)=>g(L,k),O=k=>y(k),D=k=>p(k,i);return s.$$set=k=>{t(10,e=Te(Te({},e),Ae(k)))},s.$$.update=()=>{s.$$.dirty&4096&&t(11,l=r.reduce((k,L)=>L.selected?k+1:k,0)),s.$$.dirty&2048&&t(2,n=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${l} chords`},{key:"all",value:"All"}])},e=Ae(e),[i,h,n,o,c,f,p,b,g,y,e,l,r,N,E,O,D]}class ur extends $e{constructor(e){super(),He(this,e,cr,ir,ze,{})}}function jl(s,e,t){const l=s.slice();return l[7]=e[t],l}function Pl(s,e,t){const l=s.slice();return l[4]=e[t],l}function fr(s){let e,t=ne(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Vl(jl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Ge()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r&2){t=ne(n[1]);let a;for(a=0;a<t.length;a+=1){const o=jl(n,t,a);l[a]?l[a].p(o,r):(l[a]=Vl(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function dr(s){let e,t=ne(s[0].scaleNotes||[]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Ol(Pl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Ge()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r&1){t=ne(n[0].scaleNotes||[]);let a;for(a=0;a<t.length;a+=1){const o=Pl(n,t,a);l[a]?l[a].p(o,r):(l[a]=Ol(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Vl(s){let e,t=s[7].interval+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=I(e);l=Y(r,t),r.forEach(m),this.h()},h(){d(e,"class","svelte-my4m0t")},m(n,r){M(n,e,r),u(e,l)},p(n,r){r&2&&t!==(t=n[7].interval+"")&&ae(l,t)},d(n){n&&m(e)}}}function Ol(s){let e,t=s[4].note+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=I(e);l=Y(r,t),r.forEach(m),this.h()},h(){d(e,"class","svelte-my4m0t")},m(n,r){M(n,e,r),u(e,l)},p(n,r){r&1&&t!==(t=n[4].note+"")&&ae(l,t)},d(n){n&&m(e)}}}function hr(s){let e,t,l,n,r,a;function o(h,f){return h[0]?dr:fr}let c=o(s),i=c(s);return{c(){e=_("div"),t=_("button"),i.c(),this.h()},l(h){e=v(h,"DIV",{class:!0,title:!0});var f=I(e);t=v(f,"BUTTON",{class:!0});var p=I(t);i.l(p),p.forEach(m),f.forEach(m),this.h()},h(){d(t,"class","intervals svelte-my4m0t"),d(e,"class",l=`${s[2].class||""} `),d(e,"title",n=s[1].map(Bl).join("-"))},m(h,f){M(h,e,f),u(e,t),i.m(t,null),r||(a=$(t,"click",s[3]),r=!0)},p(h,[f]){c===(c=o(h))&&i?i.p(h,f):(i.d(1),i=c(h),i&&(i.c(),i.m(t,null))),f&4&&l!==(l=`${h[2].class||""} `)&&d(e,"class",l),f&2&&n!==(n=h[1].map(Bl).join("-"))&&d(e,"title",n)},i:me,o:me,d(h){h&&m(e),i.d(),r=!1,a()}}}const Bl=s=>s.interval;function mr(s,e,t){let{scale:l,intervals:n}=e;function r(a){ns.call(this,s,a)}return s.$$set=a=>{t(2,e=Te(Te({},e),Ae(a))),"scale"in a&&t(0,l=a.scale),"intervals"in a&&t(1,n=a.intervals)},e=Ae(e),[l,n,e,r]}class vn extends $e{constructor(e){super(),He(this,e,mr,hr,ze,{scale:0,intervals:1})}}function Gl(s,e,t){const l=s.slice();return l[7]=e[t],l}function Ml(s,e,t){const l=s.slice();return l[4]=e[t],l}function pr(s){let e,t=ne(s[0]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Rl(Gl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Ge()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r&1){t=ne(n[0]);let a;for(a=0;a<t.length;a+=1){const o=Gl(n,t,a);l[a]?l[a].p(o,r):(l[a]=Rl(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function _r(s){let e,t=ne(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Ul(Ml(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Ge()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Ge()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r&2){t=ne(n[1]);let a;for(a=0;a<t.length;a+=1){const o=Ml(n,t,a);l[a]?l[a].p(o,r):(l[a]=Ul(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Rl(s){let e,t,l=s[7].roman+"",n,r,a,o=s[7].suffix+"",c,i;return{c(){e=_("span"),t=_("span"),n=J(l),r=P(),a=_("sup"),c=J(o),i=P(),this.h()},l(h){e=v(h,"SPAN",{class:!0});var f=I(e);t=v(f,"SPAN",{class:!0});var p=I(t);n=Y(p,l),p.forEach(m),r=V(f),a=v(f,"SUP",{class:!0});var b=I(a);c=Y(b,o),b.forEach(m),i=V(f),f.forEach(m),this.h()},h(){d(t,"class","block"),d(a,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),H(a,"super-text",s[7].suffix.length>2),d(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(h,f){M(h,e,f),u(e,t),u(t,n),u(e,r),u(e,a),u(a,c),u(e,i)},p(h,f){f&1&&l!==(l=h[7].roman+"")&&ae(n,l),f&1&&o!==(o=h[7].suffix+"")&&ae(c,o),f&1&&H(a,"super-text",h[7].suffix.length>2)},d(h){h&&m(e)}}}function Ul(s){let e,t,l=s[4]+"",n,r;return{c(){e=_("span"),t=_("span"),n=J(l),r=P(),this.h()},l(a){e=v(a,"SPAN",{class:!0});var o=I(e);t=v(o,"SPAN",{});var c=I(t);n=Y(c,l),c.forEach(m),r=V(o),o.forEach(m),this.h()},h(){d(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(a,o){M(a,e,o),u(e,t),u(t,n),u(e,r)},p(a,o){o&2&&l!==(l=a[4]+"")&&ae(n,l)},d(a){a&&m(e)}}}function vr(s){let e,t,l,n,r,a;function o(h,f){return h[1].length>0?_r:pr}let c=o(s),i=c(s);return{c(){e=_("div"),t=_("button"),i.c(),this.h()},l(h){e=v(h,"DIV",{class:!0,title:!0});var f=I(e);t=v(f,"BUTTON",{class:!0});var p=I(t);i.l(p),p.forEach(m),f.forEach(m),this.h()},h(){d(t,"class","triads flex flex-wrap svelte-1roj1mi"),d(e,"class",l=Ce(`${s[2].class||""} `)+" svelte-1roj1mi"),d(e,"title",n=s[0].map(Kl).join("-"))},m(h,f){M(h,e,f),u(e,t),i.m(t,null),r||(a=$(t,"click",s[3]),r=!0)},p(h,[f]){c===(c=o(h))&&i?i.p(h,f):(i.d(1),i=c(h),i&&(i.c(),i.m(t,null))),f&4&&l!==(l=Ce(`${h[2].class||""} `)+" svelte-1roj1mi")&&d(e,"class",l),f&1&&n!==(n=h[0].map(Kl).join("-"))&&d(e,"title",n)},i:me,o:me,d(h){h&&m(e),i.d(),r=!1,a()}}}const Kl=s=>s.roman+s.suffix;function gr(s,e,t){let{triads:l,chords:n}=e;function r(a){ns.call(this,s,a)}return s.$$set=a=>{t(2,e=Te(Te({},e),Ae(a))),"triads"in a&&t(0,l=a.triads),"chords"in a&&t(1,n=a.chords)},e=Ae(e),[l,n,e,r]}class gn extends $e{constructor(e){super(),He(this,e,gr,vr,ze,{triads:0,chords:1})}}function Fl(s,e,t){const l=s.slice();return l[23]=e[t],l}function xl(s,e,t){const l=s.slice();return l[23]=e[t],l}function $l(s){let e,t,l=s[23].raw.names[0]+"",n,r,a,o,c,i,h;function f(){return s[11](s[23])}a=new vn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),a.$on("click",f);function p(){return s[12](s[23])}return c=new gn({props:{triads:s[23].triads,chords:s[23].triadChords}}),c.$on("click",p),{c(){e=_("li"),t=_("div"),n=J(l),r=P(),ve(a.$$.fragment),o=P(),ve(c.$$.fragment),i=P(),this.h()},l(b){e=v(b,"LI",{class:!0});var g=I(e);t=v(g,"DIV",{class:!0});var y=I(t);n=Y(y,l),y.forEach(m),r=V(g),ge(a.$$.fragment,g),o=V(g),ge(c.$$.fragment,g),i=V(g),g.forEach(m),this.h()},h(){d(t,"class","text-xs font-bold"),d(e,"class","svelte-4hctsl")},m(b,g){M(b,e,g),u(e,t),u(t,n),u(e,r),be(a,e,null),u(e,o),be(c,e,null),u(e,i),h=!0},p(b,g){s=b,(!h||g&4)&&l!==(l=s[23].raw.names[0]+"")&&ae(n,l);const y={};g&4&&(y.scale=s[23].scale),g&4&&(y.intervals=s[23].raw.intervals),a.$set(y);const N={};g&4&&(N.triads=s[23].triads),g&4&&(N.chords=s[23].triadChords),c.$set(N)},i(b){h||(x(a.$$.fragment,b),x(c.$$.fragment,b),h=!0)},o(b){z(a.$$.fragment,b),z(c.$$.fragment,b),h=!1},d(b){b&&m(e),ye(a),ye(c)}}}function Hl(s){let e,t,l=s[23].raw.names[0]+"",n,r,a,o,c,i,h;function f(){return s[13](s[23])}a=new vn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),a.$on("click",f);function p(){return s[14](s[23])}return c=new gn({props:{triads:s[23].triads,chords:s[23].triadChords}}),c.$on("click",p),{c(){e=_("li"),t=_("div"),n=J(l),r=P(),ve(a.$$.fragment),o=P(),ve(c.$$.fragment),i=P(),this.h()},l(b){e=v(b,"LI",{class:!0});var g=I(e);t=v(g,"DIV",{class:!0});var y=I(t);n=Y(y,l),y.forEach(m),r=V(g),ge(a.$$.fragment,g),o=V(g),ge(c.$$.fragment,g),i=V(g),g.forEach(m),this.h()},h(){d(t,"class","text-xs font-bold"),d(e,"class","svelte-4hctsl")},m(b,g){M(b,e,g),u(e,t),u(t,n),u(e,r),be(a,e,null),u(e,o),be(c,e,null),u(e,i),h=!0},p(b,g){s=b,(!h||g&2)&&l!==(l=s[23].raw.names[0]+"")&&ae(n,l);const y={};g&2&&(y.scale=s[23].scale),g&2&&(y.intervals=s[23].raw.intervals),a.$set(y);const N={};g&2&&(N.triads=s[23].triads),g&2&&(N.chords=s[23].triadChords),c.$set(N)},i(b){h||(x(a.$$.fragment,b),x(c.$$.fragment,b),h=!0)},o(b){z(a.$$.fragment,b),z(c.$$.fragment,b),h=!1},d(b){b&&m(e),ye(a),ye(c)}}}function br(s){let e,t,l,n,r="Scales",a,o,c,i,h="Key",f,p,b,g,y,N,E,O,D,k,L=ne(s[2]),S=[];for(let A=0;A<L.length;A+=1)S[A]=$l(xl(s,L,A));const j=A=>z(S[A],1,1,()=>{S[A]=null});let G=ne(s[1]),w=[];for(let A=0;A<G.length;A+=1)w[A]=Hl(Fl(s,G,A));const B=A=>z(w[A],1,1,()=>{w[A]=null});return{c(){e=_("div"),t=_("fieldset"),l=_("legend"),n=_("button"),n.textContent=r,a=P(),o=_("div"),c=_("div"),i=_("label"),i.textContent=h,f=P(),p=_("input"),b=P(),g=_("ul");for(let A=0;A<S.length;A+=1)S[A].c();y=P(),N=_("ul");for(let A=0;A<w.length;A+=1)w[A].c();this.h()},l(A){e=v(A,"DIV",{class:!0});var C=I(e);t=v(C,"FIELDSET",{class:!0});var T=I(t);l=v(T,"LEGEND",{class:!0});var R=I(l);n=v(R,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-lhx60e"&&(n.textContent=r),R.forEach(m),a=V(T),o=v(T,"DIV",{class:!0});var K=I(o);c=v(K,"DIV",{class:!0});var F=I(c);i=v(F,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(i)!=="svelte-14m38zf"&&(i.textContent=h),f=V(F),p=v(F,"INPUT",{class:!0,id:!0}),F.forEach(m),b=V(K),g=v(K,"UL",{class:!0});var ce=I(g);for(let se=0;se<S.length;se+=1)S[se].l(ce);ce.forEach(m),y=V(K),N=v(K,"UL",{class:!0});var ue=I(N);for(let se=0;se<w.length;se+=1)w[se].l(ue);ue.forEach(m),K.forEach(m),T.forEach(m),C.forEach(m),this.h()},h(){d(n,"class","px-1 rounded hover:bg-gray-100"),d(l,"class","text-base"),d(i,"class","mr-4 font-bold"),d(i,"for","scale-key"),d(p,"class","bg-gray-100 w-16 px-1 rounded"),d(p,"id","scale-key"),p.value=s[0],d(c,"class","flex w-1/2 mb-2 input svelte-4hctsl"),d(g,"class","list odd w-full svelte-4hctsl"),d(N,"class","list even w-full svelte-4hctsl"),d(o,"class","body svelte-4hctsl"),H(o,"hidden",s[3]),d(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),H(t,"collapsed",s[3]),d(e,"class",E=Ce(`${s[9].class||""}`)+" svelte-4hctsl")},m(A,C){M(A,e,C),u(e,t),u(t,l),u(l,n),u(t,a),u(t,o),u(o,c),u(c,i),u(c,f),u(c,p),u(o,b),u(o,g);for(let T=0;T<S.length;T+=1)S[T]&&S[T].m(g,null);u(o,y),u(o,N);for(let T=0;T<w.length;T+=1)w[T]&&w[T].m(N,null);O=!0,D||(k=[$(n,"click",s[5]),$(p,"input",s[6])],D=!0)},p(A,[C]){if((!O||C&1&&p.value!==A[0])&&(p.value=A[0]),C&388){L=ne(A[2]);let T;for(T=0;T<L.length;T+=1){const R=xl(A,L,T);S[T]?(S[T].p(R,C),x(S[T],1)):(S[T]=$l(R),S[T].c(),x(S[T],1),S[T].m(g,null))}for(et(),T=L.length;T<S.length;T+=1)j(T);tt()}if(C&386){G=ne(A[1]);let T;for(T=0;T<G.length;T+=1){const R=Fl(A,G,T);w[T]?(w[T].p(R,C),x(w[T],1)):(w[T]=Hl(R),w[T].c(),x(w[T],1),w[T].m(N,null))}for(et(),T=G.length;T<w.length;T+=1)B(T);tt()}(!O||C&8)&&H(o,"hidden",A[3]),(!O||C&8)&&H(t,"collapsed",A[3]),(!O||C&512&&E!==(E=Ce(`${A[9].class||""}`)+" svelte-4hctsl"))&&d(e,"class",E)},i(A){if(!O){for(let C=0;C<L.length;C+=1)x(S[C]);for(let C=0;C<G.length;C+=1)x(w[C]);O=!0}},o(A){S=S.filter(Boolean);for(let C=0;C<S.length;C+=1)z(S[C]);w=w.filter(Boolean);for(let C=0;C<w.length;C+=1)z(w[C]);O=!1},d(A){A&&m(e),Be(S,A),Be(w,A),D=!1,rt(k)}}}function yr(s,e,t){let l,n,r,a,o,c,i;de(s,ss,w=>t(17,r=w)),de(s,jt,w=>t(18,a=w)),de(s,at,w=>t(19,o=w)),de(s,nt,w=>t(20,c=w));let f=Cs().map(w=>({key:w.names[0],raw:w,scale:void 0,triads:w.triads,triadChords:[]})),p="",b=[a.key,a.scale],g;const y=ht(Ue(!0),{key:"scales-hidden"});de(s,y,w=>t(3,i=w));function N(){y.update(w=>!w)}function E({currentTarget:{value:w}}){t(0,p=`${w.charAt(0).toUpperCase()}${w.charAt(1).toLowerCase()}`),t(10,f=f.map(B=>{const A=es(p,B.key),C=p&&"data"in A?A.data:void 0;let T=[];return C&&(T=B.triads.map((R,K)=>`${C.scaleNotes[K].note}${!R.suffix.includes("°")&&R.minor?"m":""}${R.suffix}`)),{...B,scale:C,triadChords:T}}))}function O(w,B,A){if(w<B.length){const C=B[w++];we.setPlayed(C),c==null||c.playChord(C.map(T=>T.midi),o.fixedVelocity),g=setTimeout(()=>O(w,B,A),A)}else we.setPlayed([]),we.setKeyAndScale(b[0],b[1])}function D(w){clearTimeout(g);let B,A;w.scale?(A=w.scale,b=[a.key,a.scale],we.setKeyAndScale(w.scale.key,w.scale.scale)):A=a;const C=r[0].midi+A.scaleNotes[0].semitones;B=w.raw.intervals.map(T=>[{...A.notesMap.get(T.semitones%12),midi:C+T.semitones}]),B[0][0].semitones!==B[B.length-1][0].semitones&&B.push(B[0].map(T=>({...T,midi:T.midi+12}))),O(0,B,500)}function k(w){clearTimeout(g);const{intervals:B}=w.raw;let A,C;w.scale?(C=w.scale,b=[a.key,a.scale],we.setKeyAndScale(w.scale.key,w.scale.scale)):C=a;const T=r[0].midi+C.scaleNotes[0].semitones;A=cn(w.triads).map((K,F)=>vs(T+C.intervals[F].semitones,C,K.intervals)),B[B.length-1].interval_seq!==1&&A.push(A[0].map(K=>({...K,midi:K.midi+12}))),O(0,A,750)}const L=w=>D(w),S=w=>k(w),j=w=>D(w),G=w=>k(w);return s.$$set=w=>{t(9,e=Te(Te({},e),Ae(w)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,l=f.filter((w,B)=>B<f.length/2)),s.$$.dirty&1024&&t(1,n=f.filter((w,B)=>B>=f.length/2))},e=Ae(e),[p,n,l,i,y,N,E,D,k,e,f,L,S,j,G]}class kr extends $e{constructor(e){super(),He(this,e,yr,br,ze,{})}}function zl(s,e,t){const l=s.slice();return l[26]=e[t],l}function ql(s,e,t){const l=s.slice();return l[29]=e[t],l}function Wl(s){let e,t;return{c(){e=_("div"),t=J(s[3]),this.h()},l(l){e=v(l,"DIV",{class:!0});var n=I(e);t=Y(n,s[3]),n.forEach(m),this.h()},h(){d(e,"class","error svelte-1u7ze7x")},m(l,n){M(l,e,n),u(e,t)},p(l,n){n[0]&8&&ae(t,l[3])},d(l){l&&m(e)}}}function Er(s){let e,t;return{c(){e=_("div"),t=J(s[0]),this.h()},l(l){e=v(l,"DIV",{slot:!0});var n=I(e);t=Y(n,s[0]),n.forEach(m),this.h()},h(){d(e,"slot","value")},m(l,n){M(l,e,n),u(e,t)},p(l,n){n[0]&1&&ae(t,l[0])},d(l){l&&m(e)}}}function Jl(s){let e,t=ne(s[5]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Yl(ql(s,t,n));return{c(){e=_("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var r=I(e);for(let a=0;a<l.length;a+=1)l[a].l(r);r.forEach(m),this.h()},h(){d(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){M(n,e,r);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(n,r){if(r[0]&32){t=ne(n[5]);let a;for(a=0;a<t.length;a+=1){const o=ql(n,t,a);l[a]?l[a].p(o,r):(l[a]=Yl(o),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Yl(s){let e,t=s[29].interval+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=I(e);l=Y(r,t),r.forEach(m),this.h()},h(){d(e,"class","svelte-1u7ze7x")},m(n,r){M(n,e,r),u(e,l)},p(n,r){r[0]&32&&t!==(t=n[29].interval+"")&&ae(l,t)},d(n){n&&m(e)}}}function Ql(s){let e,t=ne(s[8].scaleNotes),l=[];for(let n=0;n<t.length;n+=1)l[n]=Xl(zl(s,t,n));return{c(){e=_("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var r=I(e);for(let a=0;a<l.length;a+=1)l[a].l(r);r.forEach(m),this.h()},h(){d(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){M(n,e,r);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(n,r){if(r[0]&256){t=ne(n[8].scaleNotes);let a;for(a=0;a<t.length;a+=1){const o=zl(n,t,a);l[a]?l[a].p(o,r):(l[a]=Xl(o),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Be(l,n)}}}function Xl(s){let e,t=s[26].note+"",l;return{c(){e=_("span"),l=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=I(e);l=Y(r,t),r.forEach(m),this.h()},h(){d(e,"class","svelte-1u7ze7x")},m(n,r){M(n,e,r),u(e,l)},p(n,r){r[0]&256&&t!==(t=n[26].note+"")&&ae(l,t)},d(n){n&&m(e)}}}function wr(s){let e,t,l,n="Score",r,a,o,c,i,h,f,p="Range",b,g,y,N,E,O="—",D,k,L,S,j,G,w,B="Scale",A,C,T,R,K,F,ce,ue="Key",se,Q,ke,X,re,Ie,he="",ie,Ve,Ne,le;o=new Ze({props:{icon:ws,width:16}});let De=s[3]&&Wl(s);T=new dn({props:{id:"scales",class:"p-1",options:s[10],onSelect:s[14],$$slots:{value:[Er]},$$scope:{ctx:s}}});let pe=!s[7]&&Jl(s),q=!s[7]&&Ql(s);return{c(){e=_("fieldset"),t=_("legend"),l=_("button"),l.textContent=n,r=P(),a=_("button"),ve(o.$$.fragment),c=P(),i=_("div"),h=_("div"),f=_("label"),f.textContent=p,b=P(),g=_("div"),y=_("input"),N=P(),E=_("span"),E.textContent=O,D=P(),k=_("input"),L=P(),S=_("div"),De&&De.c(),j=P(),G=_("div"),w=_("label"),w.textContent=B,A=P(),C=_("div"),ve(T.$$.fragment),R=P(),pe&&pe.c(),K=P(),F=_("div"),ce=_("label"),ce.textContent=ue,se=P(),Q=_("div"),ke=_("input"),X=P(),q&&q.c(),re=P(),Ie=_("div"),Ie.innerHTML=he,this.h()},l(oe){e=v(oe,"FIELDSET",{class:!0});var U=I(e);t=v(U,"LEGEND",{class:!0});var Z=I(t);l=v(Z,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-lqyol"&&(l.textContent=n),Z.forEach(m),r=V(U),a=v(U,"BUTTON",{class:!0});var _e=I(a);ge(o.$$.fragment,_e),_e.forEach(m),c=V(U),i=v(U,"DIV",{class:!0});var te=I(i);h=v(te,"DIV",{class:!0});var Le=I(h);f=v(Le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(f)!=="svelte-10u0679"&&(f.textContent=p),b=V(Le),g=v(Le,"DIV",{class:!0});var Me=I(g);y=v(Me,"INPUT",{class:!0,id:!0}),N=V(Me),E=v(Me,"SPAN",{class:!0,"data-svelte-h":!0}),ee(E)!=="svelte-8q1xz4"&&(E.textContent=O),D=V(Me),k=v(Me,"INPUT",{class:!0,id:!0}),Me.forEach(m),L=V(Le),S=v(Le,"DIV",{class:!0});var ot=I(S);De&&De.l(ot),ot.forEach(m),Le.forEach(m),j=V(te),G=v(te,"DIV",{class:!0});var Je=I(G);w=v(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(w)!=="svelte-ld2d07"&&(w.textContent=B),A=V(Je),C=v(Je,"DIV",{class:!0});var Ke=I(C);ge(T.$$.fragment,Ke),Ke.forEach(m),R=V(Je),pe&&pe.l(Je),Je.forEach(m),K=V(te),F=v(te,"DIV",{class:!0});var Oe=I(F);ce=v(Oe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(ce)!=="svelte-17pcm6g"&&(ce.textContent=ue),se=V(Oe),Q=v(Oe,"DIV",{class:!0});var je=I(Q);ke=v(je,"INPUT",{class:!0,id:!0}),je.forEach(m),X=V(Oe),q&&q.l(Oe),Oe.forEach(m),re=V(te),Ie=v(te,"DIV",{class:!0,"data-svelte-h":!0}),ee(Ie)!=="svelte-hp3bkp"&&(Ie.innerHTML=he),te.forEach(m),U.forEach(m),this.h()},h(){d(l,"class","px-1 rounded hover:bg-gray-100"),d(t,"class","px-1 text-base"),d(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),H(a,"hidden",s[6]),d(f,"class","font-bold"),d(f,"for","range_min"),d(y,"class","h-[28px] w-full"),d(y,"id","range_min"),d(E,"class","mx-2 mt-1"),d(k,"class","h-[28px] w-full"),d(k,"id","range_max"),d(g,"class","my-1 flex w-full"),d(S,"class","flex justify-between my-1"),d(h,"class","flex flex-col h-full"),d(w,"class","font-bold"),d(w,"for","scales"),d(C,"class","my-1 w-full"),d(G,"class","flex flex-col h-full"),d(ce,"class","font-bold"),d(ce,"for","key"),d(ke,"class","h-[28px]"),d(ke,"id","key"),d(Q,"class","my-1 flex"),d(F,"class","flex flex-col h-full"),d(Ie,"class","h-full flex flex-col justify-between"),d(i,"class","options svelte-1u7ze7x"),H(i,"hidden",s[6]),d(e,"class",ie=Ce(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),H(e,"collapsed",s[6])},m(oe,U){M(oe,e,U),u(e,t),u(t,l),u(e,r),u(e,a),be(o,a,null),u(e,c),u(e,i),u(i,h),u(h,f),u(h,b),u(h,g),u(g,y),Qe(y,s[1]),u(g,N),u(g,E),u(g,D),u(g,k),Qe(k,s[2]),u(h,L),u(h,S),De&&De.m(S,null),u(i,j),u(i,G),u(G,w),u(G,A),u(G,C),be(T,C,null),u(G,R),pe&&pe.m(G,null),u(i,K),u(i,F),u(F,ce),u(F,se),u(F,Q),u(Q,ke),Qe(ke,s[4]),u(F,X),q&&q.m(F,null),u(i,re),u(i,Ie),Ve=!0,Ne||(le=[$(l,"click",s[15]),$(a,"click",s[16]),$(y,"input",s[18]),$(y,"change",s[19]),$(y,"focus",s[12]),$(k,"input",s[20]),$(k,"change",s[21]),$(k,"focus",s[12]),$(ke,"input",s[22]),$(ke,"input",s[13])],Ne=!0)},p(oe,U){(!Ve||U[0]&64)&&H(a,"hidden",oe[6]),U[0]&2&&y.value!==oe[1]&&Qe(y,oe[1]),U[0]&4&&k.value!==oe[2]&&Qe(k,oe[2]),oe[3]?De?De.p(oe,U):(De=Wl(oe),De.c(),De.m(S,null)):De&&(De.d(1),De=null);const Z={};U[0]&1|U[1]&2&&(Z.$$scope={dirty:U,ctx:oe}),T.$set(Z),oe[7]?pe&&(pe.d(1),pe=null):pe?pe.p(oe,U):(pe=Jl(oe),pe.c(),pe.m(G,null)),U[0]&16&&ke.value!==oe[4]&&Qe(ke,oe[4]),oe[7]?q&&(q.d(1),q=null):q?q.p(oe,U):(q=Ql(oe),q.c(),q.m(F,null)),(!Ve||U[0]&64)&&H(i,"hidden",oe[6]),(!Ve||U[0]&131072&&ie!==(ie=Ce(`${oe[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&d(e,"class",ie),(!Ve||U[0]&131136)&&H(e,"collapsed",oe[6])},i(oe){Ve||(x(o.$$.fragment,oe),x(T.$$.fragment,oe),Ve=!0)},o(oe){z(o.$$.fragment,oe),z(T.$$.fragment,oe),Ve=!1},d(oe){oe&&m(e),ye(o),De&&De.d(),ye(T),pe&&pe.d(),q&&q.d(),Ne=!1,rt(le)}}}function Cr(s,e,t){let l,n,r,a,o,c;de(s,ss,C=>t(23,n=C)),de(s,wt,C=>t(24,r=C)),de(s,kt,C=>t(7,o=C)),de(s,jt,C=>t(8,c=C));let i=Xe(n[0]),h=Xe(n[1]),f="";const p=ht(Ue(!1),{key:"score-options-hidden"});de(s,p,C=>t(6,a=C));let b=r[0],g=r[1];const y=Cs(),N=y.map(C=>({key:C.names[0],value:C.names[0]}));ss.subscribe(C=>{t(1,i=Xe(C[0])),t(2,h=Xe(C[1]))}),wt.subscribe(C=>{t(4,b=C[0]),t(0,g=C[1])});function E(C,T){const R=Mn(T.currentTarget.value,!0,!0);if("data"in R){const{midi:K}=R.data,F=n,ce=[C==="min"?K:F[0].midi,C==="max"?K:F[1].midi];We.setMidiRange(ce),t(3,f="")}else t(3,f=R.err),C==="min"?t(1,i=Xe(n[0])):t(2,h=Xe(n[1]))}function O(){t(3,f="")}function D({currentTarget:{value:C}}){t(4,b=`${C.charAt(0).toUpperCase()}${C.charAt(1).toLowerCase()}`),we.setKey(b)}function k(C){var T;return t(0,g=(T=N.find(R=>C===R.key))==null?void 0:T.value),we.setScale(g),!1}function L(){p.update(C=>!C)}function S(){we.clearScore(!0),We.setMidiRange([60,84])}function j(){i=this.value,t(1,i)}const G=C=>E("min",C);function w(){h=this.value,t(2,h)}const B=C=>E("max",C);function A(){b=this.value,t(4,b)}return s.$$set=C=>{t(17,e=Te(Te({},e),Ae(C)))},s.$$.update=()=>{var C;s.$$.dirty[0]&1&&t(5,l=((C=y.find(T=>T.names[0]===g))==null?void 0:C.intervals)||[])},e=Ae(e),[g,i,h,f,b,l,a,o,c,p,N,E,O,D,k,L,S,e,j,G,w,B,A]}class Tr extends $e{constructor(e){super(),He(this,e,Cr,wr,ze,{},null,[-1,-1])}}function Ar(s){s[19]=s[20].default}function Ir(s){return{c:me,l:me,m:me,i:me,o:me,d:me}}function Sr(s){Ar(s);let e,t,l;var n=s[19];function r(a,o){return{props:{class:"px-4 md:px-0"}}}return n&&(e=wn(n,r())),{c(){e&&ve(e.$$.fragment),t=Ge()},l(a){e&&ge(e.$$.fragment,a),t=Ge()},m(a,o){e&&be(e,a,o),M(a,t,o),l=!0},i(a){l||(e&&x(e.$$.fragment,a),l=!0)},o(a){e&&z(e.$$.fragment,a),l=!1},d(a){a&&m(t),e&&ye(e,a)}}}function Nr(s){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,l){M(t,e,l)},i:me,o:me,d(t){t&&m(e)}}}function Lr(s){let e,t,l,n='<a class="hover:underline" href="https://github.com/TeemuKoivisto/midi-note-trainer">MIDI Note Trainer</a>',r,a,o,c,i,h,f,p,b,g,y,N,E,O,D,k,L,S,j;o=new Qa({}),i=new kr({}),f=new ia({}),g=new Tr({props:{class:"score-options mr-4"}}),N=new ur({props:{class:"play-form"}});let G={ctx:s,current:null,token:null,hasCatch:!1,pending:Nr,then:Sr,catch:Ir,value:20,blocks:[,,,]};return kn(fe(()=>import("./Score.759bbba4.js"),["./Score.759bbba4.js","./vendor_svelte.a6fd78f9.js","./vendor.13a9dfeb.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),G),k=new nr({props:{class:"min-h-32",debounced:!!s[0]}}),k.$on("guessed-chord",s[2]),k.$on("guessed-key",s[3]),k.$on("guessed-note",s[4]),S=new ka({props:{game:s[1]}}),{c(){e=_("meta"),t=P(),l=_("h1"),l.innerHTML=n,r=P(),a=_("section"),ve(o.$$.fragment),c=P(),ve(i.$$.fragment),h=P(),ve(f.$$.fragment),p=P(),b=_("div"),ve(g.$$.fragment),y=P(),ve(N.$$.fragment),E=P(),G.block.c(),O=P(),D=_("section"),ve(k.$$.fragment),L=P(),ve(S.$$.fragment),this.h()},l(w){const B=En("svelte-1w2oado",document.head);e=v(B,"META",{name:!0,content:!0}),B.forEach(m),t=V(w),l=v(w,"H1",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-1l8ebwf"&&(l.innerHTML=n),r=V(w),a=v(w,"SECTION",{class:!0});var A=I(a);ge(o.$$.fragment,A),c=V(A),ge(i.$$.fragment,A),h=V(A),ge(f.$$.fragment,A),p=V(A),b=v(A,"DIV",{class:!0});var C=I(b);ge(g.$$.fragment,C),y=V(C),ge(N.$$.fragment,C),C.forEach(m),A.forEach(m),E=V(w),G.block.l(w),O=V(w),D=v(w,"SECTION",{class:!0});var T=I(D);ge(k.$$.fragment,T),L=V(T),ge(S.$$.fragment,T),T.forEach(m),this.h()},h(){d(e,"name","description"),d(e,"content","App to practise music notation, scales and chords using MIDI"),d(l,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight"),d(b,"class","play svelte-qjpqy3"),d(a,"class","px-4 md:px-0"),d(D,"class","mb-8 px-4 md:px-0 flex flex-col")},m(w,B){u(document.head,e),M(w,t,B),M(w,l,B),M(w,r,B),M(w,a,B),be(o,a,null),u(a,c),be(i,a,null),u(a,h),be(f,a,null),u(a,p),u(a,b),be(g,b,null),u(b,y),be(N,b,null),M(w,E,B),G.block.m(w,G.anchor=B),G.mount=()=>O.parentNode,G.anchor=O,M(w,O,B),M(w,D,B),be(k,D,null),u(D,L),be(S,D,null),j=!0},p(w,[B]){s=w;const A={};B&1&&(A.debounced=!!s[0]),k.$set(A);const C={};B&2&&(C.game=s[1]),S.$set(C)},i(w){j||(x(o.$$.fragment,w),x(i.$$.fragment,w),x(f.$$.fragment,w),x(g.$$.fragment,w),x(N.$$.fragment,w),x(G.block),x(k.$$.fragment,w),x(S.$$.fragment,w),j=!0)},o(w){z(o.$$.fragment,w),z(i.$$.fragment,w),z(f.$$.fragment,w),z(g.$$.fragment,w),z(N.$$.fragment,w);for(let B=0;B<3;B+=1){const A=G.blocks[B];z(A)}z(k.$$.fragment,w),z(S.$$.fragment,w),j=!1},d(w){w&&(m(t),m(l),m(r),m(a),m(E),m(O),m(D)),m(e),ye(o),ye(i),ye(f),ye(g),ye(N),G.block.d(w),G.token=null,G=null,ye(k),ye(S)}}}function Dr(s,e,t){let l,n,r,a,o,c;de(s,bt,L=>t(7,l=L)),de(s,kt,L=>t(1,n=L)),de(s,dt,L=>t(8,r=L)),de(s,at,L=>t(9,a=L)),de(s,nt,L=>t(10,o=L)),de(s,bs,L=>t(11,c=L));let i,h;nn(()=>(c&&k(),window.addEventListener("keydown",f),window.addEventListener("mousedown",f),window.addEventListener("touchstart",f),()=>{window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)})),ts.subscribe(L=>{L&&L.channels[1].addListener("noteon",p)});function f(){We.initAudio(),window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)}function p(L){if(i)return;const S=L.rawData;b(S[1],S[2])}function b(L,S){const j=n;j instanceof Dt&&!(j!=null&&j.ended)&&l==="waiting"?N(L):j instanceof ft&&!(j!=null&&j.ended)&&l==="waiting"?(j.addPlayedNote(L),h||(h=setTimeout(y,2e3))):j||we.pushPlayed(L),o&&o.noteOn(L,a.fixedVelocity??S)}function g(){r.autoplay&&r.waitSeconds>0?t(0,i=setTimeout(()=>{r.autoplay&&Se.nextGuess(),t(0,i=void 0)},r.waitSeconds*1e3)):r.autoplay?Se.nextGuess():t(0,i=void 0)}function y(){var S;const L=n;if(L instanceof ft){const j=L.guess();we.setPlayed(((S=L.latestGuess.guessed)==null?void 0:S.notes)||[],j,-1),Se.updateState(j?"correct":"wrong"),g()}h=void 0}function N(L){const S=n;if(S instanceof Dt&&l==="waiting"){we.setTarget([we.getNote(S.current)]);const j=S.guess(L);Se.updateState(j?"correct":"wrong"),we.pushPlayed(L,j,4e3),g()}}function E(L){const S=n;if(S instanceof ft&&l==="waiting"){const j=S.guessWrittenChord(L.detail);Se.updateState(j?"correct":"wrong"),g()}}function O(L){const S=n;if(S instanceof Ot&&l==="waiting"){const j=L.detail.replaceAll("♭","b").replaceAll("♯","#"),G=S.guess(j);Se.updateState(G?"correct":"wrong"),g()}}function D(L){b(L.detail,80)}async function k(){const L=await We.openMidi();"data"in L?L.data.name:(L.err,console.error(L.err))}return[i,n,E,O,D]}class Or extends $e{constructor(e){super(),He(this,e,Dr,Lr,ze,{})}}export{Fs as F,ft as G,Or as P,Nn as S,Dt as a,Se as b,kt as c,gt as d,Ts as e,bt as g,nt as p,jt as s,Hs as t};
