import{_ as Ie}from"./preload-helper.a4192956.js";import{S as qe,i as We,s as Je,e as b,n as j,a as y,b as C,p as B,d as p,f as m,Z as Te,N as $,g as U,h as u,_ as et,q as J,t as x,F as xe,l as W,y as Fe,$ as Xe,Q as Ae,R as Ne,c as Ps,a0 as de,u as Os,j as Vs,k as js,V as rs,W as Ct,X as as,a1 as is,a2 as Oe,x as Pe,H as Bs,B as X,C as Z,D as pe,r as me,O as Ue,J as ge,K as ve,L as be,M as ye,m as Ee,T as Ht,w as Ve,o as ae,P as _e,a3 as ms,v as bn,a4 as Bn,a5 as cs,a6 as Gn,a7 as Mn,I as Rn}from"./vendor_svelte.31d6693e.js";import{w as ss,c as Un,e as Kn,f as Qs,g as Xs,h as zt,i as us,j as fs,k as Bt,l as Gt,m as xn,a as Zs,n as Ts}from"./vendor.e9b0235c.js";import{a as Fn}from"./modal.19f420dd.js";function el(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l[24]=e[t].icon,l[26]=t,l}const Hn=s=>({}),tl=s=>({});function sl(s){let e,t,l,n,r,o,a,i,c,d,f;const g=s[17].header,_=Ps(g,s,s[16],tl);let h=de(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=nl(el(s,h,k));const S=k=>W(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),l=j(),n=b("ul"),r=b("li"),_&&_.c(),o=j();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(p),l=B(k),n=y(k,"UL",{class:!0});var E=C(n);r=y(E,"LI",{});var L=C(r);_&&_.l(L),L.forEach(p),o=B(E);for(let O=0;O<v.length;O+=1)v[O].l(E);E.forEach(p),this.h()},h(){m(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),m(e,"tabindex","-1"),m(n,"class",a=Te(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,E){U(k,e,E),U(k,l,E),U(k,n,E),u(n,r),_&&_.m(r,null),u(n,o);for(let L=0;L<v.length;L+=1)v[L]&&v[L].m(n,null);c=!0,d||(f=J(e,"click",s[11]),d=!0)},p(k,E){if(s=k,_&&_.p&&(!c||E&65536)&&Os(_,g,s,s[16],c?js(g,s[16],E,Hn):Vs(s[16]),tl),E&8457){h=de(s[0]);let L;for(L=0;L<h.length;L+=1){const O=el(s,h,L);v[L]?(v[L].p(O,E),x(v[L],1)):(v[L]=nl(O),v[L].c(),x(v[L],1),v[L].m(n,null))}for(xe(),L=h.length;L<v.length;L+=1)S(L);Fe()}(!c||E&4&&a!==(a=Te(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&m(n,"class",a)},i(k){if(!c){k&&rs(()=>{c&&(t||(t=Ct(e,as,{duration:ls},!0)),t.run(1))}),x(_,k);for(let E=0;E<h.length;E+=1)x(v[E]);k&&rs(()=>{c&&(i||(i=Ct(n,is,{duration:ls},!0)),i.run(1))}),c=!0}},o(k){k&&(t||(t=Ct(e,as,{duration:ls},!1)),t.run(0)),W(_,k),v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)W(v[E]);k&&(i||(i=Ct(n,is,{duration:ls},!1)),i.run(0)),c=!1},d(k){k&&(p(e),p(l),p(n)),k&&t&&t.end(),_&&_.d(k),Oe(v,k),k&&i&&i.end(),d=!1,f()}}}function ll(s){let e,t,l,n,r,o,a=s[23]+"",i,c,d,f,g;const _=[qn,zn],h=[];function v(k,E){return k[24]?0:1}l=v(s),n=h[l]=_[l](s);function S(){return s[20](s[22])}return{c(){e=b("li"),t=b("button"),n.c(),r=j(),o=b("div"),i=X(a),c=j(),this.h()},l(k){e=y(k,"LI",{});var E=C(e);t=y(E,"BUTTON",{class:!0});var L=C(t);n.l(L),r=B(L),o=y(L,"DIV",{});var O=C(o);i=Z(O,a),O.forEach(p),L.forEach(p),c=B(E),E.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),$(t,"selected",s[22]===s[3])},m(k,E){U(k,e,E),u(e,t),h[l].m(t,null),u(t,r),u(t,o),u(o,i),u(e,c),d=!0,f||(g=J(t,"click",S),f=!0)},p(k,E){s=k;let L=l;l=v(s),l===L?h[l].p(s,E):(xe(),W(h[L],1,1,()=>{h[L]=null}),Fe(),n=h[l],n?n.p(s,E):(n=h[l]=_[l](s),n.c()),x(n,1),n.m(t,r)),(!d||E&1)&&a!==(a=s[23]+"")&&pe(i,a),(!d||E&9)&&$(t,"selected",s[22]===s[3])},i(k){d||(x(n),d=!0)},o(k){W(n),d=!1},d(k){k&&p(e),h[l].d(),f=!1,g()}}}function zn(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","w-[24px]")},m(t,l){U(t,e,l)},p:me,i:me,o:me,d(t){t&&p(e)}}}function qn(s){let e,t;return e=new Ue({props:{class:"mr-2",icon:s[24],width:16}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const r={};n&1&&(r.icon=l[24]),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function nl(s){let e,t,l=!s[8][s[26]]&&ll(s);return{c(){l&&l.c(),e=Pe()},l(n){l&&l.l(n),e=Pe()},m(n,r){l&&l.m(n,r),U(n,e,r),t=!0},p(n,r){n[8][n[26]]?l&&(xe(),W(l,1,1,()=>{l=null}),Fe()):l?(l.p(n,r),r&256&&x(l,1)):(l=ll(n),l.c(),x(l,1),l.m(e.parentNode,e))},i(n){t||(x(l),t=!0)},o(n){W(l),t=!1},d(n){n&&p(e),l&&l.d(n)}}}function Wn(s){let e,t,l,n,r,o,a,i,c,d=s[6]&&sl(s);return{c(){e=b("div"),t=b("input"),r=j(),d&&d.c(),this.h()},l(f){e=y(f,"DIV",{class:!0,id:!0});var g=C(e);t=y(g,"INPUT",{class:!0,title:!0}),r=B(g),d&&d.l(g),g.forEach(p),this.h()},h(){m(t,"class",l=Te(`${s[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"),m(t,"title",n=s[14].title||""),$(t,"disabled",s[4]),$(t,"open",s[6]),m(e,"class",o=Te(`relative ${s[2]||""}`)+" svelte-h65upg"),m(e,"id",s[1])},m(f,g){U(f,e,g),u(e,t),et(t,s[7]),u(e,r),d&&d.m(e,null),s[21](e),a=!0,i||(c=[J(t,"input",s[18]),J(t,"click",s[9]),J(t,"focus",s[19]),J(t,"input",s[10]),J(t,"keydown",s[12])],i=!0)},p(f,[g]){(!a||g&16384&&l!==(l=Te(`${f[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"))&&m(t,"class",l),(!a||g&16384&&n!==(n=f[14].title||""))&&m(t,"title",n),g&128&&t.value!==f[7]&&et(t,f[7]),(!a||g&16400)&&$(t,"disabled",f[4]),(!a||g&16448)&&$(t,"open",f[6]),f[6]?d?(d.p(f,g),g&64&&x(d,1)):(d=sl(f),d.c(),x(d,1),d.m(e,null)):d&&(xe(),W(d,1,1,()=>{d=null}),Fe()),(!a||g&4&&o!==(o=Te(`relative ${f[2]||""}`)+" svelte-h65upg"))&&m(e,"class",o),(!a||g&2)&&m(e,"id",f[1])},i(f){a||(x(d),a=!0)},o(f){W(d),a=!1},d(f){f&&p(e),d&&d.d(),s[21](null),i=!1,Xe(c)}}}const ls=400;function Jn(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:r,id:o=void 0,containerClass:a=void 0,selected:i,disabled:c=void 0,onSelect:d}=e,f,g=!1,_=i,h=r.map(A=>!1);function v(){c||t(6,g=!g)}function S(A){t(8,h=r.map(w=>!w.value.toLowerCase().includes(A.currentTarget.value.toLowerCase())))}function k(){t(7,_=i),t(6,g=!1),t(8,h=r.map(A=>!1))}function E(A){if(A.key==="Enter"){const w=h.findIndex(D=>!D);_===i?k():w>-1&&t(6,g=d(r[w].key)),g||(t(8,h=r.map(D=>!1)),A.currentTarget instanceof HTMLElement&&A.currentTarget.blur())}else A.key==="Escape"&&(k(),A.currentTarget instanceof HTMLElement&&A.currentTarget.blur())}function L(A){t(6,g=d(A))}function O(){_=this.value,t(7,_),t(3,i)}const K=()=>t(6,g=!0),N=A=>L(A);function T(A){Bs[A?"unshift":"push"](()=>{f=A,t(5,f)})}return s.$$set=A=>{t(14,e=Ae(Ae({},e),Ne(A))),"options"in A&&t(0,r=A.options),"id"in A&&t(1,o=A.id),"containerClass"in A&&t(2,a=A.containerClass),"selected"in A&&t(3,i=A.selected),"disabled"in A&&t(4,c=A.disabled),"onSelect"in A&&t(15,d=A.onSelect),"$$scope"in A&&t(16,n=A.$$scope)},s.$$.update=()=>{s.$$.dirty&8&&t(7,_=i),s.$$.dirty&1&&t(8,h=r.map(A=>!1))},e=Ne(e),[r,o,a,i,c,f,g,_,h,v,S,k,E,L,e,d,n,l,O,K,N,T]}class yn extends qe{constructor(e){super(),We(this,e,Jn,Wn,Je,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:15})}}const ol={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Ze(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:kn(s,e,t),flats:e,sharps:t}}function kn(s,e,t){return(s<8?ol[s]:ol[s%7])-e+t+Math.floor(s/8)*12}function wn(s){let e,t=0,l=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(l=Math.floor(s/100),e=s%100):e=s;const n=kn(e,t,l);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(l)}`,interval_seq:e,semitones:n,flats:t,sharps:l}}const $n=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let Es=[];function En(){return $n.map(s=>{const e=s[3].map(wn);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function Ut(s){Es.length===0&&(Es=En());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return Es.find(t=>t.suffixes.find(l=>l===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function Yn(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const o=Math.min(l,n);l-=o,n-=o}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function os(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const r=t[n],o=s+r.semitones,a=e.scaleNotes.find(g=>g.semitones===o%12),i=r.flats>0,c=r.sharps>0,d=(i?o+1:c?o-1:o)%12,f=i?-1:c?1:0;l.push(Yn(a??e.notesMap.get(d),a?0:f,o))}return l}const rl=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],Qn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],al=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Xn(s){let e=0,t=0;for(let l=0;l<rl.length;l+=1){const n=s.find(o=>o.note.slice(0,2)===rl[l]),r=s.find(o=>o.note.slice(0,2)===Qn[l]);if(n)e+=1;else if(r)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:al.get(e*-1)}:{flats:0,sharps:t,majorSignature:al.get(t)}}function Zn(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function Cn(s){return s.map(e=>{const t=[Ze(1)];let l;return e.major?(t.push(Ze(3)),e.suffix.startsWith("+")?t.push(Ze(5,0,1)):e.suffix.startsWith("6")?t.push(Ze(6)):e.suffix.startsWith("7")?t.push(Ze(7,1)):e.suffix.startsWith("maj7")?t.push(Ze(7)):l=Ut("maj")):e.minor?(t.push(Ze(3,1)),e.suffix.startsWith("°")?t.push(Ze(5,1)):e.suffix.startsWith("6")?(t.push(Ze(6)),l=Ut("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Ze(7,1)),l=Ut("m"+e.suffix)):l=Ut("m")):e.suffix.startsWith("sus2")?t.push(Ze(2)):e.suffix.startsWith("sus4")&&t.push(Ze(4)),t.length<=2&&t.push(Ze(5)),t.length<=2&&t.push(Ze(8)),l||(l=Ut(e.suffix)),{...l,intervals:t}})}function eo(s,e){let t=e.has(4)&&e.has(7),l=e.has(3)&&e.has(7);const n=Zn(s);let r="";return t||l||(e.has(3)&&e.has(6)?(r="°",l=!0):e.has(4)&&e.has(8)?(r="+",t=!0):e.has(3)&&e.has(10)?(l=!0,r="7"):e.has(4)&&e.has(10)?(r="7",t=!0):e.has(4)&&e.has(11)?(r="maj7",t=!0):e.has(3)&&e.has(8)?(r="6",l=!0):e.has(4)&&e.has(9)?(r="6",t=!0):e.has(2)?r="sus2":e.has(5)?r="sus4":e.has(7)?r="5":r="?"),{degree:s,roman:l?n.toLowerCase():n,suffix:r,major:t,minor:l,semitones:e}}function to(s){const e=s.length;return s.map((t,l)=>{const n=t.semitones,r=new Set;for(let o=1;o<e;o+=1){const a=s[(l+o)%e].semitones,i=a<=n?a+12-n:a-n;r.add(i)}return eo(t.interval_seq,r)})}const so=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let Cs=[];function _s(){return so.map(s=>{const e=s[0],t=s[1].map(wn),l=to(t);return{names:e,intervals:t,triads:l}})}function lo(s){Cs.length===0&&(Cs=_s());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return Cs.find(t=>t.names.find(l=>l.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const no=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,oo=/^[0-9]$/,at=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function ds(s){const e=s.midi+s.flats-s.sharps;return e===12?1:Math.floor((e-12)/12)}function dt(s){return`${s.note}${ds(s)}`}function il(s){const t=(s-12)%12;return{...at[t],semitones:t,midi:s}}function ro(s,e=!0,t=!1){if(e&&!no.test(s))return{err:`Unrecognized note "${s}"`,code:400};const l=s.trim(),n=l.charAt(0).toUpperCase(),r=at.find(f=>f.note.charAt(0)===n&&f.note.length===1);if(!r)return{err:`Unable to find note ${l}`,code:500};const o=l.slice(1).split("").reduce((f,g)=>f+(g.toLowerCase()==="b"||g==="♭"?-1:g==="#"||g==="♯"?1:0),0);let a;if(oo.test(l.charAt(l.length-1)))try{a=parseInt(l.charAt(l.length-1),10)}catch{}if(t&&a===void 0)return{err:`No octave provided: ${s}`,code:400};a===void 0&&(a=0);let i=(r.semitones+o)%12;i=i<0?i+12:i;const c=o<0?-o:0,d=o>0?o:0;return{data:{note:`${n}${"♭".repeat(c)}${"♯".repeat(d)}`,semitones:i,midi:12+a*12+i,flats:c,sharps:d}}}function Gs(s){const e=at.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((n,r)=>n+(r.toLowerCase()==="b"||r==="♭"?-1:r==="#"||r==="♯"?1:0),0),l=(e.semitones+t)%12;return{note:s,semitones:l<0?l+12:l,flats:t<0?-t:0,sharps:t>0?t:0}}}const ao=/^[a-gA-G][♭b#♯]?$/,Is="ABCDEFG";function io(s,e){return e.map(t=>Is.charAt((Is.indexOf(s)+t.interval_seq-1)%Is.length))}function co(s,e,t){return t.map((l,n)=>{const r=e[n],o=(s+l.semitones)%12,a=at[o],i=a.note.charAt(0);if(i<r&&(i!=="A"||r!=="G")||i==="G"&&r==="A"){let c=1,d=at[(o+c)%12];for(;d.note.charAt(0)!==r;)c+=1,d=at[(o+c)%12];return{semitones:o,note:d.note+"♭".repeat(c),flats:c+(d.note.includes("♭")?1:0),sharps:0}}else if(i>r||i==="A"&&r==="G"){let c=1,d=o===0?at.length-1:o-c,f=at[d];for(;f.note.charAt(0)!==r;)c+=1,d=d===0?at.length-1:d-1,f=at[d];return{semitones:o,note:f.note+"♯".repeat(c),flats:0,sharps:c+(f.note.includes("♯")?1:0)}}else return{semitones:o,note:a.note,flats:a.flats,sharps:a.sharps}})}function xt(s,e){if(!ao.test(s))return{err:`Unknown key: ${s}`,code:400};const t=lo(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const l=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,n=Gs(l);if(!n)return{err:`Unable to find root for note: ${l}`,code:404};const r=io(l.charAt(0),t.intervals),o=co(n.semitones,r,t.intervals),a=new Map(at.map(i=>{const c=o.find(d=>d.semitones===i.semitones);return c?[i.semitones,c]:[i.semitones,{...i}]}));return{data:{key:l,scale:t.names[0],names:t.names,...Xn(o),intervals:t.intervals.map(i=>({...i})),triads:t.triads.map(i=>({...i})),scaleNotes:o,notesMap:a}}}const As=new Map;function uo(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function fo(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(l){return{err:`Failed to store the value: ${l}`,code:400}}}function gt(s,e){const{key:t,storage:l="local",namespace:n="default"}=e,r=uo(t,l),o=Ee(s);"data"in r?s.set(e.deserialize?e.deserialize(r.data):r.data):"err"in r&&(e!=null&&e.debug)&&console.info(r.err);const a=s.subscribe(c=>{const d=fo(e.serialize?e.serialize(c):c,t,l);"err"in d&&(e!=null&&e.debug)&&console.error(d.err)}),i=As.get(n);return i?i.push({key:t,storage:l,value:s,defaultValue:o,unsubscribe:a}):As.set(n,[{key:t,storage:l,value:s,defaultValue:o,unsubscribe:a}]),s}function ho(s=["default"],e){s.forEach(t=>{var l;(l=As.get(t))==null||l.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function mo(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const l=await t.arrayBuffer();return{data:await e.decodeAudioData(l)}}async function _o(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],l=await Promise.all(t.map(r=>mo(`${s}${r}`,e))),n=[];return l.forEach(r=>{"err"in r?console.error(`Failed to load audio: ${r.err}`):n.push(r.data)}),n}class po{constructor(e,t,l,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(l),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(l))}on(e,t,l,n,r,o,a,i){this.noteA.buffer=e,this.noteA.playbackRate.value=l,this.biquadFilter.frequency.value=r,this.gainA.gain.value=o,this.gain.gain.value=i,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=a,this.noteB.start(0)),this.noteA.start(0)}off(e,t,l){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(l),this.noteB.stop(l),(n=this.damp)==null||n.start(0)}}class go{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,l)=>{this.bufferlists.push(t),l===8?this.damper=t:l===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(l=>{this.noteOn(l,t)})}noteOn(e,t=80){if(e<109&&e>20){const l=this.notes.get(e);l&&(l.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),r=n+1,o=n*12+21,a=2**((e-69)/12)*440,i=t/127;let c=a*(2-(e-21)/50)+3*a*i;e<60&&(c=440*(3-(60-21)/50)+3*a*i);const d=1-(e%12/12+1)/12,f=Math.pow(2,(e-o)/12),g=0,_=0,h=i**1.4,v=new po(e,this.context,this.directGain,this.damper);v.on(this.bufferlists[n],this.bufferlists[r],f,g,c,d,_,h),this.notes.set(e,v)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const vo="/midi-note-trainer/",Ns=gt(Ve(!1),{key:"midi-access"}),hs=Ve(void 0),ps=gt(Ve([60,84]),{key:"midi-range",storage:"session"}),Mt=Ht(ps,s=>[il(s[0]),il(s[1])]),cl=Ve(void 0),lt=Ve(void 0),nt=gt(Ve({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),Be={async openMidi(){return ss.enable().then(()=>(Ns.set(!0),ss.inputs.length>0?(hs.set(ss.inputs[0]),{data:ss.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(s=>({err:s.toString(),code:403}))},disableMidi(){Ns.set(!1),hs.set(void 0)},setMidiRange(s){ps.set(s)},setInputValue(s,e){nt.update(t=>({...t,[s]:e})),s==="useSound"&&!e?lt.set(void 0):s==="useSound"&&!Ee(lt)&&this.initAudio()},async initAudio(){let s=Ee(cl);if(s||(s=new AudioContext,cl.set(s)),!Ee(lt)){const e=new go(s),t=await _o(`${vo}audio`,s);e.load(t),lt.set(e)}}};let rt;const Tt=Ve(["C","Major"]),pt=Ht(Tt,s=>{const e=xt(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),ul=Ve([]),wt=Ve([]);function Ss(s,e){if(s.length>0){const t=Date.now();let l=t;const n=s.filter(r=>(r.started+e>t&&(l=Math.min(l,r.started)),r.started+e>t));return!rt&&n.length>0&&(rt=setTimeout(()=>{rt=void 0,wt.update(r=>Ss(r,e))},e-(t-l)+100)),n}return s}const De={setKey(s){Tt.update(e=>[s,e[1]])},setScale(s){Tt.update(e=>[e[0],s])},setKeyAndScale(s,e){Tt.set([s,e])},setTarget(s=[]){ul.set(s)},getNote(s){return{...Ee(pt).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const n={...Ee(pt).notesMap.get(s%12),midi:s},r=Date.now(),o=e===void 0?"default":e?"correct":"wrong";if(wt.update(a=>{const i=a.findIndex(c=>c.midi===s);return i>=0&&a.splice(i,1),[...a,{...n,color:o,started:r}]}),!rt&&t!==-1){const a=t??Ee(nt).keyFadeTimeout;rt=setTimeout(()=>{rt=void 0,wt.update(i=>Ss(i,a))},a)}},setPlayed(s,e,t){const l=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(wt.update(r=>[...s.map(o=>({...o,color:n,started:l}))]),!rt&&t!==-1){const r=t??Ee(nt).keyFadeTimeout;rt=setTimeout(()=>{rt=void 0,wt.update(o=>Ss(o,r))},r)}},clearPlayed(){wt.set([]),clearTimeout(rt),rt=void 0},clearScore(s=!1){s&&Tt.set(["C","Major"]),ul.set([]),wt.set([])}};class Ms{constructor(e,t,l){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=l;const n=[],{count:r}=l,o=t.map(i=>typeof i=="object"&&i!==null?{...i}:i);let a=l.duplicates;!l.duplicates&&r>o.length&&(console.warn(`Trying to create game with count ${r} larger than available unique values ${t.length}`),a=!0);for(let i=0;i<r;i+=1){const c=Math.floor(Math.random()*o.length);if(a)n.push(o[c]);else{const d=o.splice(c,1);d.length>0&&n.push(d[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function bo(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const o=Math.min(l,n);l-=o,n-=o}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function yo(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const r=t[n],o=s+r.semitones,a=e.scaleNotes.find(g=>g.semitones===o%12),i=r.flats>0,c=r.sharps>0,d=(i?o+1:c?o-1:o)%12,f=i?-1:c?1:0;l.push(bo(a??e.notesMap.get(d),a?0:f,o))}return l}const ko=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function wo(s){const t=(s-12)%12;return{...ko[t],semitones:t,midi:s}}function Eo(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class mt extends Ms{constructor(e,t,l){const n=t.range[0],r=t.range[1],o=new Set(t.scale.scaleNotes.map(i=>i.semitones)),a=l.chords.flatMap(i=>{const c=[],d=i.intervals.reduce((f,g)=>g.semitones>f?g.semitones:f,0);for(let f=n;f<=r-d;f+=1)if((!l.onlyScale||o.has(f%12))&&(!i.allowed||i.allowed.has(f%12))){const g=yo(f,t.scale,i.intervals);c.push({...i,rootNote:g[0].note,chord:`${g[0].note}${i.suffixes[0]}`,notes:g})}return c});super(e,a,t),this.played=new Set,this.opts=l}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${Eo(e)}${e.chord.toLowerCase()}`,notes:[]};let l=this.current.chord===t.chord;return this.current.chord.slice(-3)==="maj"&&!l&&(l=this.current.chord.slice(0,-3)===t.chord),this.addGuessed(t,l)}guess(){const e=Array.from(this.played.values()).map(n=>wo(n)).sort((n,r)=>n.midi-r.midi);this.played.clear();const t={chord:"",notes:e},l=this.current.notes.every(n=>e.find(r=>r.midi%12===n.midi%12));return this.addGuessed(t,l)}}const Co={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class Ft extends Ms{constructor(e,t){const l=e==="keys-major"?"major":"minor";super(e,Object.keys(Co[l]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class jt extends Ms{constructor(e,t){const l=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-l+1)).map((r,o)=>l+o),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const In={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},ht=Ve("waiting"),_t=gt(Ve(In),{key:"game-options"}),It=Ve(void 0),Rs=Ve(En().map(s=>({...s,selected:!0}))),Le={play(...[s,e]){var i,c,d;let t;const l=Ee(pt),n=Ee(ps),r=Ee(_t),o={scale:l,range:n,duplicates:r.duplicates,count:r.count};let a=[l.key,l.scale];if(s==="notes")t=new jt(s,o),De.setTarget([De.getNote(t.current)]),(i=Ee(lt))==null||i.noteOn(t.current);else if(s==="pitches")t=new jt(s,o),De.setTarget(),Be.setInputValue("useSound",!0),(c=Ee(lt))==null||c.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new Ft(s,o),a=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new mt(s,o,e);else if(s==="chords-diatonic"){const f=Cn(l.triads).map((g,_)=>({...g,allowed:new Set([l.scaleNotes[_].semitones])}));t=new mt(s,o,{chords:f})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((d=Ee(lt))==null||d.playChord(t.current.notes.map(f=>f.midi)),De.setTarget(t.current.notes)),De.setKeyAndScale(a[0],a[1]),De.clearPlayed(),ht.set("waiting"),It.set(t),t},updateState(s){ht.set(s)},setOptionValue(s,e){_t.update(t=>({...t,[s]:e}))},toggleChords(s){Rs.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Ee(It);s!=null&&s.ended?ht.set("ended"):s instanceof jt?(s.type==="notes"?De.setTarget([De.getNote(s.current)]):De.setTarget(),De.clearPlayed(),(e=Ee(lt))==null||e.noteOn(s.current),Le.updateState("waiting"),s.startTime()):s instanceof mt?(De.setTarget(s.current.notes),De.clearPlayed(),(t=Ee(lt))==null||t.playChord(s==null?void 0:s.current.notes.map(l=>l.midi)),ht.set("waiting"),s.startTime()):s instanceof Ft&&(De.setKey(s.current),ht.set("waiting"),s.startTime())},clearGame(s=!1){const e=Ee(It);e&&De.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&_t.set(In),It.set(void 0),ht.set("waiting"),De.clearScore()}};function fl(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function dl(s,e,t){const l=s.slice();return l[40]=e[t],l}function hl(s,e,t){const l=s.slice();return l[9]=e[t],l}function ml(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function _l(s,e,t){const l=s.slice();return l[40]=e[t],l}function pl(s,e,t){const l=s.slice();return l[9]=e[t],l}function Io(s){let e,t=de(s[35].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=gl(_l(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r[0]&128){t=de(n[35].intervals);let o;for(o=0;o<t.length;o+=1){const a=_l(n,t,o);l[o]?l[o].p(a,r):(l[o]=gl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function To(s){let e,t=de(s[3][s[37]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=vl(pl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r[0]&8){t=de(n[3][n[37]]);let o;for(o=0;o<t.length;o+=1){const a=pl(n,t,o);l[o]?l[o].p(a,r):(l[o]=vl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function gl(s){let e,t=s[40].interval+"",l;return{c(){e=b("span"),l=X(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=Z(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&128&&t!==(t=n[40].interval+"")&&pe(l,t)},d(n){n&&p(e)}}}function vl(s){let e,t=s[9].note+"",l;return{c(){e=b("span"),l=X(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=Z(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&8&&t!==(t=n[9].note+"")&&pe(l,t)},d(n){n&&p(e)}}}function bl(s){let e,t,l,n,r,o,a=s[35].suffixes[0]+"",i,c,d,f,g,_,h,v=s[35].name+"",S,k,E,L,O;n=new Ue({props:{icon:s[35].selected?us:fs,width:12}});function K(){return s[25](s[35])}function N(D,P){return D[3][D[37]]&&D[3][D[37]].length>0?To:Io}let T=N(s),A=T(s);function w(){return s[26](s[35])}return{c(){e=b("li"),t=b("button"),l=b("span"),ge(n.$$.fragment),r=j(),o=b("div"),i=X(a),c=j(),d=b("li"),A.c(),g=j(),_=b("li"),h=b("button"),S=X(v),k=j(),this.h()},l(D){e=y(D,"LI",{});var P=C(e);t=y(P,"BUTTON",{class:!0});var I=C(t);l=y(I,"SPAN",{class:!0});var V=C(l);ve(n.$$.fragment,V),V.forEach(p),r=B(I),o=y(I,"DIV",{class:!0});var R=C(o);i=Z(R,a),R.forEach(p),I.forEach(p),P.forEach(p),c=B(D),d=y(D,"LI",{class:!0,title:!0});var M=C(d);A.l(M),M.forEach(p),g=B(D),_=y(D,"LI",{class:!0});var F=C(_);h=y(F,"BUTTON",{class:!0});var ee=C(h);S=Z(ee,v),ee.forEach(p),k=B(F),F.forEach(p),this.h()},h(){m(l,"class","px-1 py-1 rounded"),$(l,"text-green-500",s[35].selected),$(l,"text-gray-400",!s[35].selected),m(o,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),m(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),$(t,"hidden",s[8]),m(d,"class","intervals svelte-1rg0xw5"),m(d,"title",f=s[35].intervals.map(El).join("-")),m(h,"class","text-start"),m(_,"class","text-xs")},m(D,P){U(D,e,P),u(e,t),u(t,l),be(n,l,null),u(t,r),u(t,o),u(o,i),U(D,c,P),U(D,d,P),A.m(d,null),U(D,g,P),U(D,_,P),u(_,h),u(h,S),u(_,k),E=!0,L||(O=[J(t,"click",K),J(h,"click",w)],L=!0)},p(D,P){s=D;const I={};P[0]&128&&(I.icon=s[35].selected?us:fs),n.$set(I),(!E||P[0]&128)&&$(l,"text-green-500",s[35].selected),(!E||P[0]&128)&&$(l,"text-gray-400",!s[35].selected),(!E||P[0]&128)&&a!==(a=s[35].suffixes[0]+"")&&pe(i,a),(!E||P[0]&256)&&$(t,"hidden",s[8]),T===(T=N(s))&&A?A.p(s,P):(A.d(1),A=T(s),A&&(A.c(),A.m(d,null))),(!E||P[0]&128&&f!==(f=s[35].intervals.map(El).join("-")))&&m(d,"title",f),(!E||P[0]&128)&&v!==(v=s[35].name+"")&&pe(S,v)},i(D){E||(x(n.$$.fragment,D),E=!0)},o(D){W(n.$$.fragment,D),E=!1},d(D){D&&(p(e),p(c),p(d),p(g),p(_)),ye(n),A.d(),L=!1,Xe(O)}}}function Ao(s){let e,t=de(s[35].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=yl(dl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r[0]&64){t=de(n[35].intervals);let o;for(o=0;o<t.length;o+=1){const a=dl(n,t,o);l[o]?l[o].p(a,r):(l[o]=yl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function No(s){let e,t=de(s[4][s[37]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=kl(hl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r[0]&16){t=de(n[4][n[37]]);let o;for(o=0;o<t.length;o+=1){const a=hl(n,t,o);l[o]?l[o].p(a,r):(l[o]=kl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function yl(s){let e,t=s[40].interval+"",l;return{c(){e=b("span"),l=X(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=Z(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&64&&t!==(t=n[40].interval+"")&&pe(l,t)},d(n){n&&p(e)}}}function kl(s){let e,t=s[9].note+"",l;return{c(){e=b("span"),l=X(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=Z(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&16&&t!==(t=n[9].note+"")&&pe(l,t)},d(n){n&&p(e)}}}function wl(s){let e,t,l,n,r,o,a=s[35].suffixes[0]+"",i,c,d,f,g,_,h,v=s[35].name+"",S,k,E,L,O;n=new Ue({props:{icon:s[35].selected?us:fs,width:12}});function K(){return s[27](s[35])}function N(D,P){return D[4][D[37]]&&D[4][D[37]].length>0?No:Ao}let T=N(s),A=T(s);function w(){return s[28](s[35])}return{c(){e=b("li"),t=b("button"),l=b("span"),ge(n.$$.fragment),r=j(),o=b("div"),i=X(a),c=j(),d=b("li"),A.c(),g=j(),_=b("li"),h=b("button"),S=X(v),k=j(),this.h()},l(D){e=y(D,"LI",{});var P=C(e);t=y(P,"BUTTON",{class:!0});var I=C(t);l=y(I,"SPAN",{class:!0});var V=C(l);ve(n.$$.fragment,V),V.forEach(p),r=B(I),o=y(I,"DIV",{class:!0});var R=C(o);i=Z(R,a),R.forEach(p),I.forEach(p),P.forEach(p),c=B(D),d=y(D,"LI",{class:!0,title:!0});var M=C(d);A.l(M),M.forEach(p),g=B(D),_=y(D,"LI",{class:!0});var F=C(_);h=y(F,"BUTTON",{class:!0});var ee=C(h);S=Z(ee,v),ee.forEach(p),k=B(F),F.forEach(p),this.h()},h(){m(l,"class","px-1 py-1 rounded"),$(l,"text-green-500",s[35].selected),$(l,"text-gray-400",!s[35].selected),m(o,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),m(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),$(t,"hidden",s[8]),m(d,"class","intervals svelte-1rg0xw5"),m(d,"title",f=s[35].intervals.map(Cl).join("-")),m(h,"class","text-start"),m(_,"class","text-xs")},m(D,P){U(D,e,P),u(e,t),u(t,l),be(n,l,null),u(t,r),u(t,o),u(o,i),U(D,c,P),U(D,d,P),A.m(d,null),U(D,g,P),U(D,_,P),u(_,h),u(h,S),u(_,k),E=!0,L||(O=[J(t,"click",K),J(h,"click",w)],L=!0)},p(D,P){s=D;const I={};P[0]&64&&(I.icon=s[35].selected?us:fs),n.$set(I),(!E||P[0]&64)&&$(l,"text-green-500",s[35].selected),(!E||P[0]&64)&&$(l,"text-gray-400",!s[35].selected),(!E||P[0]&64)&&a!==(a=s[35].suffixes[0]+"")&&pe(i,a),(!E||P[0]&256)&&$(t,"hidden",s[8]),T===(T=N(s))&&A?A.p(s,P):(A.d(1),A=T(s),A&&(A.c(),A.m(d,null))),(!E||P[0]&64&&f!==(f=s[35].intervals.map(Cl).join("-")))&&m(d,"title",f),(!E||P[0]&64)&&v!==(v=s[35].name+"")&&pe(S,v)},i(D){E||(x(n.$$.fragment,D),E=!0)},o(D){W(n.$$.fragment,D),E=!1},d(D){D&&(p(e),p(c),p(d),p(g),p(_)),ye(n),A.d(),L=!1,Xe(O)}}}function So(s){let e,t,l,n,r="Chords",o,a,i,c,d,f,g,_,h,v,S,k,E,L,O,K,N,T="Key",A,w,D,P,I="Scale",V,R,M,F,ee="Note",ie,Y,z,G,le,H,se,ce,Ce,oe;c=new Ue({props:{icon:Un,width:20}}),g=new Ue({props:{icon:Kn,width:16}}),v=new Ue({props:{icon:s[5]?Qs:Xs,width:16}}),E=new Ue({props:{icon:zt,width:16}}),R=new yn({props:{class:"bg-gray-100 w-48",containerClass:"input w-48",selected:s[1],options:s[10],onSelect:s[14]}});let he=de(s[7]),Q=[];for(let q=0;q<he.length;q+=1)Q[q]=bl(ml(s,he,q));const ue=q=>W(Q[q],1,1,()=>{Q[q]=null});let we=de(s[6]),fe=[];for(let q=0;q<we.length;q+=1)fe[q]=wl(fl(s,we,q));const He=q=>W(fe[q],1,1,()=>{fe[q]=null});return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,o=j(),a=b("div"),i=b("button"),ge(c.$$.fragment),d=j(),f=b("button"),ge(g.$$.fragment),_=j(),h=b("button"),ge(v.$$.fragment),S=j(),k=b("button"),ge(E.$$.fragment),L=j(),O=b("div"),K=b("div"),N=b("label"),N.textContent=T,A=j(),w=b("input"),D=j(),P=b("label"),P.textContent=I,V=j(),ge(R.$$.fragment),M=j(),F=b("label"),F.textContent=ee,ie=j(),Y=b("input"),z=j(),G=b("ul");for(let q=0;q<Q.length;q+=1)Q[q].c();le=j(),H=b("ul");for(let q=0;q<fe.length;q+=1)fe[q].c();this.h()},l(q){e=y(q,"DIV",{class:!0});var re=C(e);t=y(re,"FIELDSET",{class:!0});var ke=C(t);l=y(ke,"LEGEND",{class:!0});var tt=C(l);n=y(tt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-1knqzl6"&&(n.textContent=r),tt.forEach(p),o=B(ke),a=y(ke,"DIV",{class:!0});var ne=C(a);i=y(ne,"BUTTON",{class:!0});var je=C(i);ve(c.$$.fragment,je),je.forEach(p),d=B(ne),f=y(ne,"BUTTON",{class:!0});var Me=C(f);ve(g.$$.fragment,Me),Me.forEach(p),_=B(ne),h=y(ne,"BUTTON",{class:!0});var vt=C(h);ve(v.$$.fragment,vt),vt.forEach(p),S=B(ne),k=y(ne,"BUTTON",{class:!0});var Nt=C(k);ve(E.$$.fragment,Nt),Nt.forEach(p),ne.forEach(p),L=B(ke),O=y(ke,"DIV",{class:!0});var ze=C(O);K=y(ze,"DIV",{class:!0});var Ke=C(K);N=y(Ke,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(N)!=="svelte-14m38zf"&&(N.textContent=T),A=B(Ke),w=y(Ke,"INPUT",{class:!0,id:!0}),D=B(Ke),P=y(Ke,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(P)!=="svelte-bxhcb0"&&(P.textContent=I),V=B(Ke),ve(R.$$.fragment,Ke),M=B(Ke),F=y(Ke,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(F)!=="svelte-dmbfli"&&(F.textContent=ee),ie=B(Ke),Y=y(Ke,"INPUT",{class:!0,id:!0}),Ke.forEach(p),z=B(ze),G=y(ze,"UL",{class:!0});var St=C(G);for(let $e=0;$e<Q.length;$e+=1)Q[$e].l(St);St.forEach(p),le=B(ze),H=y(ze,"UL",{class:!0});var st=C(H);for(let $e=0;$e<fe.length;$e+=1)fe[$e].l(st);st.forEach(p),ze.forEach(p),ke.forEach(p),re.forEach(p),this.h()},h(){m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(i,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),$(i,"hidden",s[8]),m(f,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(f,"hidden",s[8]),m(h,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(h,"hidden",s[8]),m(k,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(k,"hidden",s[8]),m(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),m(N,"class","mr-4 font-bold svelte-1rg0xw5"),m(N,"for","scale-key"),m(w,"class","input bg-gray-100 w-12 px-1 rounded"),m(w,"id","scale-key"),w.value=s[0],m(P,"class","font-bold svelte-1rg0xw5"),m(P,"for","scale-key"),m(F,"class","font-bold svelte-1rg0xw5"),m(F,"for","scale-key"),m(Y,"class","input bg-gray-100 w-12 px-1 rounded"),m(Y,"id","scale-key"),Y.value=s[2],m(K,"class","flex mb-2 options svelte-1rg0xw5"),m(G,"class","chord-list w-full svelte-1rg0xw5"),m(H,"class","chord-list w-full svelte-1rg0xw5"),m(O,"class","body svelte-1rg0xw5"),$(O,"hidden",s[8]),m(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1rg0xw5"),$(t,"collapsed",s[8]),m(e,"class",se=Te(`${s[22].class||""}`)+" svelte-1rg0xw5")},m(q,re){U(q,e,re),u(e,t),u(t,l),u(l,n),u(t,o),u(t,a),u(a,i),be(c,i,null),u(a,d),u(a,f),be(g,f,null),u(a,_),u(a,h),be(v,h,null),u(a,S),u(a,k),be(E,k,null),u(t,L),u(t,O),u(O,K),u(K,N),u(K,A),u(K,w),u(K,D),u(K,P),u(K,V),be(R,K,null),u(K,M),u(K,F),u(K,ie),u(K,Y),u(O,z),u(O,G);for(let ke=0;ke<Q.length;ke+=1)Q[ke]&&Q[ke].m(G,null);u(O,le),u(O,H);for(let ke=0;ke<fe.length;ke+=1)fe[ke]&&fe[ke].m(H,null);ce=!0,Ce||(oe=[J(n,"click",s[12]),J(i,"click",s[17]),J(f,"click",s[18]),J(h,"click",s[19]),J(k,"click",s[20]),J(w,"input",s[13]),J(Y,"input",s[15])],Ce=!0)},p(q,re){(!ce||re[0]&256)&&$(i,"hidden",q[8]),(!ce||re[0]&256)&&$(f,"hidden",q[8]);const ke={};re[0]&32&&(ke.icon=q[5]?Qs:Xs),v.$set(ke),(!ce||re[0]&256)&&$(h,"hidden",q[8]),(!ce||re[0]&256)&&$(k,"hidden",q[8]),(!ce||re[0]&1&&w.value!==q[0])&&(w.value=q[0]);const tt={};if(re[0]&2&&(tt.selected=q[1]),R.$set(tt),(!ce||re[0]&4&&Y.value!==q[2])&&(Y.value=q[2]),re[0]&2163080){he=de(q[7]);let ne;for(ne=0;ne<he.length;ne+=1){const je=ml(q,he,ne);Q[ne]?(Q[ne].p(je,re),x(Q[ne],1)):(Q[ne]=bl(je),Q[ne].c(),x(Q[ne],1),Q[ne].m(G,null))}for(xe(),ne=he.length;ne<Q.length;ne+=1)ue(ne);Fe()}if(re[0]&2163024){we=de(q[6]);let ne;for(ne=0;ne<we.length;ne+=1){const je=fl(q,we,ne);fe[ne]?(fe[ne].p(je,re),x(fe[ne],1)):(fe[ne]=wl(je),fe[ne].c(),x(fe[ne],1),fe[ne].m(H,null))}for(xe(),ne=we.length;ne<fe.length;ne+=1)He(ne);Fe()}(!ce||re[0]&256)&&$(O,"hidden",q[8]),(!ce||re[0]&256)&&$(t,"collapsed",q[8]),(!ce||re[0]&4194304&&se!==(se=Te(`${q[22].class||""}`)+" svelte-1rg0xw5"))&&m(e,"class",se)},i(q){if(!ce){x(c.$$.fragment,q),x(g.$$.fragment,q),x(v.$$.fragment,q),x(E.$$.fragment,q),x(R.$$.fragment,q);for(let re=0;re<he.length;re+=1)x(Q[re]);for(let re=0;re<we.length;re+=1)x(fe[re]);ce=!0}},o(q){W(c.$$.fragment,q),W(g.$$.fragment,q),W(v.$$.fragment,q),W(E.$$.fragment,q),W(R.$$.fragment,q),Q=Q.filter(Boolean);for(let re=0;re<Q.length;re+=1)W(Q[re]);fe=fe.filter(Boolean);for(let re=0;re<fe.length;re+=1)W(fe[re]);ce=!1},d(q){q&&p(e),ye(c),ye(g),ye(v),ye(E),ye(R),Oe(Q,q),Oe(fe,q),Ce=!1,Xe(oe)}}}const El=s=>s.interval,Cl=s=>s.interval;function Do(s,e,t){let l,n,r,o,a,i,c,d,f;_e(s,nt,G=>t(30,a=G)),_e(s,lt,G=>t(31,i=G)),_e(s,Mt,G=>t(32,c=G)),_e(s,Rs,G=>t(24,d=G));let g="C",_="Major",h=xt(g,_),v="",S,k=[],E=[];const O=_s().map(G=>({key:G.names[0],value:G.names[0]})),K=gt(Ve(!0),{key:"chords-hidden"});_e(s,K,G=>t(8,f=G));function N(){K.update(G=>!G)}function T(){const G=S&&60+S.semitones;if("err"in h||!G)t(3,k=[]),t(4,E=[]);else{const le=h.data;t(3,k=n.map(H=>os(G,le,H.intervals))),t(4,E=r.map(H=>os(G,le,H.intervals)))}}function A({currentTarget:{value:G}}){t(0,g=`${G.charAt(0).toUpperCase()}${G.charAt(1).toLowerCase()}`),h=xt(g,_),T()}function w(G){var le;return t(1,_=(le=O.find(H=>G===H.key))==null?void 0:le.value),h=xt(g,_),T(),!1}function D({currentTarget:{value:G}}){t(2,v=`${G.charAt(0).toUpperCase()}${G.charAt(1).toLowerCase()}`),t(9,S=Gs(v)),T()}function P(G){Le.toggleChords(le=>le.name===G.name?!le.selected:le.selected)}function I(){const G=H=>H.suffixes[0]==="maj"||H.suffixes[0]==="m",le=d.filter(G).every(H=>H.selected);Le.toggleChords(H=>G(H)?!le:H.selected)}function V(){const G=H=>H.suffixes[0]==="maj7"||H.suffixes[0]==="m7"||H.suffixes[0]==="7"||H.suffixes[0]==="dim7"||H.suffixes[0]==="aug7",le=d.filter(G).every(H=>H.selected);Le.toggleChords(H=>G(H)?!le:H.selected)}function R(){Le.toggleChords(G=>!o)}function M(){Le.toggleChords(G=>!0)}function F(G){if("err"in h)return;const le=c[0].midi+((S==null?void 0:S.semitones)||0),H=os(le,h.data,G.intervals);i==null||i.playChord(H.map(se=>se.midi),a.fixedVelocity)}const ee=G=>P(G),ie=G=>F(G),Y=G=>P(G),z=G=>F(G);return s.$$set=G=>{t(22,e=Ae(Ae({},e),Ne(G)))},s.$$.update=()=>{s.$$.dirty[0]&16777216&&t(23,l=d),s.$$.dirty[0]&8388608&&t(7,n=l.filter((G,le)=>le<l.length/2)),s.$$.dirty[0]&8388608&&t(6,r=l.filter((G,le)=>le>=l.length/2)),s.$$.dirty[0]&8388608&&t(5,o=l.every(G=>G.selected))},e=Ne(e),[g,_,v,k,E,o,r,n,f,S,O,K,N,A,w,D,P,I,V,R,M,F,e,l,d,ee,ie,Y,z]}class Lo extends qe{constructor(e){super(),We(this,e,Do,So,Je,{},null,[-1,-1])}}function Il(s,e,t){const l=s.slice();return l[12]=e[t],l}function Po(s){let e;return{c(){e=X(" ")},l(t){e=Z(t," ")},m(t,l){U(t,e,l)},p:me,i:me,o:me,d(t){t&&p(e)}}}function Oo(s){let e,t,l="Played:",n,r=de(s[2]),o=[];for(let a=0;a<r.length;a+=1)o[a]=Tl(Il(s,r,a));return{c(){e=b("div"),t=b("span"),t.textContent=l,n=j();for(let a=0;a<o.length;a+=1)o[a].c()},l(a){e=y(a,"DIV",{});var i=C(e);t=y(i,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1g6xxhn"&&(t.textContent=l),n=B(i);for(let c=0;c<o.length;c+=1)o[c].l(i);i.forEach(p)},m(a,i){U(a,e,i),u(e,t),u(e,n);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(e,null)},p(a,i){if(i&4){r=de(a[2]);let c;for(c=0;c<r.length;c+=1){const d=Il(a,r,c);o[c]?o[c].p(d,i):(o[c]=Tl(d),o[c].c(),o[c].m(e,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=r.length}},i:me,o:me,d(a){a&&p(e),Oe(o,a)}}}function Vo(s){let e,t,l="Result:",n,r,o,a=s[0].correct+"",i,c,d=s[0].sampled.length+"",f,g,_,h,v,S=s[0].avgTime+"",k,E;return{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),o=X("["),i=X(a),c=X(" / "),f=X(d),g=X("]"),_=j(),h=b("span"),v=X("avg "),k=X(S),E=X("s"),this.h()},l(L){e=y(L,"DIV",{class:!0});var O=C(e);t=y(O,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1eqfbgx"&&(t.textContent=l),n=B(O),r=y(O,"SPAN",{class:!0});var K=C(r);o=Z(K,"["),i=Z(K,a),c=Z(K," / "),f=Z(K,d),g=Z(K,"]"),K.forEach(p),_=B(O),h=y(O,"SPAN",{});var N=C(h);v=Z(N,"avg "),k=Z(N,S),E=Z(N,"s"),N.forEach(p),O.forEach(p),this.h()},h(){m(r,"class","mx-2"),m(e,"class","flex")},m(L,O){U(L,e,O),u(e,t),u(e,n),u(e,r),u(r,o),u(r,i),u(r,c),u(r,f),u(r,g),u(e,_),u(e,h),u(h,v),u(h,k),u(h,E)},p(L,O){O&1&&a!==(a=L[0].correct+"")&&pe(i,a),O&1&&d!==(d=L[0].sampled.length+"")&&pe(f,d),O&1&&S!==(S=L[0].avgTime+"")&&pe(k,S)},i:me,o:me,d(L){L&&p(e)}}}function jo(s){var D,P,I,V;let e,t,l="Target:",n,r,o=((D=s[0].latestGuess.target)==null?void 0:D.chord)+"",a,i,c,d=((P=s[0].latestGuess.target)==null?void 0:P.notes.map(Al).join(" "))+"",f,g,_,h,v,S,k,E,L=((I=s[0].latestGuess.guessed)==null?void 0:I.chord)+"",O,K,N,T=((V=s[0].latestGuess.guessed)==null?void 0:V.notes.map(Nl).join(" "))+"",A,w;return v=new Ue({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),a=X(o),i=j(),c=b("span"),f=X(d),g=j(),_=b("span"),h=b("div"),ge(v.$$.fragment),S=X(`
        Guessed:`),k=j(),E=b("span"),O=X(L),K=j(),N=b("span"),A=X(T),this.h()},l(R){e=y(R,"DIV",{class:!0});var M=C(e);t=y(M,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1pddpsb"&&(t.textContent=l),n=B(M),r=y(M,"SPAN",{});var F=C(r);a=Z(F,o),F.forEach(p),i=B(M),c=y(M,"SPAN",{});var ee=C(c);f=Z(ee,d),ee.forEach(p),g=B(M),_=y(M,"SPAN",{class:!0});var ie=C(_);h=y(ie,"DIV",{class:!0});var Y=C(h);ve(v.$$.fragment,Y),Y.forEach(p),S=Z(ie,`
        Guessed:`),ie.forEach(p),k=B(M),E=y(M,"SPAN",{});var z=C(E);O=Z(z,L),z.forEach(p),K=B(M),N=y(M,"SPAN",{});var G=C(N);A=Z(G,T),G.forEach(p),M.forEach(p),this.h()},h(){m(h,"class","absolute left-[-2rem] p-1"),m(_,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(R,M){U(R,e,M),u(e,t),u(e,n),u(e,r),u(r,a),u(e,i),u(e,c),u(c,f),u(e,g),u(e,_),u(_,h),be(v,h,null),u(_,S),u(e,k),u(e,E),u(E,O),u(e,K),u(e,N),u(N,A),w=!0},p(R,M){var ee,ie,Y,z;(!w||M&1)&&o!==(o=((ee=R[0].latestGuess.target)==null?void 0:ee.chord)+"")&&pe(a,o),(!w||M&1)&&d!==(d=((ie=R[0].latestGuess.target)==null?void 0:ie.notes.map(Al).join(" "))+"")&&pe(f,d);const F={};M&2&&(F.icon=R[1]==="correct"?Bt:Gt),v.$set(F),(!w||M&1)&&L!==(L=((Y=R[0].latestGuess.guessed)==null?void 0:Y.chord)+"")&&pe(O,L),(!w||M&1)&&T!==(T=((z=R[0].latestGuess.guessed)==null?void 0:z.notes.map(Nl).join(" "))+"")&&pe(A,T)},i(R){w||(x(v.$$.fragment,R),w=!0)},o(R){W(v.$$.fragment,R),w=!1},d(R){R&&p(e),ye(v)}}}function Bo(s){let e,t,l="Target:",n,r,o=s[0].latestGuess.target+"",a,i,c,d,f,g,_,h,v,S,k=s[0].latestGuess.guessed+"",E,L,O,K;return _=new Ue({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),a=X(o),i=j(),c=b("span"),d=j(),f=b("span"),g=b("div"),ge(_.$$.fragment),h=X(`
        Guessed:`),v=j(),S=b("span"),E=X(k),L=j(),O=b("span"),this.h()},l(N){e=y(N,"DIV",{class:!0});var T=C(e);t=y(T,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=B(T),r=y(T,"SPAN",{});var A=C(r);a=Z(A,o),A.forEach(p),i=B(T),c=y(T,"SPAN",{}),C(c).forEach(p),d=B(T),f=y(T,"SPAN",{class:!0});var w=C(f);g=y(w,"DIV",{class:!0});var D=C(g);ve(_.$$.fragment,D),D.forEach(p),h=Z(w,`
        Guessed:`),w.forEach(p),v=B(T),S=y(T,"SPAN",{});var P=C(S);E=Z(P,k),P.forEach(p),L=B(T),O=y(T,"SPAN",{}),C(O).forEach(p),T.forEach(p),this.h()},h(){m(g,"class","absolute left-[-2rem] p-1"),m(f,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(N,T){U(N,e,T),u(e,t),u(e,n),u(e,r),u(r,a),u(e,i),u(e,c),u(e,d),u(e,f),u(f,g),be(_,g,null),u(f,h),u(e,v),u(e,S),u(S,E),u(e,L),u(e,O),K=!0},p(N,T){(!K||T&1)&&o!==(o=N[0].latestGuess.target+"")&&pe(a,o);const A={};T&2&&(A.icon=N[1]==="correct"?Bt:Gt),_.$set(A),(!K||T&1)&&k!==(k=N[0].latestGuess.guessed+"")&&pe(E,k)},i(N){K||(x(_.$$.fragment,N),K=!0)},o(N){W(_.$$.fragment,N),K=!1},d(N){N&&p(e),ye(_)}}}function Go(s){let e,t,l="Target:",n,r,o=s[8](s[0].latestGuess.target||0)+"",a,i,c,d,f,g,_,h,v,S,k=s[8](s[0].latestGuess.guessed||0)+"",E,L,O,K="",N;return _=new Ue({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),a=X(o),i=j(),c=b("span"),d=j(),f=b("span"),g=b("div"),ge(_.$$.fragment),h=X(`
        Guessed:`),v=j(),S=b("span"),E=X(k),L=j(),O=b("span"),O.innerHTML=K,this.h()},l(T){e=y(T,"DIV",{class:!0});var A=C(e);t=y(A,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=B(A),r=y(A,"SPAN",{});var w=C(r);a=Z(w,o),w.forEach(p),i=B(A),c=y(A,"SPAN",{}),C(c).forEach(p),d=B(A),f=y(A,"SPAN",{class:!0});var D=C(f);g=y(D,"DIV",{class:!0});var P=C(g);ve(_.$$.fragment,P),P.forEach(p),h=Z(D,`
        Guessed:`),D.forEach(p),v=B(A),S=y(A,"SPAN",{});var I=C(S);E=Z(I,k),I.forEach(p),L=B(A),O=y(A,"SPAN",{"data-svelte-h":!0}),ae(O)!=="svelte-1qufua2"&&(O.innerHTML=K),A.forEach(p),this.h()},h(){m(g,"class","absolute left-[-2rem] p-1"),m(f,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(T,A){U(T,e,A),u(e,t),u(e,n),u(e,r),u(r,a),u(e,i),u(e,c),u(e,d),u(e,f),u(f,g),be(_,g,null),u(f,h),u(e,v),u(e,S),u(S,E),u(e,L),u(e,O),N=!0},p(T,A){(!N||A&1)&&o!==(o=T[8](T[0].latestGuess.target||0)+"")&&pe(a,o);const w={};A&2&&(w.icon=T[1]==="correct"?Bt:Gt),_.$set(w),(!N||A&1)&&k!==(k=T[8](T[0].latestGuess.guessed||0)+"")&&pe(E,k)},i(T){N||(x(_.$$.fragment,T),N=!0)},o(T){W(_.$$.fragment,T),N=!1},d(T){T&&p(e),ye(_)}}}function Tl(s){let e,t=dt(s[12])+"",l;return{c(){e=b("span"),l=X(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=Z(r,t),r.forEach(p),this.h()},h(){m(e,"class","mx-1")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r&4&&t!==(t=dt(n[12])+"")&&pe(l,t)},d(n){n&&p(e)}}}function Mo(s){let e;return{c(){e=X(" ")},l(t){e=Z(t," ")},m(t,l){U(t,e,l)},p:me,d(t){t&&p(e)}}}function Ro(s){let e,t="Next",l,n,r="Autoplay",o,a;return{c(){e=b("button"),e.textContent=t,l=j(),n=b("button"),n.textContent=r,this.h()},l(i){e=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-uy473n"&&(e.textContent=t),l=B(i),n=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-1cfj1sl"&&(n.textContent=r),this.h()},h(){m(e,"class","btn primary mr-1"),m(n,"class","btn primary")},m(i,c){U(i,e,c),U(i,l,c),U(i,n,c),o||(a=[J(e,"click",s[4]),J(n,"click",s[5])],o=!0)},p:me,d(i){i&&(p(e),p(l),p(n)),o=!1,Xe(a)}}}function Uo(s){let e,t="Stop autoplay",l,n;return{c(){e=b("button"),e.textContent=t,this.h()},l(r){e=y(r,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){m(e,"class","btn primary")},m(r,o){U(r,e,o),l||(n=J(e,"click",s[10]),l=!0)},p:me,d(r){r&&p(e),l=!1,n()}}}function Ko(s){let e,t="Try Again",l,n,r="Clear",o,a;return{c(){e=b("button"),e.textContent=t,l=j(),n=b("button"),n.textContent=r,this.h()},l(i){e=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-15zs1cu"&&(e.textContent=t),l=B(i),n=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-11mnk9v"&&(n.textContent=r),this.h()},h(){m(e,"class","btn primary mr-1"),m(n,"class","btn primary")},m(i,c){U(i,e,c),U(i,l,c),U(i,n,c),o||(a=[J(e,"click",s[6]),J(n,"click",s[7])],o=!0)},p:me,d(i){i&&(p(e),p(l),p(n)),o=!1,Xe(a)}}}function xo(s){let e,t,l,n,r,o,a;const i=[Go,Bo,jo,Vo,Oo,Po],c=[];function d(h,v){return h[0]instanceof jt&&(h[1]==="correct"||h[1]==="wrong")?0:h[0]instanceof Ft&&(h[1]==="correct"||h[1]==="wrong")?1:h[0]instanceof mt&&(h[1]==="correct"||h[1]==="wrong")?2:h[0]&&h[1]==="ended"?3:h[2].length>0?4:5}t=d(s),l=c[t]=i[t](s);function f(h,v){return h[0]&&h[1]==="ended"?Ko:h[0]&&h[3].autoplay?Uo:h[0]?Ro:Mo}let g=f(s),_=g(s);return{c(){e=b("div"),l.c(),r=j(),o=b("div"),_.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var v=C(e);l.l(v),v.forEach(p),r=B(h),o=y(h,"DIV",{class:!0});var S=C(o);_.l(S),S.forEach(p),this.h()},h(){m(e,"class",n=Te(`${s[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),m(o,"class","mt-2 h-8 flex items-center")},m(h,v){U(h,e,v),c[t].m(e,null),U(h,r,v),U(h,o,v),_.m(o,null),a=!0},p(h,[v]){let S=t;t=d(h),t===S?c[t].p(h,v):(xe(),W(c[S],1,1,()=>{c[S]=null}),Fe(),l=c[t],l?l.p(h,v):(l=c[t]=i[t](h),l.c()),x(l,1),l.m(e,null)),(!a||v&512&&n!==(n=Te(`${h[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"))&&m(e,"class",n),g===(g=f(h))&&_?_.p(h,v):(_.d(1),_=g(h),_&&(_.c(),_.m(o,null)))},i(h){a||(x(l),a=!0)},o(h){W(l),a=!1},d(h){h&&(p(e),p(r),p(o)),c[t].d(),_.d()}}}const Al=s=>s.note,Nl=s=>s.note;function Fo(s,e,t){let l,n,r,o;_e(s,pt,h=>t(11,l=h)),_e(s,ht,h=>t(1,n=h)),_e(s,wt,h=>t(2,r=h)),_e(s,_t,h=>t(3,o=h));let{game:a}=e;function i(){Le.nextGuess()}function c(){Le.setOptionValue("autoplay",!0),Le.nextGuess()}function d(){a instanceof mt?Le.play(a.type,a.opts):a&&Le.play(a.type,void 0)}function f(){Le.clearGame()}function g(h){const v=l.notesMap.get(h%12);return dt({midi:h,...v})}const _=()=>Le.setOptionValue("autoplay",!1);return s.$$set=h=>{t(9,e=Ae(Ae({},e),Ne(h))),"game"in h&&t(0,a=h.game)},e=Ne(e),[a,n,r,o,i,c,d,f,g,e,_]}class Ho extends qe{constructor(e){super(),We(this,e,Fo,xo,Je,{game:0})}}const Ds={ar:{name:"Arabic",import:Ie(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:Ie(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:Ie(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:Ie(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:Ie(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:Ie(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:Ie(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:Ie(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:Ie(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>qo)},fa:{name:"Farsi",import:Ie(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:Ie(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:Ie(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:Ie(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:Ie(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:Ie(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:Ie(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:Ie(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:Ie(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:Ie(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:Ie(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:Ie(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:Ie(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:Ie(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:Ie(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:Ie(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:Ie(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:Ie(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:Ie(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:Ie(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:Ie(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:Ie(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:Ie(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:Ie(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function Tn(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default.slice(0,4)}}async function zo(s=["en"]){let e={code:"en",layout:Ds.en,index:99};Object.entries(Ds).forEach(([l,n])=>{for(let r=0;r<s.length;r+=1)l===s[r]&&(!e||e.index>r)&&(e={code:l,layout:n,index:r})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:Tn(t.default)}}const An={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},qo=Object.freeze(Object.defineProperty({__proto__:null,default:An},Symbol.toStringTag,{value:"Module"})),Nn=[0,2,4,5,7,9,11],Sn=[1,3,-1,6,8,10,-1];function Wo(s,e,t){const l=s.keyType==="white"?Nn:Sn,n=l[t%l.length];let r;if(n>=0){r=e[n];const o=Math.floor(t/l.length);return{...r,semitones:r.semitones+(o>0?o:0)*12}}}function Vt(s,e,t=0,l=0){const n=s.keyType==="white"?Nn:Sn;let r=-1,o=0,a=0;return s.keys.forEach((i,c)=>{if(i.key.charAt(0)!=="{"&&c>=t&&r===-1?r=c:r!==-1&&i.key==="{empty}"&&(o+=1),r!==-1&&i.key.charAt(0)!=="{"){const d=c-o-r+l,f=n[d%n.length];if(f>=0){const g=e[f],_=Math.floor(d/n.length);i.note={...g,semitones:g.semitones+(_>0?_:0)*12},a=c-r}}}),{firstIndex:r,lastIndex:a}}const Dn=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function Jo(s,e){let t=[];const l=s.default.map((o,a)=>{if(a===0){const i=o.split(" ").filter(c=>c!=="{bksp}");for(;i.length!==13;)i.length<13?i.unshift("{empty}"):i.shift();return[...i,"{bksp}"]}else if(a===1){const i=o.split(" ");return t=i.slice(13),[...i.slice(0,13),"{enter}"]}else{if(a===2)return[...o.split(" ").slice(0,13).filter(i=>i!=="{enter}"),...t].slice(0,13);if(a===3){const i=["{shift}",...o.split(" ").slice(1,12).filter(d=>d!=="{shift}"),"{shift}"];let c=1;for(;i.length<13;)i.splice(c,0,"{empty}"),c=c===1?-1:1;return i}else return o.split(" ")}});let n;s.codes?n=s.codes.map(o=>o.split(" ")):n=Dn;const r=[0,1,2,3].map(o=>l[o].map((a,i)=>({key:a,code:n[o][i]})));return[{keyType:e==="two-rows"?"black":null,startNoteOffset:2,availableNotes:11,keys:r[0]},{keyType:e==="two-rows"?"white":"black",startNoteOffset:e==="two-rows"?1:2,availableNotes:12,keys:r[1]},{keyType:e==="two-rows"?"black":"white",startNoteOffset:1,availableNotes:12,keys:r[2]},{keyType:e==="two-rows"?"white":null,startNoteOffset:1,availableNotes:11,keys:r[3]}]}const Sl=[{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]}];class Ln{constructor(e){return this.rows=Sl,this.setCustomRow={row:Sl[0],rowIndex:0,nextKeyIdx:-1,nextNoteOffset:0},this.opts={hotkeydRows:"middle-row",isCustom:!1,layout:{code:"en",name:"English",imported:Tn(An)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=Jo(e,this.opts.hotkeydRows),this}setRows(e){return this.rows=e,this}setNotes(e){if(this.opts.hotkeydRows==="middle-row"){const{firstIndex:t}=Vt(this.rows[2],e);Vt(this.rows[1],e,1+t)}else{const{firstIndex:t,lastIndex:l}=Vt(this.rows[3],e);Vt(this.rows[2],e,t);const{firstIndex:n}=Vt(this.rows[1],e,0,l+1);Vt(this.rows[0],e,1+n,l+1)}}startSetCustomRow(e){const t={...this.rows[e],keys:this.rows[e].keys.map(a=>({...a}))},{availableNotes:l,startNoteOffset:n}=t,r=this.opts.hotkeydRows==="two-rows"&&(e===0||e===1)?3:-1,o=r!==-1?this.rows[r].keys.reduce((a,i)=>(a===-1&&i.note?a=0:a!==-1&&(i.key[0]!=="{"||i.key==="{empty}")&&(a+=1),a),-1)+1:0;return this.setCustomRow={row:t,rowIndex:e,nextKeyIdx:n,nextNoteOffset:o},{first:n,count:l}}setNextCustomNote(e,t,l){let n;const{nextKeyIdx:r,nextNoteOffset:o,row:a}=this.setCustomRow,i=r+o-a.startNoteOffset,c=Wo(a,l,i);return c?n={key:e,code:t,note:c}:n={key:e,code:t},this.setCustomRow.nextKeyIdx+=1,{index:this.setCustomRow.nextKeyIdx,key:n}}skipNextCustomNote(){return this.setCustomRow.nextKeyIdx+=1,this.setCustomRow.nextNoteOffset-=1,{index:this.setCustomRow.nextKeyIdx,key:{code:"EMPTY",key:"{empty}"}}}}function $o(s){const e=[...s.map(n=>n.keys.map(r=>r.key).join(" "))],t=["","","",""];let l=!1;return s.forEach((n,r)=>{const o=[];for(let a=0;a<n.keys.length;a+=1)o.push(n.keys[a].code),l=l||n.keys[a].code!==Dn[r][a];t[r]=o.join(" ")}),l?{default:e,codes:t}:{default:e}}function Dl(s,e,t){const l=s.slice();return l[15]=e[t].key,l[16]=e[t].value,l[17]=e[t].icon,l[19]=t,l}const Yo=s=>({}),Ll=s=>({}),Qo=s=>({}),Pl=s=>({});function Ol(s){let e,t,l,n,r,o,a,i,c,d,f;const g=s[12].header,_=Ps(g,s,s[11],Ll);let h=de(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=Vl(Dl(s,h,k));const S=k=>W(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),l=j(),n=b("ul"),r=b("li"),_&&_.c(),o=j();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(p),l=B(k),n=y(k,"UL",{class:!0});var E=C(n);r=y(E,"LI",{});var L=C(r);_&&_.l(L),L.forEach(p),o=B(E);for(let O=0;O<v.length;O+=1)v[O].l(E);E.forEach(p),this.h()},h(){m(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),m(e,"tabindex","-1"),m(n,"class",a=Te(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,E){U(k,e,E),U(k,l,E),U(k,n,E),u(n,r),_&&_.m(r,null),u(n,o);for(let L=0;L<v.length;L+=1)v[L]&&v[L].m(n,null);c=!0,d||(f=J(e,"click",s[7]),d=!0)},p(k,E){if(s=k,_&&_.p&&(!c||E&2048)&&Os(_,g,s,s[11],c?js(g,s[11],E,Yo):Vs(s[11]),Ll),E&265){h=de(s[0]);let L;for(L=0;L<h.length;L+=1){const O=Dl(s,h,L);v[L]?(v[L].p(O,E),x(v[L],1)):(v[L]=Vl(O),v[L].c(),x(v[L],1),v[L].m(n,null))}for(xe(),L=h.length;L<v.length;L+=1)S(L);Fe()}(!c||E&4&&a!==(a=Te(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&m(n,"class",a)},i(k){if(!c){k&&rs(()=>{c&&(t||(t=Ct(e,as,{duration:ns},!0)),t.run(1))}),x(_,k);for(let E=0;E<h.length;E+=1)x(v[E]);k&&rs(()=>{c&&(i||(i=Ct(n,is,{duration:ns},!0)),i.run(1))}),c=!0}},o(k){k&&(t||(t=Ct(e,as,{duration:ns},!1)),t.run(0)),W(_,k),v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)W(v[E]);k&&(i||(i=Ct(n,is,{duration:ns},!1)),i.run(0)),c=!1},d(k){k&&(p(e),p(l),p(n)),k&&t&&t.end(),_&&_.d(k),Oe(v,k),k&&i&&i.end(),d=!1,f()}}}function Xo(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","w-[24px]")},m(t,l){U(t,e,l)},p:me,i:me,o:me,d(t){t&&p(e)}}}function Zo(s){let e,t;return e=new Ue({props:{class:"mr-2",icon:s[17],width:16}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p(l,n){const r={};n&1&&(r.icon=l[17]),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function Vl(s){let e,t,l,n,r,o,a=s[16]+"",i,c,d,f,g;const _=[Zo,Xo],h=[];function v(k,E){return k[17]?0:1}l=v(s),n=h[l]=_[l](s);function S(){return s[13](s[15])}return{c(){e=b("li"),t=b("button"),n.c(),r=j(),o=b("div"),i=X(a),c=j(),this.h()},l(k){e=y(k,"LI",{});var E=C(e);t=y(E,"BUTTON",{class:!0});var L=C(t);n.l(L),r=B(L),o=y(L,"DIV",{});var O=C(o);i=Z(O,a),O.forEach(p),L.forEach(p),c=B(E),E.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),$(t,"selected",s[15]===s[3])},m(k,E){U(k,e,E),u(e,t),h[l].m(t,null),u(t,r),u(t,o),u(o,i),u(e,c),d=!0,f||(g=J(t,"click",S),f=!0)},p(k,E){s=k;let L=l;l=v(s),l===L?h[l].p(s,E):(xe(),W(h[L],1,1,()=>{h[L]=null}),Fe(),n=h[l],n?n.p(s,E):(n=h[l]=_[l](s),n.c()),x(n,1),n.m(t,r)),(!d||E&1)&&a!==(a=s[16]+"")&&pe(i,a),(!d||E&9)&&$(t,"selected",s[15]===s[3])},i(k){d||(x(n),d=!0)},o(k){W(n),d=!1},d(k){k&&p(e),h[l].d(),f=!1,g()}}}function er(s){let e,t,l,n,r,o,a,i,c;const d=s[12].value,f=Ps(d,s,s[11],Pl);let g=s[6]&&Ol(s);return{c(){e=b("div"),t=b("button"),f&&f.c(),r=j(),g&&g.c(),this.h()},l(_){e=y(_,"DIV",{class:!0,id:!0});var h=C(e);t=y(h,"BUTTON",{class:!0,title:!0});var v=C(t);f&&f.l(v),v.forEach(p),r=B(h),g&&g.l(h),h.forEach(p),this.h()},h(){m(t,"class",l=Te(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),m(t,"title",n=s[9].title||""),$(t,"disabled",s[4]),$(t,"open",s[6]),m(e,"class",o=Te(`relative ${s[2]||""}`)+" svelte-h65upg"),m(e,"id",s[1])},m(_,h){U(_,e,h),u(e,t),f&&f.m(t,null),u(e,r),g&&g.m(e,null),s[14](e),a=!0,i||(c=J(t,"click",s[7]),i=!0)},p(_,[h]){f&&f.p&&(!a||h&2048)&&Os(f,d,_,_[11],a?js(d,_[11],h,Qo):Vs(_[11]),Pl),(!a||h&512&&l!==(l=Te(`${_[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&m(t,"class",l),(!a||h&512&&n!==(n=_[9].title||""))&&m(t,"title",n),(!a||h&528)&&$(t,"disabled",_[4]),(!a||h&576)&&$(t,"open",_[6]),_[6]?g?(g.p(_,h),h&64&&x(g,1)):(g=Ol(_),g.c(),x(g,1),g.m(e,null)):g&&(xe(),W(g,1,1,()=>{g=null}),Fe()),(!a||h&4&&o!==(o=Te(`relative ${_[2]||""}`)+" svelte-h65upg"))&&m(e,"class",o),(!a||h&2)&&m(e,"id",_[1])},i(_){a||(x(f,_),x(g),a=!0)},o(_){W(f,_),W(g),a=!1},d(_){_&&p(e),f&&f.d(_),g&&g.d(),s[14](null),i=!1,c()}}}const ns=400;function tr(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:r,id:o=void 0,containerClass:a=void 0,selected:i=void 0,disabled:c=void 0,onSelect:d}=e,f,g=!1;function _(){c||t(6,g=!g)}function h(k){t(6,g=d(k))}const v=k=>h(k);function S(k){Bs[k?"unshift":"push"](()=>{f=k,t(5,f)})}return s.$$set=k=>{t(9,e=Ae(Ae({},e),Ne(k))),"options"in k&&t(0,r=k.options),"id"in k&&t(1,o=k.id),"containerClass"in k&&t(2,a=k.containerClass),"selected"in k&&t(3,i=k.selected),"disabled"in k&&t(4,c=k.disabled),"onSelect"in k&&t(10,d=k.onSelect),"$$scope"in k&&t(11,n=k.$$scope)},e=Ne(e),[r,o,a,i,c,f,g,_,h,e,d,n,l,v,S]}class sr extends qe{constructor(e){super(),We(this,e,tr,er,Je,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function lr(s){let e,t,l,n,r,o,a;return{c(){e=b("label"),t=b("input"),l=j(),n=b("div"),this.h()},l(i){e=y(i,"LABEL",{class:!0});var c=C(e);t=y(c,"INPUT",{type:!0,class:!0}),l=B(c),n=y(c,"DIV",{class:!0}),C(n).forEach(p),c.forEach(p),this.h()},h(){t.checked=s[0],m(t,"type","checkbox"),m(t,"class","svelte-k5zciy"),m(n,"class","slider svelte-k5zciy"),m(e,"class",r=Te(`${s[3].class||""} toggle`)+" svelte-k5zciy")},m(i,c){U(i,e,c),u(e,t),s[5](t),u(e,l),u(e,n),o||(a=[J(t,"change",s[4]),J(t,"keydown",s[2])],o=!0)},p(i,[c]){c&1&&(t.checked=i[0]),c&8&&r!==(r=Te(`${i[3].class||""} toggle`)+" svelte-k5zciy")&&m(e,"class",r)},i:me,o:me,d(i){i&&p(e),s[5](null),o=!1,Xe(a)}}}function nr(s,e,t){let{checked:l}=e,n;function r(i){i.key==="Enter"&&n.click()}function o(i){ms.call(this,s,i)}function a(i){Bs[i?"unshift":"push"](()=>{n=i,t(1,n)})}return s.$$set=i=>{t(3,e=Ae(Ae({},e),Ne(i))),"checked"in i&&t(0,l=i.checked)},e=Ne(e),[l,n,r,e,o,a]}class or extends qe{constructor(e){super(),We(this,e,nr,lr,Je,{checked:0})}}function rr(s,e,t){return e==="Escape"?{e:"hotkeys-cancel"}:e==="Space"?{e:"hotkeys-skip-key"}:s.has(e)?{e:"hotkeys-no-key"}:(s.add(e),{e:"hotkeys-captured-key",data:{code:e,key:t}})}const Us=/^[a-gA-G]$/,Pn=/^[♭Bb#♯sS]$/,ar=/^[0-9]$/;let te="",Qe;function ir(s,e){const{useHotkeys:t}=Ee(nt),l=Ee(xs).get(s);if(t&&te.length===0&&l&&l.note)return te="",{e:"guessed-key",data:l.note.note};if(!t&&te.length===0&&Us.test(e))return te+=e.toUpperCase(),{e:"string",data:te};if(!t&&te.length>0&&Pn.test(e))return e==="b"||e==="B"?te+="♭":te+="♯",{e:"string",data:te};if(s==="Backspace"&&te.length>0)return te=te.slice(0,-1),{e:"string",data:te};if(s==="Enter"&&te.length>0){const n=te;return te="",{e:"guessed-key",data:n}}return!1}function cr(s,e){if(s==="Enter"&&te.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let l=0;l<te.length;l+=1)l===0?t.note+=te[l]:t.chord.length>0?t.chord+=te[l].toLowerCase():te[l]==="♭"?(t.note+=te[l],t.flats+=1):te[l]==="♯"?(t.note+=te[l],t.sharps+=1):t.chord+=te[l].toLowerCase();return te="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&te.length>0)return te=te.slice(0,-1),{e:"string",data:te};if(te.length===0&&Us.test(e))return te+=e.toUpperCase(),{e:"string",data:te};if(te.length>0&&e.length===1)return te.length===1&&(e==="b"||e==="B")?te+="♭":te.length===1&&e==="#"?te+="♯":te+=e,{e:"string",data:te}}return!1}function ur(s,e,t){const{useAutoOctave:l,useHotkeys:n}=Ee(nt);let r;const a=Ee(xs).get(s),i=(a==null?void 0:a.key)||"";let c=!1;if(!Qe&&n&&(a!=null&&a.note)?(Qe=a.note,l&&(r=ds({midi:Ee(Mt)[0].midi,flats:0,sharps:0})),c="note"):!n&&te.length===0&&Us.test(e)?(te+=e.toUpperCase(),c="input"):!n&&te.length>0&&Pn.test(e)?(e==="b"||e==="B"?te+="♭":te+="♯",c="input"):!n&&te.length>0&&s==="Enter"&&l&&(r=ds({midi:Ee(Mt)[0].midi,flats:0,sharps:0}),c="octave"),!c&&ar.test(i))try{r=parseInt(i),c="octave"}catch{}if(c&&(Qe||te)&&r!==void 0){const d=(Qe==null?void 0:Qe.note)??te;return t&&(r+=1),Qe&&(Qe==null?void 0:Qe.semitones)>=12&&(r+=Math.floor(Qe.semitones/12)),Qe=void 0,te="",{e:"guessed-note",data:{note:d,octave:r}}}else if(s==="Backspace"&&(Qe||te.length>0))return Qe=void 0,te=te.slice(0,-1),{e:"string",data:te};return c==="note"?{e:"note",data:Qe}:c==="input"?{e:"string",data:te}:!1}const Ks={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}"]}},Kt=new Set,On=new Ln({layout:Ks}),ft=Ve(void 0);Ht(ft,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const Et=gt(Ve({isCustom:!1,layout:Ks,hotkeydRows:"middle-row"}),{key:"keyboard-options"}),Rt=Ve(On.rows),At=Ve(On);pt.subscribe(s=>{const e=Ee(At);e.setNotes(Array.from(s.notesMap.values())),Rt.set(e.rows),At.set(e)});Et.subscribe(s=>{const e=new Ln(s),t=Ee(pt);e.setNotes(Array.from(t.notesMap.values())),Rt.set(e.rows),At.set(e)});const xs=Ht(At,s=>new Map([...s.rows[0].keys.map(e=>[e.code,e]),...s.rows[1].keys.map(e=>[e.code,e]),...s.rows[2].keys.map(e=>[e.code,e]),...s.rows[3].keys.map(e=>[e.code,e])])),fr=Ht(xs,s=>Array.from(s.values()).map(e=>e.note).filter(e=>e!==void 0).sort((e,t)=>e.semitones-t.semitones)),it={async setLayout(s){const e=await zo(s),t=Ee(Et);e.code!==t.layout.code&&Et.update(l=>({...l,isCustom:!1,layout:e}))},async setCustomLayout(s){s?Et.update(e=>({...e,isCustom:s,layout:{code:"custom",name:"Custom",imported:e.layout.imported}})):this.setLayout(navigator.languages)},toggleRows(s){Et.update(e=>({...e,hotkeydRows:s??(e.hotkeydRows==="middle-row"?"two-rows":"middle-row")}))},captureHotkeyRow(s){const e=Ee(At),t=Ee(pt),{first:l,count:n}=e.startSetCustomRow(s);ft.set({nextIndex:l,rowIndex:s,count:n,scaleNotes:Array.from(t.notesMap.values())})},findNote(s){return Ee(fr).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((l,n)=>l+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleHotkeyInput(s,e,t){const l=rr(Kt,e,t),n=Ee(At);let r;const o=n.setCustomRow.nextKeyIdx;l.e==="hotkeys-cancel"?(ft.set(void 0),Kt.clear()):l.e==="hotkeys-skip-key"?r=n.skipNextCustomNote():l.e==="hotkeys-captured-key"&&(r=n.setNextCustomNote(l.data.key,l.data.code,s.scaleNotes));const a=Ee(Rt);if(r&&(a[s.rowIndex].keys[o]=r.key,Rt.set(a),ft.update(i=>i?{...i,nextIndex:r.index}:void 0)),s.count===o){const i=$o(a);Et.update(c=>({...c,layout:{...c.layout,imported:i}})),ft.set(void 0),Kt.clear()}return l},handleInput(s,e,t=!1){const l=Ee(It),n=Ee(ft);return n?this.handleHotkeyInput(n,s,e):l instanceof Ft?ir(s,e.toUpperCase()):l instanceof mt&&l.type==="chords-write"?cr(s,e):Ee(nt).useKeyboard?ur(s,e.toUpperCase(),t):!1},cancelCapture(){ft.set(void 0),Kt.clear()},reset(){Et.set({isCustom:!1,layout:Ks,hotkeydRows:"middle-row"}),ft.set(void 0),Kt.clear()}};function jl(s){let e;return{c(){e=b("li"),this.h()},l(t){e=y(t,"LI",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","m-[0.175rem] mr-0")},m(t,l){U(t,e,l)},d(t){t&&p(e)}}}function Bl(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,l){U(t,e,l)},d(t){t&&p(e)}}}function Gl(s){let e,t=s[0].note.note+"",l,n;return{c(){e=b("div"),l=X(t),n=X(s[3]),this.h()},l(r){e=y(r,"DIV",{class:!0});var o=C(e);l=Z(o,t),n=Z(o,s[3]),o.forEach(p),this.h()},h(){m(e,"class","absolute top-0 left-0")},m(r,o){U(r,e,o),u(e,l),u(e,n)},p(r,o){o&1&&t!==(t=r[0].note.note+"")&&pe(l,t),o&8&&pe(n,r[3])},d(r){r&&p(e)}}}function dr(s){let e,t,l,n,r,o,a=Rl(s[0].key)+"",i,c,d,f,g=s[0].key==="{enter}"&&jl(),_=s[0].key==="{enter}"&&Bl(),h=s[0].note&&Gl(s);return{c(){g&&g.c(),e=j(),t=b("li"),l=b("button"),_&&_.c(),n=j(),h&&h.c(),r=j(),o=b("div"),i=X(a),this.h()},l(v){g&&g.l(v),e=B(v),t=y(v,"LI",{class:!0});var S=C(t);l=y(S,"BUTTON",{class:!0});var k=C(l);_&&_.l(k),n=B(k),h&&h.l(k),r=B(k),o=y(k,"DIV",{});var E=C(o);i=Z(E,a),E.forEach(p),k.forEach(p),S.forEach(p),this.h()},h(){m(l,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),$(l,"items-center",!s[0].note),$(l,"items-end",s[0].note),m(t,"class",c=Te(`${s[4].class||""} m-[0.175rem] ${Ml(s[1])} min-w-[32px]`)+" svelte-1479mcy"),$(t,"enter",s[0].key==="{enter}"),$(t,"captured",s[2])},m(v,S){g&&g.m(v,S),U(v,e,S),U(v,t,S),u(t,l),_&&_.m(l,null),u(l,n),h&&h.m(l,null),u(l,r),u(l,o),u(o,i),d||(f=J(l,"click",s[10]),d=!0)},p(v,[S]){v[0].key==="{enter}"?g||(g=jl(),g.c(),g.m(e.parentNode,e)):g&&(g.d(1),g=null),v[0].key==="{enter}"?_||(_=Bl(),_.c(),_.m(l,n)):_&&(_.d(1),_=null),v[0].note?h?h.p(v,S):(h=Gl(v),h.c(),h.m(l,r)):h&&(h.d(1),h=null),S&1&&a!==(a=Rl(v[0].key)+"")&&pe(i,a),S&1&&$(l,"items-center",!v[0].note),S&1&&$(l,"items-end",v[0].note),S&18&&c!==(c=Te(`${v[4].class||""} m-[0.175rem] ${Ml(v[1])} min-w-[32px]`)+" svelte-1479mcy")&&m(t,"class",c),S&19&&$(t,"enter",v[0].key==="{enter}"),S&22&&$(t,"captured",v[2])},i:me,o:me,d(v){v&&(p(e),p(t)),g&&g.d(v),_&&_.d(),h&&h.d(),d=!1,f()}}}function Ml(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function Rl(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function hr(s,e,t){let l,n,r,o,a,i;_e(s,ft,_=>t(7,o=_)),_e(s,ps,_=>t(8,a=_)),_e(s,Rt,_=>t(9,i=_));let{rowIndex:c,keyIndex:d}=e,f;function g(_){ms.call(this,s,_)}return s.$$set=_=>{t(4,e=Ae(Ae({},e),Ne(_))),"rowIndex"in _&&t(5,c=_.rowIndex),"keyIndex"in _&&t(6,d=_.keyIndex)},s.$$.update=()=>{s.$$.dirty&608&&t(0,l=i[c].keys[d]),s.$$.dirty&257&&t(3,n=l.note?ds({midi:l.note.semitones+a[0],flats:0,sharps:0}):0),s.$$.dirty&224&&t(2,r=o&&o.rowIndex===c&&o.nextIndex===d),s.$$.dirty&65&&(l.key==="{bksp}"?t(1,f=2):l.key==="{tab}"?t(1,f=1.5):l.key==="{enter}"?t(1,f=2):l.key==="{lock}"?t(1,f=1.75):l.key==="{shift}"&&d===0?t(1,f=1.5):l.key==="{shift}"?t(1,f=2.5):t(1,f=1))},e=Ne(e),[l,f,r,n,e,c,d,o,a,i,g]}class mr extends qe{constructor(e){super(),We(this,e,hr,dr,Je,{rowIndex:5,keyIndex:6})}}function Ul(s,e,t){const l=s.slice();return l[13]=e[t],l[15]=t,l}function Kl(s,e,t){const l=s.slice();return l[16]=e[t],l[18]=t,l}function _r(s){let e,t=s[0].layout.name+"",l;return{c(){e=b("div"),l=X(t),this.h()},l(n){e=y(n,"DIV",{slot:!0});var r=C(e);l=Z(r,t),r.forEach(p),this.h()},h(){m(e,"slot","value")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r&1&&t!==(t=n[0].layout.name+"")&&pe(l,t)},d(n){n&&p(e)}}}function xl(s){let e,t,l,n,r;t=new Ue({props:{icon:xn,width:20}});function o(){return s[12](s[15])}return{c(){e=b("button"),ge(t.$$.fragment),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var i=C(e);ve(t.$$.fragment,i),i.forEach(p),this.h()},h(){m(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(a,i){U(a,e,i),be(t,e,null),l=!0,n||(r=J(e,"click",o),n=!0)},p(a,i){s=a},i(a){l||(x(t.$$.fragment,a),l=!0)},o(a){W(t.$$.fragment,a),l=!1},d(a){a&&p(e),ye(t),n=!1,r()}}}function Fl(s){let e,t;return e=new mr({props:{rowIndex:s[15],keyIndex:s[18]}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},p:me,i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function Hl(s){let e,t,l,n,r=s[2][s[15]]&&s[0].isCustom&&xl(s),o=de(s[13].keys),a=[];for(let c=0;c<o.length;c+=1)a[c]=Fl(Kl(s,o,c));const i=c=>W(a[c],1,1,()=>{a[c]=null});return{c(){e=b("li"),r&&r.c(),t=j();for(let c=0;c<a.length;c+=1)a[c].c();l=Pe(),this.h()},l(c){e=y(c,"LI",{class:!0});var d=C(e);r&&r.l(d),d.forEach(p),t=B(c);for(let f=0;f<a.length;f+=1)a[f].l(c);l=Pe(),this.h()},h(){m(e,"class","col-span-2 svelte-1av9wwd")},m(c,d){U(c,e,d),r&&r.m(e,null),U(c,t,d);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(c,d);U(c,l,d),n=!0},p(c,d){if(c[2][c[15]]&&c[0].isCustom?r?(r.p(c,d),d&5&&x(r,1)):(r=xl(c),r.c(),x(r,1),r.m(e,null)):r&&(xe(),W(r,1,1,()=>{r=null}),Fe()),d&8){o=de(c[13].keys);let f;for(f=0;f<o.length;f+=1){const g=Kl(c,o,f);a[f]?(a[f].p(g,d),x(a[f],1)):(a[f]=Fl(g),a[f].c(),x(a[f],1),a[f].m(l.parentNode,l))}for(xe(),f=o.length;f<a.length;f+=1)i(f);Fe()}},i(c){if(!n){x(r);for(let d=0;d<o.length;d+=1)x(a[d]);n=!0}},o(c){W(r),a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)W(a[d]);n=!1},d(c){c&&(p(e),p(t),p(l)),r&&r.d(),Oe(a,c)}}}function pr(s){let e,t,l,n,r,o="Layout",a,i,c,d,f,g="Custom",_,h,v,S,k,E,L="One row",O,K,N,T,A="Two rows",w,D,P,I,V,R,M,F,ee,ie,Y;i=new sr({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1 w-36",options:s[4],onSelect:s[6],$$slots:{value:[_r]},$$scope:{ctx:s}}}),K=new or({props:{checked:!s[1]}}),K.$on("change",s[9]),I=new Ue({props:{icon:zt,width:16}});let z=de(s[3].rows),G=[];for(let H=0;H<z.length;H+=1)G[H]=Hl(Ul(s,z,H));const le=H=>W(G[H],1,1,()=>{G[H]=null});return{c(){e=b("div"),t=b("div"),l=b("div"),n=b("div"),r=b("label"),r.textContent=o,a=j(),ge(i.$$.fragment),c=j(),d=b("div"),f=b("label"),f.textContent=g,_=j(),h=b("input"),S=j(),k=b("div"),E=b("label"),E.textContent=L,O=j(),ge(K.$$.fragment),N=j(),T=b("label"),T.textContent=A,w=j(),D=b("div"),P=b("button"),ge(I.$$.fragment),V=j(),R=b("div"),M=b("ul");for(let H=0;H<G.length;H+=1)G[H].c();this.h()},l(H){e=y(H,"DIV",{class:!0});var se=C(e);t=y(se,"DIV",{class:!0});var ce=C(t);l=y(ce,"DIV",{class:!0});var Ce=C(l);n=y(Ce,"DIV",{class:!0});var oe=C(n);r=y(oe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(r)!=="svelte-1xsr9lq"&&(r.textContent=o),a=B(oe),ve(i.$$.fragment,oe),oe.forEach(p),c=B(Ce),d=y(Ce,"DIV",{class:!0});var he=C(d);f=y(he,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(f)!=="svelte-11aw8ub"&&(f.textContent=g),_=B(he),h=y(he,"INPUT",{class:!0,id:!0,type:!0}),he.forEach(p),S=B(Ce),k=y(Ce,"DIV",{class:!0});var Q=C(k);E=y(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(E)!=="svelte-17p0yvw"&&(E.textContent=L),O=B(Q),ve(K.$$.fragment,Q),N=B(Q),T=y(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(T)!=="svelte-1wr3nwv"&&(T.textContent=A),Q.forEach(p),Ce.forEach(p),w=B(ce),D=y(ce,"DIV",{class:!0});var ue=C(D);P=y(ue,"BUTTON",{class:!0});var we=C(P);ve(I.$$.fragment,we),we.forEach(p),ue.forEach(p),ce.forEach(p),V=B(se),R=y(se,"DIV",{class:!0});var fe=C(R);M=y(fe,"UL",{class:!0});var He=C(M);for(let q=0;q<G.length;q+=1)G[q].l(He);He.forEach(p),fe.forEach(p),se.forEach(p),this.h()},h(){m(r,"class","font-bold mr-4"),m(r,"for","middle-row"),m(n,"class","my-1 flex items-center justify-between mr-2"),m(f,"class","font-bold mr-4"),m(f,"for","custom-layout"),m(h,"class","h-[20px]"),m(h,"id","custom-layout"),m(h,"type","checkbox"),h.checked=v=s[0].isCustom,m(d,"class","my-1 flex items-center"),m(E,"class","font-bold mr-4"),m(E,"for","two-rows"),m(T,"class","font-bold ml-4"),m(T,"for","two-rows"),m(k,"class","my-1 flex items-center"),m(l,"class","options svelte-1av9wwd"),m(P,"class","rounded px-1 py-1 hover:bg-gray-200"),m(D,"class","flex items-center justify-center"),m(t,"class","flex justify-between"),m(M,"class","keyboard svelte-1av9wwd"),m(R,"class","flex flex-col"),m(e,"class",F=Te(`${s[10].class||""} relative`)+" svelte-1av9wwd")},m(H,se){U(H,e,se),u(e,t),u(t,l),u(l,n),u(n,r),u(n,a),be(i,n,null),u(l,c),u(l,d),u(d,f),u(d,_),u(d,h),u(l,S),u(l,k),u(k,E),u(k,O),be(K,k,null),u(k,N),u(k,T),u(t,w),u(t,D),u(D,P),be(I,P,null),u(e,V),u(e,R),u(R,M);for(let ce=0;ce<G.length;ce+=1)G[ce]&&G[ce].m(M,null);ee=!0,ie||(Y=[J(h,"change",s[7]),J(P,"click",s[5])],ie=!0)},p(H,[se]){const ce={};se&524289&&(ce.$$scope={dirty:se,ctx:H}),i.$set(ce),(!ee||se&1&&v!==(v=H[0].isCustom))&&(h.checked=v);const Ce={};if(se&2&&(Ce.checked=!H[1]),K.$set(Ce),se&269){z=de(H[3].rows);let oe;for(oe=0;oe<z.length;oe+=1){const he=Ul(H,z,oe);G[oe]?(G[oe].p(he,se),x(G[oe],1)):(G[oe]=Hl(he),G[oe].c(),x(G[oe],1),G[oe].m(M,null))}for(xe(),oe=z.length;oe<G.length;oe+=1)le(oe);Fe()}(!ee||se&1024&&F!==(F=Te(`${H[10].class||""} relative`)+" svelte-1av9wwd"))&&m(e,"class",F)},i(H){if(!ee){x(i.$$.fragment,H),x(K.$$.fragment,H),x(I.$$.fragment,H);for(let se=0;se<z.length;se+=1)x(G[se]);ee=!0}},o(H){W(i.$$.fragment,H),W(K.$$.fragment,H),W(I.$$.fragment,H),G=G.filter(Boolean);for(let se=0;se<G.length;se+=1)W(G[se]);ee=!1},d(H){H&&p(e),ye(i),ye(K),ye(I),Oe(G,H),ie=!1,Xe(Y)}}}function gr(s,e,t){let l,n,r,o,a;_e(s,Et,v=>t(0,r=v)),_e(s,Rt,v=>t(11,o=v)),_e(s,At,v=>t(3,a=v)),bn(()=>{a.opts.isCustom||it.setLayout(navigator.languages)});const i=Object.entries(Ds).map(([v,S])=>({key:v,value:S.name}));function c(){it.reset(),it.setLayout(navigator.languages)}function d(v){return it.setLayout([v]),!1}function f(v){it.setCustomLayout(v.currentTarget.checked)}function g(v){it.captureHotkeyRow(v)}function _(){it.toggleRows()}const h=v=>g(v);return s.$$set=v=>{t(10,e=Ae(Ae({},e),Ne(v)))},s.$$.update=()=>{s.$$.dirty&2049&&t(2,l=o.map((v,S)=>r.hotkeydRows==="middle-row"?S===1||S===2:!0)),s.$$.dirty&1&&t(1,n=r.hotkeydRows==="middle-row")},e=Ne(e),[r,n,l,a,i,c,d,f,g,_,e,o,h]}class vr extends qe{constructor(e){super(),We(this,e,gr,pr,Je,{})}}function zl(s){let e,t;return e=new vr({props:{class:"mt-4"}}),{c(){ge(e.$$.fragment)},l(l){ve(e.$$.fragment,l)},m(l,n){be(e,l,n),t=!0},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){ye(e,l)}}}function br(s){let e,t,l,n,r="I/O",o,a,i,c,d,f,g,_,h="Device",v,S,k,E,L,O,K="Prompt",N,T,A="Disable",w,D,P,I,V="Sound",R,M,F,ee,ie,Y,z="Fixed velocity",G,le,H,se,ce,Ce,oe="Keyboard",he,Q,ue,we,fe,He,q="Hotkeys",re,ke,tt,ne,je,Me,vt="Auto-octave",Nt,ze,Ke,St,st,$e,Fs=" ",gs,Dt,ct,vs,qt,bs,bt,yt,Hs="Fade timeout",ys,ut,ks,Wt,Ye,ws,zs;c=new Ue({props:{icon:zt,width:16}});let Ge=s[2]&&!s[4]&&zl();return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,o=j(),a=b("div"),i=b("button"),ge(c.$$.fragment),d=j(),f=b("div"),g=b("div"),_=b("label"),_.textContent=h,v=j(),S=b("input"),E=j(),L=b("div"),O=b("button"),O.textContent=K,N=j(),T=b("button"),T.textContent=A,w=j(),D=b("div"),P=b("div"),I=b("label"),I.textContent=V,R=j(),M=b("input"),ee=j(),ie=b("div"),Y=b("label"),Y.textContent=z,G=j(),le=b("input"),H=j(),se=b("div"),ce=b("div"),Ce=b("label"),Ce.textContent=oe,he=j(),Q=b("input"),we=j(),fe=b("div"),He=b("label"),He.textContent=q,re=j(),ke=b("input"),ne=j(),je=b("div"),Me=b("label"),Me.textContent=vt,Nt=j(),ze=b("input"),St=j(),st=b("div"),$e=b("div"),$e.textContent=Fs,gs=j(),Dt=b("div"),ct=b("button"),vs=X("Set hotkeys"),bs=j(),bt=b("div"),yt=b("label"),yt.textContent=Hs,ys=j(),ut=b("input"),ks=j(),Ge&&Ge.c(),this.h()},l(Se){e=y(Se,"DIV",{class:!0});var Re=C(e);t=y(Re,"FIELDSET",{class:!0});var ot=C(t);l=y(ot,"LEGEND",{class:!0});var qs=C(l);n=y(qs,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-1jbbsti"&&(n.textContent=r),qs.forEach(p),o=B(ot),a=y(ot,"DIV",{class:!0});var Ws=C(a);i=y(Ws,"BUTTON",{class:!0});var Js=C(i);ve(c.$$.fragment,Js),Js.forEach(p),Ws.forEach(p),d=B(ot),f=y(ot,"DIV",{class:!0});var kt=C(f);g=y(kt,"DIV",{class:!0});var Lt=C(g);_=y(Lt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(_)!=="svelte-crpa7y"&&(_.textContent=h),v=B(Lt),S=y(Lt,"INPUT",{class:!0,id:!0}),E=B(Lt),L=y(Lt,"DIV",{class:!0});var Jt=C(L);O=y(Jt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(O)!=="svelte-mj6mct"&&(O.textContent=K),N=B(Jt),T=y(Jt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(T)!=="svelte-1sl6oxh"&&(T.textContent=A),Jt.forEach(p),Lt.forEach(p),w=B(kt),D=y(kt,"DIV",{class:!0});var $t=C(D);P=y($t,"DIV",{class:!0});var Yt=C(P);I=y(Yt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(I)!=="svelte-wgxtkw"&&(I.textContent=V),R=B(Yt),M=y(Yt,"INPUT",{class:!0,id:!0,type:!0}),Yt.forEach(p),ee=B($t),ie=y($t,"DIV",{class:!0});var Qt=C(ie);Y=y(Qt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Y)!=="svelte-1tm2bth"&&(Y.textContent=z),G=B(Qt),le=y(Qt,"INPUT",{class:!0,id:!0,placeholder:!0}),Qt.forEach(p),$t.forEach(p),H=B(kt),se=y(kt,"DIV",{class:!0});var Pt=C(se);ce=y(Pt,"DIV",{class:!0});var Xt=C(ce);Ce=y(Xt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Ce)!=="svelte-1js269u"&&(Ce.textContent=oe),he=B(Xt),Q=y(Xt,"INPUT",{class:!0,id:!0,type:!0}),Xt.forEach(p),we=B(Pt),fe=y(Pt,"DIV",{class:!0});var Zt=C(fe);He=y(Zt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(He)!=="svelte-21h39k"&&(He.textContent=q),re=B(Zt),ke=y(Zt,"INPUT",{class:!0,id:!0,type:!0}),Zt.forEach(p),ne=B(Pt),je=y(Pt,"DIV",{class:!0});var es=C(je);Me=y(es,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Me)!=="svelte-33lczu"&&(Me.textContent=vt),Nt=B(es),ze=y(es,"INPUT",{class:!0,id:!0,type:!0}),es.forEach(p),Pt.forEach(p),St=B(kt),st=y(kt,"DIV",{class:!0});var Ot=C(st);$e=y(Ot,"DIV",{class:!0,"data-svelte-h":!0}),ae($e)!=="svelte-dgefms"&&($e.textContent=Fs),gs=B(Ot),Dt=y(Ot,"DIV",{class:!0});var $s=C(Dt);ct=y($s,"BUTTON",{class:!0});var Ys=C(ct);vs=Z(Ys,"Set hotkeys"),Ys.forEach(p),$s.forEach(p),bs=B(Ot),bt=y(Ot,"DIV",{class:!0});var ts=C(bt);yt=y(ts,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(yt)!=="svelte-vd5i27"&&(yt.textContent=Hs),ys=B(ts),ut=y(ts,"INPUT",{class:!0,id:!0}),ts.forEach(p),Ot.forEach(p),kt.forEach(p),ks=B(ot),Ge&&Ge.l(ot),ot.forEach(p),Re.forEach(p),this.h()},h(){var Se;m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(i,"class","rounded px-1 py-1 hover:bg-gray-200"),m(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center"),$(a,"hidden",s[4]),m(_,"class","font-bold"),m(_,"for","device"),m(S,"class","px-1 my-1 rounded w-50"),m(S,"id","device"),S.disabled=!0,S.value=k=((Se=s[5])==null?void 0:Se.name)??"No device",m(O,"class","btn-sm primary mr-2"),m(T,"class","btn-sm primary"),m(L,"class","flex my-[auto]"),m(g,"class","h-full flex flex-col"),m(I,"class","font-bold"),m(I,"for","sound"),m(M,"class","h-[20px]"),m(M,"id","sound"),m(M,"type","checkbox"),M.checked=F=s[3].useSound,m(P,"class","my-1 flex justify-between mr-12"),m(Y,"class","font-bold"),m(Y,"for","fixed-velocity"),m(le,"class","h-[20px] w-16"),m(le,"id","fixed-velocity"),m(le,"placeholder","0-127"),m(ie,"class","flex justify-between"),m(D,"class","flex flex-col h-full"),m(Ce,"class","font-bold"),m(Ce,"for","keyboard"),m(Q,"class","h-[20px]"),m(Q,"id","keyboard"),m(Q,"type","checkbox"),Q.checked=ue=s[3].useKeyboard,m(ce,"class","my-1 flex justify-between mr-12"),m(He,"class","font-bold"),m(He,"for","hotkeys"),m(ke,"class","h-[20px]"),m(ke,"id","hotkeys"),m(ke,"type","checkbox"),ke.checked=tt=s[3].useHotkeys,m(fe,"class","my-1 flex justify-between mr-12"),m(Me,"class","font-bold"),m(Me,"for","auto-octave"),m(ze,"class","h-[20px]"),m(ze,"id","auto-octave"),m(ze,"type","checkbox"),ze.checked=Ke=s[3].useAutoOctave,m(je,"class","my-1 flex justify-between mr-12"),m(se,"class","flex flex-col h-full"),m($e,"class","h-[28px]"),m(ct,"class","w-full btn-sm primary"),ct.disabled=qt=!s[3].useHotkeys,m(Dt,"class","my-[2px] flex justify-between"),m(yt,"class","font-bold"),m(yt,"for","fade-timeout"),m(ut,"class","h-[20px] w-16"),m(ut,"id","fade-timeout"),ut.value=s[1],m(bt,"class","my-1 flex justify-between"),m(st,"class","flex flex-col h-full"),m(f,"class","body svelte-1bpw69s"),$(f,"hidden",s[4]),m(t,"class","relative flex flex-col max-w-full rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),$(t,"collapsed",s[4]),m(e,"class",Wt=Te(`${s[12].class||""}`)+" svelte-1bpw69s")},m(Se,Re){U(Se,e,Re),u(e,t),u(t,l),u(l,n),u(t,o),u(t,a),u(a,i),be(c,i,null),u(t,d),u(t,f),u(f,g),u(g,_),u(g,v),u(g,S),u(g,E),u(g,L),u(L,O),u(L,N),u(L,T),u(f,w),u(f,D),u(D,P),u(P,I),u(P,R),u(P,M),u(D,ee),u(D,ie),u(ie,Y),u(ie,G),u(ie,le),et(le,s[0]),u(f,H),u(f,se),u(se,ce),u(ce,Ce),u(ce,he),u(ce,Q),u(se,we),u(se,fe),u(fe,He),u(fe,re),u(fe,ke),u(se,ne),u(se,je),u(je,Me),u(je,Nt),u(je,ze),u(f,St),u(f,st),u(st,$e),u(st,gs),u(st,Dt),u(Dt,ct),u(ct,vs),u(st,bs),u(st,bt),u(bt,yt),u(bt,ys),u(bt,ut),u(t,ks),Ge&&Ge.m(t,null),Ye=!0,ws||(zs=[J(n,"click",s[7]),J(i,"click",s[11]),J(O,"click",Be.openMidi),J(T,"click",Be.disableMidi),J(M,"change",s[13]),J(le,"input",s[14]),J(le,"change",s[8]),J(Q,"change",s[15]),J(ke,"change",s[9]),J(ze,"change",s[16]),J(ct,"click",s[17]),J(ut,"input",s[10])],ws=!0)},p(Se,[Re]){var ot;(!Ye||Re&16)&&$(a,"hidden",Se[4]),(!Ye||Re&32&&k!==(k=((ot=Se[5])==null?void 0:ot.name)??"No device")&&S.value!==k)&&(S.value=k),(!Ye||Re&8&&F!==(F=Se[3].useSound))&&(M.checked=F),Re&1&&le.value!==Se[0]&&et(le,Se[0]),(!Ye||Re&8&&ue!==(ue=Se[3].useKeyboard))&&(Q.checked=ue),(!Ye||Re&8&&tt!==(tt=Se[3].useHotkeys))&&(ke.checked=tt),(!Ye||Re&8&&Ke!==(Ke=Se[3].useAutoOctave))&&(ze.checked=Ke),(!Ye||Re&8&&qt!==(qt=!Se[3].useHotkeys))&&(ct.disabled=qt),(!Ye||Re&2&&ut.value!==Se[1])&&(ut.value=Se[1]),(!Ye||Re&16)&&$(f,"hidden",Se[4]),Se[2]&&!Se[4]?Ge?Re&20&&x(Ge,1):(Ge=zl(),Ge.c(),x(Ge,1),Ge.m(t,null)):Ge&&(xe(),W(Ge,1,1,()=>{Ge=null}),Fe()),(!Ye||Re&16)&&$(t,"collapsed",Se[4]),(!Ye||Re&4096&&Wt!==(Wt=Te(`${Se[12].class||""}`)+" svelte-1bpw69s"))&&m(e,"class",Wt)},i(Se){Ye||(x(c.$$.fragment,Se),x(Ge),Ye=!0)},o(Se){W(c.$$.fragment,Se),W(Ge),Ye=!1},d(Se){Se&&p(e),ye(c),Ge&&Ge.d(),ws=!1,Xe(zs)}}}function yr(s,e,t){let l,n,r;_e(s,nt,O=>t(3,l=O)),_e(s,hs,O=>t(5,r=O));const o=gt(Ve(!1),{key:"inputs-hidden"});_e(s,o,O=>t(4,n=O));let a=l.fixedVelocity??"",i=l.keyFadeTimeout,c=!1;nt.subscribe(O=>{t(0,a=O.fixedVelocity??""),t(1,i=O.keyFadeTimeout)});function d(){o.update(O=>!O)}function f(O){const{value:K}=O.currentTarget;let N;if(K)try{N=parseInt(K)}catch{}N!==void 0&&N>=0&&N<=127?Be.setInputValue("fixedVelocity",N):K?t(0,a=l.fixedVelocity||""):Be.setInputValue("fixedVelocity",void 0)}function g(O){Be.setInputValue("useHotkeys",O.currentTarget.checked),O.currentTarget.checked||(t(2,c=!1),it.cancelCapture())}function _(O){try{const K=parseInt(O.currentTarget.value);Be.setInputValue("keyFadeTimeout",K)}catch{t(1,i=l.keyFadeTimeout)}}function h(){Be.setInputValue("useSound",!0),Be.setInputValue("fixedVelocity",void 0),Be.setInputValue("useKeyboard",!0),Be.setInputValue("useHotkeys",!0),Be.setInputValue("useAutoOctave",!0),Be.setInputValue("keyFadeTimeout",1500)}const v=O=>Be.setInputValue("useSound",O.currentTarget.checked);function S(){a=this.value,t(0,a)}const k=O=>Be.setInputValue("useKeyboard",O.currentTarget.checked),E=O=>Be.setInputValue("useAutoOctave",O.currentTarget.checked),L=()=>t(2,c=!c);return s.$$set=O=>{t(12,e=Ae(Ae({},e),Ne(O)))},e=Ne(e),[a,i,c,l,n,r,o,d,f,g,_,h,e,v,S,k,E,L]}class kr extends qe{constructor(e){super(),We(this,e,yr,br,Je,{})}}function wr(s){let e;return{c(){e=X(" ")},l(t){e=Z(t," ")},m(t,l){U(t,e,l)},p:me,d(t){t&&p(e)}}}function Er(s){let e,t=s[1].note+"",l;return{c(){e=X("Input: "),l=X(t)},l(n){e=Z(n,"Input: "),l=Z(n,t)},m(n,r){U(n,e,r),U(n,l,r)},p(n,r){r&2&&t!==(t=n[1].note+"")&&pe(l,t)},d(n){n&&(p(e),p(l))}}}function Cr(s){let e,t;return{c(){e=X("Input: "),t=X(s[0])},l(l){e=Z(l,"Input: "),t=Z(l,s[0])},m(l,n){U(l,e,n),U(l,t,n)},p(l,n){n&1&&pe(t,l[0])},d(l){l&&(p(e),p(t))}}}function Ir(s){let e;return{c(){e=X(Ls)},l(t){e=Z(t,Ls)},m(t,l){U(t,e,l)},p:me,d(t){t&&p(e)}}}function Tr(s){let e,t,l,n;function r(i,c){return i[2].useKeyboard&&Ls?Ir:i[2].useKeyboard&&i[0]?Cr:i[2].useKeyboard&&i[1]?Er:wr}let o=r(s),a=o(s);return{c(){e=b("div"),a.c(),this.h()},l(i){e=y(i,"DIV",{class:!0});var c=C(e);a.l(c),c.forEach(p),this.h()},h(){m(e,"class",t=`${s[4].class||""}`)},m(i,c){U(i,e,c),a.m(e,null),l||(n=J(window,"keydown",s[3]),l=!0)},p(i,[c]){o===(o=r(i))&&a?a.p(i,c):(a.d(1),a=o(i),a&&(a.c(),a.m(e,null))),c&16&&t!==(t=`${i[4].class||""}`)&&m(e,"class",t)},i:me,o:me,d(i){i&&p(e),a.d(),l=!1,n()}}}let Ls="";function Ar(s,e,t){let l;_e(s,nt,c=>t(2,l=c));let{debounced:n}=e,r="",o;const a=Bn();function i(c){const d=c.target;if(n||!(d instanceof HTMLElement)||d.tagName==="INPUT")return;const f=it.handleInput(c.code,c.key,c.shiftKey);f&&f.e==="note"?t(1,o=f.data):f&&f.e==="string"?t(0,r=f.data):f&&(f.e==="guessed-key"||f.e==="guessed-chord"||f.e==="guessed-note")?(t(0,r=""),t(1,o=void 0),a(f.e,f.data),c.code==="Enter"&&c.preventDefault()):f&&c.preventDefault()}return s.$$set=c=>{t(4,e=Ae(Ae({},e),Ne(c))),"debounced"in c&&t(5,n=c.debounced)},e=Ne(e),[r,o,l,i,e,n]}class Nr extends qe{constructor(e){super(),We(this,e,Ar,Tr,Je,{debounced:5})}}function Sr(s){let e,t,l,n="Count",r,o,a,i,c,d="Duplicates",f,g,_,h,v,S,k="Autoplay",E,L,O,K,N,T,A="Wait seconds",w,D,P,I,V;return{c(){e=b("ul"),t=b("li"),l=b("label"),l.textContent=n,r=j(),o=b("input"),a=j(),i=b("li"),c=b("label"),c.textContent=d,f=j(),g=b("input"),h=j(),v=b("li"),S=b("label"),S.textContent=k,E=j(),L=b("input"),K=j(),N=b("li"),T=b("label"),T.textContent=A,w=j(),D=b("input"),this.h()},l(R){e=y(R,"UL",{class:!0});var M=C(e);t=y(M,"LI",{class:!0});var F=C(t);l=y(F,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(l)!=="svelte-wgq9fc"&&(l.textContent=n),r=B(F),o=y(F,"INPUT",{class:!0,id:!0,type:!0}),F.forEach(p),a=B(M),i=y(M,"LI",{class:!0});var ee=C(i);c=y(ee,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(c)!=="svelte-hcg9dq"&&(c.textContent=d),f=B(ee),g=y(ee,"INPUT",{class:!0,id:!0,type:!0}),ee.forEach(p),h=B(M),v=y(M,"LI",{class:!0});var ie=C(v);S=y(ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(S)!=="svelte-lr68n2"&&(S.textContent=k),E=B(ie),L=y(ie,"INPUT",{class:!0,id:!0,type:!0}),ie.forEach(p),K=B(M),N=y(M,"LI",{class:!0});var Y=C(N);T=y(Y,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(T)!=="svelte-1qj2vcy"&&(T.textContent=A),w=B(Y),D=y(Y,"INPUT",{class:!0,id:!0,type:!0}),Y.forEach(p),M.forEach(p),this.h()},h(){m(l,"class","font-bold"),m(l,"for","guess-count"),m(o,"class","h-[20px] w-10"),m(o,"id","guess-count"),m(o,"type","number"),m(t,"class","flex items-center justify-between svelte-1elvih2"),m(c,"class","font-bold"),m(c,"for","duplicates"),m(g,"class","h-[20px]"),m(g,"id","duplicates"),m(g,"type","checkbox"),g.checked=_=s[2].duplicates,m(i,"class","flex items-center justify-between mr-6 svelte-1elvih2"),m(S,"class","font-bold"),m(S,"for","autoplay"),m(L,"class","h-[20px]"),m(L,"id","autoplay"),m(L,"type","checkbox"),L.checked=O=s[2].autoplay,m(v,"class","flex items-center justify-between mr-6 svelte-1elvih2"),m(T,"class","font-bold"),m(T,"for","wait-ms"),m(D,"class","h-[20px] w-10"),m(D,"id","wait-ms"),m(D,"type","number"),m(N,"class","flex items-center justify-between svelte-1elvih2"),m(e,"class",P=Te(`${s[5].class||""}`)+" svelte-1elvih2")},m(R,M){U(R,e,M),u(e,t),u(t,l),u(t,r),u(t,o),et(o,s[0]),u(e,a),u(e,i),u(i,c),u(i,f),u(i,g),u(e,h),u(e,v),u(v,S),u(v,E),u(v,L),u(e,K),u(e,N),u(N,T),u(N,w),u(N,D),et(D,s[1]),I||(V=[J(o,"input",s[6]),J(o,"input",s[3]),J(g,"input",s[7]),J(L,"input",s[8]),J(D,"input",s[9]),J(D,"input",s[4])],I=!0)},p(R,[M]){M&1&&cs(o.value)!==R[0]&&et(o,R[0]),M&4&&_!==(_=R[2].duplicates)&&(g.checked=_),M&4&&O!==(O=R[2].autoplay)&&(L.checked=O),M&2&&cs(D.value)!==R[1]&&et(D,R[1]),M&32&&P!==(P=Te(`${R[5].class||""}`)+" svelte-1elvih2")&&m(e,"class",P)},i:me,o:me,d(R){R&&p(e),I=!1,Xe(V)}}}function Dr(s,e,t){let l;_e(s,_t,g=>t(2,l=g));let n=l.count||"",r=l.waitSeconds||"";_t.subscribe(g=>{t(0,n=g.count||""),t(1,r=g.waitSeconds||"")});function o({currentTarget:{value:g}}){let _;try{_=parseInt(g),_<=0&&(_=1),Le.setOptionValue("count",_)}catch{t(0,n=l.count)}}function a({currentTarget:{value:g}}){let _;try{_=parseInt(g),_<0&&(_=0),Le.setOptionValue("waitSeconds",_)}catch{t(1,r=l.waitSeconds)}}function i(){n=cs(this.value),t(0,n)}const c=g=>Le.setOptionValue("duplicates",g.currentTarget.checked),d=g=>Le.setOptionValue("autoplay",g.currentTarget.checked);function f(){r=cs(this.value),t(1,r)}return s.$$set=g=>{t(5,e=Ae(Ae({},e),Ne(g)))},e=Ne(e),[n,r,l,o,a,e,i,c,d,f]}class Lr extends qe{constructor(e){super(),We(this,e,Dr,Sr,Je,{})}}function ql(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l}function Wl(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l}function Jl(s){let e,t,l=s[23]+"",n,r,o,a,i,c,d,f;function g(){return s[15](s[22])}a=new Ue({props:{icon:Ts,width:20}});function _(...h){return s[16](s[22],...h)}return{c(){e=b("li"),t=b("button"),n=X(l),r=j(),o=b("button"),ge(a.$$.fragment),i=j(),this.h()},l(h){e=y(h,"LI",{class:!0});var v=C(e);t=y(v,"BUTTON",{class:!0});var S=C(t);n=Z(S,l),S.forEach(p),r=B(v),o=y(v,"BUTTON",{class:!0});var k=C(o);ve(a.$$.fragment,k),k.forEach(p),i=B(v),v.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),$(t,"selected",s[22]===s[0]),m(o,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),m(e,"class","flex svelte-1okhpct")},m(h,v){U(h,e,v),u(e,t),u(t,n),u(e,r),u(e,o),be(a,o,null),u(e,i),c=!0,d||(f=[J(t,"click",g),J(o,"click",_)],d=!0)},p(h,v){s=h,(!c||v&17)&&$(t,"selected",s[22]===s[0])},i(h){c||(x(a.$$.fragment,h),c=!0)},o(h){W(a.$$.fragment,h),c=!1},d(h){h&&p(e),ye(a),d=!1,Xe(f)}}}function $l(s){let e,t=de(s[3]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Yl(ql(s,t,n));return{c(){e=b("ul");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=y(n,"UL",{class:!0});var r=C(e);for(let o=0;o<l.length;o+=1)l[o].l(r);r.forEach(p),this.h()},h(){m(e,"class","svelte-1okhpct")},m(n,r){U(n,e,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null)},p(n,r){if(r&138){t=de(n[3]);let o;for(o=0;o<t.length;o+=1){const a=ql(n,t,o);l[o]?l[o].p(a,r):(l[o]=Yl(a),l[o].c(),l[o].m(e,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function Yl(s){let e,t,l=s[23]+"",n,r,o,a;function i(){return s[17](s[22])}return{c(){e=b("li"),t=b("button"),n=X(l),r=j(),this.h()},l(c){e=y(c,"LI",{class:!0});var d=C(e);t=y(d,"BUTTON",{class:!0});var f=C(t);n=Z(f,l),f.forEach(p),r=B(d),d.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),$(t,"selected",s[22]===s[1]),m(e,"class","svelte-1okhpct")},m(c,d){U(c,e,d),u(e,t),u(t,n),u(e,r),o||(a=J(t,"click",i),o=!0)},p(c,d){s=c,d&8&&l!==(l=s[23]+"")&&pe(n,l),d&10&&$(t,"selected",s[22]===s[1])},d(c){c&&p(e),o=!1,a()}}}function Pr(s){let e,t,l="Play",n,r,o,a,i,c,d,f,g,_,h="Reset",v,S,k,E,L=s[2]?"Quit":"Play",O,K,N,T,A,w=de(s[4]),D=[];for(let V=0;V<w.length;V+=1)D[V]=Jl(Wl(s,w,V));const P=V=>W(D[V],1,1,()=>{D[V]=null});let I=(s[0]==="chords-write"||s[0]==="chords-play")&&$l(s);return d=new Lr({props:{class:"game-options"}}),k=new Ue({props:{class:"mr-1",icon:s[2]?Zs:Ts,width:20}}),{c(){e=b("fieldset"),t=b("legend"),t.textContent=l,n=j(),r=b("div"),o=b("ul");for(let V=0;V<D.length;V+=1)D[V].c();a=j(),i=b("div"),I&&I.c(),c=j(),ge(d.$$.fragment),f=j(),g=b("div"),_=b("button"),_.textContent=h,v=j(),S=b("button"),ge(k.$$.fragment),E=j(),O=X(L),this.h()},l(V){e=y(V,"FIELDSET",{class:!0});var R=C(e);t=y(R,"LEGEND",{class:!0,"data-svelte-h":!0}),ae(t)!=="svelte-1409tnk"&&(t.textContent=l),n=B(R),r=y(R,"DIV",{class:!0});var M=C(r);o=y(M,"UL",{class:!0});var F=C(o);for(let z=0;z<D.length;z+=1)D[z].l(F);F.forEach(p),a=B(M),i=y(M,"DIV",{class:!0});var ee=C(i);I&&I.l(ee),ee.forEach(p),c=B(M),ve(d.$$.fragment,M),f=B(M),g=y(M,"DIV",{class:!0});var ie=C(g);_=y(ie,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(_)!=="svelte-10rv0bu"&&(_.textContent=h),v=B(ie),S=y(ie,"BUTTON",{class:!0});var Y=C(S);ve(k.$$.fragment,Y),E=B(Y),O=Z(Y,L),Y.forEach(p),ie.forEach(p),M.forEach(p),R.forEach(p),this.h()},h(){m(t,"class","px-1 text-base"),m(o,"class","games svelte-1okhpct"),m(i,"class","options svelte-1okhpct"),m(_,"class","w-full btn hover:bg-gray-200"),m(S,"class","w-full mt-2 flex items-center justify-center btn primary"),m(g,"class","h-full flex flex-col justify-end"),m(r,"class","body pb-2 h-full svelte-1okhpct"),m(e,"class",K=Te(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(V,R){U(V,e,R),u(e,t),u(e,n),u(e,r),u(r,o);for(let M=0;M<D.length;M+=1)D[M]&&D[M].m(o,null);u(r,a),u(r,i),I&&I.m(i,null),u(r,c),be(d,r,null),u(r,f),u(r,g),u(g,_),u(g,v),u(g,S),be(k,S,null),u(S,E),u(S,O),N=!0,T||(A=[J(_,"click",s[8]),J(S,"click",s[9])],T=!0)},p(V,[R]){if(R&113){w=de(V[4]);let F;for(F=0;F<w.length;F+=1){const ee=Wl(V,w,F);D[F]?(D[F].p(ee,R),x(D[F],1)):(D[F]=Jl(ee),D[F].c(),x(D[F],1),D[F].m(o,null))}for(xe(),F=w.length;F<D.length;F+=1)P(F);Fe()}V[0]==="chords-write"||V[0]==="chords-play"?I?I.p(V,R):(I=$l(V),I.c(),I.m(i,null)):I&&(I.d(1),I=null);const M={};R&4&&(M.icon=V[2]?Zs:Ts),k.$set(M),(!N||R&4)&&L!==(L=V[2]?"Quit":"Play")&&pe(O,L),(!N||R&1024&&K!==(K=Te(`${V[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&m(e,"class",K)},i(V){if(!N){for(let R=0;R<w.length;R+=1)x(D[R]);x(d.$$.fragment,V),x(k.$$.fragment,V),N=!0}},o(V){D=D.filter(Boolean);for(let R=0;R<D.length;R+=1)W(D[R]);W(d.$$.fragment,V),W(k.$$.fragment,V),N=!1},d(V){V&&p(e),Oe(D,V),I&&I.d(),ye(d),ye(k),T=!1,Xe(A)}}}function Or(s,e,t){let l,n,r,o,a,i,c;_e(s,Rs,N=>t(12,o=N)),_e(s,_t,N=>t(20,a=N)),_e(s,ht,N=>t(13,i=N)),_e(s,It,N=>t(14,c=N));const d=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let f=d[4].key,g="maj-m";a.count,a.waitSeconds,_t.subscribe(N=>{N.count,N.waitSeconds});function _(N,T){if(T==="chords-write"||T==="chords-play"||T==="chords-diatonic"){let A=[];g==="selected"?A=o.filter(w=>w.selected):g==="all"?A=o:g==="maj-m"?A=o.filter(w=>w.suffixes[0]==="maj"||w.suffixes[0]==="m"):g==="seventh"&&(A=o.filter(w=>w.suffixes[0]==="maj7"||w.suffixes[0]==="m7"||w.suffixes[0]==="7"||w.suffixes[0]==="dim7"||w.suffixes[0]==="aug7")),Le.play(T,{chords:A})}else Le.play(T,void 0);N.currentTarget instanceof HTMLElement&&N.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function h(N){t(0,f=N)}function v(N,T){t(0,f=T),_(N,T)}function S(N){t(1,g=N)}function k(){Le.clearGame(!0)}function E(N){l?Le.clearGame():_(N,f)}const L=N=>h(N),O=(N,T)=>v(T,N),K=N=>S(N);return s.$$set=N=>{t(10,e=Ae(Ae({},e),Ne(N)))},s.$$.update=()=>{s.$$.dirty&24576&&t(2,l=!!c&&i!=="ended"),s.$$.dirty&4096&&t(11,n=o.reduce((N,T)=>T.selected?N+1:N,0)),s.$$.dirty&2048&&t(3,r=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${n} chords`},{key:"all",value:"All"}])},e=Ne(e),[f,g,l,r,d,h,v,S,k,E,e,n,o,i,c,L,O,K]}class Vr extends qe{constructor(e){super(),We(this,e,Or,Pr,Je,{})}}function Ql(s,e,t){const l=s.slice();return l[7]=e[t],l}function Xl(s,e,t){const l=s.slice();return l[4]=e[t],l}function jr(s){let e,t=de(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Zl(Ql(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r&2){t=de(n[1]);let o;for(o=0;o<t.length;o+=1){const a=Ql(n,t,o);l[o]?l[o].p(a,r):(l[o]=Zl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function Br(s){let e,t=de(s[0].scaleNotes||[]),l=[];for(let n=0;n<t.length;n+=1)l[n]=en(Xl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r&1){t=de(n[0].scaleNotes||[]);let o;for(o=0;o<t.length;o+=1){const a=Xl(n,t,o);l[o]?l[o].p(a,r):(l[o]=en(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function Zl(s){let e,t=s[7].interval+"",l;return{c(){e=b("span"),l=X(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=Z(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-my4m0t")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r&2&&t!==(t=n[7].interval+"")&&pe(l,t)},d(n){n&&p(e)}}}function en(s){let e,t=s[4].note+"",l;return{c(){e=b("span"),l=X(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=Z(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-my4m0t")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r&1&&t!==(t=n[4].note+"")&&pe(l,t)},d(n){n&&p(e)}}}function Gr(s){let e,t,l,n,r,o;function a(d,f){return d[0]?Br:jr}let i=a(s),c=i(s);return{c(){e=b("div"),t=b("button"),c.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,title:!0});var f=C(e);t=y(f,"BUTTON",{class:!0});var g=C(t);c.l(g),g.forEach(p),f.forEach(p),this.h()},h(){m(t,"class","intervals svelte-my4m0t"),m(e,"class",l=`${s[2].class||""} `),m(e,"title",n=s[1].map(tn).join("-"))},m(d,f){U(d,e,f),u(e,t),c.m(t,null),r||(o=J(t,"click",s[3]),r=!0)},p(d,[f]){i===(i=a(d))&&c?c.p(d,f):(c.d(1),c=i(d),c&&(c.c(),c.m(t,null))),f&4&&l!==(l=`${d[2].class||""} `)&&m(e,"class",l),f&2&&n!==(n=d[1].map(tn).join("-"))&&m(e,"title",n)},i:me,o:me,d(d){d&&p(e),c.d(),r=!1,o()}}}const tn=s=>s.interval;function Mr(s,e,t){let{scale:l,intervals:n}=e;function r(o){ms.call(this,s,o)}return s.$$set=o=>{t(2,e=Ae(Ae({},e),Ne(o))),"scale"in o&&t(0,l=o.scale),"intervals"in o&&t(1,n=o.intervals)},e=Ne(e),[l,n,e,r]}class Vn extends qe{constructor(e){super(),We(this,e,Mr,Gr,Je,{scale:0,intervals:1})}}function sn(s,e,t){const l=s.slice();return l[7]=e[t],l}function ln(s,e,t){const l=s.slice();return l[4]=e[t],l}function Rr(s){let e,t=de(s[0]),l=[];for(let n=0;n<t.length;n+=1)l[n]=nn(sn(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r&1){t=de(n[0]);let o;for(o=0;o<t.length;o+=1){const a=sn(n,t,o);l[o]?l[o].p(a,r):(l[o]=nn(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function Ur(s){let e,t=de(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=on(ln(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);U(n,e,r)},p(n,r){if(r&2){t=de(n[1]);let o;for(o=0;o<t.length;o+=1){const a=ln(n,t,o);l[o]?l[o].p(a,r):(l[o]=on(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function nn(s){let e,t,l=s[7].roman+"",n,r,o,a=s[7].suffix+"",i,c;return{c(){e=b("span"),t=b("span"),n=X(l),r=j(),o=b("sup"),i=X(a),c=j(),this.h()},l(d){e=y(d,"SPAN",{class:!0});var f=C(e);t=y(f,"SPAN",{class:!0});var g=C(t);n=Z(g,l),g.forEach(p),r=B(f),o=y(f,"SUP",{class:!0});var _=C(o);i=Z(_,a),_.forEach(p),c=B(f),f.forEach(p),this.h()},h(){m(t,"class","block"),m(o,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),$(o,"super-text",s[7].suffix.length>2),m(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(d,f){U(d,e,f),u(e,t),u(t,n),u(e,r),u(e,o),u(o,i),u(e,c)},p(d,f){f&1&&l!==(l=d[7].roman+"")&&pe(n,l),f&1&&a!==(a=d[7].suffix+"")&&pe(i,a),f&1&&$(o,"super-text",d[7].suffix.length>2)},d(d){d&&p(e)}}}function on(s){let e,t,l=s[4]+"",n,r;return{c(){e=b("span"),t=b("span"),n=X(l),r=j(),this.h()},l(o){e=y(o,"SPAN",{class:!0});var a=C(e);t=y(a,"SPAN",{});var i=C(t);n=Z(i,l),i.forEach(p),r=B(a),a.forEach(p),this.h()},h(){m(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(o,a){U(o,e,a),u(e,t),u(t,n),u(e,r)},p(o,a){a&2&&l!==(l=o[4]+"")&&pe(n,l)},d(o){o&&p(e)}}}function Kr(s){let e,t,l,n,r,o;function a(d,f){return d[1].length>0?Ur:Rr}let i=a(s),c=i(s);return{c(){e=b("div"),t=b("button"),c.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,title:!0});var f=C(e);t=y(f,"BUTTON",{class:!0});var g=C(t);c.l(g),g.forEach(p),f.forEach(p),this.h()},h(){m(t,"class","triads flex flex-wrap svelte-1roj1mi"),m(e,"class",l=Te(`${s[2].class||""} `)+" svelte-1roj1mi"),m(e,"title",n=s[0].map(rn).join("-"))},m(d,f){U(d,e,f),u(e,t),c.m(t,null),r||(o=J(t,"click",s[3]),r=!0)},p(d,[f]){i===(i=a(d))&&c?c.p(d,f):(c.d(1),c=i(d),c&&(c.c(),c.m(t,null))),f&4&&l!==(l=Te(`${d[2].class||""} `)+" svelte-1roj1mi")&&m(e,"class",l),f&1&&n!==(n=d[0].map(rn).join("-"))&&m(e,"title",n)},i:me,o:me,d(d){d&&p(e),c.d(),r=!1,o()}}}const rn=s=>s.roman+s.suffix;function xr(s,e,t){let{triads:l,chords:n}=e;function r(o){ms.call(this,s,o)}return s.$$set=o=>{t(2,e=Ae(Ae({},e),Ne(o))),"triads"in o&&t(0,l=o.triads),"chords"in o&&t(1,n=o.chords)},e=Ne(e),[l,n,e,r]}class jn extends qe{constructor(e){super(),We(this,e,xr,Kr,Je,{triads:0,chords:1})}}function an(s,e,t){const l=s.slice();return l[23]=e[t],l}function cn(s,e,t){const l=s.slice();return l[23]=e[t],l}function un(s){let e,t,l=s[23].raw.names[0]+"",n,r,o,a,i,c,d;function f(){return s[11](s[23])}o=new Vn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),o.$on("click",f);function g(){return s[12](s[23])}return i=new jn({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",g),{c(){e=b("li"),t=b("div"),n=X(l),r=j(),ge(o.$$.fragment),a=j(),ge(i.$$.fragment),c=j(),this.h()},l(_){e=y(_,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);n=Z(v,l),v.forEach(p),r=B(h),ve(o.$$.fragment,h),a=B(h),ve(i.$$.fragment,h),c=B(h),h.forEach(p),this.h()},h(){m(t,"class","text-xs font-bold"),m(e,"class","svelte-4hctsl")},m(_,h){U(_,e,h),u(e,t),u(t,n),u(e,r),be(o,e,null),u(e,a),be(i,e,null),u(e,c),d=!0},p(_,h){s=_,(!d||h&4)&&l!==(l=s[23].raw.names[0]+"")&&pe(n,l);const v={};h&4&&(v.scale=s[23].scale),h&4&&(v.intervals=s[23].raw.intervals),o.$set(v);const S={};h&4&&(S.triads=s[23].triads),h&4&&(S.chords=s[23].triadChords),i.$set(S)},i(_){d||(x(o.$$.fragment,_),x(i.$$.fragment,_),d=!0)},o(_){W(o.$$.fragment,_),W(i.$$.fragment,_),d=!1},d(_){_&&p(e),ye(o),ye(i)}}}function fn(s){let e,t,l=s[23].raw.names[0]+"",n,r,o,a,i,c,d;function f(){return s[13](s[23])}o=new Vn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),o.$on("click",f);function g(){return s[14](s[23])}return i=new jn({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",g),{c(){e=b("li"),t=b("div"),n=X(l),r=j(),ge(o.$$.fragment),a=j(),ge(i.$$.fragment),c=j(),this.h()},l(_){e=y(_,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);n=Z(v,l),v.forEach(p),r=B(h),ve(o.$$.fragment,h),a=B(h),ve(i.$$.fragment,h),c=B(h),h.forEach(p),this.h()},h(){m(t,"class","text-xs font-bold"),m(e,"class","svelte-4hctsl")},m(_,h){U(_,e,h),u(e,t),u(t,n),u(e,r),be(o,e,null),u(e,a),be(i,e,null),u(e,c),d=!0},p(_,h){s=_,(!d||h&2)&&l!==(l=s[23].raw.names[0]+"")&&pe(n,l);const v={};h&2&&(v.scale=s[23].scale),h&2&&(v.intervals=s[23].raw.intervals),o.$set(v);const S={};h&2&&(S.triads=s[23].triads),h&2&&(S.chords=s[23].triadChords),i.$set(S)},i(_){d||(x(o.$$.fragment,_),x(i.$$.fragment,_),d=!0)},o(_){W(o.$$.fragment,_),W(i.$$.fragment,_),d=!1},d(_){_&&p(e),ye(o),ye(i)}}}function Fr(s){let e,t,l,n,r="Scales",o,a,i,c="Key",d,f,g,_,h,v,S,k,E,L,O,K=de(s[2]),N=[];for(let P=0;P<K.length;P+=1)N[P]=un(cn(s,K,P));const T=P=>W(N[P],1,1,()=>{N[P]=null});let A=de(s[1]),w=[];for(let P=0;P<A.length;P+=1)w[P]=fn(an(s,A,P));const D=P=>W(w[P],1,1,()=>{w[P]=null});return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,o=j(),a=b("div"),i=b("label"),i.textContent=c,d=j(),f=b("input"),g=j(),_=b("div"),h=b("ul");for(let P=0;P<N.length;P+=1)N[P].c();v=j(),S=b("ul");for(let P=0;P<w.length;P+=1)w[P].c();this.h()},l(P){e=y(P,"DIV",{class:!0});var I=C(e);t=y(I,"FIELDSET",{class:!0});var V=C(t);l=y(V,"LEGEND",{class:!0});var R=C(l);n=y(R,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-lhx60e"&&(n.textContent=r),R.forEach(p),o=B(V),a=y(V,"DIV",{class:!0});var M=C(a);i=y(M,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(i)!=="svelte-14m38zf"&&(i.textContent=c),d=B(M),f=y(M,"INPUT",{class:!0,id:!0}),M.forEach(p),g=B(V),_=y(V,"DIV",{class:!0});var F=C(_);h=y(F,"UL",{class:!0});var ee=C(h);for(let Y=0;Y<N.length;Y+=1)N[Y].l(ee);ee.forEach(p),v=B(F),S=y(F,"UL",{class:!0});var ie=C(S);for(let Y=0;Y<w.length;Y+=1)w[Y].l(ie);ie.forEach(p),F.forEach(p),V.forEach(p),I.forEach(p),this.h()},h(){m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(i,"class","mr-4 font-bold"),m(i,"for","scale-key"),m(f,"class","bg-gray-100 w-16 px-1 rounded"),m(f,"id","scale-key"),f.value=s[0],m(a,"class","flex mb-2 input svelte-4hctsl"),$(a,"hidden",s[3]),m(h,"class","list odd w-full svelte-4hctsl"),m(S,"class","list even w-full svelte-4hctsl"),m(_,"class","body max-h-[30rem] overflow-scroll svelte-4hctsl"),$(_,"hidden",s[3]),m(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),$(t,"collapsed",s[3]),m(e,"class",k=Te(`${s[9].class||""}`)+" svelte-4hctsl")},m(P,I){U(P,e,I),u(e,t),u(t,l),u(l,n),u(t,o),u(t,a),u(a,i),u(a,d),u(a,f),u(t,g),u(t,_),u(_,h);for(let V=0;V<N.length;V+=1)N[V]&&N[V].m(h,null);u(_,v),u(_,S);for(let V=0;V<w.length;V+=1)w[V]&&w[V].m(S,null);E=!0,L||(O=[J(n,"click",s[5]),J(f,"input",s[6])],L=!0)},p(P,[I]){if((!E||I&1&&f.value!==P[0])&&(f.value=P[0]),(!E||I&8)&&$(a,"hidden",P[3]),I&388){K=de(P[2]);let V;for(V=0;V<K.length;V+=1){const R=cn(P,K,V);N[V]?(N[V].p(R,I),x(N[V],1)):(N[V]=un(R),N[V].c(),x(N[V],1),N[V].m(h,null))}for(xe(),V=K.length;V<N.length;V+=1)T(V);Fe()}if(I&386){A=de(P[1]);let V;for(V=0;V<A.length;V+=1){const R=an(P,A,V);w[V]?(w[V].p(R,I),x(w[V],1)):(w[V]=fn(R),w[V].c(),x(w[V],1),w[V].m(S,null))}for(xe(),V=A.length;V<w.length;V+=1)D(V);Fe()}(!E||I&8)&&$(_,"hidden",P[3]),(!E||I&8)&&$(t,"collapsed",P[3]),(!E||I&512&&k!==(k=Te(`${P[9].class||""}`)+" svelte-4hctsl"))&&m(e,"class",k)},i(P){if(!E){for(let I=0;I<K.length;I+=1)x(N[I]);for(let I=0;I<A.length;I+=1)x(w[I]);E=!0}},o(P){N=N.filter(Boolean);for(let I=0;I<N.length;I+=1)W(N[I]);w=w.filter(Boolean);for(let I=0;I<w.length;I+=1)W(w[I]);E=!1},d(P){P&&p(e),Oe(N,P),Oe(w,P),L=!1,Xe(O)}}}function Hr(s,e,t){let l,n,r,o,a,i,c;_e(s,Mt,w=>t(17,r=w)),_e(s,pt,w=>t(18,o=w)),_e(s,nt,w=>t(19,a=w)),_e(s,lt,w=>t(20,i=w));let f=_s().map(w=>({key:w.names[0],raw:w,scale:void 0,triads:w.triads,triadChords:[]})),g="",_=[o.key,o.scale],h;const v=gt(Ve(!0),{key:"scales-hidden"});_e(s,v,w=>t(3,c=w));function S(){v.update(w=>!w)}function k({currentTarget:{value:w}}){t(0,g=`${w.charAt(0).toUpperCase()}${w.charAt(1).toLowerCase()}`),t(10,f=f.map(D=>{const P=xt(g,D.key),I=g&&"data"in P?P.data:void 0;let V=[];return I&&(V=D.triads.map((R,M)=>`${I.scaleNotes[M].note}${!R.suffix.includes("°")&&R.minor?"m":""}${R.suffix}`)),{...D,scale:I,triadChords:V}}))}function E(w,D,P){if(w<D.length){const I=D[w++];De.setPlayed(I),i==null||i.playChord(I.map(V=>V.midi),a.fixedVelocity),h=setTimeout(()=>E(w,D,P),P)}else De.setPlayed([]),De.setKeyAndScale(_[0],_[1])}function L(w){clearTimeout(h);let D,P;w.scale?(P=w.scale,_=[o.key,o.scale],De.setKeyAndScale(w.scale.key,w.scale.scale)):P=o;const I=r[0].midi+P.scaleNotes[0].semitones;D=w.raw.intervals.map(V=>[{...P.notesMap.get(V.semitones%12),midi:I+V.semitones}]),D[0][0].semitones!==D[D.length-1][0].semitones&&D.push(D[0].map(V=>({...V,midi:V.midi+12}))),E(0,D,500)}function O(w){clearTimeout(h);const{intervals:D}=w.raw;let P,I;w.scale?(I=w.scale,_=[o.key,o.scale],De.setKeyAndScale(w.scale.key,w.scale.scale)):I=o;const V=r[0].midi+I.scaleNotes[0].semitones;P=Cn(w.triads).map((M,F)=>os(V+I.intervals[F].semitones,I,M.intervals)),D[D.length-1].interval_seq!==1&&P.push(P[0].map(M=>({...M,midi:M.midi+12}))),E(0,P,750)}const K=w=>L(w),N=w=>O(w),T=w=>L(w),A=w=>O(w);return s.$$set=w=>{t(9,e=Ae(Ae({},e),Ne(w)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,l=f.filter((w,D)=>D<f.length/2)),s.$$.dirty&1024&&t(1,n=f.filter((w,D)=>D>=f.length/2))},e=Ne(e),[g,n,l,c,v,S,k,L,O,e,f,K,N,T,A]}class zr extends qe{constructor(e){super(),We(this,e,Hr,Fr,Je,{})}}function dn(s,e,t){const l=s.slice();return l[26]=e[t],l}function hn(s,e,t){const l=s.slice();return l[29]=e[t],l}function mn(s){let e,t;return{c(){e=b("div"),t=X(s[3]),this.h()},l(l){e=y(l,"DIV",{class:!0});var n=C(e);t=Z(n,s[3]),n.forEach(p),this.h()},h(){m(e,"class","error svelte-1u7ze7x")},m(l,n){U(l,e,n),u(e,t)},p(l,n){n[0]&8&&pe(t,l[3])},d(l){l&&p(e)}}}function _n(s){let e,t=de(s[5]),l=[];for(let n=0;n<t.length;n+=1)l[n]=pn(hn(s,t,n));return{c(){e=b("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=y(n,"DIV",{class:!0});var r=C(e);for(let o=0;o<l.length;o+=1)l[o].l(r);r.forEach(p),this.h()},h(){m(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){U(n,e,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null)},p(n,r){if(r[0]&32){t=de(n[5]);let o;for(o=0;o<t.length;o+=1){const a=hn(n,t,o);l[o]?l[o].p(a,r):(l[o]=pn(a),l[o].c(),l[o].m(e,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function pn(s){let e,t=s[29].interval+"",l;return{c(){e=b("span"),l=X(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=Z(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1u7ze7x")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&32&&t!==(t=n[29].interval+"")&&pe(l,t)},d(n){n&&p(e)}}}function gn(s){let e,t=de(s[8].scaleNotes),l=[];for(let n=0;n<t.length;n+=1)l[n]=vn(dn(s,t,n));return{c(){e=b("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=y(n,"DIV",{class:!0});var r=C(e);for(let o=0;o<l.length;o+=1)l[o].l(r);r.forEach(p),this.h()},h(){m(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){U(n,e,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null)},p(n,r){if(r[0]&256){t=de(n[8].scaleNotes);let o;for(o=0;o<t.length;o+=1){const a=dn(n,t,o);l[o]?l[o].p(a,r):(l[o]=vn(a),l[o].c(),l[o].m(e,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function vn(s){let e,t=s[26].note+"",l;return{c(){e=b("span"),l=X(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=Z(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1u7ze7x")},m(n,r){U(n,e,r),u(e,l)},p(n,r){r[0]&256&&t!==(t=n[26].note+"")&&pe(l,t)},d(n){n&&p(e)}}}function qr(s){let e,t,l,n="Score",r,o,a,i,c,d,f,g="Range",_,h,v,S,k,E="—",L,O,K,N,T,A,w,D="Scale",P,I,V,R,M,F,ee,ie="Key",Y,z,G,le,H,se,ce,Ce;a=new Ue({props:{icon:zt,width:16}});let oe=s[3]&&mn(s);V=new yn({props:{class:"p-1 pl-[2px] w-48",containerClass:"w-48",selected:s[0],options:s[10],onSelect:s[14]}});let he=!s[7]&&_n(s),Q=!s[7]&&gn(s);return{c(){e=b("fieldset"),t=b("legend"),l=b("button"),l.textContent=n,r=j(),o=b("button"),ge(a.$$.fragment),i=j(),c=b("div"),d=b("div"),f=b("label"),f.textContent=g,_=j(),h=b("div"),v=b("input"),S=j(),k=b("span"),k.textContent=E,L=j(),O=b("input"),K=j(),N=b("div"),oe&&oe.c(),T=j(),A=b("div"),w=b("label"),w.textContent=D,P=j(),I=b("div"),ge(V.$$.fragment),R=j(),he&&he.c(),M=j(),F=b("div"),ee=b("label"),ee.textContent=ie,Y=j(),z=b("div"),G=b("input"),le=j(),Q&&Q.c(),this.h()},l(ue){e=y(ue,"FIELDSET",{class:!0});var we=C(e);t=y(we,"LEGEND",{class:!0});var fe=C(t);l=y(fe,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-lqyol"&&(l.textContent=n),fe.forEach(p),r=B(we),o=y(we,"BUTTON",{class:!0});var He=C(o);ve(a.$$.fragment,He),He.forEach(p),i=B(we),c=y(we,"DIV",{class:!0});var q=C(c);d=y(q,"DIV",{class:!0});var re=C(d);f=y(re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(f)!=="svelte-10u0679"&&(f.textContent=g),_=B(re),h=y(re,"DIV",{class:!0});var ke=C(h);v=y(ke,"INPUT",{class:!0,id:!0}),S=B(ke),k=y(ke,"SPAN",{class:!0,"data-svelte-h":!0}),ae(k)!=="svelte-8q1xz4"&&(k.textContent=E),L=B(ke),O=y(ke,"INPUT",{class:!0,id:!0}),ke.forEach(p),K=B(re),N=y(re,"DIV",{class:!0});var tt=C(N);oe&&oe.l(tt),tt.forEach(p),re.forEach(p),T=B(q),A=y(q,"DIV",{class:!0});var ne=C(A);w=y(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(w)!=="svelte-ld2d07"&&(w.textContent=D),P=B(ne),I=y(ne,"DIV",{class:!0});var je=C(I);ve(V.$$.fragment,je),je.forEach(p),R=B(ne),he&&he.l(ne),ne.forEach(p),M=B(q),F=y(q,"DIV",{class:!0});var Me=C(F);ee=y(Me,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(ee)!=="svelte-17pcm6g"&&(ee.textContent=ie),Y=B(Me),z=y(Me,"DIV",{class:!0});var vt=C(z);G=y(vt,"INPUT",{class:!0,id:!0}),vt.forEach(p),le=B(Me),Q&&Q.l(Me),Me.forEach(p),q.forEach(p),we.forEach(p),this.h()},h(){m(l,"class","px-1 rounded hover:bg-gray-100"),m(t,"class","text-base"),m(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(o,"hidden",s[6]),m(f,"class","font-bold"),m(f,"for","range_min"),m(v,"class","h-[28px] w-full"),m(v,"id","range_min"),m(k,"class","mx-2 mt-1"),m(O,"class","h-[28px] w-full"),m(O,"id","range_max"),m(h,"class","my-1 flex w-full"),m(N,"class","flex justify-between my-1"),m(d,"class","flex flex-col h-full"),m(w,"class","font-bold"),m(w,"for","scales"),m(I,"class","my-1 w-full"),m(A,"class","flex flex-col h-full"),m(ee,"class","font-bold"),m(ee,"for","key"),m(G,"class","h-[28px]"),m(G,"id","key"),m(z,"class","my-1 flex"),m(F,"class","flex flex-col h-full"),m(c,"class","options svelte-1u7ze7x"),$(c,"hidden",s[6]),m(e,"class",H=Te(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),$(e,"collapsed",s[6])},m(ue,we){U(ue,e,we),u(e,t),u(t,l),u(e,r),u(e,o),be(a,o,null),u(e,i),u(e,c),u(c,d),u(d,f),u(d,_),u(d,h),u(h,v),et(v,s[1]),u(h,S),u(h,k),u(h,L),u(h,O),et(O,s[2]),u(d,K),u(d,N),oe&&oe.m(N,null),u(c,T),u(c,A),u(A,w),u(A,P),u(A,I),be(V,I,null),u(A,R),he&&he.m(A,null),u(c,M),u(c,F),u(F,ee),u(F,Y),u(F,z),u(z,G),et(G,s[4]),u(F,le),Q&&Q.m(F,null),se=!0,ce||(Ce=[J(l,"click",s[15]),J(o,"click",s[16]),J(v,"input",s[18]),J(v,"change",s[19]),J(v,"focus",s[12]),J(O,"input",s[20]),J(O,"change",s[21]),J(O,"focus",s[12]),J(G,"input",s[22]),J(G,"input",s[13])],ce=!0)},p(ue,we){(!se||we[0]&64)&&$(o,"hidden",ue[6]),we[0]&2&&v.value!==ue[1]&&et(v,ue[1]),we[0]&4&&O.value!==ue[2]&&et(O,ue[2]),ue[3]?oe?oe.p(ue,we):(oe=mn(ue),oe.c(),oe.m(N,null)):oe&&(oe.d(1),oe=null);const fe={};we[0]&1&&(fe.selected=ue[0]),V.$set(fe),ue[7]?he&&(he.d(1),he=null):he?he.p(ue,we):(he=_n(ue),he.c(),he.m(A,null)),we[0]&16&&G.value!==ue[4]&&et(G,ue[4]),ue[7]?Q&&(Q.d(1),Q=null):Q?Q.p(ue,we):(Q=gn(ue),Q.c(),Q.m(F,null)),(!se||we[0]&64)&&$(c,"hidden",ue[6]),(!se||we[0]&131072&&H!==(H=Te(`${ue[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&m(e,"class",H),(!se||we[0]&131136)&&$(e,"collapsed",ue[6])},i(ue){se||(x(a.$$.fragment,ue),x(V.$$.fragment,ue),se=!0)},o(ue){W(a.$$.fragment,ue),W(V.$$.fragment,ue),se=!1},d(ue){ue&&p(e),ye(a),oe&&oe.d(),ye(V),he&&he.d(),Q&&Q.d(),ce=!1,Xe(Ce)}}}function Wr(s,e,t){let l,n,r,o,a,i;_e(s,Mt,I=>t(23,n=I)),_e(s,Tt,I=>t(24,r=I)),_e(s,It,I=>t(7,a=I)),_e(s,pt,I=>t(8,i=I));let c=dt(n[0]),d=dt(n[1]),f="";const g=gt(Ve(!1),{key:"score-options-hidden"});_e(s,g,I=>t(6,o=I));let _=r[0],h=r[1];const v=_s(),S=v.map(I=>({key:I.names[0],value:I.names[0]}));Mt.subscribe(I=>{t(1,c=dt(I[0])),t(2,d=dt(I[1]))}),Tt.subscribe(I=>{t(4,_=I[0]),t(0,h=I[1])});function k(I,V){const R=ro(V.currentTarget.value,!0,!0);if("data"in R){const{midi:M}=R.data,F=n,ee=[I==="min"?M:F[0].midi,I==="max"?M:F[1].midi];Be.setMidiRange(ee),t(3,f="")}else t(3,f=R.err),I==="min"?t(1,c=dt(n[0])):t(2,d=dt(n[1]))}function E(){t(3,f="")}function L({currentTarget:{value:I}}){t(4,_=`${I.charAt(0).toUpperCase()}${I.charAt(1).toLowerCase()}`),De.setKey(_)}function O(I){var V;return t(0,h=(V=S.find(R=>I===R.key))==null?void 0:V.value),De.setScale(h),!1}function K(){g.update(I=>!I)}function N(){De.clearScore(!0),Be.setMidiRange([60,84])}function T(){c=this.value,t(1,c)}const A=I=>k("min",I);function w(){d=this.value,t(2,d)}const D=I=>k("max",I);function P(){_=this.value,t(4,_)}return s.$$set=I=>{t(17,e=Ae(Ae({},e),Ne(I)))},s.$$.update=()=>{var I;s.$$.dirty[0]&1&&t(5,l=((I=v.find(V=>V.names[0]===h))==null?void 0:I.intervals)||[])},e=Ne(e),[h,c,d,f,_,l,o,a,i,g,S,k,E,L,O,K,N,e,T,A,w,D,P]}class Jr extends qe{constructor(e){super(),We(this,e,Wr,qr,Je,{},null,[-1,-1])}}function $r(s){s[21]=s[22].default}function Yr(s){return{c:me,l:me,m:me,i:me,o:me,d:me}}function Qr(s){$r(s);let e,t,l;var n=s[21];function r(o,a){return{props:{class:"mx-4 md:mx-0"}}}return n&&(e=Rn(n,r())),{c(){e&&ge(e.$$.fragment),t=Pe()},l(o){e&&ve(e.$$.fragment,o),t=Pe()},m(o,a){e&&be(e,o,a),U(o,t,a),l=!0},i(o){l||(e&&x(e.$$.fragment,o),l=!0)},o(o){e&&W(e.$$.fragment,o),l=!1},d(o){o&&p(t),e&&ye(e,o)}}}function Xr(s){let e;return{c(){e=X(" ")},l(t){e=Z(t," ")},m(t,l){U(t,e,l)},i:me,o:me,d(t){t&&p(e)}}}function Zr(s){let e,t,l,n,r="MIDI Note Trainer",o,a,i,c,d,f,g,_="Introduction",h,v,S,k,E,L,O,K,N,T,A,w,D,P,I,V,R,M,F,ee,ie;c=new Ue({props:{icon:zt,width:24}}),S=new kr({}),E=new zr({}),O=new Lo({}),T=new Jr({props:{class:"score-options mr-4"}}),w=new Vr({props:{class:"play-form"}});let Y={ctx:s,current:null,token:null,hasCatch:!1,pending:Xr,then:Qr,catch:Yr,value:22,blocks:[,,,]};return Gn(Ie(()=>import("./Score.96c3122f.js"),["./Score.96c3122f.js","./vendor_svelte.31d6693e.js","./vendor.e9b0235c.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),Y),V=new Nr({props:{class:"min-h-32",debounced:!!s[0]}}),V.$on("guessed-chord",s[2]),V.$on("guessed-key",s[3]),V.$on("guessed-note",s[4]),M=new Ho({props:{game:s[1]}}),{c(){e=b("meta"),t=j(),l=b("h1"),n=b("a"),n.textContent=r,o=j(),a=b("div"),i=b("button"),ge(c.$$.fragment),d=j(),f=b("div"),g=b("button"),g.textContent=_,h=j(),v=b("section"),ge(S.$$.fragment),k=j(),ge(E.$$.fragment),L=j(),ge(O.$$.fragment),K=j(),N=b("div"),ge(T.$$.fragment),A=j(),ge(w.$$.fragment),D=j(),Y.block.c(),P=j(),I=b("section"),ge(V.$$.fragment),R=j(),ge(M.$$.fragment),this.h()},l(z){const G=Mn("svelte-1w2oado",document.head);e=y(G,"META",{name:!0,content:!0}),G.forEach(p),t=B(z),l=y(z,"H1",{class:!0});var le=C(l);n=y(le,"A",{class:!0,href:!0,"data-svelte-h":!0}),ae(n)!=="svelte-km4jns"&&(n.textContent=r),o=B(le),a=y(le,"DIV",{class:!0});var H=C(a);i=y(H,"BUTTON",{class:!0});var se=C(i);ve(c.$$.fragment,se),se.forEach(p),H.forEach(p),le.forEach(p),d=B(z),f=y(z,"DIV",{class:!0});var ce=C(f);g=y(ce,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(g)!=="svelte-f34gar"&&(g.textContent=_),ce.forEach(p),h=B(z),v=y(z,"SECTION",{class:!0});var Ce=C(v);ve(S.$$.fragment,Ce),k=B(Ce),ve(E.$$.fragment,Ce),L=B(Ce),ve(O.$$.fragment,Ce),K=B(Ce),N=y(Ce,"DIV",{class:!0});var oe=C(N);ve(T.$$.fragment,oe),A=B(oe),ve(w.$$.fragment,oe),oe.forEach(p),Ce.forEach(p),D=B(z),Y.block.l(z),P=B(z),I=y(z,"SECTION",{class:!0});var he=C(I);ve(V.$$.fragment,he),R=B(he),ve(M.$$.fragment,he),he.forEach(p),this.h()},h(){m(e,"name","description"),m(e,"content","App to practise music notation, scales and chords using MIDI"),m(n,"class","hover:underline"),m(n,"href","https://github.com/TeemuKoivisto/midi-note-trainer"),m(i,"class","rounded p-2 hover:bg-gray-200"),m(a,"class","flex items-center justify-center"),m(l,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight flex items-center justify-between"),m(g,"class","btn-pill border-2 border-gray-300 hover:bg-gray-200"),m(f,"class","px-4 md:px-0"),m(N,"class","play svelte-qjpqy3"),m(v,"class","mx-4 md:mx-0"),m(I,"class","mb-8 ml-16 flex flex-col")},m(z,G){u(document.head,e),U(z,t,G),U(z,l,G),u(l,n),u(l,o),u(l,a),u(a,i),be(c,i,null),U(z,d,G),U(z,f,G),u(f,g),U(z,h,G),U(z,v,G),be(S,v,null),u(v,k),be(E,v,null),u(v,L),be(O,v,null),u(v,K),u(v,N),be(T,N,null),u(N,A),be(w,N,null),U(z,D,G),Y.block.m(z,Y.anchor=G),Y.mount=()=>P.parentNode,Y.anchor=P,U(z,P,G),U(z,I,G),be(V,I,null),u(I,R),be(M,I,null),F=!0,ee||(ie=[J(i,"click",s[5]),J(g,"click",s[6])],ee=!0)},p(z,[G]){s=z;const le={};G&1&&(le.debounced=!!s[0]),V.$set(le);const H={};G&2&&(H.game=s[1]),M.$set(H)},i(z){F||(x(c.$$.fragment,z),x(S.$$.fragment,z),x(E.$$.fragment,z),x(O.$$.fragment,z),x(T.$$.fragment,z),x(w.$$.fragment,z),x(Y.block),x(V.$$.fragment,z),x(M.$$.fragment,z),F=!0)},o(z){W(c.$$.fragment,z),W(S.$$.fragment,z),W(E.$$.fragment,z),W(O.$$.fragment,z),W(T.$$.fragment,z),W(w.$$.fragment,z);for(let G=0;G<3;G+=1){const le=Y.blocks[G];W(le)}W(V.$$.fragment,z),W(M.$$.fragment,z),F=!1},d(z){z&&(p(t),p(l),p(d),p(f),p(h),p(v),p(D),p(P),p(I)),p(e),ye(c),ye(S),ye(E),ye(O),ye(T),ye(w),Y.block.d(z),Y.token=null,Y=null,ye(V),ye(M),ee=!1,Xe(ie)}}}function ea(s,e,t){let l,n,r,o,a,i;_e(s,ht,T=>t(9,l=T)),_e(s,It,T=>t(1,n=T)),_e(s,_t,T=>t(10,r=T)),_e(s,nt,T=>t(11,o=T)),_e(s,lt,T=>t(12,a=T)),_e(s,Ns,T=>t(13,i=T));let c,d;bn(()=>(i&&O(),window.addEventListener("keydown",f),window.addEventListener("mousedown",f),window.addEventListener("touchstart",f),()=>{window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)})),hs.subscribe(T=>{T&&T.channels[1].addListener("noteon",g)});function f(){Be.initAudio(),window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)}function g(T){if(c)return;const A=T.rawData;_(A[1],A[2])}function _(T,A){const w=n;w instanceof jt&&!(w!=null&&w.ended)&&l==="waiting"?S(T):w instanceof mt&&!(w!=null&&w.ended)&&l==="waiting"?(w.addPlayedNote(T),d||(d=setTimeout(v,2e3))):w||De.pushPlayed(T),a&&a.noteOn(T,o.fixedVelocity??A)}function h(){r.autoplay&&r.waitSeconds>0?t(0,c=setTimeout(()=>{r.autoplay&&Le.nextGuess(),t(0,c=void 0)},r.waitSeconds*1e3)):r.autoplay?Le.nextGuess():t(0,c=void 0)}function v(){var A;const T=n;if(T instanceof mt){const w=T.guess();De.setPlayed(((A=T.latestGuess.guessed)==null?void 0:A.notes)||[],w,-1),Le.updateState(w?"correct":"wrong"),h()}d=void 0}function S(T){const A=n;if(A instanceof jt&&l==="waiting"){De.setTarget([De.getNote(A.current)]);const w=A.guess(T);Le.updateState(w?"correct":"wrong"),De.pushPlayed(T,w,4e3),h()}}function k(T){const A=n;if(A instanceof mt&&l==="waiting"){const w=A.guessWrittenChord(T.detail);Le.updateState(w?"correct":"wrong"),h()}}function E(T){const A=n;if(A instanceof Ft&&l==="waiting"){const w=T.detail.replaceAll("♭","b").replaceAll("♯","#"),D=A.guess(w);Le.updateState(D?"correct":"wrong"),h()}}function L(T){const A=it.findNote(T.detail.note)??Gs(T.detail.note);A&&_(A.semitones+12+T.detail.octave*12,80)}async function O(){const T=await Be.openMidi();"data"in T?T.data.name:(T.err,console.error(T.err))}function K(){ho(),window.location.reload()}return[c,n,k,E,L,K,()=>Fn.open("introduction",void 0)]}class oa extends qe{constructor(e){super(),We(this,e,ea,Zr,Je,{})}}export{rl as F,mt as G,oa as P,Qn as S,jt as a,Le as b,It as c,wt as d,ds as e,ht as g,lt as p,pt as s,ul as t};
