import{_ as fe}from"./preload-helper.a4192956.js";import{R as _e,Q as Ct,T as Ue,U as gn,S as ze,i as qe,s as We,O as nt,V as le,e as _,m as P,H as be,a as v,b as S,n as ee,d as m,o as V,I as ye,f as h,L as J,W as Ae,g as M,h as c,J as ke,p as H,t as F,C as Ze,w as et,l as q,K as Ee,X as Oe,Y as ot,M as de,N as Te,P as Ie,z as Y,A as Q,B as oe,v as Be,q as pe,c as Ql,u as Xl,j as Zl,k as en,Z as Ps,_ as qt,F as bn,$ as Vs,a0 as Os,a1 as ks,r as tn,a2 as Qe,a3 as yn,a4 as Qt,a5 as kn,a6 as En,G as wn}from"./vendor_svelte.207ec176.js";import{w as Wt,b as Cn,c as An,e as Bs,f as Gs,g as sn,h as Xt,i as Zt,j as Tn,a as Ms,k as ms}from"./vendor.13a9dfeb.js";const Us={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function $e(l,e=0,t=0){return{interval:`${l}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:l,semitones:ln(l,e,t),flats:e,sharps:t}}function ln(l,e,t){return(l<8?Us[l]:Us[l%7])-e+t+Math.floor(l/8)*12}function nn(l){let e,t=0,s=0;l<0?(t=1+Math.floor(-l/100),e=-l%100):l>100?(s=Math.floor(l/100),e=l%100):e=l;const n=ln(e,t,s);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(s)}`,interval_seq:e,semitones:n,flats:t,sharps:s}}const In=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let us=[];function an(){return In.map(l=>{const e=l[3].map(nn);return{suffixes:l[0],name:l[1][0],type:l[2],intervals:e}})}function Pt(l){us.length===0&&(us=an());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return us.find(t=>t.suffixes.find(s=>s===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function Sn(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const r=(l.semitones+e)%12;return{...l,semitones:r<0?r+12:r,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function ps(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const r=t[n],a=l+r.semitones,o=e.scaleNotes.find(p=>p.semitones===a%12),u=r.flats>0,i=r.sharps>0,d=(u?a+1:i?a-1:a)%12,f=u?-1:i?1:0;s.push(Sn(o??e.notesMap.get(d),o?0:f,a))}return s}const Rs=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],Nn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],Ks=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Ln(l){let e=0,t=0;for(let s=0;s<Rs.length;s+=1){const n=l.find(a=>a.note.slice(0,2)===Rs[s]),r=l.find(a=>a.note.slice(0,2)===Nn[s]);if(n)e+=1;else if(r)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:Ks.get(e*-1)}:{flats:0,sharps:t,majorSignature:Ks.get(t)}}function Dn(l){return l>=9?`${l>=10?"X":""}${l===9?"IX":"I".repeat(l%10)}`:`${l>=5?"V":""}${l===4?"IV":"I".repeat(l%5)}`}function rn(l){return l.map(e=>{const t=[$e(1)];let s;return e.major?(t.push($e(3)),e.suffix.startsWith("+")?t.push($e(5,0,1)):e.suffix.startsWith("6")?t.push($e(6)):e.suffix.startsWith("7")?t.push($e(7,1)):e.suffix.startsWith("maj7")?t.push($e(7)):s=Pt("maj")):e.minor?(t.push($e(3,1)),e.suffix.startsWith("°")?t.push($e(5,1)):e.suffix.startsWith("6")?(t.push($e(6)),s=Pt("m"+e.suffix)):e.suffix.startsWith("7")?(t.push($e(7,1)),s=Pt("m"+e.suffix)):s=Pt("m")):e.suffix.startsWith("sus2")?t.push($e(2)):e.suffix.startsWith("sus4")&&t.push($e(4)),t.length<=2&&t.push($e(5)),t.length<=2&&t.push($e(8)),s||(s=Pt(e.suffix)),{...s,intervals:t}})}function jn(l,e){let t=e.has(4)&&e.has(7),s=e.has(3)&&e.has(7);const n=Dn(l);let r="";return t||s||(e.has(3)&&e.has(6)?(r="°",s=!0):e.has(4)&&e.has(8)?(r="+",t=!0):e.has(3)&&e.has(10)?(s=!0,r="7"):e.has(4)&&e.has(10)?(r="7",t=!0):e.has(4)&&e.has(11)?(r="maj7",t=!0):e.has(3)&&e.has(8)?(r="6",s=!0):e.has(4)&&e.has(9)?(r="6",t=!0):e.has(2)?r="sus2":e.has(5)?r="sus4":e.has(7)?r="5":r="?"),{degree:l,roman:s?n.toLowerCase():n,suffix:r,major:t,minor:s,semitones:e}}function Pn(l){const e=l.length;return l.map((t,s)=>{const n=t.semitones,r=new Set;for(let a=1;a<e;a+=1){const o=l[(s+a)%e].semitones,u=o<=n?o+12-n:o-n;r.add(u)}return jn(t.interval_seq,r)})}const Vn=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let fs=[];function Es(){return Vn.map(l=>{const e=l[0],t=l[1].map(nn),s=Pn(t);return{names:e,intervals:t,triads:s}})}function On(l){fs.length===0&&(fs=Es());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return fs.find(t=>t.names.find(s=>s.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const Bn=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,Gn=/^[0-9]$/,st=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function on(l){return l===12?1:Math.floor((l-12)/12)}function Xe(l){return`${l.note}${on(l.midi)}`}function Nt(l){const t=(l-12)%12;return{...st[t],semitones:t,midi:l}}function Mn(l,e=!0,t=!1){if(e&&!Bn.test(l))return{err:`Unrecognized note "${l}"`,code:400};const s=l.trim(),n=s.charAt(0).toUpperCase(),r=st.find(f=>f.note.charAt(0)===n&&f.note.length===1);if(!r)return{err:`Unable to find note ${s}`,code:500};const a=s.slice(1).split("").reduce((f,p)=>f+(p.toLowerCase()==="b"||p==="♭"?-1:p==="#"||p==="♯"?1:0),0);let o;if(Gn.test(s.charAt(s.length-1)))try{o=parseInt(s.charAt(s.length-1),10)}catch{}if(t&&o===void 0)return{err:`No octave provided: ${l}`,code:400};o===void 0&&(o=0);let u=(r.semitones+a)%12;u=u<0?u+12:u;const i=a<0?-a:0,d=a>0?a:0;return{data:{note:`${n}${"♭".repeat(i)}${"♯".repeat(d)}`,semitones:u,midi:12+o*12+u,flats:i,sharps:d}}}function cn(l){const e=st.find(t=>t.note.charAt(0)===l.charAt(0)&&t.note.length===1);if(e){const t=l.slice(1).split("").reduce((n,r)=>n+(r.toLowerCase()==="b"||r==="♭"?-1:r==="#"||r==="♯"?1:0),0),s=(e.semitones+t)%12;return{note:l,semitones:s<0?s+12:s,flats:t<0?-t:0,sharps:t>0?t:0}}}const Un=/^[a-gA-G][♭b#♯]?$/,ds="ABCDEFG";function Rn(l,e){return e.map(t=>ds.charAt((ds.indexOf(l)+t.interval_seq-1)%ds.length))}function Kn(l,e,t){return t.map((s,n)=>{const r=e[n],a=(l+s.semitones)%12,o=st[a],u=o.note.charAt(0);if(u<r&&(u!=="A"||r!=="G")||u==="G"&&r==="A"){let i=1,d=st[(a+i)%12];for(;d.note.charAt(0)!==r;)i+=1,d=st[(a+i)%12];return{semitones:a,note:d.note+"♭".repeat(i),flats:i+(d.note.includes("♭")?1:0),sharps:0}}else if(u>r||u==="A"&&r==="G"){let i=1,d=a===0?st.length-1:a-i,f=st[d];for(;f.note.charAt(0)!==r;)i+=1,d=d===0?st.length-1:d-1,f=st[d];return{semitones:a,note:f.note+"♯".repeat(i),flats:0,sharps:i+(f.note.includes("♯")?1:0)}}else return{semitones:a,note:o.note,flats:o.flats,sharps:o.sharps}})}function es(l,e){if(!Un.test(l))return{err:`Unknown key: ${l}`,code:400};const t=On(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const s=`${l.charAt(0).toUpperCase()}${l.charAt(1).replace("b","♭").replace("#","♯")}`,n=cn(s);if(!n)return{err:`Unable to find root for note: ${s}`,code:404};const r=Rn(s.charAt(0),t.intervals),a=Kn(n.semitones,r,t.intervals),o=new Map(st.map(u=>{const i=a.find(d=>d.semitones===u.semitones);return i?[u.semitones,i]:[u.semitones,{...u}]}));return{data:{key:s,scale:t.names[0],names:t.names,...Ln(a),intervals:t.intervals.map(u=>({...u})),triads:t.triads.map(u=>({...u})),scaleNotes:a,notesMap:o}}}const _s=new Map;function xn(l,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(l)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function Fn(l,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(l)),{data:void 0}}catch(s){return{err:`Failed to store the value: ${s}`,code:400}}}function ht(l,e){const{key:t,storage:s="local",namespace:n="default"}=e,r=xn(t,s),a=_e(l);"data"in r?l.set(e.deserialize?e.deserialize(r.data):r.data):"err"in r&&(e!=null&&e.debug)&&console.info(r.err);const o=l.subscribe(i=>{const d=Fn(e.serialize?e.serialize(i):i,t,s);"err"in d&&(e!=null&&e.debug)&&console.error(d.err)}),u=_s.get(n);return u?u.push({key:t,storage:s,value:l,defaultValue:a,unsubscribe:o}):_s.set(n,[{key:t,storage:s,value:l,defaultValue:a,unsubscribe:o}]),l}function $n(l=["default"],e){l.forEach(t=>{var s;(s=_s.get(t))==null||s.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function Hn(l,e){const t=await fetch(l);if(!t.ok)return{err:t.statusText,code:t.status};const s=await t.arrayBuffer();return{data:await e.decodeAudioData(s)}}async function zn(l,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],s=await Promise.all(t.map(r=>Hn(`${l}${r}`,e))),n=[];return s.forEach(r=>{"err"in r?console.error(`Failed to load audio: ${r.err}`):n.push(r.data)}),n}class qn{constructor(e,t,s,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(s),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(s))}on(e,t,s,n,r,a,o,u){this.noteA.buffer=e,this.noteA.playbackRate.value=s,this.biquadFilter.frequency.value=r,this.gainA.gain.value=a,this.gain.gain.value=u,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=o,this.noteB.start(0)),this.noteA.start(0)}off(e,t,s){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(s),this.noteB.stop(s),(n=this.damp)==null||n.start(0)}}class Wn{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,s)=>{this.bufferlists.push(t),s===8?this.damper=t:s===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(s=>{this.noteOn(s,t)})}noteOn(e,t=80){if(e<109&&e>20){const s=this.notes.get(e);s&&(s.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),r=n+1,a=n*12+21,o=2**((e-69)/12)*440,u=t/127;let i=o*(2-(e-21)/50)+3*o*u;e<60&&(i=440*(3-(60-21)/50)+3*o*u);const d=1-(e%12/12+1)/12,f=Math.pow(2,(e-a)/12),p=0,g=0,b=u**1.4,E=new qn(e,this.context,this.directGain,this.damper);E.on(this.bufferlists[n],this.bufferlists[r],f,p,i,d,g,b),this.notes.set(e,E)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const Jn="/midi-note-trainer/",vs=ht(Ue(!1),{key:"midi-access"}),ts=Ue(void 0),ws=ht(Ue([60,84]),{key:"midi-range",storage:"session"}),ss=Ct(ws,l=>[Nt(l[0]),Nt(l[1])]),xs=Ue(void 0),lt=Ue(void 0),at=ht(Ue({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),He={async openMidi(){return Wt.enable().then(()=>(vs.set(!0),Wt.inputs.length>0?(ts.set(Wt.inputs[0]),{data:Wt.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(l=>({err:l.toString(),code:403}))},disableMidi(){vs.set(!1),ts.set(void 0)},setMidiRange(l){ws.set(l)},setInputValue(l,e){at.update(t=>({...t,[l]:e})),l==="useSound"&&!e?lt.set(void 0):l==="useSound"&&!_e(lt)&&this.initAudio()},async initAudio(){let l=_e(xs);if(l||(l=new AudioContext,xs.set(l)),!_e(lt)){const e=new Wn(l),t=await zn(`${Jn}audio`,l);e.load(t),lt.set(e)}}};let tt;gn({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}});const wt=Ue(["C","Major"]),Dt=Ct(wt,l=>{const e=es(l[0],l[1]);return"data"in e?e.data:{key:l[0],scale:l[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),Fs=Ue([]),gt=Ue([]);function gs(l,e){if(l.length>0){const t=Date.now();let s=t;const n=l.filter(r=>(r.started+e>t&&(s=Math.min(s,r.started)),r.started+e>t));return!tt&&n.length>0&&(tt=setTimeout(()=>{tt=void 0,gt.update(r=>gs(r,e))},e-(t-s)+100)),n}return l}const ge={setKey(l){wt.update(e=>[l,e[1]])},setScale(l){wt.update(e=>[e[0],l])},setKeyAndScale(l,e){wt.set([l,e])},setTarget(l=[]){Fs.set(l)},getNote(l){return{..._e(Dt).notesMap.get(l%12),midi:l}},pushPlayed(l,e,t){const n={..._e(Dt).notesMap.get(l%12),midi:l},r=Date.now(),a=e===void 0?"default":e?"correct":"wrong";if(gt.update(o=>{const u=o.findIndex(i=>i.midi===l);return u>=0&&o.splice(u,1),[...o,{...n,color:a,started:r}]}),!tt&&t!==-1){const o=t??_e(at).keyFadeTimeout;tt=setTimeout(()=>{tt=void 0,gt.update(u=>gs(u,o))},o)}},setPlayed(l,e,t){const s=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(gt.update(r=>[...l.map(a=>({...a,color:n,started:s}))]),!tt&&t!==-1){const r=t??_e(at).keyFadeTimeout;tt=setTimeout(()=>{tt=void 0,gt.update(a=>gs(a,r))},r)}},clearPlayed(){gt.set([]),clearTimeout(tt),tt=void 0},clearScore(l=!1){l&&wt.set(["C","Major"]),Fs.set([]),gt.set([])}};class Cs{constructor(e,t,s){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=s;const n=[],{count:r}=s,a=t.map(u=>typeof u=="object"&&u!==null?{...u}:u);let o=s.duplicates;!s.duplicates&&r>a.length&&(console.warn(`Trying to create game with count ${r} larger than available unique values ${t.length}`),o=!0);for(let u=0;u<r;u+=1){const i=Math.floor(Math.random()*a.length);if(o)n.push(a[i]);else{const d=a.splice(i,1);d.length>0&&n.push(d[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function Yn(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const r=(l.semitones+e)%12;return{...l,semitones:r<0?r+12:r,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function Qn(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const r=t[n],a=l+r.semitones,o=e.scaleNotes.find(p=>p.semitones===a%12),u=r.flats>0,i=r.sharps>0,d=(u?a+1:i?a-1:a)%12,f=u?-1:i?1:0;s.push(Yn(o??e.notesMap.get(d),o?0:f,a))}return s}const Xn=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function Zn(l){const t=(l-12)%12;return{...Xn[t],semitones:t,midi:l}}function ea(l){return`${l.note.trim().charAt(0).toUpperCase()}${"♭".repeat(l.flats)}${"♯".repeat(l.sharps)}`}class ft extends Cs{constructor(e,t,s){const n=t.range[0],r=t.range[1],a=new Set(t.scale.scaleNotes.map(u=>u.semitones)),o=s.chords.flatMap(u=>{const i=[],d=u.intervals.reduce((f,p)=>p.semitones>f?p.semitones:f,0);for(let f=n;f<=r-d;f+=1)if((!s.onlyScale||a.has(f%12))&&(!u.allowed||u.allowed.has(f%12))){const p=Qn(f,t.scale,u.intervals);i.push({...u,rootNote:p[0].note,chord:`${p[0].note}${u.suffixes[0]}`,notes:p})}return i});super(e,o,t),this.played=new Set,this.opts=s}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${ea(e)}${e.chord.toLowerCase()}`,notes:[]},s=this.current.chord===t.chord;return this.addGuessed(t,s)}guess(){const e=Array.from(this.played.values()).map(n=>Zn(n)).sort((n,r)=>n.midi-r.midi);this.played.clear();const t={chord:"",notes:e},s=this.current.notes.every(n=>e.find(r=>r.midi%12===n.midi%12));return this.addGuessed(t,s)}}const ta={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class Ot extends Cs{constructor(e,t){const s=e==="keys-major"?"major":"minor";super(e,Object.keys(ta[s]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class Lt extends Cs{constructor(e,t){const s=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-s+1)).map((r,a)=>s+a),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const un={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},bt=Ue("waiting"),dt=ht(Ue(un),{key:"game-options"}),yt=Ue(void 0),As=Ue(an().map(l=>({...l,selected:!0}))),Ce={play(...[l,e]){var u,i,d;let t;const s=_e(Dt),n=_e(ws),r=_e(dt),a={scale:s,range:n,duplicates:r.duplicates,count:r.count};let o=[s.key,s.scale];if(l==="notes")t=new Lt(l,a),ge.setTarget([ge.getNote(t.current)]),(u=_e(lt))==null||u.noteOn(t.current);else if(l==="pitches")t=new Lt(l,a),ge.setTarget(),He.setInputValue("useSound",!0),(i=_e(lt))==null||i.noteOn(t.current);else if(l==="keys-major"||l=="keys-minor")t=new Ot(l,a),o=[t.current,l==="keys-major"?"major":"minor"];else if(l==="chords-play"||l==="chords-write")t=new ft(l,a,e);else if(l==="chords-diatonic"){const f=rn(s.triads).map((p,g)=>({...p,allowed:new Set([s.scaleNotes[g].semitones])}));t=new ft(l,a,{chords:f})}else throw Error("Unknown game type: "+l);return typeof t.current!="number"&&typeof t.current!="string"&&((d=_e(lt))==null||d.playChord(t.current.notes.map(f=>f.midi)),ge.setTarget(t.current.notes)),ge.setKeyAndScale(o[0],o[1]),ge.clearPlayed(),bt.set("waiting"),yt.set(t),t},updateState(l){bt.set(l)},setOptionValue(l,e){dt.update(t=>({...t,[l]:e}))},toggleChords(l){As.update(e=>e.map(t=>({...t,selected:l(t)})))},nextGuess(){var e,t;const l=_e(yt);l!=null&&l.ended?bt.set("ended"):l instanceof Lt?(l.type==="notes"?ge.setTarget([ge.getNote(l.current)]):ge.setTarget(),ge.clearPlayed(),(e=_e(lt))==null||e.noteOn(l.current),Ce.updateState("waiting"),l.startTime()):l instanceof ft?(ge.setTarget(l.current.notes),ge.clearPlayed(),(t=_e(lt))==null||t.playChord(l==null?void 0:l.current.notes.map(s=>s.midi)),bt.set("waiting"),l.startTime()):l instanceof Ot&&(ge.setKey(l.current),bt.set("waiting"),l.startTime())},clearGame(l=!1){const e=_e(yt);e&&ge.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),l&&dt.set(un),yt.set(void 0),bt.set("waiting"),ge.clearScore()}};function $s(l,e,t){const s=l.slice();return s[25]=e[t],s[27]=t,s}function Hs(l,e,t){const s=l.slice();return s[30]=e[t],s}function zs(l,e,t){const s=l.slice();return s[8]=e[t],s}function qs(l,e,t){const s=l.slice();return s[25]=e[t],s[27]=t,s}function Ws(l,e,t){const s=l.slice();return s[30]=e[t],s}function Js(l,e,t){const s=l.slice();return s[8]=e[t],s}function sa(l){let e,t=le(l[25].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ys(Ws(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Be()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Be()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&64){t=le(n[25].intervals);let a;for(a=0;a<t.length;a+=1){const o=Ws(n,t,a);s[a]?s[a].p(o,r):(s[a]=Ys(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function la(l){let e,t=le(l[2][l[27]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Qs(Js(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Be()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Be()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&4){t=le(n[2][n[27]]);let a;for(a=0;a<t.length;a+=1){const o=Js(n,t,a);s[a]?s[a].p(o,r):(s[a]=Qs(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function Ys(l){let e,t=l[30].interval+"",s;return{c(){e=_("span"),s=Y(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r[0]&64&&t!==(t=n[30].interval+"")&&oe(s,t)},d(n){n&&m(e)}}}function Qs(l){let e,t=l[8].note+"",s;return{c(){e=_("span"),s=Y(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r[0]&4&&t!==(t=n[8].note+"")&&oe(s,t)},d(n){n&&m(e)}}}function Xs(l){let e,t,s,n,r,a,o=l[25].suffixes[0]+"",u,i,d,f,p,g,b=l[25].name+"",E,N,k,O;n=new nt({props:{icon:l[25].selected?Xt:Zt,width:12}});function j(){return l[21](l[25])}function y(D,G){return D[2][D[27]]&&D[2][D[27]].length>0?la:sa}let L=y(l),I=L(l);return{c(){e=_("li"),t=_("button"),s=_("span"),be(n.$$.fragment),r=P(),a=_("div"),u=Y(o),i=P(),d=_("li"),I.c(),p=P(),g=_("li"),E=Y(b),this.h()},l(D){e=v(D,"LI",{});var G=S(e);t=v(G,"BUTTON",{class:!0});var C=S(t);s=v(C,"SPAN",{class:!0});var B=S(s);ye(n.$$.fragment,B),B.forEach(m),r=V(C),a=v(C,"DIV",{class:!0});var T=S(a);u=Q(T,o),T.forEach(m),C.forEach(m),G.forEach(m),i=V(D),d=v(D,"LI",{class:!0,title:!0});var w=S(d);I.l(w),w.forEach(m),p=V(D),g=v(D,"LI",{class:!0});var A=S(g);E=Q(A,b),A.forEach(m),this.h()},h(){h(s,"class","px-1 py-1 rounded"),J(s,"text-green-500",l[25].selected),J(s,"text-gray-400",!l[25].selected),h(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),h(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),J(t,"hidden",l[7]),h(d,"class","intervals svelte-1j99daw"),h(d,"title",f=l[25].intervals.map(ll).join("-")),h(g,"class","text-xs")},m(D,G){M(D,e,G),c(e,t),c(t,s),ke(n,s,null),c(t,r),c(t,a),c(a,u),M(D,i,G),M(D,d,G),I.m(d,null),M(D,p,G),M(D,g,G),c(g,E),N=!0,k||(O=H(t,"click",j),k=!0)},p(D,G){l=D;const C={};G[0]&64&&(C.icon=l[25].selected?Xt:Zt),n.$set(C),(!N||G[0]&64)&&J(s,"text-green-500",l[25].selected),(!N||G[0]&64)&&J(s,"text-gray-400",!l[25].selected),(!N||G[0]&64)&&o!==(o=l[25].suffixes[0]+"")&&oe(u,o),(!N||G[0]&128)&&J(t,"hidden",l[7]),L===(L=y(l))&&I?I.p(l,G):(I.d(1),I=L(l),I&&(I.c(),I.m(d,null))),(!N||G[0]&64&&f!==(f=l[25].intervals.map(ll).join("-")))&&h(d,"title",f),(!N||G[0]&64)&&b!==(b=l[25].name+"")&&oe(E,b)},i(D){N||(F(n.$$.fragment,D),N=!0)},o(D){q(n.$$.fragment,D),N=!1},d(D){D&&(m(e),m(i),m(d),m(p),m(g)),Ee(n),I.d(),k=!1,O()}}}function na(l){let e,t=le(l[25].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Zs(Hs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Be()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Be()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&32){t=le(n[25].intervals);let a;for(a=0;a<t.length;a+=1){const o=Hs(n,t,a);s[a]?s[a].p(o,r):(s[a]=Zs(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function aa(l){let e,t=le(l[3][l[27]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=el(zs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Be()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Be()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&8){t=le(n[3][n[27]]);let a;for(a=0;a<t.length;a+=1){const o=zs(n,t,a);s[a]?s[a].p(o,r):(s[a]=el(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function Zs(l){let e,t=l[30].interval+"",s;return{c(){e=_("span"),s=Y(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r[0]&32&&t!==(t=n[30].interval+"")&&oe(s,t)},d(n){n&&m(e)}}}function el(l){let e,t=l[8].note+"",s;return{c(){e=_("span"),s=Y(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r[0]&8&&t!==(t=n[8].note+"")&&oe(s,t)},d(n){n&&m(e)}}}function tl(l){let e,t,s,n,r,a,o=l[25].suffixes[0]+"",u,i,d,f,p,g,b=l[25].name+"",E,N,k,O;n=new nt({props:{icon:l[25].selected?Xt:Zt,width:12}});function j(){return l[22](l[25])}function y(D,G){return D[3][D[27]]&&D[3][D[27]].length>0?aa:na}let L=y(l),I=L(l);return{c(){e=_("li"),t=_("button"),s=_("span"),be(n.$$.fragment),r=P(),a=_("div"),u=Y(o),i=P(),d=_("li"),I.c(),p=P(),g=_("li"),E=Y(b),this.h()},l(D){e=v(D,"LI",{});var G=S(e);t=v(G,"BUTTON",{class:!0});var C=S(t);s=v(C,"SPAN",{class:!0});var B=S(s);ye(n.$$.fragment,B),B.forEach(m),r=V(C),a=v(C,"DIV",{class:!0});var T=S(a);u=Q(T,o),T.forEach(m),C.forEach(m),G.forEach(m),i=V(D),d=v(D,"LI",{class:!0,title:!0});var w=S(d);I.l(w),w.forEach(m),p=V(D),g=v(D,"LI",{class:!0});var A=S(g);E=Q(A,b),A.forEach(m),this.h()},h(){h(s,"class","px-1 py-1 rounded"),J(s,"text-green-500",l[25].selected),J(s,"text-gray-400",!l[25].selected),h(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),h(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),J(t,"hidden",l[7]),h(d,"class","intervals svelte-1j99daw"),h(d,"title",f=l[25].intervals.map(nl).join("-")),h(g,"class","text-xs")},m(D,G){M(D,e,G),c(e,t),c(t,s),ke(n,s,null),c(t,r),c(t,a),c(a,u),M(D,i,G),M(D,d,G),I.m(d,null),M(D,p,G),M(D,g,G),c(g,E),N=!0,k||(O=H(t,"click",j),k=!0)},p(D,G){l=D;const C={};G[0]&32&&(C.icon=l[25].selected?Xt:Zt),n.$set(C),(!N||G[0]&32)&&J(s,"text-green-500",l[25].selected),(!N||G[0]&32)&&J(s,"text-gray-400",!l[25].selected),(!N||G[0]&32)&&o!==(o=l[25].suffixes[0]+"")&&oe(u,o),(!N||G[0]&128)&&J(t,"hidden",l[7]),L===(L=y(l))&&I?I.p(l,G):(I.d(1),I=L(l),I&&(I.c(),I.m(d,null))),(!N||G[0]&32&&f!==(f=l[25].intervals.map(nl).join("-")))&&h(d,"title",f),(!N||G[0]&32)&&b!==(b=l[25].name+"")&&oe(E,b)},i(D){N||(F(n.$$.fragment,D),N=!0)},o(D){q(n.$$.fragment,D),N=!1},d(D){D&&(m(e),m(i),m(d),m(p),m(g)),Ee(n),I.d(),k=!1,O()}}}function ra(l){let e,t,s,n,r="Chords",a,o,u,i,d,f,p,g,b,E,N,k,O,j,y,L,I,D="Key",G,C,B,T,w="Scale",A,U,K,x,ce="Note",ne,$,we,z,se,he,ie,ue,Re,Pe;i=new nt({props:{icon:Cn,width:20}}),p=new nt({props:{icon:An,width:16}}),E=new nt({props:{icon:l[4]?Bs:Gs,width:16}}),O=new nt({props:{icon:sn,width:16}});let je=le(l[6]),ae=[];for(let R=0;R<je.length;R+=1)ae[R]=Xs(qs(l,je,R));const Se=R=>q(ae[R],1,1,()=>{ae[R]=null});let ve=le(l[5]),X=[];for(let R=0;R<ve.length;R+=1)X[R]=tl($s(l,ve,R));const re=R=>q(X[R],1,1,()=>{X[R]=null});return{c(){e=_("div"),t=_("fieldset"),s=_("legend"),n=_("button"),n.textContent=r,a=P(),o=_("div"),u=_("button"),be(i.$$.fragment),d=P(),f=_("button"),be(p.$$.fragment),g=P(),b=_("button"),be(E.$$.fragment),N=P(),k=_("button"),be(O.$$.fragment),j=P(),y=_("div"),L=_("div"),I=_("label"),I.textContent=D,G=P(),C=_("input"),B=P(),T=_("label"),T.textContent=w,A=P(),U=_("input"),K=P(),x=_("label"),x.textContent=ce,ne=P(),$=_("input"),we=P(),z=_("ul");for(let R=0;R<ae.length;R+=1)ae[R].c();se=P(),he=_("ul");for(let R=0;R<X.length;R+=1)X[R].c();this.h()},l(R){e=v(R,"DIV",{class:!0});var Z=S(e);t=v(Z,"FIELDSET",{class:!0});var me=S(t);s=v(me,"LEGEND",{class:!0});var te=S(s);n=v(te,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1knqzl6"&&(n.textContent=r),te.forEach(m),a=V(me),o=v(me,"DIV",{class:!0});var Ne=S(o);u=v(Ne,"BUTTON",{class:!0});var Ge=S(u);ye(i.$$.fragment,Ge),Ge.forEach(m),d=V(Ne),f=v(Ne,"BUTTON",{class:!0});var rt=S(f);ye(p.$$.fragment,rt),rt.forEach(m),g=V(Ne),b=v(Ne,"BUTTON",{class:!0});var Je=S(b);ye(E.$$.fragment,Je),Je.forEach(m),N=V(Ne),k=v(Ne,"BUTTON",{class:!0});var Ke=S(k);ye(O.$$.fragment,Ke),Ke.forEach(m),Ne.forEach(m),j=V(me),y=v(me,"DIV",{class:!0});var Ve=S(y);L=v(Ve,"DIV",{class:!0});var Le=S(L);I=v(Le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(I)!=="svelte-14m38zf"&&(I.textContent=D),G=V(Le),C=v(Le,"INPUT",{class:!0,id:!0}),B=V(Le),T=v(Le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(T)!=="svelte-bxhcb0"&&(T.textContent=w),A=V(Le),U=v(Le,"INPUT",{class:!0,id:!0}),K=V(Le),x=v(Le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(x)!=="svelte-dmbfli"&&(x.textContent=ce),ne=V(Le),$=v(Le,"INPUT",{class:!0,id:!0}),Le.forEach(m),we=V(Ve),z=v(Ve,"UL",{class:!0});var jt=S(z);for(let xe=0;xe<ae.length;xe+=1)ae[xe].l(jt);jt.forEach(m),se=V(Ve),he=v(Ve,"UL",{class:!0});var At=S(he);for(let xe=0;xe<X.length;xe+=1)X[xe].l(At);At.forEach(m),Ve.forEach(m),me.forEach(m),Z.forEach(m),this.h()},h(){h(n,"class","px-1 rounded hover:bg-gray-100"),h(s,"class","text-base"),h(u,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),J(u,"hidden",l[7]),h(f,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),J(f,"hidden",l[7]),h(b,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),J(b,"hidden",l[7]),h(k,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),J(k,"hidden",l[7]),h(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),h(I,"class","mr-4 font-bold svelte-1j99daw"),h(I,"for","scale-key"),h(C,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(C,"id","scale-key"),C.value=l[0],h(T,"class","font-bold svelte-1j99daw"),h(T,"for","scale-key"),h(U,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(U,"id","scale-key"),U.value="Major",U.disabled=!0,h(x,"class","font-bold svelte-1j99daw"),h(x,"for","scale-key"),h($,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h($,"id","scale-key"),$.value=l[1],h(L,"class","flex mb-2 input svelte-1j99daw"),h(z,"class","chord-list w-full svelte-1j99daw"),h(he,"class","chord-list w-full svelte-1j99daw"),h(y,"class","body svelte-1j99daw"),J(y,"hidden",l[7]),h(t,"class","flex flex-col relative rounded border-2 px-4 py-2 my-4 text-sm svelte-1j99daw"),J(t,"collapsed",l[7]),h(e,"class",ie=Ae(`${l[18].class||""}`)+" svelte-1j99daw")},m(R,Z){M(R,e,Z),c(e,t),c(t,s),c(s,n),c(t,a),c(t,o),c(o,u),ke(i,u,null),c(o,d),c(o,f),ke(p,f,null),c(o,g),c(o,b),ke(E,b,null),c(o,N),c(o,k),ke(O,k,null),c(t,j),c(t,y),c(y,L),c(L,I),c(L,G),c(L,C),c(L,B),c(L,T),c(L,A),c(L,U),c(L,K),c(L,x),c(L,ne),c(L,$),c(y,we),c(y,z);for(let me=0;me<ae.length;me+=1)ae[me]&&ae[me].m(z,null);c(y,se),c(y,he);for(let me=0;me<X.length;me+=1)X[me]&&X[me].m(he,null);ue=!0,Re||(Pe=[H(n,"click",l[10]),H(u,"click",l[14]),H(f,"click",l[15]),H(b,"click",l[16]),H(k,"click",l[17]),H(C,"input",l[11]),H($,"input",l[12])],Re=!0)},p(R,Z){(!ue||Z[0]&128)&&J(u,"hidden",R[7]),(!ue||Z[0]&128)&&J(f,"hidden",R[7]);const me={};if(Z[0]&16&&(me.icon=R[4]?Bs:Gs),E.$set(me),(!ue||Z[0]&128)&&J(b,"hidden",R[7]),(!ue||Z[0]&128)&&J(k,"hidden",R[7]),(!ue||Z[0]&1&&C.value!==R[0])&&(C.value=R[0]),(!ue||Z[0]&2&&$.value!==R[1])&&($.value=R[1]),Z[0]&8388){je=le(R[6]);let te;for(te=0;te<je.length;te+=1){const Ne=qs(R,je,te);ae[te]?(ae[te].p(Ne,Z),F(ae[te],1)):(ae[te]=Xs(Ne),ae[te].c(),F(ae[te],1),ae[te].m(z,null))}for(Ze(),te=je.length;te<ae.length;te+=1)Se(te);et()}if(Z[0]&8360){ve=le(R[5]);let te;for(te=0;te<ve.length;te+=1){const Ne=$s(R,ve,te);X[te]?(X[te].p(Ne,Z),F(X[te],1)):(X[te]=tl(Ne),X[te].c(),F(X[te],1),X[te].m(he,null))}for(Ze(),te=ve.length;te<X.length;te+=1)re(te);et()}(!ue||Z[0]&128)&&J(y,"hidden",R[7]),(!ue||Z[0]&128)&&J(t,"collapsed",R[7]),(!ue||Z[0]&262144&&ie!==(ie=Ae(`${R[18].class||""}`)+" svelte-1j99daw"))&&h(e,"class",ie)},i(R){if(!ue){F(i.$$.fragment,R),F(p.$$.fragment,R),F(E.$$.fragment,R),F(O.$$.fragment,R);for(let Z=0;Z<je.length;Z+=1)F(ae[Z]);for(let Z=0;Z<ve.length;Z+=1)F(X[Z]);ue=!0}},o(R){q(i.$$.fragment,R),q(p.$$.fragment,R),q(E.$$.fragment,R),q(O.$$.fragment,R),ae=ae.filter(Boolean);for(let Z=0;Z<ae.length;Z+=1)q(ae[Z]);X=X.filter(Boolean);for(let Z=0;Z<X.length;Z+=1)q(X[Z]);ue=!1},d(R){R&&m(e),Ee(i),Ee(p),Ee(E),Ee(O),Oe(ae,R),Oe(X,R),Re=!1,ot(Pe)}}}let sl="Major";const ll=l=>l.interval,nl=l=>l.interval;function oa(l,e,t){let s,n,r,a,o,u;de(l,As,T=>t(20,o=T));let i="C",d=es(i,sl),f="",p,g=[],b=[];const E=ht(Ue(!0),{key:"chords-hidden"});de(l,E,T=>t(7,u=T));function N(){E.update(T=>!T)}function k(){const T=p&&60+p.semitones;if("err"in d||!T)t(2,g=[]),t(3,b=[]);else{const w=d.data;t(2,g=n.map(A=>ps(T,w,A.intervals))),t(3,b=r.map(A=>ps(T,w,A.intervals)))}}function O({currentTarget:{value:T}}){t(0,i=`${T.charAt(0).toUpperCase()}${T.charAt(1).toLowerCase()}`),d=es(i,sl),k()}function j({currentTarget:{value:T}}){t(1,f=`${T.charAt(0).toUpperCase()}${T.charAt(1).toLowerCase()}`),t(8,p=cn(f)),k()}function y(T){Ce.toggleChords(w=>w.name===T.name?!w.selected:w.selected)}function L(){const T=A=>A.suffixes[0]==="maj"||A.suffixes[0]==="m",w=o.filter(T).every(A=>A.selected);Ce.toggleChords(A=>T(A)?!w:A.selected)}function I(){const T=A=>A.suffixes[0]==="maj7"||A.suffixes[0]==="m7"||A.suffixes[0]==="7"||A.suffixes[0]==="dim7"||A.suffixes[0]==="aug7",w=o.filter(T).every(A=>A.selected);Ce.toggleChords(A=>T(A)?!w:A.selected)}function D(){Ce.toggleChords(T=>!a)}function G(){Ce.toggleChords(T=>!0)}const C=T=>y(T),B=T=>y(T);return l.$$set=T=>{t(18,e=Te(Te({},e),Ie(T)))},l.$$.update=()=>{l.$$.dirty[0]&1048576&&t(19,s=o),l.$$.dirty[0]&524288&&t(6,n=s.filter((T,w)=>w<s.length/2)),l.$$.dirty[0]&524288&&t(5,r=s.filter((T,w)=>w>=s.length/2)),l.$$.dirty[0]&524288&&t(4,a=s.every(T=>T.selected))},e=Ie(e),[i,f,g,b,a,r,n,u,p,E,N,O,j,y,L,I,D,G,e,s,o,C,B]}class ia extends ze{constructor(e){super(),qe(this,e,oa,ra,We,{},null,[-1,-1])}}function al(l,e,t){const s=l.slice();return s[10]=e[t],s}function ca(l){let e;return{c(){e=Y(" ")},l(t){e=Q(t," ")},m(t,s){M(t,e,s)},p:pe,d(t){t&&m(e)}}}function ua(l){let e,t,s="Played:",n,r=le(l[2]),a=[];for(let o=0;o<r.length;o+=1)a[o]=rl(al(l,r,o));return{c(){e=_("div"),t=_("span"),t.textContent=s,n=P();for(let o=0;o<a.length;o+=1)a[o].c()},l(o){e=v(o,"DIV",{});var u=S(e);t=v(u,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1g6xxhn"&&(t.textContent=s),n=V(u);for(let i=0;i<a.length;i+=1)a[i].l(u);u.forEach(m)},m(o,u){M(o,e,u),c(e,t),c(e,n);for(let i=0;i<a.length;i+=1)a[i]&&a[i].m(e,null)},p(o,u){if(u&4){r=le(o[2]);let i;for(i=0;i<r.length;i+=1){const d=al(o,r,i);a[i]?a[i].p(d,u):(a[i]=rl(d),a[i].c(),a[i].m(e,null))}for(;i<a.length;i+=1)a[i].d(1);a.length=r.length}},d(o){o&&m(e),Oe(a,o)}}}function fa(l){let e,t,s="Result:",n,r,a,o=l[0].correct+"",u,i,d=l[0].sampled.length+"",f,p,g,b,E,N=l[0].avgTime+"",k,O;return{c(){e=_("div"),t=_("span"),t.textContent=s,n=P(),r=_("span"),a=Y("["),u=Y(o),i=Y(" / "),f=Y(d),p=Y("]"),g=P(),b=_("span"),E=Y("avg "),k=Y(N),O=Y("s"),this.h()},l(j){e=v(j,"DIV",{class:!0});var y=S(e);t=v(y,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1eqfbgx"&&(t.textContent=s),n=V(y),r=v(y,"SPAN",{class:!0});var L=S(r);a=Q(L,"["),u=Q(L,o),i=Q(L," / "),f=Q(L,d),p=Q(L,"]"),L.forEach(m),g=V(y),b=v(y,"SPAN",{});var I=S(b);E=Q(I,"avg "),k=Q(I,N),O=Q(I,"s"),I.forEach(m),y.forEach(m),this.h()},h(){h(r,"class","mx-2"),h(e,"class","flex")},m(j,y){M(j,e,y),c(e,t),c(e,n),c(e,r),c(r,a),c(r,u),c(r,i),c(r,f),c(r,p),c(e,g),c(e,b),c(b,E),c(b,k),c(b,O)},p(j,y){y&1&&o!==(o=j[0].correct+"")&&oe(u,o),y&1&&d!==(d=j[0].sampled.length+"")&&oe(f,d),y&1&&N!==(N=j[0].avgTime+"")&&oe(k,N)},d(j){j&&m(e)}}}function da(l){var D,G,C,B;let e,t,s="Target:",n,r,a=((D=l[0].latestGuess.target)==null?void 0:D.chord)+"",o,u,i,d=((G=l[0].latestGuess.target)==null?void 0:G.notes.map(ol).join(" "))+"",f,p,g,b="Guessed:",E,N,k=((C=l[0].latestGuess.guessed)==null?void 0:C.chord)+"",O,j,y,L=((B=l[0].latestGuess.guessed)==null?void 0:B.notes.map(il).join(" "))+"",I;return{c(){e=_("div"),t=_("span"),t.textContent=s,n=P(),r=_("span"),o=Y(a),u=P(),i=_("span"),f=Y(d),p=P(),g=_("span"),g.textContent=b,E=P(),N=_("span"),O=Y(k),j=P(),y=_("span"),I=Y(L),this.h()},l(T){e=v(T,"DIV",{class:!0});var w=S(e);t=v(w,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=V(w),r=v(w,"SPAN",{});var A=S(r);o=Q(A,a),A.forEach(m),u=V(w),i=v(w,"SPAN",{});var U=S(i);f=Q(U,d),U.forEach(m),p=V(w),g=v(w,"SPAN",{"data-svelte-h":!0}),ee(g)!=="svelte-104368"&&(g.textContent=b),E=V(w),N=v(w,"SPAN",{});var K=S(N);O=Q(K,k),K.forEach(m),j=V(w),y=v(w,"SPAN",{});var x=S(y);I=Q(x,L),x.forEach(m),w.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(T,w){M(T,e,w),c(e,t),c(e,n),c(e,r),c(r,o),c(e,u),c(e,i),c(i,f),c(e,p),c(e,g),c(e,E),c(e,N),c(N,O),c(e,j),c(e,y),c(y,I)},p(T,w){var A,U,K,x;w&1&&a!==(a=((A=T[0].latestGuess.target)==null?void 0:A.chord)+"")&&oe(o,a),w&1&&d!==(d=((U=T[0].latestGuess.target)==null?void 0:U.notes.map(ol).join(" "))+"")&&oe(f,d),w&1&&k!==(k=((K=T[0].latestGuess.guessed)==null?void 0:K.chord)+"")&&oe(O,k),w&1&&L!==(L=((x=T[0].latestGuess.guessed)==null?void 0:x.notes.map(il).join(" "))+"")&&oe(I,L)},d(T){T&&m(e)}}}function ha(l){let e,t,s="Target:",n,r,a=l[0].latestGuess.target+"",o,u,i,d,f,p="Guessed:",g,b,E=l[0].latestGuess.guessed+"",N,k,O;return{c(){e=_("div"),t=_("span"),t.textContent=s,n=P(),r=_("span"),o=Y(a),u=P(),i=_("span"),d=P(),f=_("span"),f.textContent=p,g=P(),b=_("span"),N=Y(E),k=P(),O=_("span"),this.h()},l(j){e=v(j,"DIV",{class:!0});var y=S(e);t=v(y,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=V(y),r=v(y,"SPAN",{});var L=S(r);o=Q(L,a),L.forEach(m),u=V(y),i=v(y,"SPAN",{}),S(i).forEach(m),d=V(y),f=v(y,"SPAN",{"data-svelte-h":!0}),ee(f)!=="svelte-104368"&&(f.textContent=p),g=V(y),b=v(y,"SPAN",{});var I=S(b);N=Q(I,E),I.forEach(m),k=V(y),O=v(y,"SPAN",{}),S(O).forEach(m),y.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(j,y){M(j,e,y),c(e,t),c(e,n),c(e,r),c(r,o),c(e,u),c(e,i),c(e,d),c(e,f),c(e,g),c(e,b),c(b,N),c(e,k),c(e,O)},p(j,y){y&1&&a!==(a=j[0].latestGuess.target+"")&&oe(o,a),y&1&&E!==(E=j[0].latestGuess.guessed+"")&&oe(N,E)},d(j){j&&m(e)}}}function ma(l){let e,t,s="Target:",n,r,a=Xe(Nt(l[0].latestGuess.target||0))+"",o,u,i,d,f,p="Guessed:",g,b,E=Xe(Nt(l[0].latestGuess.guessed||0))+"",N,k,O;return{c(){e=_("div"),t=_("span"),t.textContent=s,n=P(),r=_("span"),o=Y(a),u=P(),i=_("span"),d=P(),f=_("span"),f.textContent=p,g=P(),b=_("span"),N=Y(E),k=P(),O=_("span"),this.h()},l(j){e=v(j,"DIV",{class:!0});var y=S(e);t=v(y,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=V(y),r=v(y,"SPAN",{});var L=S(r);o=Q(L,a),L.forEach(m),u=V(y),i=v(y,"SPAN",{}),S(i).forEach(m),d=V(y),f=v(y,"SPAN",{"data-svelte-h":!0}),ee(f)!=="svelte-104368"&&(f.textContent=p),g=V(y),b=v(y,"SPAN",{});var I=S(b);N=Q(I,E),I.forEach(m),k=V(y),O=v(y,"SPAN",{}),S(O).forEach(m),y.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(j,y){M(j,e,y),c(e,t),c(e,n),c(e,r),c(r,o),c(e,u),c(e,i),c(e,d),c(e,f),c(e,g),c(e,b),c(b,N),c(e,k),c(e,O)},p(j,y){y&1&&a!==(a=Xe(Nt(j[0].latestGuess.target||0))+"")&&oe(o,a),y&1&&E!==(E=Xe(Nt(j[0].latestGuess.guessed||0))+"")&&oe(N,E)},d(j){j&&m(e)}}}function rl(l){let e,t=Xe(l[10])+"",s;return{c(){e=_("span"),s=Y(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"class","mx-1")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r&4&&t!==(t=Xe(n[10])+"")&&oe(s,t)},d(n){n&&m(e)}}}function pa(l){let e;return{c(){e=Y(" ")},l(t){e=Q(t," ")},m(t,s){M(t,e,s)},p:pe,d(t){t&&m(e)}}}function _a(l){let e,t="Next",s,n,r="Autoplay",a,o;return{c(){e=_("button"),e.textContent=t,s=P(),n=_("button"),n.textContent=r,this.h()},l(u){e=v(u,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-1nvnoba"&&(e.textContent=t),s=V(u),n=v(u,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1cfj1sl"&&(n.textContent=r),this.h()},h(){h(e,"class","btn primary"),h(n,"class","btn primary")},m(u,i){M(u,e,i),M(u,s,i),M(u,n,i),a||(o=[H(e,"click",l[4]),H(n,"click",l[5])],a=!0)},p:pe,d(u){u&&(m(e),m(s),m(n)),a=!1,ot(o)}}}function va(l){let e,t="Stop autoplay",s,n;return{c(){e=_("button"),e.textContent=t,this.h()},l(r){e=v(r,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){h(e,"class","btn primary")},m(r,a){M(r,e,a),s||(n=H(e,"click",l[9]),s=!0)},p:pe,d(r){r&&m(e),s=!1,n()}}}function ga(l){let e,t="Try Again",s,n,r="Clear",a,o;return{c(){e=_("button"),e.textContent=t,s=P(),n=_("button"),n.textContent=r,this.h()},l(u){e=v(u,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-y911ux"&&(e.textContent=t),s=V(u),n=v(u,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-11mnk9v"&&(n.textContent=r),this.h()},h(){h(e,"class","btn primary"),h(n,"class","btn primary")},m(u,i){M(u,e,i),M(u,s,i),M(u,n,i),a||(o=[H(e,"click",l[6]),H(n,"click",l[7])],a=!0)},p:pe,d(u){u&&(m(e),m(s),m(n)),a=!1,ot(o)}}}function ba(l){let e,t,s,n;function r(f,p){return f[0]instanceof Lt&&(f[1]==="correct"||f[1]==="wrong")?ma:f[0]instanceof Ot&&(f[1]==="correct"||f[1]==="wrong")?ha:f[0]instanceof ft&&(f[1]==="correct"||f[1]==="wrong")?da:f[0]&&f[1]==="ended"?fa:f[2].length>0?ua:ca}let a=r(l),o=a(l);function u(f,p){return f[0]&&f[1]==="ended"?ga:f[0]&&f[3].autoplay?va:f[0]?_a:pa}let i=u(l),d=i(l);return{c(){e=_("div"),o.c(),s=P(),n=_("div"),d.c(),this.h()},l(f){e=v(f,"DIV",{class:!0});var p=S(e);o.l(p),p.forEach(m),s=V(f),n=v(f,"DIV",{class:!0});var g=S(n);d.l(g),g.forEach(m),this.h()},h(){h(e,"class",t=Ae(`${l[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),h(n,"class","mt-2 h-8")},m(f,p){M(f,e,p),o.m(e,null),M(f,s,p),M(f,n,p),d.m(n,null)},p(f,[p]){a===(a=r(f))&&o?o.p(f,p):(o.d(1),o=a(f),o&&(o.c(),o.m(e,null))),p&256&&t!==(t=Ae(`${f[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs")&&h(e,"class",t),i===(i=u(f))&&d?d.p(f,p):(d.d(1),d=i(f),d&&(d.c(),d.m(n,null)))},i:pe,o:pe,d(f){f&&(m(e),m(s),m(n)),o.d(),d.d()}}}const ol=l=>l.note,il=l=>l.note;function ya(l,e,t){let s,n,r;de(l,bt,p=>t(1,s=p)),de(l,gt,p=>t(2,n=p)),de(l,dt,p=>t(3,r=p));let{game:a}=e;function o(){Ce.nextGuess()}function u(){Ce.setOptionValue("autoplay",!0),Ce.nextGuess()}function i(){a instanceof ft?Ce.play(a.type,a.opts):a&&Ce.play(a.type,void 0)}function d(){Ce.clearGame()}const f=()=>Ce.setOptionValue("autoplay",!1);return l.$$set=p=>{t(8,e=Te(Te({},e),Ie(p))),"game"in p&&t(0,a=p.game)},e=Ie(e),[a,s,n,r,o,u,i,d,e,f]}class ka extends ze{constructor(e){super(),qe(this,e,ya,ba,We,{game:0})}}function cl(l,e,t){const s=l.slice();return s[15]=e[t].key,s[16]=e[t].value,s[17]=e[t].icon,s[19]=t,s}const Ea=l=>({}),ul=l=>({}),wa=l=>({}),fl=l=>({});function dl(l){let e,t,s,n,r,a,o,u,i,d,f;const p=l[12].header,g=Ql(p,l,l[11],ul);let b=le(l[0]),E=[];for(let k=0;k<b.length;k+=1)E[k]=hl(cl(l,b,k));const N=k=>q(E[k],1,1,()=>{E[k]=null});return{c(){e=_("button"),s=P(),n=_("ul"),r=_("li"),g&&g.c(),a=P();for(let k=0;k<E.length;k+=1)E[k].c();this.h()},l(k){e=v(k,"BUTTON",{class:!0,tabindex:!0}),S(e).forEach(m),s=V(k),n=v(k,"UL",{class:!0});var O=S(n);r=v(O,"LI",{});var j=S(r);g&&g.l(j),j.forEach(m),a=V(O);for(let y=0;y<E.length;y+=1)E[y].l(O);O.forEach(m),this.h()},h(){h(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),h(e,"tabindex","-1"),h(n,"class",o=Ae(`items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${l[2]||""}`)+" svelte-h65upg")},m(k,O){M(k,e,O),M(k,s,O),M(k,n,O),c(n,r),g&&g.m(r,null),c(n,a);for(let j=0;j<E.length;j+=1)E[j]&&E[j].m(n,null);i=!0,d||(f=H(e,"click",l[7]),d=!0)},p(k,O){if(l=k,g&&g.p&&(!i||O&2048)&&Xl(g,p,l,l[11],i?en(p,l[11],O,Ea):Zl(l[11]),ul),O&265){b=le(l[0]);let j;for(j=0;j<b.length;j+=1){const y=cl(l,b,j);E[j]?(E[j].p(y,O),F(E[j],1)):(E[j]=hl(y),E[j].c(),F(E[j],1),E[j].m(n,null))}for(Ze(),j=b.length;j<E.length;j+=1)N(j);et()}(!i||O&4&&o!==(o=Ae(`items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${l[2]||""}`)+" svelte-h65upg"))&&h(n,"class",o)},i(k){if(!i){k&&Ps(()=>{i&&(t||(t=qt(e,Vs,{duration:Jt},!0)),t.run(1))}),F(g,k);for(let O=0;O<b.length;O+=1)F(E[O]);k&&Ps(()=>{i&&(u||(u=qt(n,Os,{duration:Jt},!0)),u.run(1))}),i=!0}},o(k){k&&(t||(t=qt(e,Vs,{duration:Jt},!1)),t.run(0)),q(g,k),E=E.filter(Boolean);for(let O=0;O<E.length;O+=1)q(E[O]);k&&(u||(u=qt(n,Os,{duration:Jt},!1)),u.run(0)),i=!1},d(k){k&&(m(e),m(s),m(n)),k&&t&&t.end(),g&&g.d(k),Oe(E,k),k&&u&&u.end(),d=!1,f()}}}function Ca(l){let e;return{c(){e=_("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),S(e).forEach(m),this.h()},h(){h(e,"class","w-[24px]")},m(t,s){M(t,e,s)},p:pe,i:pe,o:pe,d(t){t&&m(e)}}}function Aa(l){let e,t;return e=new nt({props:{class:"mr-2",icon:l[17],width:16}}),{c(){be(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,n){ke(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.icon=s[17]),e.$set(r)},i(s){t||(F(e.$$.fragment,s),t=!0)},o(s){q(e.$$.fragment,s),t=!1},d(s){Ee(e,s)}}}function hl(l){let e,t,s,n,r,a,o=l[16]+"",u,i,d,f,p;const g=[Aa,Ca],b=[];function E(k,O){return k[17]?0:1}s=E(l),n=b[s]=g[s](l);function N(){return l[13](l[15])}return{c(){e=_("li"),t=_("button"),n.c(),r=P(),a=_("div"),u=Y(o),i=P(),this.h()},l(k){e=v(k,"LI",{});var O=S(e);t=v(O,"BUTTON",{class:!0});var j=S(t);n.l(j),r=V(j),a=v(j,"DIV",{});var y=S(a);u=Q(y,o),y.forEach(m),j.forEach(m),i=V(O),O.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),J(t,"selected",l[15]===l[3])},m(k,O){M(k,e,O),c(e,t),b[s].m(t,null),c(t,r),c(t,a),c(a,u),c(e,i),d=!0,f||(p=H(t,"click",N),f=!0)},p(k,O){l=k;let j=s;s=E(l),s===j?b[s].p(l,O):(Ze(),q(b[j],1,1,()=>{b[j]=null}),et(),n=b[s],n?n.p(l,O):(n=b[s]=g[s](l),n.c()),F(n,1),n.m(t,r)),(!d||O&1)&&o!==(o=l[16]+"")&&oe(u,o),(!d||O&9)&&J(t,"selected",l[15]===l[3])},i(k){d||(F(n),d=!0)},o(k){q(n),d=!1},d(k){k&&m(e),b[s].d(),f=!1,p()}}}function Ta(l){let e,t,s,n,r,a,o,u,i;const d=l[12].value,f=Ql(d,l,l[11],fl);let p=l[6]&&dl(l);return{c(){e=_("div"),t=_("button"),f&&f.c(),r=P(),p&&p.c(),this.h()},l(g){e=v(g,"DIV",{class:!0,id:!0});var b=S(e);t=v(b,"BUTTON",{class:!0,title:!0});var E=S(t);f&&f.l(E),E.forEach(m),r=V(b),p&&p.l(b),b.forEach(m),this.h()},h(){h(t,"class",s=Ae(`${l[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),h(t,"title",n=l[9].title||""),J(t,"disabled",l[4]),J(t,"open",l[6]),h(e,"class",a=Ae(`relative ${l[2]||""}`)+" svelte-h65upg"),h(e,"id",l[1])},m(g,b){M(g,e,b),c(e,t),f&&f.m(t,null),c(e,r),p&&p.m(e,null),l[14](e),o=!0,u||(i=H(t,"click",l[7]),u=!0)},p(g,[b]){f&&f.p&&(!o||b&2048)&&Xl(f,d,g,g[11],o?en(d,g[11],b,wa):Zl(g[11]),fl),(!o||b&512&&s!==(s=Ae(`${g[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&h(t,"class",s),(!o||b&512&&n!==(n=g[9].title||""))&&h(t,"title",n),(!o||b&528)&&J(t,"disabled",g[4]),(!o||b&576)&&J(t,"open",g[6]),g[6]?p?(p.p(g,b),b&64&&F(p,1)):(p=dl(g),p.c(),F(p,1),p.m(e,null)):p&&(Ze(),q(p,1,1,()=>{p=null}),et()),(!o||b&4&&a!==(a=Ae(`relative ${g[2]||""}`)+" svelte-h65upg"))&&h(e,"class",a),(!o||b&2)&&h(e,"id",g[1])},i(g){o||(F(f,g),F(p),o=!0)},o(g){q(f,g),q(p),o=!1},d(g){g&&m(e),f&&f.d(g),p&&p.d(),l[14](null),u=!1,i()}}}const Jt=400;function Ia(l,e,t){let{$$slots:s={},$$scope:n}=e,{options:r,id:a=void 0,containerClass:o=void 0,selected:u=void 0,disabled:i=void 0,onSelect:d}=e,f,p=!1;function g(){i||t(6,p=!p)}function b(k){t(6,p=d(k))}const E=k=>b(k);function N(k){bn[k?"unshift":"push"](()=>{f=k,t(5,f)})}return l.$$set=k=>{t(9,e=Te(Te({},e),Ie(k))),"options"in k&&t(0,r=k.options),"id"in k&&t(1,a=k.id),"containerClass"in k&&t(2,o=k.containerClass),"selected"in k&&t(3,u=k.selected),"disabled"in k&&t(4,i=k.disabled),"onSelect"in k&&t(10,d=k.onSelect),"$$scope"in k&&t(11,n=k.$$scope)},e=Ie(e),[r,a,o,u,i,f,p,g,b,e,d,n,s,E,N]}class fn extends ze{constructor(e){super(),qe(this,e,Ia,Ta,We,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function ml(l){let e;return{c(){e=_("li"),this.h()},l(t){e=v(t,"LI",{class:!0}),S(e).forEach(m),this.h()},h(){h(e,"class","m-[0.175rem] mr-0")},m(t,s){M(t,e,s)},d(t){t&&m(e)}}}function pl(l){let e;return{c(){e=_("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),S(e).forEach(m),this.h()},h(){h(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,s){M(t,e,s)},d(t){t&&m(e)}}}function _l(l){let e,t=l[0].note.note+"",s;return{c(){e=_("div"),s=Y(t),this.h()},l(n){e=v(n,"DIV",{class:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"class","absolute top-0 left-0")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r&1&&t!==(t=n[0].note.note+"")&&oe(s,t)},d(n){n&&m(e)}}}function Sa(l){let e,t,s,n,r,a,o=gl(l[0].key)+"",u,i,d,f,p=l[0].key==="{enter}"&&ml(),g=l[0].key==="{enter}"&&pl(),b=l[0].note&&_l(l);return{c(){p&&p.c(),e=P(),t=_("li"),s=_("button"),g&&g.c(),n=P(),b&&b.c(),r=P(),a=_("div"),u=Y(o),this.h()},l(E){p&&p.l(E),e=V(E),t=v(E,"LI",{class:!0});var N=S(t);s=v(N,"BUTTON",{class:!0});var k=S(s);g&&g.l(k),n=V(k),b&&b.l(k),r=V(k),a=v(k,"DIV",{});var O=S(a);u=Q(O,o),O.forEach(m),k.forEach(m),N.forEach(m),this.h()},h(){h(s,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex items-center justify-center svelte-1479mcy"),h(t,"class",i=Ae(`${l[2].class||""} m-[0.175rem] ${vl(l[0].size)}`)+" svelte-1479mcy"),J(t,"enter",l[0].key==="{enter}"),J(t,"captured",l[1])},m(E,N){p&&p.m(E,N),M(E,e,N),M(E,t,N),c(t,s),g&&g.m(s,null),c(s,n),b&&b.m(s,null),c(s,r),c(s,a),c(a,u),d||(f=H(s,"click",l[3]),d=!0)},p(E,[N]){E[0].key==="{enter}"?p||(p=ml(),p.c(),p.m(e.parentNode,e)):p&&(p.d(1),p=null),E[0].key==="{enter}"?g||(g=pl(),g.c(),g.m(s,n)):g&&(g.d(1),g=null),E[0].note?b?b.p(E,N):(b=_l(E),b.c(),b.m(s,r)):b&&(b.d(1),b=null),N&1&&o!==(o=gl(E[0].key)+"")&&oe(u,o),N&5&&i!==(i=Ae(`${E[2].class||""} m-[0.175rem] ${vl(E[0].size)}`)+" svelte-1479mcy")&&h(t,"class",i),N&5&&J(t,"enter",E[0].key==="{enter}"),N&7&&J(t,"captured",E[1])},i:pe,o:pe,d(E){E&&(m(e),m(t)),p&&p.d(E),g&&g.d(),b&&b.d(),d=!1,f()}}}function vl(l){return l&&Number.isInteger(l)?`size-${l}`:l?`size-${Math.floor(l)}-${Math.floor(l*10)-Math.floor(l)*10}`:"size-1"}function gl(l){return l==="{empty}"?"":l==="{bksp}"?"Backspace":l==="{tab}"?"Tab":l==="{enter}"?"Enter":l==="{lock}"?"Capslock":l==="{shift}"?"Shift":l}function Na(l,e,t){let{value:s,captured:n}=e;function r(a){ks.call(this,l,a)}return l.$$set=a=>{t(2,e=Te(Te({},e),Ie(a))),"value"in a&&t(0,s=a.value),"captured"in a&&t(1,n=a.captured)},e=Ie(e),[s,n,e,r]}class La extends ze{constructor(e){super(),qe(this,e,Na,Sa,We,{value:0,captured:1})}}const bs={ar:{name:"Arabic",import:fe(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:fe(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:fe(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:fe(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:fe(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:fe(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:fe(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:fe(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:fe(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>Da)},fa:{name:"Farsi",import:fe(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:fe(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:fe(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:fe(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:fe(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:fe(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:fe(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:fe(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:fe(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:fe(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:fe(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:fe(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:fe(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:fe(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:fe(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:fe(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:fe(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:fe(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:fe(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:fe(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:fe(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:fe(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:fe(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:fe(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function dn(l){if(!("default"in l.layout)||!("shift"in l.layout))throw console.error(l),Error("Invalid layout import");return{default:l.layout.default,shift:l.layout.shift}}async function hn(l=["en"]){let e={code:"en",layout:bs.en,index:99};Object.entries(bs).forEach(([s,n])=>{for(let r=0;r<l.length;r+=1)s===l[r]&&(!e||e.index>r)&&(e={code:s,layout:n,index:r})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:dn(t.default)}}const mn={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Da=Object.freeze(Object.defineProperty({__proto__:null,default:mn},Symbol.toStringTag,{value:"Module"}));function ja(l,e){return l[1].forEach((t,s)=>{let n;s===2?n={...e[1]}:s===3?n={...e[3]}:s===5?n={...e[6]}:s===6?n={...e[8]}:s===7?n={...e[10]}:s===9?(n={...e[1]},n.semitones+=12):s===10?(n={...e[3]},n.semitones+=12):s===12&&(n={...e[6]},n.semitones+=12),l[1][s].note=n}),l[2].forEach((t,s)=>{let n;s===1?n={...e[0]}:s===2?n={...e[2]}:s===3?n={...e[4]}:s===4?n={...e[5]}:s===5?n={...e[7]}:s===6?n={...e[9]}:s===7?n={...e[11]}:s===8?(n={...e[0]},n.semitones+=12):s===9?(n={...e[2]},n.semitones+=12):s===10?(n={...e[4]},n.semitones+=12):s===11?(n={...e[5]},n.semitones+=12):s===12&&(n={...e[7]},n.semitones+=12),l[2][s].note=n}),l}const Yt=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function Pa(l){let e=[];const t=l.default.map((s,n)=>{if(n===0){const r=s.split(" ").filter(a=>a!=="{bksp}");for(;r.length!==13;)r.length<13?r.unshift("{empty}"):r.shift();return[...r,"{bksp}"]}else if(n===1){const r=s.split(" ");return e=r.slice(13),[...r.slice(0,13),"{enter}"]}else{if(n===2)return[...s.split(" ").slice(0,13).filter(r=>r!=="{enter}"),...e].slice(0,13);if(n===3){const r=["{shift}",...s.split(" ").slice(1,12).filter(o=>o!=="{shift}"),"{shift}"];let a=1;for(;r.length<13;)r.splice(a,0,"{empty}"),a=a===1?-1:1;return r}else return s.split(" ")}});return[t[0].map((s,n)=>({key:s,code:Yt[0][n]})),t[1].map((s,n)=>({key:s,code:Yt[1][n]})),t[2].map((s,n)=>({key:s,code:Yt[2][n]})),t[3].map((s,n)=>({key:s,code:Yt[3][n]}))]}class ls{constructor(e){return this.rows=[[],[],[],[]],this.opts={hotkeydRows:"middle-row",layout:{code:"en",name:"English",imported:dn(mn)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=Pa(e),this}setRows(e){return this.rows=e,this}setRowHotkeys(e,t){}setNotes(e){if(this.opts.hotkeydRows==="middle-row")this.rows=ja(this.rows,e);else throw Error("not implemented")}static createWithRows(e,t){return new ls(e).setRows(t)}}const Ts=/^[a-gA-G]$/,pn=/^[♭Bb#♯sS]$/,Va=/^[0-9]$/;let W="",ut;function Oa(l,e){const{useHotkeys:t}=_e(at),s=_e(ns).get(l);if(t&&W.length===0&&s&&s.note)return W="",{e:"guessed-key",data:s.note.note};if(!t&&W.length===0&&Ts.test(e))return W+=e.toUpperCase(),{e:"string",data:W};if(!t&&W.length>0&&pn.test(e))return e==="b"||e==="B"?W+="♭":W+="♯",{e:"string",data:W};if(l==="Backspace"&&W.length>0)return W=W.slice(0,-1),{e:"string",data:W};if(l==="Enter"&&W.length>0){const n=W;return W="",{e:"guessed-key",data:n}}return!1}function Ba(l,e){if(l==="Enter"&&W.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let s=0;s<W.length;s+=1)s===0?t.note+=W[s]:t.chord.length>0?t.chord+=W[s].toLowerCase():W[s]==="♭"?(t.note+=W[s],t.flats+=1):W[s]==="♯"?(t.note+=W[s],t.sharps+=1):t.chord+=W[s].toLowerCase();return W="",{e:"guessed-chord",data:t}}else{if(l==="Backspace"&&W.length>0)return W=W.slice(0,-1),{e:"string",data:W};if(W.length===0&&Ts.test(e))return W+=e.toUpperCase(),{e:"string",data:W};if(W.length>0&&e.length===1)return W.length===1&&(e==="b"||e==="B")?W+="♭":W.length===1&&e==="#"?W+="♯":W+=e,{e:"string",data:W}}return!1}function Ga(l,e,t){const{useAutoOctave:s,useHotkeys:n}=_e(at);let r;const o=_e(ns).get(l),u=(o==null?void 0:o.key)||"";let i=!1;if(!ut&&n&&(o!=null&&o.note)?(ut=o.note,s&&(r=on(_e(ss)[0].midi)),i="note"):!n&&W.length===0&&Ts.test(e)?(W+=e.toUpperCase(),i="input"):!n&&W.length>0&&pn.test(e)&&(e==="b"||e==="B"?W+="♭":W+="♯",i="input"),Va.test(u))try{r=parseInt(u)}catch{}if(ut&&r!==void 0){const d=ut.semitones+(r+1+(t?1:0))*12;return ut=void 0,{e:"guessed-note",data:d}}else if(W&&r!==void 0){const d=Vt.findNote(W),f=d?d.semitones+(r+1)*12:void 0;return ut=void 0,W="",f!==void 0?{e:"guessed-note",data:f}:{e:"string",data:W}}else if(l==="Backspace"&&(ut||W.length>0))return ut=void 0,W=W.slice(0,-1),{e:"string",data:W};return i==="note"?{e:"note",data:ut}:i==="input"?{e:"string",data:W}:!1}const Ma={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},hs=[],kt=Ue(void 0);Ct(kt,l=>l?[l.rowIndex,l.nextIndex]:[-1,-1]);const Et=ht(Ue({useCustom:!1,customLayout:[[],[],[],[]],kbdOpts:{layout:Ma,hotkeydRows:"middle-row"}}),{key:"keyboard-settings"}),Is=Ct([Dt,Et],([l,e])=>{let t;return e.useCustom&&e.customLayout?t=ls.createWithRows(e.kbdOpts,e.customLayout):t=new ls(e.kbdOpts),t.setNotes(Array.from(l.notesMap.values())),t}),Ua=Ct(Is,l=>l.rows.map(e=>e.map((t,s)=>{let n;return t.key==="{bksp}"?n=2:t.key==="{tab}"?n=1.5:t.key==="{enter}"?n=2:t.key==="{lock}"?n=1.75:t.key==="{shift}"&&s===0?n=1.5:t.key==="{shift}"&&(n=2.5),n?{...t,size:n}:t}))),ns=Ct(Is,l=>new Map([...l.rows[0].map(e=>[e.code,e]),...l.rows[1].map(e=>[e.code,e]),...l.rows[2].map(e=>[e.code,e]),...l.rows[3].map(e=>[e.code,e])])),Ra=Ct(ns,l=>Array.from(l.values()).map(e=>e.note).filter(e=>e!==void 0)),Vt={async setLayout(l){const e=await hn([l]);Et.update(t=>({...t,layout:e}))},setCustomLayout(l){if(l){const e=_e(Is);Et.update(t=>({...t,useCustom:l,customLayout:t.customLayout.map((s,n)=>s.length===0?e.rows[n].map(r=>({...r})):s)}))}else Et.update(e=>({...e,useCustom:l}))},captureHotkeyRow(l){let e=-1,t=0;const s=_e(Et).customLayout[l].map((n,r)=>(n.key.charAt(0)!=="{"&&e===-1&&(e=r),t+=n.key.charAt(0)!=="{"?1:0,n));console.log("count",t),kt.set({row:s,nextIndex:e,rowIndex:l,count:t})},findNote(l){return _e(Ra).find(e=>{if(e.note.charAt(0)===l.charAt(0)){const t=l.slice(1).split("").reduce((s,n)=>s+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleInput(l,e,t=!1){const s=_e(yt),n=_e(kt);if(n){console.log("capturing ",hs.length);const{nextIndex:r,row:a}=n;return l==="Escape"?kt.set(void 0):hs.find(u=>u.code===l)||(hs.push({code:l,key:e}),a[r]={...a[r],code:l,key:e},r===n.count?(Et.update(u=>({...u,customLayout:u.customLayout.map((i,d)=>d!==n.rowIndex?i:a)})),kt.set(void 0)):kt.set({...n,nextIndex:r+1,row:a})),!1}else{if(s instanceof Ot)return Oa(l,e.toUpperCase());if(s instanceof ft&&s.type==="chords-write")return Ba(l,e);if(_e(at).useKeyboard)return Ga(l,e.toUpperCase(),t)}return!1}};function bl(l,e,t){const s=l.slice();return s[15]=e[t],s[17]=t,s}function yl(l,e,t){const s=l.slice();return s[18]=e[t],s[20]=t,s}function Ka(l){let e,t=l[0].kbdOpts.layout.name+"",s;return{c(){e=_("div"),s=Y(t),this.h()},l(n){e=v(n,"DIV",{slot:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"slot","value")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r&1&&t!==(t=n[0].kbdOpts.layout.name+"")&&oe(s,t)},d(n){n&&m(e)}}}function kl(l){let e,t,s,n,r;t=new nt({props:{icon:Tn,width:20}});function a(){return l[13](l[17])}return{c(){e=_("button"),be(t.$$.fragment),this.h()},l(o){e=v(o,"BUTTON",{class:!0});var u=S(e);ye(t.$$.fragment,u),u.forEach(m),this.h()},h(){h(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(o,u){M(o,e,u),ke(t,e,null),s=!0,n||(r=H(e,"click",a),n=!0)},p(o,u){l=o},i(o){s||(F(t.$$.fragment,o),s=!0)},o(o){q(t.$$.fragment,o),s=!1},d(o){o&&m(e),Ee(t),n=!1,r()}}}function El(l){let e,t;return e=new La({props:{value:l[18],captured:l[5]&&l[5].rowIndex===l[17]&&l[5].nextIndex===l[20]||!1}}),{c(){be(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,n){ke(e,s,n),t=!0},p(s,n){const r={};n&2&&(r.value=s[18]),n&32&&(r.captured=s[5]&&s[5].rowIndex===s[17]&&s[5].nextIndex===s[20]||!1),e.$set(r)},i(s){t||(F(e.$$.fragment,s),t=!0)},o(s){q(e.$$.fragment,s),t=!1},d(s){Ee(e,s)}}}function wl(l){let e,t,s,n,r=l[4][l[17]]&&kl(l),a=le(l[15]),o=[];for(let i=0;i<a.length;i+=1)o[i]=El(yl(l,a,i));const u=i=>q(o[i],1,1,()=>{o[i]=null});return{c(){e=_("li"),r&&r.c(),t=P();for(let i=0;i<o.length;i+=1)o[i].c();s=Be(),this.h()},l(i){e=v(i,"LI",{class:!0});var d=S(e);r&&r.l(d),d.forEach(m),t=V(i);for(let f=0;f<o.length;f+=1)o[f].l(i);s=Be(),this.h()},h(){h(e,"class","col-span-2 svelte-cgcsqn")},m(i,d){M(i,e,d),r&&r.m(e,null),M(i,t,d);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(i,d);M(i,s,d),n=!0},p(i,d){if(i[4][i[17]]?r?(r.p(i,d),d&16&&F(r,1)):(r=kl(i),r.c(),F(r,1),r.m(e,null)):r&&(Ze(),q(r,1,1,()=>{r=null}),et()),d&34){a=le(i[15]);let f;for(f=0;f<a.length;f+=1){const p=yl(i,a,f);o[f]?(o[f].p(p,d),F(o[f],1)):(o[f]=El(p),o[f].c(),F(o[f],1),o[f].m(s.parentNode,s))}for(Ze(),f=a.length;f<o.length;f+=1)u(f);et()}},i(i){if(!n){F(r);for(let d=0;d<a.length;d+=1)F(o[d]);n=!0}},o(i){q(r),o=o.filter(Boolean);for(let d=0;d<o.length;d+=1)q(o[d]);n=!1},d(i){i&&(m(e),m(t),m(s)),r&&r.d(),Oe(o,i)}}}function xa(l){let e,t,s,n,r="Layout",a,o,u,i,d,f="Custom",p,g,b,E,N,k,O="Middle-row",j,y,L,I,D,G="Two rows",C,B,T,w,A,U,K,x,ce;o=new fn({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1",options:l[6],onSelect:l[7],$$slots:{value:[Ka]},$$scope:{ctx:l}}});let ne=le(l[1]),$=[];for(let z=0;z<ne.length;z+=1)$[z]=wl(bl(l,ne,z));const we=z=>q($[z],1,1,()=>{$[z]=null});return{c(){e=_("div"),t=_("div"),s=_("div"),n=_("label"),n.textContent=r,a=P(),be(o.$$.fragment),u=P(),i=_("div"),d=_("label"),d.textContent=f,p=P(),g=_("input"),E=P(),N=_("div"),k=_("label"),k.textContent=O,j=P(),y=_("input"),L=P(),I=_("div"),D=_("label"),D.textContent=G,C=P(),B=_("input"),T=P(),w=_("div"),A=_("ul");for(let z=0;z<$.length;z+=1)$[z].c();this.h()},l(z){e=v(z,"DIV",{class:!0});var se=S(e);t=v(se,"DIV",{class:!0});var he=S(t);s=v(he,"DIV",{class:!0});var ie=S(s);n=v(ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1xsr9lq"&&(n.textContent=r),a=V(ie),ye(o.$$.fragment,ie),ie.forEach(m),u=V(he),i=v(he,"DIV",{class:!0});var ue=S(i);d=v(ue,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(d)!=="svelte-11aw8ub"&&(d.textContent=f),p=V(ue),g=v(ue,"INPUT",{class:!0,id:!0,type:!0}),ue.forEach(m),E=V(he),N=v(he,"DIV",{class:!0});var Re=S(N);k=v(Re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(k)!=="svelte-1ssbs6o"&&(k.textContent=O),j=V(Re),y=v(Re,"INPUT",{class:!0,id:!0,type:!0}),Re.forEach(m),L=V(he),I=v(he,"DIV",{class:!0});var Pe=S(I);D=v(Pe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(D)!=="svelte-3aw9ul"&&(D.textContent=G),C=V(Pe),B=v(Pe,"INPUT",{class:!0,id:!0,type:!0}),Pe.forEach(m),he.forEach(m),T=V(se),w=v(se,"DIV",{class:!0});var je=S(w);A=v(je,"UL",{class:!0});var ae=S(A);for(let Se=0;Se<$.length;Se+=1)$[Se].l(ae);ae.forEach(m),je.forEach(m),se.forEach(m),this.h()},h(){h(n,"class","font-bold mr-4"),h(n,"for","middle-row"),h(s,"class","my-1 flex items-center justify-between mr-2"),h(d,"class","font-bold mr-4"),h(d,"for","custom-layout"),h(g,"class","h-[20px]"),h(g,"id","custom-layout"),h(g,"type","checkbox"),g.checked=b=l[0].useCustom,h(i,"class","my-1 flex items-center justify-between mr-12"),h(k,"class","font-bold mr-4"),h(k,"for","middle-row"),h(y,"class","h-[20px]"),h(y,"id","middle-row"),h(y,"type","checkbox"),h(N,"class","my-1 flex items-center justify-between mr-12"),h(D,"class","font-bold mr-4"),h(D,"for","two-rows"),h(B,"class","h-[20px]"),h(B,"id","two-rows"),h(B,"type","checkbox"),h(I,"class","my-1 flex items-center justify-between mr-12"),h(t,"class","flex"),h(A,"class","keyboard svelte-cgcsqn"),h(w,"class","flex flex-col gap-1.5"),h(e,"class",U=Ae(`${l[10].class||""} `)+" svelte-cgcsqn")},m(z,se){M(z,e,se),c(e,t),c(t,s),c(s,n),c(s,a),ke(o,s,null),c(t,u),c(t,i),c(i,d),c(i,p),c(i,g),c(t,E),c(t,N),c(N,k),c(N,j),c(N,y),y.checked=l[2],c(t,L),c(t,I),c(I,D),c(I,C),c(I,B),B.checked=l[3],c(e,T),c(e,w),c(w,A);for(let he=0;he<$.length;he+=1)$[he]&&$[he].m(A,null);K=!0,x||(ce=[H(g,"change",l[8]),H(y,"change",l[11]),H(B,"change",l[12])],x=!0)},p(z,[se]){const he={};if(se&2097153&&(he.$$scope={dirty:se,ctx:z}),o.$set(he),(!K||se&1&&b!==(b=z[0].useCustom))&&(g.checked=b),se&4&&(y.checked=z[2]),se&8&&(B.checked=z[3]),se&562){ne=le(z[1]);let ie;for(ie=0;ie<ne.length;ie+=1){const ue=bl(z,ne,ie);$[ie]?($[ie].p(ue,se),F($[ie],1)):($[ie]=wl(ue),$[ie].c(),F($[ie],1),$[ie].m(A,null))}for(Ze(),ie=ne.length;ie<$.length;ie+=1)we(ie);et()}(!K||se&1024&&U!==(U=Ae(`${z[10].class||""} `)+" svelte-cgcsqn"))&&h(e,"class",U)},i(z){if(!K){F(o.$$.fragment,z);for(let se=0;se<ne.length;se+=1)F($[se]);K=!0}},o(z){q(o.$$.fragment,z),$=$.filter(Boolean);for(let se=0;se<$.length;se+=1)q($[se]);K=!1},d(z){z&&m(e),Ee(o),Oe($,z),x=!1,ot(ce)}}}function Fa(l,e,t){let s,n,r,a,o;de(l,Et,k=>t(0,n=k)),de(l,Ua,k=>t(1,r=k)),de(l,ns,k=>t(14,a=k)),de(l,kt,k=>t(5,o=k)),tn(async()=>{console.log(a);const k=await hn(["sw"]);console.log(k),window.layout=k});let u=!0,i=!1;const d=Object.entries(bs).map(([k,O])=>({key:k,value:O.name}));function f(k){return Vt.setLayout(k),!1}function p(k){Vt.setCustomLayout(k.currentTarget.checked)}function g(k){Vt.captureHotkeyRow(k)}function b(){u=this.checked,t(2,u)}function E(){i=this.checked,t(3,i)}const N=k=>g(k);return l.$$set=k=>{t(10,e=Te(Te({},e),Ie(k)))},l.$$.update=()=>{l.$$.dirty&3&&t(4,s=r.map((k,O)=>n.kbdOpts.hotkeydRows==="middle-row"?O===1||O===2:!0))},e=Ie(e),[n,r,u,i,s,o,d,f,p,g,e,b,E,N]}class $a extends ze{constructor(e){super(),qe(this,e,Fa,xa,We,{})}}function Cl(l){let e,t;return e=new $a({props:{class:"mt-4"}}),{c(){be(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,n){ke(e,s,n),t=!0},i(s){t||(F(e.$$.fragment,s),t=!0)},o(s){q(e.$$.fragment,s),t=!1},d(s){Ee(e,s)}}}function Ha(l){let e,t,s,n,r="I/O",a,o,u,i,d="Device",f,p,g,b,E,N,k="Prompt",O,j,y="Disable",L,I,D,G,C="Sound",B,T,w,A,U,K,x="Fixed velocity",ce,ne,$,we,z,se,he="Keyboard",ie,ue,Re,Pe,je,ae,Se="Hotkeys",ve,X,re,R,Z,me,te="Auto-octave",Ne,Ge,rt,Je,Ke,Ve,Le,jt="Set hotkeys",At,xe,mt,Ss="Fade timeout",as,it,rs,pt,Bt,os,_t,Ns="Reset all",is,Gt,Ye,cs,Ls,Me=l[2]&&Cl();return{c(){e=_("div"),t=_("fieldset"),s=_("legend"),n=_("button"),n.textContent=r,a=P(),o=_("div"),u=_("div"),i=_("label"),i.textContent=d,f=P(),p=_("input"),b=P(),E=_("div"),N=_("button"),N.textContent=k,O=P(),j=_("button"),j.textContent=y,L=P(),I=_("div"),D=_("div"),G=_("label"),G.textContent=C,B=P(),T=_("input"),A=P(),U=_("div"),K=_("label"),K.textContent=x,ce=P(),ne=_("input"),$=P(),we=_("div"),z=_("div"),se=_("label"),se.textContent=he,ie=P(),ue=_("input"),Pe=P(),je=_("div"),ae=_("label"),ae.textContent=Se,ve=P(),X=_("input"),R=P(),Z=_("div"),me=_("label"),me.textContent=te,Ne=P(),Ge=_("input"),Je=P(),Ke=_("div"),Ve=_("div"),Le=_("button"),Le.textContent=jt,At=P(),xe=_("div"),mt=_("label"),mt.textContent=Ss,as=P(),it=_("input"),rs=P(),pt=_("div"),Bt=_("div"),os=P(),_t=_("button"),_t.textContent=Ns,is=P(),Me&&Me.c(),this.h()},l(De){e=v(De,"DIV",{class:!0});var Fe=S(e);t=v(Fe,"FIELDSET",{class:!0});var ct=S(t);s=v(ct,"LEGEND",{class:!0});var Ds=S(s);n=v(Ds,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1jbbsti"&&(n.textContent=r),Ds.forEach(m),a=V(ct),o=v(ct,"DIV",{class:!0});var vt=S(o);u=v(vt,"DIV",{class:!0});var Tt=S(u);i=v(Tt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(i)!=="svelte-crpa7y"&&(i.textContent=d),f=V(Tt),p=v(Tt,"INPUT",{class:!0,id:!0}),b=V(Tt),E=v(Tt,"DIV",{class:!0});var Mt=S(E);N=v(Mt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(N)!=="svelte-mj6mct"&&(N.textContent=k),O=V(Mt),j=v(Mt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(j)!=="svelte-1sl6oxh"&&(j.textContent=y),Mt.forEach(m),Tt.forEach(m),L=V(vt),I=v(vt,"DIV",{class:!0});var Ut=S(I);D=v(Ut,"DIV",{class:!0});var Rt=S(D);G=v(Rt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(G)!=="svelte-wgxtkw"&&(G.textContent=C),B=V(Rt),T=v(Rt,"INPUT",{class:!0,id:!0,type:!0}),Rt.forEach(m),A=V(Ut),U=v(Ut,"DIV",{class:!0});var Kt=S(U);K=v(Kt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(K)!=="svelte-1tm2bth"&&(K.textContent=x),ce=V(Kt),ne=v(Kt,"INPUT",{class:!0,id:!0,placeholder:!0}),Kt.forEach(m),Ut.forEach(m),$=V(vt),we=v(vt,"DIV",{class:!0});var It=S(we);z=v(It,"DIV",{class:!0});var xt=S(z);se=v(xt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(se)!=="svelte-1js269u"&&(se.textContent=he),ie=V(xt),ue=v(xt,"INPUT",{class:!0,id:!0,type:!0}),xt.forEach(m),Pe=V(It),je=v(It,"DIV",{class:!0});var Ft=S(je);ae=v(Ft,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(ae)!=="svelte-21h39k"&&(ae.textContent=Se),ve=V(Ft),X=v(Ft,"INPUT",{class:!0,id:!0,type:!0}),Ft.forEach(m),R=V(It),Z=v(It,"DIV",{class:!0});var $t=S(Z);me=v($t,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(me)!=="svelte-33lczu"&&(me.textContent=te),Ne=V($t),Ge=v($t,"INPUT",{class:!0,id:!0,type:!0}),$t.forEach(m),It.forEach(m),Je=V(vt),Ke=v(vt,"DIV",{class:!0});var St=S(Ke);Ve=v(St,"DIV",{class:!0});var js=S(Ve);Le=v(js,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(Le)!=="svelte-1v9okg9"&&(Le.textContent=jt),js.forEach(m),At=V(St),xe=v(St,"DIV",{class:!0});var Ht=S(xe);mt=v(Ht,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(mt)!=="svelte-vd5i27"&&(mt.textContent=Ss),as=V(Ht),it=v(Ht,"INPUT",{class:!0,id:!0}),Ht.forEach(m),rs=V(St),pt=v(St,"DIV",{class:!0});var zt=S(pt);Bt=v(zt,"DIV",{}),S(Bt).forEach(m),os=V(zt),_t=v(zt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(_t)!=="svelte-jjt0c3"&&(_t.textContent=Ns),zt.forEach(m),St.forEach(m),vt.forEach(m),is=V(ct),Me&&Me.l(ct),ct.forEach(m),Fe.forEach(m),this.h()},h(){var De;h(n,"class","px-1 rounded hover:bg-gray-100"),h(s,"class","text-base"),h(i,"class","font-bold"),h(i,"for","device"),h(p,"class","px-1 my-1 rounded w-50"),h(p,"id","device"),p.disabled=!0,p.value=g=((De=l[5])==null?void 0:De.name)??"No device",h(N,"class","btn-sm primary mr-2"),h(j,"class","btn-sm primary"),h(E,"class","flex my-[auto]"),h(u,"class","h-full flex flex-col"),h(G,"class","font-bold"),h(G,"for","sound"),h(T,"class","h-[20px]"),h(T,"id","sound"),h(T,"type","checkbox"),T.checked=w=l[3].useSound,h(D,"class","my-1 flex justify-between mr-12"),h(K,"class","font-bold"),h(K,"for","fixed-velocity"),h(ne,"class","h-[20px] w-16"),h(ne,"id","fixed-velocity"),h(ne,"placeholder","0-127"),h(U,"class","flex justify-between"),h(I,"class","flex flex-col h-full"),h(se,"class","font-bold"),h(se,"for","keyboard"),h(ue,"class","h-[20px]"),h(ue,"id","keyboard"),h(ue,"type","checkbox"),ue.checked=Re=l[3].useKeyboard,h(z,"class","my-1 flex justify-between mr-12"),h(ae,"class","font-bold"),h(ae,"for","hotkeys"),h(X,"class","h-[20px]"),h(X,"id","hotkeys"),h(X,"type","checkbox"),X.checked=re=l[3].useHotkeys,h(je,"class","my-1 flex justify-between mr-12"),h(me,"class","font-bold"),h(me,"for","auto-octave"),h(Ge,"class","h-[20px]"),h(Ge,"id","auto-octave"),h(Ge,"type","checkbox"),Ge.checked=rt=l[3].useAutoOctave,h(Z,"class","my-1 flex justify-between mr-12"),h(we,"class","flex flex-col h-full"),h(Le,"class","w-full btn-sm primary"),h(Ve,"class","flex justify-between"),h(mt,"class","font-bold"),h(mt,"for","fade-timeout"),h(it,"class","h-[20px] w-16"),h(it,"id","fade-timeout"),it.value=l[1],h(xe,"class","flex justify-between"),h(_t,"class","btn-sm primary"),h(pt,"class","flex justify-between"),h(Ke,"class","flex flex-col justify-between h-full"),h(o,"class","body svelte-1bpw69s"),J(o,"hidden",l[4]),h(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-1bpw69s"),J(t,"collapsed",l[4]),h(e,"class",Gt=Ae(`${l[11].class||""}`)+" svelte-1bpw69s")},m(De,Fe){M(De,e,Fe),c(e,t),c(t,s),c(s,n),c(t,a),c(t,o),c(o,u),c(u,i),c(u,f),c(u,p),c(u,b),c(u,E),c(E,N),c(E,O),c(E,j),c(o,L),c(o,I),c(I,D),c(D,G),c(D,B),c(D,T),c(I,A),c(I,U),c(U,K),c(U,ce),c(U,ne),Qe(ne,l[0]),c(o,$),c(o,we),c(we,z),c(z,se),c(z,ie),c(z,ue),c(we,Pe),c(we,je),c(je,ae),c(je,ve),c(je,X),c(we,R),c(we,Z),c(Z,me),c(Z,Ne),c(Z,Ge),c(o,Je),c(o,Ke),c(Ke,Ve),c(Ve,Le),c(Ke,At),c(Ke,xe),c(xe,mt),c(xe,as),c(xe,it),c(Ke,rs),c(Ke,pt),c(pt,Bt),c(pt,os),c(pt,_t),c(t,is),Me&&Me.m(t,null),Ye=!0,cs||(Ls=[H(n,"click",l[7]),H(N,"click",He.openMidi),H(j,"click",He.disableMidi),H(T,"change",l[12]),H(ne,"input",l[13]),H(ne,"change",l[8]),H(ue,"change",l[14]),H(X,"change",l[15]),H(Ge,"change",l[16]),H(Le,"click",l[17]),H(it,"input",l[9]),H(_t,"click",l[10])],cs=!0)},p(De,[Fe]){var ct;(!Ye||Fe&32&&g!==(g=((ct=De[5])==null?void 0:ct.name)??"No device")&&p.value!==g)&&(p.value=g),(!Ye||Fe&8&&w!==(w=De[3].useSound))&&(T.checked=w),Fe&1&&ne.value!==De[0]&&Qe(ne,De[0]),(!Ye||Fe&8&&Re!==(Re=De[3].useKeyboard))&&(ue.checked=Re),(!Ye||Fe&8&&re!==(re=De[3].useHotkeys))&&(X.checked=re),(!Ye||Fe&8&&rt!==(rt=De[3].useAutoOctave))&&(Ge.checked=rt),(!Ye||Fe&2&&it.value!==De[1])&&(it.value=De[1]),(!Ye||Fe&16)&&J(o,"hidden",De[4]),De[2]?Me?Fe&4&&F(Me,1):(Me=Cl(),Me.c(),F(Me,1),Me.m(t,null)):Me&&(Ze(),q(Me,1,1,()=>{Me=null}),et()),(!Ye||Fe&16)&&J(t,"collapsed",De[4]),(!Ye||Fe&2048&&Gt!==(Gt=Ae(`${De[11].class||""}`)+" svelte-1bpw69s"))&&h(e,"class",Gt)},i(De){Ye||(F(Me),Ye=!0)},o(De){q(Me),Ye=!1},d(De){De&&m(e),Me&&Me.d(),cs=!1,ot(Ls)}}}function za(l,e,t){let s,n,r;de(l,at,y=>t(3,s=y)),de(l,ts,y=>t(5,r=y));const a=ht(Ue(!1),{key:"inputs-hidden"});de(l,a,y=>t(4,n=y));let o=s.fixedVelocity??"",u=s.keyFadeTimeout,i=!1;at.subscribe(y=>{t(0,o=y.fixedVelocity??""),t(1,u=y.keyFadeTimeout)});function d(){a.update(y=>!y)}function f(y){const{value:L}=y.currentTarget;let I;if(L)try{I=parseInt(L)}catch{}I!==void 0&&I>=0&&I<=127?He.setInputValue("fixedVelocity",I):L?t(0,o=s.fixedVelocity||""):He.setInputValue("fixedVelocity",void 0)}function p(y){try{const L=parseInt(y.currentTarget.value);He.setInputValue("keyFadeTimeout",L)}catch{t(1,u=s.keyFadeTimeout)}}function g(){$n()}const b=y=>He.setInputValue("useSound",y.currentTarget.checked);function E(){o=this.value,t(0,o)}const N=y=>He.setInputValue("useKeyboard",y.currentTarget.checked),k=y=>He.setInputValue("useHotkeys",y.currentTarget.checked),O=y=>He.setInputValue("useAutoOctave",y.currentTarget.checked),j=()=>t(2,i=!i);return l.$$set=y=>{t(11,e=Te(Te({},e),Ie(y)))},e=Ie(e),[o,u,i,s,n,r,a,d,f,p,g,e,b,E,N,k,O,j]}class qa extends ze{constructor(e){super(),qe(this,e,za,Ha,We,{})}}function Wa(l){let e;return{c(){e=Y(" ")},l(t){e=Q(t," ")},m(t,s){M(t,e,s)},p:pe,d(t){t&&m(e)}}}function Ja(l){let e,t=l[1].note+"",s;return{c(){e=Y("Input: "),s=Y(t)},l(n){e=Q(n,"Input: "),s=Q(n,t)},m(n,r){M(n,e,r),M(n,s,r)},p(n,r){r&2&&t!==(t=n[1].note+"")&&oe(s,t)},d(n){n&&(m(e),m(s))}}}function Ya(l){let e,t;return{c(){e=Y("Input: "),t=Y(l[0])},l(s){e=Q(s,"Input: "),t=Q(s,l[0])},m(s,n){M(s,e,n),M(s,t,n)},p(s,n){n&1&&oe(t,s[0])},d(s){s&&(m(e),m(t))}}}function Qa(l){let e;return{c(){e=Y(ys)},l(t){e=Q(t,ys)},m(t,s){M(t,e,s)},p:pe,d(t){t&&m(e)}}}function Xa(l){let e,t,s,n;function r(u,i){return u[2].useKeyboard&&ys?Qa:u[2].useKeyboard&&u[0]?Ya:u[2].useKeyboard&&u[1]?Ja:Wa}let a=r(l),o=a(l);return{c(){e=_("div"),o.c(),this.h()},l(u){e=v(u,"DIV",{class:!0});var i=S(e);o.l(i),i.forEach(m),this.h()},h(){h(e,"class",t=`${l[4].class||""}`)},m(u,i){M(u,e,i),o.m(e,null),s||(n=H(window,"keydown",l[3]),s=!0)},p(u,[i]){a===(a=r(u))&&o?o.p(u,i):(o.d(1),o=a(u),o&&(o.c(),o.m(e,null))),i&16&&t!==(t=`${u[4].class||""}`)&&h(e,"class",t)},i:pe,o:pe,d(u){u&&m(e),o.d(),s=!1,n()}}}let ys="";function Za(l,e,t){let s;de(l,at,i=>t(2,s=i));let{debounced:n}=e,r="",a;const o=yn();function u(i){const d=i.target;if(n||!(d instanceof HTMLElement)||d.tagName==="INPUT")return;const f=Vt.handleInput(i.code,i.key,i.shiftKey);f&&f.e==="note"?t(1,a=f.data):f&&f.e==="string"?t(0,r=f.data):f&&(t(0,r=""),t(1,a=void 0),o(f.e,f.data))}return l.$$set=i=>{t(4,e=Te(Te({},e),Ie(i))),"debounced"in i&&t(5,n=i.debounced)},e=Ie(e),[r,a,s,u,e,n]}class er extends ze{constructor(e){super(),qe(this,e,Za,Xa,We,{debounced:5})}}function tr(l){let e,t,s,n="Count",r,a,o,u,i,d="Duplicates",f,p,g,b,E,N,k="Autoplay",O,j,y,L,I,D,G="Wait seconds",C,B,T,w,A;return{c(){e=_("ul"),t=_("li"),s=_("label"),s.textContent=n,r=P(),a=_("input"),o=P(),u=_("li"),i=_("label"),i.textContent=d,f=P(),p=_("input"),b=P(),E=_("li"),N=_("label"),N.textContent=k,O=P(),j=_("input"),L=P(),I=_("li"),D=_("label"),D.textContent=G,C=P(),B=_("input"),this.h()},l(U){e=v(U,"UL",{class:!0});var K=S(e);t=v(K,"LI",{class:!0});var x=S(t);s=v(x,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(s)!=="svelte-wgq9fc"&&(s.textContent=n),r=V(x),a=v(x,"INPUT",{class:!0,id:!0,type:!0}),x.forEach(m),o=V(K),u=v(K,"LI",{class:!0});var ce=S(u);i=v(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(i)!=="svelte-hcg9dq"&&(i.textContent=d),f=V(ce),p=v(ce,"INPUT",{class:!0,id:!0,type:!0}),ce.forEach(m),b=V(K),E=v(K,"LI",{class:!0});var ne=S(E);N=v(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(N)!=="svelte-lr68n2"&&(N.textContent=k),O=V(ne),j=v(ne,"INPUT",{class:!0,id:!0,type:!0}),ne.forEach(m),L=V(K),I=v(K,"LI",{class:!0});var $=S(I);D=v($,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(D)!=="svelte-1qj2vcy"&&(D.textContent=G),C=V($),B=v($,"INPUT",{class:!0,id:!0,type:!0}),$.forEach(m),K.forEach(m),this.h()},h(){h(s,"class","font-bold"),h(s,"for","guess-count"),h(a,"class","h-[20px] w-10"),h(a,"id","guess-count"),h(a,"type","number"),h(t,"class","flex items-center justify-between svelte-1elvih2"),h(i,"class","font-bold"),h(i,"for","duplicates"),h(p,"class","h-[20px]"),h(p,"id","duplicates"),h(p,"type","checkbox"),p.checked=g=l[2].duplicates,h(u,"class","flex items-center justify-between mr-6 svelte-1elvih2"),h(N,"class","font-bold"),h(N,"for","autoplay"),h(j,"class","h-[20px]"),h(j,"id","autoplay"),h(j,"type","checkbox"),j.checked=y=l[2].autoplay,h(E,"class","flex items-center justify-between mr-6 svelte-1elvih2"),h(D,"class","font-bold"),h(D,"for","wait-ms"),h(B,"class","h-[20px] w-10"),h(B,"id","wait-ms"),h(B,"type","number"),h(I,"class","flex items-center justify-between svelte-1elvih2"),h(e,"class",T=Ae(`${l[5].class||""}`)+" svelte-1elvih2")},m(U,K){M(U,e,K),c(e,t),c(t,s),c(t,r),c(t,a),Qe(a,l[0]),c(e,o),c(e,u),c(u,i),c(u,f),c(u,p),c(e,b),c(e,E),c(E,N),c(E,O),c(E,j),c(e,L),c(e,I),c(I,D),c(I,C),c(I,B),Qe(B,l[1]),w||(A=[H(a,"input",l[6]),H(a,"input",l[3]),H(p,"input",l[7]),H(j,"input",l[8]),H(B,"input",l[9]),H(B,"input",l[4])],w=!0)},p(U,[K]){K&1&&Qt(a.value)!==U[0]&&Qe(a,U[0]),K&4&&g!==(g=U[2].duplicates)&&(p.checked=g),K&4&&y!==(y=U[2].autoplay)&&(j.checked=y),K&2&&Qt(B.value)!==U[1]&&Qe(B,U[1]),K&32&&T!==(T=Ae(`${U[5].class||""}`)+" svelte-1elvih2")&&h(e,"class",T)},i:pe,o:pe,d(U){U&&m(e),w=!1,ot(A)}}}function sr(l,e,t){let s;de(l,dt,p=>t(2,s=p));let n=s.count||"",r=s.waitSeconds||"";dt.subscribe(p=>{t(0,n=p.count||""),t(1,r=p.waitSeconds||"")});function a({currentTarget:{value:p}}){let g;try{g=parseInt(p),g<=0&&(g=1),Ce.setOptionValue("count",g)}catch{t(0,n=s.count)}}function o({currentTarget:{value:p}}){let g;try{g=parseInt(p),g<0&&(g=0),Ce.setOptionValue("waitSeconds",g)}catch{t(1,r=s.waitSeconds)}}function u(){n=Qt(this.value),t(0,n)}const i=p=>Ce.setOptionValue("duplicates",p.currentTarget.checked),d=p=>Ce.setOptionValue("autoplay",p.currentTarget.checked);function f(){r=Qt(this.value),t(1,r)}return l.$$set=p=>{t(5,e=Te(Te({},e),Ie(p)))},e=Ie(e),[n,r,s,a,o,e,u,i,d,f]}class lr extends ze{constructor(e){super(),qe(this,e,sr,tr,We,{})}}function Al(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function Tl(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function Il(l){let e,t,s=l[21]+"",n,r,a,o,u,i,d,f;function p(){return l[13](l[20])}o=new nt({props:{icon:ms,width:20}});function g(...b){return l[14](l[20],...b)}return{c(){e=_("li"),t=_("button"),n=Y(s),r=P(),a=_("button"),be(o.$$.fragment),u=P(),this.h()},l(b){e=v(b,"LI",{class:!0});var E=S(e);t=v(E,"BUTTON",{class:!0});var N=S(t);n=Q(N,s),N.forEach(m),r=V(E),a=v(E,"BUTTON",{class:!0});var k=S(a);ye(o.$$.fragment,k),k.forEach(m),u=V(E),E.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),J(t,"selected",l[20]===l[0]),h(a,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),h(e,"class","flex svelte-1okhpct")},m(b,E){M(b,e,E),c(e,t),c(t,n),c(e,r),c(e,a),ke(o,a,null),c(e,u),i=!0,d||(f=[H(t,"click",p),H(a,"click",g)],d=!0)},p(b,E){l=b,(!i||E&17)&&J(t,"selected",l[20]===l[0])},i(b){i||(F(o.$$.fragment,b),i=!0)},o(b){q(o.$$.fragment,b),i=!1},d(b){b&&m(e),Ee(o),d=!1,ot(f)}}}function Sl(l){let e,t=le(l[2]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Nl(Al(l,t,n));return{c(){e=_("ul");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=v(n,"UL",{class:!0});var r=S(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(m),this.h()},h(){h(e,"class","svelte-1okhpct")},m(n,r){M(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r&518){t=le(n[2]);let a;for(a=0;a<t.length;a+=1){const o=Al(n,t,a);s[a]?s[a].p(o,r):(s[a]=Nl(o),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function Nl(l){let e,t,s=l[21]+"",n,r,a,o;function u(){return l[15](l[20])}return{c(){e=_("li"),t=_("button"),n=Y(s),r=P(),this.h()},l(i){e=v(i,"LI",{class:!0});var d=S(e);t=v(d,"BUTTON",{class:!0});var f=S(t);n=Q(f,s),f.forEach(m),r=V(d),d.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),J(t,"selected",l[20]===l[1]),h(e,"class","svelte-1okhpct")},m(i,d){M(i,e,d),c(e,t),c(t,n),c(e,r),a||(o=H(t,"click",u),a=!0)},p(i,d){l=i,d&4&&s!==(s=l[21]+"")&&oe(n,s),d&6&&J(t,"selected",l[20]===l[1])},d(i){i&&m(e),a=!1,o()}}}function nr(l){let e,t,s="Play",n,r,a,o,u,i,d,f,p,g,b="Reset",E,N,k,O,j=l[3]?"Quit":"Play",y,L,I,D,G,C=le(l[4]),B=[];for(let A=0;A<C.length;A+=1)B[A]=Il(Tl(l,C,A));const T=A=>q(B[A],1,1,()=>{B[A]=null});let w=(l[0]==="chords-write"||l[0]==="chords-play")&&Sl(l);return d=new lr({props:{class:"game-options"}}),k=new nt({props:{class:"mr-1",icon:l[3]?Ms:ms,width:20}}),{c(){e=_("fieldset"),t=_("legend"),t.textContent=s,n=P(),r=_("div"),a=_("ul");for(let A=0;A<B.length;A+=1)B[A].c();o=P(),u=_("div"),w&&w.c(),i=P(),be(d.$$.fragment),f=P(),p=_("div"),g=_("button"),g.textContent=b,E=P(),N=_("button"),be(k.$$.fragment),O=P(),y=Y(j),this.h()},l(A){e=v(A,"FIELDSET",{class:!0});var U=S(e);t=v(U,"LEGEND",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-1409tnk"&&(t.textContent=s),n=V(U),r=v(U,"DIV",{class:!0});var K=S(r);a=v(K,"UL",{class:!0});var x=S(a);for(let we=0;we<B.length;we+=1)B[we].l(x);x.forEach(m),o=V(K),u=v(K,"DIV",{class:!0});var ce=S(u);w&&w.l(ce),ce.forEach(m),i=V(K),ye(d.$$.fragment,K),f=V(K),p=v(K,"DIV",{class:!0});var ne=S(p);g=v(ne,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(g)!=="svelte-10rv0bu"&&(g.textContent=b),E=V(ne),N=v(ne,"BUTTON",{class:!0});var $=S(N);ye(k.$$.fragment,$),O=V($),y=Q($,j),$.forEach(m),ne.forEach(m),K.forEach(m),U.forEach(m),this.h()},h(){h(t,"class","px-1 text-base"),h(a,"class","games svelte-1okhpct"),h(u,"class","options svelte-1okhpct"),h(g,"class","w-full btn hover:bg-gray-200"),h(N,"class","w-full mt-2 flex items-center justify-center btn primary"),h(p,"class","h-full flex flex-col justify-end"),h(r,"class","body pb-2 h-full svelte-1okhpct"),h(e,"class",L=Ae(`${l[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(A,U){M(A,e,U),c(e,t),c(e,n),c(e,r),c(r,a);for(let K=0;K<B.length;K+=1)B[K]&&B[K].m(a,null);c(r,o),c(r,u),w&&w.m(u,null),c(r,i),ke(d,r,null),c(r,f),c(r,p),c(p,g),c(p,E),c(p,N),ke(k,N,null),c(N,O),c(N,y),I=!0,D||(G=[H(g,"click",l[5]),H(N,"click",l[16])],D=!0)},p(A,[U]){if(U&401){C=le(A[4]);let x;for(x=0;x<C.length;x+=1){const ce=Tl(A,C,x);B[x]?(B[x].p(ce,U),F(B[x],1)):(B[x]=Il(ce),B[x].c(),F(B[x],1),B[x].m(a,null))}for(Ze(),x=C.length;x<B.length;x+=1)T(x);et()}A[0]==="chords-write"||A[0]==="chords-play"?w?w.p(A,U):(w=Sl(A),w.c(),w.m(u,null)):w&&(w.d(1),w=null);const K={};U&8&&(K.icon=A[3]?Ms:ms),k.$set(K),(!I||U&8)&&j!==(j=A[3]?"Quit":"Play")&&oe(y,j),(!I||U&1024&&L!==(L=Ae(`${A[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&h(e,"class",L)},i(A){if(!I){for(let U=0;U<C.length;U+=1)F(B[U]);F(d.$$.fragment,A),F(k.$$.fragment,A),I=!0}},o(A){B=B.filter(Boolean);for(let U=0;U<B.length;U+=1)q(B[U]);q(d.$$.fragment,A),q(k.$$.fragment,A),I=!1},d(A){A&&m(e),Oe(B,A),w&&w.d(),Ee(d),Ee(k),D=!1,ot(G)}}}function ar(l,e,t){let s,n,r,a,o;de(l,As,y=>t(12,r=y)),de(l,dt,y=>t(19,a=y)),de(l,yt,y=>t(3,o=y));const u=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let i=u[4].key,d="maj-m";a.count,a.waitSeconds,dt.subscribe(y=>{y.count,y.waitSeconds});function f(){Ce.clearGame(!0)}function p(y,L){if(L==="chords-write"||L==="chords-play"||L==="chords-diatonic"){let I=[];d==="selected"?I=r.filter(D=>D.selected):d==="all"?I=r:d==="maj-m"?I=r.filter(D=>D.suffixes[0]==="maj"||D.suffixes[0]==="m"):d==="seventh"&&(I=r.filter(D=>D.suffixes[0]==="maj7"||D.suffixes[0]==="m7"||D.suffixes[0]==="7"||D.suffixes[0]==="dim7"||D.suffixes[0]==="aug7")),Ce.play(L,{chords:I})}else Ce.play(L,void 0);y.currentTarget instanceof HTMLElement&&y.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function g(y){t(0,i=y)}function b(y,L){t(0,i=L),p(y,L)}function E(y){t(1,d=y)}const N=y=>g(y),k=(y,L)=>b(L,y),O=y=>E(y),j=y=>p(y,i);return l.$$set=y=>{t(10,e=Te(Te({},e),Ie(y)))},l.$$.update=()=>{l.$$.dirty&4096&&t(11,s=r.reduce((y,L)=>L.selected?y+1:y,0)),l.$$.dirty&2048&&t(2,n=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${s} chords`},{key:"all",value:"All"}])},e=Ie(e),[i,d,n,o,u,f,p,g,b,E,e,s,r,N,k,O,j]}class rr extends ze{constructor(e){super(),qe(this,e,ar,nr,We,{})}}function Ll(l,e,t){const s=l.slice();return s[7]=e[t],s}function Dl(l,e,t){const s=l.slice();return s[4]=e[t],s}function or(l){let e,t=le(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=jl(Ll(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Be()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Be()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);M(n,e,r)},p(n,r){if(r&2){t=le(n[1]);let a;for(a=0;a<t.length;a+=1){const o=Ll(n,t,a);s[a]?s[a].p(o,r):(s[a]=jl(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function ir(l){let e,t=le(l[0].scaleNotes||[]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Pl(Dl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Be()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Be()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);M(n,e,r)},p(n,r){if(r&1){t=le(n[0].scaleNotes||[]);let a;for(a=0;a<t.length;a+=1){const o=Dl(n,t,a);s[a]?s[a].p(o,r):(s[a]=Pl(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function jl(l){let e,t=l[7].interval+"",s;return{c(){e=_("span"),s=Y(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-my4m0t")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r&2&&t!==(t=n[7].interval+"")&&oe(s,t)},d(n){n&&m(e)}}}function Pl(l){let e,t=l[4].note+"",s;return{c(){e=_("span"),s=Y(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-my4m0t")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r&1&&t!==(t=n[4].note+"")&&oe(s,t)},d(n){n&&m(e)}}}function cr(l){let e,t,s,n,r,a;function o(d,f){return d[0]?ir:or}let u=o(l),i=u(l);return{c(){e=_("div"),t=_("button"),i.c(),this.h()},l(d){e=v(d,"DIV",{class:!0,title:!0});var f=S(e);t=v(f,"BUTTON",{class:!0});var p=S(t);i.l(p),p.forEach(m),f.forEach(m),this.h()},h(){h(t,"class","intervals svelte-my4m0t"),h(e,"class",s=`${l[2].class||""} `),h(e,"title",n=l[1].map(Vl).join("-"))},m(d,f){M(d,e,f),c(e,t),i.m(t,null),r||(a=H(t,"click",l[3]),r=!0)},p(d,[f]){u===(u=o(d))&&i?i.p(d,f):(i.d(1),i=u(d),i&&(i.c(),i.m(t,null))),f&4&&s!==(s=`${d[2].class||""} `)&&h(e,"class",s),f&2&&n!==(n=d[1].map(Vl).join("-"))&&h(e,"title",n)},i:pe,o:pe,d(d){d&&m(e),i.d(),r=!1,a()}}}const Vl=l=>l.interval;function ur(l,e,t){let{scale:s,intervals:n}=e;function r(a){ks.call(this,l,a)}return l.$$set=a=>{t(2,e=Te(Te({},e),Ie(a))),"scale"in a&&t(0,s=a.scale),"intervals"in a&&t(1,n=a.intervals)},e=Ie(e),[s,n,e,r]}class _n extends ze{constructor(e){super(),qe(this,e,ur,cr,We,{scale:0,intervals:1})}}function Ol(l,e,t){const s=l.slice();return s[7]=e[t],s}function Bl(l,e,t){const s=l.slice();return s[4]=e[t],s}function fr(l){let e,t=le(l[0]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Gl(Ol(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Be()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Be()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);M(n,e,r)},p(n,r){if(r&1){t=le(n[0]);let a;for(a=0;a<t.length;a+=1){const o=Ol(n,t,a);s[a]?s[a].p(o,r):(s[a]=Gl(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function dr(l){let e,t=le(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ml(Bl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Be()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Be()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);M(n,e,r)},p(n,r){if(r&2){t=le(n[1]);let a;for(a=0;a<t.length;a+=1){const o=Bl(n,t,a);s[a]?s[a].p(o,r):(s[a]=Ml(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function Gl(l){let e,t,s=l[7].roman+"",n,r,a,o=l[7].suffix+"",u,i;return{c(){e=_("span"),t=_("span"),n=Y(s),r=P(),a=_("sup"),u=Y(o),i=P(),this.h()},l(d){e=v(d,"SPAN",{class:!0});var f=S(e);t=v(f,"SPAN",{class:!0});var p=S(t);n=Q(p,s),p.forEach(m),r=V(f),a=v(f,"SUP",{class:!0});var g=S(a);u=Q(g,o),g.forEach(m),i=V(f),f.forEach(m),this.h()},h(){h(t,"class","block"),h(a,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),J(a,"super-text",l[7].suffix.length>2),h(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(d,f){M(d,e,f),c(e,t),c(t,n),c(e,r),c(e,a),c(a,u),c(e,i)},p(d,f){f&1&&s!==(s=d[7].roman+"")&&oe(n,s),f&1&&o!==(o=d[7].suffix+"")&&oe(u,o),f&1&&J(a,"super-text",d[7].suffix.length>2)},d(d){d&&m(e)}}}function Ml(l){let e,t,s=l[4]+"",n,r;return{c(){e=_("span"),t=_("span"),n=Y(s),r=P(),this.h()},l(a){e=v(a,"SPAN",{class:!0});var o=S(e);t=v(o,"SPAN",{});var u=S(t);n=Q(u,s),u.forEach(m),r=V(o),o.forEach(m),this.h()},h(){h(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(a,o){M(a,e,o),c(e,t),c(t,n),c(e,r)},p(a,o){o&2&&s!==(s=a[4]+"")&&oe(n,s)},d(a){a&&m(e)}}}function hr(l){let e,t,s,n,r,a;function o(d,f){return d[1].length>0?dr:fr}let u=o(l),i=u(l);return{c(){e=_("div"),t=_("button"),i.c(),this.h()},l(d){e=v(d,"DIV",{class:!0,title:!0});var f=S(e);t=v(f,"BUTTON",{class:!0});var p=S(t);i.l(p),p.forEach(m),f.forEach(m),this.h()},h(){h(t,"class","triads flex flex-wrap svelte-1roj1mi"),h(e,"class",s=Ae(`${l[2].class||""} `)+" svelte-1roj1mi"),h(e,"title",n=l[0].map(Ul).join("-"))},m(d,f){M(d,e,f),c(e,t),i.m(t,null),r||(a=H(t,"click",l[3]),r=!0)},p(d,[f]){u===(u=o(d))&&i?i.p(d,f):(i.d(1),i=u(d),i&&(i.c(),i.m(t,null))),f&4&&s!==(s=Ae(`${d[2].class||""} `)+" svelte-1roj1mi")&&h(e,"class",s),f&1&&n!==(n=d[0].map(Ul).join("-"))&&h(e,"title",n)},i:pe,o:pe,d(d){d&&m(e),i.d(),r=!1,a()}}}const Ul=l=>l.roman+l.suffix;function mr(l,e,t){let{triads:s,chords:n}=e;function r(a){ks.call(this,l,a)}return l.$$set=a=>{t(2,e=Te(Te({},e),Ie(a))),"triads"in a&&t(0,s=a.triads),"chords"in a&&t(1,n=a.chords)},e=Ie(e),[s,n,e,r]}class vn extends ze{constructor(e){super(),qe(this,e,mr,hr,We,{triads:0,chords:1})}}function Rl(l,e,t){const s=l.slice();return s[23]=e[t],s}function Kl(l,e,t){const s=l.slice();return s[23]=e[t],s}function xl(l){let e,t,s=l[23].raw.names[0]+"",n,r,a,o,u,i,d;function f(){return l[11](l[23])}a=new _n({props:{scale:l[23].scale,intervals:l[23].raw.intervals}}),a.$on("click",f);function p(){return l[12](l[23])}return u=new vn({props:{triads:l[23].triads,chords:l[23].triadChords}}),u.$on("click",p),{c(){e=_("li"),t=_("div"),n=Y(s),r=P(),be(a.$$.fragment),o=P(),be(u.$$.fragment),i=P(),this.h()},l(g){e=v(g,"LI",{class:!0});var b=S(e);t=v(b,"DIV",{class:!0});var E=S(t);n=Q(E,s),E.forEach(m),r=V(b),ye(a.$$.fragment,b),o=V(b),ye(u.$$.fragment,b),i=V(b),b.forEach(m),this.h()},h(){h(t,"class","text-xs font-bold"),h(e,"class","svelte-4hctsl")},m(g,b){M(g,e,b),c(e,t),c(t,n),c(e,r),ke(a,e,null),c(e,o),ke(u,e,null),c(e,i),d=!0},p(g,b){l=g,(!d||b&4)&&s!==(s=l[23].raw.names[0]+"")&&oe(n,s);const E={};b&4&&(E.scale=l[23].scale),b&4&&(E.intervals=l[23].raw.intervals),a.$set(E);const N={};b&4&&(N.triads=l[23].triads),b&4&&(N.chords=l[23].triadChords),u.$set(N)},i(g){d||(F(a.$$.fragment,g),F(u.$$.fragment,g),d=!0)},o(g){q(a.$$.fragment,g),q(u.$$.fragment,g),d=!1},d(g){g&&m(e),Ee(a),Ee(u)}}}function Fl(l){let e,t,s=l[23].raw.names[0]+"",n,r,a,o,u,i,d;function f(){return l[13](l[23])}a=new _n({props:{scale:l[23].scale,intervals:l[23].raw.intervals}}),a.$on("click",f);function p(){return l[14](l[23])}return u=new vn({props:{triads:l[23].triads,chords:l[23].triadChords}}),u.$on("click",p),{c(){e=_("li"),t=_("div"),n=Y(s),r=P(),be(a.$$.fragment),o=P(),be(u.$$.fragment),i=P(),this.h()},l(g){e=v(g,"LI",{class:!0});var b=S(e);t=v(b,"DIV",{class:!0});var E=S(t);n=Q(E,s),E.forEach(m),r=V(b),ye(a.$$.fragment,b),o=V(b),ye(u.$$.fragment,b),i=V(b),b.forEach(m),this.h()},h(){h(t,"class","text-xs font-bold"),h(e,"class","svelte-4hctsl")},m(g,b){M(g,e,b),c(e,t),c(t,n),c(e,r),ke(a,e,null),c(e,o),ke(u,e,null),c(e,i),d=!0},p(g,b){l=g,(!d||b&2)&&s!==(s=l[23].raw.names[0]+"")&&oe(n,s);const E={};b&2&&(E.scale=l[23].scale),b&2&&(E.intervals=l[23].raw.intervals),a.$set(E);const N={};b&2&&(N.triads=l[23].triads),b&2&&(N.chords=l[23].triadChords),u.$set(N)},i(g){d||(F(a.$$.fragment,g),F(u.$$.fragment,g),d=!0)},o(g){q(a.$$.fragment,g),q(u.$$.fragment,g),d=!1},d(g){g&&m(e),Ee(a),Ee(u)}}}function pr(l){let e,t,s,n,r="Scales",a,o,u,i,d="Key",f,p,g,b,E,N,k,O,j,y,L=le(l[2]),I=[];for(let T=0;T<L.length;T+=1)I[T]=xl(Kl(l,L,T));const D=T=>q(I[T],1,1,()=>{I[T]=null});let G=le(l[1]),C=[];for(let T=0;T<G.length;T+=1)C[T]=Fl(Rl(l,G,T));const B=T=>q(C[T],1,1,()=>{C[T]=null});return{c(){e=_("div"),t=_("fieldset"),s=_("legend"),n=_("button"),n.textContent=r,a=P(),o=_("div"),u=_("div"),i=_("label"),i.textContent=d,f=P(),p=_("input"),g=P(),b=_("ul");for(let T=0;T<I.length;T+=1)I[T].c();E=P(),N=_("ul");for(let T=0;T<C.length;T+=1)C[T].c();this.h()},l(T){e=v(T,"DIV",{class:!0});var w=S(e);t=v(w,"FIELDSET",{class:!0});var A=S(t);s=v(A,"LEGEND",{class:!0});var U=S(s);n=v(U,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-lhx60e"&&(n.textContent=r),U.forEach(m),a=V(A),o=v(A,"DIV",{class:!0});var K=S(o);u=v(K,"DIV",{class:!0});var x=S(u);i=v(x,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(i)!=="svelte-14m38zf"&&(i.textContent=d),f=V(x),p=v(x,"INPUT",{class:!0,id:!0}),x.forEach(m),g=V(K),b=v(K,"UL",{class:!0});var ce=S(b);for(let $=0;$<I.length;$+=1)I[$].l(ce);ce.forEach(m),E=V(K),N=v(K,"UL",{class:!0});var ne=S(N);for(let $=0;$<C.length;$+=1)C[$].l(ne);ne.forEach(m),K.forEach(m),A.forEach(m),w.forEach(m),this.h()},h(){h(n,"class","px-1 rounded hover:bg-gray-100"),h(s,"class","text-base"),h(i,"class","mr-4 font-bold"),h(i,"for","scale-key"),h(p,"class","bg-gray-100 w-16 px-1 rounded"),h(p,"id","scale-key"),p.value=l[0],h(u,"class","flex w-1/2 mb-2 input svelte-4hctsl"),h(b,"class","list odd w-full svelte-4hctsl"),h(N,"class","list even w-full svelte-4hctsl"),h(o,"class","body svelte-4hctsl"),J(o,"hidden",l[3]),h(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-4hctsl"),J(t,"collapsed",l[3]),h(e,"class",k=Ae(`${l[9].class||""}`)+" svelte-4hctsl")},m(T,w){M(T,e,w),c(e,t),c(t,s),c(s,n),c(t,a),c(t,o),c(o,u),c(u,i),c(u,f),c(u,p),c(o,g),c(o,b);for(let A=0;A<I.length;A+=1)I[A]&&I[A].m(b,null);c(o,E),c(o,N);for(let A=0;A<C.length;A+=1)C[A]&&C[A].m(N,null);O=!0,j||(y=[H(n,"click",l[5]),H(p,"input",l[6])],j=!0)},p(T,[w]){if((!O||w&1&&p.value!==T[0])&&(p.value=T[0]),w&388){L=le(T[2]);let A;for(A=0;A<L.length;A+=1){const U=Kl(T,L,A);I[A]?(I[A].p(U,w),F(I[A],1)):(I[A]=xl(U),I[A].c(),F(I[A],1),I[A].m(b,null))}for(Ze(),A=L.length;A<I.length;A+=1)D(A);et()}if(w&386){G=le(T[1]);let A;for(A=0;A<G.length;A+=1){const U=Rl(T,G,A);C[A]?(C[A].p(U,w),F(C[A],1)):(C[A]=Fl(U),C[A].c(),F(C[A],1),C[A].m(N,null))}for(Ze(),A=G.length;A<C.length;A+=1)B(A);et()}(!O||w&8)&&J(o,"hidden",T[3]),(!O||w&8)&&J(t,"collapsed",T[3]),(!O||w&512&&k!==(k=Ae(`${T[9].class||""}`)+" svelte-4hctsl"))&&h(e,"class",k)},i(T){if(!O){for(let w=0;w<L.length;w+=1)F(I[w]);for(let w=0;w<G.length;w+=1)F(C[w]);O=!0}},o(T){I=I.filter(Boolean);for(let w=0;w<I.length;w+=1)q(I[w]);C=C.filter(Boolean);for(let w=0;w<C.length;w+=1)q(C[w]);O=!1},d(T){T&&m(e),Oe(I,T),Oe(C,T),j=!1,ot(y)}}}function _r(l,e,t){let s,n,r,a,o,u,i;de(l,ss,C=>t(17,r=C)),de(l,Dt,C=>t(18,a=C)),de(l,at,C=>t(19,o=C)),de(l,lt,C=>t(20,u=C));let f=Es().map(C=>({key:C.names[0],raw:C,scale:void 0,triads:C.triads,triadChords:[]})),p="",g=[a.key,a.scale],b;const E=ht(Ue(!0),{key:"scales-hidden"});de(l,E,C=>t(3,i=C));function N(){E.update(C=>!C)}function k({currentTarget:{value:C}}){t(0,p=`${C.charAt(0).toUpperCase()}${C.charAt(1).toLowerCase()}`),t(10,f=f.map(B=>{const T=es(p,B.key),w=p&&"data"in T?T.data:void 0;let A=[];return w&&(A=B.triads.map((U,K)=>`${w.scaleNotes[K].note}${!U.suffix.includes("°")&&U.minor?"m":""}${U.suffix}`)),{...B,scale:w,triadChords:A}}))}function O(C,B,T){if(C<B.length){const w=B[C++];ge.setPlayed(w),u==null||u.playChord(w.map(A=>A.midi),o.fixedVelocity),b=setTimeout(()=>O(C,B,T),T)}else ge.setPlayed([]),ge.setKeyAndScale(g[0],g[1])}function j(C){clearTimeout(b);let B,T;C.scale?(T=C.scale,g=[a.key,a.scale],ge.setKeyAndScale(C.scale.key,C.scale.scale)):T=a;const w=r[0].midi+T.scaleNotes[0].semitones;B=C.raw.intervals.map(A=>[{...T.notesMap.get(A.semitones%12),midi:w+A.semitones}]),B[0][0].semitones!==B[B.length-1][0].semitones&&B.push(B[0].map(A=>({...A,midi:A.midi+12}))),O(0,B,500)}function y(C){clearTimeout(b);const{intervals:B}=C.raw;let T,w;C.scale?(w=C.scale,g=[a.key,a.scale],ge.setKeyAndScale(C.scale.key,C.scale.scale)):w=a;const A=r[0].midi+w.scaleNotes[0].semitones;T=rn(C.triads).map((K,x)=>ps(A+w.intervals[x].semitones,w,K.intervals)),B[B.length-1].interval_seq!==1&&T.push(T[0].map(K=>({...K,midi:K.midi+12}))),O(0,T,750)}const L=C=>j(C),I=C=>y(C),D=C=>j(C),G=C=>y(C);return l.$$set=C=>{t(9,e=Te(Te({},e),Ie(C)))},l.$$.update=()=>{l.$$.dirty&1024&&t(2,s=f.filter((C,B)=>B<f.length/2)),l.$$.dirty&1024&&t(1,n=f.filter((C,B)=>B>=f.length/2))},e=Ie(e),[p,n,s,i,E,N,k,j,y,e,f,L,I,D,G]}class vr extends ze{constructor(e){super(),qe(this,e,_r,pr,We,{})}}function $l(l,e,t){const s=l.slice();return s[26]=e[t],s}function Hl(l,e,t){const s=l.slice();return s[29]=e[t],s}function zl(l){let e,t;return{c(){e=_("div"),t=Y(l[3]),this.h()},l(s){e=v(s,"DIV",{class:!0});var n=S(e);t=Q(n,l[3]),n.forEach(m),this.h()},h(){h(e,"class","error svelte-1u7ze7x")},m(s,n){M(s,e,n),c(e,t)},p(s,n){n[0]&8&&oe(t,s[3])},d(s){s&&m(e)}}}function gr(l){let e,t;return{c(){e=_("div"),t=Y(l[0]),this.h()},l(s){e=v(s,"DIV",{slot:!0});var n=S(e);t=Q(n,l[0]),n.forEach(m),this.h()},h(){h(e,"slot","value")},m(s,n){M(s,e,n),c(e,t)},p(s,n){n[0]&1&&oe(t,s[0])},d(s){s&&m(e)}}}function ql(l){let e,t=le(l[5]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Wl(Hl(l,t,n));return{c(){e=_("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var r=S(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(m),this.h()},h(){h(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){M(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r[0]&32){t=le(n[5]);let a;for(a=0;a<t.length;a+=1){const o=Hl(n,t,a);s[a]?s[a].p(o,r):(s[a]=Wl(o),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function Wl(l){let e,t=l[29].interval+"",s;return{c(){e=_("span"),s=Y(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1u7ze7x")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r[0]&32&&t!==(t=n[29].interval+"")&&oe(s,t)},d(n){n&&m(e)}}}function Jl(l){let e,t=le(l[8].scaleNotes),s=[];for(let n=0;n<t.length;n+=1)s[n]=Yl($l(l,t,n));return{c(){e=_("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var r=S(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(m),this.h()},h(){h(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){M(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r[0]&256){t=le(n[8].scaleNotes);let a;for(a=0;a<t.length;a+=1){const o=$l(n,t,a);s[a]?s[a].p(o,r):(s[a]=Yl(o),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Oe(s,n)}}}function Yl(l){let e,t=l[26].note+"",s;return{c(){e=_("span"),s=Y(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Q(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1u7ze7x")},m(n,r){M(n,e,r),c(e,s)},p(n,r){r[0]&256&&t!==(t=n[26].note+"")&&oe(s,t)},d(n){n&&m(e)}}}function br(l){let e,t,s,n="Score",r,a,o,u,i,d,f,p="Range",g,b,E,N,k,O="—",j,y,L,I,D,G,C,B="Scale",T,w,A,U,K,x,ce,ne="Key",$,we,z,se,he,ie,ue="",Re,Pe,je,ae;o=new nt({props:{icon:sn,width:16}});let Se=l[3]&&zl(l);A=new fn({props:{id:"scales",class:"p-1",options:l[10],onSelect:l[14],$$slots:{value:[gr]},$$scope:{ctx:l}}});let ve=!l[7]&&ql(l),X=!l[7]&&Jl(l);return{c(){e=_("fieldset"),t=_("legend"),s=_("button"),s.textContent=n,r=P(),a=_("button"),be(o.$$.fragment),u=P(),i=_("div"),d=_("div"),f=_("label"),f.textContent=p,g=P(),b=_("div"),E=_("input"),N=P(),k=_("span"),k.textContent=O,j=P(),y=_("input"),L=P(),I=_("div"),Se&&Se.c(),D=P(),G=_("div"),C=_("label"),C.textContent=B,T=P(),w=_("div"),be(A.$$.fragment),U=P(),ve&&ve.c(),K=P(),x=_("div"),ce=_("label"),ce.textContent=ne,$=P(),we=_("div"),z=_("input"),se=P(),X&&X.c(),he=P(),ie=_("div"),ie.innerHTML=ue,this.h()},l(re){e=v(re,"FIELDSET",{class:!0});var R=S(e);t=v(R,"LEGEND",{class:!0});var Z=S(t);s=v(Z,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(s)!=="svelte-lqyol"&&(s.textContent=n),Z.forEach(m),r=V(R),a=v(R,"BUTTON",{class:!0});var me=S(a);ye(o.$$.fragment,me),me.forEach(m),u=V(R),i=v(R,"DIV",{class:!0});var te=S(i);d=v(te,"DIV",{class:!0});var Ne=S(d);f=v(Ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(f)!=="svelte-10u0679"&&(f.textContent=p),g=V(Ne),b=v(Ne,"DIV",{class:!0});var Ge=S(b);E=v(Ge,"INPUT",{class:!0,id:!0}),N=V(Ge),k=v(Ge,"SPAN",{class:!0,"data-svelte-h":!0}),ee(k)!=="svelte-8q1xz4"&&(k.textContent=O),j=V(Ge),y=v(Ge,"INPUT",{class:!0,id:!0}),Ge.forEach(m),L=V(Ne),I=v(Ne,"DIV",{class:!0});var rt=S(I);Se&&Se.l(rt),rt.forEach(m),Ne.forEach(m),D=V(te),G=v(te,"DIV",{class:!0});var Je=S(G);C=v(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(C)!=="svelte-ld2d07"&&(C.textContent=B),T=V(Je),w=v(Je,"DIV",{class:!0});var Ke=S(w);ye(A.$$.fragment,Ke),Ke.forEach(m),U=V(Je),ve&&ve.l(Je),Je.forEach(m),K=V(te),x=v(te,"DIV",{class:!0});var Ve=S(x);ce=v(Ve,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(ce)!=="svelte-17pcm6g"&&(ce.textContent=ne),$=V(Ve),we=v(Ve,"DIV",{class:!0});var Le=S(we);z=v(Le,"INPUT",{class:!0,id:!0}),Le.forEach(m),se=V(Ve),X&&X.l(Ve),Ve.forEach(m),he=V(te),ie=v(te,"DIV",{class:!0,"data-svelte-h":!0}),ee(ie)!=="svelte-hp3bkp"&&(ie.innerHTML=ue),te.forEach(m),R.forEach(m),this.h()},h(){h(s,"class","px-1 rounded hover:bg-gray-100"),h(t,"class","px-1 text-base"),h(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),J(a,"hidden",l[6]),h(f,"class","font-bold"),h(f,"for","range_min"),h(E,"class","h-[28px] w-full"),h(E,"id","range_min"),h(k,"class","mx-2 mt-1"),h(y,"class","h-[28px] w-full"),h(y,"id","range_max"),h(b,"class","my-1 flex w-full"),h(I,"class","flex justify-between my-1"),h(d,"class","flex flex-col h-full"),h(C,"class","font-bold"),h(C,"for","scales"),h(w,"class","my-1 w-full"),h(G,"class","flex flex-col h-full"),h(ce,"class","font-bold"),h(ce,"for","key"),h(z,"class","h-[28px]"),h(z,"id","key"),h(we,"class","my-1 flex"),h(x,"class","flex flex-col h-full"),h(ie,"class","h-full flex flex-col justify-between"),h(i,"class","options svelte-1u7ze7x"),J(i,"hidden",l[6]),h(e,"class",Re=Ae(`${l[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),J(e,"collapsed",l[6])},m(re,R){M(re,e,R),c(e,t),c(t,s),c(e,r),c(e,a),ke(o,a,null),c(e,u),c(e,i),c(i,d),c(d,f),c(d,g),c(d,b),c(b,E),Qe(E,l[1]),c(b,N),c(b,k),c(b,j),c(b,y),Qe(y,l[2]),c(d,L),c(d,I),Se&&Se.m(I,null),c(i,D),c(i,G),c(G,C),c(G,T),c(G,w),ke(A,w,null),c(G,U),ve&&ve.m(G,null),c(i,K),c(i,x),c(x,ce),c(x,$),c(x,we),c(we,z),Qe(z,l[4]),c(x,se),X&&X.m(x,null),c(i,he),c(i,ie),Pe=!0,je||(ae=[H(s,"click",l[15]),H(a,"click",l[16]),H(E,"input",l[18]),H(E,"change",l[19]),H(E,"focus",l[12]),H(y,"input",l[20]),H(y,"change",l[21]),H(y,"focus",l[12]),H(z,"input",l[22]),H(z,"input",l[13])],je=!0)},p(re,R){(!Pe||R[0]&64)&&J(a,"hidden",re[6]),R[0]&2&&E.value!==re[1]&&Qe(E,re[1]),R[0]&4&&y.value!==re[2]&&Qe(y,re[2]),re[3]?Se?Se.p(re,R):(Se=zl(re),Se.c(),Se.m(I,null)):Se&&(Se.d(1),Se=null);const Z={};R[0]&1|R[1]&2&&(Z.$$scope={dirty:R,ctx:re}),A.$set(Z),re[7]?ve&&(ve.d(1),ve=null):ve?ve.p(re,R):(ve=ql(re),ve.c(),ve.m(G,null)),R[0]&16&&z.value!==re[4]&&Qe(z,re[4]),re[7]?X&&(X.d(1),X=null):X?X.p(re,R):(X=Jl(re),X.c(),X.m(x,null)),(!Pe||R[0]&64)&&J(i,"hidden",re[6]),(!Pe||R[0]&131072&&Re!==(Re=Ae(`${re[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&h(e,"class",Re),(!Pe||R[0]&131136)&&J(e,"collapsed",re[6])},i(re){Pe||(F(o.$$.fragment,re),F(A.$$.fragment,re),Pe=!0)},o(re){q(o.$$.fragment,re),q(A.$$.fragment,re),Pe=!1},d(re){re&&m(e),Ee(o),Se&&Se.d(),Ee(A),ve&&ve.d(),X&&X.d(),je=!1,ot(ae)}}}function yr(l,e,t){let s,n,r,a,o,u;de(l,ss,w=>t(23,n=w)),de(l,wt,w=>t(24,r=w)),de(l,yt,w=>t(7,o=w)),de(l,Dt,w=>t(8,u=w));let i=Xe(n[0]),d=Xe(n[1]),f="";const p=ht(Ue(!1),{key:"score-options-hidden"});de(l,p,w=>t(6,a=w));let g=r[0],b=r[1];const E=Es(),N=E.map(w=>({key:w.names[0],value:w.names[0]}));ss.subscribe(w=>{t(1,i=Xe(w[0])),t(2,d=Xe(w[1]))}),wt.subscribe(w=>{t(4,g=w[0]),t(0,b=w[1])});function k(w,A){const U=Mn(A.currentTarget.value,!0,!0);if("data"in U){const{midi:K}=U.data,x=n,ce=[w==="min"?K:x[0].midi,w==="max"?K:x[1].midi];He.setMidiRange(ce),t(3,f="")}else t(3,f=U.err),w==="min"?t(1,i=Xe(n[0])):t(2,d=Xe(n[1]))}function O(){t(3,f="")}function j({currentTarget:{value:w}}){t(4,g=`${w.charAt(0).toUpperCase()}${w.charAt(1).toLowerCase()}`),ge.setKey(g)}function y(w){var A;return t(0,b=(A=N.find(U=>w===U.key))==null?void 0:A.value),ge.setScale(b),!1}function L(){p.update(w=>!w)}function I(){ge.clearScore(!0),He.setMidiRange([60,84])}function D(){i=this.value,t(1,i)}const G=w=>k("min",w);function C(){d=this.value,t(2,d)}const B=w=>k("max",w);function T(){g=this.value,t(4,g)}return l.$$set=w=>{t(17,e=Te(Te({},e),Ie(w)))},l.$$.update=()=>{var w;l.$$.dirty[0]&1&&t(5,s=((w=E.find(A=>A.names[0]===b))==null?void 0:w.intervals)||[])},e=Ie(e),[b,i,d,f,g,s,a,o,u,p,N,k,O,j,y,L,I,e,D,G,C,B,T]}class kr extends ze{constructor(e){super(),qe(this,e,yr,br,We,{},null,[-1,-1])}}function Er(l){l[19]=l[20].default}function wr(l){return{c:pe,l:pe,m:pe,i:pe,o:pe,d:pe}}function Cr(l){Er(l);let e,t,s;var n=l[19];function r(a,o){return{props:{class:"px-4 md:px-0"}}}return n&&(e=wn(n,r())),{c(){e&&be(e.$$.fragment),t=Be()},l(a){e&&ye(e.$$.fragment,a),t=Be()},m(a,o){e&&ke(e,a,o),M(a,t,o),s=!0},i(a){s||(e&&F(e.$$.fragment,a),s=!0)},o(a){e&&q(e.$$.fragment,a),s=!1},d(a){a&&m(t),e&&Ee(e,a)}}}function Ar(l){let e;return{c(){e=Y(" ")},l(t){e=Q(t," ")},m(t,s){M(t,e,s)},i:pe,o:pe,d(t){t&&m(e)}}}function Tr(l){let e,t,s,n='<a class="hover:underline" href="https://github.com/TeemuKoivisto/midi-note-trainer">MIDI Note Trainer</a>',r,a,o,u,i,d,f,p,g,b,E,N,k,O,j,y,L,I,D;o=new qa({}),i=new vr({}),f=new ia({}),b=new kr({props:{class:"score-options mr-4"}}),N=new rr({props:{class:"play-form"}});let G={ctx:l,current:null,token:null,hasCatch:!1,pending:Ar,then:Cr,catch:wr,value:20,blocks:[,,,]};return kn(fe(()=>import("./Score.dc87820f.js"),["./Score.dc87820f.js","./vendor_svelte.207ec176.js","./vendor.13a9dfeb.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),G),y=new er({props:{class:"min-h-32",debounced:!!l[0]}}),y.$on("guessed-chord",l[2]),y.$on("guessed-key",l[3]),y.$on("guessed-note",l[4]),I=new ka({props:{game:l[1]}}),{c(){e=_("meta"),t=P(),s=_("h1"),s.innerHTML=n,r=P(),a=_("section"),be(o.$$.fragment),u=P(),be(i.$$.fragment),d=P(),be(f.$$.fragment),p=P(),g=_("div"),be(b.$$.fragment),E=P(),be(N.$$.fragment),k=P(),G.block.c(),O=P(),j=_("section"),be(y.$$.fragment),L=P(),be(I.$$.fragment),this.h()},l(C){const B=En("svelte-1w2oado",document.head);e=v(B,"META",{name:!0,content:!0}),B.forEach(m),t=V(C),s=v(C,"H1",{class:!0,"data-svelte-h":!0}),ee(s)!=="svelte-1l8ebwf"&&(s.innerHTML=n),r=V(C),a=v(C,"SECTION",{class:!0});var T=S(a);ye(o.$$.fragment,T),u=V(T),ye(i.$$.fragment,T),d=V(T),ye(f.$$.fragment,T),p=V(T),g=v(T,"DIV",{class:!0});var w=S(g);ye(b.$$.fragment,w),E=V(w),ye(N.$$.fragment,w),w.forEach(m),T.forEach(m),k=V(C),G.block.l(C),O=V(C),j=v(C,"SECTION",{class:!0});var A=S(j);ye(y.$$.fragment,A),L=V(A),ye(I.$$.fragment,A),A.forEach(m),this.h()},h(){h(e,"name","description"),h(e,"content","App to practise music notation, scales and chords using MIDI"),h(s,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight"),h(g,"class","play svelte-qjpqy3"),h(a,"class","px-4 md:px-0"),h(j,"class","mb-8 px-4 md:px-0 flex flex-col")},m(C,B){c(document.head,e),M(C,t,B),M(C,s,B),M(C,r,B),M(C,a,B),ke(o,a,null),c(a,u),ke(i,a,null),c(a,d),ke(f,a,null),c(a,p),c(a,g),ke(b,g,null),c(g,E),ke(N,g,null),M(C,k,B),G.block.m(C,G.anchor=B),G.mount=()=>O.parentNode,G.anchor=O,M(C,O,B),M(C,j,B),ke(y,j,null),c(j,L),ke(I,j,null),D=!0},p(C,[B]){l=C;const T={};B&1&&(T.debounced=!!l[0]),y.$set(T);const w={};B&2&&(w.game=l[1]),I.$set(w)},i(C){D||(F(o.$$.fragment,C),F(i.$$.fragment,C),F(f.$$.fragment,C),F(b.$$.fragment,C),F(N.$$.fragment,C),F(G.block),F(y.$$.fragment,C),F(I.$$.fragment,C),D=!0)},o(C){q(o.$$.fragment,C),q(i.$$.fragment,C),q(f.$$.fragment,C),q(b.$$.fragment,C),q(N.$$.fragment,C);for(let B=0;B<3;B+=1){const T=G.blocks[B];q(T)}q(y.$$.fragment,C),q(I.$$.fragment,C),D=!1},d(C){C&&(m(t),m(s),m(r),m(a),m(k),m(O),m(j)),m(e),Ee(o),Ee(i),Ee(f),Ee(b),Ee(N),G.block.d(C),G.token=null,G=null,Ee(y),Ee(I)}}}function Ir(l,e,t){let s,n,r,a,o,u;de(l,bt,L=>t(7,s=L)),de(l,yt,L=>t(1,n=L)),de(l,dt,L=>t(8,r=L)),de(l,at,L=>t(9,a=L)),de(l,lt,L=>t(10,o=L)),de(l,vs,L=>t(11,u=L));let i,d;tn(()=>(u&&y(),window.addEventListener("keydown",f),window.addEventListener("mousedown",f),window.addEventListener("touchstart",f),()=>{window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)})),ts.subscribe(L=>{L&&L.channels[1].addListener("noteon",p)});function f(){He.initAudio(),window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)}function p(L){if(i)return;const I=L.rawData;g(I[1],I[2])}function g(L,I){const D=n;D instanceof Lt&&!(D!=null&&D.ended)&&s==="waiting"?N(L):D instanceof ft&&!(D!=null&&D.ended)&&s==="waiting"?(D.addPlayedNote(L),d||(d=setTimeout(E,2e3))):D||ge.pushPlayed(L),o&&o.noteOn(L,a.fixedVelocity??I)}function b(){r.autoplay&&r.waitSeconds>0?t(0,i=setTimeout(()=>{r.autoplay&&Ce.nextGuess(),t(0,i=void 0)},r.waitSeconds*1e3)):r.autoplay?Ce.nextGuess():t(0,i=void 0)}function E(){var I;const L=n;if(L instanceof ft){const D=L.guess();ge.setPlayed(((I=L.latestGuess.guessed)==null?void 0:I.notes)||[],D,-1),Ce.updateState(D?"correct":"wrong"),b()}d=void 0}function N(L){const I=n;if(I instanceof Lt&&s==="waiting"){ge.setTarget([ge.getNote(I.current)]);const D=I.guess(L);Ce.updateState(D?"correct":"wrong"),ge.pushPlayed(L,D,4e3),b()}}function k(L){const I=n;if(I instanceof ft&&s==="waiting"){const D=I.guessWrittenChord(L.detail);Ce.updateState(D?"correct":"wrong"),b()}}function O(L){const I=n;if(I instanceof Ot&&s==="waiting"){const D=L.detail.replaceAll("♭","b").replaceAll("♯","#"),G=I.guess(D);Ce.updateState(G?"correct":"wrong"),b()}}function j(L){g(L.detail,80)}async function y(){const L=await He.openMidi();"data"in L?L.data.name:(L.err,console.error(L.err))}return[i,n,k,O,j]}class Dr extends ze{constructor(e){super(),qe(this,e,Ir,Tr,We,{})}}export{Rs as F,ft as G,Dr as P,Nn as S,Lt as a,Ce as b,yt as c,gt as d,on as e,bt as g,lt as p,Dt as s,Fs as t};
