import{_ as tn}from"./preload-helper.a4192956.js";import{R as Be,Q as cs,T as Oe,U as sn,S as ze,i as He,s as Re,O as nt,V as oe,e as v,m as L,H as be,a as g,b as T,n as ne,d as m,o as G,I as ye,f as d,L as Z,W as De,g as z,h as i,J as ke,p as q,t as W,C as Je,w as Qe,l as Q,K as Ce,X as je,Y as at,M as me,N as Se,P as Ae,z as ee,A as te,B as ue,v as Ve,q as _e,Z as us,_ as Ye,$ as ln,a0 as $t,c as Fl,u as Ul,j as xl,k as Kl,a1 as ys,a2 as Ut,F as nn,a3 as ks,a4 as Cs,a5 as an,a6 as on,r as rn,G as cn}from"./vendor_svelte.c4eaef20.js";import{w as xt,b as un,c as fn,e as Es,f as ws,g as $l,h as zt,i as Ht,a as Ss,j as ns}from"./vendor.1acf520b.js";const As={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function $e(l,e=0,t=0){return{interval:`${l}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:l,semitones:zl(l,e,t),flats:e,sharps:t}}function zl(l,e,t){return(l<8?As[l]:As[l%7])-e+t+Math.floor(l/8)*12}function Hl(l){let e,t=0,s=0;l<0?(t=1+Math.floor(-l/100),e=-l%100):l>100?(s=Math.floor(l/100),e=l%100):e=l;const n=zl(e,t,s);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(s)}`,interval_seq:e,semitones:n,flats:t,sharps:s}}const dn=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let ts=[];function Rl(){return dn.map(l=>{const e=l[3].map(Hl);return{suffixes:l[0],name:l[1][0],type:l[2],intervals:e}})}function Tt(l){ts.length===0&&(ts=Rl());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return ts.find(t=>t.suffixes.find(s=>s===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function hn(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const o=(l.semitones+e)%12;return{...l,semitones:o<0?o+12:o,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function as(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const o=t[n],a=l+o.semitones,r=e.scaleNotes.find(_=>_.semitones===a%12),c=o.flats>0,f=o.sharps>0,h=(c?a+1:f?a-1:a)%12,u=c?-1:f?1:0;s.push(hn(r??e.notesMap.get(h),r?0:u,a))}return s}const Ts=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],mn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],Is=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function _n(l){let e=0,t=0;for(let s=0;s<Ts.length;s+=1){const n=l.find(a=>a.note.slice(0,2)===Ts[s]),o=l.find(a=>a.note.slice(0,2)===mn[s]);if(n)e+=1;else if(o)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:Is.get(e*-1)}:{flats:0,sharps:t,majorSignature:Is.get(t)}}function pn(l){return l>=9?`${l>=10?"X":""}${l===9?"IX":"I".repeat(l%10)}`:`${l>=5?"V":""}${l===4?"IV":"I".repeat(l%5)}`}function ql(l){return l.map(e=>{const t=[$e(1)];let s;return e.major?(t.push($e(3)),e.suffix.startsWith("+")?t.push($e(5,0,1)):e.suffix.startsWith("6")?t.push($e(6)):e.suffix.startsWith("7")?t.push($e(7,1)):e.suffix.startsWith("maj7")?t.push($e(7)):s=Tt("maj")):e.minor?(t.push($e(3,1)),e.suffix.startsWith("°")?t.push($e(5,1)):e.suffix.startsWith("6")?(t.push($e(6)),s=Tt("m"+e.suffix)):e.suffix.startsWith("7")?(t.push($e(7,1)),s=Tt("m"+e.suffix)):s=Tt("m")):e.suffix.startsWith("sus2")?t.push($e(2)):e.suffix.startsWith("sus4")&&t.push($e(4)),t.length<=2&&t.push($e(5)),t.length<=2&&t.push($e(8)),s||(s=Tt(e.suffix)),{...s,intervals:t}})}function vn(l,e){let t=e.has(4)&&e.has(7),s=e.has(3)&&e.has(7);const n=pn(l);let o="";return t||s||(e.has(3)&&e.has(6)?(o="°",s=!0):e.has(4)&&e.has(8)?(o="+",t=!0):e.has(3)&&e.has(10)?(s=!0,o="7"):e.has(4)&&e.has(10)?(o="7",t=!0):e.has(4)&&e.has(11)?(o="maj7",t=!0):e.has(3)&&e.has(8)?(o="6",s=!0):e.has(4)&&e.has(9)?(o="6",t=!0):e.has(2)?o="sus2":e.has(5)?o="sus4":e.has(7)?o="5":o="?"),{degree:l,roman:s?n.toLowerCase():n,suffix:o,major:t,minor:s,semitones:e}}function gn(l){const e=l.length;return l.map((t,s)=>{const n=t.semitones,o=new Set;for(let a=1;a<e;a+=1){const r=l[(s+a)%e].semitones,c=r<=n?r+12-n:r-n;o.add(c)}return vn(t.interval_seq,o)})}const bn=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let ss=[];function fs(){return bn.map(l=>{const e=l[0],t=l[1].map(Hl),s=gn(t);return{names:e,intervals:t,triads:s}})}function yn(l){ss.length===0&&(ss=fs());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return ss.find(t=>t.names.find(s=>s.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const kn=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,Cn=/^[0-9]$/,tt=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function Wl(l){return l===12?1:Math.floor((l-12)/12)}function Xe(l){return`${l.note}${Wl(l.midi)}`}function Et(l){const t=(l-12)%12;return{...tt[t],semitones:t,midi:l}}function En(l,e=!0,t=!1){if(e&&!kn.test(l))return{err:`Unrecognized note "${l}"`,code:400};const s=l.trim(),n=s.charAt(0).toUpperCase(),o=tt.find(u=>u.note.charAt(0)===n&&u.note.length===1);if(!o)return{err:`Unable to find note ${s}`,code:500};const a=s.slice(1).split("").reduce((u,_)=>u+(_.toLowerCase()==="b"||_==="♭"?-1:_==="#"||_==="♯"?1:0),0);let r;if(Cn.test(s.charAt(s.length-1)))try{r=parseInt(s.charAt(s.length-1),10)}catch{}if(t&&r===void 0)return{err:`No octave provided: ${l}`,code:400};r===void 0&&(r=0);let c=(o.semitones+a)%12;c=c<0?c+12:c;const f=a<0?-a:0,h=a>0?a:0;return{data:{note:`${n}${"♭".repeat(f)}${"♯".repeat(h)}`,semitones:c,midi:12+r*12+c,flats:f,sharps:h}}}function Jl(l){const e=tt.find(t=>t.note.charAt(0)===l.charAt(0)&&t.note.length===1);if(e){const t=l.slice(1).split("").reduce((n,o)=>n+(o.toLowerCase()==="b"||o==="♭"?-1:o==="#"||o==="♯"?1:0),0),s=(e.semitones+t)%12;return{note:l,semitones:s<0?s+12:s,flats:t<0?-t:0,sharps:t>0?t:0}}}const wn=/^[a-gA-G][♭b#♯]?$/,ls="ABCDEFG";function Sn(l,e){return e.map(t=>ls.charAt((ls.indexOf(l)+t.interval_seq-1)%ls.length))}function An(l,e,t){return t.map((s,n)=>{const o=e[n],a=(l+s.semitones)%12,r=tt[a],c=r.note.charAt(0);if(c<o&&(c!=="A"||o!=="G")||c==="G"&&o==="A"){let f=1,h=tt[(a+f)%12];for(;h.note.charAt(0)!==o;)f+=1,h=tt[(a+f)%12];return{semitones:a,note:h.note+"♭".repeat(f),flats:f+(h.note.includes("♭")?1:0),sharps:0}}else if(c>o||c==="A"&&o==="G"){let f=1,h=a===0?tt.length-1:a-f,u=tt[h];for(;u.note.charAt(0)!==o;)f+=1,h=h===0?tt.length-1:h-1,u=tt[h];return{semitones:a,note:u.note+"♯".repeat(f),flats:0,sharps:f+(u.note.includes("♯")?1:0)}}else return{semitones:a,note:r.note,flats:r.flats,sharps:r.sharps}})}function Rt(l,e){if(!wn.test(l))return{err:`Unknown key: ${l}`,code:400};const t=yn(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const s=`${l.charAt(0).toUpperCase()}${l.charAt(1).replace("b","♭").replace("#","♯")}`,n=Jl(s);if(!n)return{err:`Unable to find root for note: ${s}`,code:404};const o=Sn(s.charAt(0),t.intervals),a=An(n.semitones,o,t.intervals),r=new Map(tt.map(c=>{const f=a.find(h=>h.semitones===c.semitones);return f?[c.semitones,f]:[c.semitones,{...c}]}));return{data:{key:s,scale:t.names[0],names:t.names,..._n(a),intervals:t.intervals.map(c=>({...c})),triads:t.triads.map(c=>({...c})),scaleNotes:a,notesMap:r}}}const os=new Map;function Tn(l,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(l)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function In(l,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(l)),{data:void 0}}catch(s){return{err:`Failed to store the value: ${s}`,code:400}}}function vt(l,e){const{key:t,storage:s="local",namespace:n="default"}=e,o=Tn(t,s),a=Be(l);"data"in o?l.set(e.deserialize?e.deserialize(o.data):o.data):"err"in o&&(e!=null&&e.debug)&&console.info(o.err);const r=l.subscribe(f=>{const h=In(e.serialize?e.serialize(f):f,t,s);"err"in h&&(e!=null&&e.debug)&&console.error(h.err)}),c=os.get(n);return c?c.push({key:t,storage:s,value:l,defaultValue:a,unsubscribe:r}):os.set(n,[{key:t,storage:s,value:l,defaultValue:a,unsubscribe:r}]),l}function Nn(l=["default"],e){l.forEach(t=>{var s;(s=os.get(t))==null||s.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function jn(l,e){const t=await fetch(l);if(!t.ok)return{err:t.statusText,code:t.status};const s=await t.arrayBuffer();return{data:await e.decodeAudioData(s)}}async function Dn(l,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],s=await Promise.all(t.map(o=>jn(`${l}${o}`,e))),n=[];return s.forEach(o=>{"err"in o?console.error(`Failed to load audio: ${o.err}`):n.push(o.data)}),n}class Ln{constructor(e,t,s,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(s),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(s))}on(e,t,s,n,o,a,r,c){this.noteA.buffer=e,this.noteA.playbackRate.value=s,this.biquadFilter.frequency.value=o,this.gainA.gain.value=a,this.gain.gain.value=c,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=r,this.noteB.start(0)),this.noteA.start(0)}off(e,t,s){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(s),this.noteB.stop(s),(n=this.damp)==null||n.start(0)}}class Gn{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,s)=>{this.bufferlists.push(t),s===8?this.damper=t:s===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(s=>{this.noteOn(s,t)})}noteOn(e,t=80){if(e<109&&e>20){const s=this.notes.get(e);s&&(s.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),o=n+1,a=n*12+21,r=2**((e-69)/12)*440,c=t/127;let f=r*(2-(e-21)/50)+3*r*c;e<60&&(f=440*(3-(60-21)/50)+3*r*c);const h=1-(e%12/12+1)/12,u=Math.pow(2,(e-a)/12),_=0,y=0,b=c**1.4,C=new Ln(e,this.context,this.directGain,this.damper);C.on(this.bufferlists[n],this.bufferlists[o],u,_,f,h,y,b),this.notes.set(e,C)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const Pn="/midi-note-trainer/",rs=vt(Oe(!1),{key:"midi-access"}),qt=Oe(void 0),ds=vt(Oe([60,84]),{key:"midi-range",storage:"session"}),Wt=cs(ds,l=>[Et(l[0]),Et(l[1])]),Ns=Oe(void 0),st=Oe(void 0),Ql=Oe(!0),pt=vt(Oe({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),ge={async openMidi(){return xt.enable().then(()=>(rs.set(!0),xt.inputs.length>0?(qt.set(xt.inputs[0]),{data:xt.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(l=>({err:l.toString(),code:403}))},disableMidi(){rs.set(!1),qt.set(void 0)},setMidiRange(l){ds.set(l)},setInputValue(l,e){pt.update(t=>({...t,[l]:e})),l==="useSound"&&!e?st.set(void 0):l==="useSound"&&!Be(st)&&this.initAudio()},setKeyboardFocus(l){Ql.set(l)},async initAudio(){let l=Be(Ns);if(l||(l=new AudioContext,Ns.set(l)),!Be(st)){const e=new Gn(l),t=await Dn(`${Pn}audio`,l);e.load(t),st.set(e)}}};let et;const Bn=sn({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}}),gt=Oe(["C","Major"]),St=cs(gt,l=>{const e=Rt(l[0],l[1]);return"data"in e?e.data:{key:l[0],scale:l[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),Yl=cs([St,Bn],([l,e])=>{const t={...e};return Object.entries(e).forEach(([s,n])=>{const o=l.notesMap.get(n.semitones%12);o&&(t[s]={note:o.note,flats:o.flats,sharps:o.sharps,semitones:n.semitones})}),t}),js=Oe([]),ht=Oe([]);function is(l,e){if(l.length>0){const t=Date.now();let s=t;const n=l.filter(o=>(o.started+e>t&&(s=Math.min(s,o.started)),o.started+e>t));return!et&&n.length>0&&(et=setTimeout(()=>{et=void 0,ht.update(o=>is(o,e))},e-(t-s)+100)),n}return l}const ve={setKey(l){gt.update(e=>[l,e[1]])},setScale(l){gt.update(e=>[e[0],l])},setKeyAndScale(l,e){gt.set([l,e])},setTarget(l=[]){js.set(l)},findNote(l){return Object.values(Be(Yl)).find(e=>{if(e.note.charAt(0)===l.charAt(0)){const t=l.slice(1).split("").reduce((s,n)=>s+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},getNote(l){return{...Be(St).notesMap.get(l%12),midi:l}},pushPlayed(l,e,t){const n={...Be(St).notesMap.get(l%12),midi:l},o=Date.now(),a=e===void 0?"default":e?"correct":"wrong";if(ht.update(r=>{const c=r.findIndex(f=>f.midi===l);return c>=0&&r.splice(c,1),[...r,{...n,color:a,started:o}]}),!et&&t!==-1){const r=t??Be(pt).keyFadeTimeout;et=setTimeout(()=>{et=void 0,ht.update(c=>is(c,r))},r)}},setPlayed(l,e,t){const s=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(ht.update(o=>[...l.map(a=>({...a,color:n,started:s}))]),!et&&t!==-1){const o=t??Be(pt).keyFadeTimeout;et=setTimeout(()=>{et=void 0,ht.update(a=>is(a,o))},o)}},clearPlayed(){ht.set([]),clearTimeout(et),et=void 0},clearScore(l=!1){l&&gt.set(["C","Major"]),js.set([]),ht.set([])}};class hs{constructor(e,t,s){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=s;const n=[],{count:o}=s,a=t.map(c=>typeof c=="object"&&c!==null?{...c}:c);let r=s.duplicates;!s.duplicates&&o>a.length&&(console.warn(`Trying to create game with count ${o} larger than available unique values ${t.length}`),r=!0);for(let c=0;c<o;c+=1){const f=Math.floor(Math.random()*a.length);if(r)n.push(a[f]);else{const h=a.splice(f,1);h.length>0&&n.push(h[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function Mn(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const o=(l.semitones+e)%12;return{...l,semitones:o<0?o+12:o,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function Vn(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const o=t[n],a=l+o.semitones,r=e.scaleNotes.find(_=>_.semitones===a%12),c=o.flats>0,f=o.sharps>0,h=(c?a+1:f?a-1:a)%12,u=c?-1:f?1:0;s.push(Mn(r??e.notesMap.get(h),r?0:u,a))}return s}const On=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function Fn(l){const t=(l-12)%12;return{...On[t],semitones:t,midi:l}}function Un(l){return`${l.note.trim().charAt(0).toUpperCase()}${"♭".repeat(l.flats)}${"♯".repeat(l.sharps)}`}class rt extends hs{constructor(e,t,s){const n=t.range[0],o=t.range[1],a=new Set(t.scale.scaleNotes.map(c=>c.semitones)),r=s.chords.flatMap(c=>{const f=[],h=c.intervals.reduce((u,_)=>_.semitones>u?_.semitones:u,0);for(let u=n;u<=o-h;u+=1)if((!s.onlyScale||a.has(u%12))&&(!c.allowed||c.allowed.has(u%12))){const _=Vn(u,t.scale,c.intervals);f.push({...c,rootNote:_[0].note,chord:`${_[0].note}${c.suffixes[0]}`,notes:_})}return f});super(e,r,t),this.played=new Set,this.opts=s}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${Un(e)}${e.chord.toLowerCase()}`,notes:[]},s=this.current.chord===t.chord;return this.addGuessed(t,s)}guess(){const e=Array.from(this.played.values()).map(n=>Fn(n)).sort((n,o)=>n.midi-o.midi);this.played.clear();const t={chord:"",notes:e},s=this.current.notes.every(n=>e.find(o=>o.midi%12===n.midi%12));return this.addGuessed(t,s)}}const xn={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class It extends hs{constructor(e,t){const s=e==="keys-major"?"major":"minor";super(e,Object.keys(xn[s]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class wt extends hs{constructor(e,t){const s=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-s+1)).map((o,a)=>s+a),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const Xl={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},mt=Oe("waiting"),it=vt(Oe(Xl),{key:"game-options"}),_t=Oe(void 0),ms=Oe(Rl().map(l=>({...l,selected:!0}))),we={play(...[l,e]){var c,f,h;let t;const s=Be(St),n=Be(ds),o=Be(it),a={scale:s,range:n,duplicates:o.duplicates,count:o.count};let r=[s.key,s.scale];if(l==="notes")t=new wt(l,a),ve.setTarget([ve.getNote(t.current)]),(c=Be(st))==null||c.noteOn(t.current);else if(l==="pitches")t=new wt(l,a),ve.setTarget(),ge.setInputValue("useSound",!0),(f=Be(st))==null||f.noteOn(t.current);else if(l==="keys-major"||l=="keys-minor")t=new It(l,a),r=[t.current,l==="keys-major"?"major":"minor"];else if(l==="chords-play"||l==="chords-write")t=new rt(l,a,e);else if(l==="chords-diatonic"){const u=ql(s.triads).map((_,y)=>({..._,allowed:new Set([s.scaleNotes[y].semitones])}));t=new rt(l,a,{chords:u})}else throw Error("Unknown game type: "+l);return typeof t.current!="number"&&typeof t.current!="string"&&((h=Be(st))==null||h.playChord(t.current.notes.map(u=>u.midi)),ve.setTarget(t.current.notes)),ve.setKeyAndScale(r[0],r[1]),ve.clearPlayed(),mt.set("waiting"),_t.set(t),t},updateState(l){mt.set(l)},setOptionValue(l,e){it.update(t=>({...t,[l]:e}))},toggleChords(l){ms.update(e=>e.map(t=>({...t,selected:l(t)})))},nextGuess(){var e,t;const l=Be(_t);l!=null&&l.ended?mt.set("ended"):l instanceof wt?(l.type==="notes"?ve.setTarget([ve.getNote(l.current)]):ve.setTarget(),ve.clearPlayed(),(e=Be(st))==null||e.noteOn(l.current),we.updateState("waiting"),l.startTime()):l instanceof rt?(ve.setTarget(l.current.notes),ve.clearPlayed(),(t=Be(st))==null||t.playChord(l==null?void 0:l.current.notes.map(s=>s.midi)),mt.set("waiting"),l.startTime()):l instanceof It&&(ve.setKey(l.current),mt.set("waiting"),l.startTime())},clearGame(l=!1){const e=Be(_t);e&&ve.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),l&&it.set(Xl),_t.set(void 0),mt.set("waiting"),ve.clearScore()}};function Ds(l,e,t){const s=l.slice();return s[29]=e[t],s[31]=t,s}function Ls(l,e,t){const s=l.slice();return s[34]=e[t],s}function Gs(l,e,t){const s=l.slice();return s[8]=e[t],s}function Ps(l,e,t){const s=l.slice();return s[29]=e[t],s[31]=t,s}function Bs(l,e,t){const s=l.slice();return s[34]=e[t],s}function Ms(l,e,t){const s=l.slice();return s[8]=e[t],s}function Kn(l){let e,t=oe(l[29].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Vs(Bs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Ve()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=Ve()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);z(n,e,o)},p(n,o){if(o[0]&64){t=oe(n[29].intervals);let a;for(a=0;a<t.length;a+=1){const r=Bs(n,t,a);s[a]?s[a].p(r,o):(s[a]=Vs(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function $n(l){let e,t=oe(l[2][l[31]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Os(Ms(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Ve()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=Ve()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);z(n,e,o)},p(n,o){if(o[0]&4){t=oe(n[2][n[31]]);let a;for(a=0;a<t.length;a+=1){const r=Ms(n,t,a);s[a]?s[a].p(r,o):(s[a]=Os(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Vs(l){let e,t=l[34].interval+"",s;return{c(){e=v("span"),s=ee(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=te(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-8fys9e")},m(n,o){z(n,e,o),i(e,s)},p(n,o){o[0]&64&&t!==(t=n[34].interval+"")&&ue(s,t)},d(n){n&&m(e)}}}function Os(l){let e,t=l[8].note+"",s;return{c(){e=v("span"),s=ee(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=te(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-8fys9e")},m(n,o){z(n,e,o),i(e,s)},p(n,o){o[0]&4&&t!==(t=n[8].note+"")&&ue(s,t)},d(n){n&&m(e)}}}function Fs(l){let e,t,s,n,o,a,r=l[29].suffixes[0]+"",c,f,h,u,_,y,b=l[29].name+"",C,p,w,A;n=new nt({props:{icon:l[29].selected?zt:Ht,width:12}});function j(){return l[25](l[29])}function E(S,O){return S[2][S[31]]&&S[2][S[31]].length>0?$n:Kn}let N=E(l),I=N(l);return{c(){e=v("li"),t=v("button"),s=v("span"),be(n.$$.fragment),o=L(),a=v("div"),c=ee(r),f=L(),h=v("li"),I.c(),_=L(),y=v("li"),C=ee(b),this.h()},l(S){e=g(S,"LI",{});var O=T(e);t=g(O,"BUTTON",{class:!0});var D=T(t);s=g(D,"SPAN",{class:!0});var R=T(s);ye(n.$$.fragment,R),R.forEach(m),o=G(D),a=g(D,"DIV",{class:!0});var k=T(a);c=te(k,r),k.forEach(m),D.forEach(m),O.forEach(m),f=G(S),h=g(S,"LI",{class:!0,title:!0});var V=T(h);I.l(V),V.forEach(m),_=G(S),y=g(S,"LI",{class:!0});var P=T(y);C=te(P,b),P.forEach(m),this.h()},h(){d(s,"class","px-1 py-1 rounded svelte-8fys9e"),Z(s,"text-green-500",l[29].selected),Z(s,"text-gray-400",!l[29].selected),d(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-8fys9e"),d(t,"class","flex items-center justify-center w-full select-btn svelte-8fys9e"),Z(t,"hidden",l[7]),d(h,"class","intervals svelte-8fys9e"),d(h,"title",u=l[29].intervals.map(zs).join("-")),d(y,"class","text-xs")},m(S,O){z(S,e,O),i(e,t),i(t,s),ke(n,s,null),i(t,o),i(t,a),i(a,c),z(S,f,O),z(S,h,O),I.m(h,null),z(S,_,O),z(S,y,O),i(y,C),p=!0,w||(A=q(t,"click",j),w=!0)},p(S,O){l=S;const D={};O[0]&64&&(D.icon=l[29].selected?zt:Ht),n.$set(D),(!p||O[0]&64)&&Z(s,"text-green-500",l[29].selected),(!p||O[0]&64)&&Z(s,"text-gray-400",!l[29].selected),(!p||O[0]&64)&&r!==(r=l[29].suffixes[0]+"")&&ue(c,r),(!p||O[0]&128)&&Z(t,"hidden",l[7]),N===(N=E(l))&&I?I.p(l,O):(I.d(1),I=N(l),I&&(I.c(),I.m(h,null))),(!p||O[0]&64&&u!==(u=l[29].intervals.map(zs).join("-")))&&d(h,"title",u),(!p||O[0]&64)&&b!==(b=l[29].name+"")&&ue(C,b)},i(S){p||(W(n.$$.fragment,S),p=!0)},o(S){Q(n.$$.fragment,S),p=!1},d(S){S&&(m(e),m(f),m(h),m(_),m(y)),Ce(n),I.d(),w=!1,A()}}}function zn(l){let e,t=oe(l[29].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Us(Ls(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Ve()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=Ve()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);z(n,e,o)},p(n,o){if(o[0]&32){t=oe(n[29].intervals);let a;for(a=0;a<t.length;a+=1){const r=Ls(n,t,a);s[a]?s[a].p(r,o):(s[a]=Us(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Hn(l){let e,t=oe(l[3][l[31]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=xs(Gs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Ve()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=Ve()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);z(n,e,o)},p(n,o){if(o[0]&8){t=oe(n[3][n[31]]);let a;for(a=0;a<t.length;a+=1){const r=Gs(n,t,a);s[a]?s[a].p(r,o):(s[a]=xs(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Us(l){let e,t=l[34].interval+"",s;return{c(){e=v("span"),s=ee(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=te(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-8fys9e")},m(n,o){z(n,e,o),i(e,s)},p(n,o){o[0]&32&&t!==(t=n[34].interval+"")&&ue(s,t)},d(n){n&&m(e)}}}function xs(l){let e,t=l[8].note+"",s;return{c(){e=v("span"),s=ee(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=te(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-8fys9e")},m(n,o){z(n,e,o),i(e,s)},p(n,o){o[0]&8&&t!==(t=n[8].note+"")&&ue(s,t)},d(n){n&&m(e)}}}function Ks(l){let e,t,s,n,o,a,r=l[29].suffixes[0]+"",c,f,h,u,_,y,b=l[29].name+"",C,p,w,A;n=new nt({props:{icon:l[29].selected?zt:Ht,width:12}});function j(){return l[26](l[29])}function E(S,O){return S[3][S[31]]&&S[3][S[31]].length>0?Hn:zn}let N=E(l),I=N(l);return{c(){e=v("li"),t=v("button"),s=v("span"),be(n.$$.fragment),o=L(),a=v("div"),c=ee(r),f=L(),h=v("li"),I.c(),_=L(),y=v("li"),C=ee(b),this.h()},l(S){e=g(S,"LI",{});var O=T(e);t=g(O,"BUTTON",{class:!0});var D=T(t);s=g(D,"SPAN",{class:!0});var R=T(s);ye(n.$$.fragment,R),R.forEach(m),o=G(D),a=g(D,"DIV",{class:!0});var k=T(a);c=te(k,r),k.forEach(m),D.forEach(m),O.forEach(m),f=G(S),h=g(S,"LI",{class:!0,title:!0});var V=T(h);I.l(V),V.forEach(m),_=G(S),y=g(S,"LI",{class:!0});var P=T(y);C=te(P,b),P.forEach(m),this.h()},h(){d(s,"class","px-1 py-1 rounded svelte-8fys9e"),Z(s,"text-green-500",l[29].selected),Z(s,"text-gray-400",!l[29].selected),d(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-8fys9e"),d(t,"class","flex items-center justify-center w-full select-btn svelte-8fys9e"),Z(t,"hidden",l[7]),d(h,"class","intervals svelte-8fys9e"),d(h,"title",u=l[29].intervals.map(Hs).join("-")),d(y,"class","text-xs")},m(S,O){z(S,e,O),i(e,t),i(t,s),ke(n,s,null),i(t,o),i(t,a),i(a,c),z(S,f,O),z(S,h,O),I.m(h,null),z(S,_,O),z(S,y,O),i(y,C),p=!0,w||(A=q(t,"click",j),w=!0)},p(S,O){l=S;const D={};O[0]&32&&(D.icon=l[29].selected?zt:Ht),n.$set(D),(!p||O[0]&32)&&Z(s,"text-green-500",l[29].selected),(!p||O[0]&32)&&Z(s,"text-gray-400",!l[29].selected),(!p||O[0]&32)&&r!==(r=l[29].suffixes[0]+"")&&ue(c,r),(!p||O[0]&128)&&Z(t,"hidden",l[7]),N===(N=E(l))&&I?I.p(l,O):(I.d(1),I=N(l),I&&(I.c(),I.m(h,null))),(!p||O[0]&32&&u!==(u=l[29].intervals.map(Hs).join("-")))&&d(h,"title",u),(!p||O[0]&32)&&b!==(b=l[29].name+"")&&ue(C,b)},i(S){p||(W(n.$$.fragment,S),p=!0)},o(S){Q(n.$$.fragment,S),p=!1},d(S){S&&(m(e),m(f),m(h),m(_),m(y)),Ce(n),I.d(),w=!1,A()}}}function Rn(l){let e,t,s,n,o="Chords",a,r,c,f,h,u,_,y,b,C,p,w,A,j,E,N,I,S="Key",O,D,R,k,V="Scale",P,U,B,M,x="Note",re,se,X,fe,Ee,ce,Me,he,de,Fe;f=new nt({props:{icon:un,width:20}}),_=new nt({props:{icon:fn,width:16}}),C=new nt({props:{icon:l[4]?Es:ws,width:16}}),A=new nt({props:{icon:$l,width:16}});let $=oe(l[6]),H=[];for(let K=0;K<$.length;K+=1)H[K]=Fs(Ps(l,$,K));const F=K=>Q(H[K],1,1,()=>{H[K]=null});let ae=oe(l[5]),Y=[];for(let K=0;K<ae.length;K+=1)Y[K]=Ks(Ds(l,ae,K));const ie=K=>Q(Y[K],1,1,()=>{Y[K]=null});return{c(){e=v("div"),t=v("fieldset"),s=v("legend"),n=v("button"),n.textContent=o,a=L(),r=v("div"),c=v("button"),be(f.$$.fragment),h=L(),u=v("button"),be(_.$$.fragment),y=L(),b=v("button"),be(C.$$.fragment),p=L(),w=v("button"),be(A.$$.fragment),j=L(),E=v("div"),N=v("div"),I=v("label"),I.textContent=S,O=L(),D=v("input"),R=L(),k=v("label"),k.textContent=V,P=L(),U=v("input"),B=L(),M=v("label"),M.textContent=x,re=L(),se=v("input"),X=L(),fe=v("ul");for(let K=0;K<H.length;K+=1)H[K].c();Ee=L(),ce=v("ul");for(let K=0;K<Y.length;K+=1)Y[K].c();this.h()},l(K){e=g(K,"DIV",{class:!0});var J=T(e);t=g(J,"FIELDSET",{class:!0});var pe=T(t);s=g(pe,"LEGEND",{class:!0});var le=T(s);n=g(le,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1knqzl6"&&(n.textContent=o),le.forEach(m),a=G(pe),r=g(pe,"DIV",{class:!0});var Te=T(r);c=g(Te,"BUTTON",{class:!0});var Ge=T(c);ye(f.$$.fragment,Ge),Ge.forEach(m),h=G(Te),u=g(Te,"BUTTON",{class:!0});var lt=T(u);ye(_.$$.fragment,lt),lt.forEach(m),y=G(Te),b=g(Te,"BUTTON",{class:!0});var qe=T(b);ye(C.$$.fragment,qe),qe.forEach(m),p=G(Te),w=g(Te,"BUTTON",{class:!0});var Ue=T(w);ye(A.$$.fragment,Ue),Ue.forEach(m),Te.forEach(m),j=G(pe),E=g(pe,"DIV",{class:!0});var Le=T(E);N=g(Le,"DIV",{class:!0});var Ie=T(N);I=g(Ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(I)!=="svelte-14m38zf"&&(I.textContent=S),O=G(Ie),D=g(Ie,"INPUT",{class:!0,id:!0}),R=G(Ie),k=g(Ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(k)!=="svelte-1ytp0wy"&&(k.textContent=V),P=G(Ie),U=g(Ie,"INPUT",{class:!0,id:!0}),B=G(Ie),M=g(Ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(M)!=="svelte-1o58334"&&(M.textContent=x),re=G(Ie),se=g(Ie,"INPUT",{class:!0,id:!0}),Ie.forEach(m),X=G(Le),fe=g(Le,"UL",{class:!0});var At=T(fe);for(let xe=0;xe<H.length;xe+=1)H[xe].l(At);At.forEach(m),Ee=G(Le),ce=g(Le,"UL",{class:!0});var bt=T(ce);for(let xe=0;xe<Y.length;xe+=1)Y[xe].l(bt);bt.forEach(m),Le.forEach(m),pe.forEach(m),J.forEach(m),this.h()},h(){d(n,"class","px-1 rounded hover:bg-gray-100"),d(s,"class","text-base"),d(c,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),Z(c,"hidden",l[7]),d(u,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),Z(u,"hidden",l[7]),d(b,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),Z(b,"hidden",l[7]),d(w,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),Z(w,"hidden",l[7]),d(r,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),d(I,"class","mr-4 font-bold"),d(I,"for","scale-key"),d(D,"class","bg-gray-100 w-16 px-1 rounded"),d(D,"id","scale-key"),D.value=l[0],d(k,"class","mx-4 font-bold"),d(k,"for","scale-key"),d(U,"class","bg-gray-100 w-16 px-1 rounded"),d(U,"id","scale-key"),U.value="Major",U.disabled=!0,d(M,"class","mx-4 font-bold"),d(M,"for","scale-key"),d(se,"class","bg-gray-100 w-16 px-1 rounded"),d(se,"id","scale-key"),se.value=l[1],d(N,"class","flex w-1/2 mb-2 input svelte-8fys9e"),d(fe,"class","chord-list w-full svelte-8fys9e"),d(ce,"class","chord-list w-full svelte-8fys9e"),d(E,"class","body svelte-8fys9e"),Z(E,"hidden",l[7]),d(t,"class","flex flex-col relative rounded border-2 px-4 py-2 my-4 text-sm svelte-8fys9e"),Z(t,"collapsed",l[7]),d(e,"class",Me=De(`${l[18].class||""}`)+" svelte-8fys9e")},m(K,J){z(K,e,J),i(e,t),i(t,s),i(s,n),i(t,a),i(t,r),i(r,c),ke(f,c,null),i(r,h),i(r,u),ke(_,u,null),i(r,y),i(r,b),ke(C,b,null),i(r,p),i(r,w),ke(A,w,null),i(t,j),i(t,E),i(E,N),i(N,I),i(N,O),i(N,D),i(N,R),i(N,k),i(N,P),i(N,U),i(N,B),i(N,M),i(N,re),i(N,se),i(E,X),i(E,fe);for(let pe=0;pe<H.length;pe+=1)H[pe]&&H[pe].m(fe,null);i(E,Ee),i(E,ce);for(let pe=0;pe<Y.length;pe+=1)Y[pe]&&Y[pe].m(ce,null);he=!0,de||(Fe=[q(n,"click",l[10]),q(c,"click",l[14]),q(u,"click",l[15]),q(b,"click",l[16]),q(w,"click",l[17]),q(D,"input",l[11]),q(D,"focus",l[21]),q(D,"blur",l[22]),q(se,"input",l[12]),q(se,"focus",l[23]),q(se,"blur",l[24])],de=!0)},p(K,J){(!he||J[0]&128)&&Z(c,"hidden",K[7]),(!he||J[0]&128)&&Z(u,"hidden",K[7]);const pe={};if(J[0]&16&&(pe.icon=K[4]?Es:ws),C.$set(pe),(!he||J[0]&128)&&Z(b,"hidden",K[7]),(!he||J[0]&128)&&Z(w,"hidden",K[7]),(!he||J[0]&1&&D.value!==K[0])&&(D.value=K[0]),(!he||J[0]&2&&se.value!==K[1])&&(se.value=K[1]),J[0]&8388){$=oe(K[6]);let le;for(le=0;le<$.length;le+=1){const Te=Ps(K,$,le);H[le]?(H[le].p(Te,J),W(H[le],1)):(H[le]=Fs(Te),H[le].c(),W(H[le],1),H[le].m(fe,null))}for(Je(),le=$.length;le<H.length;le+=1)F(le);Qe()}if(J[0]&8360){ae=oe(K[5]);let le;for(le=0;le<ae.length;le+=1){const Te=Ds(K,ae,le);Y[le]?(Y[le].p(Te,J),W(Y[le],1)):(Y[le]=Ks(Te),Y[le].c(),W(Y[le],1),Y[le].m(ce,null))}for(Je(),le=ae.length;le<Y.length;le+=1)ie(le);Qe()}(!he||J[0]&128)&&Z(E,"hidden",K[7]),(!he||J[0]&128)&&Z(t,"collapsed",K[7]),(!he||J[0]&262144&&Me!==(Me=De(`${K[18].class||""}`)+" svelte-8fys9e"))&&d(e,"class",Me)},i(K){if(!he){W(f.$$.fragment,K),W(_.$$.fragment,K),W(C.$$.fragment,K),W(A.$$.fragment,K);for(let J=0;J<$.length;J+=1)W(H[J]);for(let J=0;J<ae.length;J+=1)W(Y[J]);he=!0}},o(K){Q(f.$$.fragment,K),Q(_.$$.fragment,K),Q(C.$$.fragment,K),Q(A.$$.fragment,K),H=H.filter(Boolean);for(let J=0;J<H.length;J+=1)Q(H[J]);Y=Y.filter(Boolean);for(let J=0;J<Y.length;J+=1)Q(Y[J]);he=!1},d(K){K&&m(e),Ce(f),Ce(_),Ce(C),Ce(A),je(H,K),je(Y,K),de=!1,at(Fe)}}}let $s="Major";const zs=l=>l.interval,Hs=l=>l.interval;function qn(l,e,t){let s,n,o,a,r,c;me(l,ms,B=>t(20,r=B));let f="C",h=Rt(f,$s),u="",_,y=[],b=[];const C=vt(Oe(!0),{key:"chords-hidden"});me(l,C,B=>t(7,c=B));function p(){C.update(B=>!B)}function w(){const B=_&&60+_.semitones;if("err"in h||!B)t(2,y=[]),t(3,b=[]);else{const M=h.data;t(2,y=n.map(x=>as(B,M,x.intervals))),t(3,b=o.map(x=>as(B,M,x.intervals)))}}function A({currentTarget:{value:B}}){t(0,f=`${B.charAt(0).toUpperCase()}${B.charAt(1).toLowerCase()}`),h=Rt(f,$s),w()}function j({currentTarget:{value:B}}){t(1,u=`${B.charAt(0).toUpperCase()}${B.charAt(1).toLowerCase()}`),t(8,_=Jl(u)),w()}function E(B){we.toggleChords(M=>M.name===B.name?!M.selected:M.selected)}function N(){const B=x=>x.suffixes[0]==="maj"||x.suffixes[0]==="m",M=r.filter(B).every(x=>x.selected);we.toggleChords(x=>B(x)?!M:x.selected)}function I(){const B=x=>x.suffixes[0]==="maj7"||x.suffixes[0]==="m7"||x.suffixes[0]==="7"||x.suffixes[0]==="dim7"||x.suffixes[0]==="aug7",M=r.filter(B).every(x=>x.selected);we.toggleChords(x=>B(x)?!M:x.selected)}function S(){we.toggleChords(B=>!a)}function O(){we.toggleChords(B=>!0)}const D=()=>ge.setKeyboardFocus(!1),R=()=>ge.setKeyboardFocus(!0),k=()=>ge.setKeyboardFocus(!1),V=()=>ge.setKeyboardFocus(!0),P=B=>E(B),U=B=>E(B);return l.$$set=B=>{t(18,e=Se(Se({},e),Ae(B)))},l.$$.update=()=>{l.$$.dirty[0]&1048576&&t(19,s=r),l.$$.dirty[0]&524288&&t(6,n=s.filter((B,M)=>M<s.length/2)),l.$$.dirty[0]&524288&&t(5,o=s.filter((B,M)=>M>=s.length/2)),l.$$.dirty[0]&524288&&t(4,a=s.every(B=>B.selected))},e=Ae(e),[f,u,y,b,a,o,n,c,_,C,p,A,j,E,N,I,S,O,e,s,r,D,R,k,V,P,U]}class Wn extends ze{constructor(e){super(),He(this,e,qn,Rn,Re,{},null,[-1,-1])}}function Rs(l,e,t){const s=l.slice();return s[10]=e[t],s}function Jn(l){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,s){z(t,e,s)},p:_e,d(t){t&&m(e)}}}function Qn(l){let e,t,s="Played:",n,o=oe(l[2]),a=[];for(let r=0;r<o.length;r+=1)a[r]=qs(Rs(l,o,r));return{c(){e=v("div"),t=v("span"),t.textContent=s,n=L();for(let r=0;r<a.length;r+=1)a[r].c()},l(r){e=g(r,"DIV",{});var c=T(e);t=g(c,"SPAN",{"data-svelte-h":!0}),ne(t)!=="svelte-1g6xxhn"&&(t.textContent=s),n=G(c);for(let f=0;f<a.length;f+=1)a[f].l(c);c.forEach(m)},m(r,c){z(r,e,c),i(e,t),i(e,n);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(e,null)},p(r,c){if(c&4){o=oe(r[2]);let f;for(f=0;f<o.length;f+=1){const h=Rs(r,o,f);a[f]?a[f].p(h,c):(a[f]=qs(h),a[f].c(),a[f].m(e,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=o.length}},d(r){r&&m(e),je(a,r)}}}function Yn(l){let e,t,s="Result:",n,o,a,r=l[0].correct+"",c,f,h=l[0].sampled.length+"",u,_,y,b,C,p=l[0].avgTime+"",w,A;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=L(),o=v("span"),a=ee("["),c=ee(r),f=ee(" / "),u=ee(h),_=ee("]"),y=L(),b=v("span"),C=ee("avg "),w=ee(p),A=ee("s"),this.h()},l(j){e=g(j,"DIV",{class:!0});var E=T(e);t=g(E,"SPAN",{"data-svelte-h":!0}),ne(t)!=="svelte-1eqfbgx"&&(t.textContent=s),n=G(E),o=g(E,"SPAN",{class:!0});var N=T(o);a=te(N,"["),c=te(N,r),f=te(N," / "),u=te(N,h),_=te(N,"]"),N.forEach(m),y=G(E),b=g(E,"SPAN",{});var I=T(b);C=te(I,"avg "),w=te(I,p),A=te(I,"s"),I.forEach(m),E.forEach(m),this.h()},h(){d(o,"class","mx-2"),d(e,"class","flex")},m(j,E){z(j,e,E),i(e,t),i(e,n),i(e,o),i(o,a),i(o,c),i(o,f),i(o,u),i(o,_),i(e,y),i(e,b),i(b,C),i(b,w),i(b,A)},p(j,E){E&1&&r!==(r=j[0].correct+"")&&ue(c,r),E&1&&h!==(h=j[0].sampled.length+"")&&ue(u,h),E&1&&p!==(p=j[0].avgTime+"")&&ue(w,p)},d(j){j&&m(e)}}}function Xn(l){var S,O,D,R;let e,t,s="Target:",n,o,a=((S=l[0].latestGuess.target)==null?void 0:S.chord)+"",r,c,f,h=((O=l[0].latestGuess.target)==null?void 0:O.notes.map(Ws).join(" "))+"",u,_,y,b="Guessed:",C,p,w=((D=l[0].latestGuess.guessed)==null?void 0:D.chord)+"",A,j,E,N=((R=l[0].latestGuess.guessed)==null?void 0:R.notes.map(Js).join(" "))+"",I;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=L(),o=v("span"),r=ee(a),c=L(),f=v("span"),u=ee(h),_=L(),y=v("span"),y.textContent=b,C=L(),p=v("span"),A=ee(w),j=L(),E=v("span"),I=ee(N),this.h()},l(k){e=g(k,"DIV",{class:!0});var V=T(e);t=g(V,"SPAN",{"data-svelte-h":!0}),ne(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=G(V),o=g(V,"SPAN",{});var P=T(o);r=te(P,a),P.forEach(m),c=G(V),f=g(V,"SPAN",{});var U=T(f);u=te(U,h),U.forEach(m),_=G(V),y=g(V,"SPAN",{"data-svelte-h":!0}),ne(y)!=="svelte-104368"&&(y.textContent=b),C=G(V),p=g(V,"SPAN",{});var B=T(p);A=te(B,w),B.forEach(m),j=G(V),E=g(V,"SPAN",{});var M=T(E);I=te(M,N),M.forEach(m),V.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(k,V){z(k,e,V),i(e,t),i(e,n),i(e,o),i(o,r),i(e,c),i(e,f),i(f,u),i(e,_),i(e,y),i(e,C),i(e,p),i(p,A),i(e,j),i(e,E),i(E,I)},p(k,V){var P,U,B,M;V&1&&a!==(a=((P=k[0].latestGuess.target)==null?void 0:P.chord)+"")&&ue(r,a),V&1&&h!==(h=((U=k[0].latestGuess.target)==null?void 0:U.notes.map(Ws).join(" "))+"")&&ue(u,h),V&1&&w!==(w=((B=k[0].latestGuess.guessed)==null?void 0:B.chord)+"")&&ue(A,w),V&1&&N!==(N=((M=k[0].latestGuess.guessed)==null?void 0:M.notes.map(Js).join(" "))+"")&&ue(I,N)},d(k){k&&m(e)}}}function Zn(l){let e,t,s="Target:",n,o,a=l[0].latestGuess.target+"",r,c,f,h,u,_="Guessed:",y,b,C=l[0].latestGuess.guessed+"",p,w,A;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=L(),o=v("span"),r=ee(a),c=L(),f=v("span"),h=L(),u=v("span"),u.textContent=_,y=L(),b=v("span"),p=ee(C),w=L(),A=v("span"),this.h()},l(j){e=g(j,"DIV",{class:!0});var E=T(e);t=g(E,"SPAN",{"data-svelte-h":!0}),ne(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=G(E),o=g(E,"SPAN",{});var N=T(o);r=te(N,a),N.forEach(m),c=G(E),f=g(E,"SPAN",{}),T(f).forEach(m),h=G(E),u=g(E,"SPAN",{"data-svelte-h":!0}),ne(u)!=="svelte-104368"&&(u.textContent=_),y=G(E),b=g(E,"SPAN",{});var I=T(b);p=te(I,C),I.forEach(m),w=G(E),A=g(E,"SPAN",{}),T(A).forEach(m),E.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(j,E){z(j,e,E),i(e,t),i(e,n),i(e,o),i(o,r),i(e,c),i(e,f),i(e,h),i(e,u),i(e,y),i(e,b),i(b,p),i(e,w),i(e,A)},p(j,E){E&1&&a!==(a=j[0].latestGuess.target+"")&&ue(r,a),E&1&&C!==(C=j[0].latestGuess.guessed+"")&&ue(p,C)},d(j){j&&m(e)}}}function ea(l){let e,t,s="Target:",n,o,a=Xe(Et(l[0].latestGuess.target||0))+"",r,c,f,h,u,_="Guessed:",y,b,C=Xe(Et(l[0].latestGuess.guessed||0))+"",p,w,A;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=L(),o=v("span"),r=ee(a),c=L(),f=v("span"),h=L(),u=v("span"),u.textContent=_,y=L(),b=v("span"),p=ee(C),w=L(),A=v("span"),this.h()},l(j){e=g(j,"DIV",{class:!0});var E=T(e);t=g(E,"SPAN",{"data-svelte-h":!0}),ne(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=G(E),o=g(E,"SPAN",{});var N=T(o);r=te(N,a),N.forEach(m),c=G(E),f=g(E,"SPAN",{}),T(f).forEach(m),h=G(E),u=g(E,"SPAN",{"data-svelte-h":!0}),ne(u)!=="svelte-104368"&&(u.textContent=_),y=G(E),b=g(E,"SPAN",{});var I=T(b);p=te(I,C),I.forEach(m),w=G(E),A=g(E,"SPAN",{}),T(A).forEach(m),E.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(j,E){z(j,e,E),i(e,t),i(e,n),i(e,o),i(o,r),i(e,c),i(e,f),i(e,h),i(e,u),i(e,y),i(e,b),i(b,p),i(e,w),i(e,A)},p(j,E){E&1&&a!==(a=Xe(Et(j[0].latestGuess.target||0))+"")&&ue(r,a),E&1&&C!==(C=Xe(Et(j[0].latestGuess.guessed||0))+"")&&ue(p,C)},d(j){j&&m(e)}}}function qs(l){let e,t=Xe(l[10])+"",s;return{c(){e=v("span"),s=ee(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=te(o,t),o.forEach(m),this.h()},h(){d(e,"class","mx-1")},m(n,o){z(n,e,o),i(e,s)},p(n,o){o&4&&t!==(t=Xe(n[10])+"")&&ue(s,t)},d(n){n&&m(e)}}}function ta(l){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,s){z(t,e,s)},p:_e,d(t){t&&m(e)}}}function sa(l){let e,t="Next",s,n,o="Autoplay",a,r;return{c(){e=v("button"),e.textContent=t,s=L(),n=v("button"),n.textContent=o,this.h()},l(c){e=g(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1nvnoba"&&(e.textContent=t),s=G(c),n=g(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1cfj1sl"&&(n.textContent=o),this.h()},h(){d(e,"class","btn primary"),d(n,"class","btn primary")},m(c,f){z(c,e,f),z(c,s,f),z(c,n,f),a||(r=[q(e,"click",l[4]),q(n,"click",l[5])],a=!0)},p:_e,d(c){c&&(m(e),m(s),m(n)),a=!1,at(r)}}}function la(l){let e,t="Stop autoplay",s,n;return{c(){e=v("button"),e.textContent=t,this.h()},l(o){e=g(o,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){d(e,"class","btn primary")},m(o,a){z(o,e,a),s||(n=q(e,"click",l[9]),s=!0)},p:_e,d(o){o&&m(e),s=!1,n()}}}function na(l){let e,t="Try Again",s,n,o="Clear",a,r;return{c(){e=v("button"),e.textContent=t,s=L(),n=v("button"),n.textContent=o,this.h()},l(c){e=g(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-y911ux"&&(e.textContent=t),s=G(c),n=g(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(n)!=="svelte-11mnk9v"&&(n.textContent=o),this.h()},h(){d(e,"class","btn primary"),d(n,"class","btn primary")},m(c,f){z(c,e,f),z(c,s,f),z(c,n,f),a||(r=[q(e,"click",l[6]),q(n,"click",l[7])],a=!0)},p:_e,d(c){c&&(m(e),m(s),m(n)),a=!1,at(r)}}}function aa(l){let e,t,s,n;function o(u,_){return u[0]instanceof wt&&(u[1]==="correct"||u[1]==="wrong")?ea:u[0]instanceof It&&(u[1]==="correct"||u[1]==="wrong")?Zn:u[0]instanceof rt&&(u[1]==="correct"||u[1]==="wrong")?Xn:u[0]&&u[1]==="ended"?Yn:u[2].length>0?Qn:Jn}let a=o(l),r=a(l);function c(u,_){return u[0]&&u[1]==="ended"?na:u[0]&&u[3].autoplay?la:u[0]?sa:ta}let f=c(l),h=f(l);return{c(){e=v("div"),r.c(),s=L(),n=v("div"),h.c(),this.h()},l(u){e=g(u,"DIV",{class:!0});var _=T(e);r.l(_),_.forEach(m),s=G(u),n=g(u,"DIV",{class:!0});var y=T(n);h.l(y),y.forEach(m),this.h()},h(){d(e,"class",t=De(`${l[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),d(n,"class","mt-2 h-8")},m(u,_){z(u,e,_),r.m(e,null),z(u,s,_),z(u,n,_),h.m(n,null)},p(u,[_]){a===(a=o(u))&&r?r.p(u,_):(r.d(1),r=a(u),r&&(r.c(),r.m(e,null))),_&256&&t!==(t=De(`${u[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs")&&d(e,"class",t),f===(f=c(u))&&h?h.p(u,_):(h.d(1),h=f(u),h&&(h.c(),h.m(n,null)))},i:_e,o:_e,d(u){u&&(m(e),m(s),m(n)),r.d(),h.d()}}}const Ws=l=>l.note,Js=l=>l.note;function oa(l,e,t){let s,n,o;me(l,mt,_=>t(1,s=_)),me(l,ht,_=>t(2,n=_)),me(l,it,_=>t(3,o=_));let{game:a}=e;function r(){we.nextGuess()}function c(){we.setOptionValue("autoplay",!0),we.nextGuess()}function f(){a instanceof rt?we.play(a.type,a.opts):a&&we.play(a.type,void 0)}function h(){we.clearGame()}const u=()=>we.setOptionValue("autoplay",!1);return l.$$set=_=>{t(8,e=Se(Se({},e),Ae(_))),"game"in _&&t(0,a=_.game)},e=Ae(e),[a,s,n,o,r,c,f,h,e,u]}class ra extends ze{constructor(e){super(),He(this,e,oa,aa,Re,{game:0})}}function Qs(l){let e;return{c(){e=v("li"),this.h()},l(t){e=g(t,"LI",{class:!0}),T(e).forEach(m),this.h()},h(){d(e,"class","m-[0.175rem] mr-0")},m(t,s){z(t,e,s)},d(t){t&&m(e)}}}function Ys(l){let e;return{c(){e=v("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),T(e).forEach(m),this.h()},h(){d(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-jvhfju")},m(t,s){z(t,e,s)},d(t){t&&m(e)}}}function ia(l){let e,t,s,n,o,a=l[0].note+"",r,c,f,h=l[0].key+"",u,_,y,b,C=l[0].key==="Enter"&&Qs(),p=l[0].key==="Enter"&&Ys();return{c(){C&&C.c(),e=L(),t=v("li"),s=v("button"),p&&p.c(),n=L(),o=v("div"),r=ee(a),c=L(),f=v("div"),u=ee(h),this.h()},l(w){C&&C.l(w),e=G(w),t=g(w,"LI",{class:!0});var A=T(t);s=g(A,"BUTTON",{class:!0});var j=T(s);p&&p.l(j),n=G(j),o=g(j,"DIV",{class:!0});var E=T(o);r=te(E,a),E.forEach(m),c=G(j),f=g(j,"DIV",{});var N=T(f);u=te(N,h),N.forEach(m),j.forEach(m),A.forEach(m),this.h()},h(){d(o,"class","absolute top-0 left-0"),d(s,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex items-center justify-center svelte-jvhfju"),d(t,"class",_=De(`${l[1].class||""} m-[0.175rem] ${Xs(l[0].size)}`)+" svelte-jvhfju"),Z(t,"enter",l[0].key==="Enter")},m(w,A){C&&C.m(w,A),z(w,e,A),z(w,t,A),i(t,s),p&&p.m(s,null),i(s,n),i(s,o),i(o,r),i(s,c),i(s,f),i(f,u),y||(b=q(s,"click",l[2]),y=!0)},p(w,[A]){w[0].key==="Enter"?C||(C=Qs(),C.c(),C.m(e.parentNode,e)):C&&(C.d(1),C=null),w[0].key==="Enter"?p||(p=Ys(),p.c(),p.m(s,n)):p&&(p.d(1),p=null),A&1&&a!==(a=w[0].note+"")&&ue(r,a),A&1&&h!==(h=w[0].key+"")&&ue(u,h),A&3&&_!==(_=De(`${w[1].class||""} m-[0.175rem] ${Xs(w[0].size)}`)+" svelte-jvhfju")&&d(t,"class",_),A&3&&Z(t,"enter",w[0].key==="Enter")},i:_e,o:_e,d(w){w&&(m(e),m(t)),C&&C.d(w),p&&p.d(),y=!1,b()}}}function Xs(l){return l&&Number.isInteger(l)?`size-${l}`:l?`size-${Math.floor(l)}-${Math.floor(l*10)-Math.floor(l)*10}`:"size-1"}function ca(l,e,t){let{value:s}=e;function n(o){us.call(this,l,o)}return l.$$set=o=>{t(1,e=Se(Se({},e),Ae(o))),"value"in o&&t(0,s=o.value)},e=Ae(e),[s,e,n]}class Jt extends ze{constructor(e){super(),He(this,e,ca,ia,Re,{value:0})}}function Zs(l,e,t){const s=l.slice();return s[9]=e[t],s}function el(l,e,t){const s=l.slice();return s[9]=e[t],s}function tl(l,e,t){const s=l.slice();return s[9]=e[t],s}function sl(l,e,t){const s=l.slice();return s[9]=e[t],s}function ll(l){let e,t;return e=new Jt({props:{value:l[9]}}),{c(){be(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,n){ke(e,s,n),t=!0},p:_e,i(s){t||(W(e.$$.fragment,s),t=!0)},o(s){Q(e.$$.fragment,s),t=!1},d(s){Ce(e,s)}}}function nl(l){let e,t;return e=new Jt({props:{value:l[9]}}),{c(){be(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,n){ke(e,s,n),t=!0},p:_e,i(s){t||(W(e.$$.fragment,s),t=!0)},o(s){Q(e.$$.fragment,s),t=!1},d(s){Ce(e,s)}}}function al(l){let e,t;return e=new Jt({props:{value:l[9]}}),{c(){be(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,n){ke(e,s,n),t=!0},p:_e,i(s){t||(W(e.$$.fragment,s),t=!0)},o(s){Q(e.$$.fragment,s),t=!1},d(s){Ce(e,s)}}}function ol(l){let e,t;return e=new Jt({props:{value:l[9]}}),{c(){be(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,n){ke(e,s,n),t=!0},p:_e,i(s){t||(W(e.$$.fragment,s),t=!0)},o(s){Q(e.$$.fragment,s),t=!1},d(s){Ce(e,s)}}}function ua(l){let e,t,s,n,o="Middle-row",a,r,c,f,h,u="Two rows",_,y,b,C,p,w,A,j,E,N,I,S,O,D,R,k,V,P,U,B,M=oe(l[2]),x=[];for(let $=0;$<M.length;$+=1)x[$]=ll(sl(l,M,$));const re=$=>Q(x[$],1,1,()=>{x[$]=null});let se=oe(l[3]),X=[];for(let $=0;$<se.length;$+=1)X[$]=nl(tl(l,se,$));const fe=$=>Q(X[$],1,1,()=>{X[$]=null});let Ee=oe(l[4]),ce=[];for(let $=0;$<Ee.length;$+=1)ce[$]=al(el(l,Ee,$));const Me=$=>Q(ce[$],1,1,()=>{ce[$]=null});let he=oe(l[5]),de=[];for(let $=0;$<he.length;$+=1)de[$]=ol(Zs(l,he,$));const Fe=$=>Q(de[$],1,1,()=>{de[$]=null});return{c(){e=v("div"),t=v("div"),s=v("div"),n=v("label"),n.textContent=o,a=L(),r=v("input"),c=L(),f=v("div"),h=v("label"),h.textContent=u,_=L(),y=v("input"),b=L(),C=v("div"),p=v("ul"),w=v("li"),A=L();for(let $=0;$<x.length;$+=1)x[$].c();j=L(),E=v("li"),N=L();for(let $=0;$<X.length;$+=1)X[$].c();I=L(),S=v("li"),O=L();for(let $=0;$<ce.length;$+=1)ce[$].c();D=L(),R=v("li"),k=L();for(let $=0;$<de.length;$+=1)de[$].c();this.h()},l($){e=g($,"DIV",{class:!0});var H=T(e);t=g(H,"DIV",{class:!0});var F=T(t);s=g(F,"DIV",{class:!0});var ae=T(s);n=g(ae,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1ssbs6o"&&(n.textContent=o),a=G(ae),r=g(ae,"INPUT",{class:!0,id:!0,type:!0}),ae.forEach(m),c=G(F),f=g(F,"DIV",{class:!0});var Y=T(f);h=g(Y,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(h)!=="svelte-3aw9ul"&&(h.textContent=u),_=G(Y),y=g(Y,"INPUT",{class:!0,id:!0,type:!0}),Y.forEach(m),F.forEach(m),b=G(H),C=g(H,"DIV",{class:!0});var ie=T(C);p=g(ie,"UL",{class:!0});var K=T(p);w=g(K,"LI",{class:!0}),T(w).forEach(m),A=G(K);for(let J=0;J<x.length;J+=1)x[J].l(K);j=G(K),E=g(K,"LI",{class:!0}),T(E).forEach(m),N=G(K);for(let J=0;J<X.length;J+=1)X[J].l(K);I=G(K),S=g(K,"LI",{class:!0}),T(S).forEach(m),O=G(K);for(let J=0;J<ce.length;J+=1)ce[J].l(K);D=G(K),R=g(K,"LI",{class:!0}),T(R).forEach(m),k=G(K);for(let J=0;J<de.length;J+=1)de[J].l(K);K.forEach(m),ie.forEach(m),H.forEach(m),this.h()},h(){d(n,"class","font-bold mr-4"),d(n,"for","middle-row"),d(r,"class","h-[20px]"),d(r,"id","middle-row"),d(r,"type","checkbox"),d(s,"class","my-1 flex items-center justify-between mr-12"),d(h,"class","font-bold mr-4"),d(h,"for","two-rows"),d(y,"class","h-[20px]"),d(y,"id","two-rows"),d(y,"type","checkbox"),d(f,"class","my-1 flex items-center justify-between mr-12"),d(t,"class","flex"),d(w,"class","col-span-2 svelte-cgcsqn"),d(E,"class","col-span-2 svelte-cgcsqn"),d(S,"class","col-span-2 svelte-cgcsqn"),d(R,"class","col-span-2 svelte-cgcsqn"),d(p,"class","keyboard svelte-cgcsqn"),d(C,"class","flex flex-col gap-1.5"),d(e,"class",V=De(`${l[6].class||""} `)+" svelte-cgcsqn")},m($,H){z($,e,H),i(e,t),i(t,s),i(s,n),i(s,a),i(s,r),r.checked=l[0],i(t,c),i(t,f),i(f,h),i(f,_),i(f,y),y.checked=l[1],i(e,b),i(e,C),i(C,p),i(p,w),i(p,A);for(let F=0;F<x.length;F+=1)x[F]&&x[F].m(p,null);i(p,j),i(p,E),i(p,N);for(let F=0;F<X.length;F+=1)X[F]&&X[F].m(p,null);i(p,I),i(p,S),i(p,O);for(let F=0;F<ce.length;F+=1)ce[F]&&ce[F].m(p,null);i(p,D),i(p,R),i(p,k);for(let F=0;F<de.length;F+=1)de[F]&&de[F].m(p,null);P=!0,U||(B=[q(r,"change",l[7]),q(y,"change",l[8])],U=!0)},p($,[H]){if(H&1&&(r.checked=$[0]),H&2&&(y.checked=$[1]),H&4){M=oe($[2]);let F;for(F=0;F<M.length;F+=1){const ae=sl($,M,F);x[F]?(x[F].p(ae,H),W(x[F],1)):(x[F]=ll(ae),x[F].c(),W(x[F],1),x[F].m(p,j))}for(Je(),F=M.length;F<x.length;F+=1)re(F);Qe()}if(H&8){se=oe($[3]);let F;for(F=0;F<se.length;F+=1){const ae=tl($,se,F);X[F]?(X[F].p(ae,H),W(X[F],1)):(X[F]=nl(ae),X[F].c(),W(X[F],1),X[F].m(p,I))}for(Je(),F=se.length;F<X.length;F+=1)fe(F);Qe()}if(H&16){Ee=oe($[4]);let F;for(F=0;F<Ee.length;F+=1){const ae=el($,Ee,F);ce[F]?(ce[F].p(ae,H),W(ce[F],1)):(ce[F]=al(ae),ce[F].c(),W(ce[F],1),ce[F].m(p,D))}for(Je(),F=Ee.length;F<ce.length;F+=1)Me(F);Qe()}if(H&32){he=oe($[5]);let F;for(F=0;F<he.length;F+=1){const ae=Zs($,he,F);de[F]?(de[F].p(ae,H),W(de[F],1)):(de[F]=ol(ae),de[F].c(),W(de[F],1),de[F].m(p,null))}for(Je(),F=he.length;F<de.length;F+=1)Fe(F);Qe()}(!P||H&64&&V!==(V=De(`${$[6].class||""} `)+" svelte-cgcsqn"))&&d(e,"class",V)},i($){if(!P){for(let H=0;H<M.length;H+=1)W(x[H]);for(let H=0;H<se.length;H+=1)W(X[H]);for(let H=0;H<Ee.length;H+=1)W(ce[H]);for(let H=0;H<he.length;H+=1)W(de[H]);P=!0}},o($){x=x.filter(Boolean);for(let H=0;H<x.length;H+=1)Q(x[H]);X=X.filter(Boolean);for(let H=0;H<X.length;H+=1)Q(X[H]);ce=ce.filter(Boolean);for(let H=0;H<ce.length;H+=1)Q(ce[H]);de=de.filter(Boolean);for(let H=0;H<de.length;H+=1)Q(de[H]);P=!1},d($){$&&m(e),je(x,$),je(X,$),je(ce,$),je(de,$),U=!1,at(B)}}}function fa(l,e,t){const s=[{key:"§",code:1,note:""},{key:"1",code:1,note:""},{key:"2",code:1,note:""},{key:"3",code:1,note:""},{key:"4",code:1,note:""},{key:"5",code:1,note:""},{key:"6",code:1,note:""},{key:"7",code:1,note:""},{key:"8",code:1,note:""},{key:"9",code:1,note:""},{key:"0",code:1,note:""},{key:"+",code:1,note:""},{key:"`",code:1,note:""},{key:"Backspace",size:2,code:1,note:""}],n=[{key:"Tab",size:1.5,code:1,note:""},{key:"q",code:1,note:""},{key:"w",code:1,note:"C♯"},{key:"e",code:1,note:"E♭"},{key:"r",code:1,note:""},{key:"t",code:1,note:"F♯"},{key:"y",code:1,note:"G♯"},{key:"u",code:1,note:"B♭"},{key:"i",code:1,note:""},{key:"o",code:1,note:"C♯"},{key:"p",code:1,note:"E♭"},{key:"/",code:1,note:""},{key:";",code:1,note:""},{key:"Enter",size:2,code:1,note:""}],o=[{key:"Caps",size:1.75,code:1,note:""},{key:"a",code:1,note:"C"},{key:"s",code:1,note:"D"},{key:"d",code:1,note:"E"},{key:"f",code:1,note:"F"},{key:"g",code:1,note:"G"},{key:"h",code:1,note:"A"},{key:"j",code:1,note:"B"},{key:"k",code:1,note:"C"},{key:"l",code:1,note:"D"},{key:"ö",code:1,note:"E"},{key:"ä",code:1,note:"F"},{key:"'",code:1,note:""}],a=[{key:"Shift",size:1.5,code:1,note:""},{key:"<",code:1,note:""},{key:"z",code:1,note:""},{key:"x",code:1,note:""},{key:"c",code:1,note:""},{key:"v",code:1,note:""},{key:"b",code:1,note:""},{key:"n",code:1,note:""},{key:"m",code:1,note:""},{key:",",code:1,note:""},{key:".",code:1,note:""},{key:"-",code:1,note:""},{key:"Shift",size:2.5,code:1,note:""}];let r=!0,c=!1;function f(){r=this.checked,t(0,r)}function h(){c=this.checked,t(1,c)}return l.$$set=u=>{t(6,e=Se(Se({},e),Ae(u)))},e=Ae(e),[r,c,s,n,o,a,e,f,h]}class da extends ze{constructor(e){super(),He(this,e,fa,ua,Re,{})}}function rl(l){let e,t;return e=new da({props:{class:"mt-4"}}),{c(){be(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,n){ke(e,s,n),t=!0},i(s){t||(W(e.$$.fragment,s),t=!0)},o(s){Q(e.$$.fragment,s),t=!1},d(s){Ce(e,s)}}}function ha(l){let e,t,s,n,o="I/O",a,r,c,f,h="Device",u,_,y,b,C,p,w="Prompt",A,j,E="Disable",N,I,S,O,D="Sound",R,k,V,P,U,B,M="Fixed velocity",x,re,se,X,fe,Ee,ce="Keyboard",Me,he,de,Fe,$,H,F="Hotkeys",ae,Y,ie,K,J,pe,le="Auto-octave",Te,Ge,lt,qe,Ue,Le,Ie,At="Set keys",bt,xe,ct,_s="Fade timeout",Qt,Ze,Yt,ut,Nt,Xt,ft,ps="Reset all",Zt,jt,We,es,vs,Pe=l[2]&&rl();return{c(){e=v("div"),t=v("fieldset"),s=v("legend"),n=v("button"),n.textContent=o,a=L(),r=v("div"),c=v("div"),f=v("label"),f.textContent=h,u=L(),_=v("input"),b=L(),C=v("div"),p=v("button"),p.textContent=w,A=L(),j=v("button"),j.textContent=E,N=L(),I=v("div"),S=v("div"),O=v("label"),O.textContent=D,R=L(),k=v("input"),P=L(),U=v("div"),B=v("label"),B.textContent=M,x=L(),re=v("input"),se=L(),X=v("div"),fe=v("div"),Ee=v("label"),Ee.textContent=ce,Me=L(),he=v("input"),Fe=L(),$=v("div"),H=v("label"),H.textContent=F,ae=L(),Y=v("input"),K=L(),J=v("div"),pe=v("label"),pe.textContent=le,Te=L(),Ge=v("input"),qe=L(),Ue=v("div"),Le=v("div"),Ie=v("button"),Ie.textContent=At,bt=L(),xe=v("div"),ct=v("label"),ct.textContent=_s,Qt=L(),Ze=v("input"),Yt=L(),ut=v("div"),Nt=v("div"),Xt=L(),ft=v("button"),ft.textContent=ps,Zt=L(),Pe&&Pe.c(),this.h()},l(Ne){e=g(Ne,"DIV",{class:!0});var Ke=T(e);t=g(Ke,"FIELDSET",{class:!0});var ot=T(t);s=g(ot,"LEGEND",{class:!0});var gs=T(s);n=g(gs,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(n)!=="svelte-1jbbsti"&&(n.textContent=o),gs.forEach(m),a=G(ot),r=g(ot,"DIV",{class:!0});var dt=T(r);c=g(dt,"DIV",{class:!0});var yt=T(c);f=g(yt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(f)!=="svelte-crpa7y"&&(f.textContent=h),u=G(yt),_=g(yt,"INPUT",{class:!0,id:!0}),b=G(yt),C=g(yt,"DIV",{class:!0});var Dt=T(C);p=g(Dt,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(p)!=="svelte-mj6mct"&&(p.textContent=w),A=G(Dt),j=g(Dt,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(j)!=="svelte-1sl6oxh"&&(j.textContent=E),Dt.forEach(m),yt.forEach(m),N=G(dt),I=g(dt,"DIV",{class:!0});var Lt=T(I);S=g(Lt,"DIV",{class:!0});var Gt=T(S);O=g(Gt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(O)!=="svelte-wgxtkw"&&(O.textContent=D),R=G(Gt),k=g(Gt,"INPUT",{class:!0,id:!0,type:!0}),Gt.forEach(m),P=G(Lt),U=g(Lt,"DIV",{class:!0});var Pt=T(U);B=g(Pt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(B)!=="svelte-1tm2bth"&&(B.textContent=M),x=G(Pt),re=g(Pt,"INPUT",{class:!0,id:!0,placeholder:!0}),Pt.forEach(m),Lt.forEach(m),se=G(dt),X=g(dt,"DIV",{class:!0});var kt=T(X);fe=g(kt,"DIV",{class:!0});var Bt=T(fe);Ee=g(Bt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(Ee)!=="svelte-1js269u"&&(Ee.textContent=ce),Me=G(Bt),he=g(Bt,"INPUT",{class:!0,id:!0,type:!0}),Bt.forEach(m),Fe=G(kt),$=g(kt,"DIV",{class:!0});var Mt=T($);H=g(Mt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(H)!=="svelte-21h39k"&&(H.textContent=F),ae=G(Mt),Y=g(Mt,"INPUT",{class:!0,id:!0,type:!0}),Mt.forEach(m),K=G(kt),J=g(kt,"DIV",{class:!0});var Vt=T(J);pe=g(Vt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(pe)!=="svelte-33lczu"&&(pe.textContent=le),Te=G(Vt),Ge=g(Vt,"INPUT",{class:!0,id:!0,type:!0}),Vt.forEach(m),kt.forEach(m),qe=G(dt),Ue=g(dt,"DIV",{class:!0});var Ct=T(Ue);Le=g(Ct,"DIV",{class:!0});var bs=T(Le);Ie=g(bs,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(Ie)!=="svelte-1npcis2"&&(Ie.textContent=At),bs.forEach(m),bt=G(Ct),xe=g(Ct,"DIV",{class:!0});var Ot=T(xe);ct=g(Ot,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(ct)!=="svelte-vd5i27"&&(ct.textContent=_s),Qt=G(Ot),Ze=g(Ot,"INPUT",{class:!0,id:!0}),Ot.forEach(m),Yt=G(Ct),ut=g(Ct,"DIV",{class:!0});var Ft=T(ut);Nt=g(Ft,"DIV",{}),T(Nt).forEach(m),Xt=G(Ft),ft=g(Ft,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(ft)!=="svelte-jjt0c3"&&(ft.textContent=ps),Ft.forEach(m),Ct.forEach(m),dt.forEach(m),Zt=G(ot),Pe&&Pe.l(ot),ot.forEach(m),Ke.forEach(m),this.h()},h(){var Ne;d(n,"class","px-1 rounded hover:bg-gray-100"),d(s,"class","text-base"),d(f,"class","font-bold"),d(f,"for","device"),d(_,"class","px-1 my-1 rounded w-50"),d(_,"id","device"),_.disabled=!0,_.value=y=((Ne=l[5])==null?void 0:Ne.name)??"No device",d(p,"class","btn-sm primary mr-2"),d(j,"class","btn-sm primary"),d(C,"class","flex my-[auto]"),d(c,"class","h-full flex flex-col"),d(O,"class","font-bold"),d(O,"for","sound"),d(k,"class","h-[20px]"),d(k,"id","sound"),d(k,"type","checkbox"),k.checked=V=l[3].useSound,d(S,"class","my-1 flex justify-between mr-12"),d(B,"class","font-bold"),d(B,"for","fixed-velocity"),d(re,"class","h-[20px] w-16"),d(re,"id","fixed-velocity"),d(re,"placeholder","0-127"),d(U,"class","flex justify-between"),d(I,"class","flex flex-col h-full"),d(Ee,"class","font-bold"),d(Ee,"for","keyboard"),d(he,"class","h-[20px]"),d(he,"id","keyboard"),d(he,"type","checkbox"),he.checked=de=l[3].useKeyboard,d(fe,"class","my-1 flex justify-between mr-12"),d(H,"class","font-bold"),d(H,"for","hotkeys"),d(Y,"class","h-[20px]"),d(Y,"id","hotkeys"),d(Y,"type","checkbox"),Y.checked=ie=l[3].useHotkeys,d($,"class","my-1 flex justify-between mr-12"),d(pe,"class","font-bold"),d(pe,"for","auto-octave"),d(Ge,"class","h-[20px]"),d(Ge,"id","auto-octave"),d(Ge,"type","checkbox"),Ge.checked=lt=l[3].useAutoOctave,d(J,"class","my-1 flex justify-between mr-12"),d(X,"class","flex flex-col h-full"),d(Ie,"class","w-full btn-sm primary"),d(Le,"class","flex justify-between"),d(ct,"class","font-bold"),d(ct,"for","fade-timeout"),d(Ze,"class","h-[20px] w-16"),d(Ze,"id","fade-timeout"),Ze.value=l[1],d(xe,"class","flex justify-between"),d(ft,"class","btn-sm primary"),d(ut,"class","flex justify-between"),d(Ue,"class","flex flex-col justify-between h-full"),d(r,"class","body svelte-1bpw69s"),Z(r,"hidden",l[4]),d(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-1bpw69s"),Z(t,"collapsed",l[4]),d(e,"class",jt=De(`${l[11].class||""}`)+" svelte-1bpw69s")},m(Ne,Ke){z(Ne,e,Ke),i(e,t),i(t,s),i(s,n),i(t,a),i(t,r),i(r,c),i(c,f),i(c,u),i(c,_),i(c,b),i(c,C),i(C,p),i(C,A),i(C,j),i(r,N),i(r,I),i(I,S),i(S,O),i(S,R),i(S,k),i(I,P),i(I,U),i(U,B),i(U,x),i(U,re),Ye(re,l[0]),i(r,se),i(r,X),i(X,fe),i(fe,Ee),i(fe,Me),i(fe,he),i(X,Fe),i(X,$),i($,H),i($,ae),i($,Y),i(X,K),i(X,J),i(J,pe),i(J,Te),i(J,Ge),i(r,qe),i(r,Ue),i(Ue,Le),i(Le,Ie),i(Ue,bt),i(Ue,xe),i(xe,ct),i(xe,Qt),i(xe,Ze),i(Ue,Yt),i(Ue,ut),i(ut,Nt),i(ut,Xt),i(ut,ft),i(t,Zt),Pe&&Pe.m(t,null),We=!0,es||(vs=[q(n,"click",l[7]),q(p,"click",ge.openMidi),q(j,"click",ge.disableMidi),q(k,"change",l[12]),q(re,"input",l[13]),q(re,"focus",l[14]),q(re,"change",l[8]),q(he,"change",l[15]),q(Y,"change",l[16]),q(Ge,"change",l[17]),q(Ie,"click",l[18]),q(Ze,"focus",l[19]),q(Ze,"blur",l[20]),q(Ze,"input",l[9]),q(ft,"click",l[10])],es=!0)},p(Ne,[Ke]){var ot;(!We||Ke&32&&y!==(y=((ot=Ne[5])==null?void 0:ot.name)??"No device")&&_.value!==y)&&(_.value=y),(!We||Ke&8&&V!==(V=Ne[3].useSound))&&(k.checked=V),Ke&1&&re.value!==Ne[0]&&Ye(re,Ne[0]),(!We||Ke&8&&de!==(de=Ne[3].useKeyboard))&&(he.checked=de),(!We||Ke&8&&ie!==(ie=Ne[3].useHotkeys))&&(Y.checked=ie),(!We||Ke&8&&lt!==(lt=Ne[3].useAutoOctave))&&(Ge.checked=lt),(!We||Ke&2&&Ze.value!==Ne[1])&&(Ze.value=Ne[1]),(!We||Ke&16)&&Z(r,"hidden",Ne[4]),Ne[2]?Pe?Ke&4&&W(Pe,1):(Pe=rl(),Pe.c(),W(Pe,1),Pe.m(t,null)):Pe&&(Je(),Q(Pe,1,1,()=>{Pe=null}),Qe()),(!We||Ke&16)&&Z(t,"collapsed",Ne[4]),(!We||Ke&2048&&jt!==(jt=De(`${Ne[11].class||""}`)+" svelte-1bpw69s"))&&d(e,"class",jt)},i(Ne){We||(W(Pe),We=!0)},o(Ne){Q(Pe),We=!1},d(Ne){Ne&&m(e),Pe&&Pe.d(),es=!1,at(vs)}}}function ma(l,e,t){let s,n,o;me(l,pt,S=>t(3,s=S)),me(l,qt,S=>t(5,o=S));const a=vt(Oe(!1),{key:"inputs-hidden"});me(l,a,S=>t(4,n=S));let r=s.fixedVelocity??"",c=s.keyFadeTimeout,f=!1;pt.subscribe(S=>{t(0,r=S.fixedVelocity??""),t(1,c=S.keyFadeTimeout)});function h(){a.update(S=>!S)}function u(S){const{value:O}=S.currentTarget;let D;if(O)try{D=parseInt(O)}catch{}D!==void 0&&D>=0&&D<=127?ge.setInputValue("fixedVelocity",D):O?t(0,r=s.fixedVelocity||""):ge.setInputValue("fixedVelocity",void 0),ge.setKeyboardFocus(!0)}function _(S){try{const O=parseInt(S.currentTarget.value);ge.setInputValue("keyFadeTimeout",O)}catch{t(1,c=s.keyFadeTimeout)}}function y(){Nn()}const b=S=>ge.setInputValue("useSound",S.currentTarget.checked);function C(){r=this.value,t(0,r)}const p=()=>ge.setKeyboardFocus(!1),w=S=>ge.setInputValue("useKeyboard",S.currentTarget.checked),A=S=>ge.setInputValue("useHotkeys",S.currentTarget.checked),j=S=>ge.setInputValue("useAutoOctave",S.currentTarget.checked),E=()=>t(2,f=!f),N=()=>ge.setKeyboardFocus(!1),I=()=>ge.setKeyboardFocus(!0);return l.$$set=S=>{t(11,e=Se(Se({},e),Ae(S)))},e=Ae(e),[r,c,f,s,n,o,a,h,u,_,y,e,b,C,p,w,A,j,E,N,I]}class _a extends ze{constructor(e){super(),He(this,e,ma,ha,Re,{})}}function pa(l){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,s){z(t,e,s)},p:_e,d(t){t&&m(e)}}}function va(l){let e,t=l[2].note+"",s;return{c(){e=ee("Input: "),s=ee(t)},l(n){e=te(n,"Input: "),s=te(n,t)},m(n,o){z(n,e,o),z(n,s,o)},p(n,o){o&4&&t!==(t=n[2].note+"")&&ue(s,t)},d(n){n&&(m(e),m(s))}}}function ga(l){let e,t;return{c(){e=ee("Input: "),t=ee(l[1])},l(s){e=te(s,"Input: "),t=te(s,l[1])},m(s,n){z(s,e,n),z(s,t,n)},p(s,n){n&2&&ue(t,s[1])},d(s){s&&(m(e),m(t))}}}function ba(l){let e;return{c(){e=ee(l[0])},l(t){e=te(t,l[0])},m(t,s){z(t,e,s)},p(t,s){s&1&&ue(e,t[0])},d(t){t&&m(e)}}}function ya(l){let e,t,s,n;function o(c,f){return c[3].useKeyboard&&c[0]?ba:c[3].useKeyboard&&c[1]?ga:c[3].useKeyboard&&c[2]?va:pa}let a=o(l),r=a(l);return{c(){e=v("div"),r.c(),this.h()},l(c){e=g(c,"DIV",{class:!0});var f=T(e);r.l(f),f.forEach(m),this.h()},h(){d(e,"class",t=`${l[5].class||""}`)},m(c,f){z(c,e,f),r.m(e,null),s||(n=q(window,"keydown",l[4]),s=!0)},p(c,[f]){a===(a=o(c))&&r?r.p(c,f):(r.d(1),r=a(c),r&&(r.c(),r.m(e,null))),f&32&&t!==(t=`${c[5].class||""}`)&&d(e,"class",t)},i:_e,o:_e,d(c){c&&m(e),r.d(),s=!1,n()}}}const ka=/^[a-gA-G]$/,Ca=/^[♭Bb#♯sS]$/,Ea=/^[0-9]$/;function wa(l,e,t){let s,n,o,a,r;me(l,pt,C=>t(3,s=C)),me(l,Yl,C=>t(7,n=C)),me(l,_t,C=>t(8,o=C)),me(l,Ql,C=>t(9,a=C)),me(l,Wt,C=>t(10,r=C));let{debounced:c}=e;const f=ln();let h="",u="",_;function y(C){const p=C.key.toUpperCase(),w=n;let A;if(!_&&s.useHotkeys&&p in w){const j=w[p];t(2,_=j),t(0,h=""),s.useAutoOctave&&(A=Wl(r[0].midi))}else!s.useHotkeys&&u.length===0&&ka.test(p)?t(1,u+=p):!s.useHotkeys&&u.length>0&&Ca.test(p)&&(p==="B"?t(1,u+="♭"):t(1,u+="♯"));if(Ea.test(p))try{A=parseInt(p)}catch{}if(_&&A!==void 0){const j=_.semitones+(A+1+(C.shiftKey?1:0))*12;f("note",j),t(2,_=void 0)}else if(u&&A!==void 0){const j=ve.findNote(u),E=j?j.semitones+(A+1)*12:void 0;E!==void 0&&f("note",E),t(1,u="")}else C.key==="Backspace"&&(t(2,_=void 0),t(1,u=u.slice(0,-1)))}function b(C){if(c||!a)return;const p=o;if(p instanceof It){const w=C.key.toUpperCase(),A=n;if(u.length===0&&w in A){const j=A[w].note;f("guessed-key",j),t(1,u="")}else C.key==="Backspace"&&t(1,u=u.slice(0,-1))}else if(p instanceof rt&&p.type==="chords-write")if(C.key==="Enter"&&u.length>0){let w={note:"",flats:0,sharps:0,chord:""};for(let A=0;A<u.length;A+=1)A===0?w.note+=u[A]:w.chord.length>0?w.chord+=u[A]:u[A]==="b"||u[A]==="♭"?w.flats+=1:u[A]==="#"||u[A]==="♯"?w.sharps+=1:w.chord+=u[A];f("guessed-chord",w),t(1,u="")}else C.key==="Backspace"?t(1,u=u.slice(0,-1)):C.key.length===1&&(t(1,u+=C.key),u.length===1&&t(1,u=u.toUpperCase()));else s.useKeyboard&&y(C)}return l.$$set=C=>{t(5,e=Se(Se({},e),Ae(C))),"debounced"in C&&t(6,c=C.debounced)},e=Ae(e),[h,u,_,s,b,e,c]}class Sa extends ze{constructor(e){super(),He(this,e,wa,ya,Re,{debounced:6})}}function Aa(l){let e,t,s,n="Count",o,a,r,c,f,h="Duplicates",u,_,y,b,C,p,w="Autoplay",A,j,E,N,I,S,O="Wait seconds",D,R,k,V,P;return{c(){e=v("ul"),t=v("li"),s=v("label"),s.textContent=n,o=L(),a=v("input"),r=L(),c=v("li"),f=v("label"),f.textContent=h,u=L(),_=v("input"),b=L(),C=v("li"),p=v("label"),p.textContent=w,A=L(),j=v("input"),N=L(),I=v("li"),S=v("label"),S.textContent=O,D=L(),R=v("input"),this.h()},l(U){e=g(U,"UL",{class:!0});var B=T(e);t=g(B,"LI",{class:!0});var M=T(t);s=g(M,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(s)!=="svelte-wgq9fc"&&(s.textContent=n),o=G(M),a=g(M,"INPUT",{class:!0,id:!0,type:!0}),M.forEach(m),r=G(B),c=g(B,"LI",{class:!0});var x=T(c);f=g(x,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(f)!=="svelte-hcg9dq"&&(f.textContent=h),u=G(x),_=g(x,"INPUT",{class:!0,id:!0,type:!0}),x.forEach(m),b=G(B),C=g(B,"LI",{class:!0});var re=T(C);p=g(re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(p)!=="svelte-lr68n2"&&(p.textContent=w),A=G(re),j=g(re,"INPUT",{class:!0,id:!0,type:!0}),re.forEach(m),N=G(B),I=g(B,"LI",{class:!0});var se=T(I);S=g(se,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(S)!=="svelte-1qj2vcy"&&(S.textContent=O),D=G(se),R=g(se,"INPUT",{class:!0,id:!0,type:!0}),se.forEach(m),B.forEach(m),this.h()},h(){d(s,"class","font-bold"),d(s,"for","guess-count"),d(a,"class","h-[20px] w-10"),d(a,"id","guess-count"),d(a,"type","number"),d(t,"class","flex items-center justify-between svelte-1elvih2"),d(f,"class","font-bold"),d(f,"for","duplicates"),d(_,"class","h-[20px]"),d(_,"id","duplicates"),d(_,"type","checkbox"),_.checked=y=l[2].duplicates,d(c,"class","flex items-center justify-between mr-6 svelte-1elvih2"),d(p,"class","font-bold"),d(p,"for","autoplay"),d(j,"class","h-[20px]"),d(j,"id","autoplay"),d(j,"type","checkbox"),j.checked=E=l[2].autoplay,d(C,"class","flex items-center justify-between mr-6 svelte-1elvih2"),d(S,"class","font-bold"),d(S,"for","wait-ms"),d(R,"class","h-[20px] w-10"),d(R,"id","wait-ms"),d(R,"type","number"),d(I,"class","flex items-center justify-between svelte-1elvih2"),d(e,"class",k=De(`${l[5].class||""}`)+" svelte-1elvih2")},m(U,B){z(U,e,B),i(e,t),i(t,s),i(t,o),i(t,a),Ye(a,l[0]),i(e,r),i(e,c),i(c,f),i(c,u),i(c,_),i(e,b),i(e,C),i(C,p),i(C,A),i(C,j),i(e,N),i(e,I),i(I,S),i(I,D),i(I,R),Ye(R,l[1]),V||(P=[q(a,"input",l[6]),q(a,"input",l[3]),q(_,"input",l[7]),q(j,"input",l[8]),q(R,"input",l[9]),q(R,"input",l[4])],V=!0)},p(U,[B]){B&1&&$t(a.value)!==U[0]&&Ye(a,U[0]),B&4&&y!==(y=U[2].duplicates)&&(_.checked=y),B&4&&E!==(E=U[2].autoplay)&&(j.checked=E),B&2&&$t(R.value)!==U[1]&&Ye(R,U[1]),B&32&&k!==(k=De(`${U[5].class||""}`)+" svelte-1elvih2")&&d(e,"class",k)},i:_e,o:_e,d(U){U&&m(e),V=!1,at(P)}}}function Ta(l,e,t){let s;me(l,it,_=>t(2,s=_));let n=s.count||"",o=s.waitSeconds||"";it.subscribe(_=>{t(0,n=_.count||""),t(1,o=_.waitSeconds||"")});function a({currentTarget:{value:_}}){let y;try{y=parseInt(_),y<=0&&(y=1),we.setOptionValue("count",y)}catch{t(0,n=s.count)}}function r({currentTarget:{value:_}}){let y;try{y=parseInt(_),y<0&&(y=0),we.setOptionValue("waitSeconds",y)}catch{t(1,o=s.waitSeconds)}}function c(){n=$t(this.value),t(0,n)}const f=_=>we.setOptionValue("duplicates",_.currentTarget.checked),h=_=>we.setOptionValue("autoplay",_.currentTarget.checked);function u(){o=$t(this.value),t(1,o)}return l.$$set=_=>{t(5,e=Se(Se({},e),Ae(_)))},e=Ae(e),[n,o,s,a,r,e,c,f,h,u]}class Ia extends ze{constructor(e){super(),He(this,e,Ta,Aa,Re,{})}}function il(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function cl(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function ul(l){let e,t,s=l[21]+"",n,o,a,r,c,f,h,u;function _(){return l[13](l[20])}r=new nt({props:{icon:ns,width:20}});function y(...b){return l[14](l[20],...b)}return{c(){e=v("li"),t=v("button"),n=ee(s),o=L(),a=v("button"),be(r.$$.fragment),c=L(),this.h()},l(b){e=g(b,"LI",{class:!0});var C=T(e);t=g(C,"BUTTON",{class:!0});var p=T(t);n=te(p,s),p.forEach(m),o=G(C),a=g(C,"BUTTON",{class:!0});var w=T(a);ye(r.$$.fragment,w),w.forEach(m),c=G(C),C.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-vja54t"),Z(t,"selected",l[20]===l[0]),d(a,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),d(e,"class","flex svelte-vja54t")},m(b,C){z(b,e,C),i(e,t),i(t,n),i(e,o),i(e,a),ke(r,a,null),i(e,c),f=!0,h||(u=[q(t,"click",_),q(a,"click",y)],h=!0)},p(b,C){l=b,(!f||C&17)&&Z(t,"selected",l[20]===l[0])},i(b){f||(W(r.$$.fragment,b),f=!0)},o(b){Q(r.$$.fragment,b),f=!1},d(b){b&&m(e),Ce(r),h=!1,at(u)}}}function fl(l){let e,t=oe(l[2]),s=[];for(let n=0;n<t.length;n+=1)s[n]=dl(il(l,t,n));return{c(){e=v("ul");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=g(n,"UL",{class:!0});var o=T(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","svelte-vja54t")},m(n,o){z(n,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,o){if(o&518){t=oe(n[2]);let a;for(a=0;a<t.length;a+=1){const r=il(n,t,a);s[a]?s[a].p(r,o):(s[a]=dl(r),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function dl(l){let e,t,s=l[21]+"",n,o,a,r;function c(){return l[15](l[20])}return{c(){e=v("li"),t=v("button"),n=ee(s),o=L(),this.h()},l(f){e=g(f,"LI",{class:!0});var h=T(e);t=g(h,"BUTTON",{class:!0});var u=T(t);n=te(u,s),u.forEach(m),o=G(h),h.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-vja54t"),Z(t,"selected",l[20]===l[1]),d(e,"class","svelte-vja54t")},m(f,h){z(f,e,h),i(e,t),i(t,n),i(e,o),a||(r=q(t,"click",c),a=!0)},p(f,h){l=f,h&4&&s!==(s=l[21]+"")&&ue(n,s),h&6&&Z(t,"selected",l[20]===l[1])},d(f){f&&m(e),a=!1,r()}}}function Na(l){let e,t,s="Play",n,o,a,r,c,f,h,u,_,y,b,C="Reset",p,w,A,j,E=l[3]?"Quit":"Play",N,I,S,O,D,R=oe(l[4]),k=[];for(let U=0;U<R.length;U+=1)k[U]=ul(cl(l,R,U));const V=U=>Q(k[U],1,1,()=>{k[U]=null});let P=(l[0]==="chords-write"||l[0]==="chords-play")&&fl(l);return u=new Ia({}),A=new nt({props:{class:"mr-1",icon:l[3]?Ss:ns,width:20}}),{c(){e=v("fieldset"),t=v("legend"),t.textContent=s,n=L(),o=v("div"),a=v("ul");for(let U=0;U<k.length;U+=1)k[U].c();r=L(),c=v("div"),P&&P.c(),f=L(),h=v("div"),be(u.$$.fragment),_=L(),y=v("div"),b=v("button"),b.textContent=C,p=L(),w=v("button"),be(A.$$.fragment),j=L(),N=ee(E),this.h()},l(U){e=g(U,"FIELDSET",{class:!0});var B=T(e);t=g(B,"LEGEND",{class:!0,"data-svelte-h":!0}),ne(t)!=="svelte-1409tnk"&&(t.textContent=s),n=G(B),o=g(B,"DIV",{class:!0});var M=T(o);a=g(M,"UL",{class:!0});var x=T(a);for(let Ee=0;Ee<k.length;Ee+=1)k[Ee].l(x);x.forEach(m),r=G(M),c=g(M,"DIV",{});var re=T(c);P&&P.l(re),re.forEach(m),f=G(M),h=g(M,"DIV",{class:!0});var se=T(h);ye(u.$$.fragment,se),_=G(se),y=g(se,"DIV",{});var X=T(y);b=g(X,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(b)!=="svelte-10rv0bu"&&(b.textContent=C),p=G(X),w=g(X,"BUTTON",{class:!0});var fe=T(w);ye(A.$$.fragment,fe),j=G(fe),N=te(fe,E),fe.forEach(m),X.forEach(m),se.forEach(m),M.forEach(m),B.forEach(m),this.h()},h(){d(t,"class","px-1 text-base"),d(a,"class","options svelte-vja54t"),d(b,"class","w-full btn hover:bg-gray-200"),d(w,"class","w-full mt-2 flex items-center justify-center btn primary"),d(h,"class","h-full flex flex-col justify-between"),d(o,"class","body pb-2 h-full svelte-vja54t"),d(e,"class",I=De(`${l[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-vja54t")},m(U,B){z(U,e,B),i(e,t),i(e,n),i(e,o),i(o,a);for(let M=0;M<k.length;M+=1)k[M]&&k[M].m(a,null);i(o,r),i(o,c),P&&P.m(c,null),i(o,f),i(o,h),ke(u,h,null),i(h,_),i(h,y),i(y,b),i(y,p),i(y,w),ke(A,w,null),i(w,j),i(w,N),S=!0,O||(D=[q(b,"click",l[5]),q(w,"click",l[16])],O=!0)},p(U,[B]){if(B&401){R=oe(U[4]);let x;for(x=0;x<R.length;x+=1){const re=cl(U,R,x);k[x]?(k[x].p(re,B),W(k[x],1)):(k[x]=ul(re),k[x].c(),W(k[x],1),k[x].m(a,null))}for(Je(),x=R.length;x<k.length;x+=1)V(x);Qe()}U[0]==="chords-write"||U[0]==="chords-play"?P?P.p(U,B):(P=fl(U),P.c(),P.m(c,null)):P&&(P.d(1),P=null);const M={};B&8&&(M.icon=U[3]?Ss:ns),A.$set(M),(!S||B&8)&&E!==(E=U[3]?"Quit":"Play")&&ue(N,E),(!S||B&1024&&I!==(I=De(`${U[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-vja54t"))&&d(e,"class",I)},i(U){if(!S){for(let B=0;B<R.length;B+=1)W(k[B]);W(u.$$.fragment,U),W(A.$$.fragment,U),S=!0}},o(U){k=k.filter(Boolean);for(let B=0;B<k.length;B+=1)Q(k[B]);Q(u.$$.fragment,U),Q(A.$$.fragment,U),S=!1},d(U){U&&m(e),je(k,U),P&&P.d(),Ce(u),Ce(A),O=!1,at(D)}}}function ja(l,e,t){let s,n,o,a,r;me(l,ms,E=>t(12,o=E)),me(l,it,E=>t(19,a=E)),me(l,_t,E=>t(3,r=E));const c=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let f=c[4].key,h="maj-m";a.count,a.waitSeconds,it.subscribe(E=>{E.count,E.waitSeconds});function u(){we.clearGame(!0)}function _(E,N){if(N==="chords-write"||N==="chords-play"||N==="chords-diatonic"){let I=[];h==="selected"?I=o.filter(S=>S.selected):h==="all"?I=o:h==="maj-m"?I=o.filter(S=>S.suffixes[0]==="maj"||S.suffixes[0]==="m"):h==="seventh"&&(I=o.filter(S=>S.suffixes[0]==="maj7"||S.suffixes[0]==="m7"||S.suffixes[0]==="7"||S.suffixes[0]==="dim7"||S.suffixes[0]==="aug7")),we.play(N,{chords:I})}else we.play(N,void 0);E.currentTarget instanceof HTMLElement&&E.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function y(E){t(0,f=E)}function b(E,N){t(0,f=N),_(E,N)}function C(E){t(1,h=E)}const p=E=>y(E),w=(E,N)=>b(N,E),A=E=>C(E),j=E=>_(E,f);return l.$$set=E=>{t(10,e=Se(Se({},e),Ae(E)))},l.$$.update=()=>{l.$$.dirty&4096&&t(11,s=o.reduce((E,N)=>N.selected?E+1:E,0)),l.$$.dirty&2048&&t(2,n=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${s} chords`},{key:"all",value:"All"}])},e=Ae(e),[f,h,n,r,c,u,_,y,b,C,e,s,o,p,w,A,j]}class Da extends ze{constructor(e){super(),He(this,e,ja,Na,Re,{})}}function hl(l,e,t){const s=l.slice();return s[7]=e[t],s}function ml(l,e,t){const s=l.slice();return s[4]=e[t],s}function La(l){let e,t=oe(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=_l(hl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Ve()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=Ve()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);z(n,e,o)},p(n,o){if(o&2){t=oe(n[1]);let a;for(a=0;a<t.length;a+=1){const r=hl(n,t,a);s[a]?s[a].p(r,o):(s[a]=_l(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Ga(l){let e,t=oe(l[0].scaleNotes||[]),s=[];for(let n=0;n<t.length;n+=1)s[n]=pl(ml(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Ve()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=Ve()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);z(n,e,o)},p(n,o){if(o&1){t=oe(n[0].scaleNotes||[]);let a;for(a=0;a<t.length;a+=1){const r=ml(n,t,a);s[a]?s[a].p(r,o):(s[a]=pl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function _l(l){let e,t=l[7].interval+"",s;return{c(){e=v("span"),s=ee(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=te(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-my4m0t")},m(n,o){z(n,e,o),i(e,s)},p(n,o){o&2&&t!==(t=n[7].interval+"")&&ue(s,t)},d(n){n&&m(e)}}}function pl(l){let e,t=l[4].note+"",s;return{c(){e=v("span"),s=ee(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=te(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-my4m0t")},m(n,o){z(n,e,o),i(e,s)},p(n,o){o&1&&t!==(t=n[4].note+"")&&ue(s,t)},d(n){n&&m(e)}}}function Pa(l){let e,t,s,n,o,a;function r(h,u){return h[0]?Ga:La}let c=r(l),f=c(l);return{c(){e=v("div"),t=v("button"),f.c(),this.h()},l(h){e=g(h,"DIV",{class:!0,title:!0});var u=T(e);t=g(u,"BUTTON",{class:!0});var _=T(t);f.l(_),_.forEach(m),u.forEach(m),this.h()},h(){d(t,"class","intervals svelte-my4m0t"),d(e,"class",s=`${l[2].class||""} `),d(e,"title",n=l[1].map(vl).join("-"))},m(h,u){z(h,e,u),i(e,t),f.m(t,null),o||(a=q(t,"click",l[3]),o=!0)},p(h,[u]){c===(c=r(h))&&f?f.p(h,u):(f.d(1),f=c(h),f&&(f.c(),f.m(t,null))),u&4&&s!==(s=`${h[2].class||""} `)&&d(e,"class",s),u&2&&n!==(n=h[1].map(vl).join("-"))&&d(e,"title",n)},i:_e,o:_e,d(h){h&&m(e),f.d(),o=!1,a()}}}const vl=l=>l.interval;function Ba(l,e,t){let{scale:s,intervals:n}=e;function o(a){us.call(this,l,a)}return l.$$set=a=>{t(2,e=Se(Se({},e),Ae(a))),"scale"in a&&t(0,s=a.scale),"intervals"in a&&t(1,n=a.intervals)},e=Ae(e),[s,n,e,o]}class Zl extends ze{constructor(e){super(),He(this,e,Ba,Pa,Re,{scale:0,intervals:1})}}function gl(l,e,t){const s=l.slice();return s[7]=e[t],s}function bl(l,e,t){const s=l.slice();return s[4]=e[t],s}function Ma(l){let e,t=oe(l[0]),s=[];for(let n=0;n<t.length;n+=1)s[n]=yl(gl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Ve()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=Ve()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);z(n,e,o)},p(n,o){if(o&1){t=oe(n[0]);let a;for(a=0;a<t.length;a+=1){const r=gl(n,t,a);s[a]?s[a].p(r,o):(s[a]=yl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Va(l){let e,t=oe(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=kl(bl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Ve()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=Ve()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);z(n,e,o)},p(n,o){if(o&2){t=oe(n[1]);let a;for(a=0;a<t.length;a+=1){const r=bl(n,t,a);s[a]?s[a].p(r,o):(s[a]=kl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function yl(l){let e,t,s=l[7].roman+"",n,o,a,r=l[7].suffix+"",c,f;return{c(){e=v("span"),t=v("span"),n=ee(s),o=L(),a=v("sup"),c=ee(r),f=L(),this.h()},l(h){e=g(h,"SPAN",{class:!0});var u=T(e);t=g(u,"SPAN",{class:!0});var _=T(t);n=te(_,s),_.forEach(m),o=G(u),a=g(u,"SUP",{class:!0});var y=T(a);c=te(y,r),y.forEach(m),f=G(u),u.forEach(m),this.h()},h(){d(t,"class","block"),d(a,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),Z(a,"super-text",l[7].suffix.length>2),d(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(h,u){z(h,e,u),i(e,t),i(t,n),i(e,o),i(e,a),i(a,c),i(e,f)},p(h,u){u&1&&s!==(s=h[7].roman+"")&&ue(n,s),u&1&&r!==(r=h[7].suffix+"")&&ue(c,r),u&1&&Z(a,"super-text",h[7].suffix.length>2)},d(h){h&&m(e)}}}function kl(l){let e,t,s=l[4]+"",n,o;return{c(){e=v("span"),t=v("span"),n=ee(s),o=L(),this.h()},l(a){e=g(a,"SPAN",{class:!0});var r=T(e);t=g(r,"SPAN",{});var c=T(t);n=te(c,s),c.forEach(m),o=G(r),r.forEach(m),this.h()},h(){d(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(a,r){z(a,e,r),i(e,t),i(t,n),i(e,o)},p(a,r){r&2&&s!==(s=a[4]+"")&&ue(n,s)},d(a){a&&m(e)}}}function Oa(l){let e,t,s,n,o,a;function r(h,u){return h[1].length>0?Va:Ma}let c=r(l),f=c(l);return{c(){e=v("div"),t=v("button"),f.c(),this.h()},l(h){e=g(h,"DIV",{class:!0,title:!0});var u=T(e);t=g(u,"BUTTON",{class:!0});var _=T(t);f.l(_),_.forEach(m),u.forEach(m),this.h()},h(){d(t,"class","triads flex flex-wrap svelte-1roj1mi"),d(e,"class",s=De(`${l[2].class||""} `)+" svelte-1roj1mi"),d(e,"title",n=l[0].map(Cl).join("-"))},m(h,u){z(h,e,u),i(e,t),f.m(t,null),o||(a=q(t,"click",l[3]),o=!0)},p(h,[u]){c===(c=r(h))&&f?f.p(h,u):(f.d(1),f=c(h),f&&(f.c(),f.m(t,null))),u&4&&s!==(s=De(`${h[2].class||""} `)+" svelte-1roj1mi")&&d(e,"class",s),u&1&&n!==(n=h[0].map(Cl).join("-"))&&d(e,"title",n)},i:_e,o:_e,d(h){h&&m(e),f.d(),o=!1,a()}}}const Cl=l=>l.roman+l.suffix;function Fa(l,e,t){let{triads:s,chords:n}=e;function o(a){us.call(this,l,a)}return l.$$set=a=>{t(2,e=Se(Se({},e),Ae(a))),"triads"in a&&t(0,s=a.triads),"chords"in a&&t(1,n=a.chords)},e=Ae(e),[s,n,e,o]}class en extends ze{constructor(e){super(),He(this,e,Fa,Oa,Re,{triads:0,chords:1})}}function El(l,e,t){const s=l.slice();return s[25]=e[t],s}function wl(l,e,t){const s=l.slice();return s[25]=e[t],s}function Sl(l){let e,t,s=l[25].raw.names[0]+"",n,o,a,r,c,f,h;function u(){return l[13](l[25])}a=new Zl({props:{scale:l[25].scale,intervals:l[25].raw.intervals}}),a.$on("click",u);function _(){return l[14](l[25])}return c=new en({props:{triads:l[25].triads,chords:l[25].triadChords}}),c.$on("click",_),{c(){e=v("li"),t=v("div"),n=ee(s),o=L(),be(a.$$.fragment),r=L(),be(c.$$.fragment),f=L(),this.h()},l(y){e=g(y,"LI",{class:!0});var b=T(e);t=g(b,"DIV",{class:!0});var C=T(t);n=te(C,s),C.forEach(m),o=G(b),ye(a.$$.fragment,b),r=G(b),ye(c.$$.fragment,b),f=G(b),b.forEach(m),this.h()},h(){d(t,"class","text-xs font-bold"),d(e,"class","svelte-4hctsl")},m(y,b){z(y,e,b),i(e,t),i(t,n),i(e,o),ke(a,e,null),i(e,r),ke(c,e,null),i(e,f),h=!0},p(y,b){l=y,(!h||b&4)&&s!==(s=l[25].raw.names[0]+"")&&ue(n,s);const C={};b&4&&(C.scale=l[25].scale),b&4&&(C.intervals=l[25].raw.intervals),a.$set(C);const p={};b&4&&(p.triads=l[25].triads),b&4&&(p.chords=l[25].triadChords),c.$set(p)},i(y){h||(W(a.$$.fragment,y),W(c.$$.fragment,y),h=!0)},o(y){Q(a.$$.fragment,y),Q(c.$$.fragment,y),h=!1},d(y){y&&m(e),Ce(a),Ce(c)}}}function Al(l){let e,t,s=l[25].raw.names[0]+"",n,o,a,r,c,f,h;function u(){return l[15](l[25])}a=new Zl({props:{scale:l[25].scale,intervals:l[25].raw.intervals}}),a.$on("click",u);function _(){return l[16](l[25])}return c=new en({props:{triads:l[25].triads,chords:l[25].triadChords}}),c.$on("click",_),{c(){e=v("li"),t=v("div"),n=ee(s),o=L(),be(a.$$.fragment),r=L(),be(c.$$.fragment),f=L(),this.h()},l(y){e=g(y,"LI",{class:!0});var b=T(e);t=g(b,"DIV",{class:!0});var C=T(t);n=te(C,s),C.forEach(m),o=G(b),ye(a.$$.fragment,b),r=G(b),ye(c.$$.fragment,b),f=G(b),b.forEach(m),this.h()},h(){d(t,"class","text-xs font-bold"),d(e,"class","svelte-4hctsl")},m(y,b){z(y,e,b),i(e,t),i(t,n),i(e,o),ke(a,e,null),i(e,r),ke(c,e,null),i(e,f),h=!0},p(y,b){l=y,(!h||b&2)&&s!==(s=l[25].raw.names[0]+"")&&ue(n,s);const C={};b&2&&(C.scale=l[25].scale),b&2&&(C.intervals=l[25].raw.intervals),a.$set(C);const p={};b&2&&(p.triads=l[25].triads),b&2&&(p.chords=l[25].triadChords),c.$set(p)},i(y){h||(W(a.$$.fragment,y),W(c.$$.fragment,y),h=!0)},o(y){Q(a.$$.fragment,y),Q(c.$$.fragment,y),h=!1},d(y){y&&m(e),Ce(a),Ce(c)}}}function Ua(l){let e,t,s,n,o="Scales",a,r,c,f,h="Key",u,_,y,b,C,p,w,A,j,E,N=oe(l[2]),I=[];for(let k=0;k<N.length;k+=1)I[k]=Sl(wl(l,N,k));const S=k=>Q(I[k],1,1,()=>{I[k]=null});let O=oe(l[1]),D=[];for(let k=0;k<O.length;k+=1)D[k]=Al(El(l,O,k));const R=k=>Q(D[k],1,1,()=>{D[k]=null});return{c(){e=v("div"),t=v("fieldset"),s=v("legend"),n=v("button"),n.textContent=o,a=L(),r=v("div"),c=v("div"),f=v("label"),f.textContent=h,u=L(),_=v("input"),y=L(),b=v("ul");for(let k=0;k<I.length;k+=1)I[k].c();C=L(),p=v("ul");for(let k=0;k<D.length;k+=1)D[k].c();this.h()},l(k){e=g(k,"DIV",{class:!0});var V=T(e);t=g(V,"FIELDSET",{class:!0});var P=T(t);s=g(P,"LEGEND",{class:!0});var U=T(s);n=g(U,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(n)!=="svelte-lhx60e"&&(n.textContent=o),U.forEach(m),a=G(P),r=g(P,"DIV",{class:!0});var B=T(r);c=g(B,"DIV",{class:!0});var M=T(c);f=g(M,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(f)!=="svelte-14m38zf"&&(f.textContent=h),u=G(M),_=g(M,"INPUT",{class:!0,id:!0}),M.forEach(m),y=G(B),b=g(B,"UL",{class:!0});var x=T(b);for(let se=0;se<I.length;se+=1)I[se].l(x);x.forEach(m),C=G(B),p=g(B,"UL",{class:!0});var re=T(p);for(let se=0;se<D.length;se+=1)D[se].l(re);re.forEach(m),B.forEach(m),P.forEach(m),V.forEach(m),this.h()},h(){d(n,"class","px-1 rounded hover:bg-gray-100"),d(s,"class","text-base"),d(f,"class","mr-4 font-bold"),d(f,"for","scale-key"),d(_,"class","bg-gray-100 w-16 px-1 rounded"),d(_,"id","scale-key"),_.value=l[0],d(c,"class","flex w-1/2 mb-2 input svelte-4hctsl"),d(b,"class","list odd w-full svelte-4hctsl"),d(p,"class","list even w-full svelte-4hctsl"),d(r,"class","body svelte-4hctsl"),Z(r,"hidden",l[3]),d(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-4hctsl"),Z(t,"collapsed",l[3]),d(e,"class",w=De(`${l[9].class||""}`)+" svelte-4hctsl")},m(k,V){z(k,e,V),i(e,t),i(t,s),i(s,n),i(t,a),i(t,r),i(r,c),i(c,f),i(c,u),i(c,_),i(r,y),i(r,b);for(let P=0;P<I.length;P+=1)I[P]&&I[P].m(b,null);i(r,C),i(r,p);for(let P=0;P<D.length;P+=1)D[P]&&D[P].m(p,null);A=!0,j||(E=[q(n,"click",l[5]),q(_,"input",l[6]),q(_,"focus",l[11]),q(_,"blur",l[12])],j=!0)},p(k,[V]){if((!A||V&1&&_.value!==k[0])&&(_.value=k[0]),V&388){N=oe(k[2]);let P;for(P=0;P<N.length;P+=1){const U=wl(k,N,P);I[P]?(I[P].p(U,V),W(I[P],1)):(I[P]=Sl(U),I[P].c(),W(I[P],1),I[P].m(b,null))}for(Je(),P=N.length;P<I.length;P+=1)S(P);Qe()}if(V&386){O=oe(k[1]);let P;for(P=0;P<O.length;P+=1){const U=El(k,O,P);D[P]?(D[P].p(U,V),W(D[P],1)):(D[P]=Al(U),D[P].c(),W(D[P],1),D[P].m(p,null))}for(Je(),P=O.length;P<D.length;P+=1)R(P);Qe()}(!A||V&8)&&Z(r,"hidden",k[3]),(!A||V&8)&&Z(t,"collapsed",k[3]),(!A||V&512&&w!==(w=De(`${k[9].class||""}`)+" svelte-4hctsl"))&&d(e,"class",w)},i(k){if(!A){for(let V=0;V<N.length;V+=1)W(I[V]);for(let V=0;V<O.length;V+=1)W(D[V]);A=!0}},o(k){I=I.filter(Boolean);for(let V=0;V<I.length;V+=1)Q(I[V]);D=D.filter(Boolean);for(let V=0;V<D.length;V+=1)Q(D[V]);A=!1},d(k){k&&m(e),je(I,k),je(D,k),j=!1,at(E)}}}function xa(l,e,t){let s,n,o,a,r,c,f;me(l,Wt,k=>t(19,o=k)),me(l,St,k=>t(20,a=k)),me(l,pt,k=>t(21,r=k)),me(l,st,k=>t(22,c=k));let u=fs().map(k=>({key:k.names[0],raw:k,scale:void 0,triads:k.triads,triadChords:[]})),_="",y=[a.key,a.scale],b;const C=vt(Oe(!0),{key:"scales-hidden"});me(l,C,k=>t(3,f=k));function p(){C.update(k=>!k)}function w({currentTarget:{value:k}}){t(0,_=`${k.charAt(0).toUpperCase()}${k.charAt(1).toLowerCase()}`),t(10,u=u.map(V=>{const P=Rt(_,V.key),U=_&&"data"in P?P.data:void 0;let B=[];return U&&(B=V.triads.map((M,x)=>`${U.scaleNotes[x].note}${!M.suffix.includes("°")&&M.minor?"m":""}${M.suffix}`)),{...V,scale:U,triadChords:B}}))}function A(k,V,P){if(k<V.length){const U=V[k++];ve.setPlayed(U),c==null||c.playChord(U.map(B=>B.midi),r.fixedVelocity),b=setTimeout(()=>A(k,V,P),P)}else ve.setPlayed([]),ve.setKeyAndScale(y[0],y[1])}function j(k){clearTimeout(b);let V,P;k.scale?(P=k.scale,y=[a.key,a.scale],ve.setKeyAndScale(k.scale.key,k.scale.scale)):P=a;const U=o[0].midi+P.scaleNotes[0].semitones;V=k.raw.intervals.map(B=>[{...P.notesMap.get(B.semitones%12),midi:U+B.semitones}]),V[0][0].semitones!==V[V.length-1][0].semitones&&V.push(V[0].map(B=>({...B,midi:B.midi+12}))),A(0,V,500)}function E(k){clearTimeout(b);const{intervals:V}=k.raw;let P,U;k.scale?(U=k.scale,y=[a.key,a.scale],ve.setKeyAndScale(k.scale.key,k.scale.scale)):U=a;const B=o[0].midi+U.scaleNotes[0].semitones;P=ql(k.triads).map((x,re)=>as(B+U.intervals[re].semitones,U,x.intervals)),V[V.length-1].interval_seq!==1&&P.push(P[0].map(x=>({...x,midi:x.midi+12}))),A(0,P,750)}const N=()=>ge.setKeyboardFocus(!1),I=()=>ge.setKeyboardFocus(!0),S=k=>j(k),O=k=>E(k),D=k=>j(k),R=k=>E(k);return l.$$set=k=>{t(9,e=Se(Se({},e),Ae(k)))},l.$$.update=()=>{l.$$.dirty&1024&&t(2,s=u.filter((k,V)=>V<u.length/2)),l.$$.dirty&1024&&t(1,n=u.filter((k,V)=>V>=u.length/2))},e=Ae(e),[_,n,s,f,C,p,w,j,E,e,u,N,I,S,O,D,R]}class Ka extends ze{constructor(e){super(),He(this,e,xa,Ua,Re,{})}}function Tl(l,e,t){const s=l.slice();return s[14]=e[t].key,s[15]=e[t].value,s[16]=e[t].icon,s[18]=t,s}const $a=l=>({}),Il=l=>({}),za=l=>({}),Nl=l=>({});function jl(l){let e,t,s,n,o,a,r,c,f,h;const u=l[11].header,_=Fl(u,l,l[10],Il);let y=oe(l[0]),b=[];for(let p=0;p<y.length;p+=1)b[p]=Dl(Tl(l,y,p));const C=p=>Q(b[p],1,1,()=>{b[p]=null});return{c(){e=v("button"),s=L(),n=v("ul"),o=v("li"),_&&_.c(),a=L();for(let p=0;p<b.length;p+=1)b[p].c();this.h()},l(p){e=g(p,"BUTTON",{class:!0,tabindex:!0}),T(e).forEach(m),s=G(p),n=g(p,"UL",{class:!0});var w=T(n);o=g(w,"LI",{});var A=T(o);_&&_.l(A),A.forEach(m),a=G(w);for(let j=0;j<b.length;j+=1)b[j].l(w);w.forEach(m),this.h()},h(){d(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),d(e,"tabindex","-1"),d(n,"class","items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl svelte-h65upg")},m(p,w){z(p,e,w),z(p,s,w),z(p,n,w),i(n,o),_&&_.m(o,null),i(n,a);for(let A=0;A<b.length;A+=1)b[A]&&b[A].m(n,null);c=!0,f||(h=q(e,"click",l[6]),f=!0)},p(p,w){if(l=p,_&&_.p&&(!c||w&1024)&&Ul(_,u,l,l[10],c?Kl(u,l[10],w,$a):xl(l[10]),Il),w&133){y=oe(l[0]);let A;for(A=0;A<y.length;A+=1){const j=Tl(l,y,A);b[A]?(b[A].p(j,w),W(b[A],1)):(b[A]=Dl(j),b[A].c(),W(b[A],1),b[A].m(n,null))}for(Je(),A=y.length;A<b.length;A+=1)C(A);Qe()}},i(p){if(!c){p&&ys(()=>{c&&(t||(t=Ut(e,ks,{duration:Kt},!0)),t.run(1))}),W(_,p);for(let w=0;w<y.length;w+=1)W(b[w]);p&&ys(()=>{c&&(r||(r=Ut(n,Cs,{duration:Kt},!0)),r.run(1))}),c=!0}},o(p){p&&(t||(t=Ut(e,ks,{duration:Kt},!1)),t.run(0)),Q(_,p),b=b.filter(Boolean);for(let w=0;w<b.length;w+=1)Q(b[w]);p&&(r||(r=Ut(n,Cs,{duration:Kt},!1)),r.run(0)),c=!1},d(p){p&&(m(e),m(s),m(n)),p&&t&&t.end(),_&&_.d(p),je(b,p),p&&r&&r.end(),f=!1,h()}}}function Ha(l){let e;return{c(){e=v("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),T(e).forEach(m),this.h()},h(){d(e,"class","w-[24px]")},m(t,s){z(t,e,s)},p:_e,i:_e,o:_e,d(t){t&&m(e)}}}function Ra(l){let e,t;return e=new nt({props:{class:"mr-2",icon:l[16],width:16}}),{c(){be(e.$$.fragment)},l(s){ye(e.$$.fragment,s)},m(s,n){ke(e,s,n),t=!0},p(s,n){const o={};n&1&&(o.icon=s[16]),e.$set(o)},i(s){t||(W(e.$$.fragment,s),t=!0)},o(s){Q(e.$$.fragment,s),t=!1},d(s){Ce(e,s)}}}function Dl(l){let e,t,s,n,o,a,r=l[15]+"",c,f,h,u,_;const y=[Ra,Ha],b=[];function C(w,A){return w[16]?0:1}s=C(l),n=b[s]=y[s](l);function p(){return l[12](l[14])}return{c(){e=v("li"),t=v("button"),n.c(),o=L(),a=v("div"),c=ee(r),f=L(),this.h()},l(w){e=g(w,"LI",{});var A=T(e);t=g(A,"BUTTON",{class:!0});var j=T(t);n.l(j),o=G(j),a=g(j,"DIV",{});var E=T(a);c=te(E,r),E.forEach(m),j.forEach(m),f=G(A),A.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),Z(t,"selected",l[14]===l[2])},m(w,A){z(w,e,A),i(e,t),b[s].m(t,null),i(t,o),i(t,a),i(a,c),i(e,f),h=!0,u||(_=q(t,"click",p),u=!0)},p(w,A){l=w;let j=s;s=C(l),s===j?b[s].p(l,A):(Je(),Q(b[j],1,1,()=>{b[j]=null}),Qe(),n=b[s],n?n.p(l,A):(n=b[s]=y[s](l),n.c()),W(n,1),n.m(t,o)),(!h||A&1)&&r!==(r=l[15]+"")&&ue(c,r),(!h||A&5)&&Z(t,"selected",l[14]===l[2])},i(w){h||(W(n),h=!0)},o(w){Q(n),h=!1},d(w){w&&m(e),b[s].d(),u=!1,_()}}}function qa(l){let e,t,s,n,o,a,r,c;const f=l[11].value,h=Fl(f,l,l[10],Nl);let u=l[5]&&jl(l);return{c(){e=v("div"),t=v("button"),h&&h.c(),o=L(),u&&u.c(),this.h()},l(_){e=g(_,"DIV",{class:!0,id:!0});var y=T(e);t=g(y,"BUTTON",{class:!0,title:!0});var b=T(t);h&&h.l(b),b.forEach(m),o=G(y),u&&u.l(y),y.forEach(m),this.h()},h(){d(t,"class",s=De(`${l[8].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),d(t,"title",n=l[8].title||""),Z(t,"disabled",l[3]),Z(t,"open",l[5]),d(e,"class","relative"),d(e,"id",l[1])},m(_,y){z(_,e,y),i(e,t),h&&h.m(t,null),i(e,o),u&&u.m(e,null),l[13](e),a=!0,r||(c=q(t,"click",l[6]),r=!0)},p(_,[y]){h&&h.p&&(!a||y&1024)&&Ul(h,f,_,_[10],a?Kl(f,_[10],y,za):xl(_[10]),Nl),(!a||y&256&&s!==(s=De(`${_[8].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&d(t,"class",s),(!a||y&256&&n!==(n=_[8].title||""))&&d(t,"title",n),(!a||y&264)&&Z(t,"disabled",_[3]),(!a||y&288)&&Z(t,"open",_[5]),_[5]?u?(u.p(_,y),y&32&&W(u,1)):(u=jl(_),u.c(),W(u,1),u.m(e,null)):u&&(Je(),Q(u,1,1,()=>{u=null}),Qe()),(!a||y&2)&&d(e,"id",_[1])},i(_){a||(W(h,_),W(u),a=!0)},o(_){Q(h,_),Q(u),a=!1},d(_){_&&m(e),h&&h.d(_),u&&u.d(),l[13](null),r=!1,c()}}}const Kt=400;function Wa(l,e,t){let{$$slots:s={},$$scope:n}=e,{options:o,id:a=void 0,selected:r=void 0,disabled:c=void 0,onSelect:f}=e,h,u=!1;function _(){c||t(5,u=!u)}function y(p){t(5,u=f(p))}const b=p=>y(p);function C(p){nn[p?"unshift":"push"](()=>{h=p,t(4,h)})}return l.$$set=p=>{t(8,e=Se(Se({},e),Ae(p))),"options"in p&&t(0,o=p.options),"id"in p&&t(1,a=p.id),"selected"in p&&t(2,r=p.selected),"disabled"in p&&t(3,c=p.disabled),"onSelect"in p&&t(9,f=p.onSelect),"$$scope"in p&&t(10,n=p.$$scope)},e=Ae(e),[o,a,r,c,h,u,_,y,e,f,n,s,b,C]}class Ja extends ze{constructor(e){super(),He(this,e,Wa,qa,Re,{options:0,id:1,selected:2,disabled:3,onSelect:9})}}function Ll(l,e,t){const s=l.slice();return s[30]=e[t],s}function Gl(l,e,t){const s=l.slice();return s[33]=e[t],s}function Pl(l){let e,t;return{c(){e=v("div"),t=ee(l[3]),this.h()},l(s){e=g(s,"DIV",{class:!0});var n=T(e);t=te(n,l[3]),n.forEach(m),this.h()},h(){d(e,"class","error svelte-1u7ze7x")},m(s,n){z(s,e,n),i(e,t)},p(s,n){n[0]&8&&ue(t,s[3])},d(s){s&&m(e)}}}function Qa(l){let e,t;return{c(){e=v("div"),t=ee(l[0]),this.h()},l(s){e=g(s,"DIV",{slot:!0});var n=T(e);t=te(n,l[0]),n.forEach(m),this.h()},h(){d(e,"slot","value")},m(s,n){z(s,e,n),i(e,t)},p(s,n){n[0]&1&&ue(t,s[0])},d(s){s&&m(e)}}}function Bl(l){let e,t=oe(l[5]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ml(Gl(l,t,n));return{c(){e=v("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=g(n,"DIV",{class:!0});var o=T(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,o){z(n,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,o){if(o[0]&32){t=oe(n[5]);let a;for(a=0;a<t.length;a+=1){const r=Gl(n,t,a);s[a]?s[a].p(r,o):(s[a]=Ml(r),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Ml(l){let e,t=l[33].interval+"",s;return{c(){e=v("span"),s=ee(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=te(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-1u7ze7x")},m(n,o){z(n,e,o),i(e,s)},p(n,o){o[0]&32&&t!==(t=n[33].interval+"")&&ue(s,t)},d(n){n&&m(e)}}}function Vl(l){let e,t=oe(l[8].scaleNotes),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ol(Ll(l,t,n));return{c(){e=v("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=g(n,"DIV",{class:!0});var o=T(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,o){z(n,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,o){if(o[0]&256){t=oe(n[8].scaleNotes);let a;for(a=0;a<t.length;a+=1){const r=Ll(n,t,a);s[a]?s[a].p(r,o):(s[a]=Ol(r),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Ol(l){let e,t=l[30].note+"",s;return{c(){e=v("span"),s=ee(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=te(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-1u7ze7x")},m(n,o){z(n,e,o),i(e,s)},p(n,o){o[0]&256&&t!==(t=n[30].note+"")&&ue(s,t)},d(n){n&&m(e)}}}function Ya(l){let e,t,s,n="Score",o,a,r,c,f,h,u,_="Range",y,b,C,p,w,A="—",j,E,N,I,S,O,D,R="Scale",k,V,P,U,B,M,x,re="Key",se,X,fe,Ee,ce,Me,he="",de,Fe,$,H;r=new nt({props:{icon:$l,width:16}});let F=l[3]&&Pl(l);P=new Ja({props:{id:"scales",class:"p-1",options:l[10],onSelect:l[14],$$slots:{value:[Qa]},$$scope:{ctx:l}}});let ae=!l[7]&&Bl(l),Y=!l[7]&&Vl(l);return{c(){e=v("fieldset"),t=v("legend"),s=v("button"),s.textContent=n,o=L(),a=v("button"),be(r.$$.fragment),c=L(),f=v("div"),h=v("div"),u=v("label"),u.textContent=_,y=L(),b=v("div"),C=v("input"),p=L(),w=v("span"),w.textContent=A,j=L(),E=v("input"),N=L(),I=v("div"),F&&F.c(),S=L(),O=v("div"),D=v("label"),D.textContent=R,k=L(),V=v("div"),be(P.$$.fragment),U=L(),ae&&ae.c(),B=L(),M=v("div"),x=v("label"),x.textContent=re,se=L(),X=v("div"),fe=v("input"),Ee=L(),Y&&Y.c(),ce=L(),Me=v("div"),Me.innerHTML=he,this.h()},l(ie){e=g(ie,"FIELDSET",{class:!0});var K=T(e);t=g(K,"LEGEND",{class:!0});var J=T(t);s=g(J,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(s)!=="svelte-lqyol"&&(s.textContent=n),J.forEach(m),o=G(K),a=g(K,"BUTTON",{class:!0});var pe=T(a);ye(r.$$.fragment,pe),pe.forEach(m),c=G(K),f=g(K,"DIV",{class:!0});var le=T(f);h=g(le,"DIV",{class:!0});var Te=T(h);u=g(Te,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(u)!=="svelte-10u0679"&&(u.textContent=_),y=G(Te),b=g(Te,"DIV",{class:!0});var Ge=T(b);C=g(Ge,"INPUT",{class:!0,id:!0}),p=G(Ge),w=g(Ge,"SPAN",{class:!0,"data-svelte-h":!0}),ne(w)!=="svelte-8q1xz4"&&(w.textContent=A),j=G(Ge),E=g(Ge,"INPUT",{class:!0,id:!0}),Ge.forEach(m),N=G(Te),I=g(Te,"DIV",{class:!0});var lt=T(I);F&&F.l(lt),lt.forEach(m),Te.forEach(m),S=G(le),O=g(le,"DIV",{class:!0});var qe=T(O);D=g(qe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(D)!=="svelte-ld2d07"&&(D.textContent=R),k=G(qe),V=g(qe,"DIV",{class:!0});var Ue=T(V);ye(P.$$.fragment,Ue),Ue.forEach(m),U=G(qe),ae&&ae.l(qe),qe.forEach(m),B=G(le),M=g(le,"DIV",{class:!0});var Le=T(M);x=g(Le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ne(x)!=="svelte-17pcm6g"&&(x.textContent=re),se=G(Le),X=g(Le,"DIV",{class:!0});var Ie=T(X);fe=g(Ie,"INPUT",{class:!0,id:!0}),Ie.forEach(m),Ee=G(Le),Y&&Y.l(Le),Le.forEach(m),ce=G(le),Me=g(le,"DIV",{class:!0,"data-svelte-h":!0}),ne(Me)!=="svelte-hp3bkp"&&(Me.innerHTML=he),le.forEach(m),K.forEach(m),this.h()},h(){d(s,"class","px-1 rounded hover:bg-gray-100"),d(t,"class","px-1 text-base"),d(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),Z(a,"hidden",l[6]),d(u,"class","font-bold"),d(u,"for","range_min"),d(C,"class","h-[28px] w-full"),d(C,"id","range_min"),d(w,"class","mx-2 mt-1"),d(E,"class","h-[28px] w-full"),d(E,"id","range_max"),d(b,"class","my-1 flex w-full"),d(I,"class","flex justify-between my-1"),d(h,"class","flex flex-col h-full"),d(D,"class","font-bold"),d(D,"for","scales"),d(V,"class","my-1 w-full"),d(O,"class","flex flex-col h-full"),d(x,"class","font-bold"),d(x,"for","key"),d(fe,"class","h-[28px]"),d(fe,"id","key"),d(X,"class","my-1 flex"),d(M,"class","flex flex-col h-full"),d(Me,"class","h-full flex flex-col justify-between"),d(f,"class","options svelte-1u7ze7x"),Z(f,"hidden",l[6]),d(e,"class",de=De(`${l[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),Z(e,"collapsed",l[6])},m(ie,K){z(ie,e,K),i(e,t),i(t,s),i(e,o),i(e,a),ke(r,a,null),i(e,c),i(e,f),i(f,h),i(h,u),i(h,y),i(h,b),i(b,C),Ye(C,l[1]),i(b,p),i(b,w),i(b,j),i(b,E),Ye(E,l[2]),i(h,N),i(h,I),F&&F.m(I,null),i(f,S),i(f,O),i(O,D),i(O,k),i(O,V),ke(P,V,null),i(O,U),ae&&ae.m(O,null),i(f,B),i(f,M),i(M,x),i(M,se),i(M,X),i(X,fe),Ye(fe,l[4]),i(M,Ee),Y&&Y.m(M,null),i(f,ce),i(f,Me),Fe=!0,$||(H=[q(s,"click",l[15]),q(a,"click",l[16]),q(C,"input",l[18]),q(C,"change",l[19]),q(C,"focus",l[12]),q(C,"blur",l[20]),q(E,"input",l[21]),q(E,"change",l[22]),q(E,"focus",l[12]),q(E,"blur",l[23]),q(fe,"input",l[24]),q(fe,"input",l[13]),q(fe,"focus",l[25]),q(fe,"blur",l[26])],$=!0)},p(ie,K){(!Fe||K[0]&64)&&Z(a,"hidden",ie[6]),K[0]&2&&C.value!==ie[1]&&Ye(C,ie[1]),K[0]&4&&E.value!==ie[2]&&Ye(E,ie[2]),ie[3]?F?F.p(ie,K):(F=Pl(ie),F.c(),F.m(I,null)):F&&(F.d(1),F=null);const J={};K[0]&1|K[1]&32&&(J.$$scope={dirty:K,ctx:ie}),P.$set(J),ie[7]?ae&&(ae.d(1),ae=null):ae?ae.p(ie,K):(ae=Bl(ie),ae.c(),ae.m(O,null)),K[0]&16&&fe.value!==ie[4]&&Ye(fe,ie[4]),ie[7]?Y&&(Y.d(1),Y=null):Y?Y.p(ie,K):(Y=Vl(ie),Y.c(),Y.m(M,null)),(!Fe||K[0]&64)&&Z(f,"hidden",ie[6]),(!Fe||K[0]&131072&&de!==(de=De(`${ie[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&d(e,"class",de),(!Fe||K[0]&131136)&&Z(e,"collapsed",ie[6])},i(ie){Fe||(W(r.$$.fragment,ie),W(P.$$.fragment,ie),Fe=!0)},o(ie){Q(r.$$.fragment,ie),Q(P.$$.fragment,ie),Fe=!1},d(ie){ie&&m(e),Ce(r),F&&F.d(),Ce(P),ae&&ae.d(),Y&&Y.d(),$=!1,at(H)}}}function Xa(l,e,t){let s,n,o,a,r,c;me(l,Wt,M=>t(27,n=M)),me(l,gt,M=>t(28,o=M)),me(l,_t,M=>t(7,r=M)),me(l,St,M=>t(8,c=M));let f=Xe(n[0]),h=Xe(n[1]),u="";const _=vt(Oe(!1),{key:"score-options-hidden"});me(l,_,M=>t(6,a=M));let y=o[0],b=o[1];const C=fs(),p=C.map(M=>({key:M.names[0],value:M.names[0]}));Wt.subscribe(M=>{t(1,f=Xe(M[0])),t(2,h=Xe(M[1]))}),gt.subscribe(M=>{t(4,y=M[0]),t(0,b=M[1])});function w(M,x){const re=En(x.currentTarget.value,!0,!0);if("data"in re){const{midi:se}=re.data,X=n,fe=[M==="min"?se:X[0].midi,M==="max"?se:X[1].midi];ge.setMidiRange(fe),t(3,u="")}else t(3,u=re.err),M==="min"?t(1,f=Xe(n[0])):t(2,h=Xe(n[1]))}function A(){t(3,u=""),ge.setKeyboardFocus(!1)}function j({currentTarget:{value:M}}){t(4,y=`${M.charAt(0).toUpperCase()}${M.charAt(1).toLowerCase()}`),ve.setKey(y)}function E(M){var x;return t(0,b=(x=p.find(re=>M===re.key))==null?void 0:x.value),ve.setScale(b),!1}function N(){_.update(M=>!M)}function I(){ve.clearScore(!0),ge.setMidiRange([60,84])}function S(){f=this.value,t(1,f)}const O=M=>w("min",M),D=()=>ge.setKeyboardFocus(!0);function R(){h=this.value,t(2,h)}const k=M=>w("max",M),V=()=>ge.setKeyboardFocus(!0);function P(){y=this.value,t(4,y)}const U=()=>ge.setKeyboardFocus(!1),B=()=>ge.setKeyboardFocus(!0);return l.$$set=M=>{t(17,e=Se(Se({},e),Ae(M)))},l.$$.update=()=>{var M;l.$$.dirty[0]&1&&t(5,s=((M=C.find(x=>x.names[0]===b))==null?void 0:M.intervals)||[])},e=Ae(e),[b,f,h,u,y,s,a,r,c,_,p,w,A,j,E,N,I,e,S,O,D,R,k,V,P,U,B]}class Za extends ze{constructor(e){super(),He(this,e,Xa,Ya,Re,{},null,[-1,-1])}}function eo(l){l[19]=l[20].default}function to(l){return{c:_e,l:_e,m:_e,i:_e,o:_e,d:_e}}function so(l){eo(l);let e,t,s;var n=l[19];function o(a,r){return{props:{class:"px-4 md:px-0"}}}return n&&(e=cn(n,o())),{c(){e&&be(e.$$.fragment),t=Ve()},l(a){e&&ye(e.$$.fragment,a),t=Ve()},m(a,r){e&&ke(e,a,r),z(a,t,r),s=!0},i(a){s||(e&&W(e.$$.fragment,a),s=!0)},o(a){e&&Q(e.$$.fragment,a),s=!1},d(a){a&&m(t),e&&Ce(e,a)}}}function lo(l){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,s){z(t,e,s)},i:_e,o:_e,d(t){t&&m(e)}}}function no(l){let e,t,s,n='<a class="hover:underline" href="https://github.com/TeemuKoivisto/midi-note-trainer">MIDI Note Trainer</a>',o,a,r,c,f,h,u,_,y,b,C,p,w,A,j,E,N,I,S;r=new _a({}),f=new Ka({}),u=new Wn({}),b=new Za({props:{class:"mr-4"}}),p=new Da({});let O={ctx:l,current:null,token:null,hasCatch:!1,pending:lo,then:so,catch:to,value:20,blocks:[,,,]};return an(tn(()=>import("./Score.f33e6870.js"),["./Score.f33e6870.js","./vendor_svelte.c4eaef20.js","./vendor.1acf520b.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),O),E=new Sa({props:{class:"min-h-32",debounced:!!l[0]}}),E.$on("guessed-chord",l[2]),E.$on("guessed-key",l[3]),E.$on("note",l[4]),I=new ra({props:{game:l[1]}}),{c(){e=v("meta"),t=L(),s=v("h1"),s.innerHTML=n,o=L(),a=v("section"),be(r.$$.fragment),c=L(),be(f.$$.fragment),h=L(),be(u.$$.fragment),_=L(),y=v("div"),be(b.$$.fragment),C=L(),be(p.$$.fragment),w=L(),O.block.c(),A=L(),j=v("section"),be(E.$$.fragment),N=L(),be(I.$$.fragment),this.h()},l(D){const R=on("svelte-1w2oado",document.head);e=g(R,"META",{name:!0,content:!0}),R.forEach(m),t=G(D),s=g(D,"H1",{class:!0,"data-svelte-h":!0}),ne(s)!=="svelte-1l8ebwf"&&(s.innerHTML=n),o=G(D),a=g(D,"SECTION",{class:!0});var k=T(a);ye(r.$$.fragment,k),c=G(k),ye(f.$$.fragment,k),h=G(k),ye(u.$$.fragment,k),_=G(k),y=g(k,"DIV",{class:!0});var V=T(y);ye(b.$$.fragment,V),C=G(V),ye(p.$$.fragment,V),V.forEach(m),k.forEach(m),w=G(D),O.block.l(D),A=G(D),j=g(D,"SECTION",{class:!0});var P=T(j);ye(E.$$.fragment,P),N=G(P),ye(I.$$.fragment,P),P.forEach(m),this.h()},h(){d(e,"name","description"),d(e,"content","App to practise music notation, scales and chords using MIDI"),d(s,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight"),d(y,"class","play svelte-1shyohv"),d(a,"class","px-4 md:px-0"),d(j,"class","mb-8 px-4 md:px-0 flex flex-col")},m(D,R){i(document.head,e),z(D,t,R),z(D,s,R),z(D,o,R),z(D,a,R),ke(r,a,null),i(a,c),ke(f,a,null),i(a,h),ke(u,a,null),i(a,_),i(a,y),ke(b,y,null),i(y,C),ke(p,y,null),z(D,w,R),O.block.m(D,O.anchor=R),O.mount=()=>A.parentNode,O.anchor=A,z(D,A,R),z(D,j,R),ke(E,j,null),i(j,N),ke(I,j,null),S=!0},p(D,[R]){l=D;const k={};R&1&&(k.debounced=!!l[0]),E.$set(k);const V={};R&2&&(V.game=l[1]),I.$set(V)},i(D){S||(W(r.$$.fragment,D),W(f.$$.fragment,D),W(u.$$.fragment,D),W(b.$$.fragment,D),W(p.$$.fragment,D),W(O.block),W(E.$$.fragment,D),W(I.$$.fragment,D),S=!0)},o(D){Q(r.$$.fragment,D),Q(f.$$.fragment,D),Q(u.$$.fragment,D),Q(b.$$.fragment,D),Q(p.$$.fragment,D);for(let R=0;R<3;R+=1){const k=O.blocks[R];Q(k)}Q(E.$$.fragment,D),Q(I.$$.fragment,D),S=!1},d(D){D&&(m(t),m(s),m(o),m(a),m(w),m(A),m(j)),m(e),Ce(r),Ce(f),Ce(u),Ce(b),Ce(p),O.block.d(D),O.token=null,O=null,Ce(E),Ce(I)}}}function ao(l,e,t){let s,n,o,a,r,c;me(l,mt,N=>t(7,s=N)),me(l,_t,N=>t(1,n=N)),me(l,it,N=>t(8,o=N)),me(l,pt,N=>t(9,a=N)),me(l,st,N=>t(10,r=N)),me(l,rs,N=>t(11,c=N));let f,h;rn(()=>(c&&E(),window.addEventListener("keydown",u),window.addEventListener("mousedown",u),window.addEventListener("touchstart",u),()=>{window.removeEventListener("keydown",u),window.removeEventListener("mousedown",u),window.removeEventListener("touchstart",u)})),qt.subscribe(N=>{N&&N.channels[1].addListener("noteon",_)});function u(){ge.initAudio(),window.removeEventListener("keydown",u),window.removeEventListener("mousedown",u),window.removeEventListener("touchstart",u)}function _(N){if(f)return;const I=N.rawData;y(I[1],I[2])}function y(N,I){const S=n;S instanceof wt&&!(S!=null&&S.ended)&&s==="waiting"?p(N):S instanceof rt&&!(S!=null&&S.ended)&&s==="waiting"?(S.addPlayedNote(N),h||(h=setTimeout(C,2e3))):S||ve.pushPlayed(N),r&&r.noteOn(N,a.fixedVelocity??I)}function b(){o.autoplay&&o.waitSeconds>0?t(0,f=setTimeout(()=>{o.autoplay&&we.nextGuess(),t(0,f=void 0)},o.waitSeconds*1e3)):o.autoplay?we.nextGuess():t(0,f=void 0)}function C(){var I;const N=n;if(N instanceof rt){const S=N.guess();ve.setPlayed(((I=N.latestGuess.guessed)==null?void 0:I.notes)||[],S,-1),we.updateState(S?"correct":"wrong"),b()}h=void 0}function p(N){const I=n;if(I instanceof wt&&s==="waiting"){ve.setTarget([ve.getNote(I.current)]);const S=I.guess(N);we.updateState(S?"correct":"wrong"),ve.pushPlayed(N,S,4e3),b()}}function w(N){const I=n;if(I instanceof rt&&s==="waiting"){const S=I.guessWrittenChord(N.detail);we.updateState(S?"correct":"wrong"),b()}}function A(N){const I=n;if(I instanceof It&&s==="waiting"){const S=N.detail.replaceAll("♭","b").replaceAll("♯","#"),O=I.guess(S);we.updateState(O?"correct":"wrong"),b()}}function j(N){y(N.detail,80)}async function E(){const N=await ge.openMidi();"data"in N?N.data.name:(N.err,console.error(N.err))}return[f,n,w,A,j]}class co extends ze{constructor(e){super(),He(this,e,ao,no,Re,{})}}export{Ts as F,rt as G,co as P,mn as S,wt as a,we as b,_t as c,ht as d,Wl as e,mt as g,st as p,St as s,js as t};
