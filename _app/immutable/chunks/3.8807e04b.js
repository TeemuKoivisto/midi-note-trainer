import{_ as en}from"./preload-helper.a4192956.js";import{R as Pe,Q as yt,T as Be,U as tn,S as Re,i as He,s as qe,O as nt,V as se,e as v,m as G,H as _e,a as g,b as T,n as Z,d as m,o as M,I as pe,f as d,L as z,W as Se,g as F,h as u,J as ve,p as R,t as q,C as tt,w as st,l as $,K as ge,X as Ie,Y as at,M as oe,N as ye,P as ke,z as J,A as Q,B as ne,v as je,q as fe,Z as cs,r as Gl,_ as Je,$ as sn,a0 as Ht,c as Ml,u as Vl,j as Kl,k as Ol,a1 as bs,a2 as Ut,F as ln,a3 as ys,a4 as ks,a5 as nn,a6 as an,G as on}from"./vendor_svelte.07af1c1a.js";import{w as xt,b as rn,c as cn,e as ws,f as Cs,g as Fl,h as qt,i as zt,a as Es,j as ns}from"./vendor.1acf520b.js";const Ss={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function xe(l,e=0,t=0){return{interval:`${l}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:l,semitones:Ul(l,e,t),flats:e,sharps:t}}function Ul(l,e,t){return(l<8?Ss[l]:Ss[l%7])-e+t+Math.floor(l/8)*12}function xl(l){let e,t=0,s=0;l<0?(t=1+Math.floor(-l/100),e=-l%100):l>100?(s=Math.floor(l/100),e=l%100):e=l;const n=Ul(e,t,s);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(s)}`,interval_seq:e,semitones:n,flats:t,sharps:s}}const un=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let ts=[];function Rl(){return un.map(l=>{const e=l[3].map(xl);return{suffixes:l[0],name:l[1][0],type:l[2],intervals:e}})}function Nt(l){ts.length===0&&(ts=Rl());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return ts.find(t=>t.suffixes.find(s=>s===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function fn(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const o=(l.semitones+e)%12;return{...l,semitones:o<0?o+12:o,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function as(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const o=t[n],a=l+o.semitones,r=e.scaleNotes.find(_=>_.semitones===a%12),i=o.flats>0,c=o.sharps>0,h=(i?a+1:c?a-1:a)%12,f=i?-1:c?1:0;s.push(fn(r??e.notesMap.get(h),r?0:f,a))}return s}const As=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],hn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],Ts=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function dn(l){let e=0,t=0;for(let s=0;s<As.length;s+=1){const n=l.find(a=>a.note.slice(0,2)===As[s]),o=l.find(a=>a.note.slice(0,2)===hn[s]);if(n)e+=1;else if(o)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:Ts.get(e*-1)}:{flats:0,sharps:t,majorSignature:Ts.get(t)}}function mn(l){return l>=9?`${l>=10?"X":""}${l===9?"IX":"I".repeat(l%10)}`:`${l>=5?"V":""}${l===4?"IV":"I".repeat(l%5)}`}function Hl(l){return l.map(e=>{const t=[xe(1)];let s;return e.major?(t.push(xe(3)),e.suffix.startsWith("+")?t.push(xe(5,0,1)):e.suffix.startsWith("6")?t.push(xe(6)):e.suffix.startsWith("7")?t.push(xe(7,1)):e.suffix.startsWith("maj7")?t.push(xe(7)):s=Nt("maj")):e.minor?(t.push(xe(3,1)),e.suffix.startsWith("°")?t.push(xe(5,1)):e.suffix.startsWith("6")?(t.push(xe(6)),s=Nt("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(xe(7,1)),s=Nt("m"+e.suffix)):s=Nt("m")):e.suffix.startsWith("sus2")?t.push(xe(2)):e.suffix.startsWith("sus4")&&t.push(xe(4)),t.length<=2&&t.push(xe(5)),t.length<=2&&t.push(xe(8)),s||(s=Nt(e.suffix)),{...s,intervals:t}})}function _n(l,e){let t=e.has(4)&&e.has(7),s=e.has(3)&&e.has(7);const n=mn(l);let o="";return t||s||(e.has(3)&&e.has(6)?(o="°",s=!0):e.has(4)&&e.has(8)?(o="+",t=!0):e.has(3)&&e.has(10)?(s=!0,o="7"):e.has(4)&&e.has(10)?(o="7",t=!0):e.has(4)&&e.has(11)?(o="maj7",t=!0):e.has(3)&&e.has(8)?(o="6",s=!0):e.has(4)&&e.has(9)?(o="6",t=!0):e.has(2)?o="sus2":e.has(5)?o="sus4":e.has(7)?o="5":o="?"),{degree:l,roman:s?n.toLowerCase():n,suffix:o,major:t,minor:s,semitones:e}}function pn(l){const e=l.length;return l.map((t,s)=>{const n=t.semitones,o=new Set;for(let a=1;a<e;a+=1){const r=l[(s+a)%e].semitones,i=r<=n?r+12-n:r-n;o.add(i)}return _n(t.interval_seq,o)})}const vn=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let ss=[];function us(){return vn.map(l=>{const e=l[0],t=l[1].map(xl),s=pn(t);return{names:e,intervals:t,triads:s}})}function gn(l){ss.length===0&&(ss=us());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return ss.find(t=>t.names.find(s=>s.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const bn=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,yn=/^[0-9]$/,Ze=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function ql(l){return l===12?1:Math.floor((l-12)/12)}function Qe(l){return`${l.note}${ql(l.midi)}`}function St(l){const t=(l-12)%12;return{...Ze[t],semitones:t,midi:l}}function kn(l,e=!0,t=!1){if(e&&!bn.test(l))return{err:`Unrecognized note "${l}"`,code:400};const s=l.trim(),n=s.charAt(0).toUpperCase(),o=Ze.find(f=>f.note.charAt(0)===n&&f.note.length===1);if(!o)return{err:`Unable to find note ${s}`,code:500};const a=s.slice(1).split("").reduce((f,_)=>f+(_.toLowerCase()==="b"||_==="♭"?-1:_==="#"||_==="♯"?1:0),0);let r;if(yn.test(s.charAt(s.length-1)))try{r=parseInt(s.charAt(s.length-1),10)}catch{}if(t&&r===void 0)return{err:`No octave provided: ${l}`,code:400};r===void 0&&(r=0);let i=(o.semitones+a)%12;i=i<0?i+12:i;const c=a<0?-a:0,h=a>0?a:0;return{data:{note:`${n}${"♭".repeat(c)}${"♯".repeat(h)}`,semitones:i,midi:12+r*12+i,flats:c,sharps:h}}}function zl(l){const e=Ze.find(t=>t.note.charAt(0)===l.charAt(0)&&t.note.length===1);if(e){const t=l.slice(1).split("").reduce((n,o)=>n+(o.toLowerCase()==="b"||o==="♭"?-1:o==="#"||o==="♯"?1:0),0),s=(e.semitones+t)%12;return{note:l,semitones:s<0?s+12:s,flats:t<0?-t:0,sharps:t>0?t:0}}}const wn=/^[a-gA-G][♭b#♯]?$/,ls="ABCDEFG";function Cn(l,e){return e.map(t=>ls.charAt((ls.indexOf(l)+t.interval_seq-1)%ls.length))}function En(l,e,t){return t.map((s,n)=>{const o=e[n],a=(l+s.semitones)%12,r=Ze[a],i=r.note.charAt(0);if(i<o&&(i!=="A"||o!=="G")||i==="G"&&o==="A"){let c=1,h=Ze[(a+c)%12];for(;h.note.charAt(0)!==o;)c+=1,h=Ze[(a+c)%12];return{semitones:a,note:h.note+"♭".repeat(c),flats:c+(h.note.includes("♭")?1:0),sharps:0}}else if(i>o||i==="A"&&o==="G"){let c=1,h=a===0?Ze.length-1:a-c,f=Ze[h];for(;f.note.charAt(0)!==o;)c+=1,h=h===0?Ze.length-1:h-1,f=Ze[h];return{semitones:a,note:f.note+"♯".repeat(c),flats:0,sharps:c+(f.note.includes("♯")?1:0)}}else return{semitones:a,note:r.note,flats:r.flats,sharps:r.sharps}})}function Wt(l,e){if(!wn.test(l))return{err:`Unknown key: ${l}`,code:400};const t=gn(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const s=`${l.charAt(0).toUpperCase()}${l.charAt(1).replace("b","♭").replace("#","♯")}`,n=zl(s);if(!n)return{err:`Unable to find root for note: ${s}`,code:404};const o=Cn(s.charAt(0),t.intervals),a=En(n.semitones,o,t.intervals),r=new Map(Ze.map(i=>{const c=a.find(h=>h.semitones===i.semitones);return c?[i.semitones,c]:[i.semitones,{...i}]}));return{data:{key:s,scale:t.names[0],names:t.names,...dn(a),intervals:t.intervals.map(i=>({...i})),triads:t.triads.map(i=>({...i})),scaleNotes:a,notesMap:r}}}const os=new Map;function Sn(l,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(l)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function An(l,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(l)),{data:void 0}}catch(s){return{err:`Failed to store the value: ${s}`,code:400}}}function ct(l,e){const{key:t,storage:s="local",namespace:n="default"}=e,o=Sn(t,s),a=Pe(l);"data"in o?l.set(e.deserialize?e.deserialize(o.data):o.data):"err"in o&&(e!=null&&e.debug)&&console.info(o.err);const r=l.subscribe(c=>{const h=An(e.serialize?e.serialize(c):c,t,s);"err"in h&&(e!=null&&e.debug)&&console.error(h.err)}),i=os.get(n);return i?i.push({key:t,storage:s,value:l,defaultValue:a,unsubscribe:r}):os.set(n,[{key:t,storage:s,value:l,defaultValue:a,unsubscribe:r}]),l}function Tn(l=["default"],e){l.forEach(t=>{var s;(s=os.get(t))==null||s.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function Nn(l,e){const t=await fetch(l);if(!t.ok)return{err:t.statusText,code:t.status};const s=await t.arrayBuffer();return{data:await e.decodeAudioData(s)}}async function In(l,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],s=await Promise.all(t.map(o=>Nn(`${l}${o}`,e))),n=[];return s.forEach(o=>{"err"in o?console.error(`Failed to load audio: ${o.err}`):n.push(o.data)}),n}class jn{constructor(e,t,s,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(s),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(s))}on(e,t,s,n,o,a,r,i){this.noteA.buffer=e,this.noteA.playbackRate.value=s,this.biquadFilter.frequency.value=o,this.gainA.gain.value=a,this.gain.gain.value=i,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=r,this.noteB.start(0)),this.noteA.start(0)}off(e,t,s){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(s),this.noteB.stop(s),(n=this.damp)==null||n.start(0)}}class Dn{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,s)=>{this.bufferlists.push(t),s===8?this.damper=t:s===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(s=>{this.noteOn(s,t)})}noteOn(e,t=80){if(e<109&&e>20){const s=this.notes.get(e);s&&(s.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),o=n+1,a=n*12+21,r=2**((e-69)/12)*440,i=t/127;let c=r*(2-(e-21)/50)+3*r*i;e<60&&(c=440*(3-(60-21)/50)+3*r*i);const h=1-(e%12/12+1)/12,f=Math.pow(2,(e-a)/12),_=0,y=0,p=i**1.4,k=new jn(e,this.context,this.directGain,this.damper);k.on(this.bufferlists[n],this.bufferlists[o],f,_,c,h,y,p),this.notes.set(e,k)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const Ln="/midi-note-trainer/",rs=ct(Be(!1),{key:"midi-access"}),$t=Be(void 0),fs=ct(Be([60,84]),{key:"midi-range",storage:"session"}),Jt=yt(fs,l=>[St(l[0]),St(l[1])]),Ns=Be(void 0),et=Be(void 0),Wl=Be(!0),vt=ct(Be({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),ue={async openMidi(){return xt.enable().then(()=>(rs.set(!0),xt.inputs.length>0?($t.set(xt.inputs[0]),{data:xt.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(l=>({err:l.toString(),code:403}))},disableMidi(){rs.set(!1),$t.set(void 0)},setMidiRange(l){fs.set(l)},setInputValue(l,e){vt.update(t=>({...t,[l]:e})),l==="useSound"&&!e?et.set(void 0):l==="useSound"&&!Pe(et)&&this.initAudio()},setKeyboardFocus(l){Wl.set(l)},async initAudio(){let l=Pe(Ns);if(l||(l=new AudioContext,Ns.set(l)),!Pe(et)){const e=new Dn(l),t=await In(`${Ln}audio`,l);e.load(t),et.set(e)}}};let Xe;const Pn=tn({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}}),gt=Be(["C","Major"]),bt=yt(gt,l=>{const e=Wt(l[0],l[1]);return"data"in e?e.data:{key:l[0],scale:l[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),$l=yt([bt,Pn],([l,e])=>{const t={...e};return Object.entries(e).forEach(([s,n])=>{const o=l.notesMap.get(n.semitones%12);o&&(t[s]={note:o.note,flats:o.flats,sharps:o.sharps,semitones:n.semitones})}),t}),Is=Be([]),mt=Be([]);function is(l,e){if(l.length>0){const t=Date.now();let s=t;const n=l.filter(o=>(o.started+e>t&&(s=Math.min(s,o.started)),o.started+e>t));return!Xe&&n.length>0&&(Xe=setTimeout(()=>{Xe=void 0,mt.update(o=>is(o,e))},e-(t-s)+100)),n}return l}const ce={setKey(l){gt.update(e=>[l,e[1]])},setScale(l){gt.update(e=>[e[0],l])},setKeyAndScale(l,e){gt.set([l,e])},setTarget(l=[]){Is.set(l)},findNote(l){return Object.values(Pe($l)).find(e=>{if(e.note.charAt(0)===l.charAt(0)){const t=l.slice(1).split("").reduce((s,n)=>s+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},getNote(l){return{...Pe(bt).notesMap.get(l%12),midi:l}},pushPlayed(l,e,t){const n={...Pe(bt).notesMap.get(l%12),midi:l},o=Date.now(),a=e===void 0?"default":e?"correct":"wrong";if(mt.update(r=>{const i=r.findIndex(c=>c.midi===l);return i>=0&&r.splice(i,1),[...r,{...n,color:a,started:o}]}),!Xe&&t!==-1){const r=t??Pe(vt).keyFadeTimeout;Xe=setTimeout(()=>{Xe=void 0,mt.update(i=>is(i,r))},r)}},setPlayed(l,e,t){const s=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(mt.update(o=>[...l.map(a=>({...a,color:n,started:s}))]),!Xe&&t!==-1){const o=t??Pe(vt).keyFadeTimeout;Xe=setTimeout(()=>{Xe=void 0,mt.update(a=>is(a,o))},o)}},clearPlayed(){mt.set([]),clearTimeout(Xe),Xe=void 0},clearScore(l=!1){l&&gt.set(["C","Major"]),Is.set([]),mt.set([])}};class hs{constructor(e,t,s){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=s;const n=[],{count:o}=s,a=t.map(i=>typeof i=="object"&&i!==null?{...i}:i);let r=s.duplicates;!s.duplicates&&o>a.length&&(console.warn(`Trying to create game with count ${o} larger than available unique values ${t.length}`),r=!0);for(let i=0;i<o;i+=1){const c=Math.floor(Math.random()*a.length);if(r)n.push(a[c]);else{const h=a.splice(c,1);h.length>0&&n.push(h[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function Bn(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const o=(l.semitones+e)%12;return{...l,semitones:o<0?o+12:o,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function Gn(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const o=t[n],a=l+o.semitones,r=e.scaleNotes.find(_=>_.semitones===a%12),i=o.flats>0,c=o.sharps>0,h=(i?a+1:c?a-1:a)%12,f=i?-1:c?1:0;s.push(Bn(r??e.notesMap.get(h),r?0:f,a))}return s}const Mn=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function Vn(l){const t=(l-12)%12;return{...Mn[t],semitones:t,midi:l}}function Kn(l){return`${l.note.trim().charAt(0).toUpperCase()}${"♭".repeat(l.flats)}${"♯".repeat(l.sharps)}`}class rt extends hs{constructor(e,t,s){const n=t.range[0],o=t.range[1],a=new Set(t.scale.scaleNotes.map(i=>i.semitones)),r=s.chords.flatMap(i=>{const c=[],h=i.intervals.reduce((f,_)=>_.semitones>f?_.semitones:f,0);for(let f=n;f<=o-h;f+=1)if((!s.onlyScale||a.has(f%12))&&(!i.allowed||i.allowed.has(f%12))){const _=Gn(f,t.scale,i.intervals);c.push({...i,rootNote:_[0].note,chord:`${_[0].note}${i.suffixes[0]}`,notes:_})}return c});super(e,r,t),this.played=new Set,this.opts=s}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${Kn(e)}${e.chord.toLowerCase()}`,notes:[]},s=this.current.chord===t.chord;return this.addGuessed(t,s)}guess(){const e=Array.from(this.played.values()).map(n=>Vn(n)).sort((n,o)=>n.midi-o.midi);this.played.clear();const t={chord:"",notes:e},s=this.current.notes.every(n=>e.find(o=>o.midi%12===n.midi%12));return this.addGuessed(t,s)}}const On={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class It extends hs{constructor(e,t){const s=e==="keys-major"?"major":"minor";super(e,Object.keys(On[s]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class At extends hs{constructor(e,t){const s=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-s+1)).map((o,a)=>s+a),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const Jl={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},_t=Be("waiting"),it=ct(Be(Jl),{key:"game-options"}),pt=Be(void 0),ds=Be(Rl().map(l=>({...l,selected:!0}))),be={play(...[l,e]){var i,c,h;let t;const s=Pe(bt),n=Pe(fs),o=Pe(it),a={scale:s,range:n,duplicates:o.duplicates,count:o.count};let r=[s.key,s.scale];if(l==="notes")t=new At(l,a),ce.setTarget([ce.getNote(t.current)]),(i=Pe(et))==null||i.noteOn(t.current);else if(l==="pitches")t=new At(l,a),ce.setTarget(),ue.setInputValue("useSound",!0),(c=Pe(et))==null||c.noteOn(t.current);else if(l==="keys-major"||l=="keys-minor")t=new It(l,a),r=[t.current,l==="keys-major"?"major":"minor"];else if(l==="chords-play"||l==="chords-write")t=new rt(l,a,e);else if(l==="chords-diatonic"){const f=Hl(s.triads).map((_,y)=>({..._,allowed:new Set([s.scaleNotes[y].semitones])}));t=new rt(l,a,{chords:f})}else throw Error("Unknown game type: "+l);return typeof t.current!="number"&&typeof t.current!="string"&&((h=Pe(et))==null||h.playChord(t.current.notes.map(f=>f.midi)),ce.setTarget(t.current.notes)),ce.setKeyAndScale(r[0],r[1]),ce.clearPlayed(),_t.set("waiting"),pt.set(t),t},updateState(l){_t.set(l)},setOptionValue(l,e){it.update(t=>({...t,[l]:e}))},toggleChords(l){ds.update(e=>e.map(t=>({...t,selected:l(t)})))},nextGuess(){var e,t;const l=Pe(pt);l!=null&&l.ended?_t.set("ended"):l instanceof At?(l.type==="notes"?ce.setTarget([ce.getNote(l.current)]):ce.setTarget(),ce.clearPlayed(),(e=Pe(et))==null||e.noteOn(l.current),be.updateState("waiting"),l.startTime()):l instanceof rt?(ce.setTarget(l.current.notes),ce.clearPlayed(),(t=Pe(et))==null||t.playChord(l==null?void 0:l.current.notes.map(s=>s.midi)),_t.set("waiting"),l.startTime()):l instanceof It&&(ce.setKey(l.current),_t.set("waiting"),l.startTime())},clearGame(l=!1){const e=Pe(pt);e&&ce.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),l&&it.set(Jl),pt.set(void 0),_t.set("waiting"),ce.clearScore()}};function js(l,e,t){const s=l.slice();return s[29]=e[t],s[31]=t,s}function Ds(l,e,t){const s=l.slice();return s[34]=e[t],s}function Ls(l,e,t){const s=l.slice();return s[8]=e[t],s}function Ps(l,e,t){const s=l.slice();return s[29]=e[t],s[31]=t,s}function Bs(l,e,t){const s=l.slice();return s[34]=e[t],s}function Gs(l,e,t){const s=l.slice();return s[8]=e[t],s}function Fn(l){let e,t=se(l[29].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ms(Bs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=je()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);F(n,e,o)},p(n,o){if(o[0]&64){t=se(n[29].intervals);let a;for(a=0;a<t.length;a+=1){const r=Bs(n,t,a);s[a]?s[a].p(r,o):(s[a]=Ms(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function Un(l){let e,t=se(l[2][l[31]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Vs(Gs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=je()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);F(n,e,o)},p(n,o){if(o[0]&4){t=se(n[2][n[31]]);let a;for(a=0;a<t.length;a+=1){const r=Gs(n,t,a);s[a]?s[a].p(r,o):(s[a]=Vs(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function Ms(l){let e,t=l[34].interval+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-1j99daw")},m(n,o){F(n,e,o),u(e,s)},p(n,o){o[0]&64&&t!==(t=n[34].interval+"")&&ne(s,t)},d(n){n&&m(e)}}}function Vs(l){let e,t=l[8].note+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-1j99daw")},m(n,o){F(n,e,o),u(e,s)},p(n,o){o[0]&4&&t!==(t=n[8].note+"")&&ne(s,t)},d(n){n&&m(e)}}}function Ks(l){let e,t,s,n,o,a,r=l[29].suffixes[0]+"",i,c,h,f,_,y,p=l[29].name+"",k,b,N,I;n=new nt({props:{icon:l[29].selected?qt:zt,width:12}});function B(){return l[25](l[29])}function C(S,L){return S[2][S[31]]&&S[2][S[31]].length>0?Un:Fn}let j=C(l),w=j(l);return{c(){e=v("li"),t=v("button"),s=v("span"),_e(n.$$.fragment),o=G(),a=v("div"),i=J(r),c=G(),h=v("li"),w.c(),_=G(),y=v("li"),k=J(p),this.h()},l(S){e=g(S,"LI",{});var L=T(e);t=g(L,"BUTTON",{class:!0});var A=T(t);s=g(A,"SPAN",{class:!0});var O=T(s);pe(n.$$.fragment,O),O.forEach(m),o=M(A),a=g(A,"DIV",{class:!0});var E=T(a);i=Q(E,r),E.forEach(m),A.forEach(m),L.forEach(m),c=M(S),h=g(S,"LI",{class:!0,title:!0});var P=T(h);w.l(P),P.forEach(m),_=M(S),y=g(S,"LI",{class:!0});var D=T(y);k=Q(D,p),D.forEach(m),this.h()},h(){d(s,"class","px-1 py-1 rounded"),z(s,"text-green-500",l[29].selected),z(s,"text-gray-400",!l[29].selected),d(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),d(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),z(t,"hidden",l[7]),d(h,"class","intervals svelte-1j99daw"),d(h,"title",f=l[29].intervals.map(Rs).join("-")),d(y,"class","text-xs")},m(S,L){F(S,e,L),u(e,t),u(t,s),ve(n,s,null),u(t,o),u(t,a),u(a,i),F(S,c,L),F(S,h,L),w.m(h,null),F(S,_,L),F(S,y,L),u(y,k),b=!0,N||(I=R(t,"click",B),N=!0)},p(S,L){l=S;const A={};L[0]&64&&(A.icon=l[29].selected?qt:zt),n.$set(A),(!b||L[0]&64)&&z(s,"text-green-500",l[29].selected),(!b||L[0]&64)&&z(s,"text-gray-400",!l[29].selected),(!b||L[0]&64)&&r!==(r=l[29].suffixes[0]+"")&&ne(i,r),(!b||L[0]&128)&&z(t,"hidden",l[7]),j===(j=C(l))&&w?w.p(l,L):(w.d(1),w=j(l),w&&(w.c(),w.m(h,null))),(!b||L[0]&64&&f!==(f=l[29].intervals.map(Rs).join("-")))&&d(h,"title",f),(!b||L[0]&64)&&p!==(p=l[29].name+"")&&ne(k,p)},i(S){b||(q(n.$$.fragment,S),b=!0)},o(S){$(n.$$.fragment,S),b=!1},d(S){S&&(m(e),m(c),m(h),m(_),m(y)),ge(n),w.d(),N=!1,I()}}}function xn(l){let e,t=se(l[29].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Os(Ds(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=je()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);F(n,e,o)},p(n,o){if(o[0]&32){t=se(n[29].intervals);let a;for(a=0;a<t.length;a+=1){const r=Ds(n,t,a);s[a]?s[a].p(r,o):(s[a]=Os(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function Rn(l){let e,t=se(l[3][l[31]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Fs(Ls(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=je()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);F(n,e,o)},p(n,o){if(o[0]&8){t=se(n[3][n[31]]);let a;for(a=0;a<t.length;a+=1){const r=Ls(n,t,a);s[a]?s[a].p(r,o):(s[a]=Fs(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function Os(l){let e,t=l[34].interval+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-1j99daw")},m(n,o){F(n,e,o),u(e,s)},p(n,o){o[0]&32&&t!==(t=n[34].interval+"")&&ne(s,t)},d(n){n&&m(e)}}}function Fs(l){let e,t=l[8].note+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-1j99daw")},m(n,o){F(n,e,o),u(e,s)},p(n,o){o[0]&8&&t!==(t=n[8].note+"")&&ne(s,t)},d(n){n&&m(e)}}}function Us(l){let e,t,s,n,o,a,r=l[29].suffixes[0]+"",i,c,h,f,_,y,p=l[29].name+"",k,b,N,I;n=new nt({props:{icon:l[29].selected?qt:zt,width:12}});function B(){return l[26](l[29])}function C(S,L){return S[3][S[31]]&&S[3][S[31]].length>0?Rn:xn}let j=C(l),w=j(l);return{c(){e=v("li"),t=v("button"),s=v("span"),_e(n.$$.fragment),o=G(),a=v("div"),i=J(r),c=G(),h=v("li"),w.c(),_=G(),y=v("li"),k=J(p),this.h()},l(S){e=g(S,"LI",{});var L=T(e);t=g(L,"BUTTON",{class:!0});var A=T(t);s=g(A,"SPAN",{class:!0});var O=T(s);pe(n.$$.fragment,O),O.forEach(m),o=M(A),a=g(A,"DIV",{class:!0});var E=T(a);i=Q(E,r),E.forEach(m),A.forEach(m),L.forEach(m),c=M(S),h=g(S,"LI",{class:!0,title:!0});var P=T(h);w.l(P),P.forEach(m),_=M(S),y=g(S,"LI",{class:!0});var D=T(y);k=Q(D,p),D.forEach(m),this.h()},h(){d(s,"class","px-1 py-1 rounded"),z(s,"text-green-500",l[29].selected),z(s,"text-gray-400",!l[29].selected),d(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),d(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),z(t,"hidden",l[7]),d(h,"class","intervals svelte-1j99daw"),d(h,"title",f=l[29].intervals.map(Hs).join("-")),d(y,"class","text-xs")},m(S,L){F(S,e,L),u(e,t),u(t,s),ve(n,s,null),u(t,o),u(t,a),u(a,i),F(S,c,L),F(S,h,L),w.m(h,null),F(S,_,L),F(S,y,L),u(y,k),b=!0,N||(I=R(t,"click",B),N=!0)},p(S,L){l=S;const A={};L[0]&32&&(A.icon=l[29].selected?qt:zt),n.$set(A),(!b||L[0]&32)&&z(s,"text-green-500",l[29].selected),(!b||L[0]&32)&&z(s,"text-gray-400",!l[29].selected),(!b||L[0]&32)&&r!==(r=l[29].suffixes[0]+"")&&ne(i,r),(!b||L[0]&128)&&z(t,"hidden",l[7]),j===(j=C(l))&&w?w.p(l,L):(w.d(1),w=j(l),w&&(w.c(),w.m(h,null))),(!b||L[0]&32&&f!==(f=l[29].intervals.map(Hs).join("-")))&&d(h,"title",f),(!b||L[0]&32)&&p!==(p=l[29].name+"")&&ne(k,p)},i(S){b||(q(n.$$.fragment,S),b=!0)},o(S){$(n.$$.fragment,S),b=!1},d(S){S&&(m(e),m(c),m(h),m(_),m(y)),ge(n),w.d(),N=!1,I()}}}function Hn(l){let e,t,s,n,o="Chords",a,r,i,c,h,f,_,y,p,k,b,N,I,B,C,j,w,S="Key",L,A,O,E,P="Scale",D,U,V,K,H="Note",ee,te,he,re,Ge,Ue,Me,me,ze,Fe;c=new nt({props:{icon:rn,width:20}}),_=new nt({props:{icon:cn,width:16}}),k=new nt({props:{icon:l[4]?ws:Cs,width:16}}),I=new nt({props:{icon:Fl,width:16}});let Te=se(l[6]),ae=[];for(let x=0;x<Te.length;x+=1)ae[x]=Ks(Ps(l,Te,x));const Ae=x=>$(ae[x],1,1,()=>{ae[x]=null});let de=se(l[5]),W=[];for(let x=0;x<de.length;x+=1)W[x]=Us(js(l,de,x));const le=x=>$(W[x],1,1,()=>{W[x]=null});return{c(){e=v("div"),t=v("fieldset"),s=v("legend"),n=v("button"),n.textContent=o,a=G(),r=v("div"),i=v("button"),_e(c.$$.fragment),h=G(),f=v("button"),_e(_.$$.fragment),y=G(),p=v("button"),_e(k.$$.fragment),b=G(),N=v("button"),_e(I.$$.fragment),B=G(),C=v("div"),j=v("div"),w=v("label"),w.textContent=S,L=G(),A=v("input"),O=G(),E=v("label"),E.textContent=P,D=G(),U=v("input"),V=G(),K=v("label"),K.textContent=H,ee=G(),te=v("input"),he=G(),re=v("ul");for(let x=0;x<ae.length;x+=1)ae[x].c();Ge=G(),Ue=v("ul");for(let x=0;x<W.length;x+=1)W[x].c();this.h()},l(x){e=g(x,"DIV",{class:!0});var Y=T(e);t=g(Y,"FIELDSET",{class:!0});var ie=T(t);s=g(ie,"LEGEND",{class:!0});var X=T(s);n=g(X,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1knqzl6"&&(n.textContent=o),X.forEach(m),a=M(ie),r=g(ie,"DIV",{class:!0});var we=T(r);i=g(we,"BUTTON",{class:!0});var De=T(i);pe(c.$$.fragment,De),De.forEach(m),h=M(we),f=g(we,"BUTTON",{class:!0});var lt=T(f);pe(_.$$.fragment,lt),lt.forEach(m),y=M(we),p=g(we,"BUTTON",{class:!0});var We=T(p);pe(k.$$.fragment,We),We.forEach(m),b=M(we),N=g(we,"BUTTON",{class:!0});var Ve=T(N);pe(I.$$.fragment,Ve),Ve.forEach(m),we.forEach(m),B=M(ie),C=g(ie,"DIV",{class:!0});var Ne=T(C);j=g(Ne,"DIV",{class:!0});var Ce=T(j);w=g(Ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(w)!=="svelte-14m38zf"&&(w.textContent=S),L=M(Ce),A=g(Ce,"INPUT",{class:!0,id:!0}),O=M(Ce),E=g(Ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(E)!=="svelte-bxhcb0"&&(E.textContent=P),D=M(Ce),U=g(Ce,"INPUT",{class:!0,id:!0}),V=M(Ce),K=g(Ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(K)!=="svelte-dmbfli"&&(K.textContent=H),ee=M(Ce),te=g(Ce,"INPUT",{class:!0,id:!0}),Ce.forEach(m),he=M(Ne),re=g(Ne,"UL",{class:!0});var Tt=T(re);for(let Ke=0;Ke<ae.length;Ke+=1)ae[Ke].l(Tt);Tt.forEach(m),Ge=M(Ne),Ue=g(Ne,"UL",{class:!0});var kt=T(Ue);for(let Ke=0;Ke<W.length;Ke+=1)W[Ke].l(kt);kt.forEach(m),Ne.forEach(m),ie.forEach(m),Y.forEach(m),this.h()},h(){d(n,"class","px-1 rounded hover:bg-gray-100"),d(s,"class","text-base"),d(i,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),z(i,"hidden",l[7]),d(f,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),z(f,"hidden",l[7]),d(p,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),z(p,"hidden",l[7]),d(N,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),z(N,"hidden",l[7]),d(r,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),d(w,"class","mr-4 font-bold svelte-1j99daw"),d(w,"for","scale-key"),d(A,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),d(A,"id","scale-key"),A.value=l[0],d(E,"class","font-bold svelte-1j99daw"),d(E,"for","scale-key"),d(U,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),d(U,"id","scale-key"),U.value="Major",U.disabled=!0,d(K,"class","font-bold svelte-1j99daw"),d(K,"for","scale-key"),d(te,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),d(te,"id","scale-key"),te.value=l[1],d(j,"class","flex mb-2 input svelte-1j99daw"),d(re,"class","chord-list w-full svelte-1j99daw"),d(Ue,"class","chord-list w-full svelte-1j99daw"),d(C,"class","body svelte-1j99daw"),z(C,"hidden",l[7]),d(t,"class","flex flex-col relative rounded border-2 px-4 py-2 my-4 text-sm svelte-1j99daw"),z(t,"collapsed",l[7]),d(e,"class",Me=Se(`${l[18].class||""}`)+" svelte-1j99daw")},m(x,Y){F(x,e,Y),u(e,t),u(t,s),u(s,n),u(t,a),u(t,r),u(r,i),ve(c,i,null),u(r,h),u(r,f),ve(_,f,null),u(r,y),u(r,p),ve(k,p,null),u(r,b),u(r,N),ve(I,N,null),u(t,B),u(t,C),u(C,j),u(j,w),u(j,L),u(j,A),u(j,O),u(j,E),u(j,D),u(j,U),u(j,V),u(j,K),u(j,ee),u(j,te),u(C,he),u(C,re);for(let ie=0;ie<ae.length;ie+=1)ae[ie]&&ae[ie].m(re,null);u(C,Ge),u(C,Ue);for(let ie=0;ie<W.length;ie+=1)W[ie]&&W[ie].m(Ue,null);me=!0,ze||(Fe=[R(n,"click",l[10]),R(i,"click",l[14]),R(f,"click",l[15]),R(p,"click",l[16]),R(N,"click",l[17]),R(A,"input",l[11]),R(A,"focus",l[21]),R(A,"blur",l[22]),R(te,"input",l[12]),R(te,"focus",l[23]),R(te,"blur",l[24])],ze=!0)},p(x,Y){(!me||Y[0]&128)&&z(i,"hidden",x[7]),(!me||Y[0]&128)&&z(f,"hidden",x[7]);const ie={};if(Y[0]&16&&(ie.icon=x[4]?ws:Cs),k.$set(ie),(!me||Y[0]&128)&&z(p,"hidden",x[7]),(!me||Y[0]&128)&&z(N,"hidden",x[7]),(!me||Y[0]&1&&A.value!==x[0])&&(A.value=x[0]),(!me||Y[0]&2&&te.value!==x[1])&&(te.value=x[1]),Y[0]&8388){Te=se(x[6]);let X;for(X=0;X<Te.length;X+=1){const we=Ps(x,Te,X);ae[X]?(ae[X].p(we,Y),q(ae[X],1)):(ae[X]=Ks(we),ae[X].c(),q(ae[X],1),ae[X].m(re,null))}for(tt(),X=Te.length;X<ae.length;X+=1)Ae(X);st()}if(Y[0]&8360){de=se(x[5]);let X;for(X=0;X<de.length;X+=1){const we=js(x,de,X);W[X]?(W[X].p(we,Y),q(W[X],1)):(W[X]=Us(we),W[X].c(),q(W[X],1),W[X].m(Ue,null))}for(tt(),X=de.length;X<W.length;X+=1)le(X);st()}(!me||Y[0]&128)&&z(C,"hidden",x[7]),(!me||Y[0]&128)&&z(t,"collapsed",x[7]),(!me||Y[0]&262144&&Me!==(Me=Se(`${x[18].class||""}`)+" svelte-1j99daw"))&&d(e,"class",Me)},i(x){if(!me){q(c.$$.fragment,x),q(_.$$.fragment,x),q(k.$$.fragment,x),q(I.$$.fragment,x);for(let Y=0;Y<Te.length;Y+=1)q(ae[Y]);for(let Y=0;Y<de.length;Y+=1)q(W[Y]);me=!0}},o(x){$(c.$$.fragment,x),$(_.$$.fragment,x),$(k.$$.fragment,x),$(I.$$.fragment,x),ae=ae.filter(Boolean);for(let Y=0;Y<ae.length;Y+=1)$(ae[Y]);W=W.filter(Boolean);for(let Y=0;Y<W.length;Y+=1)$(W[Y]);me=!1},d(x){x&&m(e),ge(c),ge(_),ge(k),ge(I),Ie(ae,x),Ie(W,x),ze=!1,at(Fe)}}}let xs="Major";const Rs=l=>l.interval,Hs=l=>l.interval;function qn(l,e,t){let s,n,o,a,r,i;oe(l,ds,V=>t(20,r=V));let c="C",h=Wt(c,xs),f="",_,y=[],p=[];const k=ct(Be(!0),{key:"chords-hidden"});oe(l,k,V=>t(7,i=V));function b(){k.update(V=>!V)}function N(){const V=_&&60+_.semitones;if("err"in h||!V)t(2,y=[]),t(3,p=[]);else{const K=h.data;t(2,y=n.map(H=>as(V,K,H.intervals))),t(3,p=o.map(H=>as(V,K,H.intervals)))}}function I({currentTarget:{value:V}}){t(0,c=`${V.charAt(0).toUpperCase()}${V.charAt(1).toLowerCase()}`),h=Wt(c,xs),N()}function B({currentTarget:{value:V}}){t(1,f=`${V.charAt(0).toUpperCase()}${V.charAt(1).toLowerCase()}`),t(8,_=zl(f)),N()}function C(V){be.toggleChords(K=>K.name===V.name?!K.selected:K.selected)}function j(){const V=H=>H.suffixes[0]==="maj"||H.suffixes[0]==="m",K=r.filter(V).every(H=>H.selected);be.toggleChords(H=>V(H)?!K:H.selected)}function w(){const V=H=>H.suffixes[0]==="maj7"||H.suffixes[0]==="m7"||H.suffixes[0]==="7"||H.suffixes[0]==="dim7"||H.suffixes[0]==="aug7",K=r.filter(V).every(H=>H.selected);be.toggleChords(H=>V(H)?!K:H.selected)}function S(){be.toggleChords(V=>!a)}function L(){be.toggleChords(V=>!0)}const A=()=>ue.setKeyboardFocus(!1),O=()=>ue.setKeyboardFocus(!0),E=()=>ue.setKeyboardFocus(!1),P=()=>ue.setKeyboardFocus(!0),D=V=>C(V),U=V=>C(V);return l.$$set=V=>{t(18,e=ye(ye({},e),ke(V)))},l.$$.update=()=>{l.$$.dirty[0]&1048576&&t(19,s=r),l.$$.dirty[0]&524288&&t(6,n=s.filter((V,K)=>K<s.length/2)),l.$$.dirty[0]&524288&&t(5,o=s.filter((V,K)=>K>=s.length/2)),l.$$.dirty[0]&524288&&t(4,a=s.every(V=>V.selected))},e=ke(e),[c,f,y,p,a,o,n,i,_,k,b,I,B,C,j,w,S,L,e,s,r,A,O,E,P,D,U]}class zn extends Re{constructor(e){super(),He(this,e,qn,Hn,qe,{},null,[-1,-1])}}function qs(l,e,t){const s=l.slice();return s[10]=e[t],s}function Wn(l){let e;return{c(){e=J(" ")},l(t){e=Q(t," ")},m(t,s){F(t,e,s)},p:fe,d(t){t&&m(e)}}}function $n(l){let e,t,s="Played:",n,o=se(l[2]),a=[];for(let r=0;r<o.length;r+=1)a[r]=zs(qs(l,o,r));return{c(){e=v("div"),t=v("span"),t.textContent=s,n=G();for(let r=0;r<a.length;r+=1)a[r].c()},l(r){e=g(r,"DIV",{});var i=T(e);t=g(i,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1g6xxhn"&&(t.textContent=s),n=M(i);for(let c=0;c<a.length;c+=1)a[c].l(i);i.forEach(m)},m(r,i){F(r,e,i),u(e,t),u(e,n);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(e,null)},p(r,i){if(i&4){o=se(r[2]);let c;for(c=0;c<o.length;c+=1){const h=qs(r,o,c);a[c]?a[c].p(h,i):(a[c]=zs(h),a[c].c(),a[c].m(e,null))}for(;c<a.length;c+=1)a[c].d(1);a.length=o.length}},d(r){r&&m(e),Ie(a,r)}}}function Jn(l){let e,t,s="Result:",n,o,a,r=l[0].correct+"",i,c,h=l[0].sampled.length+"",f,_,y,p,k,b=l[0].avgTime+"",N,I;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=G(),o=v("span"),a=J("["),i=J(r),c=J(" / "),f=J(h),_=J("]"),y=G(),p=v("span"),k=J("avg "),N=J(b),I=J("s"),this.h()},l(B){e=g(B,"DIV",{class:!0});var C=T(e);t=g(C,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1eqfbgx"&&(t.textContent=s),n=M(C),o=g(C,"SPAN",{class:!0});var j=T(o);a=Q(j,"["),i=Q(j,r),c=Q(j," / "),f=Q(j,h),_=Q(j,"]"),j.forEach(m),y=M(C),p=g(C,"SPAN",{});var w=T(p);k=Q(w,"avg "),N=Q(w,b),I=Q(w,"s"),w.forEach(m),C.forEach(m),this.h()},h(){d(o,"class","mx-2"),d(e,"class","flex")},m(B,C){F(B,e,C),u(e,t),u(e,n),u(e,o),u(o,a),u(o,i),u(o,c),u(o,f),u(o,_),u(e,y),u(e,p),u(p,k),u(p,N),u(p,I)},p(B,C){C&1&&r!==(r=B[0].correct+"")&&ne(i,r),C&1&&h!==(h=B[0].sampled.length+"")&&ne(f,h),C&1&&b!==(b=B[0].avgTime+"")&&ne(N,b)},d(B){B&&m(e)}}}function Qn(l){var S,L,A,O;let e,t,s="Target:",n,o,a=((S=l[0].latestGuess.target)==null?void 0:S.chord)+"",r,i,c,h=((L=l[0].latestGuess.target)==null?void 0:L.notes.map(Ws).join(" "))+"",f,_,y,p="Guessed:",k,b,N=((A=l[0].latestGuess.guessed)==null?void 0:A.chord)+"",I,B,C,j=((O=l[0].latestGuess.guessed)==null?void 0:O.notes.map($s).join(" "))+"",w;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=G(),o=v("span"),r=J(a),i=G(),c=v("span"),f=J(h),_=G(),y=v("span"),y.textContent=p,k=G(),b=v("span"),I=J(N),B=G(),C=v("span"),w=J(j),this.h()},l(E){e=g(E,"DIV",{class:!0});var P=T(e);t=g(P,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=M(P),o=g(P,"SPAN",{});var D=T(o);r=Q(D,a),D.forEach(m),i=M(P),c=g(P,"SPAN",{});var U=T(c);f=Q(U,h),U.forEach(m),_=M(P),y=g(P,"SPAN",{"data-svelte-h":!0}),Z(y)!=="svelte-104368"&&(y.textContent=p),k=M(P),b=g(P,"SPAN",{});var V=T(b);I=Q(V,N),V.forEach(m),B=M(P),C=g(P,"SPAN",{});var K=T(C);w=Q(K,j),K.forEach(m),P.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(E,P){F(E,e,P),u(e,t),u(e,n),u(e,o),u(o,r),u(e,i),u(e,c),u(c,f),u(e,_),u(e,y),u(e,k),u(e,b),u(b,I),u(e,B),u(e,C),u(C,w)},p(E,P){var D,U,V,K;P&1&&a!==(a=((D=E[0].latestGuess.target)==null?void 0:D.chord)+"")&&ne(r,a),P&1&&h!==(h=((U=E[0].latestGuess.target)==null?void 0:U.notes.map(Ws).join(" "))+"")&&ne(f,h),P&1&&N!==(N=((V=E[0].latestGuess.guessed)==null?void 0:V.chord)+"")&&ne(I,N),P&1&&j!==(j=((K=E[0].latestGuess.guessed)==null?void 0:K.notes.map($s).join(" "))+"")&&ne(w,j)},d(E){E&&m(e)}}}function Yn(l){let e,t,s="Target:",n,o,a=l[0].latestGuess.target+"",r,i,c,h,f,_="Guessed:",y,p,k=l[0].latestGuess.guessed+"",b,N,I;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=G(),o=v("span"),r=J(a),i=G(),c=v("span"),h=G(),f=v("span"),f.textContent=_,y=G(),p=v("span"),b=J(k),N=G(),I=v("span"),this.h()},l(B){e=g(B,"DIV",{class:!0});var C=T(e);t=g(C,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=M(C),o=g(C,"SPAN",{});var j=T(o);r=Q(j,a),j.forEach(m),i=M(C),c=g(C,"SPAN",{}),T(c).forEach(m),h=M(C),f=g(C,"SPAN",{"data-svelte-h":!0}),Z(f)!=="svelte-104368"&&(f.textContent=_),y=M(C),p=g(C,"SPAN",{});var w=T(p);b=Q(w,k),w.forEach(m),N=M(C),I=g(C,"SPAN",{}),T(I).forEach(m),C.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(B,C){F(B,e,C),u(e,t),u(e,n),u(e,o),u(o,r),u(e,i),u(e,c),u(e,h),u(e,f),u(e,y),u(e,p),u(p,b),u(e,N),u(e,I)},p(B,C){C&1&&a!==(a=B[0].latestGuess.target+"")&&ne(r,a),C&1&&k!==(k=B[0].latestGuess.guessed+"")&&ne(b,k)},d(B){B&&m(e)}}}function Xn(l){let e,t,s="Target:",n,o,a=Qe(St(l[0].latestGuess.target||0))+"",r,i,c,h,f,_="Guessed:",y,p,k=Qe(St(l[0].latestGuess.guessed||0))+"",b,N,I;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=G(),o=v("span"),r=J(a),i=G(),c=v("span"),h=G(),f=v("span"),f.textContent=_,y=G(),p=v("span"),b=J(k),N=G(),I=v("span"),this.h()},l(B){e=g(B,"DIV",{class:!0});var C=T(e);t=g(C,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=M(C),o=g(C,"SPAN",{});var j=T(o);r=Q(j,a),j.forEach(m),i=M(C),c=g(C,"SPAN",{}),T(c).forEach(m),h=M(C),f=g(C,"SPAN",{"data-svelte-h":!0}),Z(f)!=="svelte-104368"&&(f.textContent=_),y=M(C),p=g(C,"SPAN",{});var w=T(p);b=Q(w,k),w.forEach(m),N=M(C),I=g(C,"SPAN",{}),T(I).forEach(m),C.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(B,C){F(B,e,C),u(e,t),u(e,n),u(e,o),u(o,r),u(e,i),u(e,c),u(e,h),u(e,f),u(e,y),u(e,p),u(p,b),u(e,N),u(e,I)},p(B,C){C&1&&a!==(a=Qe(St(B[0].latestGuess.target||0))+"")&&ne(r,a),C&1&&k!==(k=Qe(St(B[0].latestGuess.guessed||0))+"")&&ne(b,k)},d(B){B&&m(e)}}}function zs(l){let e,t=Qe(l[10])+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","mx-1")},m(n,o){F(n,e,o),u(e,s)},p(n,o){o&4&&t!==(t=Qe(n[10])+"")&&ne(s,t)},d(n){n&&m(e)}}}function Zn(l){let e;return{c(){e=J(" ")},l(t){e=Q(t," ")},m(t,s){F(t,e,s)},p:fe,d(t){t&&m(e)}}}function ea(l){let e,t="Next",s,n,o="Autoplay",a,r;return{c(){e=v("button"),e.textContent=t,s=G(),n=v("button"),n.textContent=o,this.h()},l(i){e=g(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1nvnoba"&&(e.textContent=t),s=M(i),n=g(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1cfj1sl"&&(n.textContent=o),this.h()},h(){d(e,"class","btn primary"),d(n,"class","btn primary")},m(i,c){F(i,e,c),F(i,s,c),F(i,n,c),a||(r=[R(e,"click",l[4]),R(n,"click",l[5])],a=!0)},p:fe,d(i){i&&(m(e),m(s),m(n)),a=!1,at(r)}}}function ta(l){let e,t="Stop autoplay",s,n;return{c(){e=v("button"),e.textContent=t,this.h()},l(o){e=g(o,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){d(e,"class","btn primary")},m(o,a){F(o,e,a),s||(n=R(e,"click",l[9]),s=!0)},p:fe,d(o){o&&m(e),s=!1,n()}}}function sa(l){let e,t="Try Again",s,n,o="Clear",a,r;return{c(){e=v("button"),e.textContent=t,s=G(),n=v("button"),n.textContent=o,this.h()},l(i){e=g(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-y911ux"&&(e.textContent=t),s=M(i),n=g(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-11mnk9v"&&(n.textContent=o),this.h()},h(){d(e,"class","btn primary"),d(n,"class","btn primary")},m(i,c){F(i,e,c),F(i,s,c),F(i,n,c),a||(r=[R(e,"click",l[6]),R(n,"click",l[7])],a=!0)},p:fe,d(i){i&&(m(e),m(s),m(n)),a=!1,at(r)}}}function la(l){let e,t,s,n;function o(f,_){return f[0]instanceof At&&(f[1]==="correct"||f[1]==="wrong")?Xn:f[0]instanceof It&&(f[1]==="correct"||f[1]==="wrong")?Yn:f[0]instanceof rt&&(f[1]==="correct"||f[1]==="wrong")?Qn:f[0]&&f[1]==="ended"?Jn:f[2].length>0?$n:Wn}let a=o(l),r=a(l);function i(f,_){return f[0]&&f[1]==="ended"?sa:f[0]&&f[3].autoplay?ta:f[0]?ea:Zn}let c=i(l),h=c(l);return{c(){e=v("div"),r.c(),s=G(),n=v("div"),h.c(),this.h()},l(f){e=g(f,"DIV",{class:!0});var _=T(e);r.l(_),_.forEach(m),s=M(f),n=g(f,"DIV",{class:!0});var y=T(n);h.l(y),y.forEach(m),this.h()},h(){d(e,"class",t=Se(`${l[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),d(n,"class","mt-2 h-8")},m(f,_){F(f,e,_),r.m(e,null),F(f,s,_),F(f,n,_),h.m(n,null)},p(f,[_]){a===(a=o(f))&&r?r.p(f,_):(r.d(1),r=a(f),r&&(r.c(),r.m(e,null))),_&256&&t!==(t=Se(`${f[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs")&&d(e,"class",t),c===(c=i(f))&&h?h.p(f,_):(h.d(1),h=c(f),h&&(h.c(),h.m(n,null)))},i:fe,o:fe,d(f){f&&(m(e),m(s),m(n)),r.d(),h.d()}}}const Ws=l=>l.note,$s=l=>l.note;function na(l,e,t){let s,n,o;oe(l,_t,_=>t(1,s=_)),oe(l,mt,_=>t(2,n=_)),oe(l,it,_=>t(3,o=_));let{game:a}=e;function r(){be.nextGuess()}function i(){be.setOptionValue("autoplay",!0),be.nextGuess()}function c(){a instanceof rt?be.play(a.type,a.opts):a&&be.play(a.type,void 0)}function h(){be.clearGame()}const f=()=>be.setOptionValue("autoplay",!1);return l.$$set=_=>{t(8,e=ye(ye({},e),ke(_))),"game"in _&&t(0,a=_.game)},e=ke(e),[a,s,n,o,r,i,c,h,e,f]}class aa extends Re{constructor(e){super(),He(this,e,na,la,qe,{game:0})}}function Js(l){let e;return{c(){e=v("li"),this.h()},l(t){e=g(t,"LI",{class:!0}),T(e).forEach(m),this.h()},h(){d(e,"class","m-[0.175rem] mr-0")},m(t,s){F(t,e,s)},d(t){t&&m(e)}}}function Qs(l){let e;return{c(){e=v("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),T(e).forEach(m),this.h()},h(){d(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-jvhfju")},m(t,s){F(t,e,s)},d(t){t&&m(e)}}}function Ys(l){let e,t=l[0].note.note+"",s;return{c(){e=v("div"),s=J(t),this.h()},l(n){e=g(n,"DIV",{class:!0});var o=T(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","absolute top-0 left-0")},m(n,o){F(n,e,o),u(e,s)},p(n,o){o&1&&t!==(t=n[0].note.note+"")&&ne(s,t)},d(n){n&&m(e)}}}function oa(l){let e,t,s,n,o,a,r=l[0].key+"",i,c,h,f,_=l[0].key==="{enter}"&&Js(),y=l[0].key==="{enter}"&&Qs(),p=l[0].note&&Ys(l);return{c(){_&&_.c(),e=G(),t=v("li"),s=v("button"),y&&y.c(),n=G(),p&&p.c(),o=G(),a=v("div"),i=J(r),this.h()},l(k){_&&_.l(k),e=M(k),t=g(k,"LI",{class:!0});var b=T(t);s=g(b,"BUTTON",{class:!0});var N=T(s);y&&y.l(N),n=M(N),p&&p.l(N),o=M(N),a=g(N,"DIV",{});var I=T(a);i=Q(I,r),I.forEach(m),N.forEach(m),b.forEach(m),this.h()},h(){d(s,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex items-center justify-center svelte-jvhfju"),d(t,"class",c=Se(`${l[1].class||""} m-[0.175rem] ${Xs(l[0].size)}`)+" svelte-jvhfju"),z(t,"enter",l[0].key==="{enter}")},m(k,b){_&&_.m(k,b),F(k,e,b),F(k,t,b),u(t,s),y&&y.m(s,null),u(s,n),p&&p.m(s,null),u(s,o),u(s,a),u(a,i),h||(f=R(s,"click",l[2]),h=!0)},p(k,[b]){k[0].key==="{enter}"?_||(_=Js(),_.c(),_.m(e.parentNode,e)):_&&(_.d(1),_=null),k[0].key==="{enter}"?y||(y=Qs(),y.c(),y.m(s,n)):y&&(y.d(1),y=null),k[0].note?p?p.p(k,b):(p=Ys(k),p.c(),p.m(s,o)):p&&(p.d(1),p=null),b&1&&r!==(r=k[0].key+"")&&ne(i,r),b&3&&c!==(c=Se(`${k[1].class||""} m-[0.175rem] ${Xs(k[0].size)}`)+" svelte-jvhfju")&&d(t,"class",c),b&3&&z(t,"enter",k[0].key==="{enter}")},i:fe,o:fe,d(k){k&&(m(e),m(t)),_&&_.d(k),y&&y.d(),p&&p.d(),h=!1,f()}}}function Xs(l){return l&&Number.isInteger(l)?`size-${l}`:l?`size-${Math.floor(l)}-${Math.floor(l*10)-Math.floor(l)*10}`:"size-1"}function ra(l,e,t){let{value:s}=e;function n(o){cs.call(this,l,o)}return l.$$set=o=>{t(1,e=ye(ye({},e),ke(o))),"value"in o&&t(0,s=o.value)},e=ke(e),[s,e,n]}class ia extends Re{constructor(e){super(),He(this,e,ra,oa,qe,{value:0})}}const ca={layout:{default:["§ 1 2 3 4 5 6 7 8 9 0 + ´ {bksp}","{tab} q w e r t y u i o p å ¨ {enter}","{lock} a s d f g h j k l ö ä '","{shift} < z x c v b n m , . - {shift}",".com @ {space}"],shift:['° ! " # $ % & / ( ) = ? ` {bksp}',"{tab} Q W E R T Y U I O P Å ^","{lock} A S D F G H J K L Ö Ä * {enter}","{shift} > Z X C V B N M ; : _ {shift}",".com @ {space}"]}},ua=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function fa(l,e){return l[1].forEach((t,s)=>{let n;s===2?n={...e[1]}:s===3?n={...e[3]}:s===5?n={...e[4]}:s===6?n={...e[8]}:s===7?n={...e[10]}:s===9?(n={...e[1]},n.semitones+=12):s===10&&(n={...e[3]},n.semitones+=12),l[1][s].note=n}),l[2].forEach((t,s)=>{let n;s===1?n={...e[0]}:s===2?n={...e[2]}:s===3?n={...e[4]}:s===4?n={...e[5]}:s===5?n={...e[7]}:s===6?n={...e[9]}:s===7?n={...e[11]}:s===8?(n={...e[0]},n.semitones+=12):s===9?(n={...e[2]},n.semitones+=12):s===10?(n={...e[4]},n.semitones+=12):s===11?(n={...e[5]},n.semitones+=12):s===12&&(n={...e[7]},n.semitones+=12),l[2][s].note=n}),l}class ha{constructor(e={layout:"middle-row"}){this.language="en",this.rows=[[],[],[],[]],this.opts=e,this.setLayout(ca)}setOptions(e){this.opts={...this.opts,...e}}setLayout(e){const t=[[],[],[],[]];e.layout.default.forEach((s,n)=>{s.split(" ").forEach((o,a)=>{n<4&&t[n].push({key:o,code:ua[n][a]})})}),this.rows=t}setNotes(e){this.opts.layout==="middle-row"&&(this.rows=fa(this.rows,e))}}const da=ct(Be({layout:"middle-row"}),{key:"keyboard-options"}),Ql=yt([bt,da],([l,e])=>{const t=new ha(e);return t.setNotes(Array.from(l.notesMap.values())),t}),ma=yt(Ql,l=>l.rows.map(e=>e.map((t,s)=>{let n;return t.key==="{bksp}"?n=2:t.key==="{tab}"?n=1.5:t.key==="{enter}"?n=2:t.key==="{lock}"?n=1.75:t.key==="{shift}"&&s===0?n=1.5:t.key==="{shift}"&&(n=2.5),n?{...t,size:n}:t}))),Yl=yt(Ql,l=>new Map([...l.rows[0].map(e=>[e.code,e]),...l.rows[1].map(e=>[e.code,e]),...l.rows[2].map(e=>[e.code,e]),...l.rows[3].map(e=>[e.code,e])]));yt(Yl,l=>Array.from(l.values()).map(e=>e.note).filter(e=>e!==void 0));function Zs(l,e,t){const s=l.slice();return s[7]=e[t],s[9]=t,s}function el(l,e,t){const s=l.slice();return s[10]=e[t],s}function tl(l){let e,t;return e=new ia({props:{value:l[10]}}),{c(){_e(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,n){ve(e,s,n),t=!0},p(s,n){const o={};n&4&&(o.value=s[10]),e.$set(o)},i(s){t||(q(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){ge(e,s)}}}function sl(l){let e,t,s,n,o=se(l[7]),a=[];for(let i=0;i<o.length;i+=1)a[i]=tl(el(l,o,i));const r=i=>$(a[i],1,1,()=>{a[i]=null});return{c(){e=v("li"),t=G();for(let i=0;i<a.length;i+=1)a[i].c();s=je(),this.h()},l(i){e=g(i,"LI",{class:!0}),T(e).forEach(m),t=M(i);for(let c=0;c<a.length;c+=1)a[c].l(i);s=je(),this.h()},h(){d(e,"class","col-span-2 svelte-cgcsqn")},m(i,c){F(i,e,c),F(i,t,c);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(i,c);F(i,s,c),n=!0},p(i,c){if(c&4){o=se(i[7]);let h;for(h=0;h<o.length;h+=1){const f=el(i,o,h);a[h]?(a[h].p(f,c),q(a[h],1)):(a[h]=tl(f),a[h].c(),q(a[h],1),a[h].m(s.parentNode,s))}for(tt(),h=o.length;h<a.length;h+=1)r(h);st()}},i(i){if(!n){for(let c=0;c<o.length;c+=1)q(a[c]);n=!0}},o(i){a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)$(a[c]);n=!1},d(i){i&&(m(e),m(t),m(s)),Ie(a,i)}}}function _a(l){let e,t,s,n,o="Middle-row",a,r,i,c,h,f="Two rows",_,y,p,k,b,N,I,B,C,j=se(l[2]),w=[];for(let L=0;L<j.length;L+=1)w[L]=sl(Zs(l,j,L));const S=L=>$(w[L],1,1,()=>{w[L]=null});return{c(){e=v("div"),t=v("div"),s=v("div"),n=v("label"),n.textContent=o,a=G(),r=v("input"),i=G(),c=v("div"),h=v("label"),h.textContent=f,_=G(),y=v("input"),p=G(),k=v("div"),b=v("ul");for(let L=0;L<w.length;L+=1)w[L].c();this.h()},l(L){e=g(L,"DIV",{class:!0});var A=T(e);t=g(A,"DIV",{class:!0});var O=T(t);s=g(O,"DIV",{class:!0});var E=T(s);n=g(E,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1ssbs6o"&&(n.textContent=o),a=M(E),r=g(E,"INPUT",{class:!0,id:!0,type:!0}),E.forEach(m),i=M(O),c=g(O,"DIV",{class:!0});var P=T(c);h=g(P,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(h)!=="svelte-3aw9ul"&&(h.textContent=f),_=M(P),y=g(P,"INPUT",{class:!0,id:!0,type:!0}),P.forEach(m),O.forEach(m),p=M(A),k=g(A,"DIV",{class:!0});var D=T(k);b=g(D,"UL",{class:!0});var U=T(b);for(let V=0;V<w.length;V+=1)w[V].l(U);U.forEach(m),D.forEach(m),A.forEach(m),this.h()},h(){d(n,"class","font-bold mr-4"),d(n,"for","middle-row"),d(r,"class","h-[20px]"),d(r,"id","middle-row"),d(r,"type","checkbox"),d(s,"class","my-1 flex items-center justify-between mr-12"),d(h,"class","font-bold mr-4"),d(h,"for","two-rows"),d(y,"class","h-[20px]"),d(y,"id","two-rows"),d(y,"type","checkbox"),d(c,"class","my-1 flex items-center justify-between mr-12"),d(t,"class","flex"),d(b,"class","keyboard svelte-cgcsqn"),d(k,"class","flex flex-col gap-1.5"),d(e,"class",N=Se(`${l[3].class||""} `)+" svelte-cgcsqn")},m(L,A){F(L,e,A),u(e,t),u(t,s),u(s,n),u(s,a),u(s,r),r.checked=l[0],u(t,i),u(t,c),u(c,h),u(c,_),u(c,y),y.checked=l[1],u(e,p),u(e,k),u(k,b);for(let O=0;O<w.length;O+=1)w[O]&&w[O].m(b,null);I=!0,B||(C=[R(r,"change",l[4]),R(y,"change",l[5])],B=!0)},p(L,[A]){if(A&1&&(r.checked=L[0]),A&2&&(y.checked=L[1]),A&4){j=se(L[2]);let O;for(O=0;O<j.length;O+=1){const E=Zs(L,j,O);w[O]?(w[O].p(E,A),q(w[O],1)):(w[O]=sl(E),w[O].c(),q(w[O],1),w[O].m(b,null))}for(tt(),O=j.length;O<w.length;O+=1)S(O);st()}(!I||A&8&&N!==(N=Se(`${L[3].class||""} `)+" svelte-cgcsqn"))&&d(e,"class",N)},i(L){if(!I){for(let A=0;A<j.length;A+=1)q(w[A]);I=!0}},o(L){w=w.filter(Boolean);for(let A=0;A<w.length;A+=1)$(w[A]);I=!1},d(L){L&&m(e),Ie(w,L),B=!1,at(C)}}}function pa(l,e,t){let s,n;oe(l,Yl,c=>t(6,s=c)),oe(l,ma,c=>t(2,n=c)),Gl(()=>{console.log(s)});let o=!0,a=!1;function r(){o=this.checked,t(0,o)}function i(){a=this.checked,t(1,a)}return l.$$set=c=>{t(3,e=ye(ye({},e),ke(c)))},e=ke(e),[o,a,n,e,r,i]}class va extends Re{constructor(e){super(),He(this,e,pa,_a,qe,{})}}function ll(l){let e,t;return e=new va({props:{class:"mt-4"}}),{c(){_e(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,n){ve(e,s,n),t=!0},i(s){t||(q(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){ge(e,s)}}}function ga(l){let e,t,s,n,o="I/O",a,r,i,c,h="Device",f,_,y,p,k,b,N="Prompt",I,B,C="Disable",j,w,S,L,A="Sound",O,E,P,D,U,V,K="Fixed velocity",H,ee,te,he,re,Ge,Ue="Keyboard",Me,me,ze,Fe,Te,ae,Ae="Hotkeys",de,W,le,x,Y,ie,X="Auto-octave",we,De,lt,We,Ve,Ne,Ce,Tt="Set keys",kt,Ke,ut,ms="Fade timeout",Qt,Ye,Yt,ft,jt,Xt,ht,_s="Reset all",Zt,Dt,$e,es,ps,Le=l[2]&&ll();return{c(){e=v("div"),t=v("fieldset"),s=v("legend"),n=v("button"),n.textContent=o,a=G(),r=v("div"),i=v("div"),c=v("label"),c.textContent=h,f=G(),_=v("input"),p=G(),k=v("div"),b=v("button"),b.textContent=N,I=G(),B=v("button"),B.textContent=C,j=G(),w=v("div"),S=v("div"),L=v("label"),L.textContent=A,O=G(),E=v("input"),D=G(),U=v("div"),V=v("label"),V.textContent=K,H=G(),ee=v("input"),te=G(),he=v("div"),re=v("div"),Ge=v("label"),Ge.textContent=Ue,Me=G(),me=v("input"),Fe=G(),Te=v("div"),ae=v("label"),ae.textContent=Ae,de=G(),W=v("input"),x=G(),Y=v("div"),ie=v("label"),ie.textContent=X,we=G(),De=v("input"),We=G(),Ve=v("div"),Ne=v("div"),Ce=v("button"),Ce.textContent=Tt,kt=G(),Ke=v("div"),ut=v("label"),ut.textContent=ms,Qt=G(),Ye=v("input"),Yt=G(),ft=v("div"),jt=v("div"),Xt=G(),ht=v("button"),ht.textContent=_s,Zt=G(),Le&&Le.c(),this.h()},l(Ee){e=g(Ee,"DIV",{class:!0});var Oe=T(e);t=g(Oe,"FIELDSET",{class:!0});var ot=T(t);s=g(ot,"LEGEND",{class:!0});var vs=T(s);n=g(vs,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1jbbsti"&&(n.textContent=o),vs.forEach(m),a=M(ot),r=g(ot,"DIV",{class:!0});var dt=T(r);i=g(dt,"DIV",{class:!0});var wt=T(i);c=g(wt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(c)!=="svelte-crpa7y"&&(c.textContent=h),f=M(wt),_=g(wt,"INPUT",{class:!0,id:!0}),p=M(wt),k=g(wt,"DIV",{class:!0});var Lt=T(k);b=g(Lt,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(b)!=="svelte-mj6mct"&&(b.textContent=N),I=M(Lt),B=g(Lt,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(B)!=="svelte-1sl6oxh"&&(B.textContent=C),Lt.forEach(m),wt.forEach(m),j=M(dt),w=g(dt,"DIV",{class:!0});var Pt=T(w);S=g(Pt,"DIV",{class:!0});var Bt=T(S);L=g(Bt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(L)!=="svelte-wgxtkw"&&(L.textContent=A),O=M(Bt),E=g(Bt,"INPUT",{class:!0,id:!0,type:!0}),Bt.forEach(m),D=M(Pt),U=g(Pt,"DIV",{class:!0});var Gt=T(U);V=g(Gt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(V)!=="svelte-1tm2bth"&&(V.textContent=K),H=M(Gt),ee=g(Gt,"INPUT",{class:!0,id:!0,placeholder:!0}),Gt.forEach(m),Pt.forEach(m),te=M(dt),he=g(dt,"DIV",{class:!0});var Ct=T(he);re=g(Ct,"DIV",{class:!0});var Mt=T(re);Ge=g(Mt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(Ge)!=="svelte-1js269u"&&(Ge.textContent=Ue),Me=M(Mt),me=g(Mt,"INPUT",{class:!0,id:!0,type:!0}),Mt.forEach(m),Fe=M(Ct),Te=g(Ct,"DIV",{class:!0});var Vt=T(Te);ae=g(Vt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(ae)!=="svelte-21h39k"&&(ae.textContent=Ae),de=M(Vt),W=g(Vt,"INPUT",{class:!0,id:!0,type:!0}),Vt.forEach(m),x=M(Ct),Y=g(Ct,"DIV",{class:!0});var Kt=T(Y);ie=g(Kt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(ie)!=="svelte-33lczu"&&(ie.textContent=X),we=M(Kt),De=g(Kt,"INPUT",{class:!0,id:!0,type:!0}),Kt.forEach(m),Ct.forEach(m),We=M(dt),Ve=g(dt,"DIV",{class:!0});var Et=T(Ve);Ne=g(Et,"DIV",{class:!0});var gs=T(Ne);Ce=g(gs,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(Ce)!=="svelte-1npcis2"&&(Ce.textContent=Tt),gs.forEach(m),kt=M(Et),Ke=g(Et,"DIV",{class:!0});var Ot=T(Ke);ut=g(Ot,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(ut)!=="svelte-vd5i27"&&(ut.textContent=ms),Qt=M(Ot),Ye=g(Ot,"INPUT",{class:!0,id:!0}),Ot.forEach(m),Yt=M(Et),ft=g(Et,"DIV",{class:!0});var Ft=T(ft);jt=g(Ft,"DIV",{}),T(jt).forEach(m),Xt=M(Ft),ht=g(Ft,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(ht)!=="svelte-jjt0c3"&&(ht.textContent=_s),Ft.forEach(m),Et.forEach(m),dt.forEach(m),Zt=M(ot),Le&&Le.l(ot),ot.forEach(m),Oe.forEach(m),this.h()},h(){var Ee;d(n,"class","px-1 rounded hover:bg-gray-100"),d(s,"class","text-base"),d(c,"class","font-bold"),d(c,"for","device"),d(_,"class","px-1 my-1 rounded w-50"),d(_,"id","device"),_.disabled=!0,_.value=y=((Ee=l[5])==null?void 0:Ee.name)??"No device",d(b,"class","btn-sm primary mr-2"),d(B,"class","btn-sm primary"),d(k,"class","flex my-[auto]"),d(i,"class","h-full flex flex-col"),d(L,"class","font-bold"),d(L,"for","sound"),d(E,"class","h-[20px]"),d(E,"id","sound"),d(E,"type","checkbox"),E.checked=P=l[3].useSound,d(S,"class","my-1 flex justify-between mr-12"),d(V,"class","font-bold"),d(V,"for","fixed-velocity"),d(ee,"class","h-[20px] w-16"),d(ee,"id","fixed-velocity"),d(ee,"placeholder","0-127"),d(U,"class","flex justify-between"),d(w,"class","flex flex-col h-full"),d(Ge,"class","font-bold"),d(Ge,"for","keyboard"),d(me,"class","h-[20px]"),d(me,"id","keyboard"),d(me,"type","checkbox"),me.checked=ze=l[3].useKeyboard,d(re,"class","my-1 flex justify-between mr-12"),d(ae,"class","font-bold"),d(ae,"for","hotkeys"),d(W,"class","h-[20px]"),d(W,"id","hotkeys"),d(W,"type","checkbox"),W.checked=le=l[3].useHotkeys,d(Te,"class","my-1 flex justify-between mr-12"),d(ie,"class","font-bold"),d(ie,"for","auto-octave"),d(De,"class","h-[20px]"),d(De,"id","auto-octave"),d(De,"type","checkbox"),De.checked=lt=l[3].useAutoOctave,d(Y,"class","my-1 flex justify-between mr-12"),d(he,"class","flex flex-col h-full"),d(Ce,"class","w-full btn-sm primary"),d(Ne,"class","flex justify-between"),d(ut,"class","font-bold"),d(ut,"for","fade-timeout"),d(Ye,"class","h-[20px] w-16"),d(Ye,"id","fade-timeout"),Ye.value=l[1],d(Ke,"class","flex justify-between"),d(ht,"class","btn-sm primary"),d(ft,"class","flex justify-between"),d(Ve,"class","flex flex-col justify-between h-full"),d(r,"class","body svelte-1bpw69s"),z(r,"hidden",l[4]),d(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-1bpw69s"),z(t,"collapsed",l[4]),d(e,"class",Dt=Se(`${l[11].class||""}`)+" svelte-1bpw69s")},m(Ee,Oe){F(Ee,e,Oe),u(e,t),u(t,s),u(s,n),u(t,a),u(t,r),u(r,i),u(i,c),u(i,f),u(i,_),u(i,p),u(i,k),u(k,b),u(k,I),u(k,B),u(r,j),u(r,w),u(w,S),u(S,L),u(S,O),u(S,E),u(w,D),u(w,U),u(U,V),u(U,H),u(U,ee),Je(ee,l[0]),u(r,te),u(r,he),u(he,re),u(re,Ge),u(re,Me),u(re,me),u(he,Fe),u(he,Te),u(Te,ae),u(Te,de),u(Te,W),u(he,x),u(he,Y),u(Y,ie),u(Y,we),u(Y,De),u(r,We),u(r,Ve),u(Ve,Ne),u(Ne,Ce),u(Ve,kt),u(Ve,Ke),u(Ke,ut),u(Ke,Qt),u(Ke,Ye),u(Ve,Yt),u(Ve,ft),u(ft,jt),u(ft,Xt),u(ft,ht),u(t,Zt),Le&&Le.m(t,null),$e=!0,es||(ps=[R(n,"click",l[7]),R(b,"click",ue.openMidi),R(B,"click",ue.disableMidi),R(E,"change",l[12]),R(ee,"input",l[13]),R(ee,"focus",l[14]),R(ee,"change",l[8]),R(me,"change",l[15]),R(W,"change",l[16]),R(De,"change",l[17]),R(Ce,"click",l[18]),R(Ye,"focus",l[19]),R(Ye,"blur",l[20]),R(Ye,"input",l[9]),R(ht,"click",l[10])],es=!0)},p(Ee,[Oe]){var ot;(!$e||Oe&32&&y!==(y=((ot=Ee[5])==null?void 0:ot.name)??"No device")&&_.value!==y)&&(_.value=y),(!$e||Oe&8&&P!==(P=Ee[3].useSound))&&(E.checked=P),Oe&1&&ee.value!==Ee[0]&&Je(ee,Ee[0]),(!$e||Oe&8&&ze!==(ze=Ee[3].useKeyboard))&&(me.checked=ze),(!$e||Oe&8&&le!==(le=Ee[3].useHotkeys))&&(W.checked=le),(!$e||Oe&8&&lt!==(lt=Ee[3].useAutoOctave))&&(De.checked=lt),(!$e||Oe&2&&Ye.value!==Ee[1])&&(Ye.value=Ee[1]),(!$e||Oe&16)&&z(r,"hidden",Ee[4]),Ee[2]?Le?Oe&4&&q(Le,1):(Le=ll(),Le.c(),q(Le,1),Le.m(t,null)):Le&&(tt(),$(Le,1,1,()=>{Le=null}),st()),(!$e||Oe&16)&&z(t,"collapsed",Ee[4]),(!$e||Oe&2048&&Dt!==(Dt=Se(`${Ee[11].class||""}`)+" svelte-1bpw69s"))&&d(e,"class",Dt)},i(Ee){$e||(q(Le),$e=!0)},o(Ee){$(Le),$e=!1},d(Ee){Ee&&m(e),Le&&Le.d(),es=!1,at(ps)}}}function ba(l,e,t){let s,n,o;oe(l,vt,S=>t(3,s=S)),oe(l,$t,S=>t(5,o=S));const a=ct(Be(!1),{key:"inputs-hidden"});oe(l,a,S=>t(4,n=S));let r=s.fixedVelocity??"",i=s.keyFadeTimeout,c=!1;vt.subscribe(S=>{t(0,r=S.fixedVelocity??""),t(1,i=S.keyFadeTimeout)});function h(){a.update(S=>!S)}function f(S){const{value:L}=S.currentTarget;let A;if(L)try{A=parseInt(L)}catch{}A!==void 0&&A>=0&&A<=127?ue.setInputValue("fixedVelocity",A):L?t(0,r=s.fixedVelocity||""):ue.setInputValue("fixedVelocity",void 0),ue.setKeyboardFocus(!0)}function _(S){try{const L=parseInt(S.currentTarget.value);ue.setInputValue("keyFadeTimeout",L)}catch{t(1,i=s.keyFadeTimeout)}}function y(){Tn()}const p=S=>ue.setInputValue("useSound",S.currentTarget.checked);function k(){r=this.value,t(0,r)}const b=()=>ue.setKeyboardFocus(!1),N=S=>ue.setInputValue("useKeyboard",S.currentTarget.checked),I=S=>ue.setInputValue("useHotkeys",S.currentTarget.checked),B=S=>ue.setInputValue("useAutoOctave",S.currentTarget.checked),C=()=>t(2,c=!c),j=()=>ue.setKeyboardFocus(!1),w=()=>ue.setKeyboardFocus(!0);return l.$$set=S=>{t(11,e=ye(ye({},e),ke(S)))},e=ke(e),[r,i,c,s,n,o,a,h,f,_,y,e,p,k,b,N,I,B,C,j,w]}class ya extends Re{constructor(e){super(),He(this,e,ba,ga,qe,{})}}function ka(l){let e;return{c(){e=J(" ")},l(t){e=Q(t," ")},m(t,s){F(t,e,s)},p:fe,d(t){t&&m(e)}}}function wa(l){let e,t=l[2].note+"",s;return{c(){e=J("Input: "),s=J(t)},l(n){e=Q(n,"Input: "),s=Q(n,t)},m(n,o){F(n,e,o),F(n,s,o)},p(n,o){o&4&&t!==(t=n[2].note+"")&&ne(s,t)},d(n){n&&(m(e),m(s))}}}function Ca(l){let e,t;return{c(){e=J("Input: "),t=J(l[1])},l(s){e=Q(s,"Input: "),t=Q(s,l[1])},m(s,n){F(s,e,n),F(s,t,n)},p(s,n){n&2&&ne(t,s[1])},d(s){s&&(m(e),m(t))}}}function Ea(l){let e;return{c(){e=J(l[0])},l(t){e=Q(t,l[0])},m(t,s){F(t,e,s)},p(t,s){s&1&&ne(e,t[0])},d(t){t&&m(e)}}}function Sa(l){let e,t,s,n;function o(i,c){return i[3].useKeyboard&&i[0]?Ea:i[3].useKeyboard&&i[1]?Ca:i[3].useKeyboard&&i[2]?wa:ka}let a=o(l),r=a(l);return{c(){e=v("div"),r.c(),this.h()},l(i){e=g(i,"DIV",{class:!0});var c=T(e);r.l(c),c.forEach(m),this.h()},h(){d(e,"class",t=`${l[5].class||""}`)},m(i,c){F(i,e,c),r.m(e,null),s||(n=R(window,"keydown",l[4]),s=!0)},p(i,[c]){a===(a=o(i))&&r?r.p(i,c):(r.d(1),r=a(i),r&&(r.c(),r.m(e,null))),c&32&&t!==(t=`${i[5].class||""}`)&&d(e,"class",t)},i:fe,o:fe,d(i){i&&m(e),r.d(),s=!1,n()}}}const Aa=/^[a-gA-G]$/,Ta=/^[♭Bb#♯sS]$/,Na=/^[0-9]$/;function Ia(l,e,t){let s,n,o,a,r;oe(l,vt,k=>t(3,s=k)),oe(l,$l,k=>t(7,n=k)),oe(l,pt,k=>t(8,o=k)),oe(l,Wl,k=>t(9,a=k)),oe(l,Jt,k=>t(10,r=k));let{debounced:i}=e;const c=sn();let h="",f="",_;function y(k){const b=k.key.toUpperCase(),N=n;let I;if(!_&&s.useHotkeys&&b in N){const B=N[b];t(2,_=B),t(0,h=""),s.useAutoOctave&&(I=ql(r[0].midi))}else!s.useHotkeys&&f.length===0&&Aa.test(b)?t(1,f+=b):!s.useHotkeys&&f.length>0&&Ta.test(b)&&(b==="B"?t(1,f+="♭"):t(1,f+="♯"));if(Na.test(b))try{I=parseInt(b)}catch{}if(_&&I!==void 0){const B=_.semitones+(I+1+(k.shiftKey?1:0))*12;c("note",B),t(2,_=void 0)}else if(f&&I!==void 0){const B=ce.findNote(f),C=B?B.semitones+(I+1)*12:void 0;C!==void 0&&c("note",C),t(1,f="")}else k.key==="Backspace"&&(t(2,_=void 0),t(1,f=f.slice(0,-1)))}function p(k){if(i||!a)return;const b=o;if(b instanceof It){const N=k.key.toUpperCase(),I=n;if(f.length===0&&N in I){const B=I[N].note;c("guessed-key",B),t(1,f="")}else k.key==="Backspace"&&t(1,f=f.slice(0,-1))}else if(b instanceof rt&&b.type==="chords-write")if(k.key==="Enter"&&f.length>0){let N={note:"",flats:0,sharps:0,chord:""};for(let I=0;I<f.length;I+=1)I===0?N.note+=f[I]:N.chord.length>0?N.chord+=f[I]:f[I]==="b"||f[I]==="♭"?N.flats+=1:f[I]==="#"||f[I]==="♯"?N.sharps+=1:N.chord+=f[I];c("guessed-chord",N),t(1,f="")}else k.key==="Backspace"?t(1,f=f.slice(0,-1)):k.key.length===1&&(t(1,f+=k.key),f.length===1&&t(1,f=f.toUpperCase()));else s.useKeyboard&&y(k)}return l.$$set=k=>{t(5,e=ye(ye({},e),ke(k))),"debounced"in k&&t(6,i=k.debounced)},e=ke(e),[h,f,_,s,p,e,i]}class ja extends Re{constructor(e){super(),He(this,e,Ia,Sa,qe,{debounced:6})}}function Da(l){let e,t,s,n="Count",o,a,r,i,c,h="Duplicates",f,_,y,p,k,b,N="Autoplay",I,B,C,j,w,S,L="Wait seconds",A,O,E,P,D;return{c(){e=v("ul"),t=v("li"),s=v("label"),s.textContent=n,o=G(),a=v("input"),r=G(),i=v("li"),c=v("label"),c.textContent=h,f=G(),_=v("input"),p=G(),k=v("li"),b=v("label"),b.textContent=N,I=G(),B=v("input"),j=G(),w=v("li"),S=v("label"),S.textContent=L,A=G(),O=v("input"),this.h()},l(U){e=g(U,"UL",{class:!0});var V=T(e);t=g(V,"LI",{class:!0});var K=T(t);s=g(K,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(s)!=="svelte-wgq9fc"&&(s.textContent=n),o=M(K),a=g(K,"INPUT",{class:!0,id:!0,type:!0}),K.forEach(m),r=M(V),i=g(V,"LI",{class:!0});var H=T(i);c=g(H,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(c)!=="svelte-hcg9dq"&&(c.textContent=h),f=M(H),_=g(H,"INPUT",{class:!0,id:!0,type:!0}),H.forEach(m),p=M(V),k=g(V,"LI",{class:!0});var ee=T(k);b=g(ee,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(b)!=="svelte-lr68n2"&&(b.textContent=N),I=M(ee),B=g(ee,"INPUT",{class:!0,id:!0,type:!0}),ee.forEach(m),j=M(V),w=g(V,"LI",{class:!0});var te=T(w);S=g(te,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(S)!=="svelte-1qj2vcy"&&(S.textContent=L),A=M(te),O=g(te,"INPUT",{class:!0,id:!0,type:!0}),te.forEach(m),V.forEach(m),this.h()},h(){d(s,"class","font-bold"),d(s,"for","guess-count"),d(a,"class","h-[20px] w-10"),d(a,"id","guess-count"),d(a,"type","number"),d(t,"class","flex items-center justify-between svelte-1elvih2"),d(c,"class","font-bold"),d(c,"for","duplicates"),d(_,"class","h-[20px]"),d(_,"id","duplicates"),d(_,"type","checkbox"),_.checked=y=l[2].duplicates,d(i,"class","flex items-center justify-between mr-6 svelte-1elvih2"),d(b,"class","font-bold"),d(b,"for","autoplay"),d(B,"class","h-[20px]"),d(B,"id","autoplay"),d(B,"type","checkbox"),B.checked=C=l[2].autoplay,d(k,"class","flex items-center justify-between mr-6 svelte-1elvih2"),d(S,"class","font-bold"),d(S,"for","wait-ms"),d(O,"class","h-[20px] w-10"),d(O,"id","wait-ms"),d(O,"type","number"),d(w,"class","flex items-center justify-between svelte-1elvih2"),d(e,"class",E=Se(`${l[5].class||""}`)+" svelte-1elvih2")},m(U,V){F(U,e,V),u(e,t),u(t,s),u(t,o),u(t,a),Je(a,l[0]),u(e,r),u(e,i),u(i,c),u(i,f),u(i,_),u(e,p),u(e,k),u(k,b),u(k,I),u(k,B),u(e,j),u(e,w),u(w,S),u(w,A),u(w,O),Je(O,l[1]),P||(D=[R(a,"input",l[6]),R(a,"input",l[3]),R(_,"input",l[7]),R(B,"input",l[8]),R(O,"input",l[9]),R(O,"input",l[4])],P=!0)},p(U,[V]){V&1&&Ht(a.value)!==U[0]&&Je(a,U[0]),V&4&&y!==(y=U[2].duplicates)&&(_.checked=y),V&4&&C!==(C=U[2].autoplay)&&(B.checked=C),V&2&&Ht(O.value)!==U[1]&&Je(O,U[1]),V&32&&E!==(E=Se(`${U[5].class||""}`)+" svelte-1elvih2")&&d(e,"class",E)},i:fe,o:fe,d(U){U&&m(e),P=!1,at(D)}}}function La(l,e,t){let s;oe(l,it,_=>t(2,s=_));let n=s.count||"",o=s.waitSeconds||"";it.subscribe(_=>{t(0,n=_.count||""),t(1,o=_.waitSeconds||"")});function a({currentTarget:{value:_}}){let y;try{y=parseInt(_),y<=0&&(y=1),be.setOptionValue("count",y)}catch{t(0,n=s.count)}}function r({currentTarget:{value:_}}){let y;try{y=parseInt(_),y<0&&(y=0),be.setOptionValue("waitSeconds",y)}catch{t(1,o=s.waitSeconds)}}function i(){n=Ht(this.value),t(0,n)}const c=_=>be.setOptionValue("duplicates",_.currentTarget.checked),h=_=>be.setOptionValue("autoplay",_.currentTarget.checked);function f(){o=Ht(this.value),t(1,o)}return l.$$set=_=>{t(5,e=ye(ye({},e),ke(_)))},e=ke(e),[n,o,s,a,r,e,i,c,h,f]}class Pa extends Re{constructor(e){super(),He(this,e,La,Da,qe,{})}}function nl(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function al(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function ol(l){let e,t,s=l[21]+"",n,o,a,r,i,c,h,f;function _(){return l[13](l[20])}r=new nt({props:{icon:ns,width:20}});function y(...p){return l[14](l[20],...p)}return{c(){e=v("li"),t=v("button"),n=J(s),o=G(),a=v("button"),_e(r.$$.fragment),i=G(),this.h()},l(p){e=g(p,"LI",{class:!0});var k=T(e);t=g(k,"BUTTON",{class:!0});var b=T(t);n=Q(b,s),b.forEach(m),o=M(k),a=g(k,"BUTTON",{class:!0});var N=T(a);pe(r.$$.fragment,N),N.forEach(m),i=M(k),k.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),z(t,"selected",l[20]===l[0]),d(a,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),d(e,"class","flex svelte-1okhpct")},m(p,k){F(p,e,k),u(e,t),u(t,n),u(e,o),u(e,a),ve(r,a,null),u(e,i),c=!0,h||(f=[R(t,"click",_),R(a,"click",y)],h=!0)},p(p,k){l=p,(!c||k&17)&&z(t,"selected",l[20]===l[0])},i(p){c||(q(r.$$.fragment,p),c=!0)},o(p){$(r.$$.fragment,p),c=!1},d(p){p&&m(e),ge(r),h=!1,at(f)}}}function rl(l){let e,t=se(l[2]),s=[];for(let n=0;n<t.length;n+=1)s[n]=il(nl(l,t,n));return{c(){e=v("ul");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=g(n,"UL",{class:!0});var o=T(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","svelte-1okhpct")},m(n,o){F(n,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,o){if(o&518){t=se(n[2]);let a;for(a=0;a<t.length;a+=1){const r=nl(n,t,a);s[a]?s[a].p(r,o):(s[a]=il(r),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function il(l){let e,t,s=l[21]+"",n,o,a,r;function i(){return l[15](l[20])}return{c(){e=v("li"),t=v("button"),n=J(s),o=G(),this.h()},l(c){e=g(c,"LI",{class:!0});var h=T(e);t=g(h,"BUTTON",{class:!0});var f=T(t);n=Q(f,s),f.forEach(m),o=M(h),h.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),z(t,"selected",l[20]===l[1]),d(e,"class","svelte-1okhpct")},m(c,h){F(c,e,h),u(e,t),u(t,n),u(e,o),a||(r=R(t,"click",i),a=!0)},p(c,h){l=c,h&4&&s!==(s=l[21]+"")&&ne(n,s),h&6&&z(t,"selected",l[20]===l[1])},d(c){c&&m(e),a=!1,r()}}}function Ba(l){let e,t,s="Play",n,o,a,r,i,c,h,f,_,y,p="Reset",k,b,N,I,B=l[3]?"Quit":"Play",C,j,w,S,L,A=se(l[4]),O=[];for(let D=0;D<A.length;D+=1)O[D]=ol(al(l,A,D));const E=D=>$(O[D],1,1,()=>{O[D]=null});let P=(l[0]==="chords-write"||l[0]==="chords-play")&&rl(l);return h=new Pa({props:{class:"game-options"}}),N=new nt({props:{class:"mr-1",icon:l[3]?Es:ns,width:20}}),{c(){e=v("fieldset"),t=v("legend"),t.textContent=s,n=G(),o=v("div"),a=v("ul");for(let D=0;D<O.length;D+=1)O[D].c();r=G(),i=v("div"),P&&P.c(),c=G(),_e(h.$$.fragment),f=G(),_=v("div"),y=v("button"),y.textContent=p,k=G(),b=v("button"),_e(N.$$.fragment),I=G(),C=J(B),this.h()},l(D){e=g(D,"FIELDSET",{class:!0});var U=T(e);t=g(U,"LEGEND",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1409tnk"&&(t.textContent=s),n=M(U),o=g(U,"DIV",{class:!0});var V=T(o);a=g(V,"UL",{class:!0});var K=T(a);for(let he=0;he<O.length;he+=1)O[he].l(K);K.forEach(m),r=M(V),i=g(V,"DIV",{class:!0});var H=T(i);P&&P.l(H),H.forEach(m),c=M(V),pe(h.$$.fragment,V),f=M(V),_=g(V,"DIV",{class:!0});var ee=T(_);y=g(ee,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-10rv0bu"&&(y.textContent=p),k=M(ee),b=g(ee,"BUTTON",{class:!0});var te=T(b);pe(N.$$.fragment,te),I=M(te),C=Q(te,B),te.forEach(m),ee.forEach(m),V.forEach(m),U.forEach(m),this.h()},h(){d(t,"class","px-1 text-base"),d(a,"class","games svelte-1okhpct"),d(i,"class","options svelte-1okhpct"),d(y,"class","w-full btn hover:bg-gray-200"),d(b,"class","w-full mt-2 flex items-center justify-center btn primary"),d(_,"class","h-full flex flex-col justify-end"),d(o,"class","body pb-2 h-full svelte-1okhpct"),d(e,"class",j=Se(`${l[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(D,U){F(D,e,U),u(e,t),u(e,n),u(e,o),u(o,a);for(let V=0;V<O.length;V+=1)O[V]&&O[V].m(a,null);u(o,r),u(o,i),P&&P.m(i,null),u(o,c),ve(h,o,null),u(o,f),u(o,_),u(_,y),u(_,k),u(_,b),ve(N,b,null),u(b,I),u(b,C),w=!0,S||(L=[R(y,"click",l[5]),R(b,"click",l[16])],S=!0)},p(D,[U]){if(U&401){A=se(D[4]);let K;for(K=0;K<A.length;K+=1){const H=al(D,A,K);O[K]?(O[K].p(H,U),q(O[K],1)):(O[K]=ol(H),O[K].c(),q(O[K],1),O[K].m(a,null))}for(tt(),K=A.length;K<O.length;K+=1)E(K);st()}D[0]==="chords-write"||D[0]==="chords-play"?P?P.p(D,U):(P=rl(D),P.c(),P.m(i,null)):P&&(P.d(1),P=null);const V={};U&8&&(V.icon=D[3]?Es:ns),N.$set(V),(!w||U&8)&&B!==(B=D[3]?"Quit":"Play")&&ne(C,B),(!w||U&1024&&j!==(j=Se(`${D[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&d(e,"class",j)},i(D){if(!w){for(let U=0;U<A.length;U+=1)q(O[U]);q(h.$$.fragment,D),q(N.$$.fragment,D),w=!0}},o(D){O=O.filter(Boolean);for(let U=0;U<O.length;U+=1)$(O[U]);$(h.$$.fragment,D),$(N.$$.fragment,D),w=!1},d(D){D&&m(e),Ie(O,D),P&&P.d(),ge(h),ge(N),S=!1,at(L)}}}function Ga(l,e,t){let s,n,o,a,r;oe(l,ds,C=>t(12,o=C)),oe(l,it,C=>t(19,a=C)),oe(l,pt,C=>t(3,r=C));const i=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let c=i[4].key,h="maj-m";a.count,a.waitSeconds,it.subscribe(C=>{C.count,C.waitSeconds});function f(){be.clearGame(!0)}function _(C,j){if(j==="chords-write"||j==="chords-play"||j==="chords-diatonic"){let w=[];h==="selected"?w=o.filter(S=>S.selected):h==="all"?w=o:h==="maj-m"?w=o.filter(S=>S.suffixes[0]==="maj"||S.suffixes[0]==="m"):h==="seventh"&&(w=o.filter(S=>S.suffixes[0]==="maj7"||S.suffixes[0]==="m7"||S.suffixes[0]==="7"||S.suffixes[0]==="dim7"||S.suffixes[0]==="aug7")),be.play(j,{chords:w})}else be.play(j,void 0);C.currentTarget instanceof HTMLElement&&C.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function y(C){t(0,c=C)}function p(C,j){t(0,c=j),_(C,j)}function k(C){t(1,h=C)}const b=C=>y(C),N=(C,j)=>p(j,C),I=C=>k(C),B=C=>_(C,c);return l.$$set=C=>{t(10,e=ye(ye({},e),ke(C)))},l.$$.update=()=>{l.$$.dirty&4096&&t(11,s=o.reduce((C,j)=>j.selected?C+1:C,0)),l.$$.dirty&2048&&t(2,n=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${s} chords`},{key:"all",value:"All"}])},e=ke(e),[c,h,n,r,i,f,_,y,p,k,e,s,o,b,N,I,B]}class Ma extends Re{constructor(e){super(),He(this,e,Ga,Ba,qe,{})}}function cl(l,e,t){const s=l.slice();return s[7]=e[t],s}function ul(l,e,t){const s=l.slice();return s[4]=e[t],s}function Va(l){let e,t=se(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=fl(cl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=je()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);F(n,e,o)},p(n,o){if(o&2){t=se(n[1]);let a;for(a=0;a<t.length;a+=1){const r=cl(n,t,a);s[a]?s[a].p(r,o):(s[a]=fl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function Ka(l){let e,t=se(l[0].scaleNotes||[]),s=[];for(let n=0;n<t.length;n+=1)s[n]=hl(ul(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=je()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);F(n,e,o)},p(n,o){if(o&1){t=se(n[0].scaleNotes||[]);let a;for(a=0;a<t.length;a+=1){const r=ul(n,t,a);s[a]?s[a].p(r,o):(s[a]=hl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function fl(l){let e,t=l[7].interval+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-my4m0t")},m(n,o){F(n,e,o),u(e,s)},p(n,o){o&2&&t!==(t=n[7].interval+"")&&ne(s,t)},d(n){n&&m(e)}}}function hl(l){let e,t=l[4].note+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-my4m0t")},m(n,o){F(n,e,o),u(e,s)},p(n,o){o&1&&t!==(t=n[4].note+"")&&ne(s,t)},d(n){n&&m(e)}}}function Oa(l){let e,t,s,n,o,a;function r(h,f){return h[0]?Ka:Va}let i=r(l),c=i(l);return{c(){e=v("div"),t=v("button"),c.c(),this.h()},l(h){e=g(h,"DIV",{class:!0,title:!0});var f=T(e);t=g(f,"BUTTON",{class:!0});var _=T(t);c.l(_),_.forEach(m),f.forEach(m),this.h()},h(){d(t,"class","intervals svelte-my4m0t"),d(e,"class",s=`${l[2].class||""} `),d(e,"title",n=l[1].map(dl).join("-"))},m(h,f){F(h,e,f),u(e,t),c.m(t,null),o||(a=R(t,"click",l[3]),o=!0)},p(h,[f]){i===(i=r(h))&&c?c.p(h,f):(c.d(1),c=i(h),c&&(c.c(),c.m(t,null))),f&4&&s!==(s=`${h[2].class||""} `)&&d(e,"class",s),f&2&&n!==(n=h[1].map(dl).join("-"))&&d(e,"title",n)},i:fe,o:fe,d(h){h&&m(e),c.d(),o=!1,a()}}}const dl=l=>l.interval;function Fa(l,e,t){let{scale:s,intervals:n}=e;function o(a){cs.call(this,l,a)}return l.$$set=a=>{t(2,e=ye(ye({},e),ke(a))),"scale"in a&&t(0,s=a.scale),"intervals"in a&&t(1,n=a.intervals)},e=ke(e),[s,n,e,o]}class Xl extends Re{constructor(e){super(),He(this,e,Fa,Oa,qe,{scale:0,intervals:1})}}function ml(l,e,t){const s=l.slice();return s[7]=e[t],s}function _l(l,e,t){const s=l.slice();return s[4]=e[t],s}function Ua(l){let e,t=se(l[0]),s=[];for(let n=0;n<t.length;n+=1)s[n]=pl(ml(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=je()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);F(n,e,o)},p(n,o){if(o&1){t=se(n[0]);let a;for(a=0;a<t.length;a+=1){const r=ml(n,t,a);s[a]?s[a].p(r,o):(s[a]=pl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function xa(l){let e,t=se(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=vl(_l(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=je()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);F(n,e,o)},p(n,o){if(o&2){t=se(n[1]);let a;for(a=0;a<t.length;a+=1){const r=_l(n,t,a);s[a]?s[a].p(r,o):(s[a]=vl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function pl(l){let e,t,s=l[7].roman+"",n,o,a,r=l[7].suffix+"",i,c;return{c(){e=v("span"),t=v("span"),n=J(s),o=G(),a=v("sup"),i=J(r),c=G(),this.h()},l(h){e=g(h,"SPAN",{class:!0});var f=T(e);t=g(f,"SPAN",{class:!0});var _=T(t);n=Q(_,s),_.forEach(m),o=M(f),a=g(f,"SUP",{class:!0});var y=T(a);i=Q(y,r),y.forEach(m),c=M(f),f.forEach(m),this.h()},h(){d(t,"class","block"),d(a,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),z(a,"super-text",l[7].suffix.length>2),d(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(h,f){F(h,e,f),u(e,t),u(t,n),u(e,o),u(e,a),u(a,i),u(e,c)},p(h,f){f&1&&s!==(s=h[7].roman+"")&&ne(n,s),f&1&&r!==(r=h[7].suffix+"")&&ne(i,r),f&1&&z(a,"super-text",h[7].suffix.length>2)},d(h){h&&m(e)}}}function vl(l){let e,t,s=l[4]+"",n,o;return{c(){e=v("span"),t=v("span"),n=J(s),o=G(),this.h()},l(a){e=g(a,"SPAN",{class:!0});var r=T(e);t=g(r,"SPAN",{});var i=T(t);n=Q(i,s),i.forEach(m),o=M(r),r.forEach(m),this.h()},h(){d(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(a,r){F(a,e,r),u(e,t),u(t,n),u(e,o)},p(a,r){r&2&&s!==(s=a[4]+"")&&ne(n,s)},d(a){a&&m(e)}}}function Ra(l){let e,t,s,n,o,a;function r(h,f){return h[1].length>0?xa:Ua}let i=r(l),c=i(l);return{c(){e=v("div"),t=v("button"),c.c(),this.h()},l(h){e=g(h,"DIV",{class:!0,title:!0});var f=T(e);t=g(f,"BUTTON",{class:!0});var _=T(t);c.l(_),_.forEach(m),f.forEach(m),this.h()},h(){d(t,"class","triads flex flex-wrap svelte-1roj1mi"),d(e,"class",s=Se(`${l[2].class||""} `)+" svelte-1roj1mi"),d(e,"title",n=l[0].map(gl).join("-"))},m(h,f){F(h,e,f),u(e,t),c.m(t,null),o||(a=R(t,"click",l[3]),o=!0)},p(h,[f]){i===(i=r(h))&&c?c.p(h,f):(c.d(1),c=i(h),c&&(c.c(),c.m(t,null))),f&4&&s!==(s=Se(`${h[2].class||""} `)+" svelte-1roj1mi")&&d(e,"class",s),f&1&&n!==(n=h[0].map(gl).join("-"))&&d(e,"title",n)},i:fe,o:fe,d(h){h&&m(e),c.d(),o=!1,a()}}}const gl=l=>l.roman+l.suffix;function Ha(l,e,t){let{triads:s,chords:n}=e;function o(a){cs.call(this,l,a)}return l.$$set=a=>{t(2,e=ye(ye({},e),ke(a))),"triads"in a&&t(0,s=a.triads),"chords"in a&&t(1,n=a.chords)},e=ke(e),[s,n,e,o]}class Zl extends Re{constructor(e){super(),He(this,e,Ha,Ra,qe,{triads:0,chords:1})}}function bl(l,e,t){const s=l.slice();return s[25]=e[t],s}function yl(l,e,t){const s=l.slice();return s[25]=e[t],s}function kl(l){let e,t,s=l[25].raw.names[0]+"",n,o,a,r,i,c,h;function f(){return l[13](l[25])}a=new Xl({props:{scale:l[25].scale,intervals:l[25].raw.intervals}}),a.$on("click",f);function _(){return l[14](l[25])}return i=new Zl({props:{triads:l[25].triads,chords:l[25].triadChords}}),i.$on("click",_),{c(){e=v("li"),t=v("div"),n=J(s),o=G(),_e(a.$$.fragment),r=G(),_e(i.$$.fragment),c=G(),this.h()},l(y){e=g(y,"LI",{class:!0});var p=T(e);t=g(p,"DIV",{class:!0});var k=T(t);n=Q(k,s),k.forEach(m),o=M(p),pe(a.$$.fragment,p),r=M(p),pe(i.$$.fragment,p),c=M(p),p.forEach(m),this.h()},h(){d(t,"class","text-xs font-bold"),d(e,"class","svelte-4hctsl")},m(y,p){F(y,e,p),u(e,t),u(t,n),u(e,o),ve(a,e,null),u(e,r),ve(i,e,null),u(e,c),h=!0},p(y,p){l=y,(!h||p&4)&&s!==(s=l[25].raw.names[0]+"")&&ne(n,s);const k={};p&4&&(k.scale=l[25].scale),p&4&&(k.intervals=l[25].raw.intervals),a.$set(k);const b={};p&4&&(b.triads=l[25].triads),p&4&&(b.chords=l[25].triadChords),i.$set(b)},i(y){h||(q(a.$$.fragment,y),q(i.$$.fragment,y),h=!0)},o(y){$(a.$$.fragment,y),$(i.$$.fragment,y),h=!1},d(y){y&&m(e),ge(a),ge(i)}}}function wl(l){let e,t,s=l[25].raw.names[0]+"",n,o,a,r,i,c,h;function f(){return l[15](l[25])}a=new Xl({props:{scale:l[25].scale,intervals:l[25].raw.intervals}}),a.$on("click",f);function _(){return l[16](l[25])}return i=new Zl({props:{triads:l[25].triads,chords:l[25].triadChords}}),i.$on("click",_),{c(){e=v("li"),t=v("div"),n=J(s),o=G(),_e(a.$$.fragment),r=G(),_e(i.$$.fragment),c=G(),this.h()},l(y){e=g(y,"LI",{class:!0});var p=T(e);t=g(p,"DIV",{class:!0});var k=T(t);n=Q(k,s),k.forEach(m),o=M(p),pe(a.$$.fragment,p),r=M(p),pe(i.$$.fragment,p),c=M(p),p.forEach(m),this.h()},h(){d(t,"class","text-xs font-bold"),d(e,"class","svelte-4hctsl")},m(y,p){F(y,e,p),u(e,t),u(t,n),u(e,o),ve(a,e,null),u(e,r),ve(i,e,null),u(e,c),h=!0},p(y,p){l=y,(!h||p&2)&&s!==(s=l[25].raw.names[0]+"")&&ne(n,s);const k={};p&2&&(k.scale=l[25].scale),p&2&&(k.intervals=l[25].raw.intervals),a.$set(k);const b={};p&2&&(b.triads=l[25].triads),p&2&&(b.chords=l[25].triadChords),i.$set(b)},i(y){h||(q(a.$$.fragment,y),q(i.$$.fragment,y),h=!0)},o(y){$(a.$$.fragment,y),$(i.$$.fragment,y),h=!1},d(y){y&&m(e),ge(a),ge(i)}}}function qa(l){let e,t,s,n,o="Scales",a,r,i,c,h="Key",f,_,y,p,k,b,N,I,B,C,j=se(l[2]),w=[];for(let E=0;E<j.length;E+=1)w[E]=kl(yl(l,j,E));const S=E=>$(w[E],1,1,()=>{w[E]=null});let L=se(l[1]),A=[];for(let E=0;E<L.length;E+=1)A[E]=wl(bl(l,L,E));const O=E=>$(A[E],1,1,()=>{A[E]=null});return{c(){e=v("div"),t=v("fieldset"),s=v("legend"),n=v("button"),n.textContent=o,a=G(),r=v("div"),i=v("div"),c=v("label"),c.textContent=h,f=G(),_=v("input"),y=G(),p=v("ul");for(let E=0;E<w.length;E+=1)w[E].c();k=G(),b=v("ul");for(let E=0;E<A.length;E+=1)A[E].c();this.h()},l(E){e=g(E,"DIV",{class:!0});var P=T(e);t=g(P,"FIELDSET",{class:!0});var D=T(t);s=g(D,"LEGEND",{class:!0});var U=T(s);n=g(U,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-lhx60e"&&(n.textContent=o),U.forEach(m),a=M(D),r=g(D,"DIV",{class:!0});var V=T(r);i=g(V,"DIV",{class:!0});var K=T(i);c=g(K,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(c)!=="svelte-14m38zf"&&(c.textContent=h),f=M(K),_=g(K,"INPUT",{class:!0,id:!0}),K.forEach(m),y=M(V),p=g(V,"UL",{class:!0});var H=T(p);for(let te=0;te<w.length;te+=1)w[te].l(H);H.forEach(m),k=M(V),b=g(V,"UL",{class:!0});var ee=T(b);for(let te=0;te<A.length;te+=1)A[te].l(ee);ee.forEach(m),V.forEach(m),D.forEach(m),P.forEach(m),this.h()},h(){d(n,"class","px-1 rounded hover:bg-gray-100"),d(s,"class","text-base"),d(c,"class","mr-4 font-bold"),d(c,"for","scale-key"),d(_,"class","bg-gray-100 w-16 px-1 rounded"),d(_,"id","scale-key"),_.value=l[0],d(i,"class","flex w-1/2 mb-2 input svelte-4hctsl"),d(p,"class","list odd w-full svelte-4hctsl"),d(b,"class","list even w-full svelte-4hctsl"),d(r,"class","body svelte-4hctsl"),z(r,"hidden",l[3]),d(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-4hctsl"),z(t,"collapsed",l[3]),d(e,"class",N=Se(`${l[9].class||""}`)+" svelte-4hctsl")},m(E,P){F(E,e,P),u(e,t),u(t,s),u(s,n),u(t,a),u(t,r),u(r,i),u(i,c),u(i,f),u(i,_),u(r,y),u(r,p);for(let D=0;D<w.length;D+=1)w[D]&&w[D].m(p,null);u(r,k),u(r,b);for(let D=0;D<A.length;D+=1)A[D]&&A[D].m(b,null);I=!0,B||(C=[R(n,"click",l[5]),R(_,"input",l[6]),R(_,"focus",l[11]),R(_,"blur",l[12])],B=!0)},p(E,[P]){if((!I||P&1&&_.value!==E[0])&&(_.value=E[0]),P&388){j=se(E[2]);let D;for(D=0;D<j.length;D+=1){const U=yl(E,j,D);w[D]?(w[D].p(U,P),q(w[D],1)):(w[D]=kl(U),w[D].c(),q(w[D],1),w[D].m(p,null))}for(tt(),D=j.length;D<w.length;D+=1)S(D);st()}if(P&386){L=se(E[1]);let D;for(D=0;D<L.length;D+=1){const U=bl(E,L,D);A[D]?(A[D].p(U,P),q(A[D],1)):(A[D]=wl(U),A[D].c(),q(A[D],1),A[D].m(b,null))}for(tt(),D=L.length;D<A.length;D+=1)O(D);st()}(!I||P&8)&&z(r,"hidden",E[3]),(!I||P&8)&&z(t,"collapsed",E[3]),(!I||P&512&&N!==(N=Se(`${E[9].class||""}`)+" svelte-4hctsl"))&&d(e,"class",N)},i(E){if(!I){for(let P=0;P<j.length;P+=1)q(w[P]);for(let P=0;P<L.length;P+=1)q(A[P]);I=!0}},o(E){w=w.filter(Boolean);for(let P=0;P<w.length;P+=1)$(w[P]);A=A.filter(Boolean);for(let P=0;P<A.length;P+=1)$(A[P]);I=!1},d(E){E&&m(e),Ie(w,E),Ie(A,E),B=!1,at(C)}}}function za(l,e,t){let s,n,o,a,r,i,c;oe(l,Jt,E=>t(19,o=E)),oe(l,bt,E=>t(20,a=E)),oe(l,vt,E=>t(21,r=E)),oe(l,et,E=>t(22,i=E));let f=us().map(E=>({key:E.names[0],raw:E,scale:void 0,triads:E.triads,triadChords:[]})),_="",y=[a.key,a.scale],p;const k=ct(Be(!0),{key:"scales-hidden"});oe(l,k,E=>t(3,c=E));function b(){k.update(E=>!E)}function N({currentTarget:{value:E}}){t(0,_=`${E.charAt(0).toUpperCase()}${E.charAt(1).toLowerCase()}`),t(10,f=f.map(P=>{const D=Wt(_,P.key),U=_&&"data"in D?D.data:void 0;let V=[];return U&&(V=P.triads.map((K,H)=>`${U.scaleNotes[H].note}${!K.suffix.includes("°")&&K.minor?"m":""}${K.suffix}`)),{...P,scale:U,triadChords:V}}))}function I(E,P,D){if(E<P.length){const U=P[E++];ce.setPlayed(U),i==null||i.playChord(U.map(V=>V.midi),r.fixedVelocity),p=setTimeout(()=>I(E,P,D),D)}else ce.setPlayed([]),ce.setKeyAndScale(y[0],y[1])}function B(E){clearTimeout(p);let P,D;E.scale?(D=E.scale,y=[a.key,a.scale],ce.setKeyAndScale(E.scale.key,E.scale.scale)):D=a;const U=o[0].midi+D.scaleNotes[0].semitones;P=E.raw.intervals.map(V=>[{...D.notesMap.get(V.semitones%12),midi:U+V.semitones}]),P[0][0].semitones!==P[P.length-1][0].semitones&&P.push(P[0].map(V=>({...V,midi:V.midi+12}))),I(0,P,500)}function C(E){clearTimeout(p);const{intervals:P}=E.raw;let D,U;E.scale?(U=E.scale,y=[a.key,a.scale],ce.setKeyAndScale(E.scale.key,E.scale.scale)):U=a;const V=o[0].midi+U.scaleNotes[0].semitones;D=Hl(E.triads).map((H,ee)=>as(V+U.intervals[ee].semitones,U,H.intervals)),P[P.length-1].interval_seq!==1&&D.push(D[0].map(H=>({...H,midi:H.midi+12}))),I(0,D,750)}const j=()=>ue.setKeyboardFocus(!1),w=()=>ue.setKeyboardFocus(!0),S=E=>B(E),L=E=>C(E),A=E=>B(E),O=E=>C(E);return l.$$set=E=>{t(9,e=ye(ye({},e),ke(E)))},l.$$.update=()=>{l.$$.dirty&1024&&t(2,s=f.filter((E,P)=>P<f.length/2)),l.$$.dirty&1024&&t(1,n=f.filter((E,P)=>P>=f.length/2))},e=ke(e),[_,n,s,c,k,b,N,B,C,e,f,j,w,S,L,A,O]}class Wa extends Re{constructor(e){super(),He(this,e,za,qa,qe,{})}}function Cl(l,e,t){const s=l.slice();return s[14]=e[t].key,s[15]=e[t].value,s[16]=e[t].icon,s[18]=t,s}const $a=l=>({}),El=l=>({}),Ja=l=>({}),Sl=l=>({});function Al(l){let e,t,s,n,o,a,r,i,c,h;const f=l[11].header,_=Ml(f,l,l[10],El);let y=se(l[0]),p=[];for(let b=0;b<y.length;b+=1)p[b]=Tl(Cl(l,y,b));const k=b=>$(p[b],1,1,()=>{p[b]=null});return{c(){e=v("button"),s=G(),n=v("ul"),o=v("li"),_&&_.c(),a=G();for(let b=0;b<p.length;b+=1)p[b].c();this.h()},l(b){e=g(b,"BUTTON",{class:!0,tabindex:!0}),T(e).forEach(m),s=M(b),n=g(b,"UL",{class:!0});var N=T(n);o=g(N,"LI",{});var I=T(o);_&&_.l(I),I.forEach(m),a=M(N);for(let B=0;B<p.length;B+=1)p[B].l(N);N.forEach(m),this.h()},h(){d(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),d(e,"tabindex","-1"),d(n,"class","items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl svelte-h65upg")},m(b,N){F(b,e,N),F(b,s,N),F(b,n,N),u(n,o),_&&_.m(o,null),u(n,a);for(let I=0;I<p.length;I+=1)p[I]&&p[I].m(n,null);i=!0,c||(h=R(e,"click",l[6]),c=!0)},p(b,N){if(l=b,_&&_.p&&(!i||N&1024)&&Vl(_,f,l,l[10],i?Ol(f,l[10],N,$a):Kl(l[10]),El),N&133){y=se(l[0]);let I;for(I=0;I<y.length;I+=1){const B=Cl(l,y,I);p[I]?(p[I].p(B,N),q(p[I],1)):(p[I]=Tl(B),p[I].c(),q(p[I],1),p[I].m(n,null))}for(tt(),I=y.length;I<p.length;I+=1)k(I);st()}},i(b){if(!i){b&&bs(()=>{i&&(t||(t=Ut(e,ys,{duration:Rt},!0)),t.run(1))}),q(_,b);for(let N=0;N<y.length;N+=1)q(p[N]);b&&bs(()=>{i&&(r||(r=Ut(n,ks,{duration:Rt},!0)),r.run(1))}),i=!0}},o(b){b&&(t||(t=Ut(e,ys,{duration:Rt},!1)),t.run(0)),$(_,b),p=p.filter(Boolean);for(let N=0;N<p.length;N+=1)$(p[N]);b&&(r||(r=Ut(n,ks,{duration:Rt},!1)),r.run(0)),i=!1},d(b){b&&(m(e),m(s),m(n)),b&&t&&t.end(),_&&_.d(b),Ie(p,b),b&&r&&r.end(),c=!1,h()}}}function Qa(l){let e;return{c(){e=v("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),T(e).forEach(m),this.h()},h(){d(e,"class","w-[24px]")},m(t,s){F(t,e,s)},p:fe,i:fe,o:fe,d(t){t&&m(e)}}}function Ya(l){let e,t;return e=new nt({props:{class:"mr-2",icon:l[16],width:16}}),{c(){_e(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,n){ve(e,s,n),t=!0},p(s,n){const o={};n&1&&(o.icon=s[16]),e.$set(o)},i(s){t||(q(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){ge(e,s)}}}function Tl(l){let e,t,s,n,o,a,r=l[15]+"",i,c,h,f,_;const y=[Ya,Qa],p=[];function k(N,I){return N[16]?0:1}s=k(l),n=p[s]=y[s](l);function b(){return l[12](l[14])}return{c(){e=v("li"),t=v("button"),n.c(),o=G(),a=v("div"),i=J(r),c=G(),this.h()},l(N){e=g(N,"LI",{});var I=T(e);t=g(I,"BUTTON",{class:!0});var B=T(t);n.l(B),o=M(B),a=g(B,"DIV",{});var C=T(a);i=Q(C,r),C.forEach(m),B.forEach(m),c=M(I),I.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),z(t,"selected",l[14]===l[2])},m(N,I){F(N,e,I),u(e,t),p[s].m(t,null),u(t,o),u(t,a),u(a,i),u(e,c),h=!0,f||(_=R(t,"click",b),f=!0)},p(N,I){l=N;let B=s;s=k(l),s===B?p[s].p(l,I):(tt(),$(p[B],1,1,()=>{p[B]=null}),st(),n=p[s],n?n.p(l,I):(n=p[s]=y[s](l),n.c()),q(n,1),n.m(t,o)),(!h||I&1)&&r!==(r=l[15]+"")&&ne(i,r),(!h||I&5)&&z(t,"selected",l[14]===l[2])},i(N){h||(q(n),h=!0)},o(N){$(n),h=!1},d(N){N&&m(e),p[s].d(),f=!1,_()}}}function Xa(l){let e,t,s,n,o,a,r,i;const c=l[11].value,h=Ml(c,l,l[10],Sl);let f=l[5]&&Al(l);return{c(){e=v("div"),t=v("button"),h&&h.c(),o=G(),f&&f.c(),this.h()},l(_){e=g(_,"DIV",{class:!0,id:!0});var y=T(e);t=g(y,"BUTTON",{class:!0,title:!0});var p=T(t);h&&h.l(p),p.forEach(m),o=M(y),f&&f.l(y),y.forEach(m),this.h()},h(){d(t,"class",s=Se(`${l[8].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),d(t,"title",n=l[8].title||""),z(t,"disabled",l[3]),z(t,"open",l[5]),d(e,"class","relative"),d(e,"id",l[1])},m(_,y){F(_,e,y),u(e,t),h&&h.m(t,null),u(e,o),f&&f.m(e,null),l[13](e),a=!0,r||(i=R(t,"click",l[6]),r=!0)},p(_,[y]){h&&h.p&&(!a||y&1024)&&Vl(h,c,_,_[10],a?Ol(c,_[10],y,Ja):Kl(_[10]),Sl),(!a||y&256&&s!==(s=Se(`${_[8].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&d(t,"class",s),(!a||y&256&&n!==(n=_[8].title||""))&&d(t,"title",n),(!a||y&264)&&z(t,"disabled",_[3]),(!a||y&288)&&z(t,"open",_[5]),_[5]?f?(f.p(_,y),y&32&&q(f,1)):(f=Al(_),f.c(),q(f,1),f.m(e,null)):f&&(tt(),$(f,1,1,()=>{f=null}),st()),(!a||y&2)&&d(e,"id",_[1])},i(_){a||(q(h,_),q(f),a=!0)},o(_){$(h,_),$(f),a=!1},d(_){_&&m(e),h&&h.d(_),f&&f.d(),l[13](null),r=!1,i()}}}const Rt=400;function Za(l,e,t){let{$$slots:s={},$$scope:n}=e,{options:o,id:a=void 0,selected:r=void 0,disabled:i=void 0,onSelect:c}=e,h,f=!1;function _(){i||t(5,f=!f)}function y(b){t(5,f=c(b))}const p=b=>y(b);function k(b){ln[b?"unshift":"push"](()=>{h=b,t(4,h)})}return l.$$set=b=>{t(8,e=ye(ye({},e),ke(b))),"options"in b&&t(0,o=b.options),"id"in b&&t(1,a=b.id),"selected"in b&&t(2,r=b.selected),"disabled"in b&&t(3,i=b.disabled),"onSelect"in b&&t(9,c=b.onSelect),"$$scope"in b&&t(10,n=b.$$scope)},e=ke(e),[o,a,r,i,h,f,_,y,e,c,n,s,p,k]}class eo extends Re{constructor(e){super(),He(this,e,Za,Xa,qe,{options:0,id:1,selected:2,disabled:3,onSelect:9})}}function Nl(l,e,t){const s=l.slice();return s[30]=e[t],s}function Il(l,e,t){const s=l.slice();return s[33]=e[t],s}function jl(l){let e,t;return{c(){e=v("div"),t=J(l[3]),this.h()},l(s){e=g(s,"DIV",{class:!0});var n=T(e);t=Q(n,l[3]),n.forEach(m),this.h()},h(){d(e,"class","error svelte-1u7ze7x")},m(s,n){F(s,e,n),u(e,t)},p(s,n){n[0]&8&&ne(t,s[3])},d(s){s&&m(e)}}}function to(l){let e,t;return{c(){e=v("div"),t=J(l[0]),this.h()},l(s){e=g(s,"DIV",{slot:!0});var n=T(e);t=Q(n,l[0]),n.forEach(m),this.h()},h(){d(e,"slot","value")},m(s,n){F(s,e,n),u(e,t)},p(s,n){n[0]&1&&ne(t,s[0])},d(s){s&&m(e)}}}function Dl(l){let e,t=se(l[5]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ll(Il(l,t,n));return{c(){e=v("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=g(n,"DIV",{class:!0});var o=T(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,o){F(n,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,o){if(o[0]&32){t=se(n[5]);let a;for(a=0;a<t.length;a+=1){const r=Il(n,t,a);s[a]?s[a].p(r,o):(s[a]=Ll(r),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function Ll(l){let e,t=l[33].interval+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-1u7ze7x")},m(n,o){F(n,e,o),u(e,s)},p(n,o){o[0]&32&&t!==(t=n[33].interval+"")&&ne(s,t)},d(n){n&&m(e)}}}function Pl(l){let e,t=se(l[8].scaleNotes),s=[];for(let n=0;n<t.length;n+=1)s[n]=Bl(Nl(l,t,n));return{c(){e=v("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=g(n,"DIV",{class:!0});var o=T(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,o){F(n,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,o){if(o[0]&256){t=se(n[8].scaleNotes);let a;for(a=0;a<t.length;a+=1){const r=Nl(n,t,a);s[a]?s[a].p(r,o):(s[a]=Bl(r),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),Ie(s,n)}}}function Bl(l){let e,t=l[30].note+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=T(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-1u7ze7x")},m(n,o){F(n,e,o),u(e,s)},p(n,o){o[0]&256&&t!==(t=n[30].note+"")&&ne(s,t)},d(n){n&&m(e)}}}function so(l){let e,t,s,n="Score",o,a,r,i,c,h,f,_="Range",y,p,k,b,N,I="—",B,C,j,w,S,L,A,O="Scale",E,P,D,U,V,K,H,ee="Key",te,he,re,Ge,Ue,Me,me="",ze,Fe,Te,ae;r=new nt({props:{icon:Fl,width:16}});let Ae=l[3]&&jl(l);D=new eo({props:{id:"scales",class:"p-1",options:l[10],onSelect:l[14],$$slots:{value:[to]},$$scope:{ctx:l}}});let de=!l[7]&&Dl(l),W=!l[7]&&Pl(l);return{c(){e=v("fieldset"),t=v("legend"),s=v("button"),s.textContent=n,o=G(),a=v("button"),_e(r.$$.fragment),i=G(),c=v("div"),h=v("div"),f=v("label"),f.textContent=_,y=G(),p=v("div"),k=v("input"),b=G(),N=v("span"),N.textContent=I,B=G(),C=v("input"),j=G(),w=v("div"),Ae&&Ae.c(),S=G(),L=v("div"),A=v("label"),A.textContent=O,E=G(),P=v("div"),_e(D.$$.fragment),U=G(),de&&de.c(),V=G(),K=v("div"),H=v("label"),H.textContent=ee,te=G(),he=v("div"),re=v("input"),Ge=G(),W&&W.c(),Ue=G(),Me=v("div"),Me.innerHTML=me,this.h()},l(le){e=g(le,"FIELDSET",{class:!0});var x=T(e);t=g(x,"LEGEND",{class:!0});var Y=T(t);s=g(Y,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-lqyol"&&(s.textContent=n),Y.forEach(m),o=M(x),a=g(x,"BUTTON",{class:!0});var ie=T(a);pe(r.$$.fragment,ie),ie.forEach(m),i=M(x),c=g(x,"DIV",{class:!0});var X=T(c);h=g(X,"DIV",{class:!0});var we=T(h);f=g(we,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(f)!=="svelte-10u0679"&&(f.textContent=_),y=M(we),p=g(we,"DIV",{class:!0});var De=T(p);k=g(De,"INPUT",{class:!0,id:!0}),b=M(De),N=g(De,"SPAN",{class:!0,"data-svelte-h":!0}),Z(N)!=="svelte-8q1xz4"&&(N.textContent=I),B=M(De),C=g(De,"INPUT",{class:!0,id:!0}),De.forEach(m),j=M(we),w=g(we,"DIV",{class:!0});var lt=T(w);Ae&&Ae.l(lt),lt.forEach(m),we.forEach(m),S=M(X),L=g(X,"DIV",{class:!0});var We=T(L);A=g(We,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(A)!=="svelte-ld2d07"&&(A.textContent=O),E=M(We),P=g(We,"DIV",{class:!0});var Ve=T(P);pe(D.$$.fragment,Ve),Ve.forEach(m),U=M(We),de&&de.l(We),We.forEach(m),V=M(X),K=g(X,"DIV",{class:!0});var Ne=T(K);H=g(Ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(H)!=="svelte-17pcm6g"&&(H.textContent=ee),te=M(Ne),he=g(Ne,"DIV",{class:!0});var Ce=T(he);re=g(Ce,"INPUT",{class:!0,id:!0}),Ce.forEach(m),Ge=M(Ne),W&&W.l(Ne),Ne.forEach(m),Ue=M(X),Me=g(X,"DIV",{class:!0,"data-svelte-h":!0}),Z(Me)!=="svelte-hp3bkp"&&(Me.innerHTML=me),X.forEach(m),x.forEach(m),this.h()},h(){d(s,"class","px-1 rounded hover:bg-gray-100"),d(t,"class","px-1 text-base"),d(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),z(a,"hidden",l[6]),d(f,"class","font-bold"),d(f,"for","range_min"),d(k,"class","h-[28px] w-full"),d(k,"id","range_min"),d(N,"class","mx-2 mt-1"),d(C,"class","h-[28px] w-full"),d(C,"id","range_max"),d(p,"class","my-1 flex w-full"),d(w,"class","flex justify-between my-1"),d(h,"class","flex flex-col h-full"),d(A,"class","font-bold"),d(A,"for","scales"),d(P,"class","my-1 w-full"),d(L,"class","flex flex-col h-full"),d(H,"class","font-bold"),d(H,"for","key"),d(re,"class","h-[28px]"),d(re,"id","key"),d(he,"class","my-1 flex"),d(K,"class","flex flex-col h-full"),d(Me,"class","h-full flex flex-col justify-between"),d(c,"class","options svelte-1u7ze7x"),z(c,"hidden",l[6]),d(e,"class",ze=Se(`${l[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),z(e,"collapsed",l[6])},m(le,x){F(le,e,x),u(e,t),u(t,s),u(e,o),u(e,a),ve(r,a,null),u(e,i),u(e,c),u(c,h),u(h,f),u(h,y),u(h,p),u(p,k),Je(k,l[1]),u(p,b),u(p,N),u(p,B),u(p,C),Je(C,l[2]),u(h,j),u(h,w),Ae&&Ae.m(w,null),u(c,S),u(c,L),u(L,A),u(L,E),u(L,P),ve(D,P,null),u(L,U),de&&de.m(L,null),u(c,V),u(c,K),u(K,H),u(K,te),u(K,he),u(he,re),Je(re,l[4]),u(K,Ge),W&&W.m(K,null),u(c,Ue),u(c,Me),Fe=!0,Te||(ae=[R(s,"click",l[15]),R(a,"click",l[16]),R(k,"input",l[18]),R(k,"change",l[19]),R(k,"focus",l[12]),R(k,"blur",l[20]),R(C,"input",l[21]),R(C,"change",l[22]),R(C,"focus",l[12]),R(C,"blur",l[23]),R(re,"input",l[24]),R(re,"input",l[13]),R(re,"focus",l[25]),R(re,"blur",l[26])],Te=!0)},p(le,x){(!Fe||x[0]&64)&&z(a,"hidden",le[6]),x[0]&2&&k.value!==le[1]&&Je(k,le[1]),x[0]&4&&C.value!==le[2]&&Je(C,le[2]),le[3]?Ae?Ae.p(le,x):(Ae=jl(le),Ae.c(),Ae.m(w,null)):Ae&&(Ae.d(1),Ae=null);const Y={};x[0]&1|x[1]&32&&(Y.$$scope={dirty:x,ctx:le}),D.$set(Y),le[7]?de&&(de.d(1),de=null):de?de.p(le,x):(de=Dl(le),de.c(),de.m(L,null)),x[0]&16&&re.value!==le[4]&&Je(re,le[4]),le[7]?W&&(W.d(1),W=null):W?W.p(le,x):(W=Pl(le),W.c(),W.m(K,null)),(!Fe||x[0]&64)&&z(c,"hidden",le[6]),(!Fe||x[0]&131072&&ze!==(ze=Se(`${le[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&d(e,"class",ze),(!Fe||x[0]&131136)&&z(e,"collapsed",le[6])},i(le){Fe||(q(r.$$.fragment,le),q(D.$$.fragment,le),Fe=!0)},o(le){$(r.$$.fragment,le),$(D.$$.fragment,le),Fe=!1},d(le){le&&m(e),ge(r),Ae&&Ae.d(),ge(D),de&&de.d(),W&&W.d(),Te=!1,at(ae)}}}function lo(l,e,t){let s,n,o,a,r,i;oe(l,Jt,K=>t(27,n=K)),oe(l,gt,K=>t(28,o=K)),oe(l,pt,K=>t(7,r=K)),oe(l,bt,K=>t(8,i=K));let c=Qe(n[0]),h=Qe(n[1]),f="";const _=ct(Be(!1),{key:"score-options-hidden"});oe(l,_,K=>t(6,a=K));let y=o[0],p=o[1];const k=us(),b=k.map(K=>({key:K.names[0],value:K.names[0]}));Jt.subscribe(K=>{t(1,c=Qe(K[0])),t(2,h=Qe(K[1]))}),gt.subscribe(K=>{t(4,y=K[0]),t(0,p=K[1])});function N(K,H){const ee=kn(H.currentTarget.value,!0,!0);if("data"in ee){const{midi:te}=ee.data,he=n,re=[K==="min"?te:he[0].midi,K==="max"?te:he[1].midi];ue.setMidiRange(re),t(3,f="")}else t(3,f=ee.err),K==="min"?t(1,c=Qe(n[0])):t(2,h=Qe(n[1]))}function I(){t(3,f=""),ue.setKeyboardFocus(!1)}function B({currentTarget:{value:K}}){t(4,y=`${K.charAt(0).toUpperCase()}${K.charAt(1).toLowerCase()}`),ce.setKey(y)}function C(K){var H;return t(0,p=(H=b.find(ee=>K===ee.key))==null?void 0:H.value),ce.setScale(p),!1}function j(){_.update(K=>!K)}function w(){ce.clearScore(!0),ue.setMidiRange([60,84])}function S(){c=this.value,t(1,c)}const L=K=>N("min",K),A=()=>ue.setKeyboardFocus(!0);function O(){h=this.value,t(2,h)}const E=K=>N("max",K),P=()=>ue.setKeyboardFocus(!0);function D(){y=this.value,t(4,y)}const U=()=>ue.setKeyboardFocus(!1),V=()=>ue.setKeyboardFocus(!0);return l.$$set=K=>{t(17,e=ye(ye({},e),ke(K)))},l.$$.update=()=>{var K;l.$$.dirty[0]&1&&t(5,s=((K=k.find(H=>H.names[0]===p))==null?void 0:K.intervals)||[])},e=ke(e),[p,c,h,f,y,s,a,r,i,_,b,N,I,B,C,j,w,e,S,L,A,O,E,P,D,U,V]}class no extends Re{constructor(e){super(),He(this,e,lo,so,qe,{},null,[-1,-1])}}function ao(l){l[19]=l[20].default}function oo(l){return{c:fe,l:fe,m:fe,i:fe,o:fe,d:fe}}function ro(l){ao(l);let e,t,s;var n=l[19];function o(a,r){return{props:{class:"px-4 md:px-0"}}}return n&&(e=on(n,o())),{c(){e&&_e(e.$$.fragment),t=je()},l(a){e&&pe(e.$$.fragment,a),t=je()},m(a,r){e&&ve(e,a,r),F(a,t,r),s=!0},i(a){s||(e&&q(e.$$.fragment,a),s=!0)},o(a){e&&$(e.$$.fragment,a),s=!1},d(a){a&&m(t),e&&ge(e,a)}}}function io(l){let e;return{c(){e=J(" ")},l(t){e=Q(t," ")},m(t,s){F(t,e,s)},i:fe,o:fe,d(t){t&&m(e)}}}function co(l){let e,t,s,n='<a class="hover:underline" href="https://github.com/TeemuKoivisto/midi-note-trainer">MIDI Note Trainer</a>',o,a,r,i,c,h,f,_,y,p,k,b,N,I,B,C,j,w,S;r=new ya({}),c=new Wa({}),f=new zn({}),p=new no({props:{class:"score-options mr-4"}}),b=new Ma({props:{class:"play-form"}});let L={ctx:l,current:null,token:null,hasCatch:!1,pending:io,then:ro,catch:oo,value:20,blocks:[,,,]};return nn(en(()=>import("./Score.f78ba32e.js"),["./Score.f78ba32e.js","./vendor_svelte.07af1c1a.js","./vendor.1acf520b.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),L),C=new ja({props:{class:"min-h-32",debounced:!!l[0]}}),C.$on("guessed-chord",l[2]),C.$on("guessed-key",l[3]),C.$on("note",l[4]),w=new aa({props:{game:l[1]}}),{c(){e=v("meta"),t=G(),s=v("h1"),s.innerHTML=n,o=G(),a=v("section"),_e(r.$$.fragment),i=G(),_e(c.$$.fragment),h=G(),_e(f.$$.fragment),_=G(),y=v("div"),_e(p.$$.fragment),k=G(),_e(b.$$.fragment),N=G(),L.block.c(),I=G(),B=v("section"),_e(C.$$.fragment),j=G(),_e(w.$$.fragment),this.h()},l(A){const O=an("svelte-1w2oado",document.head);e=g(O,"META",{name:!0,content:!0}),O.forEach(m),t=M(A),s=g(A,"H1",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-1l8ebwf"&&(s.innerHTML=n),o=M(A),a=g(A,"SECTION",{class:!0});var E=T(a);pe(r.$$.fragment,E),i=M(E),pe(c.$$.fragment,E),h=M(E),pe(f.$$.fragment,E),_=M(E),y=g(E,"DIV",{class:!0});var P=T(y);pe(p.$$.fragment,P),k=M(P),pe(b.$$.fragment,P),P.forEach(m),E.forEach(m),N=M(A),L.block.l(A),I=M(A),B=g(A,"SECTION",{class:!0});var D=T(B);pe(C.$$.fragment,D),j=M(D),pe(w.$$.fragment,D),D.forEach(m),this.h()},h(){d(e,"name","description"),d(e,"content","App to practise music notation, scales and chords using MIDI"),d(s,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight"),d(y,"class","play svelte-qjpqy3"),d(a,"class","px-4 md:px-0"),d(B,"class","mb-8 px-4 md:px-0 flex flex-col")},m(A,O){u(document.head,e),F(A,t,O),F(A,s,O),F(A,o,O),F(A,a,O),ve(r,a,null),u(a,i),ve(c,a,null),u(a,h),ve(f,a,null),u(a,_),u(a,y),ve(p,y,null),u(y,k),ve(b,y,null),F(A,N,O),L.block.m(A,L.anchor=O),L.mount=()=>I.parentNode,L.anchor=I,F(A,I,O),F(A,B,O),ve(C,B,null),u(B,j),ve(w,B,null),S=!0},p(A,[O]){l=A;const E={};O&1&&(E.debounced=!!l[0]),C.$set(E);const P={};O&2&&(P.game=l[1]),w.$set(P)},i(A){S||(q(r.$$.fragment,A),q(c.$$.fragment,A),q(f.$$.fragment,A),q(p.$$.fragment,A),q(b.$$.fragment,A),q(L.block),q(C.$$.fragment,A),q(w.$$.fragment,A),S=!0)},o(A){$(r.$$.fragment,A),$(c.$$.fragment,A),$(f.$$.fragment,A),$(p.$$.fragment,A),$(b.$$.fragment,A);for(let O=0;O<3;O+=1){const E=L.blocks[O];$(E)}$(C.$$.fragment,A),$(w.$$.fragment,A),S=!1},d(A){A&&(m(t),m(s),m(o),m(a),m(N),m(I),m(B)),m(e),ge(r),ge(c),ge(f),ge(p),ge(b),L.block.d(A),L.token=null,L=null,ge(C),ge(w)}}}function uo(l,e,t){let s,n,o,a,r,i;oe(l,_t,j=>t(7,s=j)),oe(l,pt,j=>t(1,n=j)),oe(l,it,j=>t(8,o=j)),oe(l,vt,j=>t(9,a=j)),oe(l,et,j=>t(10,r=j)),oe(l,rs,j=>t(11,i=j));let c,h;Gl(()=>(i&&C(),window.addEventListener("keydown",f),window.addEventListener("mousedown",f),window.addEventListener("touchstart",f),()=>{window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)})),$t.subscribe(j=>{j&&j.channels[1].addListener("noteon",_)});function f(){ue.initAudio(),window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)}function _(j){if(c)return;const w=j.rawData;y(w[1],w[2])}function y(j,w){const S=n;S instanceof At&&!(S!=null&&S.ended)&&s==="waiting"?b(j):S instanceof rt&&!(S!=null&&S.ended)&&s==="waiting"?(S.addPlayedNote(j),h||(h=setTimeout(k,2e3))):S||ce.pushPlayed(j),r&&r.noteOn(j,a.fixedVelocity??w)}function p(){o.autoplay&&o.waitSeconds>0?t(0,c=setTimeout(()=>{o.autoplay&&be.nextGuess(),t(0,c=void 0)},o.waitSeconds*1e3)):o.autoplay?be.nextGuess():t(0,c=void 0)}function k(){var w;const j=n;if(j instanceof rt){const S=j.guess();ce.setPlayed(((w=j.latestGuess.guessed)==null?void 0:w.notes)||[],S,-1),be.updateState(S?"correct":"wrong"),p()}h=void 0}function b(j){const w=n;if(w instanceof At&&s==="waiting"){ce.setTarget([ce.getNote(w.current)]);const S=w.guess(j);be.updateState(S?"correct":"wrong"),ce.pushPlayed(j,S,4e3),p()}}function N(j){const w=n;if(w instanceof rt&&s==="waiting"){const S=w.guessWrittenChord(j.detail);be.updateState(S?"correct":"wrong"),p()}}function I(j){const w=n;if(w instanceof It&&s==="waiting"){const S=j.detail.replaceAll("♭","b").replaceAll("♯","#"),L=w.guess(S);be.updateState(L?"correct":"wrong"),p()}}function B(j){y(j.detail,80)}async function C(){const j=await ue.openMidi();"data"in j?j.data.name:(j.err,console.error(j.err))}return[c,n,N,I,B]}class _o extends Re{constructor(e){super(),He(this,e,uo,co,qe,{})}}export{As as F,rt as G,_o as P,hn as S,At as a,be as b,pt as c,mt as d,ql as e,_t as g,et as p,bt as s,Is as t};
