import{_ as ke}from"./preload-helper.a4192956.js";import{S as We,i as qe,s as Je,e as b,n as V,a as k,b as T,p as O,d as m,f as h,Z as Te,N as $,g as M,h as f,_ as et,q,t as x,F as He,l as J,y as ze,$ as Ye,Q as Ae,R as Se,c as Ns,a0 as fe,u as Ls,j as Ds,k as Ps,V as ss,W as Et,X as ls,a1 as ns,a2 as Ve,x as Pe,H as Vs,B as Z,C as ee,D as he,r as ve,O as Qe,J as ye,K as Ee,L as we,M as Ce,m as Ie,T as It,w as Ge,a3 as An,o as re,P as _e,a4 as fs,v as mn,a5 as Sn,a6 as as,a7 as Nn,a8 as Ln,I as Dn}from"./vendor_svelte.d23d0217.js";import{w as Yt,c as Pn,e as Vn,f as Js,g as $s,h as Kt,i as rs,j as os,k as On,a as Qs,l as ws}from"./vendor.e74270f4.js";import{a as jn}from"./modal.e9230202.js";function Ys(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l[24]=e[t].icon,l[26]=t,l}const Bn=s=>({}),Xs=s=>({});function Zs(s){let e,t,l,n,r,a,o,i,c,d,u;const _=s[17].header,g=Ns(_,s,s[16],Xs);let p=fe(s[0]),v=[];for(let y=0;y<p.length;y+=1)v[y]=tl(Ys(s,p,y));const L=y=>J(v[y],1,1,()=>{v[y]=null});return{c(){e=b("button"),l=V(),n=b("ul"),r=b("li"),g&&g.c(),a=V();for(let y=0;y<v.length;y+=1)v[y].c();this.h()},l(y){e=k(y,"BUTTON",{class:!0,tabindex:!0}),T(e).forEach(m),l=O(y),n=k(y,"UL",{class:!0});var E=T(n);r=k(E,"LI",{});var A=T(r);g&&g.l(A),A.forEach(m),a=O(E);for(let C=0;C<v.length;C+=1)v[C].l(E);E.forEach(m),this.h()},h(){h(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),h(e,"tabindex","-1"),h(n,"class",o=Te(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(y,E){M(y,e,E),M(y,l,E),M(y,n,E),f(n,r),g&&g.m(r,null),f(n,a);for(let A=0;A<v.length;A+=1)v[A]&&v[A].m(n,null);c=!0,d||(u=q(e,"click",s[11]),d=!0)},p(y,E){if(s=y,g&&g.p&&(!c||E&65536)&&Ls(g,_,s,s[16],c?Ps(_,s[16],E,Bn):Ds(s[16]),Xs),E&8457){p=fe(s[0]);let A;for(A=0;A<p.length;A+=1){const C=Ys(s,p,A);v[A]?(v[A].p(C,E),x(v[A],1)):(v[A]=tl(C),v[A].c(),x(v[A],1),v[A].m(n,null))}for(He(),A=p.length;A<v.length;A+=1)L(A);ze()}(!c||E&4&&o!==(o=Te(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&h(n,"class",o)},i(y){if(!c){y&&ss(()=>{c&&(t||(t=Et(e,ls,{duration:Xt},!0)),t.run(1))}),x(g,y);for(let E=0;E<p.length;E+=1)x(v[E]);y&&ss(()=>{c&&(i||(i=Et(n,ns,{duration:Xt},!0)),i.run(1))}),c=!0}},o(y){y&&(t||(t=Et(e,ls,{duration:Xt},!1)),t.run(0)),J(g,y),v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)J(v[E]);y&&(i||(i=Et(n,ns,{duration:Xt},!1)),i.run(0)),c=!1},d(y){y&&(m(e),m(l),m(n)),y&&t&&t.end(),g&&g.d(y),Ve(v,y),y&&i&&i.end(),d=!1,u()}}}function el(s){let e,t,l,n,r,a,o=s[23]+"",i,c,d,u,_;const g=[Mn,Gn],p=[];function v(y,E){return y[24]?0:1}l=v(s),n=p[l]=g[l](s);function L(){return s[20](s[22])}return{c(){e=b("li"),t=b("button"),n.c(),r=V(),a=b("div"),i=Z(o),c=V(),this.h()},l(y){e=k(y,"LI",{});var E=T(e);t=k(E,"BUTTON",{class:!0});var A=T(t);n.l(A),r=O(A),a=k(A,"DIV",{});var C=T(a);i=ee(C,o),C.forEach(m),A.forEach(m),c=O(E),E.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),$(t,"selected",s[22]===s[3])},m(y,E){M(y,e,E),f(e,t),p[l].m(t,null),f(t,r),f(t,a),f(a,i),f(e,c),d=!0,u||(_=q(t,"click",L),u=!0)},p(y,E){s=y;let A=l;l=v(s),l===A?p[l].p(s,E):(He(),J(p[A],1,1,()=>{p[A]=null}),ze(),n=p[l],n?n.p(s,E):(n=p[l]=g[l](s),n.c()),x(n,1),n.m(t,r)),(!d||E&1)&&o!==(o=s[23]+"")&&he(i,o),(!d||E&9)&&$(t,"selected",s[22]===s[3])},i(y){d||(x(n),d=!0)},o(y){J(n),d=!1},d(y){y&&m(e),p[l].d(),u=!1,_()}}}function Gn(s){let e;return{c(){e=b("div"),this.h()},l(t){e=k(t,"DIV",{class:!0}),T(e).forEach(m),this.h()},h(){h(e,"class","w-[24px]")},m(t,l){M(t,e,l)},p:ve,i:ve,o:ve,d(t){t&&m(e)}}}function Mn(s){let e,t;return e=new Qe({props:{class:"mr-2",icon:s[24],width:16}}),{c(){ye(e.$$.fragment)},l(l){Ee(e.$$.fragment,l)},m(l,n){we(e,l,n),t=!0},p(l,n){const r={};n&1&&(r.icon=l[24]),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){J(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function tl(s){let e,t,l=!s[8][s[26]]&&el(s);return{c(){l&&l.c(),e=Pe()},l(n){l&&l.l(n),e=Pe()},m(n,r){l&&l.m(n,r),M(n,e,r),t=!0},p(n,r){n[8][n[26]]?l&&(He(),J(l,1,1,()=>{l=null}),ze()):l?(l.p(n,r),r&256&&x(l,1)):(l=el(n),l.c(),x(l,1),l.m(e.parentNode,e))},i(n){t||(x(l),t=!0)},o(n){J(l),t=!1},d(n){n&&m(e),l&&l.d(n)}}}function Un(s){let e,t,l,n,r,a,o,i,c,d=s[6]&&Zs(s);return{c(){e=b("div"),t=b("input"),r=V(),d&&d.c(),this.h()},l(u){e=k(u,"DIV",{class:!0,id:!0});var _=T(e);t=k(_,"INPUT",{class:!0,title:!0}),r=O(_),d&&d.l(_),_.forEach(m),this.h()},h(){h(t,"class",l=Te(`${s[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"),h(t,"title",n=s[14].title||""),$(t,"disabled",s[4]),$(t,"open",s[6]),h(e,"class",a=Te(`relative ${s[2]||""}`)+" svelte-h65upg"),h(e,"id",s[1])},m(u,_){M(u,e,_),f(e,t),et(t,s[7]),f(e,r),d&&d.m(e,null),s[21](e),o=!0,i||(c=[q(t,"input",s[18]),q(t,"click",s[9]),q(t,"focus",s[19]),q(t,"input",s[10]),q(t,"keydown",s[12])],i=!0)},p(u,[_]){(!o||_&16384&&l!==(l=Te(`${u[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"))&&h(t,"class",l),(!o||_&16384&&n!==(n=u[14].title||""))&&h(t,"title",n),_&128&&t.value!==u[7]&&et(t,u[7]),(!o||_&16400)&&$(t,"disabled",u[4]),(!o||_&16448)&&$(t,"open",u[6]),u[6]?d?(d.p(u,_),_&64&&x(d,1)):(d=Zs(u),d.c(),x(d,1),d.m(e,null)):d&&(He(),J(d,1,1,()=>{d=null}),ze()),(!o||_&4&&a!==(a=Te(`relative ${u[2]||""}`)+" svelte-h65upg"))&&h(e,"class",a),(!o||_&2)&&h(e,"id",u[1])},i(u){o||(x(d),o=!0)},o(u){J(d),o=!1},d(u){u&&m(e),d&&d.d(),s[21](null),i=!1,Ye(c)}}}const Xt=400;function Rn(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:r,id:a=void 0,containerClass:o=void 0,selected:i,disabled:c=void 0,onSelect:d}=e,u,_=!1,g=i,p=r.map(j=>!1);function v(){c||t(6,_=!_)}function L(j){t(8,p=r.map(I=>!I.value.toLowerCase().includes(j.currentTarget.value.toLowerCase())))}function y(){t(7,g=i),t(6,_=!1),t(8,p=r.map(j=>!1))}function E(j){if(j.key==="Enter"){const I=p.findIndex(D=>!D);g===i?y():I>-1&&t(6,_=d(r[I].key)),_||(t(8,p=r.map(D=>!1)),j.currentTarget instanceof HTMLElement&&j.currentTarget.blur())}else j.key==="Escape"&&(y(),j.currentTarget instanceof HTMLElement&&j.currentTarget.blur())}function A(j){t(6,_=d(j))}function C(){g=this.value,t(7,g),t(3,i)}const U=()=>t(6,_=!0),P=j=>A(j);function B(j){Vs[j?"unshift":"push"](()=>{u=j,t(5,u)})}return s.$$set=j=>{t(14,e=Ae(Ae({},e),Se(j))),"options"in j&&t(0,r=j.options),"id"in j&&t(1,a=j.id),"containerClass"in j&&t(2,o=j.containerClass),"selected"in j&&t(3,i=j.selected),"disabled"in j&&t(4,c=j.disabled),"onSelect"in j&&t(15,d=j.onSelect),"$$scope"in j&&t(16,n=j.$$scope)},s.$$.update=()=>{s.$$.dirty&8&&t(7,g=i),s.$$.dirty&1&&t(8,p=r.map(j=>!1))},e=Se(e),[r,a,o,i,c,u,_,g,p,v,L,y,E,A,e,d,n,l,C,U,P,B]}class _n extends We{constructor(e){super(),qe(this,e,Rn,Un,Je,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:15})}}const sl={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Ze(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:pn(s,e,t),flats:e,sharps:t}}function pn(s,e,t){return(s<8?sl[s]:sl[s%7])-e+t+Math.floor(s/8)*12}function gn(s){let e,t=0,l=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(l=Math.floor(s/100),e=s%100):e=s;const n=pn(e,t,l);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(l)}`,interval_seq:e,semitones:n,flats:t,sharps:l}}const Kn=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let bs=[];function vn(){return Kn.map(s=>{const e=s[3].map(gn);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function Mt(s){bs.length===0&&(bs=vn());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return bs.find(t=>t.suffixes.find(l=>l===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function Fn(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const a=Math.min(l,n);l-=a,n-=a}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function ts(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const r=t[n],a=s+r.semitones,o=e.scaleNotes.find(_=>_.semitones===a%12),i=r.flats>0,c=r.sharps>0,d=(i?a+1:c?a-1:a)%12,u=i?-1:c?1:0;l.push(Fn(o??e.notesMap.get(d),o?0:u,a))}return l}const ll=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],xn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],nl=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Hn(s){let e=0,t=0;for(let l=0;l<ll.length;l+=1){const n=s.find(a=>a.note.slice(0,2)===ll[l]),r=s.find(a=>a.note.slice(0,2)===xn[l]);if(n)e+=1;else if(r)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:nl.get(e*-1)}:{flats:0,sharps:t,majorSignature:nl.get(t)}}function zn(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function bn(s){return s.map(e=>{const t=[Ze(1)];let l;return e.major?(t.push(Ze(3)),e.suffix.startsWith("+")?t.push(Ze(5,0,1)):e.suffix.startsWith("6")?t.push(Ze(6)):e.suffix.startsWith("7")?t.push(Ze(7,1)):e.suffix.startsWith("maj7")?t.push(Ze(7)):l=Mt("maj")):e.minor?(t.push(Ze(3,1)),e.suffix.startsWith("°")?t.push(Ze(5,1)):e.suffix.startsWith("6")?(t.push(Ze(6)),l=Mt("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Ze(7,1)),l=Mt("m"+e.suffix)):l=Mt("m")):e.suffix.startsWith("sus2")?t.push(Ze(2)):e.suffix.startsWith("sus4")&&t.push(Ze(4)),t.length<=2&&t.push(Ze(5)),t.length<=2&&t.push(Ze(8)),l||(l=Mt(e.suffix)),{...l,intervals:t}})}function Wn(s,e){let t=e.has(4)&&e.has(7),l=e.has(3)&&e.has(7);const n=zn(s);let r="";return t||l||(e.has(3)&&e.has(6)?(r="°",l=!0):e.has(4)&&e.has(8)?(r="+",t=!0):e.has(3)&&e.has(10)?(l=!0,r="7"):e.has(4)&&e.has(10)?(r="7",t=!0):e.has(4)&&e.has(11)?(r="maj7",t=!0):e.has(3)&&e.has(8)?(r="6",l=!0):e.has(4)&&e.has(9)?(r="6",t=!0):e.has(2)?r="sus2":e.has(5)?r="sus4":e.has(7)?r="5":r="?"),{degree:s,roman:l?n.toLowerCase():n,suffix:r,major:t,minor:l,semitones:e}}function qn(s){const e=s.length;return s.map((t,l)=>{const n=t.semitones,r=new Set;for(let a=1;a<e;a+=1){const o=s[(l+a)%e].semitones,i=o<=n?o+12-n:o-n;r.add(i)}return Wn(t.interval_seq,r)})}const Jn=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let ks=[];function ds(){return Jn.map(s=>{const e=s[0],t=s[1].map(gn),l=qn(t);return{names:e,intervals:t,triads:l}})}function $n(s){ks.length===0&&(ks=ds());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return ks.find(t=>t.names.find(l=>l.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const Qn=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,Yn=/^[0-9]$/,it=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function is(s){const e=s.midi+s.flats-s.sharps;return e===12?1:Math.floor((e-12)/12)}function lt(s){return`${s.note}${is(s)}`}function Ot(s){const t=(s-12)%12;return{...it[t],semitones:t,midi:s}}function Xn(s,e=!0,t=!1){if(e&&!Qn.test(s))return{err:`Unrecognized note "${s}"`,code:400};const l=s.trim(),n=l.charAt(0).toUpperCase(),r=it.find(u=>u.note.charAt(0)===n&&u.note.length===1);if(!r)return{err:`Unable to find note ${l}`,code:500};const a=l.slice(1).split("").reduce((u,_)=>u+(_.toLowerCase()==="b"||_==="♭"?-1:_==="#"||_==="♯"?1:0),0);let o;if(Yn.test(l.charAt(l.length-1)))try{o=parseInt(l.charAt(l.length-1),10)}catch{}if(t&&o===void 0)return{err:`No octave provided: ${s}`,code:400};o===void 0&&(o=0);let i=(r.semitones+a)%12;i=i<0?i+12:i;const c=a<0?-a:0,d=a>0?a:0;return{data:{note:`${n}${"♭".repeat(c)}${"♯".repeat(d)}`,semitones:i,midi:12+o*12+i,flats:c,sharps:d}}}function Os(s){const e=it.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((n,r)=>n+(r.toLowerCase()==="b"||r==="♭"?-1:r==="#"||r==="♯"?1:0),0),l=(e.semitones+t)%12;return{note:s,semitones:l<0?l+12:l,flats:t<0?-t:0,sharps:t>0?t:0}}}const Zn=/^[a-gA-G][♭b#♯]?$/,ys="ABCDEFG";function ea(s,e){return e.map(t=>ys.charAt((ys.indexOf(s)+t.interval_seq-1)%ys.length))}function ta(s,e,t){return t.map((l,n)=>{const r=e[n],a=(s+l.semitones)%12,o=it[a],i=o.note.charAt(0);if(i<r&&(i!=="A"||r!=="G")||i==="G"&&r==="A"){let c=1,d=it[(a+c)%12];for(;d.note.charAt(0)!==r;)c+=1,d=it[(a+c)%12];return{semitones:a,note:d.note+"♭".repeat(c),flats:c+(d.note.includes("♭")?1:0),sharps:0}}else if(i>r||i==="A"&&r==="G"){let c=1,d=a===0?it.length-1:a-c,u=it[d];for(;u.note.charAt(0)!==r;)c+=1,d=d===0?it.length-1:d-1,u=it[d];return{semitones:a,note:u.note+"♯".repeat(c),flats:0,sharps:c+(u.note.includes("♯")?1:0)}}else return{semitones:a,note:o.note,flats:o.flats,sharps:o.sharps}})}function Ut(s,e){if(!Zn.test(s))return{err:`Unknown key: ${s}`,code:400};const t=$n(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const l=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,n=Os(l);if(!n)return{err:`Unable to find root for note: ${l}`,code:404};const r=ea(l.charAt(0),t.intervals),a=ta(n.semitones,r,t.intervals),o=new Map(it.map(i=>{const c=a.find(d=>d.semitones===i.semitones);return c?[i.semitones,c]:[i.semitones,{...i}]}));return{data:{key:l,scale:t.names[0],names:t.names,...Hn(a),intervals:t.intervals.map(i=>({...i})),triads:t.triads.map(i=>({...i})),scaleNotes:a,notesMap:o}}}const Cs=new Map;function sa(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function la(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(l){return{err:`Failed to store the value: ${l}`,code:400}}}function _t(s,e){const{key:t,storage:l="local",namespace:n="default"}=e,r=sa(t,l),a=Ie(s);"data"in r?s.set(e.deserialize?e.deserialize(r.data):r.data):"err"in r&&(e!=null&&e.debug)&&console.info(r.err);const o=s.subscribe(c=>{const d=la(e.serialize?e.serialize(c):c,t,l);"err"in d&&(e!=null&&e.debug)&&console.error(d.err)}),i=Cs.get(n);return i?i.push({key:t,storage:l,value:s,defaultValue:a,unsubscribe:o}):Cs.set(n,[{key:t,storage:l,value:s,defaultValue:a,unsubscribe:o}]),s}function na(s=["default"],e){s.forEach(t=>{var l;(l=Cs.get(t))==null||l.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function aa(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const l=await t.arrayBuffer();return{data:await e.decodeAudioData(l)}}async function ra(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],l=await Promise.all(t.map(r=>aa(`${s}${r}`,e))),n=[];return l.forEach(r=>{"err"in r?console.error(`Failed to load audio: ${r.err}`):n.push(r.data)}),n}class oa{constructor(e,t,l,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(l),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(l))}on(e,t,l,n,r,a,o,i){this.noteA.buffer=e,this.noteA.playbackRate.value=l,this.biquadFilter.frequency.value=r,this.gainA.gain.value=a,this.gain.gain.value=i,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=o,this.noteB.start(0)),this.noteA.start(0)}off(e,t,l){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(l),this.noteB.stop(l),(n=this.damp)==null||n.start(0)}}class ia{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,l)=>{this.bufferlists.push(t),l===8?this.damper=t:l===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(l=>{this.noteOn(l,t)})}noteOn(e,t=80){if(e<109&&e>20){const l=this.notes.get(e);l&&(l.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),r=n+1,a=n*12+21,o=2**((e-69)/12)*440,i=t/127;let c=o*(2-(e-21)/50)+3*o*i;e<60&&(c=440*(3-(60-21)/50)+3*o*i);const d=1-(e%12/12+1)/12,u=Math.pow(2,(e-a)/12),_=0,g=0,p=i**1.4,v=new oa(e,this.context,this.directGain,this.damper);v.on(this.bufferlists[n],this.bufferlists[r],u,_,c,d,g,p),this.notes.set(e,v)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const ca="/midi-note-trainer/",Ts=_t(Ge(!1),{key:"midi-access"}),cs=Ge(void 0),hs=_t(Ge([60,84]),{key:"midi-range",storage:"session"}),Bt=It(hs,s=>[Ot(s[0]),Ot(s[1])]),al=Ge(void 0),nt=Ge(void 0),at=_t(Ge({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),je={async openMidi(){return Yt.enable().then(()=>(Ts.set(!0),Yt.inputs.length>0?(cs.set(Yt.inputs[0]),{data:Yt.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(s=>({err:s.toString(),code:403}))},disableMidi(){Ts.set(!1),cs.set(void 0)},setMidiRange(s){hs.set(s)},setInputValue(s,e){at.update(t=>({...t,[s]:e})),s==="useSound"&&!e?nt.set(void 0):s==="useSound"&&!Ie(nt)&&this.initAudio()},async initAudio(){let s=Ie(al);if(s||(s=new AudioContext,al.set(s)),!Ie(nt)){const e=new ia(s),t=await ra(`${ca}audio`,s);e.load(t),nt.set(e)}}};let ot;An({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}});const Tt=Ge(["C","Major"]),Gt=It(Tt,s=>{const e=Ut(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),rl=Ge([]),yt=Ge([]);function Is(s,e){if(s.length>0){const t=Date.now();let l=t;const n=s.filter(r=>(r.started+e>t&&(l=Math.min(l,r.started)),r.started+e>t));return!ot&&n.length>0&&(ot=setTimeout(()=>{ot=void 0,yt.update(r=>Is(r,e))},e-(t-l)+100)),n}return s}const Le={setKey(s){Tt.update(e=>[s,e[1]])},setScale(s){Tt.update(e=>[e[0],s])},setKeyAndScale(s,e){Tt.set([s,e])},setTarget(s=[]){rl.set(s)},getNote(s){return{...Ie(Gt).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const n={...Ie(Gt).notesMap.get(s%12),midi:s},r=Date.now(),a=e===void 0?"default":e?"correct":"wrong";if(yt.update(o=>{const i=o.findIndex(c=>c.midi===s);return i>=0&&o.splice(i,1),[...o,{...n,color:a,started:r}]}),!ot&&t!==-1){const o=t??Ie(at).keyFadeTimeout;ot=setTimeout(()=>{ot=void 0,yt.update(i=>Is(i,o))},o)}},setPlayed(s,e,t){const l=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(yt.update(r=>[...s.map(a=>({...a,color:n,started:l}))]),!ot&&t!==-1){const r=t??Ie(at).keyFadeTimeout;ot=setTimeout(()=>{ot=void 0,yt.update(a=>Is(a,r))},r)}},clearPlayed(){yt.set([]),clearTimeout(ot),ot=void 0},clearScore(s=!1){s&&Tt.set(["C","Major"]),rl.set([]),yt.set([])}};class js{constructor(e,t,l){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=l;const n=[],{count:r}=l,a=t.map(i=>typeof i=="object"&&i!==null?{...i}:i);let o=l.duplicates;!l.duplicates&&r>a.length&&(console.warn(`Trying to create game with count ${r} larger than available unique values ${t.length}`),o=!0);for(let i=0;i<r;i+=1){const c=Math.floor(Math.random()*a.length);if(o)n.push(a[c]);else{const d=a.splice(c,1);d.length>0&&n.push(d[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function ua(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const a=Math.min(l,n);l-=a,n-=a}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function fa(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const r=t[n],a=s+r.semitones,o=e.scaleNotes.find(_=>_.semitones===a%12),i=r.flats>0,c=r.sharps>0,d=(i?a+1:c?a-1:a)%12,u=i?-1:c?1:0;l.push(ua(o??e.notesMap.get(d),o?0:u,a))}return l}const da=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function ha(s){const t=(s-12)%12;return{...da[t],semitones:t,midi:s}}function ma(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class ht extends js{constructor(e,t,l){const n=t.range[0],r=t.range[1],a=new Set(t.scale.scaleNotes.map(i=>i.semitones)),o=l.chords.flatMap(i=>{const c=[],d=i.intervals.reduce((u,_)=>_.semitones>u?_.semitones:u,0);for(let u=n;u<=r-d;u+=1)if((!l.onlyScale||a.has(u%12))&&(!i.allowed||i.allowed.has(u%12))){const _=fa(u,t.scale,i.intervals);c.push({...i,rootNote:_[0].note,chord:`${_[0].note}${i.suffixes[0]}`,notes:_})}return c});super(e,o,t),this.played=new Set,this.opts=l}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${ma(e)}${e.chord.toLowerCase()}`,notes:[]};let l=this.current.chord===t.chord;return this.current.chord.slice(-3)==="maj"&&!l&&(l=this.current.chord.slice(0,-3)===t.chord),this.addGuessed(t,l)}guess(){const e=Array.from(this.played.values()).map(n=>ha(n)).sort((n,r)=>n.midi-r.midi);this.played.clear();const t={chord:"",notes:e},l=this.current.notes.every(n=>e.find(r=>r.midi%12===n.midi%12));return this.addGuessed(t,l)}}const _a={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class Rt extends js{constructor(e,t){const l=e==="keys-major"?"major":"minor";super(e,Object.keys(_a[l]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class jt extends js{constructor(e,t){const l=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-l+1)).map((r,a)=>l+a),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const kn={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},dt=Ge("waiting"),mt=_t(Ge(kn),{key:"game-options"}),wt=Ge(void 0),Bs=Ge(vn().map(s=>({...s,selected:!0}))),De={play(...[s,e]){var i,c,d;let t;const l=Ie(Gt),n=Ie(hs),r=Ie(mt),a={scale:l,range:n,duplicates:r.duplicates,count:r.count};let o=[l.key,l.scale];if(s==="notes")t=new jt(s,a),Le.setTarget([Le.getNote(t.current)]),(i=Ie(nt))==null||i.noteOn(t.current);else if(s==="pitches")t=new jt(s,a),Le.setTarget(),je.setInputValue("useSound",!0),(c=Ie(nt))==null||c.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new Rt(s,a),o=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new ht(s,a,e);else if(s==="chords-diatonic"){const u=bn(l.triads).map((_,g)=>({..._,allowed:new Set([l.scaleNotes[g].semitones])}));t=new ht(s,a,{chords:u})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((d=Ie(nt))==null||d.playChord(t.current.notes.map(u=>u.midi)),Le.setTarget(t.current.notes)),Le.setKeyAndScale(o[0],o[1]),Le.clearPlayed(),dt.set("waiting"),wt.set(t),t},updateState(s){dt.set(s)},setOptionValue(s,e){mt.update(t=>({...t,[s]:e}))},toggleChords(s){Bs.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Ie(wt);s!=null&&s.ended?dt.set("ended"):s instanceof jt?(s.type==="notes"?Le.setTarget([Le.getNote(s.current)]):Le.setTarget(),Le.clearPlayed(),(e=Ie(nt))==null||e.noteOn(s.current),De.updateState("waiting"),s.startTime()):s instanceof ht?(Le.setTarget(s.current.notes),Le.clearPlayed(),(t=Ie(nt))==null||t.playChord(s==null?void 0:s.current.notes.map(l=>l.midi)),dt.set("waiting"),s.startTime()):s instanceof Rt&&(Le.setKey(s.current),dt.set("waiting"),s.startTime())},clearGame(s=!1){const e=Ie(wt);e&&Le.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&mt.set(kn),wt.set(void 0),dt.set("waiting"),Le.clearScore()}};function ol(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function il(s,e,t){const l=s.slice();return l[40]=e[t],l}function cl(s,e,t){const l=s.slice();return l[9]=e[t],l}function ul(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function fl(s,e,t){const l=s.slice();return l[40]=e[t],l}function dl(s,e,t){const l=s.slice();return l[9]=e[t],l}function pa(s){let e,t=fe(s[35].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=hl(fl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&128){t=fe(n[35].intervals);let a;for(a=0;a<t.length;a+=1){const o=fl(n,t,a);l[a]?l[a].p(o,r):(l[a]=hl(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function ga(s){let e,t=fe(s[3][s[37]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=ml(dl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&8){t=fe(n[3][n[37]]);let a;for(a=0;a<t.length;a+=1){const o=dl(n,t,a);l[a]?l[a].p(o,r):(l[a]=ml(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function hl(s){let e,t=s[40].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var r=T(e);l=ee(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1rg0xw5")},m(n,r){M(n,e,r),f(e,l)},p(n,r){r[0]&128&&t!==(t=n[40].interval+"")&&he(l,t)},d(n){n&&m(e)}}}function ml(s){let e,t=s[9].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var r=T(e);l=ee(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1rg0xw5")},m(n,r){M(n,e,r),f(e,l)},p(n,r){r[0]&8&&t!==(t=n[9].note+"")&&he(l,t)},d(n){n&&m(e)}}}function _l(s){let e,t,l,n,r,a,o=s[35].suffixes[0]+"",i,c,d,u,_,g,p,v=s[35].name+"",L,y,E,A,C;n=new Qe({props:{icon:s[35].selected?rs:os,width:12}});function U(){return s[25](s[35])}function P(D,S){return D[3][D[37]]&&D[3][D[37]].length>0?ga:pa}let B=P(s),j=B(s);function I(){return s[26](s[35])}return{c(){e=b("li"),t=b("button"),l=b("span"),ye(n.$$.fragment),r=V(),a=b("div"),i=Z(o),c=V(),d=b("li"),j.c(),_=V(),g=b("li"),p=b("button"),L=Z(v),y=V(),this.h()},l(D){e=k(D,"LI",{});var S=T(e);t=k(S,"BUTTON",{class:!0});var w=T(t);l=k(w,"SPAN",{class:!0});var N=T(l);Ee(n.$$.fragment,N),N.forEach(m),r=O(w),a=k(w,"DIV",{class:!0});var R=T(a);i=ee(R,o),R.forEach(m),w.forEach(m),S.forEach(m),c=O(D),d=k(D,"LI",{class:!0,title:!0});var K=T(d);j.l(K),K.forEach(m),_=O(D),g=k(D,"LI",{class:!0});var F=T(g);p=k(F,"BUTTON",{class:!0});var ne=T(p);L=ee(ne,v),ne.forEach(m),y=O(F),F.forEach(m),this.h()},h(){h(l,"class","px-1 py-1 rounded"),$(l,"text-green-500",s[35].selected),$(l,"text-gray-400",!s[35].selected),h(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),h(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),$(t,"hidden",s[8]),h(d,"class","intervals svelte-1rg0xw5"),h(d,"title",u=s[35].intervals.map(bl).join("-")),h(p,"class","text-start"),h(g,"class","text-xs")},m(D,S){M(D,e,S),f(e,t),f(t,l),we(n,l,null),f(t,r),f(t,a),f(a,i),M(D,c,S),M(D,d,S),j.m(d,null),M(D,_,S),M(D,g,S),f(g,p),f(p,L),f(g,y),E=!0,A||(C=[q(t,"click",U),q(p,"click",I)],A=!0)},p(D,S){s=D;const w={};S[0]&128&&(w.icon=s[35].selected?rs:os),n.$set(w),(!E||S[0]&128)&&$(l,"text-green-500",s[35].selected),(!E||S[0]&128)&&$(l,"text-gray-400",!s[35].selected),(!E||S[0]&128)&&o!==(o=s[35].suffixes[0]+"")&&he(i,o),(!E||S[0]&256)&&$(t,"hidden",s[8]),B===(B=P(s))&&j?j.p(s,S):(j.d(1),j=B(s),j&&(j.c(),j.m(d,null))),(!E||S[0]&128&&u!==(u=s[35].intervals.map(bl).join("-")))&&h(d,"title",u),(!E||S[0]&128)&&v!==(v=s[35].name+"")&&he(L,v)},i(D){E||(x(n.$$.fragment,D),E=!0)},o(D){J(n.$$.fragment,D),E=!1},d(D){D&&(m(e),m(c),m(d),m(_),m(g)),Ce(n),j.d(),A=!1,Ye(C)}}}function va(s){let e,t=fe(s[35].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=pl(il(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&64){t=fe(n[35].intervals);let a;for(a=0;a<t.length;a+=1){const o=il(n,t,a);l[a]?l[a].p(o,r):(l[a]=pl(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function ba(s){let e,t=fe(s[4][s[37]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=gl(cl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r[0]&16){t=fe(n[4][n[37]]);let a;for(a=0;a<t.length;a+=1){const o=cl(n,t,a);l[a]?l[a].p(o,r):(l[a]=gl(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function pl(s){let e,t=s[40].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var r=T(e);l=ee(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1rg0xw5")},m(n,r){M(n,e,r),f(e,l)},p(n,r){r[0]&64&&t!==(t=n[40].interval+"")&&he(l,t)},d(n){n&&m(e)}}}function gl(s){let e,t=s[9].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var r=T(e);l=ee(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1rg0xw5")},m(n,r){M(n,e,r),f(e,l)},p(n,r){r[0]&16&&t!==(t=n[9].note+"")&&he(l,t)},d(n){n&&m(e)}}}function vl(s){let e,t,l,n,r,a,o=s[35].suffixes[0]+"",i,c,d,u,_,g,p,v=s[35].name+"",L,y,E,A,C;n=new Qe({props:{icon:s[35].selected?rs:os,width:12}});function U(){return s[27](s[35])}function P(D,S){return D[4][D[37]]&&D[4][D[37]].length>0?ba:va}let B=P(s),j=B(s);function I(){return s[28](s[35])}return{c(){e=b("li"),t=b("button"),l=b("span"),ye(n.$$.fragment),r=V(),a=b("div"),i=Z(o),c=V(),d=b("li"),j.c(),_=V(),g=b("li"),p=b("button"),L=Z(v),y=V(),this.h()},l(D){e=k(D,"LI",{});var S=T(e);t=k(S,"BUTTON",{class:!0});var w=T(t);l=k(w,"SPAN",{class:!0});var N=T(l);Ee(n.$$.fragment,N),N.forEach(m),r=O(w),a=k(w,"DIV",{class:!0});var R=T(a);i=ee(R,o),R.forEach(m),w.forEach(m),S.forEach(m),c=O(D),d=k(D,"LI",{class:!0,title:!0});var K=T(d);j.l(K),K.forEach(m),_=O(D),g=k(D,"LI",{class:!0});var F=T(g);p=k(F,"BUTTON",{class:!0});var ne=T(p);L=ee(ne,v),ne.forEach(m),y=O(F),F.forEach(m),this.h()},h(){h(l,"class","px-1 py-1 rounded"),$(l,"text-green-500",s[35].selected),$(l,"text-gray-400",!s[35].selected),h(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),h(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),$(t,"hidden",s[8]),h(d,"class","intervals svelte-1rg0xw5"),h(d,"title",u=s[35].intervals.map(kl).join("-")),h(p,"class","text-start"),h(g,"class","text-xs")},m(D,S){M(D,e,S),f(e,t),f(t,l),we(n,l,null),f(t,r),f(t,a),f(a,i),M(D,c,S),M(D,d,S),j.m(d,null),M(D,_,S),M(D,g,S),f(g,p),f(p,L),f(g,y),E=!0,A||(C=[q(t,"click",U),q(p,"click",I)],A=!0)},p(D,S){s=D;const w={};S[0]&64&&(w.icon=s[35].selected?rs:os),n.$set(w),(!E||S[0]&64)&&$(l,"text-green-500",s[35].selected),(!E||S[0]&64)&&$(l,"text-gray-400",!s[35].selected),(!E||S[0]&64)&&o!==(o=s[35].suffixes[0]+"")&&he(i,o),(!E||S[0]&256)&&$(t,"hidden",s[8]),B===(B=P(s))&&j?j.p(s,S):(j.d(1),j=B(s),j&&(j.c(),j.m(d,null))),(!E||S[0]&64&&u!==(u=s[35].intervals.map(kl).join("-")))&&h(d,"title",u),(!E||S[0]&64)&&v!==(v=s[35].name+"")&&he(L,v)},i(D){E||(x(n.$$.fragment,D),E=!0)},o(D){J(n.$$.fragment,D),E=!1},d(D){D&&(m(e),m(c),m(d),m(_),m(g)),Ce(n),j.d(),A=!1,Ye(C)}}}function ka(s){let e,t,l,n,r="Chords",a,o,i,c,d,u,_,g,p,v,L,y,E,A,C,U,P,B="Key",j,I,D,S,w="Scale",N,R,K,F,ne="Note",me,Q,W,G,se,H,te,ie,be,ae;c=new Qe({props:{icon:Pn,width:20}}),_=new Qe({props:{icon:Vn,width:16}}),v=new Qe({props:{icon:s[5]?Js:$s,width:16}}),E=new Qe({props:{icon:Kt,width:16}}),R=new _n({props:{class:"bg-gray-100 w-48",containerClass:"input w-48",selected:s[1],options:s[10],onSelect:s[14]}});let de=fe(s[7]),Y=[];for(let z=0;z<de.length;z+=1)Y[z]=_l(ul(s,de,z));const ce=z=>J(Y[z],1,1,()=>{Y[z]=null});let ge=fe(s[6]),ue=[];for(let z=0;z<ge.length;z+=1)ue[z]=vl(ol(s,ge,z));const Ke=z=>J(ue[z],1,1,()=>{ue[z]=null});return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,a=V(),o=b("div"),i=b("button"),ye(c.$$.fragment),d=V(),u=b("button"),ye(_.$$.fragment),g=V(),p=b("button"),ye(v.$$.fragment),L=V(),y=b("button"),ye(E.$$.fragment),A=V(),C=b("div"),U=b("div"),P=b("label"),P.textContent=B,j=V(),I=b("input"),D=V(),S=b("label"),S.textContent=w,N=V(),ye(R.$$.fragment),K=V(),F=b("label"),F.textContent=ne,me=V(),Q=b("input"),W=V(),G=b("ul");for(let z=0;z<Y.length;z+=1)Y[z].c();se=V(),H=b("ul");for(let z=0;z<ue.length;z+=1)ue[z].c();this.h()},l(z){e=k(z,"DIV",{class:!0});var oe=T(e);t=k(oe,"FIELDSET",{class:!0});var pe=T(t);l=k(pe,"LEGEND",{class:!0});var tt=T(l);n=k(tt,"BUTTON",{class:!0,"data-svelte-h":!0}),re(n)!=="svelte-1knqzl6"&&(n.textContent=r),tt.forEach(m),a=O(pe),o=k(pe,"DIV",{class:!0});var le=T(o);i=k(le,"BUTTON",{class:!0});var Oe=T(i);Ee(c.$$.fragment,Oe),Oe.forEach(m),d=O(le),u=k(le,"BUTTON",{class:!0});var Me=T(u);Ee(_.$$.fragment,Me),Me.forEach(m),g=O(le),p=k(le,"BUTTON",{class:!0});var pt=T(p);Ee(v.$$.fragment,pt),pt.forEach(m),L=O(le),y=k(le,"BUTTON",{class:!0});var At=T(y);Ee(E.$$.fragment,At),At.forEach(m),le.forEach(m),A=O(pe),C=k(pe,"DIV",{class:!0});var Fe=T(C);U=k(Fe,"DIV",{class:!0});var Ue=T(U);P=k(Ue,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(P)!=="svelte-14m38zf"&&(P.textContent=B),j=O(Ue),I=k(Ue,"INPUT",{class:!0,id:!0}),D=O(Ue),S=k(Ue,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(S)!=="svelte-bxhcb0"&&(S.textContent=w),N=O(Ue),Ee(R.$$.fragment,Ue),K=O(Ue),F=k(Ue,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(F)!=="svelte-dmbfli"&&(F.textContent=ne),me=O(Ue),Q=k(Ue,"INPUT",{class:!0,id:!0}),Ue.forEach(m),W=O(Fe),G=k(Fe,"UL",{class:!0});var St=T(G);for(let $e=0;$e<Y.length;$e+=1)Y[$e].l(St);St.forEach(m),se=O(Fe),H=k(Fe,"UL",{class:!0});var st=T(H);for(let $e=0;$e<ue.length;$e+=1)ue[$e].l(st);st.forEach(m),Fe.forEach(m),pe.forEach(m),oe.forEach(m),this.h()},h(){h(n,"class","px-1 rounded hover:bg-gray-100"),h(l,"class","text-base"),h(i,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),$(i,"hidden",s[8]),h(u,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(u,"hidden",s[8]),h(p,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(p,"hidden",s[8]),h(y,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(y,"hidden",s[8]),h(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),h(P,"class","mr-4 font-bold svelte-1rg0xw5"),h(P,"for","scale-key"),h(I,"class","input bg-gray-100 w-12 px-1 rounded"),h(I,"id","scale-key"),I.value=s[0],h(S,"class","font-bold svelte-1rg0xw5"),h(S,"for","scale-key"),h(F,"class","font-bold svelte-1rg0xw5"),h(F,"for","scale-key"),h(Q,"class","input bg-gray-100 w-12 px-1 rounded"),h(Q,"id","scale-key"),Q.value=s[2],h(U,"class","flex mb-2 options svelte-1rg0xw5"),h(G,"class","chord-list w-full svelte-1rg0xw5"),h(H,"class","chord-list w-full svelte-1rg0xw5"),h(C,"class","body svelte-1rg0xw5"),$(C,"hidden",s[8]),h(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1rg0xw5"),$(t,"collapsed",s[8]),h(e,"class",te=Te(`${s[22].class||""}`)+" svelte-1rg0xw5")},m(z,oe){M(z,e,oe),f(e,t),f(t,l),f(l,n),f(t,a),f(t,o),f(o,i),we(c,i,null),f(o,d),f(o,u),we(_,u,null),f(o,g),f(o,p),we(v,p,null),f(o,L),f(o,y),we(E,y,null),f(t,A),f(t,C),f(C,U),f(U,P),f(U,j),f(U,I),f(U,D),f(U,S),f(U,N),we(R,U,null),f(U,K),f(U,F),f(U,me),f(U,Q),f(C,W),f(C,G);for(let pe=0;pe<Y.length;pe+=1)Y[pe]&&Y[pe].m(G,null);f(C,se),f(C,H);for(let pe=0;pe<ue.length;pe+=1)ue[pe]&&ue[pe].m(H,null);ie=!0,be||(ae=[q(n,"click",s[12]),q(i,"click",s[17]),q(u,"click",s[18]),q(p,"click",s[19]),q(y,"click",s[20]),q(I,"input",s[13]),q(Q,"input",s[15])],be=!0)},p(z,oe){(!ie||oe[0]&256)&&$(i,"hidden",z[8]),(!ie||oe[0]&256)&&$(u,"hidden",z[8]);const pe={};oe[0]&32&&(pe.icon=z[5]?Js:$s),v.$set(pe),(!ie||oe[0]&256)&&$(p,"hidden",z[8]),(!ie||oe[0]&256)&&$(y,"hidden",z[8]),(!ie||oe[0]&1&&I.value!==z[0])&&(I.value=z[0]);const tt={};if(oe[0]&2&&(tt.selected=z[1]),R.$set(tt),(!ie||oe[0]&4&&Q.value!==z[2])&&(Q.value=z[2]),oe[0]&2163080){de=fe(z[7]);let le;for(le=0;le<de.length;le+=1){const Oe=ul(z,de,le);Y[le]?(Y[le].p(Oe,oe),x(Y[le],1)):(Y[le]=_l(Oe),Y[le].c(),x(Y[le],1),Y[le].m(G,null))}for(He(),le=de.length;le<Y.length;le+=1)ce(le);ze()}if(oe[0]&2163024){ge=fe(z[6]);let le;for(le=0;le<ge.length;le+=1){const Oe=ol(z,ge,le);ue[le]?(ue[le].p(Oe,oe),x(ue[le],1)):(ue[le]=vl(Oe),ue[le].c(),x(ue[le],1),ue[le].m(H,null))}for(He(),le=ge.length;le<ue.length;le+=1)Ke(le);ze()}(!ie||oe[0]&256)&&$(C,"hidden",z[8]),(!ie||oe[0]&256)&&$(t,"collapsed",z[8]),(!ie||oe[0]&4194304&&te!==(te=Te(`${z[22].class||""}`)+" svelte-1rg0xw5"))&&h(e,"class",te)},i(z){if(!ie){x(c.$$.fragment,z),x(_.$$.fragment,z),x(v.$$.fragment,z),x(E.$$.fragment,z),x(R.$$.fragment,z);for(let oe=0;oe<de.length;oe+=1)x(Y[oe]);for(let oe=0;oe<ge.length;oe+=1)x(ue[oe]);ie=!0}},o(z){J(c.$$.fragment,z),J(_.$$.fragment,z),J(v.$$.fragment,z),J(E.$$.fragment,z),J(R.$$.fragment,z),Y=Y.filter(Boolean);for(let oe=0;oe<Y.length;oe+=1)J(Y[oe]);ue=ue.filter(Boolean);for(let oe=0;oe<ue.length;oe+=1)J(ue[oe]);ie=!1},d(z){z&&m(e),Ce(c),Ce(_),Ce(v),Ce(E),Ce(R),Ve(Y,z),Ve(ue,z),be=!1,Ye(ae)}}}const bl=s=>s.interval,kl=s=>s.interval;function ya(s,e,t){let l,n,r,a,o,i,c,d,u;_e(s,at,G=>t(30,o=G)),_e(s,nt,G=>t(31,i=G)),_e(s,Bt,G=>t(32,c=G)),_e(s,Bs,G=>t(24,d=G));let _="C",g="Major",p=Ut(_,g),v="",L,y=[],E=[];const C=ds().map(G=>({key:G.names[0],value:G.names[0]})),U=_t(Ge(!0),{key:"chords-hidden"});_e(s,U,G=>t(8,u=G));function P(){U.update(G=>!G)}function B(){const G=L&&60+L.semitones;if("err"in p||!G)t(3,y=[]),t(4,E=[]);else{const se=p.data;t(3,y=n.map(H=>ts(G,se,H.intervals))),t(4,E=r.map(H=>ts(G,se,H.intervals)))}}function j({currentTarget:{value:G}}){t(0,_=`${G.charAt(0).toUpperCase()}${G.charAt(1).toLowerCase()}`),p=Ut(_,g),B()}function I(G){var se;return t(1,g=(se=C.find(H=>G===H.key))==null?void 0:se.value),p=Ut(_,g),B(),!1}function D({currentTarget:{value:G}}){t(2,v=`${G.charAt(0).toUpperCase()}${G.charAt(1).toLowerCase()}`),t(9,L=Os(v)),B()}function S(G){De.toggleChords(se=>se.name===G.name?!se.selected:se.selected)}function w(){const G=H=>H.suffixes[0]==="maj"||H.suffixes[0]==="m",se=d.filter(G).every(H=>H.selected);De.toggleChords(H=>G(H)?!se:H.selected)}function N(){const G=H=>H.suffixes[0]==="maj7"||H.suffixes[0]==="m7"||H.suffixes[0]==="7"||H.suffixes[0]==="dim7"||H.suffixes[0]==="aug7",se=d.filter(G).every(H=>H.selected);De.toggleChords(H=>G(H)?!se:H.selected)}function R(){De.toggleChords(G=>!a)}function K(){De.toggleChords(G=>!0)}function F(G){if("err"in p)return;const se=c[0].midi+((L==null?void 0:L.semitones)||0),H=ts(se,p.data,G.intervals);i==null||i.playChord(H.map(te=>te.midi),o.fixedVelocity)}const ne=G=>S(G),me=G=>F(G),Q=G=>S(G),W=G=>F(G);return s.$$set=G=>{t(22,e=Ae(Ae({},e),Se(G)))},s.$$.update=()=>{s.$$.dirty[0]&16777216&&t(23,l=d),s.$$.dirty[0]&8388608&&t(7,n=l.filter((G,se)=>se<l.length/2)),s.$$.dirty[0]&8388608&&t(6,r=l.filter((G,se)=>se>=l.length/2)),s.$$.dirty[0]&8388608&&t(5,a=l.every(G=>G.selected))},e=Se(e),[_,g,v,y,E,a,r,n,u,L,C,U,P,j,I,D,S,w,N,R,K,F,e,l,d,ne,me,Q,W]}class Ea extends We{constructor(e){super(),qe(this,e,ya,ka,Je,{},null,[-1,-1])}}function yl(s,e,t){const l=s.slice();return l[10]=e[t],l}function wa(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){M(t,e,l)},p:ve,d(t){t&&m(e)}}}function Ca(s){let e,t,l="Played:",n,r=fe(s[2]),a=[];for(let o=0;o<r.length;o+=1)a[o]=El(yl(s,r,o));return{c(){e=b("div"),t=b("span"),t.textContent=l,n=V();for(let o=0;o<a.length;o+=1)a[o].c()},l(o){e=k(o,"DIV",{});var i=T(e);t=k(i,"SPAN",{"data-svelte-h":!0}),re(t)!=="svelte-1g6xxhn"&&(t.textContent=l),n=O(i);for(let c=0;c<a.length;c+=1)a[c].l(i);i.forEach(m)},m(o,i){M(o,e,i),f(e,t),f(e,n);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(e,null)},p(o,i){if(i&4){r=fe(o[2]);let c;for(c=0;c<r.length;c+=1){const d=yl(o,r,c);a[c]?a[c].p(d,i):(a[c]=El(d),a[c].c(),a[c].m(e,null))}for(;c<a.length;c+=1)a[c].d(1);a.length=r.length}},d(o){o&&m(e),Ve(a,o)}}}function Ta(s){let e,t,l="Result:",n,r,a,o=s[0].correct+"",i,c,d=s[0].sampled.length+"",u,_,g,p,v,L=s[0].avgTime+"",y,E;return{c(){e=b("div"),t=b("span"),t.textContent=l,n=V(),r=b("span"),a=Z("["),i=Z(o),c=Z(" / "),u=Z(d),_=Z("]"),g=V(),p=b("span"),v=Z("avg "),y=Z(L),E=Z("s"),this.h()},l(A){e=k(A,"DIV",{class:!0});var C=T(e);t=k(C,"SPAN",{"data-svelte-h":!0}),re(t)!=="svelte-1eqfbgx"&&(t.textContent=l),n=O(C),r=k(C,"SPAN",{class:!0});var U=T(r);a=ee(U,"["),i=ee(U,o),c=ee(U," / "),u=ee(U,d),_=ee(U,"]"),U.forEach(m),g=O(C),p=k(C,"SPAN",{});var P=T(p);v=ee(P,"avg "),y=ee(P,L),E=ee(P,"s"),P.forEach(m),C.forEach(m),this.h()},h(){h(r,"class","mx-2"),h(e,"class","flex")},m(A,C){M(A,e,C),f(e,t),f(e,n),f(e,r),f(r,a),f(r,i),f(r,c),f(r,u),f(r,_),f(e,g),f(e,p),f(p,v),f(p,y),f(p,E)},p(A,C){C&1&&o!==(o=A[0].correct+"")&&he(i,o),C&1&&d!==(d=A[0].sampled.length+"")&&he(u,d),C&1&&L!==(L=A[0].avgTime+"")&&he(y,L)},d(A){A&&m(e)}}}function Ia(s){var B,j,I,D;let e,t,l="Target:",n,r,a=((B=s[0].latestGuess.target)==null?void 0:B.chord)+"",o,i,c,d=((j=s[0].latestGuess.target)==null?void 0:j.notes.map(wl).join(" "))+"",u,_,g,p="Guessed:",v,L,y=((I=s[0].latestGuess.guessed)==null?void 0:I.chord)+"",E,A,C,U=((D=s[0].latestGuess.guessed)==null?void 0:D.notes.map(Cl).join(" "))+"",P;return{c(){e=b("div"),t=b("span"),t.textContent=l,n=V(),r=b("span"),o=Z(a),i=V(),c=b("span"),u=Z(d),_=V(),g=b("span"),g.textContent=p,v=V(),L=b("span"),E=Z(y),A=V(),C=b("span"),P=Z(U),this.h()},l(S){e=k(S,"DIV",{class:!0});var w=T(e);t=k(w,"SPAN",{"data-svelte-h":!0}),re(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=O(w),r=k(w,"SPAN",{});var N=T(r);o=ee(N,a),N.forEach(m),i=O(w),c=k(w,"SPAN",{});var R=T(c);u=ee(R,d),R.forEach(m),_=O(w),g=k(w,"SPAN",{"data-svelte-h":!0}),re(g)!=="svelte-104368"&&(g.textContent=p),v=O(w),L=k(w,"SPAN",{});var K=T(L);E=ee(K,y),K.forEach(m),A=O(w),C=k(w,"SPAN",{});var F=T(C);P=ee(F,U),F.forEach(m),w.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(S,w){M(S,e,w),f(e,t),f(e,n),f(e,r),f(r,o),f(e,i),f(e,c),f(c,u),f(e,_),f(e,g),f(e,v),f(e,L),f(L,E),f(e,A),f(e,C),f(C,P)},p(S,w){var N,R,K,F;w&1&&a!==(a=((N=S[0].latestGuess.target)==null?void 0:N.chord)+"")&&he(o,a),w&1&&d!==(d=((R=S[0].latestGuess.target)==null?void 0:R.notes.map(wl).join(" "))+"")&&he(u,d),w&1&&y!==(y=((K=S[0].latestGuess.guessed)==null?void 0:K.chord)+"")&&he(E,y),w&1&&U!==(U=((F=S[0].latestGuess.guessed)==null?void 0:F.notes.map(Cl).join(" "))+"")&&he(P,U)},d(S){S&&m(e)}}}function Aa(s){let e,t,l="Target:",n,r,a=s[0].latestGuess.target+"",o,i,c,d,u,_="Guessed:",g,p,v=s[0].latestGuess.guessed+"",L,y,E;return{c(){e=b("div"),t=b("span"),t.textContent=l,n=V(),r=b("span"),o=Z(a),i=V(),c=b("span"),d=V(),u=b("span"),u.textContent=_,g=V(),p=b("span"),L=Z(v),y=V(),E=b("span"),this.h()},l(A){e=k(A,"DIV",{class:!0});var C=T(e);t=k(C,"SPAN",{"data-svelte-h":!0}),re(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=O(C),r=k(C,"SPAN",{});var U=T(r);o=ee(U,a),U.forEach(m),i=O(C),c=k(C,"SPAN",{}),T(c).forEach(m),d=O(C),u=k(C,"SPAN",{"data-svelte-h":!0}),re(u)!=="svelte-104368"&&(u.textContent=_),g=O(C),p=k(C,"SPAN",{});var P=T(p);L=ee(P,v),P.forEach(m),y=O(C),E=k(C,"SPAN",{}),T(E).forEach(m),C.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(A,C){M(A,e,C),f(e,t),f(e,n),f(e,r),f(r,o),f(e,i),f(e,c),f(e,d),f(e,u),f(e,g),f(e,p),f(p,L),f(e,y),f(e,E)},p(A,C){C&1&&a!==(a=A[0].latestGuess.target+"")&&he(o,a),C&1&&v!==(v=A[0].latestGuess.guessed+"")&&he(L,v)},d(A){A&&m(e)}}}function Sa(s){let e,t,l="Target:",n,r,a=lt(Ot(s[0].latestGuess.target||0))+"",o,i,c,d,u,_="Guessed:",g,p,v=lt(Ot(s[0].latestGuess.guessed||0))+"",L,y,E;return{c(){e=b("div"),t=b("span"),t.textContent=l,n=V(),r=b("span"),o=Z(a),i=V(),c=b("span"),d=V(),u=b("span"),u.textContent=_,g=V(),p=b("span"),L=Z(v),y=V(),E=b("span"),this.h()},l(A){e=k(A,"DIV",{class:!0});var C=T(e);t=k(C,"SPAN",{"data-svelte-h":!0}),re(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=O(C),r=k(C,"SPAN",{});var U=T(r);o=ee(U,a),U.forEach(m),i=O(C),c=k(C,"SPAN",{}),T(c).forEach(m),d=O(C),u=k(C,"SPAN",{"data-svelte-h":!0}),re(u)!=="svelte-104368"&&(u.textContent=_),g=O(C),p=k(C,"SPAN",{});var P=T(p);L=ee(P,v),P.forEach(m),y=O(C),E=k(C,"SPAN",{}),T(E).forEach(m),C.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(A,C){M(A,e,C),f(e,t),f(e,n),f(e,r),f(r,o),f(e,i),f(e,c),f(e,d),f(e,u),f(e,g),f(e,p),f(p,L),f(e,y),f(e,E)},p(A,C){C&1&&a!==(a=lt(Ot(A[0].latestGuess.target||0))+"")&&he(o,a),C&1&&v!==(v=lt(Ot(A[0].latestGuess.guessed||0))+"")&&he(L,v)},d(A){A&&m(e)}}}function El(s){let e,t=lt(s[10])+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var r=T(e);l=ee(r,t),r.forEach(m),this.h()},h(){h(e,"class","mx-1")},m(n,r){M(n,e,r),f(e,l)},p(n,r){r&4&&t!==(t=lt(n[10])+"")&&he(l,t)},d(n){n&&m(e)}}}function Na(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){M(t,e,l)},p:ve,d(t){t&&m(e)}}}function La(s){let e,t="Next",l,n,r="Autoplay",a,o;return{c(){e=b("button"),e.textContent=t,l=V(),n=b("button"),n.textContent=r,this.h()},l(i){e=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-uy473n"&&(e.textContent=t),l=O(i),n=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),re(n)!=="svelte-1cfj1sl"&&(n.textContent=r),this.h()},h(){h(e,"class","btn primary mr-1"),h(n,"class","btn primary")},m(i,c){M(i,e,c),M(i,l,c),M(i,n,c),a||(o=[q(e,"click",s[4]),q(n,"click",s[5])],a=!0)},p:ve,d(i){i&&(m(e),m(l),m(n)),a=!1,Ye(o)}}}function Da(s){let e,t="Stop autoplay",l,n;return{c(){e=b("button"),e.textContent=t,this.h()},l(r){e=k(r,"BUTTON",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){h(e,"class","btn primary")},m(r,a){M(r,e,a),l||(n=q(e,"click",s[9]),l=!0)},p:ve,d(r){r&&m(e),l=!1,n()}}}function Pa(s){let e,t="Try Again",l,n,r="Clear",a,o;return{c(){e=b("button"),e.textContent=t,l=V(),n=b("button"),n.textContent=r,this.h()},l(i){e=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),re(e)!=="svelte-15zs1cu"&&(e.textContent=t),l=O(i),n=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),re(n)!=="svelte-11mnk9v"&&(n.textContent=r),this.h()},h(){h(e,"class","btn primary mr-1"),h(n,"class","btn primary")},m(i,c){M(i,e,c),M(i,l,c),M(i,n,c),a||(o=[q(e,"click",s[6]),q(n,"click",s[7])],a=!0)},p:ve,d(i){i&&(m(e),m(l),m(n)),a=!1,Ye(o)}}}function Va(s){let e,t,l,n;function r(u,_){return u[0]instanceof jt&&(u[1]==="correct"||u[1]==="wrong")?Sa:u[0]instanceof Rt&&(u[1]==="correct"||u[1]==="wrong")?Aa:u[0]instanceof ht&&(u[1]==="correct"||u[1]==="wrong")?Ia:u[0]&&u[1]==="ended"?Ta:u[2].length>0?Ca:wa}let a=r(s),o=a(s);function i(u,_){return u[0]&&u[1]==="ended"?Pa:u[0]&&u[3].autoplay?Da:u[0]?La:Na}let c=i(s),d=c(s);return{c(){e=b("div"),o.c(),l=V(),n=b("div"),d.c(),this.h()},l(u){e=k(u,"DIV",{class:!0});var _=T(e);o.l(_),_.forEach(m),l=O(u),n=k(u,"DIV",{class:!0});var g=T(n);d.l(g),g.forEach(m),this.h()},h(){h(e,"class",t=Te(`${s[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),h(n,"class","mt-2 h-8 flex items-center")},m(u,_){M(u,e,_),o.m(e,null),M(u,l,_),M(u,n,_),d.m(n,null)},p(u,[_]){a===(a=r(u))&&o?o.p(u,_):(o.d(1),o=a(u),o&&(o.c(),o.m(e,null))),_&256&&t!==(t=Te(`${u[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs")&&h(e,"class",t),c===(c=i(u))&&d?d.p(u,_):(d.d(1),d=c(u),d&&(d.c(),d.m(n,null)))},i:ve,o:ve,d(u){u&&(m(e),m(l),m(n)),o.d(),d.d()}}}const wl=s=>s.note,Cl=s=>s.note;function Oa(s,e,t){let l,n,r;_e(s,dt,_=>t(1,l=_)),_e(s,yt,_=>t(2,n=_)),_e(s,mt,_=>t(3,r=_));let{game:a}=e;function o(){De.nextGuess()}function i(){De.setOptionValue("autoplay",!0),De.nextGuess()}function c(){a instanceof ht?De.play(a.type,a.opts):a&&De.play(a.type,void 0)}function d(){De.clearGame()}const u=()=>De.setOptionValue("autoplay",!1);return s.$$set=_=>{t(8,e=Ae(Ae({},e),Se(_))),"game"in _&&t(0,a=_.game)},e=Se(e),[a,l,n,r,o,i,c,d,e,u]}class ja extends We{constructor(e){super(),qe(this,e,Oa,Va,Je,{game:0})}}const As={ar:{name:"Arabic",import:ke(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:ke(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:ke(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:ke(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:ke(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:ke(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:ke(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:ke(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:ke(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>Ga)},fa:{name:"Farsi",import:ke(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:ke(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:ke(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:ke(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:ke(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:ke(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:ke(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:ke(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:ke(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:ke(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:ke(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:ke(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:ke(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:ke(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:ke(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:ke(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:ke(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:ke(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:ke(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:ke(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:ke(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:ke(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:ke(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:ke(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function yn(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default,shift:s.layout.shift}}async function Ba(s=["en"]){let e={code:"en",layout:As.en,index:99};Object.entries(As).forEach(([l,n])=>{for(let r=0;r<s.length;r+=1)l===s[r]&&(!e||e.index>r)&&(e={code:l,layout:n,index:r})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:yn(t.default)}}const En={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Ga=Object.freeze(Object.defineProperty({__proto__:null,default:En},Symbol.toStringTag,{value:"Module"}));function Vt(s,e,t,l=0){const n=t?[0,2,4,5,7,9,11]:[-1,1,3,-1,6,8,10];let r=-1,a=0;return s.forEach((o,i)=>{const c=o.key.charAt(0)==="{";!c&&r===-1&&(r=i);const d=n[(i-r+l)%n.length];if(r!==-1&&i!==0&&!c&&d>=0){const u=e[d],_=Math.floor((l+i-r)/n.length);o.note={...u,semitones:u.semitones+(_>0?_:0)*12},o.note,a=i-r}}),a}const Zt=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function Ma(s){let e=[];const t=s.default.map((l,n)=>{if(n===0){const r=l.split(" ").filter(a=>a!=="{bksp}");for(;r.length!==13;)r.length<13?r.unshift("{empty}"):r.shift();return[...r,"{bksp}"]}else if(n===1){const r=l.split(" ");return e=r.slice(13),[...r.slice(0,13),"{enter}"]}else{if(n===2)return[...l.split(" ").slice(0,13).filter(r=>r!=="{enter}"),...e].slice(0,13);if(n===3){const r=["{shift}",...l.split(" ").slice(1,12).filter(o=>o!=="{shift}"),"{shift}"];let a=1;for(;r.length<13;)r.splice(a,0,"{empty}"),a=a===1?-1:1;return r}else return l.split(" ")}});return[t[0].map((l,n)=>({key:l,code:Zt[0][n]})),t[1].map((l,n)=>({key:l,code:Zt[1][n]})),t[2].map((l,n)=>({key:l,code:Zt[2][n]})),t[3].map((l,n)=>({key:l,code:Zt[3][n]}))]}class us{constructor(e){return this.rows=[[],[],[],[]],this.opts={hotkeydRows:"middle-row",layout:{code:"en",name:"English",imported:yn(En)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=Ma(e),this}setRows(e){return this.rows=e,this}setRowHotkeys(e,t){}setNotes(e){if(this.opts.hotkeydRows==="middle-row")Vt(this.rows[1],e,!1),Vt(this.rows[2],e,!0);else{Vt(this.rows[2],e,!1);const t=Vt(this.rows[3],e,!0);Vt(this.rows[0],e,!1,t),Vt(this.rows[1],e,!0,t+1)}}static createWithRows(e,t){return new us(e).setRows(t)}}function Tl(s,e,t){const l=s.slice();return l[15]=e[t].key,l[16]=e[t].value,l[17]=e[t].icon,l[19]=t,l}const Ua=s=>({}),Il=s=>({}),Ra=s=>({}),Al=s=>({});function Sl(s){let e,t,l,n,r,a,o,i,c,d,u;const _=s[12].header,g=Ns(_,s,s[11],Il);let p=fe(s[0]),v=[];for(let y=0;y<p.length;y+=1)v[y]=Nl(Tl(s,p,y));const L=y=>J(v[y],1,1,()=>{v[y]=null});return{c(){e=b("button"),l=V(),n=b("ul"),r=b("li"),g&&g.c(),a=V();for(let y=0;y<v.length;y+=1)v[y].c();this.h()},l(y){e=k(y,"BUTTON",{class:!0,tabindex:!0}),T(e).forEach(m),l=O(y),n=k(y,"UL",{class:!0});var E=T(n);r=k(E,"LI",{});var A=T(r);g&&g.l(A),A.forEach(m),a=O(E);for(let C=0;C<v.length;C+=1)v[C].l(E);E.forEach(m),this.h()},h(){h(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),h(e,"tabindex","-1"),h(n,"class",o=Te(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(y,E){M(y,e,E),M(y,l,E),M(y,n,E),f(n,r),g&&g.m(r,null),f(n,a);for(let A=0;A<v.length;A+=1)v[A]&&v[A].m(n,null);c=!0,d||(u=q(e,"click",s[7]),d=!0)},p(y,E){if(s=y,g&&g.p&&(!c||E&2048)&&Ls(g,_,s,s[11],c?Ps(_,s[11],E,Ua):Ds(s[11]),Il),E&265){p=fe(s[0]);let A;for(A=0;A<p.length;A+=1){const C=Tl(s,p,A);v[A]?(v[A].p(C,E),x(v[A],1)):(v[A]=Nl(C),v[A].c(),x(v[A],1),v[A].m(n,null))}for(He(),A=p.length;A<v.length;A+=1)L(A);ze()}(!c||E&4&&o!==(o=Te(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&h(n,"class",o)},i(y){if(!c){y&&ss(()=>{c&&(t||(t=Et(e,ls,{duration:es},!0)),t.run(1))}),x(g,y);for(let E=0;E<p.length;E+=1)x(v[E]);y&&ss(()=>{c&&(i||(i=Et(n,ns,{duration:es},!0)),i.run(1))}),c=!0}},o(y){y&&(t||(t=Et(e,ls,{duration:es},!1)),t.run(0)),J(g,y),v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)J(v[E]);y&&(i||(i=Et(n,ns,{duration:es},!1)),i.run(0)),c=!1},d(y){y&&(m(e),m(l),m(n)),y&&t&&t.end(),g&&g.d(y),Ve(v,y),y&&i&&i.end(),d=!1,u()}}}function Ka(s){let e;return{c(){e=b("div"),this.h()},l(t){e=k(t,"DIV",{class:!0}),T(e).forEach(m),this.h()},h(){h(e,"class","w-[24px]")},m(t,l){M(t,e,l)},p:ve,i:ve,o:ve,d(t){t&&m(e)}}}function Fa(s){let e,t;return e=new Qe({props:{class:"mr-2",icon:s[17],width:16}}),{c(){ye(e.$$.fragment)},l(l){Ee(e.$$.fragment,l)},m(l,n){we(e,l,n),t=!0},p(l,n){const r={};n&1&&(r.icon=l[17]),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){J(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function Nl(s){let e,t,l,n,r,a,o=s[16]+"",i,c,d,u,_;const g=[Fa,Ka],p=[];function v(y,E){return y[17]?0:1}l=v(s),n=p[l]=g[l](s);function L(){return s[13](s[15])}return{c(){e=b("li"),t=b("button"),n.c(),r=V(),a=b("div"),i=Z(o),c=V(),this.h()},l(y){e=k(y,"LI",{});var E=T(e);t=k(E,"BUTTON",{class:!0});var A=T(t);n.l(A),r=O(A),a=k(A,"DIV",{});var C=T(a);i=ee(C,o),C.forEach(m),A.forEach(m),c=O(E),E.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),$(t,"selected",s[15]===s[3])},m(y,E){M(y,e,E),f(e,t),p[l].m(t,null),f(t,r),f(t,a),f(a,i),f(e,c),d=!0,u||(_=q(t,"click",L),u=!0)},p(y,E){s=y;let A=l;l=v(s),l===A?p[l].p(s,E):(He(),J(p[A],1,1,()=>{p[A]=null}),ze(),n=p[l],n?n.p(s,E):(n=p[l]=g[l](s),n.c()),x(n,1),n.m(t,r)),(!d||E&1)&&o!==(o=s[16]+"")&&he(i,o),(!d||E&9)&&$(t,"selected",s[15]===s[3])},i(y){d||(x(n),d=!0)},o(y){J(n),d=!1},d(y){y&&m(e),p[l].d(),u=!1,_()}}}function xa(s){let e,t,l,n,r,a,o,i,c;const d=s[12].value,u=Ns(d,s,s[11],Al);let _=s[6]&&Sl(s);return{c(){e=b("div"),t=b("button"),u&&u.c(),r=V(),_&&_.c(),this.h()},l(g){e=k(g,"DIV",{class:!0,id:!0});var p=T(e);t=k(p,"BUTTON",{class:!0,title:!0});var v=T(t);u&&u.l(v),v.forEach(m),r=O(p),_&&_.l(p),p.forEach(m),this.h()},h(){h(t,"class",l=Te(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),h(t,"title",n=s[9].title||""),$(t,"disabled",s[4]),$(t,"open",s[6]),h(e,"class",a=Te(`relative ${s[2]||""}`)+" svelte-h65upg"),h(e,"id",s[1])},m(g,p){M(g,e,p),f(e,t),u&&u.m(t,null),f(e,r),_&&_.m(e,null),s[14](e),o=!0,i||(c=q(t,"click",s[7]),i=!0)},p(g,[p]){u&&u.p&&(!o||p&2048)&&Ls(u,d,g,g[11],o?Ps(d,g[11],p,Ra):Ds(g[11]),Al),(!o||p&512&&l!==(l=Te(`${g[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&h(t,"class",l),(!o||p&512&&n!==(n=g[9].title||""))&&h(t,"title",n),(!o||p&528)&&$(t,"disabled",g[4]),(!o||p&576)&&$(t,"open",g[6]),g[6]?_?(_.p(g,p),p&64&&x(_,1)):(_=Sl(g),_.c(),x(_,1),_.m(e,null)):_&&(He(),J(_,1,1,()=>{_=null}),ze()),(!o||p&4&&a!==(a=Te(`relative ${g[2]||""}`)+" svelte-h65upg"))&&h(e,"class",a),(!o||p&2)&&h(e,"id",g[1])},i(g){o||(x(u,g),x(_),o=!0)},o(g){J(u,g),J(_),o=!1},d(g){g&&m(e),u&&u.d(g),_&&_.d(),s[14](null),i=!1,c()}}}const es=400;function Ha(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:r,id:a=void 0,containerClass:o=void 0,selected:i=void 0,disabled:c=void 0,onSelect:d}=e,u,_=!1;function g(){c||t(6,_=!_)}function p(y){t(6,_=d(y))}const v=y=>p(y);function L(y){Vs[y?"unshift":"push"](()=>{u=y,t(5,u)})}return s.$$set=y=>{t(9,e=Ae(Ae({},e),Se(y))),"options"in y&&t(0,r=y.options),"id"in y&&t(1,a=y.id),"containerClass"in y&&t(2,o=y.containerClass),"selected"in y&&t(3,i=y.selected),"disabled"in y&&t(4,c=y.disabled),"onSelect"in y&&t(10,d=y.onSelect),"$$scope"in y&&t(11,n=y.$$scope)},e=Se(e),[r,a,o,i,c,u,_,g,p,e,d,n,l,v,L]}class za extends We{constructor(e){super(),qe(this,e,Ha,xa,Je,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function Wa(s){let e,t,l,n,r,a,o;return{c(){e=b("label"),t=b("input"),l=V(),n=b("div"),this.h()},l(i){e=k(i,"LABEL",{class:!0});var c=T(e);t=k(c,"INPUT",{type:!0,class:!0}),l=O(c),n=k(c,"DIV",{class:!0}),T(n).forEach(m),c.forEach(m),this.h()},h(){t.checked=s[0],h(t,"type","checkbox"),h(t,"class","svelte-k5zciy"),h(n,"class","slider svelte-k5zciy"),h(e,"class",r=Te(`${s[3].class||""} toggle`)+" svelte-k5zciy")},m(i,c){M(i,e,c),f(e,t),s[5](t),f(e,l),f(e,n),a||(o=[q(t,"change",s[4]),q(t,"keydown",s[2])],a=!0)},p(i,[c]){c&1&&(t.checked=i[0]),c&8&&r!==(r=Te(`${i[3].class||""} toggle`)+" svelte-k5zciy")&&h(e,"class",r)},i:ve,o:ve,d(i){i&&m(e),s[5](null),a=!1,Ye(o)}}}function qa(s,e,t){let{checked:l}=e,n;function r(i){i.key==="Enter"&&n.click()}function a(i){fs.call(this,s,i)}function o(i){Vs[i?"unshift":"push"](()=>{n=i,t(1,n)})}return s.$$set=i=>{t(3,e=Ae(Ae({},e),Se(i))),"checked"in i&&t(0,l=i.checked)},e=Se(e),[l,n,r,e,a,o]}class Ja extends We{constructor(e){super(),qe(this,e,qa,Wa,Je,{checked:0})}}function Ll(s){let e;return{c(){e=b("li"),this.h()},l(t){e=k(t,"LI",{class:!0}),T(e).forEach(m),this.h()},h(){h(e,"class","m-[0.175rem] mr-0")},m(t,l){M(t,e,l)},d(t){t&&m(e)}}}function Dl(s){let e;return{c(){e=b("div"),this.h()},l(t){e=k(t,"DIV",{class:!0}),T(e).forEach(m),this.h()},h(){h(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,l){M(t,e,l)},d(t){t&&m(e)}}}function Pl(s){let e,t=s[0].note.note+"",l,n;return{c(){e=b("div"),l=Z(t),n=Z(s[2]),this.h()},l(r){e=k(r,"DIV",{class:!0});var a=T(e);l=ee(a,t),n=ee(a,s[2]),a.forEach(m),this.h()},h(){h(e,"class","absolute top-0 left-0")},m(r,a){M(r,e,a),f(e,l),f(e,n)},p(r,a){a&1&&t!==(t=r[0].note.note+"")&&he(l,t),a&4&&he(n,r[2])},d(r){r&&m(e)}}}function $a(s){let e,t,l,n,r,a,o=Ol(s[0].key)+"",i,c,d,u,_=s[0].key==="{enter}"&&Ll(),g=s[0].key==="{enter}"&&Dl(),p=s[0].note&&Pl(s);return{c(){_&&_.c(),e=V(),t=b("li"),l=b("button"),g&&g.c(),n=V(),p&&p.c(),r=V(),a=b("div"),i=Z(o),this.h()},l(v){_&&_.l(v),e=O(v),t=k(v,"LI",{class:!0});var L=T(t);l=k(L,"BUTTON",{class:!0});var y=T(l);g&&g.l(y),n=O(y),p&&p.l(y),r=O(y),a=k(y,"DIV",{});var E=T(a);i=ee(E,o),E.forEach(m),y.forEach(m),L.forEach(m),this.h()},h(){h(l,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),$(l,"items-center",!s[0].note),$(l,"items-end",s[0].note),h(t,"class",c=Te(`${s[3].class||""} m-[0.175rem] ${Vl(s[0].size)}`)+" svelte-1479mcy"),$(t,"enter",s[0].key==="{enter}"),$(t,"captured",s[1])},m(v,L){_&&_.m(v,L),M(v,e,L),M(v,t,L),f(t,l),g&&g.m(l,null),f(l,n),p&&p.m(l,null),f(l,r),f(l,a),f(a,i),d||(u=q(l,"click",s[5]),d=!0)},p(v,[L]){v[0].key==="{enter}"?_||(_=Ll(),_.c(),_.m(e.parentNode,e)):_&&(_.d(1),_=null),v[0].key==="{enter}"?g||(g=Dl(),g.c(),g.m(l,n)):g&&(g.d(1),g=null),v[0].note?p?p.p(v,L):(p=Pl(v),p.c(),p.m(l,r)):p&&(p.d(1),p=null),L&1&&o!==(o=Ol(v[0].key)+"")&&he(i,o),L&1&&$(l,"items-center",!v[0].note),L&1&&$(l,"items-end",v[0].note),L&9&&c!==(c=Te(`${v[3].class||""} m-[0.175rem] ${Vl(v[0].size)}`)+" svelte-1479mcy")&&h(t,"class",c),L&9&&$(t,"enter",v[0].key==="{enter}"),L&11&&$(t,"captured",v[1])},i:ve,o:ve,d(v){v&&(m(e),m(t)),_&&_.d(v),g&&g.d(),p&&p.d(),d=!1,u()}}}function Vl(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function Ol(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function Qa(s,e,t){let l,n;_e(s,hs,i=>t(4,n=i));let{value:r,captured:a}=e;function o(i){fs.call(this,s,i)}return s.$$set=i=>{t(3,e=Ae(Ae({},e),Se(i))),"value"in i&&t(0,r=i.value),"captured"in i&&t(1,a=i.captured)},s.$$.update=()=>{s.$$.dirty&17&&t(2,l=r.note?is({midi:r.note.semitones+n[0],flats:0,sharps:0}):0)},e=Se(e),[r,a,l,e,n,o]}class Ya extends We{constructor(e){super(),qe(this,e,Qa,$a,Je,{value:0,captured:1})}}function Xa(s,e,t){return e==="Escape"?{e:"hotkeys-cancel"}:e==="Space"?{e:"hotkeys-captured-key",data:{code:"EMPTY",key:"{empty}"}}:s.has(e)?{e:"hotkeys-no-key"}:(s.add(e),{e:"hotkeys-captured-key",data:{code:e,key:t}})}const Gs=/^[a-gA-G]$/,wn=/^[♭Bb#♯sS]$/,Za=/^[0-9]$/;let X="",xe;function er(s,e){const{useHotkeys:t}=Ie(at),l=Ie(Us).get(s);if(t&&X.length===0&&l&&l.note)return X="",{e:"guessed-key",data:l.note.note};if(!t&&X.length===0&&Gs.test(e))return X+=e.toUpperCase(),{e:"string",data:X};if(!t&&X.length>0&&wn.test(e))return e==="b"||e==="B"?X+="♭":X+="♯",{e:"string",data:X};if(s==="Backspace"&&X.length>0)return X=X.slice(0,-1),{e:"string",data:X};if(s==="Enter"&&X.length>0){const n=X;return X="",{e:"guessed-key",data:n}}return!1}function tr(s,e){if(s==="Enter"&&X.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let l=0;l<X.length;l+=1)l===0?t.note+=X[l]:t.chord.length>0?t.chord+=X[l].toLowerCase():X[l]==="♭"?(t.note+=X[l],t.flats+=1):X[l]==="♯"?(t.note+=X[l],t.sharps+=1):t.chord+=X[l].toLowerCase();return X="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&X.length>0)return X=X.slice(0,-1),{e:"string",data:X};if(X.length===0&&Gs.test(e))return X+=e.toUpperCase(),{e:"string",data:X};if(X.length>0&&e.length===1)return X.length===1&&(e==="b"||e==="B")?X+="♭":X.length===1&&e==="#"?X+="♯":X+=e,{e:"string",data:X}}return!1}function sr(s,e,t){const{useAutoOctave:l,useHotkeys:n}=Ie(at);let r;const o=Ie(Us).get(s),i=(o==null?void 0:o.key)||"";let c=!1;if(!xe&&n&&(o!=null&&o.note)?(xe=o.note,l&&(r=is({midi:Ie(Bt)[0].midi,flats:0,sharps:0})),c="note"):!n&&X.length===0&&Gs.test(e)?(X+=e.toUpperCase(),c="input"):!n&&X.length>0&&wn.test(e)?(e==="b"||e==="B"?X+="♭":X+="♯",c="input"):!n&&X.length>0&&s==="Enter"&&l&&(r=is({midi:Ie(Bt)[0].midi,flats:0,sharps:0}),c="octave"),!c&&Za.test(i))try{r=parseInt(i),c="octave"}catch{}if(c&&(xe||X)&&r!==void 0){const d=(xe==null?void 0:xe.note)??X;return!xe&&t?r+=1:xe&&(xe==null?void 0:xe.semitones)>=12&&(r+=Math.floor(xe.semitones/12)),xe=void 0,X="",{e:"guessed-note",data:{note:d,octave:r}}}else if(s==="Backspace"&&(xe||X.length>0))return xe=void 0,X=X.slice(0,-1),{e:"string",data:X};return c==="note"?{e:"note",data:xe}:c==="input"?{e:"string",data:X}:!1}const Cn={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Es=new Set,Ct=Ge(void 0);It(Ct,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const ut=_t(Ge({useCustom:!1,customLayout:[[],[],[],[]],kbdOpts:{layout:Cn,hotkeydRows:"middle-row"}}),{key:"keyboard-settings"}),Ms=It([Gt,ut],([s,e])=>{let t;return e.useCustom&&e.customLayout?t=us.createWithRows(e.kbdOpts,e.customLayout):t=new us(e.kbdOpts),t.setNotes(Array.from(s.notesMap.values())),t}),lr=It(Ms,s=>s.rows.map(e=>e.map((t,l)=>{let n;return t.key==="{bksp}"?n=2:t.key==="{tab}"?n=1.5:t.key==="{enter}"?n=2:t.key==="{lock}"?n=1.75:t.key==="{shift}"&&l===0?n=1.5:t.key==="{shift}"&&(n=2.5),n?{...t,size:n}:t}))),Us=It(Ms,s=>new Map([...s.rows[0].map(e=>[e.code,e]),...s.rows[1].map(e=>[e.code,e]),...s.rows[2].map(e=>[e.code,e]),...s.rows[3].map(e=>[e.code,e])])),nr=It(Us,s=>Array.from(s.values()).map(e=>e.note).filter(e=>e!==void 0).sort((e,t)=>e.semitones-t.semitones)),ft={async setLayout(s){const e=await Ba(s);ut.update(t=>({...t,kbdOpts:{...t.kbdOpts,layout:e}}))},setCustomLayout(s){if(s){const e=Ie(Ms);ut.update(t=>({...t,useCustom:s,customLayout:t.customLayout.map((l,n)=>l.length===0?e.rows[n].map(r=>({...r})):l)}))}else ut.update(e=>({...e,useCustom:s}))},toggleRows(s){ut.update(e=>({...e,kbdOpts:{...e.kbdOpts,hotkeydRows:s??(e.kbdOpts.hotkeydRows==="middle-row"?"two-rows":"middle-row")}}))},captureHotkeyRow(s){let e=-1,t=0;const l=Ie(ut).customLayout[s].map((n,r)=>{const a=n.key.charAt(0)==="{"&&n.key!=="{empty}";return!a&&e===-1&&(e=r),t+=a?0:1,n});console.log("count",t),Ct.set({row:l,nextIndex:e,rowIndex:s,count:t})},findNote(s){return Ie(nr).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((l,n)=>l+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleHotkeyInput(s,e,t){const l=Xa(Es,e,t);if(l.e==="hotkeys-cancel")Ct.set(void 0),Es.clear();else if(l.e==="hotkeys-captured-key"){const n=s.row.map((r,a)=>a===s.nextIndex?l.data:r);s.nextIndex===s.count?(ut.update(r=>({...r,customLayout:r.customLayout.map((a,o)=>o!==s.rowIndex?a:n)})),Ct.set(void 0),Es.clear()):n&&Ct.set({...s,nextIndex:s.nextIndex+1,row:n})}return l},handleInput(s,e,t=!1){const l=Ie(wt),n=Ie(Ct);return n?this.handleHotkeyInput(n,s,e):l instanceof Rt?er(s,e.toUpperCase()):l instanceof ht&&l.type==="chords-write"?tr(s,e):Ie(at).useKeyboard?sr(s,e.toUpperCase(),t):!1},reset(){ut.set({useCustom:!1,customLayout:[[],[],[],[]],kbdOpts:{layout:Cn,hotkeydRows:"middle-row"}})}};function jl(s,e,t){const l=s.slice();return l[13]=e[t],l[15]=t,l}function Bl(s,e,t){const l=s.slice();return l[16]=e[t],l[18]=t,l}function ar(s){let e,t=s[0].kbdOpts.layout.name+"",l;return{c(){e=b("div"),l=Z(t),this.h()},l(n){e=k(n,"DIV",{slot:!0});var r=T(e);l=ee(r,t),r.forEach(m),this.h()},h(){h(e,"slot","value")},m(n,r){M(n,e,r),f(e,l)},p(n,r){r&1&&t!==(t=n[0].kbdOpts.layout.name+"")&&he(l,t)},d(n){n&&m(e)}}}function Gl(s){let e,t,l,n,r;t=new Qe({props:{icon:On,width:20}});function a(){return s[12](s[15])}return{c(){e=b("button"),ye(t.$$.fragment),this.h()},l(o){e=k(o,"BUTTON",{class:!0});var i=T(e);Ee(t.$$.fragment,i),i.forEach(m),this.h()},h(){h(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(o,i){M(o,e,i),we(t,e,null),l=!0,n||(r=q(e,"click",a),n=!0)},p(o,i){s=o},i(o){l||(x(t.$$.fragment,o),l=!0)},o(o){J(t.$$.fragment,o),l=!1},d(o){o&&m(e),Ce(t),n=!1,r()}}}function Ml(s){let e,t;return e=new Ya({props:{value:s[16],captured:s[4]&&s[4].rowIndex===s[15]&&s[4].nextIndex===s[18]||!1}}),{c(){ye(e.$$.fragment)},l(l){Ee(e.$$.fragment,l)},m(l,n){we(e,l,n),t=!0},p(l,n){const r={};n&2&&(r.value=l[16]),n&16&&(r.captured=l[4]&&l[4].rowIndex===l[15]&&l[4].nextIndex===l[18]||!1),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){J(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function Ul(s){let e,t,l,n,r=s[3][s[15]]&&Gl(s),a=fe(s[13]),o=[];for(let c=0;c<a.length;c+=1)o[c]=Ml(Bl(s,a,c));const i=c=>J(o[c],1,1,()=>{o[c]=null});return{c(){e=b("li"),r&&r.c(),t=V();for(let c=0;c<o.length;c+=1)o[c].c();l=Pe(),this.h()},l(c){e=k(c,"LI",{class:!0});var d=T(e);r&&r.l(d),d.forEach(m),t=O(c);for(let u=0;u<o.length;u+=1)o[u].l(c);l=Pe(),this.h()},h(){h(e,"class","col-span-2 svelte-1av9wwd")},m(c,d){M(c,e,d),r&&r.m(e,null),M(c,t,d);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(c,d);M(c,l,d),n=!0},p(c,d){if(c[3][c[15]]?r?(r.p(c,d),d&8&&x(r,1)):(r=Gl(c),r.c(),x(r,1),r.m(e,null)):r&&(He(),J(r,1,1,()=>{r=null}),ze()),d&18){a=fe(c[13]);let u;for(u=0;u<a.length;u+=1){const _=Bl(c,a,u);o[u]?(o[u].p(_,d),x(o[u],1)):(o[u]=Ml(_),o[u].c(),x(o[u],1),o[u].m(l.parentNode,l))}for(He(),u=a.length;u<o.length;u+=1)i(u);ze()}},i(c){if(!n){x(r);for(let d=0;d<a.length;d+=1)x(o[d]);n=!0}},o(c){J(r),o=o.filter(Boolean);for(let d=0;d<o.length;d+=1)J(o[d]);n=!1},d(c){c&&(m(e),m(t),m(l)),r&&r.d(),Ve(o,c)}}}function rr(s){let e,t,l,n,r,a="Layout",o,i,c,d,u,_="Custom",g,p,v,L,y,E,A="One row",C,U,P,B,j="Two rows",I,D,S,w,N,R,K,F,ne,me,Q;i=new za({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1 w-36",options:s[5],onSelect:s[7],$$slots:{value:[ar]},$$scope:{ctx:s}}}),U=new Ja({props:{checked:!s[2]}}),U.$on("change",s[10]),w=new Qe({props:{icon:Kt,width:16}});let W=fe(s[1]),G=[];for(let H=0;H<W.length;H+=1)G[H]=Ul(jl(s,W,H));const se=H=>J(G[H],1,1,()=>{G[H]=null});return{c(){e=b("div"),t=b("div"),l=b("div"),n=b("div"),r=b("label"),r.textContent=a,o=V(),ye(i.$$.fragment),c=V(),d=b("div"),u=b("label"),u.textContent=_,g=V(),p=b("input"),L=V(),y=b("div"),E=b("label"),E.textContent=A,C=V(),ye(U.$$.fragment),P=V(),B=b("label"),B.textContent=j,I=V(),D=b("div"),S=b("button"),ye(w.$$.fragment),N=V(),R=b("div"),K=b("ul");for(let H=0;H<G.length;H+=1)G[H].c();this.h()},l(H){e=k(H,"DIV",{class:!0});var te=T(e);t=k(te,"DIV",{class:!0});var ie=T(t);l=k(ie,"DIV",{class:!0});var be=T(l);n=k(be,"DIV",{class:!0});var ae=T(n);r=k(ae,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(r)!=="svelte-1xsr9lq"&&(r.textContent=a),o=O(ae),Ee(i.$$.fragment,ae),ae.forEach(m),c=O(be),d=k(be,"DIV",{class:!0});var de=T(d);u=k(de,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(u)!=="svelte-11aw8ub"&&(u.textContent=_),g=O(de),p=k(de,"INPUT",{class:!0,id:!0,type:!0}),de.forEach(m),L=O(be),y=k(be,"DIV",{class:!0});var Y=T(y);E=k(Y,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(E)!=="svelte-17p0yvw"&&(E.textContent=A),C=O(Y),Ee(U.$$.fragment,Y),P=O(Y),B=k(Y,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(B)!=="svelte-1wr3nwv"&&(B.textContent=j),Y.forEach(m),be.forEach(m),I=O(ie),D=k(ie,"DIV",{class:!0});var ce=T(D);S=k(ce,"BUTTON",{class:!0});var ge=T(S);Ee(w.$$.fragment,ge),ge.forEach(m),ce.forEach(m),ie.forEach(m),N=O(te),R=k(te,"DIV",{class:!0});var ue=T(R);K=k(ue,"UL",{class:!0});var Ke=T(K);for(let z=0;z<G.length;z+=1)G[z].l(Ke);Ke.forEach(m),ue.forEach(m),te.forEach(m),this.h()},h(){h(r,"class","font-bold mr-4"),h(r,"for","middle-row"),h(n,"class","my-1 flex items-center justify-between mr-2"),h(u,"class","font-bold mr-4"),h(u,"for","custom-layout"),h(p,"class","h-[20px]"),h(p,"id","custom-layout"),h(p,"type","checkbox"),p.checked=v=s[0].useCustom,h(d,"class","my-1 flex items-center"),h(E,"class","font-bold mr-4"),h(E,"for","two-rows"),h(B,"class","font-bold ml-4"),h(B,"for","two-rows"),h(y,"class","my-1 flex items-center"),h(l,"class","options svelte-1av9wwd"),h(S,"class","rounded px-1 py-1 hover:bg-gray-200"),h(D,"class","flex items-center justify-center"),h(t,"class","flex justify-between"),h(K,"class","keyboard svelte-1av9wwd"),h(R,"class","flex flex-col"),h(e,"class",F=Te(`${s[11].class||""} relative`)+" svelte-1av9wwd")},m(H,te){M(H,e,te),f(e,t),f(t,l),f(l,n),f(n,r),f(n,o),we(i,n,null),f(l,c),f(l,d),f(d,u),f(d,g),f(d,p),f(l,L),f(l,y),f(y,E),f(y,C),we(U,y,null),f(y,P),f(y,B),f(t,I),f(t,D),f(D,S),we(w,S,null),f(e,N),f(e,R),f(R,K);for(let ie=0;ie<G.length;ie+=1)G[ie]&&G[ie].m(K,null);ne=!0,me||(Q=[q(p,"change",s[8]),q(S,"click",s[6])],me=!0)},p(H,[te]){const ie={};te&524289&&(ie.$$scope={dirty:te,ctx:H}),i.$set(ie),(!ne||te&1&&v!==(v=H[0].useCustom))&&(p.checked=v);const be={};if(te&4&&(be.checked=!H[2]),U.$set(be),te&538){W=fe(H[1]);let ae;for(ae=0;ae<W.length;ae+=1){const de=jl(H,W,ae);G[ae]?(G[ae].p(de,te),x(G[ae],1)):(G[ae]=Ul(de),G[ae].c(),x(G[ae],1),G[ae].m(K,null))}for(He(),ae=W.length;ae<G.length;ae+=1)se(ae);ze()}(!ne||te&2048&&F!==(F=Te(`${H[11].class||""} relative`)+" svelte-1av9wwd"))&&h(e,"class",F)},i(H){if(!ne){x(i.$$.fragment,H),x(U.$$.fragment,H),x(w.$$.fragment,H);for(let te=0;te<W.length;te+=1)x(G[te]);ne=!0}},o(H){J(i.$$.fragment,H),J(U.$$.fragment,H),J(w.$$.fragment,H),G=G.filter(Boolean);for(let te=0;te<G.length;te+=1)J(G[te]);ne=!1},d(H){H&&m(e),Ce(i),Ce(U),Ce(w),Ve(G,H),me=!1,Ye(Q)}}}function or(s,e,t){let l,n,r,a,o;_e(s,ut,v=>t(0,r=v)),_e(s,lr,v=>t(1,a=v)),_e(s,Ct,v=>t(4,o=v)),mn(()=>{ft.setLayout(navigator.languages)});const i=Object.entries(As).map(([v,L])=>({key:v,value:L.name}));function c(){ft.reset(),ft.setLayout(navigator.languages)}function d(v){return ft.setLayout([v]),!1}function u(v){ft.setCustomLayout(v.currentTarget.checked)}function _(v){ft.captureHotkeyRow(v)}function g(){ft.toggleRows()}const p=v=>_(v);return s.$$set=v=>{t(11,e=Ae(Ae({},e),Se(v)))},s.$$.update=()=>{s.$$.dirty&3&&t(3,l=a.map((v,L)=>r.kbdOpts.hotkeydRows==="middle-row"?L===1||L===2:!0)),s.$$.dirty&1&&t(2,n=r.kbdOpts.hotkeydRows==="middle-row")},e=Se(e),[r,a,n,l,o,i,c,d,u,_,g,e,p]}class ir extends We{constructor(e){super(),qe(this,e,or,rr,Je,{})}}function Rl(s){let e,t;return e=new ir({props:{class:"mt-4"}}),{c(){ye(e.$$.fragment)},l(l){Ee(e.$$.fragment,l)},m(l,n){we(e,l,n),t=!0},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){J(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function cr(s){let e,t,l,n,r="I/O",a,o,i,c,d,u,_,g,p="Device",v,L,y,E,A,C,U="Prompt",P,B,j="Disable",I,D,S,w,N="Sound",R,K,F,ne,me,Q,W="Fixed velocity",G,se,H,te,ie,be,ae="Keyboard",de,Y,ce,ge,ue,Ke,z="Hotkeys",oe,pe,tt,le,Oe,Me,pt="Auto-octave",At,Fe,Ue,St,st,$e,Rs=" ",ms,Nt,gt,Ks="Set hotkeys",_s,vt,bt,Fs="Fade timeout",ps,ct,gs,Ft,Xe,vs,xs;c=new Qe({props:{icon:Kt,width:16}});let Be=s[2]&&!s[4]&&Rl();return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,a=V(),o=b("div"),i=b("button"),ye(c.$$.fragment),d=V(),u=b("div"),_=b("div"),g=b("label"),g.textContent=p,v=V(),L=b("input"),E=V(),A=b("div"),C=b("button"),C.textContent=U,P=V(),B=b("button"),B.textContent=j,I=V(),D=b("div"),S=b("div"),w=b("label"),w.textContent=N,R=V(),K=b("input"),ne=V(),me=b("div"),Q=b("label"),Q.textContent=W,G=V(),se=b("input"),H=V(),te=b("div"),ie=b("div"),be=b("label"),be.textContent=ae,de=V(),Y=b("input"),ge=V(),ue=b("div"),Ke=b("label"),Ke.textContent=z,oe=V(),pe=b("input"),le=V(),Oe=b("div"),Me=b("label"),Me.textContent=pt,At=V(),Fe=b("input"),St=V(),st=b("div"),$e=b("div"),$e.textContent=Rs,ms=V(),Nt=b("div"),gt=b("button"),gt.textContent=Ks,_s=V(),vt=b("div"),bt=b("label"),bt.textContent=Fs,ps=V(),ct=b("input"),gs=V(),Be&&Be.c(),this.h()},l(Ne){e=k(Ne,"DIV",{class:!0});var Re=T(e);t=k(Re,"FIELDSET",{class:!0});var rt=T(t);l=k(rt,"LEGEND",{class:!0});var Hs=T(l);n=k(Hs,"BUTTON",{class:!0,"data-svelte-h":!0}),re(n)!=="svelte-1jbbsti"&&(n.textContent=r),Hs.forEach(m),a=O(rt),o=k(rt,"DIV",{class:!0});var zs=T(o);i=k(zs,"BUTTON",{class:!0});var Ws=T(i);Ee(c.$$.fragment,Ws),Ws.forEach(m),zs.forEach(m),d=O(rt),u=k(rt,"DIV",{class:!0});var kt=T(u);_=k(kt,"DIV",{class:!0});var Lt=T(_);g=k(Lt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(g)!=="svelte-crpa7y"&&(g.textContent=p),v=O(Lt),L=k(Lt,"INPUT",{class:!0,id:!0}),E=O(Lt),A=k(Lt,"DIV",{class:!0});var xt=T(A);C=k(xt,"BUTTON",{class:!0,"data-svelte-h":!0}),re(C)!=="svelte-mj6mct"&&(C.textContent=U),P=O(xt),B=k(xt,"BUTTON",{class:!0,"data-svelte-h":!0}),re(B)!=="svelte-1sl6oxh"&&(B.textContent=j),xt.forEach(m),Lt.forEach(m),I=O(kt),D=k(kt,"DIV",{class:!0});var Ht=T(D);S=k(Ht,"DIV",{class:!0});var zt=T(S);w=k(zt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(w)!=="svelte-wgxtkw"&&(w.textContent=N),R=O(zt),K=k(zt,"INPUT",{class:!0,id:!0,type:!0}),zt.forEach(m),ne=O(Ht),me=k(Ht,"DIV",{class:!0});var Wt=T(me);Q=k(Wt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(Q)!=="svelte-1tm2bth"&&(Q.textContent=W),G=O(Wt),se=k(Wt,"INPUT",{class:!0,id:!0,placeholder:!0}),Wt.forEach(m),Ht.forEach(m),H=O(kt),te=k(kt,"DIV",{class:!0});var Dt=T(te);ie=k(Dt,"DIV",{class:!0});var qt=T(ie);be=k(qt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(be)!=="svelte-1js269u"&&(be.textContent=ae),de=O(qt),Y=k(qt,"INPUT",{class:!0,id:!0,type:!0}),qt.forEach(m),ge=O(Dt),ue=k(Dt,"DIV",{class:!0});var Jt=T(ue);Ke=k(Jt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(Ke)!=="svelte-21h39k"&&(Ke.textContent=z),oe=O(Jt),pe=k(Jt,"INPUT",{class:!0,id:!0,type:!0}),Jt.forEach(m),le=O(Dt),Oe=k(Dt,"DIV",{class:!0});var $t=T(Oe);Me=k($t,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(Me)!=="svelte-33lczu"&&(Me.textContent=pt),At=O($t),Fe=k($t,"INPUT",{class:!0,id:!0,type:!0}),$t.forEach(m),Dt.forEach(m),St=O(kt),st=k(kt,"DIV",{class:!0});var Pt=T(st);$e=k(Pt,"DIV",{class:!0,"data-svelte-h":!0}),re($e)!=="svelte-dgefms"&&($e.textContent=Rs),ms=O(Pt),Nt=k(Pt,"DIV",{class:!0});var qs=T(Nt);gt=k(qs,"BUTTON",{class:!0,"data-svelte-h":!0}),re(gt)!=="svelte-1v9okg9"&&(gt.textContent=Ks),qs.forEach(m),_s=O(Pt),vt=k(Pt,"DIV",{class:!0});var Qt=T(vt);bt=k(Qt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(bt)!=="svelte-vd5i27"&&(bt.textContent=Fs),ps=O(Qt),ct=k(Qt,"INPUT",{class:!0,id:!0}),Qt.forEach(m),Pt.forEach(m),kt.forEach(m),gs=O(rt),Be&&Be.l(rt),rt.forEach(m),Re.forEach(m),this.h()},h(){var Ne;h(n,"class","px-1 rounded hover:bg-gray-100"),h(l,"class","text-base"),h(i,"class","rounded px-1 py-1 hover:bg-gray-200"),h(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center"),$(o,"hidden",s[4]),h(g,"class","font-bold"),h(g,"for","device"),h(L,"class","px-1 my-1 rounded w-50"),h(L,"id","device"),L.disabled=!0,L.value=y=((Ne=s[5])==null?void 0:Ne.name)??"No device",h(C,"class","btn-sm primary mr-2"),h(B,"class","btn-sm primary"),h(A,"class","flex my-[auto]"),h(_,"class","h-full flex flex-col"),h(w,"class","font-bold"),h(w,"for","sound"),h(K,"class","h-[20px]"),h(K,"id","sound"),h(K,"type","checkbox"),K.checked=F=s[3].useSound,h(S,"class","my-1 flex justify-between mr-12"),h(Q,"class","font-bold"),h(Q,"for","fixed-velocity"),h(se,"class","h-[20px] w-16"),h(se,"id","fixed-velocity"),h(se,"placeholder","0-127"),h(me,"class","flex justify-between"),h(D,"class","flex flex-col h-full"),h(be,"class","font-bold"),h(be,"for","keyboard"),h(Y,"class","h-[20px]"),h(Y,"id","keyboard"),h(Y,"type","checkbox"),Y.checked=ce=s[3].useKeyboard,h(ie,"class","my-1 flex justify-between mr-12"),h(Ke,"class","font-bold"),h(Ke,"for","hotkeys"),h(pe,"class","h-[20px]"),h(pe,"id","hotkeys"),h(pe,"type","checkbox"),pe.checked=tt=s[3].useHotkeys,h(ue,"class","my-1 flex justify-between mr-12"),h(Me,"class","font-bold"),h(Me,"for","auto-octave"),h(Fe,"class","h-[20px]"),h(Fe,"id","auto-octave"),h(Fe,"type","checkbox"),Fe.checked=Ue=s[3].useAutoOctave,h(Oe,"class","my-1 flex justify-between mr-12"),h(te,"class","flex flex-col h-full"),h($e,"class","h-[28px]"),h(gt,"class","w-full btn-sm primary"),h(Nt,"class","my-[2px] flex justify-between"),h(bt,"class","font-bold"),h(bt,"for","fade-timeout"),h(ct,"class","h-[20px] w-16"),h(ct,"id","fade-timeout"),ct.value=s[1],h(vt,"class","my-1 flex justify-between"),h(st,"class","flex flex-col h-full"),h(u,"class","body svelte-1bpw69s"),$(u,"hidden",s[4]),h(t,"class","relative flex flex-col max-w-full rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),$(t,"collapsed",s[4]),h(e,"class",Ft=Te(`${s[11].class||""}`)+" svelte-1bpw69s")},m(Ne,Re){M(Ne,e,Re),f(e,t),f(t,l),f(l,n),f(t,a),f(t,o),f(o,i),we(c,i,null),f(t,d),f(t,u),f(u,_),f(_,g),f(_,v),f(_,L),f(_,E),f(_,A),f(A,C),f(A,P),f(A,B),f(u,I),f(u,D),f(D,S),f(S,w),f(S,R),f(S,K),f(D,ne),f(D,me),f(me,Q),f(me,G),f(me,se),et(se,s[0]),f(u,H),f(u,te),f(te,ie),f(ie,be),f(ie,de),f(ie,Y),f(te,ge),f(te,ue),f(ue,Ke),f(ue,oe),f(ue,pe),f(te,le),f(te,Oe),f(Oe,Me),f(Oe,At),f(Oe,Fe),f(u,St),f(u,st),f(st,$e),f(st,ms),f(st,Nt),f(Nt,gt),f(st,_s),f(st,vt),f(vt,bt),f(vt,ps),f(vt,ct),f(t,gs),Be&&Be.m(t,null),Xe=!0,vs||(xs=[q(n,"click",s[7]),q(i,"click",s[10]),q(C,"click",je.openMidi),q(B,"click",je.disableMidi),q(K,"change",s[12]),q(se,"input",s[13]),q(se,"change",s[8]),q(Y,"change",s[14]),q(pe,"change",s[15]),q(Fe,"change",s[16]),q(gt,"click",s[17]),q(ct,"input",s[9])],vs=!0)},p(Ne,[Re]){var rt;(!Xe||Re&16)&&$(o,"hidden",Ne[4]),(!Xe||Re&32&&y!==(y=((rt=Ne[5])==null?void 0:rt.name)??"No device")&&L.value!==y)&&(L.value=y),(!Xe||Re&8&&F!==(F=Ne[3].useSound))&&(K.checked=F),Re&1&&se.value!==Ne[0]&&et(se,Ne[0]),(!Xe||Re&8&&ce!==(ce=Ne[3].useKeyboard))&&(Y.checked=ce),(!Xe||Re&8&&tt!==(tt=Ne[3].useHotkeys))&&(pe.checked=tt),(!Xe||Re&8&&Ue!==(Ue=Ne[3].useAutoOctave))&&(Fe.checked=Ue),(!Xe||Re&2&&ct.value!==Ne[1])&&(ct.value=Ne[1]),(!Xe||Re&16)&&$(u,"hidden",Ne[4]),Ne[2]&&!Ne[4]?Be?Re&20&&x(Be,1):(Be=Rl(),Be.c(),x(Be,1),Be.m(t,null)):Be&&(He(),J(Be,1,1,()=>{Be=null}),ze()),(!Xe||Re&16)&&$(t,"collapsed",Ne[4]),(!Xe||Re&2048&&Ft!==(Ft=Te(`${Ne[11].class||""}`)+" svelte-1bpw69s"))&&h(e,"class",Ft)},i(Ne){Xe||(x(c.$$.fragment,Ne),x(Be),Xe=!0)},o(Ne){J(c.$$.fragment,Ne),J(Be),Xe=!1},d(Ne){Ne&&m(e),Ce(c),Be&&Be.d(),vs=!1,Ye(xs)}}}function ur(s,e,t){let l,n,r;_e(s,at,C=>t(3,l=C)),_e(s,cs,C=>t(5,r=C));const a=_t(Ge(!1),{key:"inputs-hidden"});_e(s,a,C=>t(4,n=C));let o=l.fixedVelocity??"",i=l.keyFadeTimeout,c=!1;at.subscribe(C=>{t(0,o=C.fixedVelocity??""),t(1,i=C.keyFadeTimeout)});function d(){a.update(C=>!C)}function u(C){const{value:U}=C.currentTarget;let P;if(U)try{P=parseInt(U)}catch{}P!==void 0&&P>=0&&P<=127?je.setInputValue("fixedVelocity",P):U?t(0,o=l.fixedVelocity||""):je.setInputValue("fixedVelocity",void 0)}function _(C){try{const U=parseInt(C.currentTarget.value);je.setInputValue("keyFadeTimeout",U)}catch{t(1,i=l.keyFadeTimeout)}}function g(){je.setInputValue("useSound",!0),je.setInputValue("fixedVelocity",void 0),je.setInputValue("useKeyboard",!0),je.setInputValue("useHotkeys",!0),je.setInputValue("useAutoOctave",!0),je.setInputValue("keyFadeTimeout",1500)}const p=C=>je.setInputValue("useSound",C.currentTarget.checked);function v(){o=this.value,t(0,o)}const L=C=>je.setInputValue("useKeyboard",C.currentTarget.checked),y=C=>je.setInputValue("useHotkeys",C.currentTarget.checked),E=C=>je.setInputValue("useAutoOctave",C.currentTarget.checked),A=()=>t(2,c=!c);return s.$$set=C=>{t(11,e=Ae(Ae({},e),Se(C)))},e=Se(e),[o,i,c,l,n,r,a,d,u,_,g,e,p,v,L,y,E,A]}class fr extends We{constructor(e){super(),qe(this,e,ur,cr,Je,{})}}function dr(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){M(t,e,l)},p:ve,d(t){t&&m(e)}}}function hr(s){let e,t=s[1].note+"",l;return{c(){e=Z("Input: "),l=Z(t)},l(n){e=ee(n,"Input: "),l=ee(n,t)},m(n,r){M(n,e,r),M(n,l,r)},p(n,r){r&2&&t!==(t=n[1].note+"")&&he(l,t)},d(n){n&&(m(e),m(l))}}}function mr(s){let e,t;return{c(){e=Z("Input: "),t=Z(s[0])},l(l){e=ee(l,"Input: "),t=ee(l,s[0])},m(l,n){M(l,e,n),M(l,t,n)},p(l,n){n&1&&he(t,l[0])},d(l){l&&(m(e),m(t))}}}function _r(s){let e;return{c(){e=Z(Ss)},l(t){e=ee(t,Ss)},m(t,l){M(t,e,l)},p:ve,d(t){t&&m(e)}}}function pr(s){let e,t,l,n;function r(i,c){return i[2].useKeyboard&&Ss?_r:i[2].useKeyboard&&i[0]?mr:i[2].useKeyboard&&i[1]?hr:dr}let a=r(s),o=a(s);return{c(){e=b("div"),o.c(),this.h()},l(i){e=k(i,"DIV",{class:!0});var c=T(e);o.l(c),c.forEach(m),this.h()},h(){h(e,"class",t=`${s[4].class||""}`)},m(i,c){M(i,e,c),o.m(e,null),l||(n=q(window,"keydown",s[3]),l=!0)},p(i,[c]){a===(a=r(i))&&o?o.p(i,c):(o.d(1),o=a(i),o&&(o.c(),o.m(e,null))),c&16&&t!==(t=`${i[4].class||""}`)&&h(e,"class",t)},i:ve,o:ve,d(i){i&&m(e),o.d(),l=!1,n()}}}let Ss="";function gr(s,e,t){let l;_e(s,at,c=>t(2,l=c));let{debounced:n}=e,r="",a;const o=Sn();function i(c){const d=c.target;if(n||!(d instanceof HTMLElement)||d.tagName==="INPUT")return;const u=ft.handleInput(c.code,c.key,c.shiftKey);u&&u.e==="note"?t(1,a=u.data):u&&u.e==="string"?t(0,r=u.data):u&&(u.e==="guessed-key"||u.e==="guessed-chord"||u.e==="guessed-note")?(t(0,r=""),t(1,a=void 0),o(u.e,u.data),c.code==="Enter"&&c.preventDefault()):u&&c.preventDefault()}return s.$$set=c=>{t(4,e=Ae(Ae({},e),Se(c))),"debounced"in c&&t(5,n=c.debounced)},e=Se(e),[r,a,l,i,e,n]}class vr extends We{constructor(e){super(),qe(this,e,gr,pr,Je,{debounced:5})}}function br(s){let e,t,l,n="Count",r,a,o,i,c,d="Duplicates",u,_,g,p,v,L,y="Autoplay",E,A,C,U,P,B,j="Wait seconds",I,D,S,w,N;return{c(){e=b("ul"),t=b("li"),l=b("label"),l.textContent=n,r=V(),a=b("input"),o=V(),i=b("li"),c=b("label"),c.textContent=d,u=V(),_=b("input"),p=V(),v=b("li"),L=b("label"),L.textContent=y,E=V(),A=b("input"),U=V(),P=b("li"),B=b("label"),B.textContent=j,I=V(),D=b("input"),this.h()},l(R){e=k(R,"UL",{class:!0});var K=T(e);t=k(K,"LI",{class:!0});var F=T(t);l=k(F,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(l)!=="svelte-wgq9fc"&&(l.textContent=n),r=O(F),a=k(F,"INPUT",{class:!0,id:!0,type:!0}),F.forEach(m),o=O(K),i=k(K,"LI",{class:!0});var ne=T(i);c=k(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(c)!=="svelte-hcg9dq"&&(c.textContent=d),u=O(ne),_=k(ne,"INPUT",{class:!0,id:!0,type:!0}),ne.forEach(m),p=O(K),v=k(K,"LI",{class:!0});var me=T(v);L=k(me,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(L)!=="svelte-lr68n2"&&(L.textContent=y),E=O(me),A=k(me,"INPUT",{class:!0,id:!0,type:!0}),me.forEach(m),U=O(K),P=k(K,"LI",{class:!0});var Q=T(P);B=k(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(B)!=="svelte-1qj2vcy"&&(B.textContent=j),I=O(Q),D=k(Q,"INPUT",{class:!0,id:!0,type:!0}),Q.forEach(m),K.forEach(m),this.h()},h(){h(l,"class","font-bold"),h(l,"for","guess-count"),h(a,"class","h-[20px] w-10"),h(a,"id","guess-count"),h(a,"type","number"),h(t,"class","flex items-center justify-between svelte-1elvih2"),h(c,"class","font-bold"),h(c,"for","duplicates"),h(_,"class","h-[20px]"),h(_,"id","duplicates"),h(_,"type","checkbox"),_.checked=g=s[2].duplicates,h(i,"class","flex items-center justify-between mr-6 svelte-1elvih2"),h(L,"class","font-bold"),h(L,"for","autoplay"),h(A,"class","h-[20px]"),h(A,"id","autoplay"),h(A,"type","checkbox"),A.checked=C=s[2].autoplay,h(v,"class","flex items-center justify-between mr-6 svelte-1elvih2"),h(B,"class","font-bold"),h(B,"for","wait-ms"),h(D,"class","h-[20px] w-10"),h(D,"id","wait-ms"),h(D,"type","number"),h(P,"class","flex items-center justify-between svelte-1elvih2"),h(e,"class",S=Te(`${s[5].class||""}`)+" svelte-1elvih2")},m(R,K){M(R,e,K),f(e,t),f(t,l),f(t,r),f(t,a),et(a,s[0]),f(e,o),f(e,i),f(i,c),f(i,u),f(i,_),f(e,p),f(e,v),f(v,L),f(v,E),f(v,A),f(e,U),f(e,P),f(P,B),f(P,I),f(P,D),et(D,s[1]),w||(N=[q(a,"input",s[6]),q(a,"input",s[3]),q(_,"input",s[7]),q(A,"input",s[8]),q(D,"input",s[9]),q(D,"input",s[4])],w=!0)},p(R,[K]){K&1&&as(a.value)!==R[0]&&et(a,R[0]),K&4&&g!==(g=R[2].duplicates)&&(_.checked=g),K&4&&C!==(C=R[2].autoplay)&&(A.checked=C),K&2&&as(D.value)!==R[1]&&et(D,R[1]),K&32&&S!==(S=Te(`${R[5].class||""}`)+" svelte-1elvih2")&&h(e,"class",S)},i:ve,o:ve,d(R){R&&m(e),w=!1,Ye(N)}}}function kr(s,e,t){let l;_e(s,mt,_=>t(2,l=_));let n=l.count||"",r=l.waitSeconds||"";mt.subscribe(_=>{t(0,n=_.count||""),t(1,r=_.waitSeconds||"")});function a({currentTarget:{value:_}}){let g;try{g=parseInt(_),g<=0&&(g=1),De.setOptionValue("count",g)}catch{t(0,n=l.count)}}function o({currentTarget:{value:_}}){let g;try{g=parseInt(_),g<0&&(g=0),De.setOptionValue("waitSeconds",g)}catch{t(1,r=l.waitSeconds)}}function i(){n=as(this.value),t(0,n)}const c=_=>De.setOptionValue("duplicates",_.currentTarget.checked),d=_=>De.setOptionValue("autoplay",_.currentTarget.checked);function u(){r=as(this.value),t(1,r)}return s.$$set=_=>{t(5,e=Ae(Ae({},e),Se(_)))},e=Se(e),[n,r,l,a,o,e,i,c,d,u]}class yr extends We{constructor(e){super(),qe(this,e,kr,br,Je,{})}}function Kl(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l}function Fl(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l}function xl(s){let e,t,l=s[23]+"",n,r,a,o,i,c,d,u;function _(){return s[15](s[22])}o=new Qe({props:{icon:ws,width:20}});function g(...p){return s[16](s[22],...p)}return{c(){e=b("li"),t=b("button"),n=Z(l),r=V(),a=b("button"),ye(o.$$.fragment),i=V(),this.h()},l(p){e=k(p,"LI",{class:!0});var v=T(e);t=k(v,"BUTTON",{class:!0});var L=T(t);n=ee(L,l),L.forEach(m),r=O(v),a=k(v,"BUTTON",{class:!0});var y=T(a);Ee(o.$$.fragment,y),y.forEach(m),i=O(v),v.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),$(t,"selected",s[22]===s[0]),h(a,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),h(e,"class","flex svelte-1okhpct")},m(p,v){M(p,e,v),f(e,t),f(t,n),f(e,r),f(e,a),we(o,a,null),f(e,i),c=!0,d||(u=[q(t,"click",_),q(a,"click",g)],d=!0)},p(p,v){s=p,(!c||v&17)&&$(t,"selected",s[22]===s[0])},i(p){c||(x(o.$$.fragment,p),c=!0)},o(p){J(o.$$.fragment,p),c=!1},d(p){p&&m(e),Ce(o),d=!1,Ye(u)}}}function Hl(s){let e,t=fe(s[3]),l=[];for(let n=0;n<t.length;n+=1)l[n]=zl(Kl(s,t,n));return{c(){e=b("ul");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=k(n,"UL",{class:!0});var r=T(e);for(let a=0;a<l.length;a+=1)l[a].l(r);r.forEach(m),this.h()},h(){h(e,"class","svelte-1okhpct")},m(n,r){M(n,e,r);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(n,r){if(r&138){t=fe(n[3]);let a;for(a=0;a<t.length;a+=1){const o=Kl(n,t,a);l[a]?l[a].p(o,r):(l[a]=zl(o),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function zl(s){let e,t,l=s[23]+"",n,r,a,o;function i(){return s[17](s[22])}return{c(){e=b("li"),t=b("button"),n=Z(l),r=V(),this.h()},l(c){e=k(c,"LI",{class:!0});var d=T(e);t=k(d,"BUTTON",{class:!0});var u=T(t);n=ee(u,l),u.forEach(m),r=O(d),d.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),$(t,"selected",s[22]===s[1]),h(e,"class","svelte-1okhpct")},m(c,d){M(c,e,d),f(e,t),f(t,n),f(e,r),a||(o=q(t,"click",i),a=!0)},p(c,d){s=c,d&8&&l!==(l=s[23]+"")&&he(n,l),d&10&&$(t,"selected",s[22]===s[1])},d(c){c&&m(e),a=!1,o()}}}function Er(s){let e,t,l="Play",n,r,a,o,i,c,d,u,_,g,p="Reset",v,L,y,E,A=s[2]?"Quit":"Play",C,U,P,B,j,I=fe(s[4]),D=[];for(let N=0;N<I.length;N+=1)D[N]=xl(Fl(s,I,N));const S=N=>J(D[N],1,1,()=>{D[N]=null});let w=(s[0]==="chords-write"||s[0]==="chords-play")&&Hl(s);return d=new yr({props:{class:"game-options"}}),y=new Qe({props:{class:"mr-1",icon:s[2]?Qs:ws,width:20}}),{c(){e=b("fieldset"),t=b("legend"),t.textContent=l,n=V(),r=b("div"),a=b("ul");for(let N=0;N<D.length;N+=1)D[N].c();o=V(),i=b("div"),w&&w.c(),c=V(),ye(d.$$.fragment),u=V(),_=b("div"),g=b("button"),g.textContent=p,v=V(),L=b("button"),ye(y.$$.fragment),E=V(),C=Z(A),this.h()},l(N){e=k(N,"FIELDSET",{class:!0});var R=T(e);t=k(R,"LEGEND",{class:!0,"data-svelte-h":!0}),re(t)!=="svelte-1409tnk"&&(t.textContent=l),n=O(R),r=k(R,"DIV",{class:!0});var K=T(r);a=k(K,"UL",{class:!0});var F=T(a);for(let W=0;W<D.length;W+=1)D[W].l(F);F.forEach(m),o=O(K),i=k(K,"DIV",{class:!0});var ne=T(i);w&&w.l(ne),ne.forEach(m),c=O(K),Ee(d.$$.fragment,K),u=O(K),_=k(K,"DIV",{class:!0});var me=T(_);g=k(me,"BUTTON",{class:!0,"data-svelte-h":!0}),re(g)!=="svelte-10rv0bu"&&(g.textContent=p),v=O(me),L=k(me,"BUTTON",{class:!0});var Q=T(L);Ee(y.$$.fragment,Q),E=O(Q),C=ee(Q,A),Q.forEach(m),me.forEach(m),K.forEach(m),R.forEach(m),this.h()},h(){h(t,"class","px-1 text-base"),h(a,"class","games svelte-1okhpct"),h(i,"class","options svelte-1okhpct"),h(g,"class","w-full btn hover:bg-gray-200"),h(L,"class","w-full mt-2 flex items-center justify-center btn primary"),h(_,"class","h-full flex flex-col justify-end"),h(r,"class","body pb-2 h-full svelte-1okhpct"),h(e,"class",U=Te(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(N,R){M(N,e,R),f(e,t),f(e,n),f(e,r),f(r,a);for(let K=0;K<D.length;K+=1)D[K]&&D[K].m(a,null);f(r,o),f(r,i),w&&w.m(i,null),f(r,c),we(d,r,null),f(r,u),f(r,_),f(_,g),f(_,v),f(_,L),we(y,L,null),f(L,E),f(L,C),P=!0,B||(j=[q(g,"click",s[8]),q(L,"click",s[9])],B=!0)},p(N,[R]){if(R&113){I=fe(N[4]);let F;for(F=0;F<I.length;F+=1){const ne=Fl(N,I,F);D[F]?(D[F].p(ne,R),x(D[F],1)):(D[F]=xl(ne),D[F].c(),x(D[F],1),D[F].m(a,null))}for(He(),F=I.length;F<D.length;F+=1)S(F);ze()}N[0]==="chords-write"||N[0]==="chords-play"?w?w.p(N,R):(w=Hl(N),w.c(),w.m(i,null)):w&&(w.d(1),w=null);const K={};R&4&&(K.icon=N[2]?Qs:ws),y.$set(K),(!P||R&4)&&A!==(A=N[2]?"Quit":"Play")&&he(C,A),(!P||R&1024&&U!==(U=Te(`${N[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&h(e,"class",U)},i(N){if(!P){for(let R=0;R<I.length;R+=1)x(D[R]);x(d.$$.fragment,N),x(y.$$.fragment,N),P=!0}},o(N){D=D.filter(Boolean);for(let R=0;R<D.length;R+=1)J(D[R]);J(d.$$.fragment,N),J(y.$$.fragment,N),P=!1},d(N){N&&m(e),Ve(D,N),w&&w.d(),Ce(d),Ce(y),B=!1,Ye(j)}}}function wr(s,e,t){let l,n,r,a,o,i,c;_e(s,Bs,P=>t(12,a=P)),_e(s,mt,P=>t(20,o=P)),_e(s,dt,P=>t(13,i=P)),_e(s,wt,P=>t(14,c=P));const d=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let u=d[4].key,_="maj-m";o.count,o.waitSeconds,mt.subscribe(P=>{P.count,P.waitSeconds});function g(P,B){if(B==="chords-write"||B==="chords-play"||B==="chords-diatonic"){let j=[];_==="selected"?j=a.filter(I=>I.selected):_==="all"?j=a:_==="maj-m"?j=a.filter(I=>I.suffixes[0]==="maj"||I.suffixes[0]==="m"):_==="seventh"&&(j=a.filter(I=>I.suffixes[0]==="maj7"||I.suffixes[0]==="m7"||I.suffixes[0]==="7"||I.suffixes[0]==="dim7"||I.suffixes[0]==="aug7")),De.play(B,{chords:j})}else De.play(B,void 0);P.currentTarget instanceof HTMLElement&&P.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function p(P){t(0,u=P)}function v(P,B){t(0,u=B),g(P,B)}function L(P){t(1,_=P)}function y(){De.clearGame(!0)}function E(P){l?De.clearGame():g(P,u)}const A=P=>p(P),C=(P,B)=>v(B,P),U=P=>L(P);return s.$$set=P=>{t(10,e=Ae(Ae({},e),Se(P)))},s.$$.update=()=>{s.$$.dirty&24576&&t(2,l=!!c&&i!=="ended"),s.$$.dirty&4096&&t(11,n=a.reduce((P,B)=>B.selected?P+1:P,0)),s.$$.dirty&2048&&t(3,r=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${n} chords`},{key:"all",value:"All"}])},e=Se(e),[u,_,l,r,d,p,v,L,y,E,e,n,a,i,c,A,C,U]}class Cr extends We{constructor(e){super(),qe(this,e,wr,Er,Je,{})}}function Wl(s,e,t){const l=s.slice();return l[7]=e[t],l}function ql(s,e,t){const l=s.slice();return l[4]=e[t],l}function Tr(s){let e,t=fe(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Jl(Wl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r&2){t=fe(n[1]);let a;for(a=0;a<t.length;a+=1){const o=Wl(n,t,a);l[a]?l[a].p(o,r):(l[a]=Jl(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function Ir(s){let e,t=fe(s[0].scaleNotes||[]),l=[];for(let n=0;n<t.length;n+=1)l[n]=$l(ql(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r&1){t=fe(n[0].scaleNotes||[]);let a;for(a=0;a<t.length;a+=1){const o=ql(n,t,a);l[a]?l[a].p(o,r):(l[a]=$l(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function Jl(s){let e,t=s[7].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var r=T(e);l=ee(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-my4m0t")},m(n,r){M(n,e,r),f(e,l)},p(n,r){r&2&&t!==(t=n[7].interval+"")&&he(l,t)},d(n){n&&m(e)}}}function $l(s){let e,t=s[4].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var r=T(e);l=ee(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-my4m0t")},m(n,r){M(n,e,r),f(e,l)},p(n,r){r&1&&t!==(t=n[4].note+"")&&he(l,t)},d(n){n&&m(e)}}}function Ar(s){let e,t,l,n,r,a;function o(d,u){return d[0]?Ir:Tr}let i=o(s),c=i(s);return{c(){e=b("div"),t=b("button"),c.c(),this.h()},l(d){e=k(d,"DIV",{class:!0,title:!0});var u=T(e);t=k(u,"BUTTON",{class:!0});var _=T(t);c.l(_),_.forEach(m),u.forEach(m),this.h()},h(){h(t,"class","intervals svelte-my4m0t"),h(e,"class",l=`${s[2].class||""} `),h(e,"title",n=s[1].map(Ql).join("-"))},m(d,u){M(d,e,u),f(e,t),c.m(t,null),r||(a=q(t,"click",s[3]),r=!0)},p(d,[u]){i===(i=o(d))&&c?c.p(d,u):(c.d(1),c=i(d),c&&(c.c(),c.m(t,null))),u&4&&l!==(l=`${d[2].class||""} `)&&h(e,"class",l),u&2&&n!==(n=d[1].map(Ql).join("-"))&&h(e,"title",n)},i:ve,o:ve,d(d){d&&m(e),c.d(),r=!1,a()}}}const Ql=s=>s.interval;function Sr(s,e,t){let{scale:l,intervals:n}=e;function r(a){fs.call(this,s,a)}return s.$$set=a=>{t(2,e=Ae(Ae({},e),Se(a))),"scale"in a&&t(0,l=a.scale),"intervals"in a&&t(1,n=a.intervals)},e=Se(e),[l,n,e,r]}class Tn extends We{constructor(e){super(),qe(this,e,Sr,Ar,Je,{scale:0,intervals:1})}}function Yl(s,e,t){const l=s.slice();return l[7]=e[t],l}function Xl(s,e,t){const l=s.slice();return l[4]=e[t],l}function Nr(s){let e,t=fe(s[0]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Zl(Yl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r&1){t=fe(n[0]);let a;for(a=0;a<t.length;a+=1){const o=Yl(n,t,a);l[a]?l[a].p(o,r):(l[a]=Zl(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function Lr(s){let e,t=fe(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=en(Xl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(n,r);M(n,e,r)},p(n,r){if(r&2){t=fe(n[1]);let a;for(a=0;a<t.length;a+=1){const o=Xl(n,t,a);l[a]?l[a].p(o,r):(l[a]=en(o),l[a].c(),l[a].m(e.parentNode,e))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function Zl(s){let e,t,l=s[7].roman+"",n,r,a,o=s[7].suffix+"",i,c;return{c(){e=b("span"),t=b("span"),n=Z(l),r=V(),a=b("sup"),i=Z(o),c=V(),this.h()},l(d){e=k(d,"SPAN",{class:!0});var u=T(e);t=k(u,"SPAN",{class:!0});var _=T(t);n=ee(_,l),_.forEach(m),r=O(u),a=k(u,"SUP",{class:!0});var g=T(a);i=ee(g,o),g.forEach(m),c=O(u),u.forEach(m),this.h()},h(){h(t,"class","block"),h(a,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),$(a,"super-text",s[7].suffix.length>2),h(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(d,u){M(d,e,u),f(e,t),f(t,n),f(e,r),f(e,a),f(a,i),f(e,c)},p(d,u){u&1&&l!==(l=d[7].roman+"")&&he(n,l),u&1&&o!==(o=d[7].suffix+"")&&he(i,o),u&1&&$(a,"super-text",d[7].suffix.length>2)},d(d){d&&m(e)}}}function en(s){let e,t,l=s[4]+"",n,r;return{c(){e=b("span"),t=b("span"),n=Z(l),r=V(),this.h()},l(a){e=k(a,"SPAN",{class:!0});var o=T(e);t=k(o,"SPAN",{});var i=T(t);n=ee(i,l),i.forEach(m),r=O(o),o.forEach(m),this.h()},h(){h(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(a,o){M(a,e,o),f(e,t),f(t,n),f(e,r)},p(a,o){o&2&&l!==(l=a[4]+"")&&he(n,l)},d(a){a&&m(e)}}}function Dr(s){let e,t,l,n,r,a;function o(d,u){return d[1].length>0?Lr:Nr}let i=o(s),c=i(s);return{c(){e=b("div"),t=b("button"),c.c(),this.h()},l(d){e=k(d,"DIV",{class:!0,title:!0});var u=T(e);t=k(u,"BUTTON",{class:!0});var _=T(t);c.l(_),_.forEach(m),u.forEach(m),this.h()},h(){h(t,"class","triads flex flex-wrap svelte-1roj1mi"),h(e,"class",l=Te(`${s[2].class||""} `)+" svelte-1roj1mi"),h(e,"title",n=s[0].map(tn).join("-"))},m(d,u){M(d,e,u),f(e,t),c.m(t,null),r||(a=q(t,"click",s[3]),r=!0)},p(d,[u]){i===(i=o(d))&&c?c.p(d,u):(c.d(1),c=i(d),c&&(c.c(),c.m(t,null))),u&4&&l!==(l=Te(`${d[2].class||""} `)+" svelte-1roj1mi")&&h(e,"class",l),u&1&&n!==(n=d[0].map(tn).join("-"))&&h(e,"title",n)},i:ve,o:ve,d(d){d&&m(e),c.d(),r=!1,a()}}}const tn=s=>s.roman+s.suffix;function Pr(s,e,t){let{triads:l,chords:n}=e;function r(a){fs.call(this,s,a)}return s.$$set=a=>{t(2,e=Ae(Ae({},e),Se(a))),"triads"in a&&t(0,l=a.triads),"chords"in a&&t(1,n=a.chords)},e=Se(e),[l,n,e,r]}class In extends We{constructor(e){super(),qe(this,e,Pr,Dr,Je,{triads:0,chords:1})}}function sn(s,e,t){const l=s.slice();return l[23]=e[t],l}function ln(s,e,t){const l=s.slice();return l[23]=e[t],l}function nn(s){let e,t,l=s[23].raw.names[0]+"",n,r,a,o,i,c,d;function u(){return s[11](s[23])}a=new Tn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),a.$on("click",u);function _(){return s[12](s[23])}return i=new In({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",_),{c(){e=b("li"),t=b("div"),n=Z(l),r=V(),ye(a.$$.fragment),o=V(),ye(i.$$.fragment),c=V(),this.h()},l(g){e=k(g,"LI",{class:!0});var p=T(e);t=k(p,"DIV",{class:!0});var v=T(t);n=ee(v,l),v.forEach(m),r=O(p),Ee(a.$$.fragment,p),o=O(p),Ee(i.$$.fragment,p),c=O(p),p.forEach(m),this.h()},h(){h(t,"class","text-xs font-bold"),h(e,"class","svelte-4hctsl")},m(g,p){M(g,e,p),f(e,t),f(t,n),f(e,r),we(a,e,null),f(e,o),we(i,e,null),f(e,c),d=!0},p(g,p){s=g,(!d||p&4)&&l!==(l=s[23].raw.names[0]+"")&&he(n,l);const v={};p&4&&(v.scale=s[23].scale),p&4&&(v.intervals=s[23].raw.intervals),a.$set(v);const L={};p&4&&(L.triads=s[23].triads),p&4&&(L.chords=s[23].triadChords),i.$set(L)},i(g){d||(x(a.$$.fragment,g),x(i.$$.fragment,g),d=!0)},o(g){J(a.$$.fragment,g),J(i.$$.fragment,g),d=!1},d(g){g&&m(e),Ce(a),Ce(i)}}}function an(s){let e,t,l=s[23].raw.names[0]+"",n,r,a,o,i,c,d;function u(){return s[13](s[23])}a=new Tn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),a.$on("click",u);function _(){return s[14](s[23])}return i=new In({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",_),{c(){e=b("li"),t=b("div"),n=Z(l),r=V(),ye(a.$$.fragment),o=V(),ye(i.$$.fragment),c=V(),this.h()},l(g){e=k(g,"LI",{class:!0});var p=T(e);t=k(p,"DIV",{class:!0});var v=T(t);n=ee(v,l),v.forEach(m),r=O(p),Ee(a.$$.fragment,p),o=O(p),Ee(i.$$.fragment,p),c=O(p),p.forEach(m),this.h()},h(){h(t,"class","text-xs font-bold"),h(e,"class","svelte-4hctsl")},m(g,p){M(g,e,p),f(e,t),f(t,n),f(e,r),we(a,e,null),f(e,o),we(i,e,null),f(e,c),d=!0},p(g,p){s=g,(!d||p&2)&&l!==(l=s[23].raw.names[0]+"")&&he(n,l);const v={};p&2&&(v.scale=s[23].scale),p&2&&(v.intervals=s[23].raw.intervals),a.$set(v);const L={};p&2&&(L.triads=s[23].triads),p&2&&(L.chords=s[23].triadChords),i.$set(L)},i(g){d||(x(a.$$.fragment,g),x(i.$$.fragment,g),d=!0)},o(g){J(a.$$.fragment,g),J(i.$$.fragment,g),d=!1},d(g){g&&m(e),Ce(a),Ce(i)}}}function Vr(s){let e,t,l,n,r="Scales",a,o,i,c="Key",d,u,_,g,p,v,L,y,E,A,C,U=fe(s[2]),P=[];for(let S=0;S<U.length;S+=1)P[S]=nn(ln(s,U,S));const B=S=>J(P[S],1,1,()=>{P[S]=null});let j=fe(s[1]),I=[];for(let S=0;S<j.length;S+=1)I[S]=an(sn(s,j,S));const D=S=>J(I[S],1,1,()=>{I[S]=null});return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,a=V(),o=b("div"),i=b("label"),i.textContent=c,d=V(),u=b("input"),_=V(),g=b("div"),p=b("ul");for(let S=0;S<P.length;S+=1)P[S].c();v=V(),L=b("ul");for(let S=0;S<I.length;S+=1)I[S].c();this.h()},l(S){e=k(S,"DIV",{class:!0});var w=T(e);t=k(w,"FIELDSET",{class:!0});var N=T(t);l=k(N,"LEGEND",{class:!0});var R=T(l);n=k(R,"BUTTON",{class:!0,"data-svelte-h":!0}),re(n)!=="svelte-lhx60e"&&(n.textContent=r),R.forEach(m),a=O(N),o=k(N,"DIV",{class:!0});var K=T(o);i=k(K,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(i)!=="svelte-14m38zf"&&(i.textContent=c),d=O(K),u=k(K,"INPUT",{class:!0,id:!0}),K.forEach(m),_=O(N),g=k(N,"DIV",{class:!0});var F=T(g);p=k(F,"UL",{class:!0});var ne=T(p);for(let Q=0;Q<P.length;Q+=1)P[Q].l(ne);ne.forEach(m),v=O(F),L=k(F,"UL",{class:!0});var me=T(L);for(let Q=0;Q<I.length;Q+=1)I[Q].l(me);me.forEach(m),F.forEach(m),N.forEach(m),w.forEach(m),this.h()},h(){h(n,"class","px-1 rounded hover:bg-gray-100"),h(l,"class","text-base"),h(i,"class","mr-4 font-bold"),h(i,"for","scale-key"),h(u,"class","bg-gray-100 w-16 px-1 rounded"),h(u,"id","scale-key"),u.value=s[0],h(o,"class","flex mb-2 input svelte-4hctsl"),$(o,"hidden",s[3]),h(p,"class","list odd w-full svelte-4hctsl"),h(L,"class","list even w-full svelte-4hctsl"),h(g,"class","body max-h-[30rem] overflow-scroll svelte-4hctsl"),$(g,"hidden",s[3]),h(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),$(t,"collapsed",s[3]),h(e,"class",y=Te(`${s[9].class||""}`)+" svelte-4hctsl")},m(S,w){M(S,e,w),f(e,t),f(t,l),f(l,n),f(t,a),f(t,o),f(o,i),f(o,d),f(o,u),f(t,_),f(t,g),f(g,p);for(let N=0;N<P.length;N+=1)P[N]&&P[N].m(p,null);f(g,v),f(g,L);for(let N=0;N<I.length;N+=1)I[N]&&I[N].m(L,null);E=!0,A||(C=[q(n,"click",s[5]),q(u,"input",s[6])],A=!0)},p(S,[w]){if((!E||w&1&&u.value!==S[0])&&(u.value=S[0]),(!E||w&8)&&$(o,"hidden",S[3]),w&388){U=fe(S[2]);let N;for(N=0;N<U.length;N+=1){const R=ln(S,U,N);P[N]?(P[N].p(R,w),x(P[N],1)):(P[N]=nn(R),P[N].c(),x(P[N],1),P[N].m(p,null))}for(He(),N=U.length;N<P.length;N+=1)B(N);ze()}if(w&386){j=fe(S[1]);let N;for(N=0;N<j.length;N+=1){const R=sn(S,j,N);I[N]?(I[N].p(R,w),x(I[N],1)):(I[N]=an(R),I[N].c(),x(I[N],1),I[N].m(L,null))}for(He(),N=j.length;N<I.length;N+=1)D(N);ze()}(!E||w&8)&&$(g,"hidden",S[3]),(!E||w&8)&&$(t,"collapsed",S[3]),(!E||w&512&&y!==(y=Te(`${S[9].class||""}`)+" svelte-4hctsl"))&&h(e,"class",y)},i(S){if(!E){for(let w=0;w<U.length;w+=1)x(P[w]);for(let w=0;w<j.length;w+=1)x(I[w]);E=!0}},o(S){P=P.filter(Boolean);for(let w=0;w<P.length;w+=1)J(P[w]);I=I.filter(Boolean);for(let w=0;w<I.length;w+=1)J(I[w]);E=!1},d(S){S&&m(e),Ve(P,S),Ve(I,S),A=!1,Ye(C)}}}function Or(s,e,t){let l,n,r,a,o,i,c;_e(s,Bt,I=>t(17,r=I)),_e(s,Gt,I=>t(18,a=I)),_e(s,at,I=>t(19,o=I)),_e(s,nt,I=>t(20,i=I));let u=ds().map(I=>({key:I.names[0],raw:I,scale:void 0,triads:I.triads,triadChords:[]})),_="",g=[a.key,a.scale],p;const v=_t(Ge(!0),{key:"scales-hidden"});_e(s,v,I=>t(3,c=I));function L(){v.update(I=>!I)}function y({currentTarget:{value:I}}){t(0,_=`${I.charAt(0).toUpperCase()}${I.charAt(1).toLowerCase()}`),t(10,u=u.map(D=>{const S=Ut(_,D.key),w=_&&"data"in S?S.data:void 0;let N=[];return w&&(N=D.triads.map((R,K)=>`${w.scaleNotes[K].note}${!R.suffix.includes("°")&&R.minor?"m":""}${R.suffix}`)),{...D,scale:w,triadChords:N}}))}function E(I,D,S){if(I<D.length){const w=D[I++];Le.setPlayed(w),i==null||i.playChord(w.map(N=>N.midi),o.fixedVelocity),p=setTimeout(()=>E(I,D,S),S)}else Le.setPlayed([]),Le.setKeyAndScale(g[0],g[1])}function A(I){clearTimeout(p);let D,S;I.scale?(S=I.scale,g=[a.key,a.scale],Le.setKeyAndScale(I.scale.key,I.scale.scale)):S=a;const w=r[0].midi+S.scaleNotes[0].semitones;D=I.raw.intervals.map(N=>[{...S.notesMap.get(N.semitones%12),midi:w+N.semitones}]),D[0][0].semitones!==D[D.length-1][0].semitones&&D.push(D[0].map(N=>({...N,midi:N.midi+12}))),E(0,D,500)}function C(I){clearTimeout(p);const{intervals:D}=I.raw;let S,w;I.scale?(w=I.scale,g=[a.key,a.scale],Le.setKeyAndScale(I.scale.key,I.scale.scale)):w=a;const N=r[0].midi+w.scaleNotes[0].semitones;S=bn(I.triads).map((K,F)=>ts(N+w.intervals[F].semitones,w,K.intervals)),D[D.length-1].interval_seq!==1&&S.push(S[0].map(K=>({...K,midi:K.midi+12}))),E(0,S,750)}const U=I=>A(I),P=I=>C(I),B=I=>A(I),j=I=>C(I);return s.$$set=I=>{t(9,e=Ae(Ae({},e),Se(I)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,l=u.filter((I,D)=>D<u.length/2)),s.$$.dirty&1024&&t(1,n=u.filter((I,D)=>D>=u.length/2))},e=Se(e),[_,n,l,c,v,L,y,A,C,e,u,U,P,B,j]}class jr extends We{constructor(e){super(),qe(this,e,Or,Vr,Je,{})}}function rn(s,e,t){const l=s.slice();return l[26]=e[t],l}function on(s,e,t){const l=s.slice();return l[29]=e[t],l}function cn(s){let e,t;return{c(){e=b("div"),t=Z(s[3]),this.h()},l(l){e=k(l,"DIV",{class:!0});var n=T(e);t=ee(n,s[3]),n.forEach(m),this.h()},h(){h(e,"class","error svelte-1u7ze7x")},m(l,n){M(l,e,n),f(e,t)},p(l,n){n[0]&8&&he(t,l[3])},d(l){l&&m(e)}}}function un(s){let e,t=fe(s[5]),l=[];for(let n=0;n<t.length;n+=1)l[n]=fn(on(s,t,n));return{c(){e=b("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=k(n,"DIV",{class:!0});var r=T(e);for(let a=0;a<l.length;a+=1)l[a].l(r);r.forEach(m),this.h()},h(){h(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){M(n,e,r);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(n,r){if(r[0]&32){t=fe(n[5]);let a;for(a=0;a<t.length;a+=1){const o=on(n,t,a);l[a]?l[a].p(o,r):(l[a]=fn(o),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function fn(s){let e,t=s[29].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var r=T(e);l=ee(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1u7ze7x")},m(n,r){M(n,e,r),f(e,l)},p(n,r){r[0]&32&&t!==(t=n[29].interval+"")&&he(l,t)},d(n){n&&m(e)}}}function dn(s){let e,t=fe(s[8].scaleNotes),l=[];for(let n=0;n<t.length;n+=1)l[n]=hn(rn(s,t,n));return{c(){e=b("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=k(n,"DIV",{class:!0});var r=T(e);for(let a=0;a<l.length;a+=1)l[a].l(r);r.forEach(m),this.h()},h(){h(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){M(n,e,r);for(let a=0;a<l.length;a+=1)l[a]&&l[a].m(e,null)},p(n,r){if(r[0]&256){t=fe(n[8].scaleNotes);let a;for(a=0;a<t.length;a+=1){const o=rn(n,t,a);l[a]?l[a].p(o,r):(l[a]=hn(o),l[a].c(),l[a].m(e,null))}for(;a<l.length;a+=1)l[a].d(1);l.length=t.length}},d(n){n&&m(e),Ve(l,n)}}}function hn(s){let e,t=s[26].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=k(n,"SPAN",{class:!0});var r=T(e);l=ee(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1u7ze7x")},m(n,r){M(n,e,r),f(e,l)},p(n,r){r[0]&256&&t!==(t=n[26].note+"")&&he(l,t)},d(n){n&&m(e)}}}function Br(s){let e,t,l,n="Score",r,a,o,i,c,d,u,_="Range",g,p,v,L,y,E="—",A,C,U,P,B,j,I,D="Scale",S,w,N,R,K,F,ne,me="Key",Q,W,G,se,H,te,ie,be;o=new Qe({props:{icon:Kt,width:16}});let ae=s[3]&&cn(s);N=new _n({props:{class:"p-1 pl-[2px] w-48",containerClass:"w-48",selected:s[0],options:s[10],onSelect:s[14]}});let de=!s[7]&&un(s),Y=!s[7]&&dn(s);return{c(){e=b("fieldset"),t=b("legend"),l=b("button"),l.textContent=n,r=V(),a=b("button"),ye(o.$$.fragment),i=V(),c=b("div"),d=b("div"),u=b("label"),u.textContent=_,g=V(),p=b("div"),v=b("input"),L=V(),y=b("span"),y.textContent=E,A=V(),C=b("input"),U=V(),P=b("div"),ae&&ae.c(),B=V(),j=b("div"),I=b("label"),I.textContent=D,S=V(),w=b("div"),ye(N.$$.fragment),R=V(),de&&de.c(),K=V(),F=b("div"),ne=b("label"),ne.textContent=me,Q=V(),W=b("div"),G=b("input"),se=V(),Y&&Y.c(),this.h()},l(ce){e=k(ce,"FIELDSET",{class:!0});var ge=T(e);t=k(ge,"LEGEND",{class:!0});var ue=T(t);l=k(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),re(l)!=="svelte-lqyol"&&(l.textContent=n),ue.forEach(m),r=O(ge),a=k(ge,"BUTTON",{class:!0});var Ke=T(a);Ee(o.$$.fragment,Ke),Ke.forEach(m),i=O(ge),c=k(ge,"DIV",{class:!0});var z=T(c);d=k(z,"DIV",{class:!0});var oe=T(d);u=k(oe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(u)!=="svelte-10u0679"&&(u.textContent=_),g=O(oe),p=k(oe,"DIV",{class:!0});var pe=T(p);v=k(pe,"INPUT",{class:!0,id:!0}),L=O(pe),y=k(pe,"SPAN",{class:!0,"data-svelte-h":!0}),re(y)!=="svelte-8q1xz4"&&(y.textContent=E),A=O(pe),C=k(pe,"INPUT",{class:!0,id:!0}),pe.forEach(m),U=O(oe),P=k(oe,"DIV",{class:!0});var tt=T(P);ae&&ae.l(tt),tt.forEach(m),oe.forEach(m),B=O(z),j=k(z,"DIV",{class:!0});var le=T(j);I=k(le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(I)!=="svelte-ld2d07"&&(I.textContent=D),S=O(le),w=k(le,"DIV",{class:!0});var Oe=T(w);Ee(N.$$.fragment,Oe),Oe.forEach(m),R=O(le),de&&de.l(le),le.forEach(m),K=O(z),F=k(z,"DIV",{class:!0});var Me=T(F);ne=k(Me,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),re(ne)!=="svelte-17pcm6g"&&(ne.textContent=me),Q=O(Me),W=k(Me,"DIV",{class:!0});var pt=T(W);G=k(pt,"INPUT",{class:!0,id:!0}),pt.forEach(m),se=O(Me),Y&&Y.l(Me),Me.forEach(m),z.forEach(m),ge.forEach(m),this.h()},h(){h(l,"class","px-1 rounded hover:bg-gray-100"),h(t,"class","px-1 text-base"),h(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),$(a,"hidden",s[6]),h(u,"class","font-bold"),h(u,"for","range_min"),h(v,"class","h-[28px] w-full"),h(v,"id","range_min"),h(y,"class","mx-2 mt-1"),h(C,"class","h-[28px] w-full"),h(C,"id","range_max"),h(p,"class","my-1 flex w-full"),h(P,"class","flex justify-between my-1"),h(d,"class","flex flex-col h-full"),h(I,"class","font-bold"),h(I,"for","scales"),h(w,"class","my-1 w-full"),h(j,"class","flex flex-col h-full"),h(ne,"class","font-bold"),h(ne,"for","key"),h(G,"class","h-[28px]"),h(G,"id","key"),h(W,"class","my-1 flex"),h(F,"class","flex flex-col h-full"),h(c,"class","options svelte-1u7ze7x"),$(c,"hidden",s[6]),h(e,"class",H=Te(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),$(e,"collapsed",s[6])},m(ce,ge){M(ce,e,ge),f(e,t),f(t,l),f(e,r),f(e,a),we(o,a,null),f(e,i),f(e,c),f(c,d),f(d,u),f(d,g),f(d,p),f(p,v),et(v,s[1]),f(p,L),f(p,y),f(p,A),f(p,C),et(C,s[2]),f(d,U),f(d,P),ae&&ae.m(P,null),f(c,B),f(c,j),f(j,I),f(j,S),f(j,w),we(N,w,null),f(j,R),de&&de.m(j,null),f(c,K),f(c,F),f(F,ne),f(F,Q),f(F,W),f(W,G),et(G,s[4]),f(F,se),Y&&Y.m(F,null),te=!0,ie||(be=[q(l,"click",s[15]),q(a,"click",s[16]),q(v,"input",s[18]),q(v,"change",s[19]),q(v,"focus",s[12]),q(C,"input",s[20]),q(C,"change",s[21]),q(C,"focus",s[12]),q(G,"input",s[22]),q(G,"input",s[13])],ie=!0)},p(ce,ge){(!te||ge[0]&64)&&$(a,"hidden",ce[6]),ge[0]&2&&v.value!==ce[1]&&et(v,ce[1]),ge[0]&4&&C.value!==ce[2]&&et(C,ce[2]),ce[3]?ae?ae.p(ce,ge):(ae=cn(ce),ae.c(),ae.m(P,null)):ae&&(ae.d(1),ae=null);const ue={};ge[0]&1&&(ue.selected=ce[0]),N.$set(ue),ce[7]?de&&(de.d(1),de=null):de?de.p(ce,ge):(de=un(ce),de.c(),de.m(j,null)),ge[0]&16&&G.value!==ce[4]&&et(G,ce[4]),ce[7]?Y&&(Y.d(1),Y=null):Y?Y.p(ce,ge):(Y=dn(ce),Y.c(),Y.m(F,null)),(!te||ge[0]&64)&&$(c,"hidden",ce[6]),(!te||ge[0]&131072&&H!==(H=Te(`${ce[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&h(e,"class",H),(!te||ge[0]&131136)&&$(e,"collapsed",ce[6])},i(ce){te||(x(o.$$.fragment,ce),x(N.$$.fragment,ce),te=!0)},o(ce){J(o.$$.fragment,ce),J(N.$$.fragment,ce),te=!1},d(ce){ce&&m(e),Ce(o),ae&&ae.d(),Ce(N),de&&de.d(),Y&&Y.d(),ie=!1,Ye(be)}}}function Gr(s,e,t){let l,n,r,a,o,i;_e(s,Bt,w=>t(23,n=w)),_e(s,Tt,w=>t(24,r=w)),_e(s,wt,w=>t(7,o=w)),_e(s,Gt,w=>t(8,i=w));let c=lt(n[0]),d=lt(n[1]),u="";const _=_t(Ge(!1),{key:"score-options-hidden"});_e(s,_,w=>t(6,a=w));let g=r[0],p=r[1];const v=ds(),L=v.map(w=>({key:w.names[0],value:w.names[0]}));Bt.subscribe(w=>{t(1,c=lt(w[0])),t(2,d=lt(w[1]))}),Tt.subscribe(w=>{t(4,g=w[0]),t(0,p=w[1])});function y(w,N){const R=Xn(N.currentTarget.value,!0,!0);if("data"in R){const{midi:K}=R.data,F=n,ne=[w==="min"?K:F[0].midi,w==="max"?K:F[1].midi];je.setMidiRange(ne),t(3,u="")}else t(3,u=R.err),w==="min"?t(1,c=lt(n[0])):t(2,d=lt(n[1]))}function E(){t(3,u="")}function A({currentTarget:{value:w}}){t(4,g=`${w.charAt(0).toUpperCase()}${w.charAt(1).toLowerCase()}`),Le.setKey(g)}function C(w){var N;return t(0,p=(N=L.find(R=>w===R.key))==null?void 0:N.value),Le.setScale(p),!1}function U(){_.update(w=>!w)}function P(){Le.clearScore(!0),je.setMidiRange([60,84])}function B(){c=this.value,t(1,c)}const j=w=>y("min",w);function I(){d=this.value,t(2,d)}const D=w=>y("max",w);function S(){g=this.value,t(4,g)}return s.$$set=w=>{t(17,e=Ae(Ae({},e),Se(w)))},s.$$.update=()=>{var w;s.$$.dirty[0]&1&&t(5,l=((w=v.find(N=>N.names[0]===p))==null?void 0:w.intervals)||[])},e=Se(e),[p,c,d,u,g,l,a,o,i,_,L,y,E,A,C,U,P,e,B,j,I,D,S]}class Mr extends We{constructor(e){super(),qe(this,e,Gr,Br,Je,{},null,[-1,-1])}}function Ur(s){s[21]=s[22].default}function Rr(s){return{c:ve,l:ve,m:ve,i:ve,o:ve,d:ve}}function Kr(s){Ur(s);let e,t,l;var n=s[21];function r(a,o){return{props:{class:"mx-4 md:mx-0"}}}return n&&(e=Dn(n,r())),{c(){e&&ye(e.$$.fragment),t=Pe()},l(a){e&&Ee(e.$$.fragment,a),t=Pe()},m(a,o){e&&we(e,a,o),M(a,t,o),l=!0},i(a){l||(e&&x(e.$$.fragment,a),l=!0)},o(a){e&&J(e.$$.fragment,a),l=!1},d(a){a&&m(t),e&&Ce(e,a)}}}function Fr(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){M(t,e,l)},i:ve,o:ve,d(t){t&&m(e)}}}function xr(s){let e,t,l,n,r="MIDI Note Trainer",a,o,i,c,d,u,_,g="Introduction",p,v,L,y,E,A,C,U,P,B,j,I,D,S,w,N,R,K,F,ne,me;c=new Qe({props:{icon:Kt,width:24}}),L=new fr({}),E=new jr({}),C=new Ea({}),B=new Mr({props:{class:"score-options mr-4"}}),I=new Cr({props:{class:"play-form"}});let Q={ctx:s,current:null,token:null,hasCatch:!1,pending:Fr,then:Kr,catch:Rr,value:22,blocks:[,,,]};return Nn(ke(()=>import("./Score.a7a94c7f.js"),["./Score.a7a94c7f.js","./vendor_svelte.d23d0217.js","./vendor.e74270f4.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),Q),N=new vr({props:{class:"min-h-32",debounced:!!s[0]}}),N.$on("guessed-chord",s[2]),N.$on("guessed-key",s[3]),N.$on("guessed-note",s[4]),K=new ja({props:{game:s[1]}}),{c(){e=b("meta"),t=V(),l=b("h1"),n=b("a"),n.textContent=r,a=V(),o=b("div"),i=b("button"),ye(c.$$.fragment),d=V(),u=b("div"),_=b("button"),_.textContent=g,p=V(),v=b("section"),ye(L.$$.fragment),y=V(),ye(E.$$.fragment),A=V(),ye(C.$$.fragment),U=V(),P=b("div"),ye(B.$$.fragment),j=V(),ye(I.$$.fragment),D=V(),Q.block.c(),S=V(),w=b("section"),ye(N.$$.fragment),R=V(),ye(K.$$.fragment),this.h()},l(W){const G=Ln("svelte-1w2oado",document.head);e=k(G,"META",{name:!0,content:!0}),G.forEach(m),t=O(W),l=k(W,"H1",{class:!0});var se=T(l);n=k(se,"A",{class:!0,href:!0,"data-svelte-h":!0}),re(n)!=="svelte-km4jns"&&(n.textContent=r),a=O(se),o=k(se,"DIV",{class:!0});var H=T(o);i=k(H,"BUTTON",{class:!0});var te=T(i);Ee(c.$$.fragment,te),te.forEach(m),H.forEach(m),se.forEach(m),d=O(W),u=k(W,"DIV",{class:!0});var ie=T(u);_=k(ie,"BUTTON",{class:!0,"data-svelte-h":!0}),re(_)!=="svelte-f34gar"&&(_.textContent=g),ie.forEach(m),p=O(W),v=k(W,"SECTION",{class:!0});var be=T(v);Ee(L.$$.fragment,be),y=O(be),Ee(E.$$.fragment,be),A=O(be),Ee(C.$$.fragment,be),U=O(be),P=k(be,"DIV",{class:!0});var ae=T(P);Ee(B.$$.fragment,ae),j=O(ae),Ee(I.$$.fragment,ae),ae.forEach(m),be.forEach(m),D=O(W),Q.block.l(W),S=O(W),w=k(W,"SECTION",{class:!0});var de=T(w);Ee(N.$$.fragment,de),R=O(de),Ee(K.$$.fragment,de),de.forEach(m),this.h()},h(){h(e,"name","description"),h(e,"content","App to practise music notation, scales and chords using MIDI"),h(n,"class","hover:underline"),h(n,"href","https://github.com/TeemuKoivisto/midi-note-trainer"),h(i,"class","rounded p-2 hover:bg-gray-200"),h(o,"class","flex items-center justify-center"),h(l,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight flex items-center justify-between"),h(_,"class","btn-pill border-2 border-gray-300 hover:bg-gray-200"),h(u,"class","px-4 md:px-0"),h(P,"class","play svelte-qjpqy3"),h(v,"class","mx-4 md:mx-0"),h(w,"class","mb-8 ml-16 flex flex-col")},m(W,G){f(document.head,e),M(W,t,G),M(W,l,G),f(l,n),f(l,a),f(l,o),f(o,i),we(c,i,null),M(W,d,G),M(W,u,G),f(u,_),M(W,p,G),M(W,v,G),we(L,v,null),f(v,y),we(E,v,null),f(v,A),we(C,v,null),f(v,U),f(v,P),we(B,P,null),f(P,j),we(I,P,null),M(W,D,G),Q.block.m(W,Q.anchor=G),Q.mount=()=>S.parentNode,Q.anchor=S,M(W,S,G),M(W,w,G),we(N,w,null),f(w,R),we(K,w,null),F=!0,ne||(me=[q(i,"click",s[5]),q(_,"click",s[6])],ne=!0)},p(W,[G]){s=W;const se={};G&1&&(se.debounced=!!s[0]),N.$set(se);const H={};G&2&&(H.game=s[1]),K.$set(H)},i(W){F||(x(c.$$.fragment,W),x(L.$$.fragment,W),x(E.$$.fragment,W),x(C.$$.fragment,W),x(B.$$.fragment,W),x(I.$$.fragment,W),x(Q.block),x(N.$$.fragment,W),x(K.$$.fragment,W),F=!0)},o(W){J(c.$$.fragment,W),J(L.$$.fragment,W),J(E.$$.fragment,W),J(C.$$.fragment,W),J(B.$$.fragment,W),J(I.$$.fragment,W);for(let G=0;G<3;G+=1){const se=Q.blocks[G];J(se)}J(N.$$.fragment,W),J(K.$$.fragment,W),F=!1},d(W){W&&(m(t),m(l),m(d),m(u),m(p),m(v),m(D),m(S),m(w)),m(e),Ce(c),Ce(L),Ce(E),Ce(C),Ce(B),Ce(I),Q.block.d(W),Q.token=null,Q=null,Ce(N),Ce(K),ne=!1,Ye(me)}}}function Hr(s,e,t){let l,n,r,a,o,i;_e(s,dt,B=>t(9,l=B)),_e(s,wt,B=>t(1,n=B)),_e(s,mt,B=>t(10,r=B)),_e(s,at,B=>t(11,a=B)),_e(s,nt,B=>t(12,o=B)),_e(s,Ts,B=>t(13,i=B));let c,d;mn(()=>(i&&C(),window.addEventListener("keydown",u),window.addEventListener("mousedown",u),window.addEventListener("touchstart",u),()=>{window.removeEventListener("keydown",u),window.removeEventListener("mousedown",u),window.removeEventListener("touchstart",u)})),cs.subscribe(B=>{B&&B.channels[1].addListener("noteon",_)});function u(){je.initAudio(),window.removeEventListener("keydown",u),window.removeEventListener("mousedown",u),window.removeEventListener("touchstart",u)}function _(B){if(c)return;const j=B.rawData;g(j[1],j[2])}function g(B,j){const I=n;I instanceof jt&&!(I!=null&&I.ended)&&l==="waiting"?L(B):I instanceof ht&&!(I!=null&&I.ended)&&l==="waiting"?(I.addPlayedNote(B),d||(d=setTimeout(v,2e3))):I||Le.pushPlayed(B),o&&o.noteOn(B,a.fixedVelocity??j)}function p(){r.autoplay&&r.waitSeconds>0?t(0,c=setTimeout(()=>{r.autoplay&&De.nextGuess(),t(0,c=void 0)},r.waitSeconds*1e3)):r.autoplay?De.nextGuess():t(0,c=void 0)}function v(){var j;const B=n;if(B instanceof ht){const I=B.guess();Le.setPlayed(((j=B.latestGuess.guessed)==null?void 0:j.notes)||[],I,-1),De.updateState(I?"correct":"wrong"),p()}d=void 0}function L(B){const j=n;if(j instanceof jt&&l==="waiting"){Le.setTarget([Le.getNote(j.current)]);const I=j.guess(B);De.updateState(I?"correct":"wrong"),Le.pushPlayed(B,I,4e3),p()}}function y(B){const j=n;if(j instanceof ht&&l==="waiting"){const I=j.guessWrittenChord(B.detail);De.updateState(I?"correct":"wrong"),p()}}function E(B){const j=n;if(j instanceof Rt&&l==="waiting"){const I=B.detail.replaceAll("♭","b").replaceAll("♯","#"),D=j.guess(I);De.updateState(D?"correct":"wrong"),p()}}function A(B){const j=ft.findNote(B.detail.note)??Os(B.detail.note);j&&g(j.semitones+12+B.detail.octave*12,80)}async function C(){const B=await je.openMidi();"data"in B?B.data.name:(B.err,console.error(B.err))}function U(){na(),window.location.reload()}return[c,n,y,E,A,U,()=>jn.open("introduction",void 0)]}class $r extends We{constructor(e){super(),qe(this,e,Hr,xr,Je,{})}}export{ll as F,ht as G,$r as P,xn as S,jt as a,De as b,wt as c,yt as d,is as e,dt as g,nt as p,Gt as s,rl as t};
