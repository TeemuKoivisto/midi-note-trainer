import{_ as te}from"./preload-helper.a4192956.js";import{R as ye,Q as Nt,T as Be,U as hn,S as He,i as ze,s as qe,O as rt,V as le,e as p,m as P,H as _e,a as v,b as S,n as Z,d as _,o as j,I as pe,f as h,L as q,W as Ie,g as R,h as u,J as ve,p as $,t as F,C as st,w as lt,l as W,K as ge,X as Pe,Y as it,M as oe,N as Ee,P as we,z as J,A as Y,B as re,v as je,q as fe,c as Hl,u as zl,j as ql,k as Wl,Z as Ns,_ as $t,F as mn,$ as Ls,a0 as Ds,a1 as ps,r as Jl,a2 as Qe,a3 as _n,a4 as Wt,a5 as pn,a6 as vn,G as gn}from"./vendor_svelte.464dccef.js";import{w as Ht,b as bn,c as yn,e as Ps,f as js,g as Yl,h as Jt,i as Yt,a as Vs,j as cs}from"./vendor.1acf520b.js";const Os={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Fe(l,e=0,t=0){return{interval:`${l}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:l,semitones:Ql(l,e,t),flats:e,sharps:t}}function Ql(l,e,t){return(l<8?Os[l]:Os[l%7])-e+t+Math.floor(l/8)*12}function Xl(l){let e,t=0,s=0;l<0?(t=1+Math.floor(-l/100),e=-l%100):l>100?(s=Math.floor(l/100),e=l%100):e=l;const n=Ql(e,t,s);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(s)}`,interval_seq:e,semitones:n,flats:t,sharps:s}}const kn=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let rs=[];function Zl(){return kn.map(l=>{const e=l[3].map(Xl);return{suffixes:l[0],name:l[1][0],type:l[2],intervals:e}})}function Dt(l){rs.length===0&&(rs=Zl());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return rs.find(t=>t.suffixes.find(s=>s===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function En(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const r=(l.semitones+e)%12;return{...l,semitones:r<0?r+12:r,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function us(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const r=t[n],a=l+r.semitones,i=e.scaleNotes.find(m=>m.semitones===a%12),o=r.flats>0,c=r.sharps>0,f=(o?a+1:c?a-1:a)%12,d=o?-1:c?1:0;s.push(En(i??e.notesMap.get(f),i?0:d,a))}return s}const Bs=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],wn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],Gs=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Cn(l){let e=0,t=0;for(let s=0;s<Bs.length;s+=1){const n=l.find(a=>a.note.slice(0,2)===Bs[s]),r=l.find(a=>a.note.slice(0,2)===wn[s]);if(n)e+=1;else if(r)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:Gs.get(e*-1)}:{flats:0,sharps:t,majorSignature:Gs.get(t)}}function An(l){return l>=9?`${l>=10?"X":""}${l===9?"IX":"I".repeat(l%10)}`:`${l>=5?"V":""}${l===4?"IV":"I".repeat(l%5)}`}function en(l){return l.map(e=>{const t=[Fe(1)];let s;return e.major?(t.push(Fe(3)),e.suffix.startsWith("+")?t.push(Fe(5,0,1)):e.suffix.startsWith("6")?t.push(Fe(6)):e.suffix.startsWith("7")?t.push(Fe(7,1)):e.suffix.startsWith("maj7")?t.push(Fe(7)):s=Dt("maj")):e.minor?(t.push(Fe(3,1)),e.suffix.startsWith("°")?t.push(Fe(5,1)):e.suffix.startsWith("6")?(t.push(Fe(6)),s=Dt("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Fe(7,1)),s=Dt("m"+e.suffix)):s=Dt("m")):e.suffix.startsWith("sus2")?t.push(Fe(2)):e.suffix.startsWith("sus4")&&t.push(Fe(4)),t.length<=2&&t.push(Fe(5)),t.length<=2&&t.push(Fe(8)),s||(s=Dt(e.suffix)),{...s,intervals:t}})}function Tn(l,e){let t=e.has(4)&&e.has(7),s=e.has(3)&&e.has(7);const n=An(l);let r="";return t||s||(e.has(3)&&e.has(6)?(r="°",s=!0):e.has(4)&&e.has(8)?(r="+",t=!0):e.has(3)&&e.has(10)?(s=!0,r="7"):e.has(4)&&e.has(10)?(r="7",t=!0):e.has(4)&&e.has(11)?(r="maj7",t=!0):e.has(3)&&e.has(8)?(r="6",s=!0):e.has(4)&&e.has(9)?(r="6",t=!0):e.has(2)?r="sus2":e.has(5)?r="sus4":e.has(7)?r="5":r="?"),{degree:l,roman:s?n.toLowerCase():n,suffix:r,major:t,minor:s,semitones:e}}function In(l){const e=l.length;return l.map((t,s)=>{const n=t.semitones,r=new Set;for(let a=1;a<e;a+=1){const i=l[(s+a)%e].semitones,o=i<=n?i+12-n:i-n;r.add(o)}return Tn(t.interval_seq,r)})}const Sn=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let is=[];function vs(){return Sn.map(l=>{const e=l[0],t=l[1].map(Xl),s=In(t);return{names:e,intervals:t,triads:s}})}function Nn(l){is.length===0&&(is=vs());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return is.find(t=>t.names.find(s=>s.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const Ln=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,Dn=/^[0-9]$/,et=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function tn(l){return l===12?1:Math.floor((l-12)/12)}function Xe(l){return`${l.note}${tn(l.midi)}`}function Tt(l){const t=(l-12)%12;return{...et[t],semitones:t,midi:l}}function Pn(l,e=!0,t=!1){if(e&&!Ln.test(l))return{err:`Unrecognized note "${l}"`,code:400};const s=l.trim(),n=s.charAt(0).toUpperCase(),r=et.find(d=>d.note.charAt(0)===n&&d.note.length===1);if(!r)return{err:`Unable to find note ${s}`,code:500};const a=s.slice(1).split("").reduce((d,m)=>d+(m.toLowerCase()==="b"||m==="♭"?-1:m==="#"||m==="♯"?1:0),0);let i;if(Dn.test(s.charAt(s.length-1)))try{i=parseInt(s.charAt(s.length-1),10)}catch{}if(t&&i===void 0)return{err:`No octave provided: ${l}`,code:400};i===void 0&&(i=0);let o=(r.semitones+a)%12;o=o<0?o+12:o;const c=a<0?-a:0,f=a>0?a:0;return{data:{note:`${n}${"♭".repeat(c)}${"♯".repeat(f)}`,semitones:o,midi:12+i*12+o,flats:c,sharps:f}}}function sn(l){const e=et.find(t=>t.note.charAt(0)===l.charAt(0)&&t.note.length===1);if(e){const t=l.slice(1).split("").reduce((n,r)=>n+(r.toLowerCase()==="b"||r==="♭"?-1:r==="#"||r==="♯"?1:0),0),s=(e.semitones+t)%12;return{note:l,semitones:s<0?s+12:s,flats:t<0?-t:0,sharps:t>0?t:0}}}const jn=/^[a-gA-G][♭b#♯]?$/,os="ABCDEFG";function Vn(l,e){return e.map(t=>os.charAt((os.indexOf(l)+t.interval_seq-1)%os.length))}function On(l,e,t){return t.map((s,n)=>{const r=e[n],a=(l+s.semitones)%12,i=et[a],o=i.note.charAt(0);if(o<r&&(o!=="A"||r!=="G")||o==="G"&&r==="A"){let c=1,f=et[(a+c)%12];for(;f.note.charAt(0)!==r;)c+=1,f=et[(a+c)%12];return{semitones:a,note:f.note+"♭".repeat(c),flats:c+(f.note.includes("♭")?1:0),sharps:0}}else if(o>r||o==="A"&&r==="G"){let c=1,f=a===0?et.length-1:a-c,d=et[f];for(;d.note.charAt(0)!==r;)c+=1,f=f===0?et.length-1:f-1,d=et[f];return{semitones:a,note:d.note+"♯".repeat(c),flats:0,sharps:c+(d.note.includes("♯")?1:0)}}else return{semitones:a,note:i.note,flats:i.flats,sharps:i.sharps}})}function Qt(l,e){if(!jn.test(l))return{err:`Unknown key: ${l}`,code:400};const t=Nn(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const s=`${l.charAt(0).toUpperCase()}${l.charAt(1).replace("b","♭").replace("#","♯")}`,n=sn(s);if(!n)return{err:`Unable to find root for note: ${s}`,code:404};const r=Vn(s.charAt(0),t.intervals),a=On(n.semitones,r,t.intervals),i=new Map(et.map(o=>{const c=a.find(f=>f.semitones===o.semitones);return c?[o.semitones,c]:[o.semitones,{...o}]}));return{data:{key:s,scale:t.names[0],names:t.names,...Cn(a),intervals:t.intervals.map(o=>({...o})),triads:t.triads.map(o=>({...o})),scaleNotes:a,notesMap:i}}}const fs=new Map;function Bn(l,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(l)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function Gn(l,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(l)),{data:void 0}}catch(s){return{err:`Failed to store the value: ${s}`,code:400}}}function ht(l,e){const{key:t,storage:s="local",namespace:n="default"}=e,r=Bn(t,s),a=ye(l);"data"in r?l.set(e.deserialize?e.deserialize(r.data):r.data):"err"in r&&(e!=null&&e.debug)&&console.info(r.err);const i=l.subscribe(c=>{const f=Gn(e.serialize?e.serialize(c):c,t,s);"err"in f&&(e!=null&&e.debug)&&console.error(f.err)}),o=fs.get(n);return o?o.push({key:t,storage:s,value:l,defaultValue:a,unsubscribe:i}):fs.set(n,[{key:t,storage:s,value:l,defaultValue:a,unsubscribe:i}]),l}function Mn(l=["default"],e){l.forEach(t=>{var s;(s=fs.get(t))==null||s.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function Un(l,e){const t=await fetch(l);if(!t.ok)return{err:t.statusText,code:t.status};const s=await t.arrayBuffer();return{data:await e.decodeAudioData(s)}}async function Rn(l,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],s=await Promise.all(t.map(r=>Un(`${l}${r}`,e))),n=[];return s.forEach(r=>{"err"in r?console.error(`Failed to load audio: ${r.err}`):n.push(r.data)}),n}class Kn{constructor(e,t,s,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(s),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(s))}on(e,t,s,n,r,a,i,o){this.noteA.buffer=e,this.noteA.playbackRate.value=s,this.biquadFilter.frequency.value=r,this.gainA.gain.value=a,this.gain.gain.value=o,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=i,this.noteB.start(0)),this.noteA.start(0)}off(e,t,s){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(s),this.noteB.stop(s),(n=this.damp)==null||n.start(0)}}class xn{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,s)=>{this.bufferlists.push(t),s===8?this.damper=t:s===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(s=>{this.noteOn(s,t)})}noteOn(e,t=80){if(e<109&&e>20){const s=this.notes.get(e);s&&(s.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),r=n+1,a=n*12+21,i=2**((e-69)/12)*440,o=t/127;let c=i*(2-(e-21)/50)+3*i*o;e<60&&(c=440*(3-(60-21)/50)+3*i*o);const f=1-(e%12/12+1)/12,d=Math.pow(2,(e-a)/12),m=0,b=0,g=o**1.4,T=new Kn(e,this.context,this.directGain,this.damper);T.on(this.bufferlists[n],this.bufferlists[r],d,m,c,f,b,g),this.notes.set(e,T)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const Fn="/midi-note-trainer/",ds=ht(Be(!1),{key:"midi-access"}),Xt=Be(void 0),gs=ht(Be([60,84]),{key:"midi-range",storage:"session"}),Zt=Nt(gs,l=>[Tt(l[0]),Tt(l[1])]),Ms=Be(void 0),tt=Be(void 0),nt=ht(Be({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),$e={async openMidi(){return Ht.enable().then(()=>(ds.set(!0),Ht.inputs.length>0?(Xt.set(Ht.inputs[0]),{data:Ht.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(l=>({err:l.toString(),code:403}))},disableMidi(){ds.set(!1),Xt.set(void 0)},setMidiRange(l){gs.set(l)},setInputValue(l,e){nt.update(t=>({...t,[l]:e})),l==="useSound"&&!e?tt.set(void 0):l==="useSound"&&!ye(tt)&&this.initAudio()},async initAudio(){let l=ye(Ms);if(l||(l=new AudioContext,Ms.set(l)),!ye(tt)){const e=new xn(l),t=await Rn(`${Fn}audio`,l);e.load(t),tt.set(e)}}};let Ze;hn({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}});const kt=Be(["C","Major"]),St=Nt(kt,l=>{const e=Qt(l[0],l[1]);return"data"in e?e.data:{key:l[0],scale:l[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),Us=Be([]),gt=Be([]);function hs(l,e){if(l.length>0){const t=Date.now();let s=t;const n=l.filter(r=>(r.started+e>t&&(s=Math.min(s,r.started)),r.started+e>t));return!Ze&&n.length>0&&(Ze=setTimeout(()=>{Ze=void 0,gt.update(r=>hs(r,e))},e-(t-s)+100)),n}return l}const me={setKey(l){kt.update(e=>[l,e[1]])},setScale(l){kt.update(e=>[e[0],l])},setKeyAndScale(l,e){kt.set([l,e])},setTarget(l=[]){Us.set(l)},getNote(l){return{...ye(St).notesMap.get(l%12),midi:l}},pushPlayed(l,e,t){const n={...ye(St).notesMap.get(l%12),midi:l},r=Date.now(),a=e===void 0?"default":e?"correct":"wrong";if(gt.update(i=>{const o=i.findIndex(c=>c.midi===l);return o>=0&&i.splice(o,1),[...i,{...n,color:a,started:r}]}),!Ze&&t!==-1){const i=t??ye(nt).keyFadeTimeout;Ze=setTimeout(()=>{Ze=void 0,gt.update(o=>hs(o,i))},i)}},setPlayed(l,e,t){const s=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(gt.update(r=>[...l.map(a=>({...a,color:n,started:s}))]),!Ze&&t!==-1){const r=t??ye(nt).keyFadeTimeout;Ze=setTimeout(()=>{Ze=void 0,gt.update(a=>hs(a,r))},r)}},clearPlayed(){gt.set([]),clearTimeout(Ze),Ze=void 0},clearScore(l=!1){l&&kt.set(["C","Major"]),Us.set([]),gt.set([])}};class bs{constructor(e,t,s){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=s;const n=[],{count:r}=s,a=t.map(o=>typeof o=="object"&&o!==null?{...o}:o);let i=s.duplicates;!s.duplicates&&r>a.length&&(console.warn(`Trying to create game with count ${r} larger than available unique values ${t.length}`),i=!0);for(let o=0;o<r;o+=1){const c=Math.floor(Math.random()*a.length);if(i)n.push(a[c]);else{const f=a.splice(c,1);f.length>0&&n.push(f[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function $n(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const r=(l.semitones+e)%12;return{...l,semitones:r<0?r+12:r,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function Hn(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const r=t[n],a=l+r.semitones,i=e.scaleNotes.find(m=>m.semitones===a%12),o=r.flats>0,c=r.sharps>0,f=(o?a+1:c?a-1:a)%12,d=o?-1:c?1:0;s.push($n(i??e.notesMap.get(f),i?0:d,a))}return s}const zn=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function qn(l){const t=(l-12)%12;return{...zn[t],semitones:t,midi:l}}function Wn(l){return`${l.note.trim().charAt(0).toUpperCase()}${"♭".repeat(l.flats)}${"♯".repeat(l.sharps)}`}class ft extends bs{constructor(e,t,s){const n=t.range[0],r=t.range[1],a=new Set(t.scale.scaleNotes.map(o=>o.semitones)),i=s.chords.flatMap(o=>{const c=[],f=o.intervals.reduce((d,m)=>m.semitones>d?m.semitones:d,0);for(let d=n;d<=r-f;d+=1)if((!s.onlyScale||a.has(d%12))&&(!o.allowed||o.allowed.has(d%12))){const m=Hn(d,t.scale,o.intervals);c.push({...o,rootNote:m[0].note,chord:`${m[0].note}${o.suffixes[0]}`,notes:m})}return c});super(e,i,t),this.played=new Set,this.opts=s}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${Wn(e)}${e.chord.toLowerCase()}`,notes:[]},s=this.current.chord===t.chord;return this.addGuessed(t,s)}guess(){const e=Array.from(this.played.values()).map(n=>qn(n)).sort((n,r)=>n.midi-r.midi);this.played.clear();const t={chord:"",notes:e},s=this.current.notes.every(n=>e.find(r=>r.midi%12===n.midi%12));return this.addGuessed(t,s)}}const Jn={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class Pt extends bs{constructor(e,t){const s=e==="keys-major"?"major":"minor";super(e,Object.keys(Jn[s]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class It extends bs{constructor(e,t){const s=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-s+1)).map((r,a)=>s+a),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const ln={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},bt=Be("waiting"),dt=ht(Be(ln),{key:"game-options"}),yt=Be(void 0),ys=Be(Zl().map(l=>({...l,selected:!0}))),ke={play(...[l,e]){var o,c,f;let t;const s=ye(St),n=ye(gs),r=ye(dt),a={scale:s,range:n,duplicates:r.duplicates,count:r.count};let i=[s.key,s.scale];if(l==="notes")t=new It(l,a),me.setTarget([me.getNote(t.current)]),(o=ye(tt))==null||o.noteOn(t.current);else if(l==="pitches")t=new It(l,a),me.setTarget(),$e.setInputValue("useSound",!0),(c=ye(tt))==null||c.noteOn(t.current);else if(l==="keys-major"||l=="keys-minor")t=new Pt(l,a),i=[t.current,l==="keys-major"?"major":"minor"];else if(l==="chords-play"||l==="chords-write")t=new ft(l,a,e);else if(l==="chords-diatonic"){const d=en(s.triads).map((m,b)=>({...m,allowed:new Set([s.scaleNotes[b].semitones])}));t=new ft(l,a,{chords:d})}else throw Error("Unknown game type: "+l);return typeof t.current!="number"&&typeof t.current!="string"&&((f=ye(tt))==null||f.playChord(t.current.notes.map(d=>d.midi)),me.setTarget(t.current.notes)),me.setKeyAndScale(i[0],i[1]),me.clearPlayed(),bt.set("waiting"),yt.set(t),t},updateState(l){bt.set(l)},setOptionValue(l,e){dt.update(t=>({...t,[l]:e}))},toggleChords(l){ys.update(e=>e.map(t=>({...t,selected:l(t)})))},nextGuess(){var e,t;const l=ye(yt);l!=null&&l.ended?bt.set("ended"):l instanceof It?(l.type==="notes"?me.setTarget([me.getNote(l.current)]):me.setTarget(),me.clearPlayed(),(e=ye(tt))==null||e.noteOn(l.current),ke.updateState("waiting"),l.startTime()):l instanceof ft?(me.setTarget(l.current.notes),me.clearPlayed(),(t=ye(tt))==null||t.playChord(l==null?void 0:l.current.notes.map(s=>s.midi)),bt.set("waiting"),l.startTime()):l instanceof Pt&&(me.setKey(l.current),bt.set("waiting"),l.startTime())},clearGame(l=!1){const e=ye(yt);e&&me.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),l&&dt.set(ln),yt.set(void 0),bt.set("waiting"),me.clearScore()}};function Rs(l,e,t){const s=l.slice();return s[25]=e[t],s[27]=t,s}function Ks(l,e,t){const s=l.slice();return s[30]=e[t],s}function xs(l,e,t){const s=l.slice();return s[8]=e[t],s}function Fs(l,e,t){const s=l.slice();return s[25]=e[t],s[27]=t,s}function $s(l,e,t){const s=l.slice();return s[30]=e[t],s}function Hs(l,e,t){const s=l.slice();return s[8]=e[t],s}function Yn(l){let e,t=le(l[25].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=zs($s(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=je()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);R(n,e,r)},p(n,r){if(r[0]&64){t=le(n[25].intervals);let a;for(a=0;a<t.length;a+=1){const i=$s(n,t,a);s[a]?s[a].p(i,r):(s[a]=zs(i),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function Qn(l){let e,t=le(l[2][l[27]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=qs(Hs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=je()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);R(n,e,r)},p(n,r){if(r[0]&4){t=le(n[2][n[27]]);let a;for(a=0;a<t.length;a+=1){const i=Hs(n,t,a);s[a]?s[a].p(i,r):(s[a]=qs(i),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function zs(l){let e,t=l[30].interval+"",s;return{c(){e=p("span"),s=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r[0]&64&&t!==(t=n[30].interval+"")&&re(s,t)},d(n){n&&_(e)}}}function qs(l){let e,t=l[8].note+"",s;return{c(){e=p("span"),s=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r[0]&4&&t!==(t=n[8].note+"")&&re(s,t)},d(n){n&&_(e)}}}function Ws(l){let e,t,s,n,r,a,i=l[25].suffixes[0]+"",o,c,f,d,m,b,g=l[25].name+"",T,y,D,O;n=new rt({props:{icon:l[25].selected?Jt:Yt,width:12}});function V(){return l[21](l[25])}function E(L,M){return L[2][L[27]]&&L[2][L[27]].length>0?Qn:Yn}let N=E(l),I=N(l);return{c(){e=p("li"),t=p("button"),s=p("span"),_e(n.$$.fragment),r=P(),a=p("div"),o=J(i),c=P(),f=p("li"),I.c(),m=P(),b=p("li"),T=J(g),this.h()},l(L){e=v(L,"LI",{});var M=S(e);t=v(M,"BUTTON",{class:!0});var w=S(t);s=v(w,"SPAN",{class:!0});var G=S(s);pe(n.$$.fragment,G),G.forEach(_),r=j(w),a=v(w,"DIV",{class:!0});var C=S(a);o=Y(C,i),C.forEach(_),w.forEach(_),M.forEach(_),c=j(L),f=v(L,"LI",{class:!0,title:!0});var k=S(f);I.l(k),k.forEach(_),m=j(L),b=v(L,"LI",{class:!0});var A=S(b);T=Y(A,g),A.forEach(_),this.h()},h(){h(s,"class","px-1 py-1 rounded"),q(s,"text-green-500",l[25].selected),q(s,"text-gray-400",!l[25].selected),h(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),h(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),q(t,"hidden",l[7]),h(f,"class","intervals svelte-1j99daw"),h(f,"title",d=l[25].intervals.map(Zs).join("-")),h(b,"class","text-xs")},m(L,M){R(L,e,M),u(e,t),u(t,s),ve(n,s,null),u(t,r),u(t,a),u(a,o),R(L,c,M),R(L,f,M),I.m(f,null),R(L,m,M),R(L,b,M),u(b,T),y=!0,D||(O=$(t,"click",V),D=!0)},p(L,M){l=L;const w={};M[0]&64&&(w.icon=l[25].selected?Jt:Yt),n.$set(w),(!y||M[0]&64)&&q(s,"text-green-500",l[25].selected),(!y||M[0]&64)&&q(s,"text-gray-400",!l[25].selected),(!y||M[0]&64)&&i!==(i=l[25].suffixes[0]+"")&&re(o,i),(!y||M[0]&128)&&q(t,"hidden",l[7]),N===(N=E(l))&&I?I.p(l,M):(I.d(1),I=N(l),I&&(I.c(),I.m(f,null))),(!y||M[0]&64&&d!==(d=l[25].intervals.map(Zs).join("-")))&&h(f,"title",d),(!y||M[0]&64)&&g!==(g=l[25].name+"")&&re(T,g)},i(L){y||(F(n.$$.fragment,L),y=!0)},o(L){W(n.$$.fragment,L),y=!1},d(L){L&&(_(e),_(c),_(f),_(m),_(b)),ge(n),I.d(),D=!1,O()}}}function Xn(l){let e,t=le(l[25].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Js(Ks(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=je()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);R(n,e,r)},p(n,r){if(r[0]&32){t=le(n[25].intervals);let a;for(a=0;a<t.length;a+=1){const i=Ks(n,t,a);s[a]?s[a].p(i,r):(s[a]=Js(i),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function Zn(l){let e,t=le(l[3][l[27]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ys(xs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=je()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);R(n,e,r)},p(n,r){if(r[0]&8){t=le(n[3][n[27]]);let a;for(a=0;a<t.length;a+=1){const i=xs(n,t,a);s[a]?s[a].p(i,r):(s[a]=Ys(i),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function Js(l){let e,t=l[30].interval+"",s;return{c(){e=p("span"),s=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r[0]&32&&t!==(t=n[30].interval+"")&&re(s,t)},d(n){n&&_(e)}}}function Ys(l){let e,t=l[8].note+"",s;return{c(){e=p("span"),s=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r[0]&8&&t!==(t=n[8].note+"")&&re(s,t)},d(n){n&&_(e)}}}function Qs(l){let e,t,s,n,r,a,i=l[25].suffixes[0]+"",o,c,f,d,m,b,g=l[25].name+"",T,y,D,O;n=new rt({props:{icon:l[25].selected?Jt:Yt,width:12}});function V(){return l[22](l[25])}function E(L,M){return L[3][L[27]]&&L[3][L[27]].length>0?Zn:Xn}let N=E(l),I=N(l);return{c(){e=p("li"),t=p("button"),s=p("span"),_e(n.$$.fragment),r=P(),a=p("div"),o=J(i),c=P(),f=p("li"),I.c(),m=P(),b=p("li"),T=J(g),this.h()},l(L){e=v(L,"LI",{});var M=S(e);t=v(M,"BUTTON",{class:!0});var w=S(t);s=v(w,"SPAN",{class:!0});var G=S(s);pe(n.$$.fragment,G),G.forEach(_),r=j(w),a=v(w,"DIV",{class:!0});var C=S(a);o=Y(C,i),C.forEach(_),w.forEach(_),M.forEach(_),c=j(L),f=v(L,"LI",{class:!0,title:!0});var k=S(f);I.l(k),k.forEach(_),m=j(L),b=v(L,"LI",{class:!0});var A=S(b);T=Y(A,g),A.forEach(_),this.h()},h(){h(s,"class","px-1 py-1 rounded"),q(s,"text-green-500",l[25].selected),q(s,"text-gray-400",!l[25].selected),h(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),h(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),q(t,"hidden",l[7]),h(f,"class","intervals svelte-1j99daw"),h(f,"title",d=l[25].intervals.map(el).join("-")),h(b,"class","text-xs")},m(L,M){R(L,e,M),u(e,t),u(t,s),ve(n,s,null),u(t,r),u(t,a),u(a,o),R(L,c,M),R(L,f,M),I.m(f,null),R(L,m,M),R(L,b,M),u(b,T),y=!0,D||(O=$(t,"click",V),D=!0)},p(L,M){l=L;const w={};M[0]&32&&(w.icon=l[25].selected?Jt:Yt),n.$set(w),(!y||M[0]&32)&&q(s,"text-green-500",l[25].selected),(!y||M[0]&32)&&q(s,"text-gray-400",!l[25].selected),(!y||M[0]&32)&&i!==(i=l[25].suffixes[0]+"")&&re(o,i),(!y||M[0]&128)&&q(t,"hidden",l[7]),N===(N=E(l))&&I?I.p(l,M):(I.d(1),I=N(l),I&&(I.c(),I.m(f,null))),(!y||M[0]&32&&d!==(d=l[25].intervals.map(el).join("-")))&&h(f,"title",d),(!y||M[0]&32)&&g!==(g=l[25].name+"")&&re(T,g)},i(L){y||(F(n.$$.fragment,L),y=!0)},o(L){W(n.$$.fragment,L),y=!1},d(L){L&&(_(e),_(c),_(f),_(m),_(b)),ge(n),I.d(),D=!1,O()}}}function ea(l){let e,t,s,n,r="Chords",a,i,o,c,f,d,m,b,g,T,y,D,O,V,E,N,I,L="Key",M,w,G,C,k="Scale",A,B,U,x,z="Note",ne,se,de,ue,Ne,xe,Ge,be,We,Ke;c=new rt({props:{icon:bn,width:20}}),m=new rt({props:{icon:yn,width:16}}),T=new rt({props:{icon:l[4]?Ps:js,width:16}}),O=new rt({props:{icon:Yl,width:16}});let Le=le(l[6]),ie=[];for(let K=0;K<Le.length;K+=1)ie[K]=Ws(Fs(l,Le,K));const Se=K=>W(ie[K],1,1,()=>{ie[K]=null});let he=le(l[5]),Q=[];for(let K=0;K<he.length;K+=1)Q[K]=Qs(Rs(l,he,K));const ae=K=>W(Q[K],1,1,()=>{Q[K]=null});return{c(){e=p("div"),t=p("fieldset"),s=p("legend"),n=p("button"),n.textContent=r,a=P(),i=p("div"),o=p("button"),_e(c.$$.fragment),f=P(),d=p("button"),_e(m.$$.fragment),b=P(),g=p("button"),_e(T.$$.fragment),y=P(),D=p("button"),_e(O.$$.fragment),V=P(),E=p("div"),N=p("div"),I=p("label"),I.textContent=L,M=P(),w=p("input"),G=P(),C=p("label"),C.textContent=k,A=P(),B=p("input"),U=P(),x=p("label"),x.textContent=z,ne=P(),se=p("input"),de=P(),ue=p("ul");for(let K=0;K<ie.length;K+=1)ie[K].c();Ne=P(),xe=p("ul");for(let K=0;K<Q.length;K+=1)Q[K].c();this.h()},l(K){e=v(K,"DIV",{class:!0});var X=S(e);t=v(X,"FIELDSET",{class:!0});var ce=S(t);s=v(ce,"LEGEND",{class:!0});var ee=S(s);n=v(ee,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1knqzl6"&&(n.textContent=r),ee.forEach(_),a=j(ce),i=v(ce,"DIV",{class:!0});var Ce=S(i);o=v(Ce,"BUTTON",{class:!0});var Ve=S(o);pe(c.$$.fragment,Ve),Ve.forEach(_),f=j(Ce),d=v(Ce,"BUTTON",{class:!0});var at=S(d);pe(m.$$.fragment,at),at.forEach(_),b=j(Ce),g=v(Ce,"BUTTON",{class:!0});var Je=S(g);pe(T.$$.fragment,Je),Je.forEach(_),y=j(Ce),D=v(Ce,"BUTTON",{class:!0});var Me=S(D);pe(O.$$.fragment,Me),Me.forEach(_),Ce.forEach(_),V=j(ce),E=v(ce,"DIV",{class:!0});var De=S(E);N=v(De,"DIV",{class:!0});var Ae=S(N);I=v(Ae,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(I)!=="svelte-14m38zf"&&(I.textContent=L),M=j(Ae),w=v(Ae,"INPUT",{class:!0,id:!0}),G=j(Ae),C=v(Ae,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(C)!=="svelte-bxhcb0"&&(C.textContent=k),A=j(Ae),B=v(Ae,"INPUT",{class:!0,id:!0}),U=j(Ae),x=v(Ae,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(x)!=="svelte-dmbfli"&&(x.textContent=z),ne=j(Ae),se=v(Ae,"INPUT",{class:!0,id:!0}),Ae.forEach(_),de=j(De),ue=v(De,"UL",{class:!0});var Lt=S(ue);for(let Ue=0;Ue<ie.length;Ue+=1)ie[Ue].l(Lt);Lt.forEach(_),Ne=j(De),xe=v(De,"UL",{class:!0});var Et=S(xe);for(let Ue=0;Ue<Q.length;Ue+=1)Q[Ue].l(Et);Et.forEach(_),De.forEach(_),ce.forEach(_),X.forEach(_),this.h()},h(){h(n,"class","px-1 rounded hover:bg-gray-100"),h(s,"class","text-base"),h(o,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),q(o,"hidden",l[7]),h(d,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),q(d,"hidden",l[7]),h(g,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),q(g,"hidden",l[7]),h(D,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),q(D,"hidden",l[7]),h(i,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),h(I,"class","mr-4 font-bold svelte-1j99daw"),h(I,"for","scale-key"),h(w,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(w,"id","scale-key"),w.value=l[0],h(C,"class","font-bold svelte-1j99daw"),h(C,"for","scale-key"),h(B,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(B,"id","scale-key"),B.value="Major",B.disabled=!0,h(x,"class","font-bold svelte-1j99daw"),h(x,"for","scale-key"),h(se,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(se,"id","scale-key"),se.value=l[1],h(N,"class","flex mb-2 input svelte-1j99daw"),h(ue,"class","chord-list w-full svelte-1j99daw"),h(xe,"class","chord-list w-full svelte-1j99daw"),h(E,"class","body svelte-1j99daw"),q(E,"hidden",l[7]),h(t,"class","flex flex-col relative rounded border-2 px-4 py-2 my-4 text-sm svelte-1j99daw"),q(t,"collapsed",l[7]),h(e,"class",Ge=Ie(`${l[18].class||""}`)+" svelte-1j99daw")},m(K,X){R(K,e,X),u(e,t),u(t,s),u(s,n),u(t,a),u(t,i),u(i,o),ve(c,o,null),u(i,f),u(i,d),ve(m,d,null),u(i,b),u(i,g),ve(T,g,null),u(i,y),u(i,D),ve(O,D,null),u(t,V),u(t,E),u(E,N),u(N,I),u(N,M),u(N,w),u(N,G),u(N,C),u(N,A),u(N,B),u(N,U),u(N,x),u(N,ne),u(N,se),u(E,de),u(E,ue);for(let ce=0;ce<ie.length;ce+=1)ie[ce]&&ie[ce].m(ue,null);u(E,Ne),u(E,xe);for(let ce=0;ce<Q.length;ce+=1)Q[ce]&&Q[ce].m(xe,null);be=!0,We||(Ke=[$(n,"click",l[10]),$(o,"click",l[14]),$(d,"click",l[15]),$(g,"click",l[16]),$(D,"click",l[17]),$(w,"input",l[11]),$(se,"input",l[12])],We=!0)},p(K,X){(!be||X[0]&128)&&q(o,"hidden",K[7]),(!be||X[0]&128)&&q(d,"hidden",K[7]);const ce={};if(X[0]&16&&(ce.icon=K[4]?Ps:js),T.$set(ce),(!be||X[0]&128)&&q(g,"hidden",K[7]),(!be||X[0]&128)&&q(D,"hidden",K[7]),(!be||X[0]&1&&w.value!==K[0])&&(w.value=K[0]),(!be||X[0]&2&&se.value!==K[1])&&(se.value=K[1]),X[0]&8388){Le=le(K[6]);let ee;for(ee=0;ee<Le.length;ee+=1){const Ce=Fs(K,Le,ee);ie[ee]?(ie[ee].p(Ce,X),F(ie[ee],1)):(ie[ee]=Ws(Ce),ie[ee].c(),F(ie[ee],1),ie[ee].m(ue,null))}for(st(),ee=Le.length;ee<ie.length;ee+=1)Se(ee);lt()}if(X[0]&8360){he=le(K[5]);let ee;for(ee=0;ee<he.length;ee+=1){const Ce=Rs(K,he,ee);Q[ee]?(Q[ee].p(Ce,X),F(Q[ee],1)):(Q[ee]=Qs(Ce),Q[ee].c(),F(Q[ee],1),Q[ee].m(xe,null))}for(st(),ee=he.length;ee<Q.length;ee+=1)ae(ee);lt()}(!be||X[0]&128)&&q(E,"hidden",K[7]),(!be||X[0]&128)&&q(t,"collapsed",K[7]),(!be||X[0]&262144&&Ge!==(Ge=Ie(`${K[18].class||""}`)+" svelte-1j99daw"))&&h(e,"class",Ge)},i(K){if(!be){F(c.$$.fragment,K),F(m.$$.fragment,K),F(T.$$.fragment,K),F(O.$$.fragment,K);for(let X=0;X<Le.length;X+=1)F(ie[X]);for(let X=0;X<he.length;X+=1)F(Q[X]);be=!0}},o(K){W(c.$$.fragment,K),W(m.$$.fragment,K),W(T.$$.fragment,K),W(O.$$.fragment,K),ie=ie.filter(Boolean);for(let X=0;X<ie.length;X+=1)W(ie[X]);Q=Q.filter(Boolean);for(let X=0;X<Q.length;X+=1)W(Q[X]);be=!1},d(K){K&&_(e),ge(c),ge(m),ge(T),ge(O),Pe(ie,K),Pe(Q,K),We=!1,it(Ke)}}}let Xs="Major";const Zs=l=>l.interval,el=l=>l.interval;function ta(l,e,t){let s,n,r,a,i,o;oe(l,ys,C=>t(20,i=C));let c="C",f=Qt(c,Xs),d="",m,b=[],g=[];const T=ht(Be(!0),{key:"chords-hidden"});oe(l,T,C=>t(7,o=C));function y(){T.update(C=>!C)}function D(){const C=m&&60+m.semitones;if("err"in f||!C)t(2,b=[]),t(3,g=[]);else{const k=f.data;t(2,b=n.map(A=>us(C,k,A.intervals))),t(3,g=r.map(A=>us(C,k,A.intervals)))}}function O({currentTarget:{value:C}}){t(0,c=`${C.charAt(0).toUpperCase()}${C.charAt(1).toLowerCase()}`),f=Qt(c,Xs),D()}function V({currentTarget:{value:C}}){t(1,d=`${C.charAt(0).toUpperCase()}${C.charAt(1).toLowerCase()}`),t(8,m=sn(d)),D()}function E(C){ke.toggleChords(k=>k.name===C.name?!k.selected:k.selected)}function N(){const C=A=>A.suffixes[0]==="maj"||A.suffixes[0]==="m",k=i.filter(C).every(A=>A.selected);ke.toggleChords(A=>C(A)?!k:A.selected)}function I(){const C=A=>A.suffixes[0]==="maj7"||A.suffixes[0]==="m7"||A.suffixes[0]==="7"||A.suffixes[0]==="dim7"||A.suffixes[0]==="aug7",k=i.filter(C).every(A=>A.selected);ke.toggleChords(A=>C(A)?!k:A.selected)}function L(){ke.toggleChords(C=>!a)}function M(){ke.toggleChords(C=>!0)}const w=C=>E(C),G=C=>E(C);return l.$$set=C=>{t(18,e=Ee(Ee({},e),we(C)))},l.$$.update=()=>{l.$$.dirty[0]&1048576&&t(19,s=i),l.$$.dirty[0]&524288&&t(6,n=s.filter((C,k)=>k<s.length/2)),l.$$.dirty[0]&524288&&t(5,r=s.filter((C,k)=>k>=s.length/2)),l.$$.dirty[0]&524288&&t(4,a=s.every(C=>C.selected))},e=we(e),[c,d,b,g,a,r,n,o,m,T,y,O,V,E,N,I,L,M,e,s,i,w,G]}class sa extends He{constructor(e){super(),ze(this,e,ta,ea,qe,{},null,[-1,-1])}}function tl(l,e,t){const s=l.slice();return s[10]=e[t],s}function la(l){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,s){R(t,e,s)},p:fe,d(t){t&&_(e)}}}function na(l){let e,t,s="Played:",n,r=le(l[2]),a=[];for(let i=0;i<r.length;i+=1)a[i]=sl(tl(l,r,i));return{c(){e=p("div"),t=p("span"),t.textContent=s,n=P();for(let i=0;i<a.length;i+=1)a[i].c()},l(i){e=v(i,"DIV",{});var o=S(e);t=v(o,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1g6xxhn"&&(t.textContent=s),n=j(o);for(let c=0;c<a.length;c+=1)a[c].l(o);o.forEach(_)},m(i,o){R(i,e,o),u(e,t),u(e,n);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(e,null)},p(i,o){if(o&4){r=le(i[2]);let c;for(c=0;c<r.length;c+=1){const f=tl(i,r,c);a[c]?a[c].p(f,o):(a[c]=sl(f),a[c].c(),a[c].m(e,null))}for(;c<a.length;c+=1)a[c].d(1);a.length=r.length}},d(i){i&&_(e),Pe(a,i)}}}function aa(l){let e,t,s="Result:",n,r,a,i=l[0].correct+"",o,c,f=l[0].sampled.length+"",d,m,b,g,T,y=l[0].avgTime+"",D,O;return{c(){e=p("div"),t=p("span"),t.textContent=s,n=P(),r=p("span"),a=J("["),o=J(i),c=J(" / "),d=J(f),m=J("]"),b=P(),g=p("span"),T=J("avg "),D=J(y),O=J("s"),this.h()},l(V){e=v(V,"DIV",{class:!0});var E=S(e);t=v(E,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1eqfbgx"&&(t.textContent=s),n=j(E),r=v(E,"SPAN",{class:!0});var N=S(r);a=Y(N,"["),o=Y(N,i),c=Y(N," / "),d=Y(N,f),m=Y(N,"]"),N.forEach(_),b=j(E),g=v(E,"SPAN",{});var I=S(g);T=Y(I,"avg "),D=Y(I,y),O=Y(I,"s"),I.forEach(_),E.forEach(_),this.h()},h(){h(r,"class","mx-2"),h(e,"class","flex")},m(V,E){R(V,e,E),u(e,t),u(e,n),u(e,r),u(r,a),u(r,o),u(r,c),u(r,d),u(r,m),u(e,b),u(e,g),u(g,T),u(g,D),u(g,O)},p(V,E){E&1&&i!==(i=V[0].correct+"")&&re(o,i),E&1&&f!==(f=V[0].sampled.length+"")&&re(d,f),E&1&&y!==(y=V[0].avgTime+"")&&re(D,y)},d(V){V&&_(e)}}}function ra(l){var L,M,w,G;let e,t,s="Target:",n,r,a=((L=l[0].latestGuess.target)==null?void 0:L.chord)+"",i,o,c,f=((M=l[0].latestGuess.target)==null?void 0:M.notes.map(ll).join(" "))+"",d,m,b,g="Guessed:",T,y,D=((w=l[0].latestGuess.guessed)==null?void 0:w.chord)+"",O,V,E,N=((G=l[0].latestGuess.guessed)==null?void 0:G.notes.map(nl).join(" "))+"",I;return{c(){e=p("div"),t=p("span"),t.textContent=s,n=P(),r=p("span"),i=J(a),o=P(),c=p("span"),d=J(f),m=P(),b=p("span"),b.textContent=g,T=P(),y=p("span"),O=J(D),V=P(),E=p("span"),I=J(N),this.h()},l(C){e=v(C,"DIV",{class:!0});var k=S(e);t=v(k,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=j(k),r=v(k,"SPAN",{});var A=S(r);i=Y(A,a),A.forEach(_),o=j(k),c=v(k,"SPAN",{});var B=S(c);d=Y(B,f),B.forEach(_),m=j(k),b=v(k,"SPAN",{"data-svelte-h":!0}),Z(b)!=="svelte-104368"&&(b.textContent=g),T=j(k),y=v(k,"SPAN",{});var U=S(y);O=Y(U,D),U.forEach(_),V=j(k),E=v(k,"SPAN",{});var x=S(E);I=Y(x,N),x.forEach(_),k.forEach(_),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(C,k){R(C,e,k),u(e,t),u(e,n),u(e,r),u(r,i),u(e,o),u(e,c),u(c,d),u(e,m),u(e,b),u(e,T),u(e,y),u(y,O),u(e,V),u(e,E),u(E,I)},p(C,k){var A,B,U,x;k&1&&a!==(a=((A=C[0].latestGuess.target)==null?void 0:A.chord)+"")&&re(i,a),k&1&&f!==(f=((B=C[0].latestGuess.target)==null?void 0:B.notes.map(ll).join(" "))+"")&&re(d,f),k&1&&D!==(D=((U=C[0].latestGuess.guessed)==null?void 0:U.chord)+"")&&re(O,D),k&1&&N!==(N=((x=C[0].latestGuess.guessed)==null?void 0:x.notes.map(nl).join(" "))+"")&&re(I,N)},d(C){C&&_(e)}}}function ia(l){let e,t,s="Target:",n,r,a=l[0].latestGuess.target+"",i,o,c,f,d,m="Guessed:",b,g,T=l[0].latestGuess.guessed+"",y,D,O;return{c(){e=p("div"),t=p("span"),t.textContent=s,n=P(),r=p("span"),i=J(a),o=P(),c=p("span"),f=P(),d=p("span"),d.textContent=m,b=P(),g=p("span"),y=J(T),D=P(),O=p("span"),this.h()},l(V){e=v(V,"DIV",{class:!0});var E=S(e);t=v(E,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=j(E),r=v(E,"SPAN",{});var N=S(r);i=Y(N,a),N.forEach(_),o=j(E),c=v(E,"SPAN",{}),S(c).forEach(_),f=j(E),d=v(E,"SPAN",{"data-svelte-h":!0}),Z(d)!=="svelte-104368"&&(d.textContent=m),b=j(E),g=v(E,"SPAN",{});var I=S(g);y=Y(I,T),I.forEach(_),D=j(E),O=v(E,"SPAN",{}),S(O).forEach(_),E.forEach(_),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(V,E){R(V,e,E),u(e,t),u(e,n),u(e,r),u(r,i),u(e,o),u(e,c),u(e,f),u(e,d),u(e,b),u(e,g),u(g,y),u(e,D),u(e,O)},p(V,E){E&1&&a!==(a=V[0].latestGuess.target+"")&&re(i,a),E&1&&T!==(T=V[0].latestGuess.guessed+"")&&re(y,T)},d(V){V&&_(e)}}}function oa(l){let e,t,s="Target:",n,r,a=Xe(Tt(l[0].latestGuess.target||0))+"",i,o,c,f,d,m="Guessed:",b,g,T=Xe(Tt(l[0].latestGuess.guessed||0))+"",y,D,O;return{c(){e=p("div"),t=p("span"),t.textContent=s,n=P(),r=p("span"),i=J(a),o=P(),c=p("span"),f=P(),d=p("span"),d.textContent=m,b=P(),g=p("span"),y=J(T),D=P(),O=p("span"),this.h()},l(V){e=v(V,"DIV",{class:!0});var E=S(e);t=v(E,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=j(E),r=v(E,"SPAN",{});var N=S(r);i=Y(N,a),N.forEach(_),o=j(E),c=v(E,"SPAN",{}),S(c).forEach(_),f=j(E),d=v(E,"SPAN",{"data-svelte-h":!0}),Z(d)!=="svelte-104368"&&(d.textContent=m),b=j(E),g=v(E,"SPAN",{});var I=S(g);y=Y(I,T),I.forEach(_),D=j(E),O=v(E,"SPAN",{}),S(O).forEach(_),E.forEach(_),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(V,E){R(V,e,E),u(e,t),u(e,n),u(e,r),u(r,i),u(e,o),u(e,c),u(e,f),u(e,d),u(e,b),u(e,g),u(g,y),u(e,D),u(e,O)},p(V,E){E&1&&a!==(a=Xe(Tt(V[0].latestGuess.target||0))+"")&&re(i,a),E&1&&T!==(T=Xe(Tt(V[0].latestGuess.guessed||0))+"")&&re(y,T)},d(V){V&&_(e)}}}function sl(l){let e,t=Xe(l[10])+"",s;return{c(){e=p("span"),s=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"class","mx-1")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r&4&&t!==(t=Xe(n[10])+"")&&re(s,t)},d(n){n&&_(e)}}}function ca(l){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,s){R(t,e,s)},p:fe,d(t){t&&_(e)}}}function ua(l){let e,t="Next",s,n,r="Autoplay",a,i;return{c(){e=p("button"),e.textContent=t,s=P(),n=p("button"),n.textContent=r,this.h()},l(o){e=v(o,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1nvnoba"&&(e.textContent=t),s=j(o),n=v(o,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1cfj1sl"&&(n.textContent=r),this.h()},h(){h(e,"class","btn primary"),h(n,"class","btn primary")},m(o,c){R(o,e,c),R(o,s,c),R(o,n,c),a||(i=[$(e,"click",l[4]),$(n,"click",l[5])],a=!0)},p:fe,d(o){o&&(_(e),_(s),_(n)),a=!1,it(i)}}}function fa(l){let e,t="Stop autoplay",s,n;return{c(){e=p("button"),e.textContent=t,this.h()},l(r){e=v(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){h(e,"class","btn primary")},m(r,a){R(r,e,a),s||(n=$(e,"click",l[9]),s=!0)},p:fe,d(r){r&&_(e),s=!1,n()}}}function da(l){let e,t="Try Again",s,n,r="Clear",a,i;return{c(){e=p("button"),e.textContent=t,s=P(),n=p("button"),n.textContent=r,this.h()},l(o){e=v(o,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-y911ux"&&(e.textContent=t),s=j(o),n=v(o,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-11mnk9v"&&(n.textContent=r),this.h()},h(){h(e,"class","btn primary"),h(n,"class","btn primary")},m(o,c){R(o,e,c),R(o,s,c),R(o,n,c),a||(i=[$(e,"click",l[6]),$(n,"click",l[7])],a=!0)},p:fe,d(o){o&&(_(e),_(s),_(n)),a=!1,it(i)}}}function ha(l){let e,t,s,n;function r(d,m){return d[0]instanceof It&&(d[1]==="correct"||d[1]==="wrong")?oa:d[0]instanceof Pt&&(d[1]==="correct"||d[1]==="wrong")?ia:d[0]instanceof ft&&(d[1]==="correct"||d[1]==="wrong")?ra:d[0]&&d[1]==="ended"?aa:d[2].length>0?na:la}let a=r(l),i=a(l);function o(d,m){return d[0]&&d[1]==="ended"?da:d[0]&&d[3].autoplay?fa:d[0]?ua:ca}let c=o(l),f=c(l);return{c(){e=p("div"),i.c(),s=P(),n=p("div"),f.c(),this.h()},l(d){e=v(d,"DIV",{class:!0});var m=S(e);i.l(m),m.forEach(_),s=j(d),n=v(d,"DIV",{class:!0});var b=S(n);f.l(b),b.forEach(_),this.h()},h(){h(e,"class",t=Ie(`${l[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),h(n,"class","mt-2 h-8")},m(d,m){R(d,e,m),i.m(e,null),R(d,s,m),R(d,n,m),f.m(n,null)},p(d,[m]){a===(a=r(d))&&i?i.p(d,m):(i.d(1),i=a(d),i&&(i.c(),i.m(e,null))),m&256&&t!==(t=Ie(`${d[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs")&&h(e,"class",t),c===(c=o(d))&&f?f.p(d,m):(f.d(1),f=c(d),f&&(f.c(),f.m(n,null)))},i:fe,o:fe,d(d){d&&(_(e),_(s),_(n)),i.d(),f.d()}}}const ll=l=>l.note,nl=l=>l.note;function ma(l,e,t){let s,n,r;oe(l,bt,m=>t(1,s=m)),oe(l,gt,m=>t(2,n=m)),oe(l,dt,m=>t(3,r=m));let{game:a}=e;function i(){ke.nextGuess()}function o(){ke.setOptionValue("autoplay",!0),ke.nextGuess()}function c(){a instanceof ft?ke.play(a.type,a.opts):a&&ke.play(a.type,void 0)}function f(){ke.clearGame()}const d=()=>ke.setOptionValue("autoplay",!1);return l.$$set=m=>{t(8,e=Ee(Ee({},e),we(m))),"game"in m&&t(0,a=m.game)},e=we(e),[a,s,n,r,i,o,c,f,e,d]}class _a extends He{constructor(e){super(),ze(this,e,ma,ha,qe,{game:0})}}function al(l,e,t){const s=l.slice();return s[14]=e[t].key,s[15]=e[t].value,s[16]=e[t].icon,s[18]=t,s}const pa=l=>({}),rl=l=>({}),va=l=>({}),il=l=>({});function ol(l){let e,t,s,n,r,a,i,o,c,f;const d=l[11].header,m=Hl(d,l,l[10],rl);let b=le(l[0]),g=[];for(let y=0;y<b.length;y+=1)g[y]=cl(al(l,b,y));const T=y=>W(g[y],1,1,()=>{g[y]=null});return{c(){e=p("button"),s=P(),n=p("ul"),r=p("li"),m&&m.c(),a=P();for(let y=0;y<g.length;y+=1)g[y].c();this.h()},l(y){e=v(y,"BUTTON",{class:!0,tabindex:!0}),S(e).forEach(_),s=j(y),n=v(y,"UL",{class:!0});var D=S(n);r=v(D,"LI",{});var O=S(r);m&&m.l(O),O.forEach(_),a=j(D);for(let V=0;V<g.length;V+=1)g[V].l(D);D.forEach(_),this.h()},h(){h(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),h(e,"tabindex","-1"),h(n,"class","items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl svelte-h65upg")},m(y,D){R(y,e,D),R(y,s,D),R(y,n,D),u(n,r),m&&m.m(r,null),u(n,a);for(let O=0;O<g.length;O+=1)g[O]&&g[O].m(n,null);o=!0,c||(f=$(e,"click",l[6]),c=!0)},p(y,D){if(l=y,m&&m.p&&(!o||D&1024)&&zl(m,d,l,l[10],o?Wl(d,l[10],D,pa):ql(l[10]),rl),D&133){b=le(l[0]);let O;for(O=0;O<b.length;O+=1){const V=al(l,b,O);g[O]?(g[O].p(V,D),F(g[O],1)):(g[O]=cl(V),g[O].c(),F(g[O],1),g[O].m(n,null))}for(st(),O=b.length;O<g.length;O+=1)T(O);lt()}},i(y){if(!o){y&&Ns(()=>{o&&(t||(t=$t(e,Ls,{duration:zt},!0)),t.run(1))}),F(m,y);for(let D=0;D<b.length;D+=1)F(g[D]);y&&Ns(()=>{o&&(i||(i=$t(n,Ds,{duration:zt},!0)),i.run(1))}),o=!0}},o(y){y&&(t||(t=$t(e,Ls,{duration:zt},!1)),t.run(0)),W(m,y),g=g.filter(Boolean);for(let D=0;D<g.length;D+=1)W(g[D]);y&&(i||(i=$t(n,Ds,{duration:zt},!1)),i.run(0)),o=!1},d(y){y&&(_(e),_(s),_(n)),y&&t&&t.end(),m&&m.d(y),Pe(g,y),y&&i&&i.end(),c=!1,f()}}}function ga(l){let e;return{c(){e=p("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),S(e).forEach(_),this.h()},h(){h(e,"class","w-[24px]")},m(t,s){R(t,e,s)},p:fe,i:fe,o:fe,d(t){t&&_(e)}}}function ba(l){let e,t;return e=new rt({props:{class:"mr-2",icon:l[16],width:16}}),{c(){_e(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,n){ve(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.icon=s[16]),e.$set(r)},i(s){t||(F(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){ge(e,s)}}}function cl(l){let e,t,s,n,r,a,i=l[15]+"",o,c,f,d,m;const b=[ba,ga],g=[];function T(D,O){return D[16]?0:1}s=T(l),n=g[s]=b[s](l);function y(){return l[12](l[14])}return{c(){e=p("li"),t=p("button"),n.c(),r=P(),a=p("div"),o=J(i),c=P(),this.h()},l(D){e=v(D,"LI",{});var O=S(e);t=v(O,"BUTTON",{class:!0});var V=S(t);n.l(V),r=j(V),a=v(V,"DIV",{});var E=S(a);o=Y(E,i),E.forEach(_),V.forEach(_),c=j(O),O.forEach(_),this.h()},h(){h(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),q(t,"selected",l[14]===l[2])},m(D,O){R(D,e,O),u(e,t),g[s].m(t,null),u(t,r),u(t,a),u(a,o),u(e,c),f=!0,d||(m=$(t,"click",y),d=!0)},p(D,O){l=D;let V=s;s=T(l),s===V?g[s].p(l,O):(st(),W(g[V],1,1,()=>{g[V]=null}),lt(),n=g[s],n?n.p(l,O):(n=g[s]=b[s](l),n.c()),F(n,1),n.m(t,r)),(!f||O&1)&&i!==(i=l[15]+"")&&re(o,i),(!f||O&5)&&q(t,"selected",l[14]===l[2])},i(D){f||(F(n),f=!0)},o(D){W(n),f=!1},d(D){D&&_(e),g[s].d(),d=!1,m()}}}function ya(l){let e,t,s,n,r,a,i,o;const c=l[11].value,f=Hl(c,l,l[10],il);let d=l[5]&&ol(l);return{c(){e=p("div"),t=p("button"),f&&f.c(),r=P(),d&&d.c(),this.h()},l(m){e=v(m,"DIV",{class:!0,id:!0});var b=S(e);t=v(b,"BUTTON",{class:!0,title:!0});var g=S(t);f&&f.l(g),g.forEach(_),r=j(b),d&&d.l(b),b.forEach(_),this.h()},h(){h(t,"class",s=Ie(`${l[8].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),h(t,"title",n=l[8].title||""),q(t,"disabled",l[3]),q(t,"open",l[5]),h(e,"class","relative"),h(e,"id",l[1])},m(m,b){R(m,e,b),u(e,t),f&&f.m(t,null),u(e,r),d&&d.m(e,null),l[13](e),a=!0,i||(o=$(t,"click",l[6]),i=!0)},p(m,[b]){f&&f.p&&(!a||b&1024)&&zl(f,c,m,m[10],a?Wl(c,m[10],b,va):ql(m[10]),il),(!a||b&256&&s!==(s=Ie(`${m[8].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&h(t,"class",s),(!a||b&256&&n!==(n=m[8].title||""))&&h(t,"title",n),(!a||b&264)&&q(t,"disabled",m[3]),(!a||b&288)&&q(t,"open",m[5]),m[5]?d?(d.p(m,b),b&32&&F(d,1)):(d=ol(m),d.c(),F(d,1),d.m(e,null)):d&&(st(),W(d,1,1,()=>{d=null}),lt()),(!a||b&2)&&h(e,"id",m[1])},i(m){a||(F(f,m),F(d),a=!0)},o(m){W(f,m),W(d),a=!1},d(m){m&&_(e),f&&f.d(m),d&&d.d(),l[13](null),i=!1,o()}}}const zt=400;function ka(l,e,t){let{$$slots:s={},$$scope:n}=e,{options:r,id:a=void 0,selected:i=void 0,disabled:o=void 0,onSelect:c}=e,f,d=!1;function m(){o||t(5,d=!d)}function b(y){t(5,d=c(y))}const g=y=>b(y);function T(y){mn[y?"unshift":"push"](()=>{f=y,t(4,f)})}return l.$$set=y=>{t(8,e=Ee(Ee({},e),we(y))),"options"in y&&t(0,r=y.options),"id"in y&&t(1,a=y.id),"selected"in y&&t(2,i=y.selected),"disabled"in y&&t(3,o=y.disabled),"onSelect"in y&&t(9,c=y.onSelect),"$$scope"in y&&t(10,n=y.$$scope)},e=we(e),[r,a,i,o,f,d,m,b,e,c,n,s,g,T]}class nn extends He{constructor(e){super(),ze(this,e,ka,ya,qe,{options:0,id:1,selected:2,disabled:3,onSelect:9})}}function ul(l){let e;return{c(){e=p("li"),this.h()},l(t){e=v(t,"LI",{class:!0}),S(e).forEach(_),this.h()},h(){h(e,"class","m-[0.175rem] mr-0")},m(t,s){R(t,e,s)},d(t){t&&_(e)}}}function fl(l){let e;return{c(){e=p("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),S(e).forEach(_),this.h()},h(){h(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-jvhfju")},m(t,s){R(t,e,s)},d(t){t&&_(e)}}}function dl(l){let e,t=l[0].note.note+"",s;return{c(){e=p("div"),s=J(t),this.h()},l(n){e=v(n,"DIV",{class:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"class","absolute top-0 left-0")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r&1&&t!==(t=n[0].note.note+"")&&re(s,t)},d(n){n&&_(e)}}}function Ea(l){let e,t,s,n,r,a,i=l[0].key+"",o,c,f,d,m=l[0].key==="{enter}"&&ul(),b=l[0].key==="{enter}"&&fl(),g=l[0].note&&dl(l);return{c(){m&&m.c(),e=P(),t=p("li"),s=p("button"),b&&b.c(),n=P(),g&&g.c(),r=P(),a=p("div"),o=J(i),this.h()},l(T){m&&m.l(T),e=j(T),t=v(T,"LI",{class:!0});var y=S(t);s=v(y,"BUTTON",{class:!0});var D=S(s);b&&b.l(D),n=j(D),g&&g.l(D),r=j(D),a=v(D,"DIV",{});var O=S(a);o=Y(O,i),O.forEach(_),D.forEach(_),y.forEach(_),this.h()},h(){h(s,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex items-center justify-center svelte-jvhfju"),h(t,"class",c=Ie(`${l[1].class||""} m-[0.175rem] ${hl(l[0].size)}`)+" svelte-jvhfju"),q(t,"enter",l[0].key==="{enter}")},m(T,y){m&&m.m(T,y),R(T,e,y),R(T,t,y),u(t,s),b&&b.m(s,null),u(s,n),g&&g.m(s,null),u(s,r),u(s,a),u(a,o),f||(d=$(s,"click",l[2]),f=!0)},p(T,[y]){T[0].key==="{enter}"?m||(m=ul(),m.c(),m.m(e.parentNode,e)):m&&(m.d(1),m=null),T[0].key==="{enter}"?b||(b=fl(),b.c(),b.m(s,n)):b&&(b.d(1),b=null),T[0].note?g?g.p(T,y):(g=dl(T),g.c(),g.m(s,r)):g&&(g.d(1),g=null),y&1&&i!==(i=T[0].key+"")&&re(o,i),y&3&&c!==(c=Ie(`${T[1].class||""} m-[0.175rem] ${hl(T[0].size)}`)+" svelte-jvhfju")&&h(t,"class",c),y&3&&q(t,"enter",T[0].key==="{enter}")},i:fe,o:fe,d(T){T&&(_(e),_(t)),m&&m.d(T),b&&b.d(),g&&g.d(),f=!1,d()}}}function hl(l){return l&&Number.isInteger(l)?`size-${l}`:l?`size-${Math.floor(l)}-${Math.floor(l*10)-Math.floor(l)*10}`:"size-1"}function wa(l,e,t){let{value:s}=e;function n(r){ps.call(this,l,r)}return l.$$set=r=>{t(1,e=Ee(Ee({},e),we(r))),"value"in r&&t(0,s=r.value)},e=we(e),[s,e,n]}class Ca extends He{constructor(e){super(),ze(this,e,wa,Ea,qe,{value:0})}}const ms={ar:{name:"Arabic",import:te(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:te(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:te(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},as:{name:"Assamese",import:te(()=>import("./assamese-2fg5TKew.e3a11680.js"),[],import.meta.url)},balochi:{name:"Balochi",import:te(()=>import("./balochi-KrgUS2RK.d85c6f1a.js"),[],import.meta.url)},be:{name:"Belarusian",import:te(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:te(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:te(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:te(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:te(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:te(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>Aa)},fa:{name:"Farsi",import:te(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:te(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:te(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:te(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},gilaki:{name:"Gilaki",import:te(()=>import("./gilaki-v742kFIj.beefdad3.js"),[],import.meta.url)},el:{name:"Greek",import:te(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:te(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:te(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:te(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:te(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:te(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},kn:{name:"Kannada",import:te(()=>import("./kannada-1jV6XiS0.41bc3c66.js"),[],import.meta.url)},ku:{name:"Kurdish",import:te(()=>import("./kurdish-eencXZUC.4cb27155.js"),[],import.meta.url)},mk:{name:"Macedonian",import:te(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},ml:{name:"Malayalam",import:te(()=>import("./malayalam-1xjnMslS.610dd1c4.js"),[],import.meta.url)},yo:{name:"Nigerian",import:te(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:te(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:te(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},odia:{name:"Odia",import:te(()=>import("./odia-zrWvkRlA.e8b72abc.js"),[],import.meta.url)},pl:{name:"Polish",import:te(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:te(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:te(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},ru2:{name:"Russian Old",import:te(()=>import("./russianOld-EJwjNEzY.7b3bb226.js"),[],import.meta.url)},sd:{name:"Sindhi",import:te(()=>import("./sindhi-guri82Yy.2a0648bd.js"),[],import.meta.url)},es:{name:"Spanish",import:te(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:te(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:te(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:te(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:te(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:te(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ur:{name:"Urdu",import:te(()=>import("./urdu-NIkHMU4A.9c633ce1.js"),[],import.meta.url)},ur2:{name:"Urdu Standard",import:te(()=>import("./urduStandard-LGkVMfEq.8382df56.js"),[],import.meta.url)},ug:{name:"Uyghur",import:te(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function an(l){if(!("default"in l.layout)||!("shift"in l.layout))throw console.error(l),Error("Invalid layout import");return{default:l.layout.default,shift:l.layout.shift}}async function rn(l=["en"]){let e={code:"en",layout:ms.en,index:99};Object.entries(ms).forEach(([s,n])=>{for(let r=0;r<l.length;r+=1)s===l[r]&&(!e||e.index>r)&&(e={code:s,layout:n,index:r})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:an(t.default)}}const on={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Aa=Object.freeze(Object.defineProperty({__proto__:null,default:on},Symbol.toStringTag,{value:"Module"}));function Ta(l,e){return l[1].forEach((t,s)=>{let n;s===2?n={...e[1]}:s===3?n={...e[3]}:s===5?n={...e[6]}:s===6?n={...e[8]}:s===7?n={...e[10]}:s===9?(n={...e[1]},n.semitones+=12):s===10&&(n={...e[3]},n.semitones+=12),l[1][s].note=n}),l[2].forEach((t,s)=>{let n;s===1?n={...e[0]}:s===2?n={...e[2]}:s===3?n={...e[4]}:s===4?n={...e[5]}:s===5?n={...e[7]}:s===6?n={...e[9]}:s===7?n={...e[11]}:s===8?(n={...e[0]},n.semitones+=12):s===9?(n={...e[2]},n.semitones+=12):s===10?(n={...e[4]},n.semitones+=12):s===11?(n={...e[5]},n.semitones+=12):s===12&&(n={...e[7]},n.semitones+=12),l[2][s].note=n}),l}const qt=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function Ia(l){let e=[];const t=l.default.map((s,n)=>{if(n===0)return s.split(" ").slice(0,14);if(n===1){const r=s.split(" ");return e=r.slice(13),[...r.slice(0,13),"{enter}"]}else{if(n===2)return[...s.split(" ").slice(0,13).filter(r=>r!=="{enter}"),...e].slice(0,13);if(n===3){const r=s.split(" ");return r.length===12?[r[0],"{empty}",...r.slice(1)]:r.slice(0,13)}else return s.split(" ")}});return[t[0].map((s,n)=>({key:s,code:qt[0][n]})),t[1].map((s,n)=>({key:s,code:qt[1][n]})),t[2].map((s,n)=>({key:s,code:qt[2][n]})),t[3].map((s,n)=>({key:s,code:qt[3][n]}))]}class Sa{constructor(e){this.rows=[[],[],[],[]],this.opts={hotkeydRows:"middle-row",layout:{code:"en",name:"English",imported:an(on)},...e},this.setLayout(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}setLayout(e){this.rows=Ia(e)}setNotes(e){if(this.opts.hotkeydRows==="middle-row")this.rows=Ta(this.rows,e);else throw Error("not implemented")}}const ks=/^[a-gA-G]$/,cn=/^[♭Bb#♯sS]$/,Na=/^[0-9]$/;let H="",ut;const La={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Es=ht(Be({layout:La,hotkeydRows:"middle-row"}),{key:"keyboard-options"}),un=Nt([St,Es],([l,e])=>{const t=new Sa(e);return t.setNotes(Array.from(l.notesMap.values())),t}),Da=Nt(un,l=>l.rows.map(e=>e.map((t,s)=>{let n;return t.key==="{bksp}"?n=2:t.key==="{tab}"?n=1.5:t.key==="{enter}"?n=2:t.key==="{lock}"?n=1.75:t.key==="{shift}"&&s===0?n=1.5:t.key==="{shift}"&&(n=2.5),n?{...t,size:n}:t}))),es=Nt(un,l=>new Map([...l.rows[0].map(e=>[e.code,e]),...l.rows[1].map(e=>[e.code,e]),...l.rows[2].map(e=>[e.code,e]),...l.rows[3].map(e=>[e.code,e])])),Pa=Nt(es,l=>Array.from(l.values()).map(e=>e.note).filter(e=>e!==void 0));function ja(l,e){const{useHotkeys:t}=ye(nt),s=ye(es).get(l);if(t&&H.length===0&&s&&s.note)return H="",{e:"guessed-key",data:s.note.note};if(!t&&H.length===0&&ks.test(e))return H+=e.toUpperCase(),{e:"string",data:H};if(!t&&H.length>0&&cn.test(e))return e==="b"||e==="B"?H+="♭":H+="♯",{e:"string",data:H};if(l==="Backspace"&&H.length>0)return H=H.slice(0,-1),{e:"string",data:H};if(l==="Enter"&&H.length>0){const n=H;return H="",{e:"guessed-key",data:n}}return!1}function Va(l,e){if(l==="Enter"&&H.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let s=0;s<H.length;s+=1)s===0?t.note+=H[s]:t.chord.length>0?t.chord+=H[s].toLowerCase():H[s]==="♭"?(t.note+=H[s],t.flats+=1):H[s]==="♯"?(t.note+=H[s],t.sharps+=1):t.chord+=H[s].toLowerCase();return H="",{e:"guessed-chord",data:t}}else{if(l==="Backspace"&&H.length>0)return H=H.slice(0,-1),{e:"string",data:H};if(H.length===0&&ks.test(e))return H+=e.toUpperCase(),{e:"string",data:H};if(H.length>0&&e.length===1)return H.length===1&&(e==="b"||e==="B")?H+="♭":H.length===1&&e==="#"?H+="♯":H+=e,{e:"string",data:H}}return!1}function Oa(l,e,t){const{useAutoOctave:s,useHotkeys:n}=ye(nt);let r;const i=ye(es).get(l),o=(i==null?void 0:i.key)||"";let c=!1;if(!ut&&n&&(i!=null&&i.note)?(ut=i.note,s&&(r=tn(ye(Zt)[0].midi)),c="note"):!n&&H.length===0&&ks.test(e)?(H+=e.toUpperCase(),c="input"):!n&&H.length>0&&cn.test(e)&&(e==="b"||e==="B"?H+="♭":H+="♯",c="input"),Na.test(o))try{r=parseInt(o)}catch{}if(ut&&r!==void 0){const f=ut.semitones+(r+1+(t?1:0))*12;return ut=void 0,{e:"guessed-note",data:f}}else if(H&&r!==void 0){const f=ws.findNote(H),d=f?f.semitones+(r+1)*12:void 0;return ut=void 0,H="",d!==void 0?{e:"guessed-note",data:d}:{e:"string",data:H}}else if(l==="Backspace"&&(ut||H.length>0))return ut=void 0,H=H.slice(0,-1),{e:"string",data:H};return c==="note"?{e:"note",data:ut}:c==="input"?{e:"string",data:H}:!1}const ws={async setLayout(l){const e=await rn([l]);Es.update(t=>({...t,layout:e}))},findNote(l){return ye(Pa).find(e=>{if(e.note.charAt(0)===l.charAt(0)){const t=l.slice(1).split("").reduce((s,n)=>s+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleInput(l,e,t=!1){const s=ye(yt);return s instanceof Pt?ja(l,e.toUpperCase()):s instanceof ft&&s.type==="chords-write"?Va(l,e):ye(nt).useKeyboard?Oa(l,e.toUpperCase(),t):!1}};function ml(l,e,t){const s=l.slice();return s[10]=e[t],s[12]=t,s}function _l(l,e,t){const s=l.slice();return s[13]=e[t],s}function Ba(l){let e,t=l[2].layout.name+"",s;return{c(){e=p("div"),s=J(t),this.h()},l(n){e=v(n,"DIV",{slot:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"slot","value")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r&4&&t!==(t=n[2].layout.name+"")&&re(s,t)},d(n){n&&_(e)}}}function pl(l){let e,t;return e=new Ca({props:{value:l[13]}}),{c(){_e(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,n){ve(e,s,n),t=!0},p(s,n){const r={};n&8&&(r.value=s[13]),e.$set(r)},i(s){t||(F(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){ge(e,s)}}}function vl(l){let e,t,s,n,r=le(l[10]),a=[];for(let o=0;o<r.length;o+=1)a[o]=pl(_l(l,r,o));const i=o=>W(a[o],1,1,()=>{a[o]=null});return{c(){e=p("li"),t=P();for(let o=0;o<a.length;o+=1)a[o].c();s=je(),this.h()},l(o){e=v(o,"LI",{class:!0}),S(e).forEach(_),t=j(o);for(let c=0;c<a.length;c+=1)a[c].l(o);s=je(),this.h()},h(){h(e,"class","col-span-2 svelte-cgcsqn")},m(o,c){R(o,e,c),R(o,t,c);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(o,c);R(o,s,c),n=!0},p(o,c){if(c&8){r=le(o[10]);let f;for(f=0;f<r.length;f+=1){const d=_l(o,r,f);a[f]?(a[f].p(d,c),F(a[f],1)):(a[f]=pl(d),a[f].c(),F(a[f],1),a[f].m(s.parentNode,s))}for(st(),f=r.length;f<a.length;f+=1)i(f);lt()}},i(o){if(!n){for(let c=0;c<r.length;c+=1)F(a[c]);n=!0}},o(o){a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)W(a[c]);n=!1},d(o){o&&(_(e),_(t),_(s)),Pe(a,o)}}}function Ga(l){let e,t,s,n,r="Layout",a,i,o,c,f,d="Middle-row",m,b,g,T,y,D="Two rows",O,V,E,N,I,L,M,w,G;i=new nn({props:{id:"keyboard-lang",class:"p-1",options:l[4],onSelect:l[5],$$slots:{value:[Ba]},$$scope:{ctx:l}}});let C=le(l[3]),k=[];for(let B=0;B<C.length;B+=1)k[B]=vl(ml(l,C,B));const A=B=>W(k[B],1,1,()=>{k[B]=null});return{c(){e=p("div"),t=p("div"),s=p("div"),n=p("label"),n.textContent=r,a=P(),_e(i.$$.fragment),o=P(),c=p("div"),f=p("label"),f.textContent=d,m=P(),b=p("input"),g=P(),T=p("div"),y=p("label"),y.textContent=D,O=P(),V=p("input"),E=P(),N=p("div"),I=p("ul");for(let B=0;B<k.length;B+=1)k[B].c();this.h()},l(B){e=v(B,"DIV",{class:!0});var U=S(e);t=v(U,"DIV",{class:!0});var x=S(t);s=v(x,"DIV",{class:!0});var z=S(s);n=v(z,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1xsr9lq"&&(n.textContent=r),a=j(z),pe(i.$$.fragment,z),z.forEach(_),o=j(x),c=v(x,"DIV",{class:!0});var ne=S(c);f=v(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(f)!=="svelte-1ssbs6o"&&(f.textContent=d),m=j(ne),b=v(ne,"INPUT",{class:!0,id:!0,type:!0}),ne.forEach(_),g=j(x),T=v(x,"DIV",{class:!0});var se=S(T);y=v(se,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(y)!=="svelte-3aw9ul"&&(y.textContent=D),O=j(se),V=v(se,"INPUT",{class:!0,id:!0,type:!0}),se.forEach(_),x.forEach(_),E=j(U),N=v(U,"DIV",{class:!0});var de=S(N);I=v(de,"UL",{class:!0});var ue=S(I);for(let Ne=0;Ne<k.length;Ne+=1)k[Ne].l(ue);ue.forEach(_),de.forEach(_),U.forEach(_),this.h()},h(){h(n,"class","font-bold mr-4"),h(n,"for","middle-row"),h(s,"class","my-1 flex items-center justify-between mr-12"),h(f,"class","font-bold mr-4"),h(f,"for","middle-row"),h(b,"class","h-[20px]"),h(b,"id","middle-row"),h(b,"type","checkbox"),h(c,"class","my-1 flex items-center justify-between mr-12"),h(y,"class","font-bold mr-4"),h(y,"for","two-rows"),h(V,"class","h-[20px]"),h(V,"id","two-rows"),h(V,"type","checkbox"),h(T,"class","my-1 flex items-center justify-between mr-12"),h(t,"class","flex"),h(I,"class","keyboard svelte-cgcsqn"),h(N,"class","flex flex-col gap-1.5"),h(e,"class",L=Ie(`${l[6].class||""} `)+" svelte-cgcsqn")},m(B,U){R(B,e,U),u(e,t),u(t,s),u(s,n),u(s,a),ve(i,s,null),u(t,o),u(t,c),u(c,f),u(c,m),u(c,b),b.checked=l[0],u(t,g),u(t,T),u(T,y),u(T,O),u(T,V),V.checked=l[1],u(e,E),u(e,N),u(N,I);for(let x=0;x<k.length;x+=1)k[x]&&k[x].m(I,null);M=!0,w||(G=[$(b,"change",l[7]),$(V,"change",l[8])],w=!0)},p(B,[U]){const x={};if(U&65540&&(x.$$scope={dirty:U,ctx:B}),i.$set(x),U&1&&(b.checked=B[0]),U&2&&(V.checked=B[1]),U&8){C=le(B[3]);let z;for(z=0;z<C.length;z+=1){const ne=ml(B,C,z);k[z]?(k[z].p(ne,U),F(k[z],1)):(k[z]=vl(ne),k[z].c(),F(k[z],1),k[z].m(I,null))}for(st(),z=C.length;z<k.length;z+=1)A(z);lt()}(!M||U&64&&L!==(L=Ie(`${B[6].class||""} `)+" svelte-cgcsqn"))&&h(e,"class",L)},i(B){if(!M){F(i.$$.fragment,B);for(let U=0;U<C.length;U+=1)F(k[U]);M=!0}},o(B){W(i.$$.fragment,B),k=k.filter(Boolean);for(let U=0;U<k.length;U+=1)W(k[U]);M=!1},d(B){B&&_(e),ge(i),Pe(k,B),w=!1,it(G)}}}function Ma(l,e,t){let s,n,r;oe(l,es,m=>t(9,s=m)),oe(l,Es,m=>t(2,n=m)),oe(l,Da,m=>t(3,r=m)),Jl(async()=>{console.log(s);const m=await rn(["sw"]);console.log(m),window.layout=m});let a=!0,i=!1;const o=Object.entries(ms).map(([m,b])=>({key:m,value:b.name}));function c(m){return console.log("key ",m),ws.setLayout(m),!1}function f(){a=this.checked,t(0,a)}function d(){i=this.checked,t(1,i)}return l.$$set=m=>{t(6,e=Ee(Ee({},e),we(m)))},e=we(e),[a,i,n,r,o,c,e,f,d]}class Ua extends He{constructor(e){super(),ze(this,e,Ma,Ga,qe,{})}}function gl(l){let e,t;return e=new Ua({props:{class:"mt-4"}}),{c(){_e(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,n){ve(e,s,n),t=!0},i(s){t||(F(e.$$.fragment,s),t=!0)},o(s){W(e.$$.fragment,s),t=!1},d(s){ge(e,s)}}}function Ra(l){let e,t,s,n,r="I/O",a,i,o,c,f="Device",d,m,b,g,T,y,D="Prompt",O,V,E="Disable",N,I,L,M,w="Sound",G,C,k,A,B,U,x="Fixed velocity",z,ne,se,de,ue,Ne,xe="Keyboard",Ge,be,We,Ke,Le,ie,Se="Hotkeys",he,Q,ae,K,X,ce,ee="Auto-octave",Ce,Ve,at,Je,Me,De,Ae,Lt="Set hotkeys",Et,Ue,mt,Cs="Fade timeout",ts,ot,ss,_t,jt,ls,pt,As="Reset all",ns,Vt,Ye,as,Ts,Oe=l[2]&&gl();return{c(){e=p("div"),t=p("fieldset"),s=p("legend"),n=p("button"),n.textContent=r,a=P(),i=p("div"),o=p("div"),c=p("label"),c.textContent=f,d=P(),m=p("input"),g=P(),T=p("div"),y=p("button"),y.textContent=D,O=P(),V=p("button"),V.textContent=E,N=P(),I=p("div"),L=p("div"),M=p("label"),M.textContent=w,G=P(),C=p("input"),A=P(),B=p("div"),U=p("label"),U.textContent=x,z=P(),ne=p("input"),se=P(),de=p("div"),ue=p("div"),Ne=p("label"),Ne.textContent=xe,Ge=P(),be=p("input"),Ke=P(),Le=p("div"),ie=p("label"),ie.textContent=Se,he=P(),Q=p("input"),K=P(),X=p("div"),ce=p("label"),ce.textContent=ee,Ce=P(),Ve=p("input"),Je=P(),Me=p("div"),De=p("div"),Ae=p("button"),Ae.textContent=Lt,Et=P(),Ue=p("div"),mt=p("label"),mt.textContent=Cs,ts=P(),ot=p("input"),ss=P(),_t=p("div"),jt=p("div"),ls=P(),pt=p("button"),pt.textContent=As,ns=P(),Oe&&Oe.c(),this.h()},l(Te){e=v(Te,"DIV",{class:!0});var Re=S(e);t=v(Re,"FIELDSET",{class:!0});var ct=S(t);s=v(ct,"LEGEND",{class:!0});var Is=S(s);n=v(Is,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1jbbsti"&&(n.textContent=r),Is.forEach(_),a=j(ct),i=v(ct,"DIV",{class:!0});var vt=S(i);o=v(vt,"DIV",{class:!0});var wt=S(o);c=v(wt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(c)!=="svelte-crpa7y"&&(c.textContent=f),d=j(wt),m=v(wt,"INPUT",{class:!0,id:!0}),g=j(wt),T=v(wt,"DIV",{class:!0});var Ot=S(T);y=v(Ot,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-mj6mct"&&(y.textContent=D),O=j(Ot),V=v(Ot,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(V)!=="svelte-1sl6oxh"&&(V.textContent=E),Ot.forEach(_),wt.forEach(_),N=j(vt),I=v(vt,"DIV",{class:!0});var Bt=S(I);L=v(Bt,"DIV",{class:!0});var Gt=S(L);M=v(Gt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(M)!=="svelte-wgxtkw"&&(M.textContent=w),G=j(Gt),C=v(Gt,"INPUT",{class:!0,id:!0,type:!0}),Gt.forEach(_),A=j(Bt),B=v(Bt,"DIV",{class:!0});var Mt=S(B);U=v(Mt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(U)!=="svelte-1tm2bth"&&(U.textContent=x),z=j(Mt),ne=v(Mt,"INPUT",{class:!0,id:!0,placeholder:!0}),Mt.forEach(_),Bt.forEach(_),se=j(vt),de=v(vt,"DIV",{class:!0});var Ct=S(de);ue=v(Ct,"DIV",{class:!0});var Ut=S(ue);Ne=v(Ut,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(Ne)!=="svelte-1js269u"&&(Ne.textContent=xe),Ge=j(Ut),be=v(Ut,"INPUT",{class:!0,id:!0,type:!0}),Ut.forEach(_),Ke=j(Ct),Le=v(Ct,"DIV",{class:!0});var Rt=S(Le);ie=v(Rt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(ie)!=="svelte-21h39k"&&(ie.textContent=Se),he=j(Rt),Q=v(Rt,"INPUT",{class:!0,id:!0,type:!0}),Rt.forEach(_),K=j(Ct),X=v(Ct,"DIV",{class:!0});var Kt=S(X);ce=v(Kt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(ce)!=="svelte-33lczu"&&(ce.textContent=ee),Ce=j(Kt),Ve=v(Kt,"INPUT",{class:!0,id:!0,type:!0}),Kt.forEach(_),Ct.forEach(_),Je=j(vt),Me=v(vt,"DIV",{class:!0});var At=S(Me);De=v(At,"DIV",{class:!0});var Ss=S(De);Ae=v(Ss,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(Ae)!=="svelte-1v9okg9"&&(Ae.textContent=Lt),Ss.forEach(_),Et=j(At),Ue=v(At,"DIV",{class:!0});var xt=S(Ue);mt=v(xt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(mt)!=="svelte-vd5i27"&&(mt.textContent=Cs),ts=j(xt),ot=v(xt,"INPUT",{class:!0,id:!0}),xt.forEach(_),ss=j(At),_t=v(At,"DIV",{class:!0});var Ft=S(_t);jt=v(Ft,"DIV",{}),S(jt).forEach(_),ls=j(Ft),pt=v(Ft,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(pt)!=="svelte-jjt0c3"&&(pt.textContent=As),Ft.forEach(_),At.forEach(_),vt.forEach(_),ns=j(ct),Oe&&Oe.l(ct),ct.forEach(_),Re.forEach(_),this.h()},h(){var Te;h(n,"class","px-1 rounded hover:bg-gray-100"),h(s,"class","text-base"),h(c,"class","font-bold"),h(c,"for","device"),h(m,"class","px-1 my-1 rounded w-50"),h(m,"id","device"),m.disabled=!0,m.value=b=((Te=l[5])==null?void 0:Te.name)??"No device",h(y,"class","btn-sm primary mr-2"),h(V,"class","btn-sm primary"),h(T,"class","flex my-[auto]"),h(o,"class","h-full flex flex-col"),h(M,"class","font-bold"),h(M,"for","sound"),h(C,"class","h-[20px]"),h(C,"id","sound"),h(C,"type","checkbox"),C.checked=k=l[3].useSound,h(L,"class","my-1 flex justify-between mr-12"),h(U,"class","font-bold"),h(U,"for","fixed-velocity"),h(ne,"class","h-[20px] w-16"),h(ne,"id","fixed-velocity"),h(ne,"placeholder","0-127"),h(B,"class","flex justify-between"),h(I,"class","flex flex-col h-full"),h(Ne,"class","font-bold"),h(Ne,"for","keyboard"),h(be,"class","h-[20px]"),h(be,"id","keyboard"),h(be,"type","checkbox"),be.checked=We=l[3].useKeyboard,h(ue,"class","my-1 flex justify-between mr-12"),h(ie,"class","font-bold"),h(ie,"for","hotkeys"),h(Q,"class","h-[20px]"),h(Q,"id","hotkeys"),h(Q,"type","checkbox"),Q.checked=ae=l[3].useHotkeys,h(Le,"class","my-1 flex justify-between mr-12"),h(ce,"class","font-bold"),h(ce,"for","auto-octave"),h(Ve,"class","h-[20px]"),h(Ve,"id","auto-octave"),h(Ve,"type","checkbox"),Ve.checked=at=l[3].useAutoOctave,h(X,"class","my-1 flex justify-between mr-12"),h(de,"class","flex flex-col h-full"),h(Ae,"class","w-full btn-sm primary"),h(De,"class","flex justify-between"),h(mt,"class","font-bold"),h(mt,"for","fade-timeout"),h(ot,"class","h-[20px] w-16"),h(ot,"id","fade-timeout"),ot.value=l[1],h(Ue,"class","flex justify-between"),h(pt,"class","btn-sm primary"),h(_t,"class","flex justify-between"),h(Me,"class","flex flex-col justify-between h-full"),h(i,"class","body svelte-1bpw69s"),q(i,"hidden",l[4]),h(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-1bpw69s"),q(t,"collapsed",l[4]),h(e,"class",Vt=Ie(`${l[11].class||""}`)+" svelte-1bpw69s")},m(Te,Re){R(Te,e,Re),u(e,t),u(t,s),u(s,n),u(t,a),u(t,i),u(i,o),u(o,c),u(o,d),u(o,m),u(o,g),u(o,T),u(T,y),u(T,O),u(T,V),u(i,N),u(i,I),u(I,L),u(L,M),u(L,G),u(L,C),u(I,A),u(I,B),u(B,U),u(B,z),u(B,ne),Qe(ne,l[0]),u(i,se),u(i,de),u(de,ue),u(ue,Ne),u(ue,Ge),u(ue,be),u(de,Ke),u(de,Le),u(Le,ie),u(Le,he),u(Le,Q),u(de,K),u(de,X),u(X,ce),u(X,Ce),u(X,Ve),u(i,Je),u(i,Me),u(Me,De),u(De,Ae),u(Me,Et),u(Me,Ue),u(Ue,mt),u(Ue,ts),u(Ue,ot),u(Me,ss),u(Me,_t),u(_t,jt),u(_t,ls),u(_t,pt),u(t,ns),Oe&&Oe.m(t,null),Ye=!0,as||(Ts=[$(n,"click",l[7]),$(y,"click",$e.openMidi),$(V,"click",$e.disableMidi),$(C,"change",l[12]),$(ne,"input",l[13]),$(ne,"change",l[8]),$(be,"change",l[14]),$(Q,"change",l[15]),$(Ve,"change",l[16]),$(Ae,"click",l[17]),$(ot,"input",l[9]),$(pt,"click",l[10])],as=!0)},p(Te,[Re]){var ct;(!Ye||Re&32&&b!==(b=((ct=Te[5])==null?void 0:ct.name)??"No device")&&m.value!==b)&&(m.value=b),(!Ye||Re&8&&k!==(k=Te[3].useSound))&&(C.checked=k),Re&1&&ne.value!==Te[0]&&Qe(ne,Te[0]),(!Ye||Re&8&&We!==(We=Te[3].useKeyboard))&&(be.checked=We),(!Ye||Re&8&&ae!==(ae=Te[3].useHotkeys))&&(Q.checked=ae),(!Ye||Re&8&&at!==(at=Te[3].useAutoOctave))&&(Ve.checked=at),(!Ye||Re&2&&ot.value!==Te[1])&&(ot.value=Te[1]),(!Ye||Re&16)&&q(i,"hidden",Te[4]),Te[2]?Oe?Re&4&&F(Oe,1):(Oe=gl(),Oe.c(),F(Oe,1),Oe.m(t,null)):Oe&&(st(),W(Oe,1,1,()=>{Oe=null}),lt()),(!Ye||Re&16)&&q(t,"collapsed",Te[4]),(!Ye||Re&2048&&Vt!==(Vt=Ie(`${Te[11].class||""}`)+" svelte-1bpw69s"))&&h(e,"class",Vt)},i(Te){Ye||(F(Oe),Ye=!0)},o(Te){W(Oe),Ye=!1},d(Te){Te&&_(e),Oe&&Oe.d(),as=!1,it(Ts)}}}function Ka(l,e,t){let s,n,r;oe(l,nt,E=>t(3,s=E)),oe(l,Xt,E=>t(5,r=E));const a=ht(Be(!1),{key:"inputs-hidden"});oe(l,a,E=>t(4,n=E));let i=s.fixedVelocity??"",o=s.keyFadeTimeout,c=!1;nt.subscribe(E=>{t(0,i=E.fixedVelocity??""),t(1,o=E.keyFadeTimeout)});function f(){a.update(E=>!E)}function d(E){const{value:N}=E.currentTarget;let I;if(N)try{I=parseInt(N)}catch{}I!==void 0&&I>=0&&I<=127?$e.setInputValue("fixedVelocity",I):N?t(0,i=s.fixedVelocity||""):$e.setInputValue("fixedVelocity",void 0)}function m(E){try{const N=parseInt(E.currentTarget.value);$e.setInputValue("keyFadeTimeout",N)}catch{t(1,o=s.keyFadeTimeout)}}function b(){Mn()}const g=E=>$e.setInputValue("useSound",E.currentTarget.checked);function T(){i=this.value,t(0,i)}const y=E=>$e.setInputValue("useKeyboard",E.currentTarget.checked),D=E=>$e.setInputValue("useHotkeys",E.currentTarget.checked),O=E=>$e.setInputValue("useAutoOctave",E.currentTarget.checked),V=()=>t(2,c=!c);return l.$$set=E=>{t(11,e=Ee(Ee({},e),we(E)))},e=we(e),[i,o,c,s,n,r,a,f,d,m,b,e,g,T,y,D,O,V]}class xa extends He{constructor(e){super(),ze(this,e,Ka,Ra,qe,{})}}function Fa(l){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,s){R(t,e,s)},p:fe,d(t){t&&_(e)}}}function $a(l){let e,t=l[1].note+"",s;return{c(){e=J("Input: "),s=J(t)},l(n){e=Y(n,"Input: "),s=Y(n,t)},m(n,r){R(n,e,r),R(n,s,r)},p(n,r){r&2&&t!==(t=n[1].note+"")&&re(s,t)},d(n){n&&(_(e),_(s))}}}function Ha(l){let e,t;return{c(){e=J("Input: "),t=J(l[0])},l(s){e=Y(s,"Input: "),t=Y(s,l[0])},m(s,n){R(s,e,n),R(s,t,n)},p(s,n){n&1&&re(t,s[0])},d(s){s&&(_(e),_(t))}}}function za(l){let e;return{c(){e=J(_s)},l(t){e=Y(t,_s)},m(t,s){R(t,e,s)},p:fe,d(t){t&&_(e)}}}function qa(l){let e,t,s,n;function r(o,c){return o[2].useKeyboard&&_s?za:o[2].useKeyboard&&o[0]?Ha:o[2].useKeyboard&&o[1]?$a:Fa}let a=r(l),i=a(l);return{c(){e=p("div"),i.c(),this.h()},l(o){e=v(o,"DIV",{class:!0});var c=S(e);i.l(c),c.forEach(_),this.h()},h(){h(e,"class",t=`${l[4].class||""}`)},m(o,c){R(o,e,c),i.m(e,null),s||(n=$(window,"keydown",l[3]),s=!0)},p(o,[c]){a===(a=r(o))&&i?i.p(o,c):(i.d(1),i=a(o),i&&(i.c(),i.m(e,null))),c&16&&t!==(t=`${o[4].class||""}`)&&h(e,"class",t)},i:fe,o:fe,d(o){o&&_(e),i.d(),s=!1,n()}}}let _s="";function Wa(l,e,t){let s;oe(l,nt,c=>t(2,s=c));let{debounced:n}=e,r="",a;const i=_n();function o(c){const f=c.target;if(n||!(f instanceof HTMLElement)||f.tagName==="INPUT")return;const d=ws.handleInput(c.code,c.key,c.shiftKey);d&&d.e==="note"?t(1,a=d.data):d&&d.e==="string"?t(0,r=d.data):d&&(t(0,r=""),t(1,a=void 0),i(d.e,d.data))}return l.$$set=c=>{t(4,e=Ee(Ee({},e),we(c))),"debounced"in c&&t(5,n=c.debounced)},e=we(e),[r,a,s,o,e,n]}class Ja extends He{constructor(e){super(),ze(this,e,Wa,qa,qe,{debounced:5})}}function Ya(l){let e,t,s,n="Count",r,a,i,o,c,f="Duplicates",d,m,b,g,T,y,D="Autoplay",O,V,E,N,I,L,M="Wait seconds",w,G,C,k,A;return{c(){e=p("ul"),t=p("li"),s=p("label"),s.textContent=n,r=P(),a=p("input"),i=P(),o=p("li"),c=p("label"),c.textContent=f,d=P(),m=p("input"),g=P(),T=p("li"),y=p("label"),y.textContent=D,O=P(),V=p("input"),N=P(),I=p("li"),L=p("label"),L.textContent=M,w=P(),G=p("input"),this.h()},l(B){e=v(B,"UL",{class:!0});var U=S(e);t=v(U,"LI",{class:!0});var x=S(t);s=v(x,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(s)!=="svelte-wgq9fc"&&(s.textContent=n),r=j(x),a=v(x,"INPUT",{class:!0,id:!0,type:!0}),x.forEach(_),i=j(U),o=v(U,"LI",{class:!0});var z=S(o);c=v(z,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(c)!=="svelte-hcg9dq"&&(c.textContent=f),d=j(z),m=v(z,"INPUT",{class:!0,id:!0,type:!0}),z.forEach(_),g=j(U),T=v(U,"LI",{class:!0});var ne=S(T);y=v(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(y)!=="svelte-lr68n2"&&(y.textContent=D),O=j(ne),V=v(ne,"INPUT",{class:!0,id:!0,type:!0}),ne.forEach(_),N=j(U),I=v(U,"LI",{class:!0});var se=S(I);L=v(se,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(L)!=="svelte-1qj2vcy"&&(L.textContent=M),w=j(se),G=v(se,"INPUT",{class:!0,id:!0,type:!0}),se.forEach(_),U.forEach(_),this.h()},h(){h(s,"class","font-bold"),h(s,"for","guess-count"),h(a,"class","h-[20px] w-10"),h(a,"id","guess-count"),h(a,"type","number"),h(t,"class","flex items-center justify-between svelte-1elvih2"),h(c,"class","font-bold"),h(c,"for","duplicates"),h(m,"class","h-[20px]"),h(m,"id","duplicates"),h(m,"type","checkbox"),m.checked=b=l[2].duplicates,h(o,"class","flex items-center justify-between mr-6 svelte-1elvih2"),h(y,"class","font-bold"),h(y,"for","autoplay"),h(V,"class","h-[20px]"),h(V,"id","autoplay"),h(V,"type","checkbox"),V.checked=E=l[2].autoplay,h(T,"class","flex items-center justify-between mr-6 svelte-1elvih2"),h(L,"class","font-bold"),h(L,"for","wait-ms"),h(G,"class","h-[20px] w-10"),h(G,"id","wait-ms"),h(G,"type","number"),h(I,"class","flex items-center justify-between svelte-1elvih2"),h(e,"class",C=Ie(`${l[5].class||""}`)+" svelte-1elvih2")},m(B,U){R(B,e,U),u(e,t),u(t,s),u(t,r),u(t,a),Qe(a,l[0]),u(e,i),u(e,o),u(o,c),u(o,d),u(o,m),u(e,g),u(e,T),u(T,y),u(T,O),u(T,V),u(e,N),u(e,I),u(I,L),u(I,w),u(I,G),Qe(G,l[1]),k||(A=[$(a,"input",l[6]),$(a,"input",l[3]),$(m,"input",l[7]),$(V,"input",l[8]),$(G,"input",l[9]),$(G,"input",l[4])],k=!0)},p(B,[U]){U&1&&Wt(a.value)!==B[0]&&Qe(a,B[0]),U&4&&b!==(b=B[2].duplicates)&&(m.checked=b),U&4&&E!==(E=B[2].autoplay)&&(V.checked=E),U&2&&Wt(G.value)!==B[1]&&Qe(G,B[1]),U&32&&C!==(C=Ie(`${B[5].class||""}`)+" svelte-1elvih2")&&h(e,"class",C)},i:fe,o:fe,d(B){B&&_(e),k=!1,it(A)}}}function Qa(l,e,t){let s;oe(l,dt,m=>t(2,s=m));let n=s.count||"",r=s.waitSeconds||"";dt.subscribe(m=>{t(0,n=m.count||""),t(1,r=m.waitSeconds||"")});function a({currentTarget:{value:m}}){let b;try{b=parseInt(m),b<=0&&(b=1),ke.setOptionValue("count",b)}catch{t(0,n=s.count)}}function i({currentTarget:{value:m}}){let b;try{b=parseInt(m),b<0&&(b=0),ke.setOptionValue("waitSeconds",b)}catch{t(1,r=s.waitSeconds)}}function o(){n=Wt(this.value),t(0,n)}const c=m=>ke.setOptionValue("duplicates",m.currentTarget.checked),f=m=>ke.setOptionValue("autoplay",m.currentTarget.checked);function d(){r=Wt(this.value),t(1,r)}return l.$$set=m=>{t(5,e=Ee(Ee({},e),we(m)))},e=we(e),[n,r,s,a,i,e,o,c,f,d]}class Xa extends He{constructor(e){super(),ze(this,e,Qa,Ya,qe,{})}}function bl(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function yl(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function kl(l){let e,t,s=l[21]+"",n,r,a,i,o,c,f,d;function m(){return l[13](l[20])}i=new rt({props:{icon:cs,width:20}});function b(...g){return l[14](l[20],...g)}return{c(){e=p("li"),t=p("button"),n=J(s),r=P(),a=p("button"),_e(i.$$.fragment),o=P(),this.h()},l(g){e=v(g,"LI",{class:!0});var T=S(e);t=v(T,"BUTTON",{class:!0});var y=S(t);n=Y(y,s),y.forEach(_),r=j(T),a=v(T,"BUTTON",{class:!0});var D=S(a);pe(i.$$.fragment,D),D.forEach(_),o=j(T),T.forEach(_),this.h()},h(){h(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),q(t,"selected",l[20]===l[0]),h(a,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),h(e,"class","flex svelte-1okhpct")},m(g,T){R(g,e,T),u(e,t),u(t,n),u(e,r),u(e,a),ve(i,a,null),u(e,o),c=!0,f||(d=[$(t,"click",m),$(a,"click",b)],f=!0)},p(g,T){l=g,(!c||T&17)&&q(t,"selected",l[20]===l[0])},i(g){c||(F(i.$$.fragment,g),c=!0)},o(g){W(i.$$.fragment,g),c=!1},d(g){g&&_(e),ge(i),f=!1,it(d)}}}function El(l){let e,t=le(l[2]),s=[];for(let n=0;n<t.length;n+=1)s[n]=wl(bl(l,t,n));return{c(){e=p("ul");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=v(n,"UL",{class:!0});var r=S(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(_),this.h()},h(){h(e,"class","svelte-1okhpct")},m(n,r){R(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r&518){t=le(n[2]);let a;for(a=0;a<t.length;a+=1){const i=bl(n,t,a);s[a]?s[a].p(i,r):(s[a]=wl(i),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function wl(l){let e,t,s=l[21]+"",n,r,a,i;function o(){return l[15](l[20])}return{c(){e=p("li"),t=p("button"),n=J(s),r=P(),this.h()},l(c){e=v(c,"LI",{class:!0});var f=S(e);t=v(f,"BUTTON",{class:!0});var d=S(t);n=Y(d,s),d.forEach(_),r=j(f),f.forEach(_),this.h()},h(){h(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),q(t,"selected",l[20]===l[1]),h(e,"class","svelte-1okhpct")},m(c,f){R(c,e,f),u(e,t),u(t,n),u(e,r),a||(i=$(t,"click",o),a=!0)},p(c,f){l=c,f&4&&s!==(s=l[21]+"")&&re(n,s),f&6&&q(t,"selected",l[20]===l[1])},d(c){c&&_(e),a=!1,i()}}}function Za(l){let e,t,s="Play",n,r,a,i,o,c,f,d,m,b,g="Reset",T,y,D,O,V=l[3]?"Quit":"Play",E,N,I,L,M,w=le(l[4]),G=[];for(let A=0;A<w.length;A+=1)G[A]=kl(yl(l,w,A));const C=A=>W(G[A],1,1,()=>{G[A]=null});let k=(l[0]==="chords-write"||l[0]==="chords-play")&&El(l);return f=new Xa({props:{class:"game-options"}}),D=new rt({props:{class:"mr-1",icon:l[3]?Vs:cs,width:20}}),{c(){e=p("fieldset"),t=p("legend"),t.textContent=s,n=P(),r=p("div"),a=p("ul");for(let A=0;A<G.length;A+=1)G[A].c();i=P(),o=p("div"),k&&k.c(),c=P(),_e(f.$$.fragment),d=P(),m=p("div"),b=p("button"),b.textContent=g,T=P(),y=p("button"),_e(D.$$.fragment),O=P(),E=J(V),this.h()},l(A){e=v(A,"FIELDSET",{class:!0});var B=S(e);t=v(B,"LEGEND",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1409tnk"&&(t.textContent=s),n=j(B),r=v(B,"DIV",{class:!0});var U=S(r);a=v(U,"UL",{class:!0});var x=S(a);for(let de=0;de<G.length;de+=1)G[de].l(x);x.forEach(_),i=j(U),o=v(U,"DIV",{class:!0});var z=S(o);k&&k.l(z),z.forEach(_),c=j(U),pe(f.$$.fragment,U),d=j(U),m=v(U,"DIV",{class:!0});var ne=S(m);b=v(ne,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(b)!=="svelte-10rv0bu"&&(b.textContent=g),T=j(ne),y=v(ne,"BUTTON",{class:!0});var se=S(y);pe(D.$$.fragment,se),O=j(se),E=Y(se,V),se.forEach(_),ne.forEach(_),U.forEach(_),B.forEach(_),this.h()},h(){h(t,"class","px-1 text-base"),h(a,"class","games svelte-1okhpct"),h(o,"class","options svelte-1okhpct"),h(b,"class","w-full btn hover:bg-gray-200"),h(y,"class","w-full mt-2 flex items-center justify-center btn primary"),h(m,"class","h-full flex flex-col justify-end"),h(r,"class","body pb-2 h-full svelte-1okhpct"),h(e,"class",N=Ie(`${l[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(A,B){R(A,e,B),u(e,t),u(e,n),u(e,r),u(r,a);for(let U=0;U<G.length;U+=1)G[U]&&G[U].m(a,null);u(r,i),u(r,o),k&&k.m(o,null),u(r,c),ve(f,r,null),u(r,d),u(r,m),u(m,b),u(m,T),u(m,y),ve(D,y,null),u(y,O),u(y,E),I=!0,L||(M=[$(b,"click",l[5]),$(y,"click",l[16])],L=!0)},p(A,[B]){if(B&401){w=le(A[4]);let x;for(x=0;x<w.length;x+=1){const z=yl(A,w,x);G[x]?(G[x].p(z,B),F(G[x],1)):(G[x]=kl(z),G[x].c(),F(G[x],1),G[x].m(a,null))}for(st(),x=w.length;x<G.length;x+=1)C(x);lt()}A[0]==="chords-write"||A[0]==="chords-play"?k?k.p(A,B):(k=El(A),k.c(),k.m(o,null)):k&&(k.d(1),k=null);const U={};B&8&&(U.icon=A[3]?Vs:cs),D.$set(U),(!I||B&8)&&V!==(V=A[3]?"Quit":"Play")&&re(E,V),(!I||B&1024&&N!==(N=Ie(`${A[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&h(e,"class",N)},i(A){if(!I){for(let B=0;B<w.length;B+=1)F(G[B]);F(f.$$.fragment,A),F(D.$$.fragment,A),I=!0}},o(A){G=G.filter(Boolean);for(let B=0;B<G.length;B+=1)W(G[B]);W(f.$$.fragment,A),W(D.$$.fragment,A),I=!1},d(A){A&&_(e),Pe(G,A),k&&k.d(),ge(f),ge(D),L=!1,it(M)}}}function er(l,e,t){let s,n,r,a,i;oe(l,ys,E=>t(12,r=E)),oe(l,dt,E=>t(19,a=E)),oe(l,yt,E=>t(3,i=E));const o=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let c=o[4].key,f="maj-m";a.count,a.waitSeconds,dt.subscribe(E=>{E.count,E.waitSeconds});function d(){ke.clearGame(!0)}function m(E,N){if(N==="chords-write"||N==="chords-play"||N==="chords-diatonic"){let I=[];f==="selected"?I=r.filter(L=>L.selected):f==="all"?I=r:f==="maj-m"?I=r.filter(L=>L.suffixes[0]==="maj"||L.suffixes[0]==="m"):f==="seventh"&&(I=r.filter(L=>L.suffixes[0]==="maj7"||L.suffixes[0]==="m7"||L.suffixes[0]==="7"||L.suffixes[0]==="dim7"||L.suffixes[0]==="aug7")),ke.play(N,{chords:I})}else ke.play(N,void 0);E.currentTarget instanceof HTMLElement&&E.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function b(E){t(0,c=E)}function g(E,N){t(0,c=N),m(E,N)}function T(E){t(1,f=E)}const y=E=>b(E),D=(E,N)=>g(N,E),O=E=>T(E),V=E=>m(E,c);return l.$$set=E=>{t(10,e=Ee(Ee({},e),we(E)))},l.$$.update=()=>{l.$$.dirty&4096&&t(11,s=r.reduce((E,N)=>N.selected?E+1:E,0)),l.$$.dirty&2048&&t(2,n=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${s} chords`},{key:"all",value:"All"}])},e=we(e),[c,f,n,i,o,d,m,b,g,T,e,s,r,y,D,O,V]}class tr extends He{constructor(e){super(),ze(this,e,er,Za,qe,{})}}function Cl(l,e,t){const s=l.slice();return s[7]=e[t],s}function Al(l,e,t){const s=l.slice();return s[4]=e[t],s}function sr(l){let e,t=le(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Tl(Cl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=je()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);R(n,e,r)},p(n,r){if(r&2){t=le(n[1]);let a;for(a=0;a<t.length;a+=1){const i=Cl(n,t,a);s[a]?s[a].p(i,r):(s[a]=Tl(i),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function lr(l){let e,t=le(l[0].scaleNotes||[]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Il(Al(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=je()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);R(n,e,r)},p(n,r){if(r&1){t=le(n[0].scaleNotes||[]);let a;for(a=0;a<t.length;a+=1){const i=Al(n,t,a);s[a]?s[a].p(i,r):(s[a]=Il(i),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function Tl(l){let e,t=l[7].interval+"",s;return{c(){e=p("span"),s=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"class","svelte-my4m0t")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r&2&&t!==(t=n[7].interval+"")&&re(s,t)},d(n){n&&_(e)}}}function Il(l){let e,t=l[4].note+"",s;return{c(){e=p("span"),s=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"class","svelte-my4m0t")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r&1&&t!==(t=n[4].note+"")&&re(s,t)},d(n){n&&_(e)}}}function nr(l){let e,t,s,n,r,a;function i(f,d){return f[0]?lr:sr}let o=i(l),c=o(l);return{c(){e=p("div"),t=p("button"),c.c(),this.h()},l(f){e=v(f,"DIV",{class:!0,title:!0});var d=S(e);t=v(d,"BUTTON",{class:!0});var m=S(t);c.l(m),m.forEach(_),d.forEach(_),this.h()},h(){h(t,"class","intervals svelte-my4m0t"),h(e,"class",s=`${l[2].class||""} `),h(e,"title",n=l[1].map(Sl).join("-"))},m(f,d){R(f,e,d),u(e,t),c.m(t,null),r||(a=$(t,"click",l[3]),r=!0)},p(f,[d]){o===(o=i(f))&&c?c.p(f,d):(c.d(1),c=o(f),c&&(c.c(),c.m(t,null))),d&4&&s!==(s=`${f[2].class||""} `)&&h(e,"class",s),d&2&&n!==(n=f[1].map(Sl).join("-"))&&h(e,"title",n)},i:fe,o:fe,d(f){f&&_(e),c.d(),r=!1,a()}}}const Sl=l=>l.interval;function ar(l,e,t){let{scale:s,intervals:n}=e;function r(a){ps.call(this,l,a)}return l.$$set=a=>{t(2,e=Ee(Ee({},e),we(a))),"scale"in a&&t(0,s=a.scale),"intervals"in a&&t(1,n=a.intervals)},e=we(e),[s,n,e,r]}class fn extends He{constructor(e){super(),ze(this,e,ar,nr,qe,{scale:0,intervals:1})}}function Nl(l,e,t){const s=l.slice();return s[7]=e[t],s}function Ll(l,e,t){const s=l.slice();return s[4]=e[t],s}function rr(l){let e,t=le(l[0]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Dl(Nl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=je()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);R(n,e,r)},p(n,r){if(r&1){t=le(n[0]);let a;for(a=0;a<t.length;a+=1){const i=Nl(n,t,a);s[a]?s[a].p(i,r):(s[a]=Dl(i),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function ir(l){let e,t=le(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Pl(Ll(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=je()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=je()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);R(n,e,r)},p(n,r){if(r&2){t=le(n[1]);let a;for(a=0;a<t.length;a+=1){const i=Ll(n,t,a);s[a]?s[a].p(i,r):(s[a]=Pl(i),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function Dl(l){let e,t,s=l[7].roman+"",n,r,a,i=l[7].suffix+"",o,c;return{c(){e=p("span"),t=p("span"),n=J(s),r=P(),a=p("sup"),o=J(i),c=P(),this.h()},l(f){e=v(f,"SPAN",{class:!0});var d=S(e);t=v(d,"SPAN",{class:!0});var m=S(t);n=Y(m,s),m.forEach(_),r=j(d),a=v(d,"SUP",{class:!0});var b=S(a);o=Y(b,i),b.forEach(_),c=j(d),d.forEach(_),this.h()},h(){h(t,"class","block"),h(a,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),q(a,"super-text",l[7].suffix.length>2),h(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(f,d){R(f,e,d),u(e,t),u(t,n),u(e,r),u(e,a),u(a,o),u(e,c)},p(f,d){d&1&&s!==(s=f[7].roman+"")&&re(n,s),d&1&&i!==(i=f[7].suffix+"")&&re(o,i),d&1&&q(a,"super-text",f[7].suffix.length>2)},d(f){f&&_(e)}}}function Pl(l){let e,t,s=l[4]+"",n,r;return{c(){e=p("span"),t=p("span"),n=J(s),r=P(),this.h()},l(a){e=v(a,"SPAN",{class:!0});var i=S(e);t=v(i,"SPAN",{});var o=S(t);n=Y(o,s),o.forEach(_),r=j(i),i.forEach(_),this.h()},h(){h(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(a,i){R(a,e,i),u(e,t),u(t,n),u(e,r)},p(a,i){i&2&&s!==(s=a[4]+"")&&re(n,s)},d(a){a&&_(e)}}}function or(l){let e,t,s,n,r,a;function i(f,d){return f[1].length>0?ir:rr}let o=i(l),c=o(l);return{c(){e=p("div"),t=p("button"),c.c(),this.h()},l(f){e=v(f,"DIV",{class:!0,title:!0});var d=S(e);t=v(d,"BUTTON",{class:!0});var m=S(t);c.l(m),m.forEach(_),d.forEach(_),this.h()},h(){h(t,"class","triads flex flex-wrap svelte-1roj1mi"),h(e,"class",s=Ie(`${l[2].class||""} `)+" svelte-1roj1mi"),h(e,"title",n=l[0].map(jl).join("-"))},m(f,d){R(f,e,d),u(e,t),c.m(t,null),r||(a=$(t,"click",l[3]),r=!0)},p(f,[d]){o===(o=i(f))&&c?c.p(f,d):(c.d(1),c=o(f),c&&(c.c(),c.m(t,null))),d&4&&s!==(s=Ie(`${f[2].class||""} `)+" svelte-1roj1mi")&&h(e,"class",s),d&1&&n!==(n=f[0].map(jl).join("-"))&&h(e,"title",n)},i:fe,o:fe,d(f){f&&_(e),c.d(),r=!1,a()}}}const jl=l=>l.roman+l.suffix;function cr(l,e,t){let{triads:s,chords:n}=e;function r(a){ps.call(this,l,a)}return l.$$set=a=>{t(2,e=Ee(Ee({},e),we(a))),"triads"in a&&t(0,s=a.triads),"chords"in a&&t(1,n=a.chords)},e=we(e),[s,n,e,r]}class dn extends He{constructor(e){super(),ze(this,e,cr,or,qe,{triads:0,chords:1})}}function Vl(l,e,t){const s=l.slice();return s[23]=e[t],s}function Ol(l,e,t){const s=l.slice();return s[23]=e[t],s}function Bl(l){let e,t,s=l[23].raw.names[0]+"",n,r,a,i,o,c,f;function d(){return l[11](l[23])}a=new fn({props:{scale:l[23].scale,intervals:l[23].raw.intervals}}),a.$on("click",d);function m(){return l[12](l[23])}return o=new dn({props:{triads:l[23].triads,chords:l[23].triadChords}}),o.$on("click",m),{c(){e=p("li"),t=p("div"),n=J(s),r=P(),_e(a.$$.fragment),i=P(),_e(o.$$.fragment),c=P(),this.h()},l(b){e=v(b,"LI",{class:!0});var g=S(e);t=v(g,"DIV",{class:!0});var T=S(t);n=Y(T,s),T.forEach(_),r=j(g),pe(a.$$.fragment,g),i=j(g),pe(o.$$.fragment,g),c=j(g),g.forEach(_),this.h()},h(){h(t,"class","text-xs font-bold"),h(e,"class","svelte-4hctsl")},m(b,g){R(b,e,g),u(e,t),u(t,n),u(e,r),ve(a,e,null),u(e,i),ve(o,e,null),u(e,c),f=!0},p(b,g){l=b,(!f||g&4)&&s!==(s=l[23].raw.names[0]+"")&&re(n,s);const T={};g&4&&(T.scale=l[23].scale),g&4&&(T.intervals=l[23].raw.intervals),a.$set(T);const y={};g&4&&(y.triads=l[23].triads),g&4&&(y.chords=l[23].triadChords),o.$set(y)},i(b){f||(F(a.$$.fragment,b),F(o.$$.fragment,b),f=!0)},o(b){W(a.$$.fragment,b),W(o.$$.fragment,b),f=!1},d(b){b&&_(e),ge(a),ge(o)}}}function Gl(l){let e,t,s=l[23].raw.names[0]+"",n,r,a,i,o,c,f;function d(){return l[13](l[23])}a=new fn({props:{scale:l[23].scale,intervals:l[23].raw.intervals}}),a.$on("click",d);function m(){return l[14](l[23])}return o=new dn({props:{triads:l[23].triads,chords:l[23].triadChords}}),o.$on("click",m),{c(){e=p("li"),t=p("div"),n=J(s),r=P(),_e(a.$$.fragment),i=P(),_e(o.$$.fragment),c=P(),this.h()},l(b){e=v(b,"LI",{class:!0});var g=S(e);t=v(g,"DIV",{class:!0});var T=S(t);n=Y(T,s),T.forEach(_),r=j(g),pe(a.$$.fragment,g),i=j(g),pe(o.$$.fragment,g),c=j(g),g.forEach(_),this.h()},h(){h(t,"class","text-xs font-bold"),h(e,"class","svelte-4hctsl")},m(b,g){R(b,e,g),u(e,t),u(t,n),u(e,r),ve(a,e,null),u(e,i),ve(o,e,null),u(e,c),f=!0},p(b,g){l=b,(!f||g&2)&&s!==(s=l[23].raw.names[0]+"")&&re(n,s);const T={};g&2&&(T.scale=l[23].scale),g&2&&(T.intervals=l[23].raw.intervals),a.$set(T);const y={};g&2&&(y.triads=l[23].triads),g&2&&(y.chords=l[23].triadChords),o.$set(y)},i(b){f||(F(a.$$.fragment,b),F(o.$$.fragment,b),f=!0)},o(b){W(a.$$.fragment,b),W(o.$$.fragment,b),f=!1},d(b){b&&_(e),ge(a),ge(o)}}}function ur(l){let e,t,s,n,r="Scales",a,i,o,c,f="Key",d,m,b,g,T,y,D,O,V,E,N=le(l[2]),I=[];for(let C=0;C<N.length;C+=1)I[C]=Bl(Ol(l,N,C));const L=C=>W(I[C],1,1,()=>{I[C]=null});let M=le(l[1]),w=[];for(let C=0;C<M.length;C+=1)w[C]=Gl(Vl(l,M,C));const G=C=>W(w[C],1,1,()=>{w[C]=null});return{c(){e=p("div"),t=p("fieldset"),s=p("legend"),n=p("button"),n.textContent=r,a=P(),i=p("div"),o=p("div"),c=p("label"),c.textContent=f,d=P(),m=p("input"),b=P(),g=p("ul");for(let C=0;C<I.length;C+=1)I[C].c();T=P(),y=p("ul");for(let C=0;C<w.length;C+=1)w[C].c();this.h()},l(C){e=v(C,"DIV",{class:!0});var k=S(e);t=v(k,"FIELDSET",{class:!0});var A=S(t);s=v(A,"LEGEND",{class:!0});var B=S(s);n=v(B,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-lhx60e"&&(n.textContent=r),B.forEach(_),a=j(A),i=v(A,"DIV",{class:!0});var U=S(i);o=v(U,"DIV",{class:!0});var x=S(o);c=v(x,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(c)!=="svelte-14m38zf"&&(c.textContent=f),d=j(x),m=v(x,"INPUT",{class:!0,id:!0}),x.forEach(_),b=j(U),g=v(U,"UL",{class:!0});var z=S(g);for(let se=0;se<I.length;se+=1)I[se].l(z);z.forEach(_),T=j(U),y=v(U,"UL",{class:!0});var ne=S(y);for(let se=0;se<w.length;se+=1)w[se].l(ne);ne.forEach(_),U.forEach(_),A.forEach(_),k.forEach(_),this.h()},h(){h(n,"class","px-1 rounded hover:bg-gray-100"),h(s,"class","text-base"),h(c,"class","mr-4 font-bold"),h(c,"for","scale-key"),h(m,"class","bg-gray-100 w-16 px-1 rounded"),h(m,"id","scale-key"),m.value=l[0],h(o,"class","flex w-1/2 mb-2 input svelte-4hctsl"),h(g,"class","list odd w-full svelte-4hctsl"),h(y,"class","list even w-full svelte-4hctsl"),h(i,"class","body svelte-4hctsl"),q(i,"hidden",l[3]),h(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-4hctsl"),q(t,"collapsed",l[3]),h(e,"class",D=Ie(`${l[9].class||""}`)+" svelte-4hctsl")},m(C,k){R(C,e,k),u(e,t),u(t,s),u(s,n),u(t,a),u(t,i),u(i,o),u(o,c),u(o,d),u(o,m),u(i,b),u(i,g);for(let A=0;A<I.length;A+=1)I[A]&&I[A].m(g,null);u(i,T),u(i,y);for(let A=0;A<w.length;A+=1)w[A]&&w[A].m(y,null);O=!0,V||(E=[$(n,"click",l[5]),$(m,"input",l[6])],V=!0)},p(C,[k]){if((!O||k&1&&m.value!==C[0])&&(m.value=C[0]),k&388){N=le(C[2]);let A;for(A=0;A<N.length;A+=1){const B=Ol(C,N,A);I[A]?(I[A].p(B,k),F(I[A],1)):(I[A]=Bl(B),I[A].c(),F(I[A],1),I[A].m(g,null))}for(st(),A=N.length;A<I.length;A+=1)L(A);lt()}if(k&386){M=le(C[1]);let A;for(A=0;A<M.length;A+=1){const B=Vl(C,M,A);w[A]?(w[A].p(B,k),F(w[A],1)):(w[A]=Gl(B),w[A].c(),F(w[A],1),w[A].m(y,null))}for(st(),A=M.length;A<w.length;A+=1)G(A);lt()}(!O||k&8)&&q(i,"hidden",C[3]),(!O||k&8)&&q(t,"collapsed",C[3]),(!O||k&512&&D!==(D=Ie(`${C[9].class||""}`)+" svelte-4hctsl"))&&h(e,"class",D)},i(C){if(!O){for(let k=0;k<N.length;k+=1)F(I[k]);for(let k=0;k<M.length;k+=1)F(w[k]);O=!0}},o(C){I=I.filter(Boolean);for(let k=0;k<I.length;k+=1)W(I[k]);w=w.filter(Boolean);for(let k=0;k<w.length;k+=1)W(w[k]);O=!1},d(C){C&&_(e),Pe(I,C),Pe(w,C),V=!1,it(E)}}}function fr(l,e,t){let s,n,r,a,i,o,c;oe(l,Zt,w=>t(17,r=w)),oe(l,St,w=>t(18,a=w)),oe(l,nt,w=>t(19,i=w)),oe(l,tt,w=>t(20,o=w));let d=vs().map(w=>({key:w.names[0],raw:w,scale:void 0,triads:w.triads,triadChords:[]})),m="",b=[a.key,a.scale],g;const T=ht(Be(!0),{key:"scales-hidden"});oe(l,T,w=>t(3,c=w));function y(){T.update(w=>!w)}function D({currentTarget:{value:w}}){t(0,m=`${w.charAt(0).toUpperCase()}${w.charAt(1).toLowerCase()}`),t(10,d=d.map(G=>{const C=Qt(m,G.key),k=m&&"data"in C?C.data:void 0;let A=[];return k&&(A=G.triads.map((B,U)=>`${k.scaleNotes[U].note}${!B.suffix.includes("°")&&B.minor?"m":""}${B.suffix}`)),{...G,scale:k,triadChords:A}}))}function O(w,G,C){if(w<G.length){const k=G[w++];me.setPlayed(k),o==null||o.playChord(k.map(A=>A.midi),i.fixedVelocity),g=setTimeout(()=>O(w,G,C),C)}else me.setPlayed([]),me.setKeyAndScale(b[0],b[1])}function V(w){clearTimeout(g);let G,C;w.scale?(C=w.scale,b=[a.key,a.scale],me.setKeyAndScale(w.scale.key,w.scale.scale)):C=a;const k=r[0].midi+C.scaleNotes[0].semitones;G=w.raw.intervals.map(A=>[{...C.notesMap.get(A.semitones%12),midi:k+A.semitones}]),G[0][0].semitones!==G[G.length-1][0].semitones&&G.push(G[0].map(A=>({...A,midi:A.midi+12}))),O(0,G,500)}function E(w){clearTimeout(g);const{intervals:G}=w.raw;let C,k;w.scale?(k=w.scale,b=[a.key,a.scale],me.setKeyAndScale(w.scale.key,w.scale.scale)):k=a;const A=r[0].midi+k.scaleNotes[0].semitones;C=en(w.triads).map((U,x)=>us(A+k.intervals[x].semitones,k,U.intervals)),G[G.length-1].interval_seq!==1&&C.push(C[0].map(U=>({...U,midi:U.midi+12}))),O(0,C,750)}const N=w=>V(w),I=w=>E(w),L=w=>V(w),M=w=>E(w);return l.$$set=w=>{t(9,e=Ee(Ee({},e),we(w)))},l.$$.update=()=>{l.$$.dirty&1024&&t(2,s=d.filter((w,G)=>G<d.length/2)),l.$$.dirty&1024&&t(1,n=d.filter((w,G)=>G>=d.length/2))},e=we(e),[m,n,s,c,T,y,D,V,E,e,d,N,I,L,M]}class dr extends He{constructor(e){super(),ze(this,e,fr,ur,qe,{})}}function Ml(l,e,t){const s=l.slice();return s[26]=e[t],s}function Ul(l,e,t){const s=l.slice();return s[29]=e[t],s}function Rl(l){let e,t;return{c(){e=p("div"),t=J(l[3]),this.h()},l(s){e=v(s,"DIV",{class:!0});var n=S(e);t=Y(n,l[3]),n.forEach(_),this.h()},h(){h(e,"class","error svelte-1u7ze7x")},m(s,n){R(s,e,n),u(e,t)},p(s,n){n[0]&8&&re(t,s[3])},d(s){s&&_(e)}}}function hr(l){let e,t;return{c(){e=p("div"),t=J(l[0]),this.h()},l(s){e=v(s,"DIV",{slot:!0});var n=S(e);t=Y(n,l[0]),n.forEach(_),this.h()},h(){h(e,"slot","value")},m(s,n){R(s,e,n),u(e,t)},p(s,n){n[0]&1&&re(t,s[0])},d(s){s&&_(e)}}}function Kl(l){let e,t=le(l[5]),s=[];for(let n=0;n<t.length;n+=1)s[n]=xl(Ul(l,t,n));return{c(){e=p("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var r=S(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(_),this.h()},h(){h(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){R(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r[0]&32){t=le(n[5]);let a;for(a=0;a<t.length;a+=1){const i=Ul(n,t,a);s[a]?s[a].p(i,r):(s[a]=xl(i),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function xl(l){let e,t=l[29].interval+"",s;return{c(){e=p("span"),s=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"class","svelte-1u7ze7x")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r[0]&32&&t!==(t=n[29].interval+"")&&re(s,t)},d(n){n&&_(e)}}}function Fl(l){let e,t=le(l[8].scaleNotes),s=[];for(let n=0;n<t.length;n+=1)s[n]=$l(Ml(l,t,n));return{c(){e=p("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var r=S(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(_),this.h()},h(){h(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){R(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r[0]&256){t=le(n[8].scaleNotes);let a;for(a=0;a<t.length;a+=1){const i=Ml(n,t,a);s[a]?s[a].p(i,r):(s[a]=$l(i),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&_(e),Pe(s,n)}}}function $l(l){let e,t=l[26].note+"",s;return{c(){e=p("span"),s=J(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=S(e);s=Y(r,t),r.forEach(_),this.h()},h(){h(e,"class","svelte-1u7ze7x")},m(n,r){R(n,e,r),u(e,s)},p(n,r){r[0]&256&&t!==(t=n[26].note+"")&&re(s,t)},d(n){n&&_(e)}}}function mr(l){let e,t,s,n="Score",r,a,i,o,c,f,d,m="Range",b,g,T,y,D,O="—",V,E,N,I,L,M,w,G="Scale",C,k,A,B,U,x,z,ne="Key",se,de,ue,Ne,xe,Ge,be="",We,Ke,Le,ie;i=new rt({props:{icon:Yl,width:16}});let Se=l[3]&&Rl(l);A=new nn({props:{id:"scales",class:"p-1",options:l[10],onSelect:l[14],$$slots:{value:[hr]},$$scope:{ctx:l}}});let he=!l[7]&&Kl(l),Q=!l[7]&&Fl(l);return{c(){e=p("fieldset"),t=p("legend"),s=p("button"),s.textContent=n,r=P(),a=p("button"),_e(i.$$.fragment),o=P(),c=p("div"),f=p("div"),d=p("label"),d.textContent=m,b=P(),g=p("div"),T=p("input"),y=P(),D=p("span"),D.textContent=O,V=P(),E=p("input"),N=P(),I=p("div"),Se&&Se.c(),L=P(),M=p("div"),w=p("label"),w.textContent=G,C=P(),k=p("div"),_e(A.$$.fragment),B=P(),he&&he.c(),U=P(),x=p("div"),z=p("label"),z.textContent=ne,se=P(),de=p("div"),ue=p("input"),Ne=P(),Q&&Q.c(),xe=P(),Ge=p("div"),Ge.innerHTML=be,this.h()},l(ae){e=v(ae,"FIELDSET",{class:!0});var K=S(e);t=v(K,"LEGEND",{class:!0});var X=S(t);s=v(X,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-lqyol"&&(s.textContent=n),X.forEach(_),r=j(K),a=v(K,"BUTTON",{class:!0});var ce=S(a);pe(i.$$.fragment,ce),ce.forEach(_),o=j(K),c=v(K,"DIV",{class:!0});var ee=S(c);f=v(ee,"DIV",{class:!0});var Ce=S(f);d=v(Ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(d)!=="svelte-10u0679"&&(d.textContent=m),b=j(Ce),g=v(Ce,"DIV",{class:!0});var Ve=S(g);T=v(Ve,"INPUT",{class:!0,id:!0}),y=j(Ve),D=v(Ve,"SPAN",{class:!0,"data-svelte-h":!0}),Z(D)!=="svelte-8q1xz4"&&(D.textContent=O),V=j(Ve),E=v(Ve,"INPUT",{class:!0,id:!0}),Ve.forEach(_),N=j(Ce),I=v(Ce,"DIV",{class:!0});var at=S(I);Se&&Se.l(at),at.forEach(_),Ce.forEach(_),L=j(ee),M=v(ee,"DIV",{class:!0});var Je=S(M);w=v(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(w)!=="svelte-ld2d07"&&(w.textContent=G),C=j(Je),k=v(Je,"DIV",{class:!0});var Me=S(k);pe(A.$$.fragment,Me),Me.forEach(_),B=j(Je),he&&he.l(Je),Je.forEach(_),U=j(ee),x=v(ee,"DIV",{class:!0});var De=S(x);z=v(De,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(z)!=="svelte-17pcm6g"&&(z.textContent=ne),se=j(De),de=v(De,"DIV",{class:!0});var Ae=S(de);ue=v(Ae,"INPUT",{class:!0,id:!0}),Ae.forEach(_),Ne=j(De),Q&&Q.l(De),De.forEach(_),xe=j(ee),Ge=v(ee,"DIV",{class:!0,"data-svelte-h":!0}),Z(Ge)!=="svelte-hp3bkp"&&(Ge.innerHTML=be),ee.forEach(_),K.forEach(_),this.h()},h(){h(s,"class","px-1 rounded hover:bg-gray-100"),h(t,"class","px-1 text-base"),h(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),q(a,"hidden",l[6]),h(d,"class","font-bold"),h(d,"for","range_min"),h(T,"class","h-[28px] w-full"),h(T,"id","range_min"),h(D,"class","mx-2 mt-1"),h(E,"class","h-[28px] w-full"),h(E,"id","range_max"),h(g,"class","my-1 flex w-full"),h(I,"class","flex justify-between my-1"),h(f,"class","flex flex-col h-full"),h(w,"class","font-bold"),h(w,"for","scales"),h(k,"class","my-1 w-full"),h(M,"class","flex flex-col h-full"),h(z,"class","font-bold"),h(z,"for","key"),h(ue,"class","h-[28px]"),h(ue,"id","key"),h(de,"class","my-1 flex"),h(x,"class","flex flex-col h-full"),h(Ge,"class","h-full flex flex-col justify-between"),h(c,"class","options svelte-1u7ze7x"),q(c,"hidden",l[6]),h(e,"class",We=Ie(`${l[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),q(e,"collapsed",l[6])},m(ae,K){R(ae,e,K),u(e,t),u(t,s),u(e,r),u(e,a),ve(i,a,null),u(e,o),u(e,c),u(c,f),u(f,d),u(f,b),u(f,g),u(g,T),Qe(T,l[1]),u(g,y),u(g,D),u(g,V),u(g,E),Qe(E,l[2]),u(f,N),u(f,I),Se&&Se.m(I,null),u(c,L),u(c,M),u(M,w),u(M,C),u(M,k),ve(A,k,null),u(M,B),he&&he.m(M,null),u(c,U),u(c,x),u(x,z),u(x,se),u(x,de),u(de,ue),Qe(ue,l[4]),u(x,Ne),Q&&Q.m(x,null),u(c,xe),u(c,Ge),Ke=!0,Le||(ie=[$(s,"click",l[15]),$(a,"click",l[16]),$(T,"input",l[18]),$(T,"change",l[19]),$(T,"focus",l[12]),$(E,"input",l[20]),$(E,"change",l[21]),$(E,"focus",l[12]),$(ue,"input",l[22]),$(ue,"input",l[13])],Le=!0)},p(ae,K){(!Ke||K[0]&64)&&q(a,"hidden",ae[6]),K[0]&2&&T.value!==ae[1]&&Qe(T,ae[1]),K[0]&4&&E.value!==ae[2]&&Qe(E,ae[2]),ae[3]?Se?Se.p(ae,K):(Se=Rl(ae),Se.c(),Se.m(I,null)):Se&&(Se.d(1),Se=null);const X={};K[0]&1|K[1]&2&&(X.$$scope={dirty:K,ctx:ae}),A.$set(X),ae[7]?he&&(he.d(1),he=null):he?he.p(ae,K):(he=Kl(ae),he.c(),he.m(M,null)),K[0]&16&&ue.value!==ae[4]&&Qe(ue,ae[4]),ae[7]?Q&&(Q.d(1),Q=null):Q?Q.p(ae,K):(Q=Fl(ae),Q.c(),Q.m(x,null)),(!Ke||K[0]&64)&&q(c,"hidden",ae[6]),(!Ke||K[0]&131072&&We!==(We=Ie(`${ae[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&h(e,"class",We),(!Ke||K[0]&131136)&&q(e,"collapsed",ae[6])},i(ae){Ke||(F(i.$$.fragment,ae),F(A.$$.fragment,ae),Ke=!0)},o(ae){W(i.$$.fragment,ae),W(A.$$.fragment,ae),Ke=!1},d(ae){ae&&_(e),ge(i),Se&&Se.d(),ge(A),he&&he.d(),Q&&Q.d(),Le=!1,it(ie)}}}function _r(l,e,t){let s,n,r,a,i,o;oe(l,Zt,k=>t(23,n=k)),oe(l,kt,k=>t(24,r=k)),oe(l,yt,k=>t(7,i=k)),oe(l,St,k=>t(8,o=k));let c=Xe(n[0]),f=Xe(n[1]),d="";const m=ht(Be(!1),{key:"score-options-hidden"});oe(l,m,k=>t(6,a=k));let b=r[0],g=r[1];const T=vs(),y=T.map(k=>({key:k.names[0],value:k.names[0]}));Zt.subscribe(k=>{t(1,c=Xe(k[0])),t(2,f=Xe(k[1]))}),kt.subscribe(k=>{t(4,b=k[0]),t(0,g=k[1])});function D(k,A){const B=Pn(A.currentTarget.value,!0,!0);if("data"in B){const{midi:U}=B.data,x=n,z=[k==="min"?U:x[0].midi,k==="max"?U:x[1].midi];$e.setMidiRange(z),t(3,d="")}else t(3,d=B.err),k==="min"?t(1,c=Xe(n[0])):t(2,f=Xe(n[1]))}function O(){t(3,d="")}function V({currentTarget:{value:k}}){t(4,b=`${k.charAt(0).toUpperCase()}${k.charAt(1).toLowerCase()}`),me.setKey(b)}function E(k){var A;return t(0,g=(A=y.find(B=>k===B.key))==null?void 0:A.value),me.setScale(g),!1}function N(){m.update(k=>!k)}function I(){me.clearScore(!0),$e.setMidiRange([60,84])}function L(){c=this.value,t(1,c)}const M=k=>D("min",k);function w(){f=this.value,t(2,f)}const G=k=>D("max",k);function C(){b=this.value,t(4,b)}return l.$$set=k=>{t(17,e=Ee(Ee({},e),we(k)))},l.$$.update=()=>{var k;l.$$.dirty[0]&1&&t(5,s=((k=T.find(A=>A.names[0]===g))==null?void 0:k.intervals)||[])},e=we(e),[g,c,f,d,b,s,a,i,o,m,y,D,O,V,E,N,I,e,L,M,w,G,C]}class pr extends He{constructor(e){super(),ze(this,e,_r,mr,qe,{},null,[-1,-1])}}function vr(l){l[19]=l[20].default}function gr(l){return{c:fe,l:fe,m:fe,i:fe,o:fe,d:fe}}function br(l){vr(l);let e,t,s;var n=l[19];function r(a,i){return{props:{class:"px-4 md:px-0"}}}return n&&(e=gn(n,r())),{c(){e&&_e(e.$$.fragment),t=je()},l(a){e&&pe(e.$$.fragment,a),t=je()},m(a,i){e&&ve(e,a,i),R(a,t,i),s=!0},i(a){s||(e&&F(e.$$.fragment,a),s=!0)},o(a){e&&W(e.$$.fragment,a),s=!1},d(a){a&&_(t),e&&ge(e,a)}}}function yr(l){let e;return{c(){e=J(" ")},l(t){e=Y(t," ")},m(t,s){R(t,e,s)},i:fe,o:fe,d(t){t&&_(e)}}}function kr(l){let e,t,s,n='<a class="hover:underline" href="https://github.com/TeemuKoivisto/midi-note-trainer">MIDI Note Trainer</a>',r,a,i,o,c,f,d,m,b,g,T,y,D,O,V,E,N,I,L;i=new xa({}),c=new dr({}),d=new sa({}),g=new pr({props:{class:"score-options mr-4"}}),y=new tr({props:{class:"play-form"}});let M={ctx:l,current:null,token:null,hasCatch:!1,pending:yr,then:br,catch:gr,value:20,blocks:[,,,]};return pn(te(()=>import("./Score.814f5002.js"),["./Score.814f5002.js","./vendor_svelte.464dccef.js","./vendor.1acf520b.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),M),E=new Ja({props:{class:"min-h-32",debounced:!!l[0]}}),E.$on("guessed-chord",l[2]),E.$on("guessed-key",l[3]),E.$on("guessed-note",l[4]),I=new _a({props:{game:l[1]}}),{c(){e=p("meta"),t=P(),s=p("h1"),s.innerHTML=n,r=P(),a=p("section"),_e(i.$$.fragment),o=P(),_e(c.$$.fragment),f=P(),_e(d.$$.fragment),m=P(),b=p("div"),_e(g.$$.fragment),T=P(),_e(y.$$.fragment),D=P(),M.block.c(),O=P(),V=p("section"),_e(E.$$.fragment),N=P(),_e(I.$$.fragment),this.h()},l(w){const G=vn("svelte-1w2oado",document.head);e=v(G,"META",{name:!0,content:!0}),G.forEach(_),t=j(w),s=v(w,"H1",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-1l8ebwf"&&(s.innerHTML=n),r=j(w),a=v(w,"SECTION",{class:!0});var C=S(a);pe(i.$$.fragment,C),o=j(C),pe(c.$$.fragment,C),f=j(C),pe(d.$$.fragment,C),m=j(C),b=v(C,"DIV",{class:!0});var k=S(b);pe(g.$$.fragment,k),T=j(k),pe(y.$$.fragment,k),k.forEach(_),C.forEach(_),D=j(w),M.block.l(w),O=j(w),V=v(w,"SECTION",{class:!0});var A=S(V);pe(E.$$.fragment,A),N=j(A),pe(I.$$.fragment,A),A.forEach(_),this.h()},h(){h(e,"name","description"),h(e,"content","App to practise music notation, scales and chords using MIDI"),h(s,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight"),h(b,"class","play svelte-qjpqy3"),h(a,"class","px-4 md:px-0"),h(V,"class","mb-8 px-4 md:px-0 flex flex-col")},m(w,G){u(document.head,e),R(w,t,G),R(w,s,G),R(w,r,G),R(w,a,G),ve(i,a,null),u(a,o),ve(c,a,null),u(a,f),ve(d,a,null),u(a,m),u(a,b),ve(g,b,null),u(b,T),ve(y,b,null),R(w,D,G),M.block.m(w,M.anchor=G),M.mount=()=>O.parentNode,M.anchor=O,R(w,O,G),R(w,V,G),ve(E,V,null),u(V,N),ve(I,V,null),L=!0},p(w,[G]){l=w;const C={};G&1&&(C.debounced=!!l[0]),E.$set(C);const k={};G&2&&(k.game=l[1]),I.$set(k)},i(w){L||(F(i.$$.fragment,w),F(c.$$.fragment,w),F(d.$$.fragment,w),F(g.$$.fragment,w),F(y.$$.fragment,w),F(M.block),F(E.$$.fragment,w),F(I.$$.fragment,w),L=!0)},o(w){W(i.$$.fragment,w),W(c.$$.fragment,w),W(d.$$.fragment,w),W(g.$$.fragment,w),W(y.$$.fragment,w);for(let G=0;G<3;G+=1){const C=M.blocks[G];W(C)}W(E.$$.fragment,w),W(I.$$.fragment,w),L=!1},d(w){w&&(_(t),_(s),_(r),_(a),_(D),_(O),_(V)),_(e),ge(i),ge(c),ge(d),ge(g),ge(y),M.block.d(w),M.token=null,M=null,ge(E),ge(I)}}}function Er(l,e,t){let s,n,r,a,i,o;oe(l,bt,N=>t(7,s=N)),oe(l,yt,N=>t(1,n=N)),oe(l,dt,N=>t(8,r=N)),oe(l,nt,N=>t(9,a=N)),oe(l,tt,N=>t(10,i=N)),oe(l,ds,N=>t(11,o=N));let c,f;Jl(()=>(o&&E(),window.addEventListener("keydown",d),window.addEventListener("mousedown",d),window.addEventListener("touchstart",d),()=>{window.removeEventListener("keydown",d),window.removeEventListener("mousedown",d),window.removeEventListener("touchstart",d)})),Xt.subscribe(N=>{N&&N.channels[1].addListener("noteon",m)});function d(){$e.initAudio(),window.removeEventListener("keydown",d),window.removeEventListener("mousedown",d),window.removeEventListener("touchstart",d)}function m(N){if(c)return;const I=N.rawData;b(I[1],I[2])}function b(N,I){const L=n;L instanceof It&&!(L!=null&&L.ended)&&s==="waiting"?y(N):L instanceof ft&&!(L!=null&&L.ended)&&s==="waiting"?(L.addPlayedNote(N),f||(f=setTimeout(T,2e3))):L||me.pushPlayed(N),i&&i.noteOn(N,a.fixedVelocity??I)}function g(){r.autoplay&&r.waitSeconds>0?t(0,c=setTimeout(()=>{r.autoplay&&ke.nextGuess(),t(0,c=void 0)},r.waitSeconds*1e3)):r.autoplay?ke.nextGuess():t(0,c=void 0)}function T(){var I;const N=n;if(N instanceof ft){const L=N.guess();me.setPlayed(((I=N.latestGuess.guessed)==null?void 0:I.notes)||[],L,-1),ke.updateState(L?"correct":"wrong"),g()}f=void 0}function y(N){const I=n;if(I instanceof It&&s==="waiting"){me.setTarget([me.getNote(I.current)]);const L=I.guess(N);ke.updateState(L?"correct":"wrong"),me.pushPlayed(N,L,4e3),g()}}function D(N){const I=n;if(I instanceof ft&&s==="waiting"){const L=I.guessWrittenChord(N.detail);ke.updateState(L?"correct":"wrong"),g()}}function O(N){const I=n;if(I instanceof Pt&&s==="waiting"){const L=N.detail.replaceAll("♭","b").replaceAll("♯","#"),M=I.guess(L);ke.updateState(M?"correct":"wrong"),g()}}function V(N){b(N.detail,80)}async function E(){const N=await $e.openMidi();"data"in N?N.data.name:(N.err,console.error(N.err))}return[c,n,D,O,V]}class Tr extends He{constructor(e){super(),ze(this,e,Er,kr,qe,{})}}export{Bs as F,ft as G,Tr as P,wn as S,It as a,ke as b,yt as c,gt as d,tn as e,bt as g,tt as p,St as s,Us as t};
