import{_ as an}from"./preload-helper.a4192956.js";import{R as _e,Q as Ct,T as Pe,U as rn,S as Re,i as He,s as qe,O as rt,V as le,e as p,m as P,H as ve,a as v,b as T,n as ee,d as m,o as B,I as ge,f as h,L as z,W as Te,g as F,h as u,J as be,p as $,t as H,C as st,w as lt,l as J,K as ye,X as De,Y as ot,M as oe,N as Ce,P as we,z as Q,A as Y,B as ae,v as Le,q as ue,Z as hs,r as Fl,_ as Qe,$ as on,a0 as qt,c as Ul,u as xl,j as $l,k as Rl,a1 as Es,a2 as $t,F as cn,a3 as Ss,a4 as As,a5 as un,a6 as fn,G as dn}from"./vendor_svelte.565aa2ba.js";import{w as Rt,b as hn,c as mn,e as Ts,f as Ns,g as Hl,h as zt,i as Wt,a as Is,j as os}from"./vendor.1acf520b.js";const js={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function $e(l,e=0,t=0){return{interval:`${l}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:l,semitones:ql(l,e,t),flats:e,sharps:t}}function ql(l,e,t){return(l<8?js[l]:js[l%7])-e+t+Math.floor(l/8)*12}function zl(l){let e,t=0,s=0;l<0?(t=1+Math.floor(-l/100),e=-l%100):l>100?(s=Math.floor(l/100),e=l%100):e=l;const n=ql(e,t,s);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(s)}`,interval_seq:e,semitones:n,flats:t,sharps:s}}const _n=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let ns=[];function Wl(){return _n.map(l=>{const e=l[3].map(zl);return{suffixes:l[0],name:l[1][0],type:l[2],intervals:e}})}function jt(l){ns.length===0&&(ns=Wl());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return ns.find(t=>t.suffixes.find(s=>s===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function pn(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const r=(l.semitones+e)%12;return{...l,semitones:r<0?r+12:r,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function is(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const r=t[n],a=l+r.semitones,o=e.scaleNotes.find(_=>_.semitones===a%12),i=r.flats>0,c=r.sharps>0,f=(i?a+1:c?a-1:a)%12,d=i?-1:c?1:0;s.push(pn(o??e.notesMap.get(f),o?0:d,a))}return s}const Ds=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],vn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],Ls=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function gn(l){let e=0,t=0;for(let s=0;s<Ds.length;s+=1){const n=l.find(a=>a.note.slice(0,2)===Ds[s]),r=l.find(a=>a.note.slice(0,2)===vn[s]);if(n)e+=1;else if(r)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:Ls.get(e*-1)}:{flats:0,sharps:t,majorSignature:Ls.get(t)}}function bn(l){return l>=9?`${l>=10?"X":""}${l===9?"IX":"I".repeat(l%10)}`:`${l>=5?"V":""}${l===4?"IV":"I".repeat(l%5)}`}function Jl(l){return l.map(e=>{const t=[$e(1)];let s;return e.major?(t.push($e(3)),e.suffix.startsWith("+")?t.push($e(5,0,1)):e.suffix.startsWith("6")?t.push($e(6)):e.suffix.startsWith("7")?t.push($e(7,1)):e.suffix.startsWith("maj7")?t.push($e(7)):s=jt("maj")):e.minor?(t.push($e(3,1)),e.suffix.startsWith("°")?t.push($e(5,1)):e.suffix.startsWith("6")?(t.push($e(6)),s=jt("m"+e.suffix)):e.suffix.startsWith("7")?(t.push($e(7,1)),s=jt("m"+e.suffix)):s=jt("m")):e.suffix.startsWith("sus2")?t.push($e(2)):e.suffix.startsWith("sus4")&&t.push($e(4)),t.length<=2&&t.push($e(5)),t.length<=2&&t.push($e(8)),s||(s=jt(e.suffix)),{...s,intervals:t}})}function yn(l,e){let t=e.has(4)&&e.has(7),s=e.has(3)&&e.has(7);const n=bn(l);let r="";return t||s||(e.has(3)&&e.has(6)?(r="°",s=!0):e.has(4)&&e.has(8)?(r="+",t=!0):e.has(3)&&e.has(10)?(s=!0,r="7"):e.has(4)&&e.has(10)?(r="7",t=!0):e.has(4)&&e.has(11)?(r="maj7",t=!0):e.has(3)&&e.has(8)?(r="6",s=!0):e.has(4)&&e.has(9)?(r="6",t=!0):e.has(2)?r="sus2":e.has(5)?r="sus4":e.has(7)?r="5":r="?"),{degree:l,roman:s?n.toLowerCase():n,suffix:r,major:t,minor:s,semitones:e}}function kn(l){const e=l.length;return l.map((t,s)=>{const n=t.semitones,r=new Set;for(let a=1;a<e;a+=1){const o=l[(s+a)%e].semitones,i=o<=n?o+12-n:o-n;r.add(i)}return yn(t.interval_seq,r)})}const Cn=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let as=[];function ms(){return Cn.map(l=>{const e=l[0],t=l[1].map(zl),s=kn(t);return{names:e,intervals:t,triads:s}})}function wn(l){as.length===0&&(as=ms());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return as.find(t=>t.names.find(s=>s.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const En=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,Sn=/^[0-9]$/,et=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function Ql(l){return l===12?1:Math.floor((l-12)/12)}function Ye(l){return`${l.note}${Ql(l.midi)}`}function Tt(l){const t=(l-12)%12;return{...et[t],semitones:t,midi:l}}function An(l,e=!0,t=!1){if(e&&!En.test(l))return{err:`Unrecognized note "${l}"`,code:400};const s=l.trim(),n=s.charAt(0).toUpperCase(),r=et.find(d=>d.note.charAt(0)===n&&d.note.length===1);if(!r)return{err:`Unable to find note ${s}`,code:500};const a=s.slice(1).split("").reduce((d,_)=>d+(_.toLowerCase()==="b"||_==="♭"?-1:_==="#"||_==="♯"?1:0),0);let o;if(Sn.test(s.charAt(s.length-1)))try{o=parseInt(s.charAt(s.length-1),10)}catch{}if(t&&o===void 0)return{err:`No octave provided: ${l}`,code:400};o===void 0&&(o=0);let i=(r.semitones+a)%12;i=i<0?i+12:i;const c=a<0?-a:0,f=a>0?a:0;return{data:{note:`${n}${"♭".repeat(c)}${"♯".repeat(f)}`,semitones:i,midi:12+o*12+i,flats:c,sharps:f}}}function Yl(l){const e=et.find(t=>t.note.charAt(0)===l.charAt(0)&&t.note.length===1);if(e){const t=l.slice(1).split("").reduce((n,r)=>n+(r.toLowerCase()==="b"||r==="♭"?-1:r==="#"||r==="♯"?1:0),0),s=(e.semitones+t)%12;return{note:l,semitones:s<0?s+12:s,flats:t<0?-t:0,sharps:t>0?t:0}}}const Tn=/^[a-gA-G][♭b#♯]?$/,rs="ABCDEFG";function Nn(l,e){return e.map(t=>rs.charAt((rs.indexOf(l)+t.interval_seq-1)%rs.length))}function In(l,e,t){return t.map((s,n)=>{const r=e[n],a=(l+s.semitones)%12,o=et[a],i=o.note.charAt(0);if(i<r&&(i!=="A"||r!=="G")||i==="G"&&r==="A"){let c=1,f=et[(a+c)%12];for(;f.note.charAt(0)!==r;)c+=1,f=et[(a+c)%12];return{semitones:a,note:f.note+"♭".repeat(c),flats:c+(f.note.includes("♭")?1:0),sharps:0}}else if(i>r||i==="A"&&r==="G"){let c=1,f=a===0?et.length-1:a-c,d=et[f];for(;d.note.charAt(0)!==r;)c+=1,f=f===0?et.length-1:f-1,d=et[f];return{semitones:a,note:d.note+"♯".repeat(c),flats:0,sharps:c+(d.note.includes("♯")?1:0)}}else return{semitones:a,note:o.note,flats:o.flats,sharps:o.sharps}})}function Jt(l,e){if(!Tn.test(l))return{err:`Unknown key: ${l}`,code:400};const t=wn(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const s=`${l.charAt(0).toUpperCase()}${l.charAt(1).replace("b","♭").replace("#","♯")}`,n=Yl(s);if(!n)return{err:`Unable to find root for note: ${s}`,code:404};const r=Nn(s.charAt(0),t.intervals),a=In(n.semitones,r,t.intervals),o=new Map(et.map(i=>{const c=a.find(f=>f.semitones===i.semitones);return c?[i.semitones,c]:[i.semitones,{...i}]}));return{data:{key:s,scale:t.names[0],names:t.names,...gn(a),intervals:t.intervals.map(i=>({...i})),triads:t.triads.map(i=>({...i})),scaleNotes:a,notesMap:o}}}const cs=new Map;function jn(l,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(l)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function Dn(l,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(l)),{data:void 0}}catch(s){return{err:`Failed to store the value: ${s}`,code:400}}}function dt(l,e){const{key:t,storage:s="local",namespace:n="default"}=e,r=jn(t,s),a=_e(l);"data"in r?l.set(e.deserialize?e.deserialize(r.data):r.data):"err"in r&&(e!=null&&e.debug)&&console.info(r.err);const o=l.subscribe(c=>{const f=Dn(e.serialize?e.serialize(c):c,t,s);"err"in f&&(e!=null&&e.debug)&&console.error(f.err)}),i=cs.get(n);return i?i.push({key:t,storage:s,value:l,defaultValue:a,unsubscribe:o}):cs.set(n,[{key:t,storage:s,value:l,defaultValue:a,unsubscribe:o}]),l}function Ln(l=["default"],e){l.forEach(t=>{var s;(s=cs.get(t))==null||s.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function Pn(l,e){const t=await fetch(l);if(!t.ok)return{err:t.statusText,code:t.status};const s=await t.arrayBuffer();return{data:await e.decodeAudioData(s)}}async function Bn(l,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],s=await Promise.all(t.map(r=>Pn(`${l}${r}`,e))),n=[];return s.forEach(r=>{"err"in r?console.error(`Failed to load audio: ${r.err}`):n.push(r.data)}),n}class Gn{constructor(e,t,s,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(s),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(s))}on(e,t,s,n,r,a,o,i){this.noteA.buffer=e,this.noteA.playbackRate.value=s,this.biquadFilter.frequency.value=r,this.gainA.gain.value=a,this.gain.gain.value=i,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=o,this.noteB.start(0)),this.noteA.start(0)}off(e,t,s){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(s),this.noteB.stop(s),(n=this.damp)==null||n.start(0)}}class Mn{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,s)=>{this.bufferlists.push(t),s===8?this.damper=t:s===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(s=>{this.noteOn(s,t)})}noteOn(e,t=80){if(e<109&&e>20){const s=this.notes.get(e);s&&(s.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),r=n+1,a=n*12+21,o=2**((e-69)/12)*440,i=t/127;let c=o*(2-(e-21)/50)+3*o*i;e<60&&(c=440*(3-(60-21)/50)+3*o*i);const f=1-(e%12/12+1)/12,d=Math.pow(2,(e-a)/12),_=0,b=0,g=i**1.4,E=new Gn(e,this.context,this.directGain,this.damper);E.on(this.bufferlists[n],this.bufferlists[r],d,_,c,f,b,g),this.notes.set(e,E)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const Vn="/midi-note-trainer/",us=dt(Pe(!1),{key:"midi-access"}),Qt=Pe(void 0),_s=dt(Pe([60,84]),{key:"midi-range",storage:"session"}),Yt=Ct(_s,l=>[Tt(l[0]),Tt(l[1])]),Ps=Pe(void 0),tt=Pe(void 0),Kn=Pe(!0),nt=dt(Pe({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),fe={async openMidi(){return Rt.enable().then(()=>(us.set(!0),Rt.inputs.length>0?(Qt.set(Rt.inputs[0]),{data:Rt.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(l=>({err:l.toString(),code:403}))},disableMidi(){us.set(!1),Qt.set(void 0)},setMidiRange(l){_s.set(l)},setInputValue(l,e){nt.update(t=>({...t,[l]:e})),l==="useSound"&&!e?tt.set(void 0):l==="useSound"&&!_e(tt)&&this.initAudio()},setKeyboardFocus(l){Kn.set(l)},async initAudio(){let l=_e(Ps);if(l||(l=new AudioContext,Ps.set(l)),!_e(tt)){const e=new Mn(l),t=await Bn(`${Vn}audio`,l);e.load(t),tt.set(e)}}};let Ze;const On=rn({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}}),yt=Pe(["C","Major"]),kt=Ct(yt,l=>{const e=Jt(l[0],l[1]);return"data"in e?e.data:{key:l[0],scale:l[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),Fn=Ct([kt,On],([l,e])=>{const t={...e};return Object.entries(e).forEach(([s,n])=>{const r=l.notesMap.get(n.semitones%12);r&&(t[s]={note:r.note,flats:r.flats,sharps:r.sharps,semitones:n.semitones})}),t}),Bs=Pe([]),vt=Pe([]);function fs(l,e){if(l.length>0){const t=Date.now();let s=t;const n=l.filter(r=>(r.started+e>t&&(s=Math.min(s,r.started)),r.started+e>t));return!Ze&&n.length>0&&(Ze=setTimeout(()=>{Ze=void 0,vt.update(r=>fs(r,e))},e-(t-s)+100)),n}return l}const me={setKey(l){yt.update(e=>[l,e[1]])},setScale(l){yt.update(e=>[e[0],l])},setKeyAndScale(l,e){yt.set([l,e])},setTarget(l=[]){Bs.set(l)},findNote(l){return Object.values(_e(Fn)).find(e=>{if(e.note.charAt(0)===l.charAt(0)){const t=l.slice(1).split("").reduce((s,n)=>s+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},getNote(l){return{..._e(kt).notesMap.get(l%12),midi:l}},pushPlayed(l,e,t){const n={..._e(kt).notesMap.get(l%12),midi:l},r=Date.now(),a=e===void 0?"default":e?"correct":"wrong";if(vt.update(o=>{const i=o.findIndex(c=>c.midi===l);return i>=0&&o.splice(i,1),[...o,{...n,color:a,started:r}]}),!Ze&&t!==-1){const o=t??_e(nt).keyFadeTimeout;Ze=setTimeout(()=>{Ze=void 0,vt.update(i=>fs(i,o))},o)}},setPlayed(l,e,t){const s=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(vt.update(r=>[...l.map(a=>({...a,color:n,started:s}))]),!Ze&&t!==-1){const r=t??_e(nt).keyFadeTimeout;Ze=setTimeout(()=>{Ze=void 0,vt.update(a=>fs(a,r))},r)}},clearPlayed(){vt.set([]),clearTimeout(Ze),Ze=void 0},clearScore(l=!1){l&&yt.set(["C","Major"]),Bs.set([]),vt.set([])}};class ps{constructor(e,t,s){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=s;const n=[],{count:r}=s,a=t.map(i=>typeof i=="object"&&i!==null?{...i}:i);let o=s.duplicates;!s.duplicates&&r>a.length&&(console.warn(`Trying to create game with count ${r} larger than available unique values ${t.length}`),o=!0);for(let i=0;i<r;i+=1){const c=Math.floor(Math.random()*a.length);if(o)n.push(a[c]);else{const f=a.splice(c,1);f.length>0&&n.push(f[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function Un(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const r=(l.semitones+e)%12;return{...l,semitones:r<0?r+12:r,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function xn(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const r=t[n],a=l+r.semitones,o=e.scaleNotes.find(_=>_.semitones===a%12),i=r.flats>0,c=r.sharps>0,f=(i?a+1:c?a-1:a)%12,d=i?-1:c?1:0;s.push(Un(o??e.notesMap.get(f),o?0:d,a))}return s}const $n=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function Rn(l){const t=(l-12)%12;return{...$n[t],semitones:t,midi:l}}function Hn(l){return`${l.note.trim().charAt(0).toUpperCase()}${"♭".repeat(l.flats)}${"♯".repeat(l.sharps)}`}class ut extends ps{constructor(e,t,s){const n=t.range[0],r=t.range[1],a=new Set(t.scale.scaleNotes.map(i=>i.semitones)),o=s.chords.flatMap(i=>{const c=[],f=i.intervals.reduce((d,_)=>_.semitones>d?_.semitones:d,0);for(let d=n;d<=r-f;d+=1)if((!s.onlyScale||a.has(d%12))&&(!i.allowed||i.allowed.has(d%12))){const _=xn(d,t.scale,i.intervals);c.push({...i,rootNote:_[0].note,chord:`${_[0].note}${i.suffixes[0]}`,notes:_})}return c});super(e,o,t),this.played=new Set,this.opts=s}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${Hn(e)}${e.chord.toLowerCase()}`,notes:[]},s=this.current.chord===t.chord;return this.addGuessed(t,s)}guess(){const e=Array.from(this.played.values()).map(n=>Rn(n)).sort((n,r)=>n.midi-r.midi);this.played.clear();const t={chord:"",notes:e},s=this.current.notes.every(n=>e.find(r=>r.midi%12===n.midi%12));return this.addGuessed(t,s)}}const qn={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class Dt extends ps{constructor(e,t){const s=e==="keys-major"?"major":"minor";super(e,Object.keys(qn[s]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class Nt extends ps{constructor(e,t){const s=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-s+1)).map((r,a)=>s+a),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const Xl={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},gt=Pe("waiting"),ft=dt(Pe(Xl),{key:"game-options"}),bt=Pe(void 0),vs=Pe(Wl().map(l=>({...l,selected:!0}))),ke={play(...[l,e]){var i,c,f;let t;const s=_e(kt),n=_e(_s),r=_e(ft),a={scale:s,range:n,duplicates:r.duplicates,count:r.count};let o=[s.key,s.scale];if(l==="notes")t=new Nt(l,a),me.setTarget([me.getNote(t.current)]),(i=_e(tt))==null||i.noteOn(t.current);else if(l==="pitches")t=new Nt(l,a),me.setTarget(),fe.setInputValue("useSound",!0),(c=_e(tt))==null||c.noteOn(t.current);else if(l==="keys-major"||l=="keys-minor")t=new Dt(l,a),o=[t.current,l==="keys-major"?"major":"minor"];else if(l==="chords-play"||l==="chords-write")t=new ut(l,a,e);else if(l==="chords-diatonic"){const d=Jl(s.triads).map((_,b)=>({..._,allowed:new Set([s.scaleNotes[b].semitones])}));t=new ut(l,a,{chords:d})}else throw Error("Unknown game type: "+l);return typeof t.current!="number"&&typeof t.current!="string"&&((f=_e(tt))==null||f.playChord(t.current.notes.map(d=>d.midi)),me.setTarget(t.current.notes)),me.setKeyAndScale(o[0],o[1]),me.clearPlayed(),gt.set("waiting"),bt.set(t),t},updateState(l){gt.set(l)},setOptionValue(l,e){ft.update(t=>({...t,[l]:e}))},toggleChords(l){vs.update(e=>e.map(t=>({...t,selected:l(t)})))},nextGuess(){var e,t;const l=_e(bt);l!=null&&l.ended?gt.set("ended"):l instanceof Nt?(l.type==="notes"?me.setTarget([me.getNote(l.current)]):me.setTarget(),me.clearPlayed(),(e=_e(tt))==null||e.noteOn(l.current),ke.updateState("waiting"),l.startTime()):l instanceof ut?(me.setTarget(l.current.notes),me.clearPlayed(),(t=_e(tt))==null||t.playChord(l==null?void 0:l.current.notes.map(s=>s.midi)),gt.set("waiting"),l.startTime()):l instanceof Dt&&(me.setKey(l.current),gt.set("waiting"),l.startTime())},clearGame(l=!1){const e=_e(bt);e&&me.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),l&&ft.set(Xl),bt.set(void 0),gt.set("waiting"),me.clearScore()}};function Gs(l,e,t){const s=l.slice();return s[29]=e[t],s[31]=t,s}function Ms(l,e,t){const s=l.slice();return s[34]=e[t],s}function Vs(l,e,t){const s=l.slice();return s[8]=e[t],s}function Ks(l,e,t){const s=l.slice();return s[29]=e[t],s[31]=t,s}function Os(l,e,t){const s=l.slice();return s[34]=e[t],s}function Fs(l,e,t){const s=l.slice();return s[8]=e[t],s}function zn(l){let e,t=le(l[29].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Us(Os(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Le()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Le()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);F(n,e,r)},p(n,r){if(r[0]&64){t=le(n[29].intervals);let a;for(a=0;a<t.length;a+=1){const o=Os(n,t,a);s[a]?s[a].p(o,r):(s[a]=Us(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function Wn(l){let e,t=le(l[2][l[31]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=xs(Fs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Le()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Le()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);F(n,e,r)},p(n,r){if(r[0]&4){t=le(n[2][n[31]]);let a;for(a=0;a<t.length;a+=1){const o=Fs(n,t,a);s[a]?s[a].p(o,r):(s[a]=xs(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function Us(l){let e,t=l[34].interval+"",s;return{c(){e=p("span"),s=Q(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=T(e);s=Y(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){F(n,e,r),u(e,s)},p(n,r){r[0]&64&&t!==(t=n[34].interval+"")&&ae(s,t)},d(n){n&&m(e)}}}function xs(l){let e,t=l[8].note+"",s;return{c(){e=p("span"),s=Q(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=T(e);s=Y(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){F(n,e,r),u(e,s)},p(n,r){r[0]&4&&t!==(t=n[8].note+"")&&ae(s,t)},d(n){n&&m(e)}}}function $s(l){let e,t,s,n,r,a,o=l[29].suffixes[0]+"",i,c,f,d,_,b,g=l[29].name+"",E,y,D,G;n=new rt({props:{icon:l[29].selected?zt:Wt,width:12}});function K(){return l[25](l[29])}function C(S,j){return S[2][S[31]]&&S[2][S[31]].length>0?Wn:zn}let N=C(l),k=N(l);return{c(){e=p("li"),t=p("button"),s=p("span"),ve(n.$$.fragment),r=P(),a=p("div"),i=Q(o),c=P(),f=p("li"),k.c(),_=P(),b=p("li"),E=Q(g),this.h()},l(S){e=v(S,"LI",{});var j=T(e);t=v(j,"BUTTON",{class:!0});var A=T(t);s=v(A,"SPAN",{class:!0});var O=T(s);ge(n.$$.fragment,O),O.forEach(m),r=B(A),a=v(A,"DIV",{class:!0});var w=T(a);i=Y(w,o),w.forEach(m),A.forEach(m),j.forEach(m),c=B(S),f=v(S,"LI",{class:!0,title:!0});var L=T(f);k.l(L),L.forEach(m),_=B(S),b=v(S,"LI",{class:!0});var I=T(b);E=Y(I,g),I.forEach(m),this.h()},h(){h(s,"class","px-1 py-1 rounded"),z(s,"text-green-500",l[29].selected),z(s,"text-gray-400",!l[29].selected),h(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),h(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),z(t,"hidden",l[7]),h(f,"class","intervals svelte-1j99daw"),h(f,"title",d=l[29].intervals.map(Ws).join("-")),h(b,"class","text-xs")},m(S,j){F(S,e,j),u(e,t),u(t,s),be(n,s,null),u(t,r),u(t,a),u(a,i),F(S,c,j),F(S,f,j),k.m(f,null),F(S,_,j),F(S,b,j),u(b,E),y=!0,D||(G=$(t,"click",K),D=!0)},p(S,j){l=S;const A={};j[0]&64&&(A.icon=l[29].selected?zt:Wt),n.$set(A),(!y||j[0]&64)&&z(s,"text-green-500",l[29].selected),(!y||j[0]&64)&&z(s,"text-gray-400",!l[29].selected),(!y||j[0]&64)&&o!==(o=l[29].suffixes[0]+"")&&ae(i,o),(!y||j[0]&128)&&z(t,"hidden",l[7]),N===(N=C(l))&&k?k.p(l,j):(k.d(1),k=N(l),k&&(k.c(),k.m(f,null))),(!y||j[0]&64&&d!==(d=l[29].intervals.map(Ws).join("-")))&&h(f,"title",d),(!y||j[0]&64)&&g!==(g=l[29].name+"")&&ae(E,g)},i(S){y||(H(n.$$.fragment,S),y=!0)},o(S){J(n.$$.fragment,S),y=!1},d(S){S&&(m(e),m(c),m(f),m(_),m(b)),ye(n),k.d(),D=!1,G()}}}function Jn(l){let e,t=le(l[29].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Rs(Ms(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Le()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Le()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);F(n,e,r)},p(n,r){if(r[0]&32){t=le(n[29].intervals);let a;for(a=0;a<t.length;a+=1){const o=Ms(n,t,a);s[a]?s[a].p(o,r):(s[a]=Rs(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function Qn(l){let e,t=le(l[3][l[31]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Hs(Vs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Le()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Le()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);F(n,e,r)},p(n,r){if(r[0]&8){t=le(n[3][n[31]]);let a;for(a=0;a<t.length;a+=1){const o=Vs(n,t,a);s[a]?s[a].p(o,r):(s[a]=Hs(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function Rs(l){let e,t=l[34].interval+"",s;return{c(){e=p("span"),s=Q(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=T(e);s=Y(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){F(n,e,r),u(e,s)},p(n,r){r[0]&32&&t!==(t=n[34].interval+"")&&ae(s,t)},d(n){n&&m(e)}}}function Hs(l){let e,t=l[8].note+"",s;return{c(){e=p("span"),s=Q(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=T(e);s=Y(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1j99daw")},m(n,r){F(n,e,r),u(e,s)},p(n,r){r[0]&8&&t!==(t=n[8].note+"")&&ae(s,t)},d(n){n&&m(e)}}}function qs(l){let e,t,s,n,r,a,o=l[29].suffixes[0]+"",i,c,f,d,_,b,g=l[29].name+"",E,y,D,G;n=new rt({props:{icon:l[29].selected?zt:Wt,width:12}});function K(){return l[26](l[29])}function C(S,j){return S[3][S[31]]&&S[3][S[31]].length>0?Qn:Jn}let N=C(l),k=N(l);return{c(){e=p("li"),t=p("button"),s=p("span"),ve(n.$$.fragment),r=P(),a=p("div"),i=Q(o),c=P(),f=p("li"),k.c(),_=P(),b=p("li"),E=Q(g),this.h()},l(S){e=v(S,"LI",{});var j=T(e);t=v(j,"BUTTON",{class:!0});var A=T(t);s=v(A,"SPAN",{class:!0});var O=T(s);ge(n.$$.fragment,O),O.forEach(m),r=B(A),a=v(A,"DIV",{class:!0});var w=T(a);i=Y(w,o),w.forEach(m),A.forEach(m),j.forEach(m),c=B(S),f=v(S,"LI",{class:!0,title:!0});var L=T(f);k.l(L),L.forEach(m),_=B(S),b=v(S,"LI",{class:!0});var I=T(b);E=Y(I,g),I.forEach(m),this.h()},h(){h(s,"class","px-1 py-1 rounded"),z(s,"text-green-500",l[29].selected),z(s,"text-gray-400",!l[29].selected),h(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-1j99daw"),h(t,"class","flex items-center justify-center w-full select-btn svelte-1j99daw"),z(t,"hidden",l[7]),h(f,"class","intervals svelte-1j99daw"),h(f,"title",d=l[29].intervals.map(Js).join("-")),h(b,"class","text-xs")},m(S,j){F(S,e,j),u(e,t),u(t,s),be(n,s,null),u(t,r),u(t,a),u(a,i),F(S,c,j),F(S,f,j),k.m(f,null),F(S,_,j),F(S,b,j),u(b,E),y=!0,D||(G=$(t,"click",K),D=!0)},p(S,j){l=S;const A={};j[0]&32&&(A.icon=l[29].selected?zt:Wt),n.$set(A),(!y||j[0]&32)&&z(s,"text-green-500",l[29].selected),(!y||j[0]&32)&&z(s,"text-gray-400",!l[29].selected),(!y||j[0]&32)&&o!==(o=l[29].suffixes[0]+"")&&ae(i,o),(!y||j[0]&128)&&z(t,"hidden",l[7]),N===(N=C(l))&&k?k.p(l,j):(k.d(1),k=N(l),k&&(k.c(),k.m(f,null))),(!y||j[0]&32&&d!==(d=l[29].intervals.map(Js).join("-")))&&h(f,"title",d),(!y||j[0]&32)&&g!==(g=l[29].name+"")&&ae(E,g)},i(S){y||(H(n.$$.fragment,S),y=!0)},o(S){J(n.$$.fragment,S),y=!1},d(S){S&&(m(e),m(c),m(f),m(_),m(b)),ye(n),k.d(),D=!1,G()}}}function Yn(l){let e,t,s,n,r="Chords",a,o,i,c,f,d,_,b,g,E,y,D,G,K,C,N,k,S="Key",j,A,O,w,L="Scale",I,U,M,V,R="Note",te,se,de,ie,Me,xe,Ve,pe,ze,Ue;c=new rt({props:{icon:hn,width:20}}),_=new rt({props:{icon:mn,width:16}}),E=new rt({props:{icon:l[4]?Ts:Ns,width:16}}),G=new rt({props:{icon:Hl,width:16}});let Ie=le(l[6]),re=[];for(let x=0;x<Ie.length;x+=1)re[x]=$s(Ks(l,Ie,x));const Ne=x=>J(re[x],1,1,()=>{re[x]=null});let he=le(l[5]),W=[];for(let x=0;x<he.length;x+=1)W[x]=qs(Gs(l,he,x));const ne=x=>J(W[x],1,1,()=>{W[x]=null});return{c(){e=p("div"),t=p("fieldset"),s=p("legend"),n=p("button"),n.textContent=r,a=P(),o=p("div"),i=p("button"),ve(c.$$.fragment),f=P(),d=p("button"),ve(_.$$.fragment),b=P(),g=p("button"),ve(E.$$.fragment),y=P(),D=p("button"),ve(G.$$.fragment),K=P(),C=p("div"),N=p("div"),k=p("label"),k.textContent=S,j=P(),A=p("input"),O=P(),w=p("label"),w.textContent=L,I=P(),U=p("input"),M=P(),V=p("label"),V.textContent=R,te=P(),se=p("input"),de=P(),ie=p("ul");for(let x=0;x<re.length;x+=1)re[x].c();Me=P(),xe=p("ul");for(let x=0;x<W.length;x+=1)W[x].c();this.h()},l(x){e=v(x,"DIV",{class:!0});var X=T(e);t=v(X,"FIELDSET",{class:!0});var ce=T(t);s=v(ce,"LEGEND",{class:!0});var Z=T(s);n=v(Z,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1knqzl6"&&(n.textContent=r),Z.forEach(m),a=B(ce),o=v(ce,"DIV",{class:!0});var Ee=T(o);i=v(Ee,"BUTTON",{class:!0});var Be=T(i);ge(c.$$.fragment,Be),Be.forEach(m),f=B(Ee),d=v(Ee,"BUTTON",{class:!0});var at=T(d);ge(_.$$.fragment,at),at.forEach(m),b=B(Ee),g=v(Ee,"BUTTON",{class:!0});var We=T(g);ge(E.$$.fragment,We),We.forEach(m),y=B(Ee),D=v(Ee,"BUTTON",{class:!0});var Ke=T(D);ge(G.$$.fragment,Ke),Ke.forEach(m),Ee.forEach(m),K=B(ce),C=v(ce,"DIV",{class:!0});var je=T(C);N=v(je,"DIV",{class:!0});var Se=T(N);k=v(Se,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(k)!=="svelte-14m38zf"&&(k.textContent=S),j=B(Se),A=v(Se,"INPUT",{class:!0,id:!0}),O=B(Se),w=v(Se,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(w)!=="svelte-bxhcb0"&&(w.textContent=L),I=B(Se),U=v(Se,"INPUT",{class:!0,id:!0}),M=B(Se),V=v(Se,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(V)!=="svelte-dmbfli"&&(V.textContent=R),te=B(Se),se=v(Se,"INPUT",{class:!0,id:!0}),Se.forEach(m),de=B(je),ie=v(je,"UL",{class:!0});var It=T(ie);for(let Oe=0;Oe<re.length;Oe+=1)re[Oe].l(It);It.forEach(m),Me=B(je),xe=v(je,"UL",{class:!0});var wt=T(xe);for(let Oe=0;Oe<W.length;Oe+=1)W[Oe].l(wt);wt.forEach(m),je.forEach(m),ce.forEach(m),X.forEach(m),this.h()},h(){h(n,"class","px-1 rounded hover:bg-gray-100"),h(s,"class","text-base"),h(i,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),z(i,"hidden",l[7]),h(d,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),z(d,"hidden",l[7]),h(g,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),z(g,"hidden",l[7]),h(D,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),z(D,"hidden",l[7]),h(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),h(k,"class","mr-4 font-bold svelte-1j99daw"),h(k,"for","scale-key"),h(A,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(A,"id","scale-key"),A.value=l[0],h(w,"class","font-bold svelte-1j99daw"),h(w,"for","scale-key"),h(U,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(U,"id","scale-key"),U.value="Major",U.disabled=!0,h(V,"class","font-bold svelte-1j99daw"),h(V,"for","scale-key"),h(se,"class","bg-gray-100 w-16 px-1 rounded svelte-1j99daw"),h(se,"id","scale-key"),se.value=l[1],h(N,"class","flex mb-2 input svelte-1j99daw"),h(ie,"class","chord-list w-full svelte-1j99daw"),h(xe,"class","chord-list w-full svelte-1j99daw"),h(C,"class","body svelte-1j99daw"),z(C,"hidden",l[7]),h(t,"class","flex flex-col relative rounded border-2 px-4 py-2 my-4 text-sm svelte-1j99daw"),z(t,"collapsed",l[7]),h(e,"class",Ve=Te(`${l[18].class||""}`)+" svelte-1j99daw")},m(x,X){F(x,e,X),u(e,t),u(t,s),u(s,n),u(t,a),u(t,o),u(o,i),be(c,i,null),u(o,f),u(o,d),be(_,d,null),u(o,b),u(o,g),be(E,g,null),u(o,y),u(o,D),be(G,D,null),u(t,K),u(t,C),u(C,N),u(N,k),u(N,j),u(N,A),u(N,O),u(N,w),u(N,I),u(N,U),u(N,M),u(N,V),u(N,te),u(N,se),u(C,de),u(C,ie);for(let ce=0;ce<re.length;ce+=1)re[ce]&&re[ce].m(ie,null);u(C,Me),u(C,xe);for(let ce=0;ce<W.length;ce+=1)W[ce]&&W[ce].m(xe,null);pe=!0,ze||(Ue=[$(n,"click",l[10]),$(i,"click",l[14]),$(d,"click",l[15]),$(g,"click",l[16]),$(D,"click",l[17]),$(A,"input",l[11]),$(A,"focus",l[21]),$(A,"blur",l[22]),$(se,"input",l[12]),$(se,"focus",l[23]),$(se,"blur",l[24])],ze=!0)},p(x,X){(!pe||X[0]&128)&&z(i,"hidden",x[7]),(!pe||X[0]&128)&&z(d,"hidden",x[7]);const ce={};if(X[0]&16&&(ce.icon=x[4]?Ts:Ns),E.$set(ce),(!pe||X[0]&128)&&z(g,"hidden",x[7]),(!pe||X[0]&128)&&z(D,"hidden",x[7]),(!pe||X[0]&1&&A.value!==x[0])&&(A.value=x[0]),(!pe||X[0]&2&&se.value!==x[1])&&(se.value=x[1]),X[0]&8388){Ie=le(x[6]);let Z;for(Z=0;Z<Ie.length;Z+=1){const Ee=Ks(x,Ie,Z);re[Z]?(re[Z].p(Ee,X),H(re[Z],1)):(re[Z]=$s(Ee),re[Z].c(),H(re[Z],1),re[Z].m(ie,null))}for(st(),Z=Ie.length;Z<re.length;Z+=1)Ne(Z);lt()}if(X[0]&8360){he=le(x[5]);let Z;for(Z=0;Z<he.length;Z+=1){const Ee=Gs(x,he,Z);W[Z]?(W[Z].p(Ee,X),H(W[Z],1)):(W[Z]=qs(Ee),W[Z].c(),H(W[Z],1),W[Z].m(xe,null))}for(st(),Z=he.length;Z<W.length;Z+=1)ne(Z);lt()}(!pe||X[0]&128)&&z(C,"hidden",x[7]),(!pe||X[0]&128)&&z(t,"collapsed",x[7]),(!pe||X[0]&262144&&Ve!==(Ve=Te(`${x[18].class||""}`)+" svelte-1j99daw"))&&h(e,"class",Ve)},i(x){if(!pe){H(c.$$.fragment,x),H(_.$$.fragment,x),H(E.$$.fragment,x),H(G.$$.fragment,x);for(let X=0;X<Ie.length;X+=1)H(re[X]);for(let X=0;X<he.length;X+=1)H(W[X]);pe=!0}},o(x){J(c.$$.fragment,x),J(_.$$.fragment,x),J(E.$$.fragment,x),J(G.$$.fragment,x),re=re.filter(Boolean);for(let X=0;X<re.length;X+=1)J(re[X]);W=W.filter(Boolean);for(let X=0;X<W.length;X+=1)J(W[X]);pe=!1},d(x){x&&m(e),ye(c),ye(_),ye(E),ye(G),De(re,x),De(W,x),ze=!1,ot(Ue)}}}let zs="Major";const Ws=l=>l.interval,Js=l=>l.interval;function Xn(l,e,t){let s,n,r,a,o,i;oe(l,vs,M=>t(20,o=M));let c="C",f=Jt(c,zs),d="",_,b=[],g=[];const E=dt(Pe(!0),{key:"chords-hidden"});oe(l,E,M=>t(7,i=M));function y(){E.update(M=>!M)}function D(){const M=_&&60+_.semitones;if("err"in f||!M)t(2,b=[]),t(3,g=[]);else{const V=f.data;t(2,b=n.map(R=>is(M,V,R.intervals))),t(3,g=r.map(R=>is(M,V,R.intervals)))}}function G({currentTarget:{value:M}}){t(0,c=`${M.charAt(0).toUpperCase()}${M.charAt(1).toLowerCase()}`),f=Jt(c,zs),D()}function K({currentTarget:{value:M}}){t(1,d=`${M.charAt(0).toUpperCase()}${M.charAt(1).toLowerCase()}`),t(8,_=Yl(d)),D()}function C(M){ke.toggleChords(V=>V.name===M.name?!V.selected:V.selected)}function N(){const M=R=>R.suffixes[0]==="maj"||R.suffixes[0]==="m",V=o.filter(M).every(R=>R.selected);ke.toggleChords(R=>M(R)?!V:R.selected)}function k(){const M=R=>R.suffixes[0]==="maj7"||R.suffixes[0]==="m7"||R.suffixes[0]==="7"||R.suffixes[0]==="dim7"||R.suffixes[0]==="aug7",V=o.filter(M).every(R=>R.selected);ke.toggleChords(R=>M(R)?!V:R.selected)}function S(){ke.toggleChords(M=>!a)}function j(){ke.toggleChords(M=>!0)}const A=()=>fe.setKeyboardFocus(!1),O=()=>fe.setKeyboardFocus(!0),w=()=>fe.setKeyboardFocus(!1),L=()=>fe.setKeyboardFocus(!0),I=M=>C(M),U=M=>C(M);return l.$$set=M=>{t(18,e=Ce(Ce({},e),we(M)))},l.$$.update=()=>{l.$$.dirty[0]&1048576&&t(19,s=o),l.$$.dirty[0]&524288&&t(6,n=s.filter((M,V)=>V<s.length/2)),l.$$.dirty[0]&524288&&t(5,r=s.filter((M,V)=>V>=s.length/2)),l.$$.dirty[0]&524288&&t(4,a=s.every(M=>M.selected))},e=we(e),[c,d,b,g,a,r,n,i,_,E,y,G,K,C,N,k,S,j,e,s,o,A,O,w,L,I,U]}class Zn extends Re{constructor(e){super(),He(this,e,Xn,Yn,qe,{},null,[-1,-1])}}function Qs(l,e,t){const s=l.slice();return s[10]=e[t],s}function ea(l){let e;return{c(){e=Q(" ")},l(t){e=Y(t," ")},m(t,s){F(t,e,s)},p:ue,d(t){t&&m(e)}}}function ta(l){let e,t,s="Played:",n,r=le(l[2]),a=[];for(let o=0;o<r.length;o+=1)a[o]=Ys(Qs(l,r,o));return{c(){e=p("div"),t=p("span"),t.textContent=s,n=P();for(let o=0;o<a.length;o+=1)a[o].c()},l(o){e=v(o,"DIV",{});var i=T(e);t=v(i,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1g6xxhn"&&(t.textContent=s),n=B(i);for(let c=0;c<a.length;c+=1)a[c].l(i);i.forEach(m)},m(o,i){F(o,e,i),u(e,t),u(e,n);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(e,null)},p(o,i){if(i&4){r=le(o[2]);let c;for(c=0;c<r.length;c+=1){const f=Qs(o,r,c);a[c]?a[c].p(f,i):(a[c]=Ys(f),a[c].c(),a[c].m(e,null))}for(;c<a.length;c+=1)a[c].d(1);a.length=r.length}},d(o){o&&m(e),De(a,o)}}}function sa(l){let e,t,s="Result:",n,r,a,o=l[0].correct+"",i,c,f=l[0].sampled.length+"",d,_,b,g,E,y=l[0].avgTime+"",D,G;return{c(){e=p("div"),t=p("span"),t.textContent=s,n=P(),r=p("span"),a=Q("["),i=Q(o),c=Q(" / "),d=Q(f),_=Q("]"),b=P(),g=p("span"),E=Q("avg "),D=Q(y),G=Q("s"),this.h()},l(K){e=v(K,"DIV",{class:!0});var C=T(e);t=v(C,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1eqfbgx"&&(t.textContent=s),n=B(C),r=v(C,"SPAN",{class:!0});var N=T(r);a=Y(N,"["),i=Y(N,o),c=Y(N," / "),d=Y(N,f),_=Y(N,"]"),N.forEach(m),b=B(C),g=v(C,"SPAN",{});var k=T(g);E=Y(k,"avg "),D=Y(k,y),G=Y(k,"s"),k.forEach(m),C.forEach(m),this.h()},h(){h(r,"class","mx-2"),h(e,"class","flex")},m(K,C){F(K,e,C),u(e,t),u(e,n),u(e,r),u(r,a),u(r,i),u(r,c),u(r,d),u(r,_),u(e,b),u(e,g),u(g,E),u(g,D),u(g,G)},p(K,C){C&1&&o!==(o=K[0].correct+"")&&ae(i,o),C&1&&f!==(f=K[0].sampled.length+"")&&ae(d,f),C&1&&y!==(y=K[0].avgTime+"")&&ae(D,y)},d(K){K&&m(e)}}}function la(l){var S,j,A,O;let e,t,s="Target:",n,r,a=((S=l[0].latestGuess.target)==null?void 0:S.chord)+"",o,i,c,f=((j=l[0].latestGuess.target)==null?void 0:j.notes.map(Xs).join(" "))+"",d,_,b,g="Guessed:",E,y,D=((A=l[0].latestGuess.guessed)==null?void 0:A.chord)+"",G,K,C,N=((O=l[0].latestGuess.guessed)==null?void 0:O.notes.map(Zs).join(" "))+"",k;return{c(){e=p("div"),t=p("span"),t.textContent=s,n=P(),r=p("span"),o=Q(a),i=P(),c=p("span"),d=Q(f),_=P(),b=p("span"),b.textContent=g,E=P(),y=p("span"),G=Q(D),K=P(),C=p("span"),k=Q(N),this.h()},l(w){e=v(w,"DIV",{class:!0});var L=T(e);t=v(L,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=B(L),r=v(L,"SPAN",{});var I=T(r);o=Y(I,a),I.forEach(m),i=B(L),c=v(L,"SPAN",{});var U=T(c);d=Y(U,f),U.forEach(m),_=B(L),b=v(L,"SPAN",{"data-svelte-h":!0}),ee(b)!=="svelte-104368"&&(b.textContent=g),E=B(L),y=v(L,"SPAN",{});var M=T(y);G=Y(M,D),M.forEach(m),K=B(L),C=v(L,"SPAN",{});var V=T(C);k=Y(V,N),V.forEach(m),L.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(w,L){F(w,e,L),u(e,t),u(e,n),u(e,r),u(r,o),u(e,i),u(e,c),u(c,d),u(e,_),u(e,b),u(e,E),u(e,y),u(y,G),u(e,K),u(e,C),u(C,k)},p(w,L){var I,U,M,V;L&1&&a!==(a=((I=w[0].latestGuess.target)==null?void 0:I.chord)+"")&&ae(o,a),L&1&&f!==(f=((U=w[0].latestGuess.target)==null?void 0:U.notes.map(Xs).join(" "))+"")&&ae(d,f),L&1&&D!==(D=((M=w[0].latestGuess.guessed)==null?void 0:M.chord)+"")&&ae(G,D),L&1&&N!==(N=((V=w[0].latestGuess.guessed)==null?void 0:V.notes.map(Zs).join(" "))+"")&&ae(k,N)},d(w){w&&m(e)}}}function na(l){let e,t,s="Target:",n,r,a=l[0].latestGuess.target+"",o,i,c,f,d,_="Guessed:",b,g,E=l[0].latestGuess.guessed+"",y,D,G;return{c(){e=p("div"),t=p("span"),t.textContent=s,n=P(),r=p("span"),o=Q(a),i=P(),c=p("span"),f=P(),d=p("span"),d.textContent=_,b=P(),g=p("span"),y=Q(E),D=P(),G=p("span"),this.h()},l(K){e=v(K,"DIV",{class:!0});var C=T(e);t=v(C,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=B(C),r=v(C,"SPAN",{});var N=T(r);o=Y(N,a),N.forEach(m),i=B(C),c=v(C,"SPAN",{}),T(c).forEach(m),f=B(C),d=v(C,"SPAN",{"data-svelte-h":!0}),ee(d)!=="svelte-104368"&&(d.textContent=_),b=B(C),g=v(C,"SPAN",{});var k=T(g);y=Y(k,E),k.forEach(m),D=B(C),G=v(C,"SPAN",{}),T(G).forEach(m),C.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(K,C){F(K,e,C),u(e,t),u(e,n),u(e,r),u(r,o),u(e,i),u(e,c),u(e,f),u(e,d),u(e,b),u(e,g),u(g,y),u(e,D),u(e,G)},p(K,C){C&1&&a!==(a=K[0].latestGuess.target+"")&&ae(o,a),C&1&&E!==(E=K[0].latestGuess.guessed+"")&&ae(y,E)},d(K){K&&m(e)}}}function aa(l){let e,t,s="Target:",n,r,a=Ye(Tt(l[0].latestGuess.target||0))+"",o,i,c,f,d,_="Guessed:",b,g,E=Ye(Tt(l[0].latestGuess.guessed||0))+"",y,D,G;return{c(){e=p("div"),t=p("span"),t.textContent=s,n=P(),r=p("span"),o=Q(a),i=P(),c=p("span"),f=P(),d=p("span"),d.textContent=_,b=P(),g=p("span"),y=Q(E),D=P(),G=p("span"),this.h()},l(K){e=v(K,"DIV",{class:!0});var C=T(e);t=v(C,"SPAN",{"data-svelte-h":!0}),ee(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=B(C),r=v(C,"SPAN",{});var N=T(r);o=Y(N,a),N.forEach(m),i=B(C),c=v(C,"SPAN",{}),T(c).forEach(m),f=B(C),d=v(C,"SPAN",{"data-svelte-h":!0}),ee(d)!=="svelte-104368"&&(d.textContent=_),b=B(C),g=v(C,"SPAN",{});var k=T(g);y=Y(k,E),k.forEach(m),D=B(C),G=v(C,"SPAN",{}),T(G).forEach(m),C.forEach(m),this.h()},h(){h(e,"class","guessed svelte-1lxfpqs")},m(K,C){F(K,e,C),u(e,t),u(e,n),u(e,r),u(r,o),u(e,i),u(e,c),u(e,f),u(e,d),u(e,b),u(e,g),u(g,y),u(e,D),u(e,G)},p(K,C){C&1&&a!==(a=Ye(Tt(K[0].latestGuess.target||0))+"")&&ae(o,a),C&1&&E!==(E=Ye(Tt(K[0].latestGuess.guessed||0))+"")&&ae(y,E)},d(K){K&&m(e)}}}function Ys(l){let e,t=Ye(l[10])+"",s;return{c(){e=p("span"),s=Q(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=T(e);s=Y(r,t),r.forEach(m),this.h()},h(){h(e,"class","mx-1")},m(n,r){F(n,e,r),u(e,s)},p(n,r){r&4&&t!==(t=Ye(n[10])+"")&&ae(s,t)},d(n){n&&m(e)}}}function ra(l){let e;return{c(){e=Q(" ")},l(t){e=Y(t," ")},m(t,s){F(t,e,s)},p:ue,d(t){t&&m(e)}}}function oa(l){let e,t="Next",s,n,r="Autoplay",a,o;return{c(){e=p("button"),e.textContent=t,s=P(),n=p("button"),n.textContent=r,this.h()},l(i){e=v(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-1nvnoba"&&(e.textContent=t),s=B(i),n=v(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1cfj1sl"&&(n.textContent=r),this.h()},h(){h(e,"class","btn primary"),h(n,"class","btn primary")},m(i,c){F(i,e,c),F(i,s,c),F(i,n,c),a||(o=[$(e,"click",l[4]),$(n,"click",l[5])],a=!0)},p:ue,d(i){i&&(m(e),m(s),m(n)),a=!1,ot(o)}}}function ia(l){let e,t="Stop autoplay",s,n;return{c(){e=p("button"),e.textContent=t,this.h()},l(r){e=v(r,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){h(e,"class","btn primary")},m(r,a){F(r,e,a),s||(n=$(e,"click",l[9]),s=!0)},p:ue,d(r){r&&m(e),s=!1,n()}}}function ca(l){let e,t="Try Again",s,n,r="Clear",a,o;return{c(){e=p("button"),e.textContent=t,s=P(),n=p("button"),n.textContent=r,this.h()},l(i){e=v(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-y911ux"&&(e.textContent=t),s=B(i),n=v(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-11mnk9v"&&(n.textContent=r),this.h()},h(){h(e,"class","btn primary"),h(n,"class","btn primary")},m(i,c){F(i,e,c),F(i,s,c),F(i,n,c),a||(o=[$(e,"click",l[6]),$(n,"click",l[7])],a=!0)},p:ue,d(i){i&&(m(e),m(s),m(n)),a=!1,ot(o)}}}function ua(l){let e,t,s,n;function r(d,_){return d[0]instanceof Nt&&(d[1]==="correct"||d[1]==="wrong")?aa:d[0]instanceof Dt&&(d[1]==="correct"||d[1]==="wrong")?na:d[0]instanceof ut&&(d[1]==="correct"||d[1]==="wrong")?la:d[0]&&d[1]==="ended"?sa:d[2].length>0?ta:ea}let a=r(l),o=a(l);function i(d,_){return d[0]&&d[1]==="ended"?ca:d[0]&&d[3].autoplay?ia:d[0]?oa:ra}let c=i(l),f=c(l);return{c(){e=p("div"),o.c(),s=P(),n=p("div"),f.c(),this.h()},l(d){e=v(d,"DIV",{class:!0});var _=T(e);o.l(_),_.forEach(m),s=B(d),n=v(d,"DIV",{class:!0});var b=T(n);f.l(b),b.forEach(m),this.h()},h(){h(e,"class",t=Te(`${l[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),h(n,"class","mt-2 h-8")},m(d,_){F(d,e,_),o.m(e,null),F(d,s,_),F(d,n,_),f.m(n,null)},p(d,[_]){a===(a=r(d))&&o?o.p(d,_):(o.d(1),o=a(d),o&&(o.c(),o.m(e,null))),_&256&&t!==(t=Te(`${d[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs")&&h(e,"class",t),c===(c=i(d))&&f?f.p(d,_):(f.d(1),f=c(d),f&&(f.c(),f.m(n,null)))},i:ue,o:ue,d(d){d&&(m(e),m(s),m(n)),o.d(),f.d()}}}const Xs=l=>l.note,Zs=l=>l.note;function fa(l,e,t){let s,n,r;oe(l,gt,_=>t(1,s=_)),oe(l,vt,_=>t(2,n=_)),oe(l,ft,_=>t(3,r=_));let{game:a}=e;function o(){ke.nextGuess()}function i(){ke.setOptionValue("autoplay",!0),ke.nextGuess()}function c(){a instanceof ut?ke.play(a.type,a.opts):a&&ke.play(a.type,void 0)}function f(){ke.clearGame()}const d=()=>ke.setOptionValue("autoplay",!1);return l.$$set=_=>{t(8,e=Ce(Ce({},e),we(_))),"game"in _&&t(0,a=_.game)},e=we(e),[a,s,n,r,o,i,c,f,e,d]}class da extends Re{constructor(e){super(),He(this,e,fa,ua,qe,{game:0})}}function el(l){let e;return{c(){e=p("li"),this.h()},l(t){e=v(t,"LI",{class:!0}),T(e).forEach(m),this.h()},h(){h(e,"class","m-[0.175rem] mr-0")},m(t,s){F(t,e,s)},d(t){t&&m(e)}}}function tl(l){let e;return{c(){e=p("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),T(e).forEach(m),this.h()},h(){h(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-jvhfju")},m(t,s){F(t,e,s)},d(t){t&&m(e)}}}function sl(l){let e,t=l[0].note.note+"",s;return{c(){e=p("div"),s=Q(t),this.h()},l(n){e=v(n,"DIV",{class:!0});var r=T(e);s=Y(r,t),r.forEach(m),this.h()},h(){h(e,"class","absolute top-0 left-0")},m(n,r){F(n,e,r),u(e,s)},p(n,r){r&1&&t!==(t=n[0].note.note+"")&&ae(s,t)},d(n){n&&m(e)}}}function ha(l){let e,t,s,n,r,a,o=l[0].key+"",i,c,f,d,_=l[0].key==="{enter}"&&el(),b=l[0].key==="{enter}"&&tl(),g=l[0].note&&sl(l);return{c(){_&&_.c(),e=P(),t=p("li"),s=p("button"),b&&b.c(),n=P(),g&&g.c(),r=P(),a=p("div"),i=Q(o),this.h()},l(E){_&&_.l(E),e=B(E),t=v(E,"LI",{class:!0});var y=T(t);s=v(y,"BUTTON",{class:!0});var D=T(s);b&&b.l(D),n=B(D),g&&g.l(D),r=B(D),a=v(D,"DIV",{});var G=T(a);i=Y(G,o),G.forEach(m),D.forEach(m),y.forEach(m),this.h()},h(){h(s,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex items-center justify-center svelte-jvhfju"),h(t,"class",c=Te(`${l[1].class||""} m-[0.175rem] ${ll(l[0].size)}`)+" svelte-jvhfju"),z(t,"enter",l[0].key==="{enter}")},m(E,y){_&&_.m(E,y),F(E,e,y),F(E,t,y),u(t,s),b&&b.m(s,null),u(s,n),g&&g.m(s,null),u(s,r),u(s,a),u(a,i),f||(d=$(s,"click",l[2]),f=!0)},p(E,[y]){E[0].key==="{enter}"?_||(_=el(),_.c(),_.m(e.parentNode,e)):_&&(_.d(1),_=null),E[0].key==="{enter}"?b||(b=tl(),b.c(),b.m(s,n)):b&&(b.d(1),b=null),E[0].note?g?g.p(E,y):(g=sl(E),g.c(),g.m(s,r)):g&&(g.d(1),g=null),y&1&&o!==(o=E[0].key+"")&&ae(i,o),y&3&&c!==(c=Te(`${E[1].class||""} m-[0.175rem] ${ll(E[0].size)}`)+" svelte-jvhfju")&&h(t,"class",c),y&3&&z(t,"enter",E[0].key==="{enter}")},i:ue,o:ue,d(E){E&&(m(e),m(t)),_&&_.d(E),b&&b.d(),g&&g.d(),f=!1,d()}}}function ll(l){return l&&Number.isInteger(l)?`size-${l}`:l?`size-${Math.floor(l)}-${Math.floor(l*10)-Math.floor(l)*10}`:"size-1"}function ma(l,e,t){let{value:s}=e;function n(r){hs.call(this,l,r)}return l.$$set=r=>{t(1,e=Ce(Ce({},e),we(r))),"value"in r&&t(0,s=r.value)},e=we(e),[s,e,n]}class _a extends Re{constructor(e){super(),He(this,e,ma,ha,qe,{value:0})}}const pa={layout:{default:["§ 1 2 3 4 5 6 7 8 9 0 + ´ {bksp}","{tab} q w e r t y u i o p å ¨ {enter}","{lock} a s d f g h j k l ö ä '","{shift} < z x c v b n m , . - {shift}",".com @ {space}"],shift:['° ! " # $ % & / ( ) = ? ` {bksp}',"{tab} Q W E R T Y U I O P Å ^","{lock} A S D F G H J K L Ö Ä * {enter}","{shift} > Z X C V B N M ; : _ {shift}",".com @ {space}"]}},va=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function ga(l,e){return l[1].forEach((t,s)=>{let n;s===2?n={...e[1]}:s===3?n={...e[3]}:s===5?n={...e[6]}:s===6?n={...e[8]}:s===7?n={...e[10]}:s===9?(n={...e[1]},n.semitones+=12):s===10&&(n={...e[3]},n.semitones+=12),l[1][s].note=n}),l[2].forEach((t,s)=>{let n;s===1?n={...e[0]}:s===2?n={...e[2]}:s===3?n={...e[4]}:s===4?n={...e[5]}:s===5?n={...e[7]}:s===6?n={...e[9]}:s===7?n={...e[11]}:s===8?(n={...e[0]},n.semitones+=12):s===9?(n={...e[2]},n.semitones+=12):s===10?(n={...e[4]},n.semitones+=12):s===11?(n={...e[5]},n.semitones+=12):s===12&&(n={...e[7]},n.semitones+=12),l[2][s].note=n}),l}class ba{constructor(e={layout:"middle-row"}){this.language="en",this.rows=[[],[],[],[]],this.opts=e,this.setLayout(pa)}setOptions(e){this.opts={...this.opts,...e}}setLayout(e){const t=[[],[],[],[]];e.layout.default.forEach((s,n)=>{s.split(" ").forEach((r,a)=>{n<4&&t[n].push({key:r,code:va[n][a]})})}),this.rows=t}setNotes(e){this.opts.layout==="middle-row"&&(this.rows=ga(this.rows,e))}}const gs=/^[a-gA-G]$/,Zl=/^[♭Bb#♯sS]$/,ya=/^[0-9]$/;let q="",ct;const en=Pe(!0),ka=dt(Pe({layout:"middle-row"}),{key:"keyboard-options"}),tn=Ct([kt,ka],([l,e])=>{const t=new ba(e);return t.setNotes(Array.from(l.notesMap.values())),t}),Ca=Ct(tn,l=>l.rows.map(e=>e.map((t,s)=>{let n;return t.key==="{bksp}"?n=2:t.key==="{tab}"?n=1.5:t.key==="{enter}"?n=2:t.key==="{lock}"?n=1.75:t.key==="{shift}"&&s===0?n=1.5:t.key==="{shift}"&&(n=2.5),n?{...t,size:n}:t}))),Xt=Ct(tn,l=>new Map([...l.rows[0].map(e=>[e.code,e]),...l.rows[1].map(e=>[e.code,e]),...l.rows[2].map(e=>[e.code,e]),...l.rows[3].map(e=>[e.code,e])])),wa=Ct(Xt,l=>Array.from(l.values()).map(e=>e.note).filter(e=>e!==void 0));function Ea(l,e){const{useHotkeys:t}=_e(nt),s=_e(Xt).get(l);if(t&&q.length===0&&s&&s.note)return q="",{e:"guessed-key",data:s.note.note};if(!t&&q.length===0&&gs.test(e))return q+=e.toUpperCase(),{e:"string",data:q};if(!t&&q.length>0&&Zl.test(e))return e==="b"||e==="B"?q+="♭":q+="♯",{e:"string",data:q};if(l==="Backspace"&&q.length>0)return q=q.slice(0,-1),{e:"string",data:q};if(l==="Enter"&&q.length>0){const n=q;return q="",{e:"guessed-key",data:n}}return!1}function Sa(l,e,t){if(l==="Enter"&&q.length>0){const s={note:"",flats:0,sharps:0,chord:""};for(let n=0;n<q.length;n+=1)n===0?s.note+=q[n]:s.chord.length>0?s.chord+=q[n].toLowerCase():q[n]==="♭"?(s.note+=q[n],s.flats+=1):q[n]==="♯"?(s.note+=q[n],s.sharps+=1):s.chord+=q[n].toLowerCase();return q="",{e:"guessed-chord",data:s}}else{if(l==="Backspace"&&q.length>0)return q=q.slice(0,-1),{e:"string",data:q};if(q.length===0&&gs.test(e))return q+=e.toUpperCase(),{e:"string",data:q};if(q.length>0&&e.length===1)return q.length===1&&(e==="b"||e==="B")?q+="♭":q.length===1&&e==="#"?q+="♯":q+=e,{e:"string",data:q}}return!1}function Aa(l,e,t){const{useAutoOctave:s,useHotkeys:n}=_e(nt);let r;const o=_e(Xt).get(l),i=(o==null?void 0:o.key)||"";let c=!1;if(!ct&&n&&(o!=null&&o.note)?(ct=o.note,s&&(r=Ql(_e(Yt)[0].midi)),c="note"):!n&&q.length===0&&gs.test(e)?(q+=e.toUpperCase(),c="input"):!n&&q.length>0&&Zl.test(e)&&(e==="b"||e==="B"?q+="♭":q+="♯",c="input"),ya.test(i))try{r=parseInt(i)}catch{}if(ct&&r!==void 0){const f=ct.semitones+(r+1+(t?1:0))*12;return ct=void 0,{e:"guessed-note",data:f}}else if(q&&r!==void 0){const f=sn.findNote(q),d=f?f.semitones+(r+1)*12:void 0;return ct=void 0,q="",d!==void 0?{e:"guessed-note",data:d}:{e:"string",data:q}}else if(l==="Backspace"&&(ct||q.length>0))return ct=void 0,q=q.slice(0,-1),{e:"string",data:q};return c==="note"?{e:"note",data:ct}:c==="input"?{e:"string",data:q}:!1}const sn={setKeyboardFocus(l){en.set(l)},findNote(l){return _e(wa).find(e=>{if(e.note.charAt(0)===l.charAt(0)){const t=l.slice(1).split("").reduce((s,n)=>s+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleInput(l,e,t=!1){const s=_e(bt);return s instanceof Dt?Ea(l,e.toUpperCase()):s instanceof ut&&s.type==="chords-write"?Sa(l,e):_e(nt).useKeyboard?Aa(l,e.toUpperCase(),t):!1}};function nl(l,e,t){const s=l.slice();return s[7]=e[t],s[9]=t,s}function al(l,e,t){const s=l.slice();return s[10]=e[t],s}function rl(l){let e,t;return e=new _a({props:{value:l[10]}}),{c(){ve(e.$$.fragment)},l(s){ge(e.$$.fragment,s)},m(s,n){be(e,s,n),t=!0},p(s,n){const r={};n&4&&(r.value=s[10]),e.$set(r)},i(s){t||(H(e.$$.fragment,s),t=!0)},o(s){J(e.$$.fragment,s),t=!1},d(s){ye(e,s)}}}function ol(l){let e,t,s,n,r=le(l[7]),a=[];for(let i=0;i<r.length;i+=1)a[i]=rl(al(l,r,i));const o=i=>J(a[i],1,1,()=>{a[i]=null});return{c(){e=p("li"),t=P();for(let i=0;i<a.length;i+=1)a[i].c();s=Le(),this.h()},l(i){e=v(i,"LI",{class:!0}),T(e).forEach(m),t=B(i);for(let c=0;c<a.length;c+=1)a[c].l(i);s=Le(),this.h()},h(){h(e,"class","col-span-2 svelte-cgcsqn")},m(i,c){F(i,e,c),F(i,t,c);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(i,c);F(i,s,c),n=!0},p(i,c){if(c&4){r=le(i[7]);let f;for(f=0;f<r.length;f+=1){const d=al(i,r,f);a[f]?(a[f].p(d,c),H(a[f],1)):(a[f]=rl(d),a[f].c(),H(a[f],1),a[f].m(s.parentNode,s))}for(st(),f=r.length;f<a.length;f+=1)o(f);lt()}},i(i){if(!n){for(let c=0;c<r.length;c+=1)H(a[c]);n=!0}},o(i){a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)J(a[c]);n=!1},d(i){i&&(m(e),m(t),m(s)),De(a,i)}}}function Ta(l){let e,t,s,n,r="Middle-row",a,o,i,c,f,d="Two rows",_,b,g,E,y,D,G,K,C,N=le(l[2]),k=[];for(let j=0;j<N.length;j+=1)k[j]=ol(nl(l,N,j));const S=j=>J(k[j],1,1,()=>{k[j]=null});return{c(){e=p("div"),t=p("div"),s=p("div"),n=p("label"),n.textContent=r,a=P(),o=p("input"),i=P(),c=p("div"),f=p("label"),f.textContent=d,_=P(),b=p("input"),g=P(),E=p("div"),y=p("ul");for(let j=0;j<k.length;j+=1)k[j].c();this.h()},l(j){e=v(j,"DIV",{class:!0});var A=T(e);t=v(A,"DIV",{class:!0});var O=T(t);s=v(O,"DIV",{class:!0});var w=T(s);n=v(w,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1ssbs6o"&&(n.textContent=r),a=B(w),o=v(w,"INPUT",{class:!0,id:!0,type:!0}),w.forEach(m),i=B(O),c=v(O,"DIV",{class:!0});var L=T(c);f=v(L,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(f)!=="svelte-3aw9ul"&&(f.textContent=d),_=B(L),b=v(L,"INPUT",{class:!0,id:!0,type:!0}),L.forEach(m),O.forEach(m),g=B(A),E=v(A,"DIV",{class:!0});var I=T(E);y=v(I,"UL",{class:!0});var U=T(y);for(let M=0;M<k.length;M+=1)k[M].l(U);U.forEach(m),I.forEach(m),A.forEach(m),this.h()},h(){h(n,"class","font-bold mr-4"),h(n,"for","middle-row"),h(o,"class","h-[20px]"),h(o,"id","middle-row"),h(o,"type","checkbox"),h(s,"class","my-1 flex items-center justify-between mr-12"),h(f,"class","font-bold mr-4"),h(f,"for","two-rows"),h(b,"class","h-[20px]"),h(b,"id","two-rows"),h(b,"type","checkbox"),h(c,"class","my-1 flex items-center justify-between mr-12"),h(t,"class","flex"),h(y,"class","keyboard svelte-cgcsqn"),h(E,"class","flex flex-col gap-1.5"),h(e,"class",D=Te(`${l[3].class||""} `)+" svelte-cgcsqn")},m(j,A){F(j,e,A),u(e,t),u(t,s),u(s,n),u(s,a),u(s,o),o.checked=l[0],u(t,i),u(t,c),u(c,f),u(c,_),u(c,b),b.checked=l[1],u(e,g),u(e,E),u(E,y);for(let O=0;O<k.length;O+=1)k[O]&&k[O].m(y,null);G=!0,K||(C=[$(o,"change",l[4]),$(b,"change",l[5])],K=!0)},p(j,[A]){if(A&1&&(o.checked=j[0]),A&2&&(b.checked=j[1]),A&4){N=le(j[2]);let O;for(O=0;O<N.length;O+=1){const w=nl(j,N,O);k[O]?(k[O].p(w,A),H(k[O],1)):(k[O]=ol(w),k[O].c(),H(k[O],1),k[O].m(y,null))}for(st(),O=N.length;O<k.length;O+=1)S(O);lt()}(!G||A&8&&D!==(D=Te(`${j[3].class||""} `)+" svelte-cgcsqn"))&&h(e,"class",D)},i(j){if(!G){for(let A=0;A<N.length;A+=1)H(k[A]);G=!0}},o(j){k=k.filter(Boolean);for(let A=0;A<k.length;A+=1)J(k[A]);G=!1},d(j){j&&m(e),De(k,j),K=!1,ot(C)}}}function Na(l,e,t){let s,n;oe(l,Xt,c=>t(6,s=c)),oe(l,Ca,c=>t(2,n=c)),Fl(()=>{console.log(s)});let r=!0,a=!1;function o(){r=this.checked,t(0,r)}function i(){a=this.checked,t(1,a)}return l.$$set=c=>{t(3,e=Ce(Ce({},e),we(c)))},e=we(e),[r,a,n,e,o,i]}class Ia extends Re{constructor(e){super(),He(this,e,Na,Ta,qe,{})}}function il(l){let e,t;return e=new Ia({props:{class:"mt-4"}}),{c(){ve(e.$$.fragment)},l(s){ge(e.$$.fragment,s)},m(s,n){be(e,s,n),t=!0},i(s){t||(H(e.$$.fragment,s),t=!0)},o(s){J(e.$$.fragment,s),t=!1},d(s){ye(e,s)}}}function ja(l){let e,t,s,n,r="I/O",a,o,i,c,f="Device",d,_,b,g,E,y,D="Prompt",G,K,C="Disable",N,k,S,j,A="Sound",O,w,L,I,U,M,V="Fixed velocity",R,te,se,de,ie,Me,xe="Keyboard",Ve,pe,ze,Ue,Ie,re,Ne="Hotkeys",he,W,ne,x,X,ce,Z="Auto-octave",Ee,Be,at,We,Ke,je,Se,It="Set keys",wt,Oe,ht,bs="Fade timeout",Zt,Xe,es,mt,Lt,ts,_t,ys="Reset all",ss,Pt,Je,ls,ks,Ge=l[2]&&il();return{c(){e=p("div"),t=p("fieldset"),s=p("legend"),n=p("button"),n.textContent=r,a=P(),o=p("div"),i=p("div"),c=p("label"),c.textContent=f,d=P(),_=p("input"),g=P(),E=p("div"),y=p("button"),y.textContent=D,G=P(),K=p("button"),K.textContent=C,N=P(),k=p("div"),S=p("div"),j=p("label"),j.textContent=A,O=P(),w=p("input"),I=P(),U=p("div"),M=p("label"),M.textContent=V,R=P(),te=p("input"),se=P(),de=p("div"),ie=p("div"),Me=p("label"),Me.textContent=xe,Ve=P(),pe=p("input"),Ue=P(),Ie=p("div"),re=p("label"),re.textContent=Ne,he=P(),W=p("input"),x=P(),X=p("div"),ce=p("label"),ce.textContent=Z,Ee=P(),Be=p("input"),We=P(),Ke=p("div"),je=p("div"),Se=p("button"),Se.textContent=It,wt=P(),Oe=p("div"),ht=p("label"),ht.textContent=bs,Zt=P(),Xe=p("input"),es=P(),mt=p("div"),Lt=p("div"),ts=P(),_t=p("button"),_t.textContent=ys,ss=P(),Ge&&Ge.c(),this.h()},l(Ae){e=v(Ae,"DIV",{class:!0});var Fe=T(e);t=v(Fe,"FIELDSET",{class:!0});var it=T(t);s=v(it,"LEGEND",{class:!0});var Cs=T(s);n=v(Cs,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1jbbsti"&&(n.textContent=r),Cs.forEach(m),a=B(it),o=v(it,"DIV",{class:!0});var pt=T(o);i=v(pt,"DIV",{class:!0});var Et=T(i);c=v(Et,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(c)!=="svelte-crpa7y"&&(c.textContent=f),d=B(Et),_=v(Et,"INPUT",{class:!0,id:!0}),g=B(Et),E=v(Et,"DIV",{class:!0});var Bt=T(E);y=v(Bt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(y)!=="svelte-mj6mct"&&(y.textContent=D),G=B(Bt),K=v(Bt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(K)!=="svelte-1sl6oxh"&&(K.textContent=C),Bt.forEach(m),Et.forEach(m),N=B(pt),k=v(pt,"DIV",{class:!0});var Gt=T(k);S=v(Gt,"DIV",{class:!0});var Mt=T(S);j=v(Mt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(j)!=="svelte-wgxtkw"&&(j.textContent=A),O=B(Mt),w=v(Mt,"INPUT",{class:!0,id:!0,type:!0}),Mt.forEach(m),I=B(Gt),U=v(Gt,"DIV",{class:!0});var Vt=T(U);M=v(Vt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(M)!=="svelte-1tm2bth"&&(M.textContent=V),R=B(Vt),te=v(Vt,"INPUT",{class:!0,id:!0,placeholder:!0}),Vt.forEach(m),Gt.forEach(m),se=B(pt),de=v(pt,"DIV",{class:!0});var St=T(de);ie=v(St,"DIV",{class:!0});var Kt=T(ie);Me=v(Kt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(Me)!=="svelte-1js269u"&&(Me.textContent=xe),Ve=B(Kt),pe=v(Kt,"INPUT",{class:!0,id:!0,type:!0}),Kt.forEach(m),Ue=B(St),Ie=v(St,"DIV",{class:!0});var Ot=T(Ie);re=v(Ot,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(re)!=="svelte-21h39k"&&(re.textContent=Ne),he=B(Ot),W=v(Ot,"INPUT",{class:!0,id:!0,type:!0}),Ot.forEach(m),x=B(St),X=v(St,"DIV",{class:!0});var Ft=T(X);ce=v(Ft,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(ce)!=="svelte-33lczu"&&(ce.textContent=Z),Ee=B(Ft),Be=v(Ft,"INPUT",{class:!0,id:!0,type:!0}),Ft.forEach(m),St.forEach(m),We=B(pt),Ke=v(pt,"DIV",{class:!0});var At=T(Ke);je=v(At,"DIV",{class:!0});var ws=T(je);Se=v(ws,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(Se)!=="svelte-1npcis2"&&(Se.textContent=It),ws.forEach(m),wt=B(At),Oe=v(At,"DIV",{class:!0});var Ut=T(Oe);ht=v(Ut,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(ht)!=="svelte-vd5i27"&&(ht.textContent=bs),Zt=B(Ut),Xe=v(Ut,"INPUT",{class:!0,id:!0}),Ut.forEach(m),es=B(At),mt=v(At,"DIV",{class:!0});var xt=T(mt);Lt=v(xt,"DIV",{}),T(Lt).forEach(m),ts=B(xt),_t=v(xt,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(_t)!=="svelte-jjt0c3"&&(_t.textContent=ys),xt.forEach(m),At.forEach(m),pt.forEach(m),ss=B(it),Ge&&Ge.l(it),it.forEach(m),Fe.forEach(m),this.h()},h(){var Ae;h(n,"class","px-1 rounded hover:bg-gray-100"),h(s,"class","text-base"),h(c,"class","font-bold"),h(c,"for","device"),h(_,"class","px-1 my-1 rounded w-50"),h(_,"id","device"),_.disabled=!0,_.value=b=((Ae=l[5])==null?void 0:Ae.name)??"No device",h(y,"class","btn-sm primary mr-2"),h(K,"class","btn-sm primary"),h(E,"class","flex my-[auto]"),h(i,"class","h-full flex flex-col"),h(j,"class","font-bold"),h(j,"for","sound"),h(w,"class","h-[20px]"),h(w,"id","sound"),h(w,"type","checkbox"),w.checked=L=l[3].useSound,h(S,"class","my-1 flex justify-between mr-12"),h(M,"class","font-bold"),h(M,"for","fixed-velocity"),h(te,"class","h-[20px] w-16"),h(te,"id","fixed-velocity"),h(te,"placeholder","0-127"),h(U,"class","flex justify-between"),h(k,"class","flex flex-col h-full"),h(Me,"class","font-bold"),h(Me,"for","keyboard"),h(pe,"class","h-[20px]"),h(pe,"id","keyboard"),h(pe,"type","checkbox"),pe.checked=ze=l[3].useKeyboard,h(ie,"class","my-1 flex justify-between mr-12"),h(re,"class","font-bold"),h(re,"for","hotkeys"),h(W,"class","h-[20px]"),h(W,"id","hotkeys"),h(W,"type","checkbox"),W.checked=ne=l[3].useHotkeys,h(Ie,"class","my-1 flex justify-between mr-12"),h(ce,"class","font-bold"),h(ce,"for","auto-octave"),h(Be,"class","h-[20px]"),h(Be,"id","auto-octave"),h(Be,"type","checkbox"),Be.checked=at=l[3].useAutoOctave,h(X,"class","my-1 flex justify-between mr-12"),h(de,"class","flex flex-col h-full"),h(Se,"class","w-full btn-sm primary"),h(je,"class","flex justify-between"),h(ht,"class","font-bold"),h(ht,"for","fade-timeout"),h(Xe,"class","h-[20px] w-16"),h(Xe,"id","fade-timeout"),Xe.value=l[1],h(Oe,"class","flex justify-between"),h(_t,"class","btn-sm primary"),h(mt,"class","flex justify-between"),h(Ke,"class","flex flex-col justify-between h-full"),h(o,"class","body svelte-1bpw69s"),z(o,"hidden",l[4]),h(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-1bpw69s"),z(t,"collapsed",l[4]),h(e,"class",Pt=Te(`${l[11].class||""}`)+" svelte-1bpw69s")},m(Ae,Fe){F(Ae,e,Fe),u(e,t),u(t,s),u(s,n),u(t,a),u(t,o),u(o,i),u(i,c),u(i,d),u(i,_),u(i,g),u(i,E),u(E,y),u(E,G),u(E,K),u(o,N),u(o,k),u(k,S),u(S,j),u(S,O),u(S,w),u(k,I),u(k,U),u(U,M),u(U,R),u(U,te),Qe(te,l[0]),u(o,se),u(o,de),u(de,ie),u(ie,Me),u(ie,Ve),u(ie,pe),u(de,Ue),u(de,Ie),u(Ie,re),u(Ie,he),u(Ie,W),u(de,x),u(de,X),u(X,ce),u(X,Ee),u(X,Be),u(o,We),u(o,Ke),u(Ke,je),u(je,Se),u(Ke,wt),u(Ke,Oe),u(Oe,ht),u(Oe,Zt),u(Oe,Xe),u(Ke,es),u(Ke,mt),u(mt,Lt),u(mt,ts),u(mt,_t),u(t,ss),Ge&&Ge.m(t,null),Je=!0,ls||(ks=[$(n,"click",l[7]),$(y,"click",fe.openMidi),$(K,"click",fe.disableMidi),$(w,"change",l[12]),$(te,"input",l[13]),$(te,"focus",l[14]),$(te,"change",l[8]),$(pe,"change",l[15]),$(W,"change",l[16]),$(Be,"change",l[17]),$(Se,"click",l[18]),$(Xe,"focus",l[19]),$(Xe,"blur",l[20]),$(Xe,"input",l[9]),$(_t,"click",l[10])],ls=!0)},p(Ae,[Fe]){var it;(!Je||Fe&32&&b!==(b=((it=Ae[5])==null?void 0:it.name)??"No device")&&_.value!==b)&&(_.value=b),(!Je||Fe&8&&L!==(L=Ae[3].useSound))&&(w.checked=L),Fe&1&&te.value!==Ae[0]&&Qe(te,Ae[0]),(!Je||Fe&8&&ze!==(ze=Ae[3].useKeyboard))&&(pe.checked=ze),(!Je||Fe&8&&ne!==(ne=Ae[3].useHotkeys))&&(W.checked=ne),(!Je||Fe&8&&at!==(at=Ae[3].useAutoOctave))&&(Be.checked=at),(!Je||Fe&2&&Xe.value!==Ae[1])&&(Xe.value=Ae[1]),(!Je||Fe&16)&&z(o,"hidden",Ae[4]),Ae[2]?Ge?Fe&4&&H(Ge,1):(Ge=il(),Ge.c(),H(Ge,1),Ge.m(t,null)):Ge&&(st(),J(Ge,1,1,()=>{Ge=null}),lt()),(!Je||Fe&16)&&z(t,"collapsed",Ae[4]),(!Je||Fe&2048&&Pt!==(Pt=Te(`${Ae[11].class||""}`)+" svelte-1bpw69s"))&&h(e,"class",Pt)},i(Ae){Je||(H(Ge),Je=!0)},o(Ae){J(Ge),Je=!1},d(Ae){Ae&&m(e),Ge&&Ge.d(),ls=!1,ot(ks)}}}function Da(l,e,t){let s,n,r;oe(l,nt,S=>t(3,s=S)),oe(l,Qt,S=>t(5,r=S));const a=dt(Pe(!1),{key:"inputs-hidden"});oe(l,a,S=>t(4,n=S));let o=s.fixedVelocity??"",i=s.keyFadeTimeout,c=!1;nt.subscribe(S=>{t(0,o=S.fixedVelocity??""),t(1,i=S.keyFadeTimeout)});function f(){a.update(S=>!S)}function d(S){const{value:j}=S.currentTarget;let A;if(j)try{A=parseInt(j)}catch{}A!==void 0&&A>=0&&A<=127?fe.setInputValue("fixedVelocity",A):j?t(0,o=s.fixedVelocity||""):fe.setInputValue("fixedVelocity",void 0),fe.setKeyboardFocus(!0)}function _(S){try{const j=parseInt(S.currentTarget.value);fe.setInputValue("keyFadeTimeout",j)}catch{t(1,i=s.keyFadeTimeout)}}function b(){Ln()}const g=S=>fe.setInputValue("useSound",S.currentTarget.checked);function E(){o=this.value,t(0,o)}const y=()=>fe.setKeyboardFocus(!1),D=S=>fe.setInputValue("useKeyboard",S.currentTarget.checked),G=S=>fe.setInputValue("useHotkeys",S.currentTarget.checked),K=S=>fe.setInputValue("useAutoOctave",S.currentTarget.checked),C=()=>t(2,c=!c),N=()=>fe.setKeyboardFocus(!1),k=()=>fe.setKeyboardFocus(!0);return l.$$set=S=>{t(11,e=Ce(Ce({},e),we(S)))},e=we(e),[o,i,c,s,n,r,a,f,d,_,b,e,g,E,y,D,G,K,C,N,k]}class La extends Re{constructor(e){super(),He(this,e,Da,ja,qe,{})}}function Pa(l){let e;return{c(){e=Q(" ")},l(t){e=Y(t," ")},m(t,s){F(t,e,s)},p:ue,d(t){t&&m(e)}}}function Ba(l){let e,t=l[1].note+"",s;return{c(){e=Q("Input: "),s=Q(t)},l(n){e=Y(n,"Input: "),s=Y(n,t)},m(n,r){F(n,e,r),F(n,s,r)},p(n,r){r&2&&t!==(t=n[1].note+"")&&ae(s,t)},d(n){n&&(m(e),m(s))}}}function Ga(l){let e,t;return{c(){e=Q("Input: "),t=Q(l[0])},l(s){e=Y(s,"Input: "),t=Y(s,l[0])},m(s,n){F(s,e,n),F(s,t,n)},p(s,n){n&1&&ae(t,s[0])},d(s){s&&(m(e),m(t))}}}function Ma(l){let e;return{c(){e=Q(ds)},l(t){e=Y(t,ds)},m(t,s){F(t,e,s)},p:ue,d(t){t&&m(e)}}}function Va(l){let e,t,s,n;function r(i,c){return i[2].useKeyboard&&ds?Ma:i[2].useKeyboard&&i[0]?Ga:i[2].useKeyboard&&i[1]?Ba:Pa}let a=r(l),o=a(l);return{c(){e=p("div"),o.c(),this.h()},l(i){e=v(i,"DIV",{class:!0});var c=T(e);o.l(c),c.forEach(m),this.h()},h(){h(e,"class",t=`${l[4].class||""}`)},m(i,c){F(i,e,c),o.m(e,null),s||(n=$(window,"keydown",l[3]),s=!0)},p(i,[c]){a===(a=r(i))&&o?o.p(i,c):(o.d(1),o=a(i),o&&(o.c(),o.m(e,null))),c&16&&t!==(t=`${i[4].class||""}`)&&h(e,"class",t)},i:ue,o:ue,d(i){i&&m(e),o.d(),s=!1,n()}}}let ds="";function Ka(l,e,t){let s,n;oe(l,en,f=>t(6,s=f)),oe(l,nt,f=>t(2,n=f));let{debounced:r}=e,a="",o;const i=on();function c(f){if(r||!s)return;const d=sn.handleInput(f.code,f.key,f.shiftKey);d&&d.e==="note"?t(1,o=d.data):d&&d.e==="string"?t(0,a=d.data):d&&i(d.e,d.data)}return l.$$set=f=>{t(4,e=Ce(Ce({},e),we(f))),"debounced"in f&&t(5,r=f.debounced)},e=we(e),[a,o,n,c,e,r]}class Oa extends Re{constructor(e){super(),He(this,e,Ka,Va,qe,{debounced:5})}}function Fa(l){let e,t,s,n="Count",r,a,o,i,c,f="Duplicates",d,_,b,g,E,y,D="Autoplay",G,K,C,N,k,S,j="Wait seconds",A,O,w,L,I;return{c(){e=p("ul"),t=p("li"),s=p("label"),s.textContent=n,r=P(),a=p("input"),o=P(),i=p("li"),c=p("label"),c.textContent=f,d=P(),_=p("input"),g=P(),E=p("li"),y=p("label"),y.textContent=D,G=P(),K=p("input"),N=P(),k=p("li"),S=p("label"),S.textContent=j,A=P(),O=p("input"),this.h()},l(U){e=v(U,"UL",{class:!0});var M=T(e);t=v(M,"LI",{class:!0});var V=T(t);s=v(V,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(s)!=="svelte-wgq9fc"&&(s.textContent=n),r=B(V),a=v(V,"INPUT",{class:!0,id:!0,type:!0}),V.forEach(m),o=B(M),i=v(M,"LI",{class:!0});var R=T(i);c=v(R,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(c)!=="svelte-hcg9dq"&&(c.textContent=f),d=B(R),_=v(R,"INPUT",{class:!0,id:!0,type:!0}),R.forEach(m),g=B(M),E=v(M,"LI",{class:!0});var te=T(E);y=v(te,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(y)!=="svelte-lr68n2"&&(y.textContent=D),G=B(te),K=v(te,"INPUT",{class:!0,id:!0,type:!0}),te.forEach(m),N=B(M),k=v(M,"LI",{class:!0});var se=T(k);S=v(se,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(S)!=="svelte-1qj2vcy"&&(S.textContent=j),A=B(se),O=v(se,"INPUT",{class:!0,id:!0,type:!0}),se.forEach(m),M.forEach(m),this.h()},h(){h(s,"class","font-bold"),h(s,"for","guess-count"),h(a,"class","h-[20px] w-10"),h(a,"id","guess-count"),h(a,"type","number"),h(t,"class","flex items-center justify-between svelte-1elvih2"),h(c,"class","font-bold"),h(c,"for","duplicates"),h(_,"class","h-[20px]"),h(_,"id","duplicates"),h(_,"type","checkbox"),_.checked=b=l[2].duplicates,h(i,"class","flex items-center justify-between mr-6 svelte-1elvih2"),h(y,"class","font-bold"),h(y,"for","autoplay"),h(K,"class","h-[20px]"),h(K,"id","autoplay"),h(K,"type","checkbox"),K.checked=C=l[2].autoplay,h(E,"class","flex items-center justify-between mr-6 svelte-1elvih2"),h(S,"class","font-bold"),h(S,"for","wait-ms"),h(O,"class","h-[20px] w-10"),h(O,"id","wait-ms"),h(O,"type","number"),h(k,"class","flex items-center justify-between svelte-1elvih2"),h(e,"class",w=Te(`${l[5].class||""}`)+" svelte-1elvih2")},m(U,M){F(U,e,M),u(e,t),u(t,s),u(t,r),u(t,a),Qe(a,l[0]),u(e,o),u(e,i),u(i,c),u(i,d),u(i,_),u(e,g),u(e,E),u(E,y),u(E,G),u(E,K),u(e,N),u(e,k),u(k,S),u(k,A),u(k,O),Qe(O,l[1]),L||(I=[$(a,"input",l[6]),$(a,"input",l[3]),$(_,"input",l[7]),$(K,"input",l[8]),$(O,"input",l[9]),$(O,"input",l[4])],L=!0)},p(U,[M]){M&1&&qt(a.value)!==U[0]&&Qe(a,U[0]),M&4&&b!==(b=U[2].duplicates)&&(_.checked=b),M&4&&C!==(C=U[2].autoplay)&&(K.checked=C),M&2&&qt(O.value)!==U[1]&&Qe(O,U[1]),M&32&&w!==(w=Te(`${U[5].class||""}`)+" svelte-1elvih2")&&h(e,"class",w)},i:ue,o:ue,d(U){U&&m(e),L=!1,ot(I)}}}function Ua(l,e,t){let s;oe(l,ft,_=>t(2,s=_));let n=s.count||"",r=s.waitSeconds||"";ft.subscribe(_=>{t(0,n=_.count||""),t(1,r=_.waitSeconds||"")});function a({currentTarget:{value:_}}){let b;try{b=parseInt(_),b<=0&&(b=1),ke.setOptionValue("count",b)}catch{t(0,n=s.count)}}function o({currentTarget:{value:_}}){let b;try{b=parseInt(_),b<0&&(b=0),ke.setOptionValue("waitSeconds",b)}catch{t(1,r=s.waitSeconds)}}function i(){n=qt(this.value),t(0,n)}const c=_=>ke.setOptionValue("duplicates",_.currentTarget.checked),f=_=>ke.setOptionValue("autoplay",_.currentTarget.checked);function d(){r=qt(this.value),t(1,r)}return l.$$set=_=>{t(5,e=Ce(Ce({},e),we(_)))},e=we(e),[n,r,s,a,o,e,i,c,f,d]}class xa extends Re{constructor(e){super(),He(this,e,Ua,Fa,qe,{})}}function cl(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function ul(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function fl(l){let e,t,s=l[21]+"",n,r,a,o,i,c,f,d;function _(){return l[13](l[20])}o=new rt({props:{icon:os,width:20}});function b(...g){return l[14](l[20],...g)}return{c(){e=p("li"),t=p("button"),n=Q(s),r=P(),a=p("button"),ve(o.$$.fragment),i=P(),this.h()},l(g){e=v(g,"LI",{class:!0});var E=T(e);t=v(E,"BUTTON",{class:!0});var y=T(t);n=Y(y,s),y.forEach(m),r=B(E),a=v(E,"BUTTON",{class:!0});var D=T(a);ge(o.$$.fragment,D),D.forEach(m),i=B(E),E.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),z(t,"selected",l[20]===l[0]),h(a,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),h(e,"class","flex svelte-1okhpct")},m(g,E){F(g,e,E),u(e,t),u(t,n),u(e,r),u(e,a),be(o,a,null),u(e,i),c=!0,f||(d=[$(t,"click",_),$(a,"click",b)],f=!0)},p(g,E){l=g,(!c||E&17)&&z(t,"selected",l[20]===l[0])},i(g){c||(H(o.$$.fragment,g),c=!0)},o(g){J(o.$$.fragment,g),c=!1},d(g){g&&m(e),ye(o),f=!1,ot(d)}}}function dl(l){let e,t=le(l[2]),s=[];for(let n=0;n<t.length;n+=1)s[n]=hl(cl(l,t,n));return{c(){e=p("ul");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=v(n,"UL",{class:!0});var r=T(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(m),this.h()},h(){h(e,"class","svelte-1okhpct")},m(n,r){F(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r&518){t=le(n[2]);let a;for(a=0;a<t.length;a+=1){const o=cl(n,t,a);s[a]?s[a].p(o,r):(s[a]=hl(o),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function hl(l){let e,t,s=l[21]+"",n,r,a,o;function i(){return l[15](l[20])}return{c(){e=p("li"),t=p("button"),n=Q(s),r=P(),this.h()},l(c){e=v(c,"LI",{class:!0});var f=T(e);t=v(f,"BUTTON",{class:!0});var d=T(t);n=Y(d,s),d.forEach(m),r=B(f),f.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),z(t,"selected",l[20]===l[1]),h(e,"class","svelte-1okhpct")},m(c,f){F(c,e,f),u(e,t),u(t,n),u(e,r),a||(o=$(t,"click",i),a=!0)},p(c,f){l=c,f&4&&s!==(s=l[21]+"")&&ae(n,s),f&6&&z(t,"selected",l[20]===l[1])},d(c){c&&m(e),a=!1,o()}}}function $a(l){let e,t,s="Play",n,r,a,o,i,c,f,d,_,b,g="Reset",E,y,D,G,K=l[3]?"Quit":"Play",C,N,k,S,j,A=le(l[4]),O=[];for(let I=0;I<A.length;I+=1)O[I]=fl(ul(l,A,I));const w=I=>J(O[I],1,1,()=>{O[I]=null});let L=(l[0]==="chords-write"||l[0]==="chords-play")&&dl(l);return f=new xa({props:{class:"game-options"}}),D=new rt({props:{class:"mr-1",icon:l[3]?Is:os,width:20}}),{c(){e=p("fieldset"),t=p("legend"),t.textContent=s,n=P(),r=p("div"),a=p("ul");for(let I=0;I<O.length;I+=1)O[I].c();o=P(),i=p("div"),L&&L.c(),c=P(),ve(f.$$.fragment),d=P(),_=p("div"),b=p("button"),b.textContent=g,E=P(),y=p("button"),ve(D.$$.fragment),G=P(),C=Q(K),this.h()},l(I){e=v(I,"FIELDSET",{class:!0});var U=T(e);t=v(U,"LEGEND",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-1409tnk"&&(t.textContent=s),n=B(U),r=v(U,"DIV",{class:!0});var M=T(r);a=v(M,"UL",{class:!0});var V=T(a);for(let de=0;de<O.length;de+=1)O[de].l(V);V.forEach(m),o=B(M),i=v(M,"DIV",{class:!0});var R=T(i);L&&L.l(R),R.forEach(m),c=B(M),ge(f.$$.fragment,M),d=B(M),_=v(M,"DIV",{class:!0});var te=T(_);b=v(te,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(b)!=="svelte-10rv0bu"&&(b.textContent=g),E=B(te),y=v(te,"BUTTON",{class:!0});var se=T(y);ge(D.$$.fragment,se),G=B(se),C=Y(se,K),se.forEach(m),te.forEach(m),M.forEach(m),U.forEach(m),this.h()},h(){h(t,"class","px-1 text-base"),h(a,"class","games svelte-1okhpct"),h(i,"class","options svelte-1okhpct"),h(b,"class","w-full btn hover:bg-gray-200"),h(y,"class","w-full mt-2 flex items-center justify-center btn primary"),h(_,"class","h-full flex flex-col justify-end"),h(r,"class","body pb-2 h-full svelte-1okhpct"),h(e,"class",N=Te(`${l[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(I,U){F(I,e,U),u(e,t),u(e,n),u(e,r),u(r,a);for(let M=0;M<O.length;M+=1)O[M]&&O[M].m(a,null);u(r,o),u(r,i),L&&L.m(i,null),u(r,c),be(f,r,null),u(r,d),u(r,_),u(_,b),u(_,E),u(_,y),be(D,y,null),u(y,G),u(y,C),k=!0,S||(j=[$(b,"click",l[5]),$(y,"click",l[16])],S=!0)},p(I,[U]){if(U&401){A=le(I[4]);let V;for(V=0;V<A.length;V+=1){const R=ul(I,A,V);O[V]?(O[V].p(R,U),H(O[V],1)):(O[V]=fl(R),O[V].c(),H(O[V],1),O[V].m(a,null))}for(st(),V=A.length;V<O.length;V+=1)w(V);lt()}I[0]==="chords-write"||I[0]==="chords-play"?L?L.p(I,U):(L=dl(I),L.c(),L.m(i,null)):L&&(L.d(1),L=null);const M={};U&8&&(M.icon=I[3]?Is:os),D.$set(M),(!k||U&8)&&K!==(K=I[3]?"Quit":"Play")&&ae(C,K),(!k||U&1024&&N!==(N=Te(`${I[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&h(e,"class",N)},i(I){if(!k){for(let U=0;U<A.length;U+=1)H(O[U]);H(f.$$.fragment,I),H(D.$$.fragment,I),k=!0}},o(I){O=O.filter(Boolean);for(let U=0;U<O.length;U+=1)J(O[U]);J(f.$$.fragment,I),J(D.$$.fragment,I),k=!1},d(I){I&&m(e),De(O,I),L&&L.d(),ye(f),ye(D),S=!1,ot(j)}}}function Ra(l,e,t){let s,n,r,a,o;oe(l,vs,C=>t(12,r=C)),oe(l,ft,C=>t(19,a=C)),oe(l,bt,C=>t(3,o=C));const i=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let c=i[4].key,f="maj-m";a.count,a.waitSeconds,ft.subscribe(C=>{C.count,C.waitSeconds});function d(){ke.clearGame(!0)}function _(C,N){if(N==="chords-write"||N==="chords-play"||N==="chords-diatonic"){let k=[];f==="selected"?k=r.filter(S=>S.selected):f==="all"?k=r:f==="maj-m"?k=r.filter(S=>S.suffixes[0]==="maj"||S.suffixes[0]==="m"):f==="seventh"&&(k=r.filter(S=>S.suffixes[0]==="maj7"||S.suffixes[0]==="m7"||S.suffixes[0]==="7"||S.suffixes[0]==="dim7"||S.suffixes[0]==="aug7")),ke.play(N,{chords:k})}else ke.play(N,void 0);C.currentTarget instanceof HTMLElement&&C.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function b(C){t(0,c=C)}function g(C,N){t(0,c=N),_(C,N)}function E(C){t(1,f=C)}const y=C=>b(C),D=(C,N)=>g(N,C),G=C=>E(C),K=C=>_(C,c);return l.$$set=C=>{t(10,e=Ce(Ce({},e),we(C)))},l.$$.update=()=>{l.$$.dirty&4096&&t(11,s=r.reduce((C,N)=>N.selected?C+1:C,0)),l.$$.dirty&2048&&t(2,n=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${s} chords`},{key:"all",value:"All"}])},e=we(e),[c,f,n,o,i,d,_,b,g,E,e,s,r,y,D,G,K]}class Ha extends Re{constructor(e){super(),He(this,e,Ra,$a,qe,{})}}function ml(l,e,t){const s=l.slice();return s[7]=e[t],s}function _l(l,e,t){const s=l.slice();return s[4]=e[t],s}function qa(l){let e,t=le(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=pl(ml(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Le()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Le()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);F(n,e,r)},p(n,r){if(r&2){t=le(n[1]);let a;for(a=0;a<t.length;a+=1){const o=ml(n,t,a);s[a]?s[a].p(o,r):(s[a]=pl(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function za(l){let e,t=le(l[0].scaleNotes||[]),s=[];for(let n=0;n<t.length;n+=1)s[n]=vl(_l(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Le()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Le()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);F(n,e,r)},p(n,r){if(r&1){t=le(n[0].scaleNotes||[]);let a;for(a=0;a<t.length;a+=1){const o=_l(n,t,a);s[a]?s[a].p(o,r):(s[a]=vl(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function pl(l){let e,t=l[7].interval+"",s;return{c(){e=p("span"),s=Q(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=T(e);s=Y(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-my4m0t")},m(n,r){F(n,e,r),u(e,s)},p(n,r){r&2&&t!==(t=n[7].interval+"")&&ae(s,t)},d(n){n&&m(e)}}}function vl(l){let e,t=l[4].note+"",s;return{c(){e=p("span"),s=Q(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=T(e);s=Y(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-my4m0t")},m(n,r){F(n,e,r),u(e,s)},p(n,r){r&1&&t!==(t=n[4].note+"")&&ae(s,t)},d(n){n&&m(e)}}}function Wa(l){let e,t,s,n,r,a;function o(f,d){return f[0]?za:qa}let i=o(l),c=i(l);return{c(){e=p("div"),t=p("button"),c.c(),this.h()},l(f){e=v(f,"DIV",{class:!0,title:!0});var d=T(e);t=v(d,"BUTTON",{class:!0});var _=T(t);c.l(_),_.forEach(m),d.forEach(m),this.h()},h(){h(t,"class","intervals svelte-my4m0t"),h(e,"class",s=`${l[2].class||""} `),h(e,"title",n=l[1].map(gl).join("-"))},m(f,d){F(f,e,d),u(e,t),c.m(t,null),r||(a=$(t,"click",l[3]),r=!0)},p(f,[d]){i===(i=o(f))&&c?c.p(f,d):(c.d(1),c=i(f),c&&(c.c(),c.m(t,null))),d&4&&s!==(s=`${f[2].class||""} `)&&h(e,"class",s),d&2&&n!==(n=f[1].map(gl).join("-"))&&h(e,"title",n)},i:ue,o:ue,d(f){f&&m(e),c.d(),r=!1,a()}}}const gl=l=>l.interval;function Ja(l,e,t){let{scale:s,intervals:n}=e;function r(a){hs.call(this,l,a)}return l.$$set=a=>{t(2,e=Ce(Ce({},e),we(a))),"scale"in a&&t(0,s=a.scale),"intervals"in a&&t(1,n=a.intervals)},e=we(e),[s,n,e,r]}class ln extends Re{constructor(e){super(),He(this,e,Ja,Wa,qe,{scale:0,intervals:1})}}function bl(l,e,t){const s=l.slice();return s[7]=e[t],s}function yl(l,e,t){const s=l.slice();return s[4]=e[t],s}function Qa(l){let e,t=le(l[0]),s=[];for(let n=0;n<t.length;n+=1)s[n]=kl(bl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Le()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Le()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);F(n,e,r)},p(n,r){if(r&1){t=le(n[0]);let a;for(a=0;a<t.length;a+=1){const o=bl(n,t,a);s[a]?s[a].p(o,r):(s[a]=kl(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function Ya(l){let e,t=le(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Cl(yl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=Le()},l(n){for(let r=0;r<s.length;r+=1)s[r].l(n);e=Le()},m(n,r){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,r);F(n,e,r)},p(n,r){if(r&2){t=le(n[1]);let a;for(a=0;a<t.length;a+=1){const o=yl(n,t,a);s[a]?s[a].p(o,r):(s[a]=Cl(o),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function kl(l){let e,t,s=l[7].roman+"",n,r,a,o=l[7].suffix+"",i,c;return{c(){e=p("span"),t=p("span"),n=Q(s),r=P(),a=p("sup"),i=Q(o),c=P(),this.h()},l(f){e=v(f,"SPAN",{class:!0});var d=T(e);t=v(d,"SPAN",{class:!0});var _=T(t);n=Y(_,s),_.forEach(m),r=B(d),a=v(d,"SUP",{class:!0});var b=T(a);i=Y(b,o),b.forEach(m),c=B(d),d.forEach(m),this.h()},h(){h(t,"class","block"),h(a,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),z(a,"super-text",l[7].suffix.length>2),h(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(f,d){F(f,e,d),u(e,t),u(t,n),u(e,r),u(e,a),u(a,i),u(e,c)},p(f,d){d&1&&s!==(s=f[7].roman+"")&&ae(n,s),d&1&&o!==(o=f[7].suffix+"")&&ae(i,o),d&1&&z(a,"super-text",f[7].suffix.length>2)},d(f){f&&m(e)}}}function Cl(l){let e,t,s=l[4]+"",n,r;return{c(){e=p("span"),t=p("span"),n=Q(s),r=P(),this.h()},l(a){e=v(a,"SPAN",{class:!0});var o=T(e);t=v(o,"SPAN",{});var i=T(t);n=Y(i,s),i.forEach(m),r=B(o),o.forEach(m),this.h()},h(){h(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(a,o){F(a,e,o),u(e,t),u(t,n),u(e,r)},p(a,o){o&2&&s!==(s=a[4]+"")&&ae(n,s)},d(a){a&&m(e)}}}function Xa(l){let e,t,s,n,r,a;function o(f,d){return f[1].length>0?Ya:Qa}let i=o(l),c=i(l);return{c(){e=p("div"),t=p("button"),c.c(),this.h()},l(f){e=v(f,"DIV",{class:!0,title:!0});var d=T(e);t=v(d,"BUTTON",{class:!0});var _=T(t);c.l(_),_.forEach(m),d.forEach(m),this.h()},h(){h(t,"class","triads flex flex-wrap svelte-1roj1mi"),h(e,"class",s=Te(`${l[2].class||""} `)+" svelte-1roj1mi"),h(e,"title",n=l[0].map(wl).join("-"))},m(f,d){F(f,e,d),u(e,t),c.m(t,null),r||(a=$(t,"click",l[3]),r=!0)},p(f,[d]){i===(i=o(f))&&c?c.p(f,d):(c.d(1),c=i(f),c&&(c.c(),c.m(t,null))),d&4&&s!==(s=Te(`${f[2].class||""} `)+" svelte-1roj1mi")&&h(e,"class",s),d&1&&n!==(n=f[0].map(wl).join("-"))&&h(e,"title",n)},i:ue,o:ue,d(f){f&&m(e),c.d(),r=!1,a()}}}const wl=l=>l.roman+l.suffix;function Za(l,e,t){let{triads:s,chords:n}=e;function r(a){hs.call(this,l,a)}return l.$$set=a=>{t(2,e=Ce(Ce({},e),we(a))),"triads"in a&&t(0,s=a.triads),"chords"in a&&t(1,n=a.chords)},e=we(e),[s,n,e,r]}class nn extends Re{constructor(e){super(),He(this,e,Za,Xa,qe,{triads:0,chords:1})}}function El(l,e,t){const s=l.slice();return s[25]=e[t],s}function Sl(l,e,t){const s=l.slice();return s[25]=e[t],s}function Al(l){let e,t,s=l[25].raw.names[0]+"",n,r,a,o,i,c,f;function d(){return l[13](l[25])}a=new ln({props:{scale:l[25].scale,intervals:l[25].raw.intervals}}),a.$on("click",d);function _(){return l[14](l[25])}return i=new nn({props:{triads:l[25].triads,chords:l[25].triadChords}}),i.$on("click",_),{c(){e=p("li"),t=p("div"),n=Q(s),r=P(),ve(a.$$.fragment),o=P(),ve(i.$$.fragment),c=P(),this.h()},l(b){e=v(b,"LI",{class:!0});var g=T(e);t=v(g,"DIV",{class:!0});var E=T(t);n=Y(E,s),E.forEach(m),r=B(g),ge(a.$$.fragment,g),o=B(g),ge(i.$$.fragment,g),c=B(g),g.forEach(m),this.h()},h(){h(t,"class","text-xs font-bold"),h(e,"class","svelte-4hctsl")},m(b,g){F(b,e,g),u(e,t),u(t,n),u(e,r),be(a,e,null),u(e,o),be(i,e,null),u(e,c),f=!0},p(b,g){l=b,(!f||g&4)&&s!==(s=l[25].raw.names[0]+"")&&ae(n,s);const E={};g&4&&(E.scale=l[25].scale),g&4&&(E.intervals=l[25].raw.intervals),a.$set(E);const y={};g&4&&(y.triads=l[25].triads),g&4&&(y.chords=l[25].triadChords),i.$set(y)},i(b){f||(H(a.$$.fragment,b),H(i.$$.fragment,b),f=!0)},o(b){J(a.$$.fragment,b),J(i.$$.fragment,b),f=!1},d(b){b&&m(e),ye(a),ye(i)}}}function Tl(l){let e,t,s=l[25].raw.names[0]+"",n,r,a,o,i,c,f;function d(){return l[15](l[25])}a=new ln({props:{scale:l[25].scale,intervals:l[25].raw.intervals}}),a.$on("click",d);function _(){return l[16](l[25])}return i=new nn({props:{triads:l[25].triads,chords:l[25].triadChords}}),i.$on("click",_),{c(){e=p("li"),t=p("div"),n=Q(s),r=P(),ve(a.$$.fragment),o=P(),ve(i.$$.fragment),c=P(),this.h()},l(b){e=v(b,"LI",{class:!0});var g=T(e);t=v(g,"DIV",{class:!0});var E=T(t);n=Y(E,s),E.forEach(m),r=B(g),ge(a.$$.fragment,g),o=B(g),ge(i.$$.fragment,g),c=B(g),g.forEach(m),this.h()},h(){h(t,"class","text-xs font-bold"),h(e,"class","svelte-4hctsl")},m(b,g){F(b,e,g),u(e,t),u(t,n),u(e,r),be(a,e,null),u(e,o),be(i,e,null),u(e,c),f=!0},p(b,g){l=b,(!f||g&2)&&s!==(s=l[25].raw.names[0]+"")&&ae(n,s);const E={};g&2&&(E.scale=l[25].scale),g&2&&(E.intervals=l[25].raw.intervals),a.$set(E);const y={};g&2&&(y.triads=l[25].triads),g&2&&(y.chords=l[25].triadChords),i.$set(y)},i(b){f||(H(a.$$.fragment,b),H(i.$$.fragment,b),f=!0)},o(b){J(a.$$.fragment,b),J(i.$$.fragment,b),f=!1},d(b){b&&m(e),ye(a),ye(i)}}}function er(l){let e,t,s,n,r="Scales",a,o,i,c,f="Key",d,_,b,g,E,y,D,G,K,C,N=le(l[2]),k=[];for(let w=0;w<N.length;w+=1)k[w]=Al(Sl(l,N,w));const S=w=>J(k[w],1,1,()=>{k[w]=null});let j=le(l[1]),A=[];for(let w=0;w<j.length;w+=1)A[w]=Tl(El(l,j,w));const O=w=>J(A[w],1,1,()=>{A[w]=null});return{c(){e=p("div"),t=p("fieldset"),s=p("legend"),n=p("button"),n.textContent=r,a=P(),o=p("div"),i=p("div"),c=p("label"),c.textContent=f,d=P(),_=p("input"),b=P(),g=p("ul");for(let w=0;w<k.length;w+=1)k[w].c();E=P(),y=p("ul");for(let w=0;w<A.length;w+=1)A[w].c();this.h()},l(w){e=v(w,"DIV",{class:!0});var L=T(e);t=v(L,"FIELDSET",{class:!0});var I=T(t);s=v(I,"LEGEND",{class:!0});var U=T(s);n=v(U,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-lhx60e"&&(n.textContent=r),U.forEach(m),a=B(I),o=v(I,"DIV",{class:!0});var M=T(o);i=v(M,"DIV",{class:!0});var V=T(i);c=v(V,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(c)!=="svelte-14m38zf"&&(c.textContent=f),d=B(V),_=v(V,"INPUT",{class:!0,id:!0}),V.forEach(m),b=B(M),g=v(M,"UL",{class:!0});var R=T(g);for(let se=0;se<k.length;se+=1)k[se].l(R);R.forEach(m),E=B(M),y=v(M,"UL",{class:!0});var te=T(y);for(let se=0;se<A.length;se+=1)A[se].l(te);te.forEach(m),M.forEach(m),I.forEach(m),L.forEach(m),this.h()},h(){h(n,"class","px-1 rounded hover:bg-gray-100"),h(s,"class","text-base"),h(c,"class","mr-4 font-bold"),h(c,"for","scale-key"),h(_,"class","bg-gray-100 w-16 px-1 rounded"),h(_,"id","scale-key"),_.value=l[0],h(i,"class","flex w-1/2 mb-2 input svelte-4hctsl"),h(g,"class","list odd w-full svelte-4hctsl"),h(y,"class","list even w-full svelte-4hctsl"),h(o,"class","body svelte-4hctsl"),z(o,"hidden",l[3]),h(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-4hctsl"),z(t,"collapsed",l[3]),h(e,"class",D=Te(`${l[9].class||""}`)+" svelte-4hctsl")},m(w,L){F(w,e,L),u(e,t),u(t,s),u(s,n),u(t,a),u(t,o),u(o,i),u(i,c),u(i,d),u(i,_),u(o,b),u(o,g);for(let I=0;I<k.length;I+=1)k[I]&&k[I].m(g,null);u(o,E),u(o,y);for(let I=0;I<A.length;I+=1)A[I]&&A[I].m(y,null);G=!0,K||(C=[$(n,"click",l[5]),$(_,"input",l[6]),$(_,"focus",l[11]),$(_,"blur",l[12])],K=!0)},p(w,[L]){if((!G||L&1&&_.value!==w[0])&&(_.value=w[0]),L&388){N=le(w[2]);let I;for(I=0;I<N.length;I+=1){const U=Sl(w,N,I);k[I]?(k[I].p(U,L),H(k[I],1)):(k[I]=Al(U),k[I].c(),H(k[I],1),k[I].m(g,null))}for(st(),I=N.length;I<k.length;I+=1)S(I);lt()}if(L&386){j=le(w[1]);let I;for(I=0;I<j.length;I+=1){const U=El(w,j,I);A[I]?(A[I].p(U,L),H(A[I],1)):(A[I]=Tl(U),A[I].c(),H(A[I],1),A[I].m(y,null))}for(st(),I=j.length;I<A.length;I+=1)O(I);lt()}(!G||L&8)&&z(o,"hidden",w[3]),(!G||L&8)&&z(t,"collapsed",w[3]),(!G||L&512&&D!==(D=Te(`${w[9].class||""}`)+" svelte-4hctsl"))&&h(e,"class",D)},i(w){if(!G){for(let L=0;L<N.length;L+=1)H(k[L]);for(let L=0;L<j.length;L+=1)H(A[L]);G=!0}},o(w){k=k.filter(Boolean);for(let L=0;L<k.length;L+=1)J(k[L]);A=A.filter(Boolean);for(let L=0;L<A.length;L+=1)J(A[L]);G=!1},d(w){w&&m(e),De(k,w),De(A,w),K=!1,ot(C)}}}function tr(l,e,t){let s,n,r,a,o,i,c;oe(l,Yt,w=>t(19,r=w)),oe(l,kt,w=>t(20,a=w)),oe(l,nt,w=>t(21,o=w)),oe(l,tt,w=>t(22,i=w));let d=ms().map(w=>({key:w.names[0],raw:w,scale:void 0,triads:w.triads,triadChords:[]})),_="",b=[a.key,a.scale],g;const E=dt(Pe(!0),{key:"scales-hidden"});oe(l,E,w=>t(3,c=w));function y(){E.update(w=>!w)}function D({currentTarget:{value:w}}){t(0,_=`${w.charAt(0).toUpperCase()}${w.charAt(1).toLowerCase()}`),t(10,d=d.map(L=>{const I=Jt(_,L.key),U=_&&"data"in I?I.data:void 0;let M=[];return U&&(M=L.triads.map((V,R)=>`${U.scaleNotes[R].note}${!V.suffix.includes("°")&&V.minor?"m":""}${V.suffix}`)),{...L,scale:U,triadChords:M}}))}function G(w,L,I){if(w<L.length){const U=L[w++];me.setPlayed(U),i==null||i.playChord(U.map(M=>M.midi),o.fixedVelocity),g=setTimeout(()=>G(w,L,I),I)}else me.setPlayed([]),me.setKeyAndScale(b[0],b[1])}function K(w){clearTimeout(g);let L,I;w.scale?(I=w.scale,b=[a.key,a.scale],me.setKeyAndScale(w.scale.key,w.scale.scale)):I=a;const U=r[0].midi+I.scaleNotes[0].semitones;L=w.raw.intervals.map(M=>[{...I.notesMap.get(M.semitones%12),midi:U+M.semitones}]),L[0][0].semitones!==L[L.length-1][0].semitones&&L.push(L[0].map(M=>({...M,midi:M.midi+12}))),G(0,L,500)}function C(w){clearTimeout(g);const{intervals:L}=w.raw;let I,U;w.scale?(U=w.scale,b=[a.key,a.scale],me.setKeyAndScale(w.scale.key,w.scale.scale)):U=a;const M=r[0].midi+U.scaleNotes[0].semitones;I=Jl(w.triads).map((R,te)=>is(M+U.intervals[te].semitones,U,R.intervals)),L[L.length-1].interval_seq!==1&&I.push(I[0].map(R=>({...R,midi:R.midi+12}))),G(0,I,750)}const N=()=>fe.setKeyboardFocus(!1),k=()=>fe.setKeyboardFocus(!0),S=w=>K(w),j=w=>C(w),A=w=>K(w),O=w=>C(w);return l.$$set=w=>{t(9,e=Ce(Ce({},e),we(w)))},l.$$.update=()=>{l.$$.dirty&1024&&t(2,s=d.filter((w,L)=>L<d.length/2)),l.$$.dirty&1024&&t(1,n=d.filter((w,L)=>L>=d.length/2))},e=we(e),[_,n,s,c,E,y,D,K,C,e,d,N,k,S,j,A,O]}class sr extends Re{constructor(e){super(),He(this,e,tr,er,qe,{})}}function Nl(l,e,t){const s=l.slice();return s[14]=e[t].key,s[15]=e[t].value,s[16]=e[t].icon,s[18]=t,s}const lr=l=>({}),Il=l=>({}),nr=l=>({}),jl=l=>({});function Dl(l){let e,t,s,n,r,a,o,i,c,f;const d=l[11].header,_=Ul(d,l,l[10],Il);let b=le(l[0]),g=[];for(let y=0;y<b.length;y+=1)g[y]=Ll(Nl(l,b,y));const E=y=>J(g[y],1,1,()=>{g[y]=null});return{c(){e=p("button"),s=P(),n=p("ul"),r=p("li"),_&&_.c(),a=P();for(let y=0;y<g.length;y+=1)g[y].c();this.h()},l(y){e=v(y,"BUTTON",{class:!0,tabindex:!0}),T(e).forEach(m),s=B(y),n=v(y,"UL",{class:!0});var D=T(n);r=v(D,"LI",{});var G=T(r);_&&_.l(G),G.forEach(m),a=B(D);for(let K=0;K<g.length;K+=1)g[K].l(D);D.forEach(m),this.h()},h(){h(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),h(e,"tabindex","-1"),h(n,"class","items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl svelte-h65upg")},m(y,D){F(y,e,D),F(y,s,D),F(y,n,D),u(n,r),_&&_.m(r,null),u(n,a);for(let G=0;G<g.length;G+=1)g[G]&&g[G].m(n,null);i=!0,c||(f=$(e,"click",l[6]),c=!0)},p(y,D){if(l=y,_&&_.p&&(!i||D&1024)&&xl(_,d,l,l[10],i?Rl(d,l[10],D,lr):$l(l[10]),Il),D&133){b=le(l[0]);let G;for(G=0;G<b.length;G+=1){const K=Nl(l,b,G);g[G]?(g[G].p(K,D),H(g[G],1)):(g[G]=Ll(K),g[G].c(),H(g[G],1),g[G].m(n,null))}for(st(),G=b.length;G<g.length;G+=1)E(G);lt()}},i(y){if(!i){y&&Es(()=>{i&&(t||(t=$t(e,Ss,{duration:Ht},!0)),t.run(1))}),H(_,y);for(let D=0;D<b.length;D+=1)H(g[D]);y&&Es(()=>{i&&(o||(o=$t(n,As,{duration:Ht},!0)),o.run(1))}),i=!0}},o(y){y&&(t||(t=$t(e,Ss,{duration:Ht},!1)),t.run(0)),J(_,y),g=g.filter(Boolean);for(let D=0;D<g.length;D+=1)J(g[D]);y&&(o||(o=$t(n,As,{duration:Ht},!1)),o.run(0)),i=!1},d(y){y&&(m(e),m(s),m(n)),y&&t&&t.end(),_&&_.d(y),De(g,y),y&&o&&o.end(),c=!1,f()}}}function ar(l){let e;return{c(){e=p("div"),this.h()},l(t){e=v(t,"DIV",{class:!0}),T(e).forEach(m),this.h()},h(){h(e,"class","w-[24px]")},m(t,s){F(t,e,s)},p:ue,i:ue,o:ue,d(t){t&&m(e)}}}function rr(l){let e,t;return e=new rt({props:{class:"mr-2",icon:l[16],width:16}}),{c(){ve(e.$$.fragment)},l(s){ge(e.$$.fragment,s)},m(s,n){be(e,s,n),t=!0},p(s,n){const r={};n&1&&(r.icon=s[16]),e.$set(r)},i(s){t||(H(e.$$.fragment,s),t=!0)},o(s){J(e.$$.fragment,s),t=!1},d(s){ye(e,s)}}}function Ll(l){let e,t,s,n,r,a,o=l[15]+"",i,c,f,d,_;const b=[rr,ar],g=[];function E(D,G){return D[16]?0:1}s=E(l),n=g[s]=b[s](l);function y(){return l[12](l[14])}return{c(){e=p("li"),t=p("button"),n.c(),r=P(),a=p("div"),i=Q(o),c=P(),this.h()},l(D){e=v(D,"LI",{});var G=T(e);t=v(G,"BUTTON",{class:!0});var K=T(t);n.l(K),r=B(K),a=v(K,"DIV",{});var C=T(a);i=Y(C,o),C.forEach(m),K.forEach(m),c=B(G),G.forEach(m),this.h()},h(){h(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),z(t,"selected",l[14]===l[2])},m(D,G){F(D,e,G),u(e,t),g[s].m(t,null),u(t,r),u(t,a),u(a,i),u(e,c),f=!0,d||(_=$(t,"click",y),d=!0)},p(D,G){l=D;let K=s;s=E(l),s===K?g[s].p(l,G):(st(),J(g[K],1,1,()=>{g[K]=null}),lt(),n=g[s],n?n.p(l,G):(n=g[s]=b[s](l),n.c()),H(n,1),n.m(t,r)),(!f||G&1)&&o!==(o=l[15]+"")&&ae(i,o),(!f||G&5)&&z(t,"selected",l[14]===l[2])},i(D){f||(H(n),f=!0)},o(D){J(n),f=!1},d(D){D&&m(e),g[s].d(),d=!1,_()}}}function or(l){let e,t,s,n,r,a,o,i;const c=l[11].value,f=Ul(c,l,l[10],jl);let d=l[5]&&Dl(l);return{c(){e=p("div"),t=p("button"),f&&f.c(),r=P(),d&&d.c(),this.h()},l(_){e=v(_,"DIV",{class:!0,id:!0});var b=T(e);t=v(b,"BUTTON",{class:!0,title:!0});var g=T(t);f&&f.l(g),g.forEach(m),r=B(b),d&&d.l(b),b.forEach(m),this.h()},h(){h(t,"class",s=Te(`${l[8].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),h(t,"title",n=l[8].title||""),z(t,"disabled",l[3]),z(t,"open",l[5]),h(e,"class","relative"),h(e,"id",l[1])},m(_,b){F(_,e,b),u(e,t),f&&f.m(t,null),u(e,r),d&&d.m(e,null),l[13](e),a=!0,o||(i=$(t,"click",l[6]),o=!0)},p(_,[b]){f&&f.p&&(!a||b&1024)&&xl(f,c,_,_[10],a?Rl(c,_[10],b,nr):$l(_[10]),jl),(!a||b&256&&s!==(s=Te(`${_[8].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&h(t,"class",s),(!a||b&256&&n!==(n=_[8].title||""))&&h(t,"title",n),(!a||b&264)&&z(t,"disabled",_[3]),(!a||b&288)&&z(t,"open",_[5]),_[5]?d?(d.p(_,b),b&32&&H(d,1)):(d=Dl(_),d.c(),H(d,1),d.m(e,null)):d&&(st(),J(d,1,1,()=>{d=null}),lt()),(!a||b&2)&&h(e,"id",_[1])},i(_){a||(H(f,_),H(d),a=!0)},o(_){J(f,_),J(d),a=!1},d(_){_&&m(e),f&&f.d(_),d&&d.d(),l[13](null),o=!1,i()}}}const Ht=400;function ir(l,e,t){let{$$slots:s={},$$scope:n}=e,{options:r,id:a=void 0,selected:o=void 0,disabled:i=void 0,onSelect:c}=e,f,d=!1;function _(){i||t(5,d=!d)}function b(y){t(5,d=c(y))}const g=y=>b(y);function E(y){cn[y?"unshift":"push"](()=>{f=y,t(4,f)})}return l.$$set=y=>{t(8,e=Ce(Ce({},e),we(y))),"options"in y&&t(0,r=y.options),"id"in y&&t(1,a=y.id),"selected"in y&&t(2,o=y.selected),"disabled"in y&&t(3,i=y.disabled),"onSelect"in y&&t(9,c=y.onSelect),"$$scope"in y&&t(10,n=y.$$scope)},e=we(e),[r,a,o,i,f,d,_,b,e,c,n,s,g,E]}class cr extends Re{constructor(e){super(),He(this,e,ir,or,qe,{options:0,id:1,selected:2,disabled:3,onSelect:9})}}function Pl(l,e,t){const s=l.slice();return s[30]=e[t],s}function Bl(l,e,t){const s=l.slice();return s[33]=e[t],s}function Gl(l){let e,t;return{c(){e=p("div"),t=Q(l[3]),this.h()},l(s){e=v(s,"DIV",{class:!0});var n=T(e);t=Y(n,l[3]),n.forEach(m),this.h()},h(){h(e,"class","error svelte-1u7ze7x")},m(s,n){F(s,e,n),u(e,t)},p(s,n){n[0]&8&&ae(t,s[3])},d(s){s&&m(e)}}}function ur(l){let e,t;return{c(){e=p("div"),t=Q(l[0]),this.h()},l(s){e=v(s,"DIV",{slot:!0});var n=T(e);t=Y(n,l[0]),n.forEach(m),this.h()},h(){h(e,"slot","value")},m(s,n){F(s,e,n),u(e,t)},p(s,n){n[0]&1&&ae(t,s[0])},d(s){s&&m(e)}}}function Ml(l){let e,t=le(l[5]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Vl(Bl(l,t,n));return{c(){e=p("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var r=T(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(m),this.h()},h(){h(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){F(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r[0]&32){t=le(n[5]);let a;for(a=0;a<t.length;a+=1){const o=Bl(n,t,a);s[a]?s[a].p(o,r):(s[a]=Vl(o),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function Vl(l){let e,t=l[33].interval+"",s;return{c(){e=p("span"),s=Q(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=T(e);s=Y(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1u7ze7x")},m(n,r){F(n,e,r),u(e,s)},p(n,r){r[0]&32&&t!==(t=n[33].interval+"")&&ae(s,t)},d(n){n&&m(e)}}}function Kl(l){let e,t=le(l[8].scaleNotes),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ol(Pl(l,t,n));return{c(){e=p("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=v(n,"DIV",{class:!0});var r=T(e);for(let a=0;a<s.length;a+=1)s[a].l(r);r.forEach(m),this.h()},h(){h(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){F(n,e,r);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,r){if(r[0]&256){t=le(n[8].scaleNotes);let a;for(a=0;a<t.length;a+=1){const o=Pl(n,t,a);s[a]?s[a].p(o,r):(s[a]=Ol(o),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),De(s,n)}}}function Ol(l){let e,t=l[30].note+"",s;return{c(){e=p("span"),s=Q(t),this.h()},l(n){e=v(n,"SPAN",{class:!0});var r=T(e);s=Y(r,t),r.forEach(m),this.h()},h(){h(e,"class","svelte-1u7ze7x")},m(n,r){F(n,e,r),u(e,s)},p(n,r){r[0]&256&&t!==(t=n[30].note+"")&&ae(s,t)},d(n){n&&m(e)}}}function fr(l){let e,t,s,n="Score",r,a,o,i,c,f,d,_="Range",b,g,E,y,D,G="—",K,C,N,k,S,j,A,O="Scale",w,L,I,U,M,V,R,te="Key",se,de,ie,Me,xe,Ve,pe="",ze,Ue,Ie,re;o=new rt({props:{icon:Hl,width:16}});let Ne=l[3]&&Gl(l);I=new cr({props:{id:"scales",class:"p-1",options:l[10],onSelect:l[14],$$slots:{value:[ur]},$$scope:{ctx:l}}});let he=!l[7]&&Ml(l),W=!l[7]&&Kl(l);return{c(){e=p("fieldset"),t=p("legend"),s=p("button"),s.textContent=n,r=P(),a=p("button"),ve(o.$$.fragment),i=P(),c=p("div"),f=p("div"),d=p("label"),d.textContent=_,b=P(),g=p("div"),E=p("input"),y=P(),D=p("span"),D.textContent=G,K=P(),C=p("input"),N=P(),k=p("div"),Ne&&Ne.c(),S=P(),j=p("div"),A=p("label"),A.textContent=O,w=P(),L=p("div"),ve(I.$$.fragment),U=P(),he&&he.c(),M=P(),V=p("div"),R=p("label"),R.textContent=te,se=P(),de=p("div"),ie=p("input"),Me=P(),W&&W.c(),xe=P(),Ve=p("div"),Ve.innerHTML=pe,this.h()},l(ne){e=v(ne,"FIELDSET",{class:!0});var x=T(e);t=v(x,"LEGEND",{class:!0});var X=T(t);s=v(X,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(s)!=="svelte-lqyol"&&(s.textContent=n),X.forEach(m),r=B(x),a=v(x,"BUTTON",{class:!0});var ce=T(a);ge(o.$$.fragment,ce),ce.forEach(m),i=B(x),c=v(x,"DIV",{class:!0});var Z=T(c);f=v(Z,"DIV",{class:!0});var Ee=T(f);d=v(Ee,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(d)!=="svelte-10u0679"&&(d.textContent=_),b=B(Ee),g=v(Ee,"DIV",{class:!0});var Be=T(g);E=v(Be,"INPUT",{class:!0,id:!0}),y=B(Be),D=v(Be,"SPAN",{class:!0,"data-svelte-h":!0}),ee(D)!=="svelte-8q1xz4"&&(D.textContent=G),K=B(Be),C=v(Be,"INPUT",{class:!0,id:!0}),Be.forEach(m),N=B(Ee),k=v(Ee,"DIV",{class:!0});var at=T(k);Ne&&Ne.l(at),at.forEach(m),Ee.forEach(m),S=B(Z),j=v(Z,"DIV",{class:!0});var We=T(j);A=v(We,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(A)!=="svelte-ld2d07"&&(A.textContent=O),w=B(We),L=v(We,"DIV",{class:!0});var Ke=T(L);ge(I.$$.fragment,Ke),Ke.forEach(m),U=B(We),he&&he.l(We),We.forEach(m),M=B(Z),V=v(Z,"DIV",{class:!0});var je=T(V);R=v(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ee(R)!=="svelte-17pcm6g"&&(R.textContent=te),se=B(je),de=v(je,"DIV",{class:!0});var Se=T(de);ie=v(Se,"INPUT",{class:!0,id:!0}),Se.forEach(m),Me=B(je),W&&W.l(je),je.forEach(m),xe=B(Z),Ve=v(Z,"DIV",{class:!0,"data-svelte-h":!0}),ee(Ve)!=="svelte-hp3bkp"&&(Ve.innerHTML=pe),Z.forEach(m),x.forEach(m),this.h()},h(){h(s,"class","px-1 rounded hover:bg-gray-100"),h(t,"class","px-1 text-base"),h(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),z(a,"hidden",l[6]),h(d,"class","font-bold"),h(d,"for","range_min"),h(E,"class","h-[28px] w-full"),h(E,"id","range_min"),h(D,"class","mx-2 mt-1"),h(C,"class","h-[28px] w-full"),h(C,"id","range_max"),h(g,"class","my-1 flex w-full"),h(k,"class","flex justify-between my-1"),h(f,"class","flex flex-col h-full"),h(A,"class","font-bold"),h(A,"for","scales"),h(L,"class","my-1 w-full"),h(j,"class","flex flex-col h-full"),h(R,"class","font-bold"),h(R,"for","key"),h(ie,"class","h-[28px]"),h(ie,"id","key"),h(de,"class","my-1 flex"),h(V,"class","flex flex-col h-full"),h(Ve,"class","h-full flex flex-col justify-between"),h(c,"class","options svelte-1u7ze7x"),z(c,"hidden",l[6]),h(e,"class",ze=Te(`${l[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),z(e,"collapsed",l[6])},m(ne,x){F(ne,e,x),u(e,t),u(t,s),u(e,r),u(e,a),be(o,a,null),u(e,i),u(e,c),u(c,f),u(f,d),u(f,b),u(f,g),u(g,E),Qe(E,l[1]),u(g,y),u(g,D),u(g,K),u(g,C),Qe(C,l[2]),u(f,N),u(f,k),Ne&&Ne.m(k,null),u(c,S),u(c,j),u(j,A),u(j,w),u(j,L),be(I,L,null),u(j,U),he&&he.m(j,null),u(c,M),u(c,V),u(V,R),u(V,se),u(V,de),u(de,ie),Qe(ie,l[4]),u(V,Me),W&&W.m(V,null),u(c,xe),u(c,Ve),Ue=!0,Ie||(re=[$(s,"click",l[15]),$(a,"click",l[16]),$(E,"input",l[18]),$(E,"change",l[19]),$(E,"focus",l[12]),$(E,"blur",l[20]),$(C,"input",l[21]),$(C,"change",l[22]),$(C,"focus",l[12]),$(C,"blur",l[23]),$(ie,"input",l[24]),$(ie,"input",l[13]),$(ie,"focus",l[25]),$(ie,"blur",l[26])],Ie=!0)},p(ne,x){(!Ue||x[0]&64)&&z(a,"hidden",ne[6]),x[0]&2&&E.value!==ne[1]&&Qe(E,ne[1]),x[0]&4&&C.value!==ne[2]&&Qe(C,ne[2]),ne[3]?Ne?Ne.p(ne,x):(Ne=Gl(ne),Ne.c(),Ne.m(k,null)):Ne&&(Ne.d(1),Ne=null);const X={};x[0]&1|x[1]&32&&(X.$$scope={dirty:x,ctx:ne}),I.$set(X),ne[7]?he&&(he.d(1),he=null):he?he.p(ne,x):(he=Ml(ne),he.c(),he.m(j,null)),x[0]&16&&ie.value!==ne[4]&&Qe(ie,ne[4]),ne[7]?W&&(W.d(1),W=null):W?W.p(ne,x):(W=Kl(ne),W.c(),W.m(V,null)),(!Ue||x[0]&64)&&z(c,"hidden",ne[6]),(!Ue||x[0]&131072&&ze!==(ze=Te(`${ne[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&h(e,"class",ze),(!Ue||x[0]&131136)&&z(e,"collapsed",ne[6])},i(ne){Ue||(H(o.$$.fragment,ne),H(I.$$.fragment,ne),Ue=!0)},o(ne){J(o.$$.fragment,ne),J(I.$$.fragment,ne),Ue=!1},d(ne){ne&&m(e),ye(o),Ne&&Ne.d(),ye(I),he&&he.d(),W&&W.d(),Ie=!1,ot(re)}}}function dr(l,e,t){let s,n,r,a,o,i;oe(l,Yt,V=>t(27,n=V)),oe(l,yt,V=>t(28,r=V)),oe(l,bt,V=>t(7,o=V)),oe(l,kt,V=>t(8,i=V));let c=Ye(n[0]),f=Ye(n[1]),d="";const _=dt(Pe(!1),{key:"score-options-hidden"});oe(l,_,V=>t(6,a=V));let b=r[0],g=r[1];const E=ms(),y=E.map(V=>({key:V.names[0],value:V.names[0]}));Yt.subscribe(V=>{t(1,c=Ye(V[0])),t(2,f=Ye(V[1]))}),yt.subscribe(V=>{t(4,b=V[0]),t(0,g=V[1])});function D(V,R){const te=An(R.currentTarget.value,!0,!0);if("data"in te){const{midi:se}=te.data,de=n,ie=[V==="min"?se:de[0].midi,V==="max"?se:de[1].midi];fe.setMidiRange(ie),t(3,d="")}else t(3,d=te.err),V==="min"?t(1,c=Ye(n[0])):t(2,f=Ye(n[1]))}function G(){t(3,d=""),fe.setKeyboardFocus(!1)}function K({currentTarget:{value:V}}){t(4,b=`${V.charAt(0).toUpperCase()}${V.charAt(1).toLowerCase()}`),me.setKey(b)}function C(V){var R;return t(0,g=(R=y.find(te=>V===te.key))==null?void 0:R.value),me.setScale(g),!1}function N(){_.update(V=>!V)}function k(){me.clearScore(!0),fe.setMidiRange([60,84])}function S(){c=this.value,t(1,c)}const j=V=>D("min",V),A=()=>fe.setKeyboardFocus(!0);function O(){f=this.value,t(2,f)}const w=V=>D("max",V),L=()=>fe.setKeyboardFocus(!0);function I(){b=this.value,t(4,b)}const U=()=>fe.setKeyboardFocus(!1),M=()=>fe.setKeyboardFocus(!0);return l.$$set=V=>{t(17,e=Ce(Ce({},e),we(V)))},l.$$.update=()=>{var V;l.$$.dirty[0]&1&&t(5,s=((V=E.find(R=>R.names[0]===g))==null?void 0:V.intervals)||[])},e=we(e),[g,c,f,d,b,s,a,o,i,_,y,D,G,K,C,N,k,e,S,j,A,O,w,L,I,U,M]}class hr extends Re{constructor(e){super(),He(this,e,dr,fr,qe,{},null,[-1,-1])}}function mr(l){l[19]=l[20].default}function _r(l){return{c:ue,l:ue,m:ue,i:ue,o:ue,d:ue}}function pr(l){mr(l);let e,t,s;var n=l[19];function r(a,o){return{props:{class:"px-4 md:px-0"}}}return n&&(e=dn(n,r())),{c(){e&&ve(e.$$.fragment),t=Le()},l(a){e&&ge(e.$$.fragment,a),t=Le()},m(a,o){e&&be(e,a,o),F(a,t,o),s=!0},i(a){s||(e&&H(e.$$.fragment,a),s=!0)},o(a){e&&J(e.$$.fragment,a),s=!1},d(a){a&&m(t),e&&ye(e,a)}}}function vr(l){let e;return{c(){e=Q(" ")},l(t){e=Y(t," ")},m(t,s){F(t,e,s)},i:ue,o:ue,d(t){t&&m(e)}}}function gr(l){let e,t,s,n='<a class="hover:underline" href="https://github.com/TeemuKoivisto/midi-note-trainer">MIDI Note Trainer</a>',r,a,o,i,c,f,d,_,b,g,E,y,D,G,K,C,N,k,S;o=new La({}),c=new sr({}),d=new Zn({}),g=new hr({props:{class:"score-options mr-4"}}),y=new Ha({props:{class:"play-form"}});let j={ctx:l,current:null,token:null,hasCatch:!1,pending:vr,then:pr,catch:_r,value:20,blocks:[,,,]};return un(an(()=>import("./Score.8ff28522.js"),["./Score.8ff28522.js","./vendor_svelte.565aa2ba.js","./vendor.1acf520b.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),j),C=new Oa({props:{class:"min-h-32",debounced:!!l[0]}}),C.$on("guessed-chord",l[2]),C.$on("guessed-key",l[3]),C.$on("guessed-note",l[4]),k=new da({props:{game:l[1]}}),{c(){e=p("meta"),t=P(),s=p("h1"),s.innerHTML=n,r=P(),a=p("section"),ve(o.$$.fragment),i=P(),ve(c.$$.fragment),f=P(),ve(d.$$.fragment),_=P(),b=p("div"),ve(g.$$.fragment),E=P(),ve(y.$$.fragment),D=P(),j.block.c(),G=P(),K=p("section"),ve(C.$$.fragment),N=P(),ve(k.$$.fragment),this.h()},l(A){const O=fn("svelte-1w2oado",document.head);e=v(O,"META",{name:!0,content:!0}),O.forEach(m),t=B(A),s=v(A,"H1",{class:!0,"data-svelte-h":!0}),ee(s)!=="svelte-1l8ebwf"&&(s.innerHTML=n),r=B(A),a=v(A,"SECTION",{class:!0});var w=T(a);ge(o.$$.fragment,w),i=B(w),ge(c.$$.fragment,w),f=B(w),ge(d.$$.fragment,w),_=B(w),b=v(w,"DIV",{class:!0});var L=T(b);ge(g.$$.fragment,L),E=B(L),ge(y.$$.fragment,L),L.forEach(m),w.forEach(m),D=B(A),j.block.l(A),G=B(A),K=v(A,"SECTION",{class:!0});var I=T(K);ge(C.$$.fragment,I),N=B(I),ge(k.$$.fragment,I),I.forEach(m),this.h()},h(){h(e,"name","description"),h(e,"content","App to practise music notation, scales and chords using MIDI"),h(s,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight"),h(b,"class","play svelte-qjpqy3"),h(a,"class","px-4 md:px-0"),h(K,"class","mb-8 px-4 md:px-0 flex flex-col")},m(A,O){u(document.head,e),F(A,t,O),F(A,s,O),F(A,r,O),F(A,a,O),be(o,a,null),u(a,i),be(c,a,null),u(a,f),be(d,a,null),u(a,_),u(a,b),be(g,b,null),u(b,E),be(y,b,null),F(A,D,O),j.block.m(A,j.anchor=O),j.mount=()=>G.parentNode,j.anchor=G,F(A,G,O),F(A,K,O),be(C,K,null),u(K,N),be(k,K,null),S=!0},p(A,[O]){l=A;const w={};O&1&&(w.debounced=!!l[0]),C.$set(w);const L={};O&2&&(L.game=l[1]),k.$set(L)},i(A){S||(H(o.$$.fragment,A),H(c.$$.fragment,A),H(d.$$.fragment,A),H(g.$$.fragment,A),H(y.$$.fragment,A),H(j.block),H(C.$$.fragment,A),H(k.$$.fragment,A),S=!0)},o(A){J(o.$$.fragment,A),J(c.$$.fragment,A),J(d.$$.fragment,A),J(g.$$.fragment,A),J(y.$$.fragment,A);for(let O=0;O<3;O+=1){const w=j.blocks[O];J(w)}J(C.$$.fragment,A),J(k.$$.fragment,A),S=!1},d(A){A&&(m(t),m(s),m(r),m(a),m(D),m(G),m(K)),m(e),ye(o),ye(c),ye(d),ye(g),ye(y),j.block.d(A),j.token=null,j=null,ye(C),ye(k)}}}function br(l,e,t){let s,n,r,a,o,i;oe(l,gt,N=>t(7,s=N)),oe(l,bt,N=>t(1,n=N)),oe(l,ft,N=>t(8,r=N)),oe(l,nt,N=>t(9,a=N)),oe(l,tt,N=>t(10,o=N)),oe(l,us,N=>t(11,i=N));let c,f;Fl(()=>(i&&C(),window.addEventListener("keydown",d),window.addEventListener("mousedown",d),window.addEventListener("touchstart",d),()=>{window.removeEventListener("keydown",d),window.removeEventListener("mousedown",d),window.removeEventListener("touchstart",d)})),Qt.subscribe(N=>{N&&N.channels[1].addListener("noteon",_)});function d(){fe.initAudio(),window.removeEventListener("keydown",d),window.removeEventListener("mousedown",d),window.removeEventListener("touchstart",d)}function _(N){if(c)return;const k=N.rawData;b(k[1],k[2])}function b(N,k){const S=n;S instanceof Nt&&!(S!=null&&S.ended)&&s==="waiting"?y(N):S instanceof ut&&!(S!=null&&S.ended)&&s==="waiting"?(S.addPlayedNote(N),f||(f=setTimeout(E,2e3))):S||me.pushPlayed(N),o&&o.noteOn(N,a.fixedVelocity??k)}function g(){r.autoplay&&r.waitSeconds>0?t(0,c=setTimeout(()=>{r.autoplay&&ke.nextGuess(),t(0,c=void 0)},r.waitSeconds*1e3)):r.autoplay?ke.nextGuess():t(0,c=void 0)}function E(){var k;const N=n;if(N instanceof ut){const S=N.guess();me.setPlayed(((k=N.latestGuess.guessed)==null?void 0:k.notes)||[],S,-1),ke.updateState(S?"correct":"wrong"),g()}f=void 0}function y(N){const k=n;if(k instanceof Nt&&s==="waiting"){me.setTarget([me.getNote(k.current)]);const S=k.guess(N);ke.updateState(S?"correct":"wrong"),me.pushPlayed(N,S,4e3),g()}}function D(N){const k=n;if(k instanceof ut&&s==="waiting"){const S=k.guessWrittenChord(N.detail);ke.updateState(S?"correct":"wrong"),g()}}function G(N){const k=n;if(k instanceof Dt&&s==="waiting"){const S=N.detail.replaceAll("♭","b").replaceAll("♯","#"),j=k.guess(S);ke.updateState(j?"correct":"wrong"),g()}}function K(N){b(N.detail,80)}async function C(){const N=await fe.openMidi();"data"in N?N.data.name:(N.err,console.error(N.err))}return[c,n,D,G,K]}class wr extends Re{constructor(e){super(),He(this,e,br,gr,qe,{})}}export{Ds as F,ut as G,wr as P,vn as S,Nt as a,ke as b,bt as c,vt as d,Ql as e,gt as g,tt as p,kt as s,Bs as t};
