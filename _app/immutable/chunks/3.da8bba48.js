import{_ as en}from"./preload-helper.a4192956.js";import{R as Be,Q as yt,T as Ge,U as tn,S as He,i as xe,s as ze,O as nt,V as se,e as v,m as G,H as _e,a as g,b as A,n as Z,d as m,o as M,I as pe,f as d,L as q,W as Se,g as U,h as u,J as ve,p as x,t as z,C as tt,w as st,l as $,K as ge,X as je,Y as at,M as re,N as ye,P as ke,z as J,A as Q,B as ne,v as De,q as he,Z as cs,r as Gl,_ as Je,$ as sn,a0 as xt,c as Ml,u as Vl,j as Kl,k as Ol,a1 as bs,a2 as Ft,F as ln,a3 as ys,a4 as ks,a5 as nn,a6 as an,G as on}from"./vendor_svelte.8af766b0.js";import{w as Rt,b as rn,c as cn,e as ws,f as Cs,g as Ul,h as zt,i as qt,a as Es,j as ns}from"./vendor.1acf520b.js";const Ss={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Re(l,e=0,t=0){return{interval:`${l}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:l,semitones:Fl(l,e,t),flats:e,sharps:t}}function Fl(l,e,t){return(l<8?Ss[l]:Ss[l%7])-e+t+Math.floor(l/8)*12}function Rl(l){let e,t=0,s=0;l<0?(t=1+Math.floor(-l/100),e=-l%100):l>100?(s=Math.floor(l/100),e=l%100):e=l;const n=Fl(e,t,s);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(s)}`,interval_seq:e,semitones:n,flats:t,sharps:s}}const un=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let ts=[];function Hl(){return un.map(l=>{const e=l[3].map(Rl);return{suffixes:l[0],name:l[1][0],type:l[2],intervals:e}})}function Nt(l){ts.length===0&&(ts=Hl());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return ts.find(t=>t.suffixes.find(s=>s===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function fn(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const o=(l.semitones+e)%12;return{...l,semitones:o<0?o+12:o,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function as(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const o=t[n],a=l+o.semitones,r=e.scaleNotes.find(_=>_.semitones===a%12),i=o.flats>0,c=o.sharps>0,h=(i?a+1:c?a-1:a)%12,f=i?-1:c?1:0;s.push(fn(r??e.notesMap.get(h),r?0:f,a))}return s}const As=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],hn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],Ts=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function dn(l){let e=0,t=0;for(let s=0;s<As.length;s+=1){const n=l.find(a=>a.note.slice(0,2)===As[s]),o=l.find(a=>a.note.slice(0,2)===hn[s]);if(n)e+=1;else if(o)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:Ts.get(e*-1)}:{flats:0,sharps:t,majorSignature:Ts.get(t)}}function mn(l){return l>=9?`${l>=10?"X":""}${l===9?"IX":"I".repeat(l%10)}`:`${l>=5?"V":""}${l===4?"IV":"I".repeat(l%5)}`}function xl(l){return l.map(e=>{const t=[Re(1)];let s;return e.major?(t.push(Re(3)),e.suffix.startsWith("+")?t.push(Re(5,0,1)):e.suffix.startsWith("6")?t.push(Re(6)):e.suffix.startsWith("7")?t.push(Re(7,1)):e.suffix.startsWith("maj7")?t.push(Re(7)):s=Nt("maj")):e.minor?(t.push(Re(3,1)),e.suffix.startsWith("°")?t.push(Re(5,1)):e.suffix.startsWith("6")?(t.push(Re(6)),s=Nt("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Re(7,1)),s=Nt("m"+e.suffix)):s=Nt("m")):e.suffix.startsWith("sus2")?t.push(Re(2)):e.suffix.startsWith("sus4")&&t.push(Re(4)),t.length<=2&&t.push(Re(5)),t.length<=2&&t.push(Re(8)),s||(s=Nt(e.suffix)),{...s,intervals:t}})}function _n(l,e){let t=e.has(4)&&e.has(7),s=e.has(3)&&e.has(7);const n=mn(l);let o="";return t||s||(e.has(3)&&e.has(6)?(o="°",s=!0):e.has(4)&&e.has(8)?(o="+",t=!0):e.has(3)&&e.has(10)?(s=!0,o="7"):e.has(4)&&e.has(10)?(o="7",t=!0):e.has(4)&&e.has(11)?(o="maj7",t=!0):e.has(3)&&e.has(8)?(o="6",s=!0):e.has(4)&&e.has(9)?(o="6",t=!0):e.has(2)?o="sus2":e.has(5)?o="sus4":e.has(7)?o="5":o="?"),{degree:l,roman:s?n.toLowerCase():n,suffix:o,major:t,minor:s,semitones:e}}function pn(l){const e=l.length;return l.map((t,s)=>{const n=t.semitones,o=new Set;for(let a=1;a<e;a+=1){const r=l[(s+a)%e].semitones,i=r<=n?r+12-n:r-n;o.add(i)}return _n(t.interval_seq,o)})}const vn=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let ss=[];function us(){return vn.map(l=>{const e=l[0],t=l[1].map(Rl),s=pn(t);return{names:e,intervals:t,triads:s}})}function gn(l){ss.length===0&&(ss=us());const e=l.replaceAll(/-|\s/g,"").toLowerCase().trim();return ss.find(t=>t.names.find(s=>s.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const bn=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,yn=/^[0-9]$/,Ze=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function zl(l){return l===12?1:Math.floor((l-12)/12)}function Qe(l){return`${l.note}${zl(l.midi)}`}function St(l){const t=(l-12)%12;return{...Ze[t],semitones:t,midi:l}}function kn(l,e=!0,t=!1){if(e&&!bn.test(l))return{err:`Unrecognized note "${l}"`,code:400};const s=l.trim(),n=s.charAt(0).toUpperCase(),o=Ze.find(f=>f.note.charAt(0)===n&&f.note.length===1);if(!o)return{err:`Unable to find note ${s}`,code:500};const a=s.slice(1).split("").reduce((f,_)=>f+(_.toLowerCase()==="b"||_==="♭"?-1:_==="#"||_==="♯"?1:0),0);let r;if(yn.test(s.charAt(s.length-1)))try{r=parseInt(s.charAt(s.length-1),10)}catch{}if(t&&r===void 0)return{err:`No octave provided: ${l}`,code:400};r===void 0&&(r=0);let i=(o.semitones+a)%12;i=i<0?i+12:i;const c=a<0?-a:0,h=a>0?a:0;return{data:{note:`${n}${"♭".repeat(c)}${"♯".repeat(h)}`,semitones:i,midi:12+r*12+i,flats:c,sharps:h}}}function ql(l){const e=Ze.find(t=>t.note.charAt(0)===l.charAt(0)&&t.note.length===1);if(e){const t=l.slice(1).split("").reduce((n,o)=>n+(o.toLowerCase()==="b"||o==="♭"?-1:o==="#"||o==="♯"?1:0),0),s=(e.semitones+t)%12;return{note:l,semitones:s<0?s+12:s,flats:t<0?-t:0,sharps:t>0?t:0}}}const wn=/^[a-gA-G][♭b#♯]?$/,ls="ABCDEFG";function Cn(l,e){return e.map(t=>ls.charAt((ls.indexOf(l)+t.interval_seq-1)%ls.length))}function En(l,e,t){return t.map((s,n)=>{const o=e[n],a=(l+s.semitones)%12,r=Ze[a],i=r.note.charAt(0);if(i<o&&(i!=="A"||o!=="G")||i==="G"&&o==="A"){let c=1,h=Ze[(a+c)%12];for(;h.note.charAt(0)!==o;)c+=1,h=Ze[(a+c)%12];return{semitones:a,note:h.note+"♭".repeat(c),flats:c+(h.note.includes("♭")?1:0),sharps:0}}else if(i>o||i==="A"&&o==="G"){let c=1,h=a===0?Ze.length-1:a-c,f=Ze[h];for(;f.note.charAt(0)!==o;)c+=1,h=h===0?Ze.length-1:h-1,f=Ze[h];return{semitones:a,note:f.note+"♯".repeat(c),flats:0,sharps:c+(f.note.includes("♯")?1:0)}}else return{semitones:a,note:r.note,flats:r.flats,sharps:r.sharps}})}function Wt(l,e){if(!wn.test(l))return{err:`Unknown key: ${l}`,code:400};const t=gn(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const s=`${l.charAt(0).toUpperCase()}${l.charAt(1).replace("b","♭").replace("#","♯")}`,n=ql(s);if(!n)return{err:`Unable to find root for note: ${s}`,code:404};const o=Cn(s.charAt(0),t.intervals),a=En(n.semitones,o,t.intervals),r=new Map(Ze.map(i=>{const c=a.find(h=>h.semitones===i.semitones);return c?[i.semitones,c]:[i.semitones,{...i}]}));return{data:{key:s,scale:t.names[0],names:t.names,...dn(a),intervals:t.intervals.map(i=>({...i})),triads:t.triads.map(i=>({...i})),scaleNotes:a,notesMap:r}}}const os=new Map;function Sn(l,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(l)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function An(l,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(l)),{data:void 0}}catch(s){return{err:`Failed to store the value: ${s}`,code:400}}}function ct(l,e){const{key:t,storage:s="local",namespace:n="default"}=e,o=Sn(t,s),a=Be(l);"data"in o?l.set(e.deserialize?e.deserialize(o.data):o.data):"err"in o&&(e!=null&&e.debug)&&console.info(o.err);const r=l.subscribe(c=>{const h=An(e.serialize?e.serialize(c):c,t,s);"err"in h&&(e!=null&&e.debug)&&console.error(h.err)}),i=os.get(n);return i?i.push({key:t,storage:s,value:l,defaultValue:a,unsubscribe:r}):os.set(n,[{key:t,storage:s,value:l,defaultValue:a,unsubscribe:r}]),l}function Tn(l=["default"],e){l.forEach(t=>{var s;(s=os.get(t))==null||s.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function Nn(l,e){const t=await fetch(l);if(!t.ok)return{err:t.statusText,code:t.status};const s=await t.arrayBuffer();return{data:await e.decodeAudioData(s)}}async function In(l,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],s=await Promise.all(t.map(o=>Nn(`${l}${o}`,e))),n=[];return s.forEach(o=>{"err"in o?console.error(`Failed to load audio: ${o.err}`):n.push(o.data)}),n}class jn{constructor(e,t,s,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(s),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(s))}on(e,t,s,n,o,a,r,i){this.noteA.buffer=e,this.noteA.playbackRate.value=s,this.biquadFilter.frequency.value=o,this.gainA.gain.value=a,this.gain.gain.value=i,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=r,this.noteB.start(0)),this.noteA.start(0)}off(e,t,s){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(s),this.noteB.stop(s),(n=this.damp)==null||n.start(0)}}class Dn{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,s)=>{this.bufferlists.push(t),s===8?this.damper=t:s===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(s=>{this.noteOn(s,t)})}noteOn(e,t=80){if(e<109&&e>20){const s=this.notes.get(e);s&&(s.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),o=n+1,a=n*12+21,r=2**((e-69)/12)*440,i=t/127;let c=r*(2-(e-21)/50)+3*r*i;e<60&&(c=440*(3-(60-21)/50)+3*r*i);const h=1-(e%12/12+1)/12,f=Math.pow(2,(e-a)/12),_=0,b=0,p=i**1.4,w=new jn(e,this.context,this.directGain,this.damper);w.on(this.bufferlists[n],this.bufferlists[o],f,_,c,h,b,p),this.notes.set(e,w)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const Ln="/midi-note-trainer/",rs=ct(Ge(!1),{key:"midi-access"}),$t=Ge(void 0),fs=ct(Ge([60,84]),{key:"midi-range",storage:"session"}),Jt=yt(fs,l=>[St(l[0]),St(l[1])]),Ns=Ge(void 0),et=Ge(void 0),Wl=Ge(!0),vt=ct(Ge({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),fe={async openMidi(){return Rt.enable().then(()=>(rs.set(!0),Rt.inputs.length>0?($t.set(Rt.inputs[0]),{data:Rt.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(l=>({err:l.toString(),code:403}))},disableMidi(){rs.set(!1),$t.set(void 0)},setMidiRange(l){fs.set(l)},setInputValue(l,e){vt.update(t=>({...t,[l]:e})),l==="useSound"&&!e?et.set(void 0):l==="useSound"&&!Be(et)&&this.initAudio()},setKeyboardFocus(l){Wl.set(l)},async initAudio(){let l=Be(Ns);if(l||(l=new AudioContext,Ns.set(l)),!Be(et)){const e=new Dn(l),t=await In(`${Ln}audio`,l);e.load(t),et.set(e)}}};let Xe;const Pn=tn({A:{note:"C",semitones:0,flats:0,sharps:0},W:{note:"C♯",semitones:1,flats:0,sharps:1},S:{note:"D",semitones:2,flats:0,sharps:0},E:{note:"E♭",semitones:3,flats:1,sharps:0},D:{note:"E",semitones:4,flats:0,sharps:0},F:{note:"F",semitones:5,flats:0,sharps:0},T:{note:"F♯",semitones:6,flats:0,sharps:1},G:{note:"G",semitones:7,flats:0,sharps:0},Y:{note:"G♯",semitones:8,flats:0,sharps:1},H:{note:"A",semitones:9,flats:0,sharps:0},U:{note:"B♭",semitones:10,flats:1,sharps:0},J:{note:"B",semitones:11,flats:0,sharps:0},K:{note:"C",semitones:12,flats:0,sharps:0},O:{note:"C♯",semitones:13,flats:0,sharps:1},L:{note:"D",semitones:14,flats:0,sharps:0},P:{note:"E♭",semitones:15,flats:1,sharps:0},Ö:{note:"E",semitones:16,flats:0,sharps:0},Ä:{note:"F",semitones:17,flats:0,sharps:0},Å:{note:"F♯",semitones:18,flats:0,sharps:1}}),gt=Ge(["C","Major"]),bt=yt(gt,l=>{const e=Wt(l[0],l[1]);return"data"in e?e.data:{key:l[0],scale:l[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),$l=yt([bt,Pn],([l,e])=>{const t={...e};return Object.entries(e).forEach(([s,n])=>{const o=l.notesMap.get(n.semitones%12);o&&(t[s]={note:o.note,flats:o.flats,sharps:o.sharps,semitones:n.semitones})}),t}),Is=Ge([]),mt=Ge([]);function is(l,e){if(l.length>0){const t=Date.now();let s=t;const n=l.filter(o=>(o.started+e>t&&(s=Math.min(s,o.started)),o.started+e>t));return!Xe&&n.length>0&&(Xe=setTimeout(()=>{Xe=void 0,mt.update(o=>is(o,e))},e-(t-s)+100)),n}return l}const ue={setKey(l){gt.update(e=>[l,e[1]])},setScale(l){gt.update(e=>[e[0],l])},setKeyAndScale(l,e){gt.set([l,e])},setTarget(l=[]){Is.set(l)},findNote(l){return Object.values(Be($l)).find(e=>{if(e.note.charAt(0)===l.charAt(0)){const t=l.slice(1).split("").reduce((s,n)=>s+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},getNote(l){return{...Be(bt).notesMap.get(l%12),midi:l}},pushPlayed(l,e,t){const n={...Be(bt).notesMap.get(l%12),midi:l},o=Date.now(),a=e===void 0?"default":e?"correct":"wrong";if(mt.update(r=>{const i=r.findIndex(c=>c.midi===l);return i>=0&&r.splice(i,1),[...r,{...n,color:a,started:o}]}),!Xe&&t!==-1){const r=t??Be(vt).keyFadeTimeout;Xe=setTimeout(()=>{Xe=void 0,mt.update(i=>is(i,r))},r)}},setPlayed(l,e,t){const s=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(mt.update(o=>[...l.map(a=>({...a,color:n,started:s}))]),!Xe&&t!==-1){const o=t??Be(vt).keyFadeTimeout;Xe=setTimeout(()=>{Xe=void 0,mt.update(a=>is(a,o))},o)}},clearPlayed(){mt.set([]),clearTimeout(Xe),Xe=void 0},clearScore(l=!1){l&&gt.set(["C","Major"]),Is.set([]),mt.set([])}};class hs{constructor(e,t,s){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=s;const n=[],{count:o}=s,a=t.map(i=>typeof i=="object"&&i!==null?{...i}:i);let r=s.duplicates;!s.duplicates&&o>a.length&&(console.warn(`Trying to create game with count ${o} larger than available unique values ${t.length}`),r=!0);for(let i=0;i<o;i+=1){const c=Math.floor(Math.random()*a.length);if(r)n.push(a[c]);else{const h=a.splice(c,1);h.length>0&&n.push(h[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function Bn(l,e,t){let s=e<0?l.flats-e:l.flats,n=e>0?l.sharps+e:l.sharps;if(s>0&&n>0){const a=Math.min(s,n);s-=a,n-=a}const o=(l.semitones+e)%12;return{...l,semitones:o<0?o+12:o,note:`${l.note.charAt(0)}${"♭".repeat(s)}${"♯".repeat(n)}`,flats:s,sharps:n,midi:t}}function Gn(l,e,t){const s=[];for(let n=0;n<t.length;n+=1){const o=t[n],a=l+o.semitones,r=e.scaleNotes.find(_=>_.semitones===a%12),i=o.flats>0,c=o.sharps>0,h=(i?a+1:c?a-1:a)%12,f=i?-1:c?1:0;s.push(Bn(r??e.notesMap.get(h),r?0:f,a))}return s}const Mn=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function Vn(l){const t=(l-12)%12;return{...Mn[t],semitones:t,midi:l}}function Kn(l){return`${l.note.trim().charAt(0).toUpperCase()}${"♭".repeat(l.flats)}${"♯".repeat(l.sharps)}`}class rt extends hs{constructor(e,t,s){const n=t.range[0],o=t.range[1],a=new Set(t.scale.scaleNotes.map(i=>i.semitones)),r=s.chords.flatMap(i=>{const c=[],h=i.intervals.reduce((f,_)=>_.semitones>f?_.semitones:f,0);for(let f=n;f<=o-h;f+=1)if((!s.onlyScale||a.has(f%12))&&(!i.allowed||i.allowed.has(f%12))){const _=Gn(f,t.scale,i.intervals);c.push({...i,rootNote:_[0].note,chord:`${_[0].note}${i.suffixes[0]}`,notes:_})}return c});super(e,r,t),this.played=new Set,this.opts=s}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${Kn(e)}${e.chord.toLowerCase()}`,notes:[]},s=this.current.chord===t.chord;return this.addGuessed(t,s)}guess(){const e=Array.from(this.played.values()).map(n=>Vn(n)).sort((n,o)=>n.midi-o.midi);this.played.clear();const t={chord:"",notes:e},s=this.current.notes.every(n=>e.find(o=>o.midi%12===n.midi%12));return this.addGuessed(t,s)}}const On={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class It extends hs{constructor(e,t){const s=e==="keys-major"?"major":"minor";super(e,Object.keys(On[s]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class At extends hs{constructor(e,t){const s=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-s+1)).map((o,a)=>s+a),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const Jl={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},_t=Ge("waiting"),it=ct(Ge(Jl),{key:"game-options"}),pt=Ge(void 0),ds=Ge(Hl().map(l=>({...l,selected:!0}))),be={play(...[l,e]){var i,c,h;let t;const s=Be(bt),n=Be(fs),o=Be(it),a={scale:s,range:n,duplicates:o.duplicates,count:o.count};let r=[s.key,s.scale];if(l==="notes")t=new At(l,a),ue.setTarget([ue.getNote(t.current)]),(i=Be(et))==null||i.noteOn(t.current);else if(l==="pitches")t=new At(l,a),ue.setTarget(),fe.setInputValue("useSound",!0),(c=Be(et))==null||c.noteOn(t.current);else if(l==="keys-major"||l=="keys-minor")t=new It(l,a),r=[t.current,l==="keys-major"?"major":"minor"];else if(l==="chords-play"||l==="chords-write")t=new rt(l,a,e);else if(l==="chords-diatonic"){const f=xl(s.triads).map((_,b)=>({..._,allowed:new Set([s.scaleNotes[b].semitones])}));t=new rt(l,a,{chords:f})}else throw Error("Unknown game type: "+l);return typeof t.current!="number"&&typeof t.current!="string"&&((h=Be(et))==null||h.playChord(t.current.notes.map(f=>f.midi)),ue.setTarget(t.current.notes)),ue.setKeyAndScale(r[0],r[1]),ue.clearPlayed(),_t.set("waiting"),pt.set(t),t},updateState(l){_t.set(l)},setOptionValue(l,e){it.update(t=>({...t,[l]:e}))},toggleChords(l){ds.update(e=>e.map(t=>({...t,selected:l(t)})))},nextGuess(){var e,t;const l=Be(pt);l!=null&&l.ended?_t.set("ended"):l instanceof At?(l.type==="notes"?ue.setTarget([ue.getNote(l.current)]):ue.setTarget(),ue.clearPlayed(),(e=Be(et))==null||e.noteOn(l.current),be.updateState("waiting"),l.startTime()):l instanceof rt?(ue.setTarget(l.current.notes),ue.clearPlayed(),(t=Be(et))==null||t.playChord(l==null?void 0:l.current.notes.map(s=>s.midi)),_t.set("waiting"),l.startTime()):l instanceof It&&(ue.setKey(l.current),_t.set("waiting"),l.startTime())},clearGame(l=!1){const e=Be(pt);e&&ue.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),l&&it.set(Jl),pt.set(void 0),_t.set("waiting"),ue.clearScore()}};function js(l,e,t){const s=l.slice();return s[29]=e[t],s[31]=t,s}function Ds(l,e,t){const s=l.slice();return s[34]=e[t],s}function Ls(l,e,t){const s=l.slice();return s[8]=e[t],s}function Ps(l,e,t){const s=l.slice();return s[29]=e[t],s[31]=t,s}function Bs(l,e,t){const s=l.slice();return s[34]=e[t],s}function Gs(l,e,t){const s=l.slice();return s[8]=e[t],s}function Un(l){let e,t=se(l[29].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ms(Bs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=De()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=De()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);U(n,e,o)},p(n,o){if(o[0]&64){t=se(n[29].intervals);let a;for(a=0;a<t.length;a+=1){const r=Bs(n,t,a);s[a]?s[a].p(r,o):(s[a]=Ms(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Fn(l){let e,t=se(l[2][l[31]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Vs(Gs(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=De()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=De()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);U(n,e,o)},p(n,o){if(o[0]&4){t=se(n[2][n[31]]);let a;for(a=0;a<t.length;a+=1){const r=Gs(n,t,a);s[a]?s[a].p(r,o):(s[a]=Vs(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Ms(l){let e,t=l[34].interval+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=A(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-8fys9e")},m(n,o){U(n,e,o),u(e,s)},p(n,o){o[0]&64&&t!==(t=n[34].interval+"")&&ne(s,t)},d(n){n&&m(e)}}}function Vs(l){let e,t=l[8].note+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=A(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-8fys9e")},m(n,o){U(n,e,o),u(e,s)},p(n,o){o[0]&4&&t!==(t=n[8].note+"")&&ne(s,t)},d(n){n&&m(e)}}}function Ks(l){let e,t,s,n,o,a,r=l[29].suffixes[0]+"",i,c,h,f,_,b,p=l[29].name+"",w,y,T,N;n=new nt({props:{icon:l[29].selected?zt:qt,width:12}});function L(){return l[25](l[29])}function E(S,D){return S[2][S[31]]&&S[2][S[31]].length>0?Fn:Un}let j=E(l),C=j(l);return{c(){e=v("li"),t=v("button"),s=v("span"),_e(n.$$.fragment),o=G(),a=v("div"),i=J(r),c=G(),h=v("li"),C.c(),_=G(),b=v("li"),w=J(p),this.h()},l(S){e=g(S,"LI",{});var D=A(e);t=g(D,"BUTTON",{class:!0});var I=A(t);s=g(I,"SPAN",{class:!0});var F=A(s);pe(n.$$.fragment,F),F.forEach(m),o=M(I),a=g(I,"DIV",{class:!0});var k=A(a);i=Q(k,r),k.forEach(m),I.forEach(m),D.forEach(m),c=M(S),h=g(S,"LI",{class:!0,title:!0});var V=A(h);C.l(V),V.forEach(m),_=M(S),b=g(S,"LI",{class:!0});var P=A(b);w=Q(P,p),P.forEach(m),this.h()},h(){d(s,"class","px-1 py-1 rounded svelte-8fys9e"),q(s,"text-green-500",l[29].selected),q(s,"text-gray-400",!l[29].selected),d(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-8fys9e"),d(t,"class","flex items-center justify-center w-full select-btn svelte-8fys9e"),q(t,"hidden",l[7]),d(h,"class","intervals svelte-8fys9e"),d(h,"title",f=l[29].intervals.map(Hs).join("-")),d(b,"class","text-xs")},m(S,D){U(S,e,D),u(e,t),u(t,s),ve(n,s,null),u(t,o),u(t,a),u(a,i),U(S,c,D),U(S,h,D),C.m(h,null),U(S,_,D),U(S,b,D),u(b,w),y=!0,T||(N=x(t,"click",L),T=!0)},p(S,D){l=S;const I={};D[0]&64&&(I.icon=l[29].selected?zt:qt),n.$set(I),(!y||D[0]&64)&&q(s,"text-green-500",l[29].selected),(!y||D[0]&64)&&q(s,"text-gray-400",!l[29].selected),(!y||D[0]&64)&&r!==(r=l[29].suffixes[0]+"")&&ne(i,r),(!y||D[0]&128)&&q(t,"hidden",l[7]),j===(j=E(l))&&C?C.p(l,D):(C.d(1),C=j(l),C&&(C.c(),C.m(h,null))),(!y||D[0]&64&&f!==(f=l[29].intervals.map(Hs).join("-")))&&d(h,"title",f),(!y||D[0]&64)&&p!==(p=l[29].name+"")&&ne(w,p)},i(S){y||(z(n.$$.fragment,S),y=!0)},o(S){$(n.$$.fragment,S),y=!1},d(S){S&&(m(e),m(c),m(h),m(_),m(b)),ge(n),C.d(),T=!1,N()}}}function Rn(l){let e,t=se(l[29].intervals),s=[];for(let n=0;n<t.length;n+=1)s[n]=Os(Ds(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=De()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=De()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);U(n,e,o)},p(n,o){if(o[0]&32){t=se(n[29].intervals);let a;for(a=0;a<t.length;a+=1){const r=Ds(n,t,a);s[a]?s[a].p(r,o):(s[a]=Os(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Hn(l){let e,t=se(l[3][l[31]]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Us(Ls(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=De()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=De()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);U(n,e,o)},p(n,o){if(o[0]&8){t=se(n[3][n[31]]);let a;for(a=0;a<t.length;a+=1){const r=Ls(n,t,a);s[a]?s[a].p(r,o):(s[a]=Us(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Os(l){let e,t=l[34].interval+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=A(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-8fys9e")},m(n,o){U(n,e,o),u(e,s)},p(n,o){o[0]&32&&t!==(t=n[34].interval+"")&&ne(s,t)},d(n){n&&m(e)}}}function Us(l){let e,t=l[8].note+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=A(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-8fys9e")},m(n,o){U(n,e,o),u(e,s)},p(n,o){o[0]&8&&t!==(t=n[8].note+"")&&ne(s,t)},d(n){n&&m(e)}}}function Fs(l){let e,t,s,n,o,a,r=l[29].suffixes[0]+"",i,c,h,f,_,b,p=l[29].name+"",w,y,T,N;n=new nt({props:{icon:l[29].selected?zt:qt,width:12}});function L(){return l[26](l[29])}function E(S,D){return S[3][S[31]]&&S[3][S[31]].length>0?Hn:Rn}let j=E(l),C=j(l);return{c(){e=v("li"),t=v("button"),s=v("span"),_e(n.$$.fragment),o=G(),a=v("div"),i=J(r),c=G(),h=v("li"),C.c(),_=G(),b=v("li"),w=J(p),this.h()},l(S){e=g(S,"LI",{});var D=A(e);t=g(D,"BUTTON",{class:!0});var I=A(t);s=g(I,"SPAN",{class:!0});var F=A(s);pe(n.$$.fragment,F),F.forEach(m),o=M(I),a=g(I,"DIV",{class:!0});var k=A(a);i=Q(k,r),k.forEach(m),I.forEach(m),D.forEach(m),c=M(S),h=g(S,"LI",{class:!0,title:!0});var V=A(h);C.l(V),V.forEach(m),_=M(S),b=g(S,"LI",{class:!0});var P=A(b);w=Q(P,p),P.forEach(m),this.h()},h(){d(s,"class","px-1 py-1 rounded svelte-8fys9e"),q(s,"text-green-500",l[29].selected),q(s,"text-gray-400",!l[29].selected),d(a,"class","ml-1 px-1 w-full bg-gray-200 svelte-8fys9e"),d(t,"class","flex items-center justify-center w-full select-btn svelte-8fys9e"),q(t,"hidden",l[7]),d(h,"class","intervals svelte-8fys9e"),d(h,"title",f=l[29].intervals.map(xs).join("-")),d(b,"class","text-xs")},m(S,D){U(S,e,D),u(e,t),u(t,s),ve(n,s,null),u(t,o),u(t,a),u(a,i),U(S,c,D),U(S,h,D),C.m(h,null),U(S,_,D),U(S,b,D),u(b,w),y=!0,T||(N=x(t,"click",L),T=!0)},p(S,D){l=S;const I={};D[0]&32&&(I.icon=l[29].selected?zt:qt),n.$set(I),(!y||D[0]&32)&&q(s,"text-green-500",l[29].selected),(!y||D[0]&32)&&q(s,"text-gray-400",!l[29].selected),(!y||D[0]&32)&&r!==(r=l[29].suffixes[0]+"")&&ne(i,r),(!y||D[0]&128)&&q(t,"hidden",l[7]),j===(j=E(l))&&C?C.p(l,D):(C.d(1),C=j(l),C&&(C.c(),C.m(h,null))),(!y||D[0]&32&&f!==(f=l[29].intervals.map(xs).join("-")))&&d(h,"title",f),(!y||D[0]&32)&&p!==(p=l[29].name+"")&&ne(w,p)},i(S){y||(z(n.$$.fragment,S),y=!0)},o(S){$(n.$$.fragment,S),y=!1},d(S){S&&(m(e),m(c),m(h),m(_),m(b)),ge(n),C.d(),T=!1,N()}}}function xn(l){let e,t,s,n,o="Chords",a,r,i,c,h,f,_,b,p,w,y,T,N,L,E,j,C,S="Key",D,I,F,k,V="Scale",P,O,B,K,H="Note",ee,te,ce,ae,Te,Fe,Me,me,qe,Ue;c=new nt({props:{icon:rn,width:20}}),_=new nt({props:{icon:cn,width:16}}),w=new nt({props:{icon:l[4]?ws:Cs,width:16}}),N=new nt({props:{icon:Ul,width:16}});let Ne=se(l[6]),oe=[];for(let R=0;R<Ne.length;R+=1)oe[R]=Ks(Ps(l,Ne,R));const Ae=R=>$(oe[R],1,1,()=>{oe[R]=null});let de=se(l[5]),W=[];for(let R=0;R<de.length;R+=1)W[R]=Fs(js(l,de,R));const le=R=>$(W[R],1,1,()=>{W[R]=null});return{c(){e=v("div"),t=v("fieldset"),s=v("legend"),n=v("button"),n.textContent=o,a=G(),r=v("div"),i=v("button"),_e(c.$$.fragment),h=G(),f=v("button"),_e(_.$$.fragment),b=G(),p=v("button"),_e(w.$$.fragment),y=G(),T=v("button"),_e(N.$$.fragment),L=G(),E=v("div"),j=v("div"),C=v("label"),C.textContent=S,D=G(),I=v("input"),F=G(),k=v("label"),k.textContent=V,P=G(),O=v("input"),B=G(),K=v("label"),K.textContent=H,ee=G(),te=v("input"),ce=G(),ae=v("ul");for(let R=0;R<oe.length;R+=1)oe[R].c();Te=G(),Fe=v("ul");for(let R=0;R<W.length;R+=1)W[R].c();this.h()},l(R){e=g(R,"DIV",{class:!0});var Y=A(e);t=g(Y,"FIELDSET",{class:!0});var ie=A(t);s=g(ie,"LEGEND",{class:!0});var X=A(s);n=g(X,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1knqzl6"&&(n.textContent=o),X.forEach(m),a=M(ie),r=g(ie,"DIV",{class:!0});var we=A(r);i=g(we,"BUTTON",{class:!0});var Le=A(i);pe(c.$$.fragment,Le),Le.forEach(m),h=M(we),f=g(we,"BUTTON",{class:!0});var lt=A(f);pe(_.$$.fragment,lt),lt.forEach(m),b=M(we),p=g(we,"BUTTON",{class:!0});var We=A(p);pe(w.$$.fragment,We),We.forEach(m),y=M(we),T=g(we,"BUTTON",{class:!0});var Ve=A(T);pe(N.$$.fragment,Ve),Ve.forEach(m),we.forEach(m),L=M(ie),E=g(ie,"DIV",{class:!0});var Ie=A(E);j=g(Ie,"DIV",{class:!0});var Ce=A(j);C=g(Ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(C)!=="svelte-14m38zf"&&(C.textContent=S),D=M(Ce),I=g(Ce,"INPUT",{class:!0,id:!0}),F=M(Ce),k=g(Ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(k)!=="svelte-1ytp0wy"&&(k.textContent=V),P=M(Ce),O=g(Ce,"INPUT",{class:!0,id:!0}),B=M(Ce),K=g(Ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(K)!=="svelte-1o58334"&&(K.textContent=H),ee=M(Ce),te=g(Ce,"INPUT",{class:!0,id:!0}),Ce.forEach(m),ce=M(Ie),ae=g(Ie,"UL",{class:!0});var Tt=A(ae);for(let Ke=0;Ke<oe.length;Ke+=1)oe[Ke].l(Tt);Tt.forEach(m),Te=M(Ie),Fe=g(Ie,"UL",{class:!0});var kt=A(Fe);for(let Ke=0;Ke<W.length;Ke+=1)W[Ke].l(kt);kt.forEach(m),Ie.forEach(m),ie.forEach(m),Y.forEach(m),this.h()},h(){d(n,"class","px-1 rounded hover:bg-gray-100"),d(s,"class","text-base"),d(i,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),q(i,"hidden",l[7]),d(f,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),q(f,"hidden",l[7]),d(p,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),q(p,"hidden",l[7]),d(T,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),q(T,"hidden",l[7]),d(r,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),d(C,"class","mr-4 font-bold"),d(C,"for","scale-key"),d(I,"class","bg-gray-100 w-16 px-1 rounded"),d(I,"id","scale-key"),I.value=l[0],d(k,"class","mx-4 font-bold"),d(k,"for","scale-key"),d(O,"class","bg-gray-100 w-16 px-1 rounded"),d(O,"id","scale-key"),O.value="Major",O.disabled=!0,d(K,"class","mx-4 font-bold"),d(K,"for","scale-key"),d(te,"class","bg-gray-100 w-16 px-1 rounded"),d(te,"id","scale-key"),te.value=l[1],d(j,"class","flex w-1/2 mb-2 input svelte-8fys9e"),d(ae,"class","chord-list w-full svelte-8fys9e"),d(Fe,"class","chord-list w-full svelte-8fys9e"),d(E,"class","body svelte-8fys9e"),q(E,"hidden",l[7]),d(t,"class","flex flex-col relative rounded border-2 px-4 py-2 my-4 text-sm svelte-8fys9e"),q(t,"collapsed",l[7]),d(e,"class",Me=Se(`${l[18].class||""}`)+" svelte-8fys9e")},m(R,Y){U(R,e,Y),u(e,t),u(t,s),u(s,n),u(t,a),u(t,r),u(r,i),ve(c,i,null),u(r,h),u(r,f),ve(_,f,null),u(r,b),u(r,p),ve(w,p,null),u(r,y),u(r,T),ve(N,T,null),u(t,L),u(t,E),u(E,j),u(j,C),u(j,D),u(j,I),u(j,F),u(j,k),u(j,P),u(j,O),u(j,B),u(j,K),u(j,ee),u(j,te),u(E,ce),u(E,ae);for(let ie=0;ie<oe.length;ie+=1)oe[ie]&&oe[ie].m(ae,null);u(E,Te),u(E,Fe);for(let ie=0;ie<W.length;ie+=1)W[ie]&&W[ie].m(Fe,null);me=!0,qe||(Ue=[x(n,"click",l[10]),x(i,"click",l[14]),x(f,"click",l[15]),x(p,"click",l[16]),x(T,"click",l[17]),x(I,"input",l[11]),x(I,"focus",l[21]),x(I,"blur",l[22]),x(te,"input",l[12]),x(te,"focus",l[23]),x(te,"blur",l[24])],qe=!0)},p(R,Y){(!me||Y[0]&128)&&q(i,"hidden",R[7]),(!me||Y[0]&128)&&q(f,"hidden",R[7]);const ie={};if(Y[0]&16&&(ie.icon=R[4]?ws:Cs),w.$set(ie),(!me||Y[0]&128)&&q(p,"hidden",R[7]),(!me||Y[0]&128)&&q(T,"hidden",R[7]),(!me||Y[0]&1&&I.value!==R[0])&&(I.value=R[0]),(!me||Y[0]&2&&te.value!==R[1])&&(te.value=R[1]),Y[0]&8388){Ne=se(R[6]);let X;for(X=0;X<Ne.length;X+=1){const we=Ps(R,Ne,X);oe[X]?(oe[X].p(we,Y),z(oe[X],1)):(oe[X]=Ks(we),oe[X].c(),z(oe[X],1),oe[X].m(ae,null))}for(tt(),X=Ne.length;X<oe.length;X+=1)Ae(X);st()}if(Y[0]&8360){de=se(R[5]);let X;for(X=0;X<de.length;X+=1){const we=js(R,de,X);W[X]?(W[X].p(we,Y),z(W[X],1)):(W[X]=Fs(we),W[X].c(),z(W[X],1),W[X].m(Fe,null))}for(tt(),X=de.length;X<W.length;X+=1)le(X);st()}(!me||Y[0]&128)&&q(E,"hidden",R[7]),(!me||Y[0]&128)&&q(t,"collapsed",R[7]),(!me||Y[0]&262144&&Me!==(Me=Se(`${R[18].class||""}`)+" svelte-8fys9e"))&&d(e,"class",Me)},i(R){if(!me){z(c.$$.fragment,R),z(_.$$.fragment,R),z(w.$$.fragment,R),z(N.$$.fragment,R);for(let Y=0;Y<Ne.length;Y+=1)z(oe[Y]);for(let Y=0;Y<de.length;Y+=1)z(W[Y]);me=!0}},o(R){$(c.$$.fragment,R),$(_.$$.fragment,R),$(w.$$.fragment,R),$(N.$$.fragment,R),oe=oe.filter(Boolean);for(let Y=0;Y<oe.length;Y+=1)$(oe[Y]);W=W.filter(Boolean);for(let Y=0;Y<W.length;Y+=1)$(W[Y]);me=!1},d(R){R&&m(e),ge(c),ge(_),ge(w),ge(N),je(oe,R),je(W,R),qe=!1,at(Ue)}}}let Rs="Major";const Hs=l=>l.interval,xs=l=>l.interval;function zn(l,e,t){let s,n,o,a,r,i;re(l,ds,B=>t(20,r=B));let c="C",h=Wt(c,Rs),f="",_,b=[],p=[];const w=ct(Ge(!0),{key:"chords-hidden"});re(l,w,B=>t(7,i=B));function y(){w.update(B=>!B)}function T(){const B=_&&60+_.semitones;if("err"in h||!B)t(2,b=[]),t(3,p=[]);else{const K=h.data;t(2,b=n.map(H=>as(B,K,H.intervals))),t(3,p=o.map(H=>as(B,K,H.intervals)))}}function N({currentTarget:{value:B}}){t(0,c=`${B.charAt(0).toUpperCase()}${B.charAt(1).toLowerCase()}`),h=Wt(c,Rs),T()}function L({currentTarget:{value:B}}){t(1,f=`${B.charAt(0).toUpperCase()}${B.charAt(1).toLowerCase()}`),t(8,_=ql(f)),T()}function E(B){be.toggleChords(K=>K.name===B.name?!K.selected:K.selected)}function j(){const B=H=>H.suffixes[0]==="maj"||H.suffixes[0]==="m",K=r.filter(B).every(H=>H.selected);be.toggleChords(H=>B(H)?!K:H.selected)}function C(){const B=H=>H.suffixes[0]==="maj7"||H.suffixes[0]==="m7"||H.suffixes[0]==="7"||H.suffixes[0]==="dim7"||H.suffixes[0]==="aug7",K=r.filter(B).every(H=>H.selected);be.toggleChords(H=>B(H)?!K:H.selected)}function S(){be.toggleChords(B=>!a)}function D(){be.toggleChords(B=>!0)}const I=()=>fe.setKeyboardFocus(!1),F=()=>fe.setKeyboardFocus(!0),k=()=>fe.setKeyboardFocus(!1),V=()=>fe.setKeyboardFocus(!0),P=B=>E(B),O=B=>E(B);return l.$$set=B=>{t(18,e=ye(ye({},e),ke(B)))},l.$$.update=()=>{l.$$.dirty[0]&1048576&&t(19,s=r),l.$$.dirty[0]&524288&&t(6,n=s.filter((B,K)=>K<s.length/2)),l.$$.dirty[0]&524288&&t(5,o=s.filter((B,K)=>K>=s.length/2)),l.$$.dirty[0]&524288&&t(4,a=s.every(B=>B.selected))},e=ke(e),[c,f,b,p,a,o,n,i,_,w,y,N,L,E,j,C,S,D,e,s,r,I,F,k,V,P,O]}class qn extends He{constructor(e){super(),xe(this,e,zn,xn,ze,{},null,[-1,-1])}}function zs(l,e,t){const s=l.slice();return s[10]=e[t],s}function Wn(l){let e;return{c(){e=J(" ")},l(t){e=Q(t," ")},m(t,s){U(t,e,s)},p:he,d(t){t&&m(e)}}}function $n(l){let e,t,s="Played:",n,o=se(l[2]),a=[];for(let r=0;r<o.length;r+=1)a[r]=qs(zs(l,o,r));return{c(){e=v("div"),t=v("span"),t.textContent=s,n=G();for(let r=0;r<a.length;r+=1)a[r].c()},l(r){e=g(r,"DIV",{});var i=A(e);t=g(i,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1g6xxhn"&&(t.textContent=s),n=M(i);for(let c=0;c<a.length;c+=1)a[c].l(i);i.forEach(m)},m(r,i){U(r,e,i),u(e,t),u(e,n);for(let c=0;c<a.length;c+=1)a[c]&&a[c].m(e,null)},p(r,i){if(i&4){o=se(r[2]);let c;for(c=0;c<o.length;c+=1){const h=zs(r,o,c);a[c]?a[c].p(h,i):(a[c]=qs(h),a[c].c(),a[c].m(e,null))}for(;c<a.length;c+=1)a[c].d(1);a.length=o.length}},d(r){r&&m(e),je(a,r)}}}function Jn(l){let e,t,s="Result:",n,o,a,r=l[0].correct+"",i,c,h=l[0].sampled.length+"",f,_,b,p,w,y=l[0].avgTime+"",T,N;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=G(),o=v("span"),a=J("["),i=J(r),c=J(" / "),f=J(h),_=J("]"),b=G(),p=v("span"),w=J("avg "),T=J(y),N=J("s"),this.h()},l(L){e=g(L,"DIV",{class:!0});var E=A(e);t=g(E,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1eqfbgx"&&(t.textContent=s),n=M(E),o=g(E,"SPAN",{class:!0});var j=A(o);a=Q(j,"["),i=Q(j,r),c=Q(j," / "),f=Q(j,h),_=Q(j,"]"),j.forEach(m),b=M(E),p=g(E,"SPAN",{});var C=A(p);w=Q(C,"avg "),T=Q(C,y),N=Q(C,"s"),C.forEach(m),E.forEach(m),this.h()},h(){d(o,"class","mx-2"),d(e,"class","flex")},m(L,E){U(L,e,E),u(e,t),u(e,n),u(e,o),u(o,a),u(o,i),u(o,c),u(o,f),u(o,_),u(e,b),u(e,p),u(p,w),u(p,T),u(p,N)},p(L,E){E&1&&r!==(r=L[0].correct+"")&&ne(i,r),E&1&&h!==(h=L[0].sampled.length+"")&&ne(f,h),E&1&&y!==(y=L[0].avgTime+"")&&ne(T,y)},d(L){L&&m(e)}}}function Qn(l){var S,D,I,F;let e,t,s="Target:",n,o,a=((S=l[0].latestGuess.target)==null?void 0:S.chord)+"",r,i,c,h=((D=l[0].latestGuess.target)==null?void 0:D.notes.map(Ws).join(" "))+"",f,_,b,p="Guessed:",w,y,T=((I=l[0].latestGuess.guessed)==null?void 0:I.chord)+"",N,L,E,j=((F=l[0].latestGuess.guessed)==null?void 0:F.notes.map($s).join(" "))+"",C;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=G(),o=v("span"),r=J(a),i=G(),c=v("span"),f=J(h),_=G(),b=v("span"),b.textContent=p,w=G(),y=v("span"),N=J(T),L=G(),E=v("span"),C=J(j),this.h()},l(k){e=g(k,"DIV",{class:!0});var V=A(e);t=g(V,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=M(V),o=g(V,"SPAN",{});var P=A(o);r=Q(P,a),P.forEach(m),i=M(V),c=g(V,"SPAN",{});var O=A(c);f=Q(O,h),O.forEach(m),_=M(V),b=g(V,"SPAN",{"data-svelte-h":!0}),Z(b)!=="svelte-104368"&&(b.textContent=p),w=M(V),y=g(V,"SPAN",{});var B=A(y);N=Q(B,T),B.forEach(m),L=M(V),E=g(V,"SPAN",{});var K=A(E);C=Q(K,j),K.forEach(m),V.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(k,V){U(k,e,V),u(e,t),u(e,n),u(e,o),u(o,r),u(e,i),u(e,c),u(c,f),u(e,_),u(e,b),u(e,w),u(e,y),u(y,N),u(e,L),u(e,E),u(E,C)},p(k,V){var P,O,B,K;V&1&&a!==(a=((P=k[0].latestGuess.target)==null?void 0:P.chord)+"")&&ne(r,a),V&1&&h!==(h=((O=k[0].latestGuess.target)==null?void 0:O.notes.map(Ws).join(" "))+"")&&ne(f,h),V&1&&T!==(T=((B=k[0].latestGuess.guessed)==null?void 0:B.chord)+"")&&ne(N,T),V&1&&j!==(j=((K=k[0].latestGuess.guessed)==null?void 0:K.notes.map($s).join(" "))+"")&&ne(C,j)},d(k){k&&m(e)}}}function Yn(l){let e,t,s="Target:",n,o,a=l[0].latestGuess.target+"",r,i,c,h,f,_="Guessed:",b,p,w=l[0].latestGuess.guessed+"",y,T,N;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=G(),o=v("span"),r=J(a),i=G(),c=v("span"),h=G(),f=v("span"),f.textContent=_,b=G(),p=v("span"),y=J(w),T=G(),N=v("span"),this.h()},l(L){e=g(L,"DIV",{class:!0});var E=A(e);t=g(E,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=M(E),o=g(E,"SPAN",{});var j=A(o);r=Q(j,a),j.forEach(m),i=M(E),c=g(E,"SPAN",{}),A(c).forEach(m),h=M(E),f=g(E,"SPAN",{"data-svelte-h":!0}),Z(f)!=="svelte-104368"&&(f.textContent=_),b=M(E),p=g(E,"SPAN",{});var C=A(p);y=Q(C,w),C.forEach(m),T=M(E),N=g(E,"SPAN",{}),A(N).forEach(m),E.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(L,E){U(L,e,E),u(e,t),u(e,n),u(e,o),u(o,r),u(e,i),u(e,c),u(e,h),u(e,f),u(e,b),u(e,p),u(p,y),u(e,T),u(e,N)},p(L,E){E&1&&a!==(a=L[0].latestGuess.target+"")&&ne(r,a),E&1&&w!==(w=L[0].latestGuess.guessed+"")&&ne(y,w)},d(L){L&&m(e)}}}function Xn(l){let e,t,s="Target:",n,o,a=Qe(St(l[0].latestGuess.target||0))+"",r,i,c,h,f,_="Guessed:",b,p,w=Qe(St(l[0].latestGuess.guessed||0))+"",y,T,N;return{c(){e=v("div"),t=v("span"),t.textContent=s,n=G(),o=v("span"),r=J(a),i=G(),c=v("span"),h=G(),f=v("span"),f.textContent=_,b=G(),p=v("span"),y=J(w),T=G(),N=v("span"),this.h()},l(L){e=g(L,"DIV",{class:!0});var E=A(e);t=g(E,"SPAN",{"data-svelte-h":!0}),Z(t)!=="svelte-1s5czg5"&&(t.textContent=s),n=M(E),o=g(E,"SPAN",{});var j=A(o);r=Q(j,a),j.forEach(m),i=M(E),c=g(E,"SPAN",{}),A(c).forEach(m),h=M(E),f=g(E,"SPAN",{"data-svelte-h":!0}),Z(f)!=="svelte-104368"&&(f.textContent=_),b=M(E),p=g(E,"SPAN",{});var C=A(p);y=Q(C,w),C.forEach(m),T=M(E),N=g(E,"SPAN",{}),A(N).forEach(m),E.forEach(m),this.h()},h(){d(e,"class","guessed svelte-1lxfpqs")},m(L,E){U(L,e,E),u(e,t),u(e,n),u(e,o),u(o,r),u(e,i),u(e,c),u(e,h),u(e,f),u(e,b),u(e,p),u(p,y),u(e,T),u(e,N)},p(L,E){E&1&&a!==(a=Qe(St(L[0].latestGuess.target||0))+"")&&ne(r,a),E&1&&w!==(w=Qe(St(L[0].latestGuess.guessed||0))+"")&&ne(y,w)},d(L){L&&m(e)}}}function qs(l){let e,t=Qe(l[10])+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=A(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","mx-1")},m(n,o){U(n,e,o),u(e,s)},p(n,o){o&4&&t!==(t=Qe(n[10])+"")&&ne(s,t)},d(n){n&&m(e)}}}function Zn(l){let e;return{c(){e=J(" ")},l(t){e=Q(t," ")},m(t,s){U(t,e,s)},p:he,d(t){t&&m(e)}}}function ea(l){let e,t="Next",s,n,o="Autoplay",a,r;return{c(){e=v("button"),e.textContent=t,s=G(),n=v("button"),n.textContent=o,this.h()},l(i){e=g(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1nvnoba"&&(e.textContent=t),s=M(i),n=g(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1cfj1sl"&&(n.textContent=o),this.h()},h(){d(e,"class","btn primary"),d(n,"class","btn primary")},m(i,c){U(i,e,c),U(i,s,c),U(i,n,c),a||(r=[x(e,"click",l[4]),x(n,"click",l[5])],a=!0)},p:he,d(i){i&&(m(e),m(s),m(n)),a=!1,at(r)}}}function ta(l){let e,t="Stop autoplay",s,n;return{c(){e=v("button"),e.textContent=t,this.h()},l(o){e=g(o,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){d(e,"class","btn primary")},m(o,a){U(o,e,a),s||(n=x(e,"click",l[9]),s=!0)},p:he,d(o){o&&m(e),s=!1,n()}}}function sa(l){let e,t="Try Again",s,n,o="Clear",a,r;return{c(){e=v("button"),e.textContent=t,s=G(),n=v("button"),n.textContent=o,this.h()},l(i){e=g(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-y911ux"&&(e.textContent=t),s=M(i),n=g(i,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-11mnk9v"&&(n.textContent=o),this.h()},h(){d(e,"class","btn primary"),d(n,"class","btn primary")},m(i,c){U(i,e,c),U(i,s,c),U(i,n,c),a||(r=[x(e,"click",l[6]),x(n,"click",l[7])],a=!0)},p:he,d(i){i&&(m(e),m(s),m(n)),a=!1,at(r)}}}function la(l){let e,t,s,n;function o(f,_){return f[0]instanceof At&&(f[1]==="correct"||f[1]==="wrong")?Xn:f[0]instanceof It&&(f[1]==="correct"||f[1]==="wrong")?Yn:f[0]instanceof rt&&(f[1]==="correct"||f[1]==="wrong")?Qn:f[0]&&f[1]==="ended"?Jn:f[2].length>0?$n:Wn}let a=o(l),r=a(l);function i(f,_){return f[0]&&f[1]==="ended"?sa:f[0]&&f[3].autoplay?ta:f[0]?ea:Zn}let c=i(l),h=c(l);return{c(){e=v("div"),r.c(),s=G(),n=v("div"),h.c(),this.h()},l(f){e=g(f,"DIV",{class:!0});var _=A(e);r.l(_),_.forEach(m),s=M(f),n=g(f,"DIV",{class:!0});var b=A(n);h.l(b),b.forEach(m),this.h()},h(){d(e,"class",t=Se(`${l[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),d(n,"class","mt-2 h-8")},m(f,_){U(f,e,_),r.m(e,null),U(f,s,_),U(f,n,_),h.m(n,null)},p(f,[_]){a===(a=o(f))&&r?r.p(f,_):(r.d(1),r=a(f),r&&(r.c(),r.m(e,null))),_&256&&t!==(t=Se(`${f[8].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs")&&d(e,"class",t),c===(c=i(f))&&h?h.p(f,_):(h.d(1),h=c(f),h&&(h.c(),h.m(n,null)))},i:he,o:he,d(f){f&&(m(e),m(s),m(n)),r.d(),h.d()}}}const Ws=l=>l.note,$s=l=>l.note;function na(l,e,t){let s,n,o;re(l,_t,_=>t(1,s=_)),re(l,mt,_=>t(2,n=_)),re(l,it,_=>t(3,o=_));let{game:a}=e;function r(){be.nextGuess()}function i(){be.setOptionValue("autoplay",!0),be.nextGuess()}function c(){a instanceof rt?be.play(a.type,a.opts):a&&be.play(a.type,void 0)}function h(){be.clearGame()}const f=()=>be.setOptionValue("autoplay",!1);return l.$$set=_=>{t(8,e=ye(ye({},e),ke(_))),"game"in _&&t(0,a=_.game)},e=ke(e),[a,s,n,o,r,i,c,h,e,f]}class aa extends He{constructor(e){super(),xe(this,e,na,la,ze,{game:0})}}function Js(l){let e;return{c(){e=v("li"),this.h()},l(t){e=g(t,"LI",{class:!0}),A(e).forEach(m),this.h()},h(){d(e,"class","m-[0.175rem] mr-0")},m(t,s){U(t,e,s)},d(t){t&&m(e)}}}function Qs(l){let e;return{c(){e=v("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),A(e).forEach(m),this.h()},h(){d(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-jvhfju")},m(t,s){U(t,e,s)},d(t){t&&m(e)}}}function Ys(l){let e,t=l[0].note.note+"",s;return{c(){e=v("div"),s=J(t),this.h()},l(n){e=g(n,"DIV",{class:!0});var o=A(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","absolute top-0 left-0")},m(n,o){U(n,e,o),u(e,s)},p(n,o){o&1&&t!==(t=n[0].note.note+"")&&ne(s,t)},d(n){n&&m(e)}}}function oa(l){let e,t,s,n,o,a,r=l[0].key+"",i,c,h,f,_=l[0].key==="{enter}"&&Js(),b=l[0].key==="{enter}"&&Qs(),p=l[0].note&&Ys(l);return{c(){_&&_.c(),e=G(),t=v("li"),s=v("button"),b&&b.c(),n=G(),p&&p.c(),o=G(),a=v("div"),i=J(r),this.h()},l(w){_&&_.l(w),e=M(w),t=g(w,"LI",{class:!0});var y=A(t);s=g(y,"BUTTON",{class:!0});var T=A(s);b&&b.l(T),n=M(T),p&&p.l(T),o=M(T),a=g(T,"DIV",{});var N=A(a);i=Q(N,r),N.forEach(m),T.forEach(m),y.forEach(m),this.h()},h(){d(s,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex items-center justify-center svelte-jvhfju"),d(t,"class",c=Se(`${l[1].class||""} m-[0.175rem] ${Xs(l[0].size)}`)+" svelte-jvhfju"),q(t,"enter",l[0].key==="{enter}")},m(w,y){_&&_.m(w,y),U(w,e,y),U(w,t,y),u(t,s),b&&b.m(s,null),u(s,n),p&&p.m(s,null),u(s,o),u(s,a),u(a,i),h||(f=x(s,"click",l[2]),h=!0)},p(w,[y]){w[0].key==="{enter}"?_||(_=Js(),_.c(),_.m(e.parentNode,e)):_&&(_.d(1),_=null),w[0].key==="{enter}"?b||(b=Qs(),b.c(),b.m(s,n)):b&&(b.d(1),b=null),w[0].note?p?p.p(w,y):(p=Ys(w),p.c(),p.m(s,o)):p&&(p.d(1),p=null),y&1&&r!==(r=w[0].key+"")&&ne(i,r),y&3&&c!==(c=Se(`${w[1].class||""} m-[0.175rem] ${Xs(w[0].size)}`)+" svelte-jvhfju")&&d(t,"class",c),y&3&&q(t,"enter",w[0].key==="{enter}")},i:he,o:he,d(w){w&&(m(e),m(t)),_&&_.d(w),b&&b.d(),p&&p.d(),h=!1,f()}}}function Xs(l){return l&&Number.isInteger(l)?`size-${l}`:l?`size-${Math.floor(l)}-${Math.floor(l*10)-Math.floor(l)*10}`:"size-1"}function ra(l,e,t){let{value:s}=e;function n(o){cs.call(this,l,o)}return l.$$set=o=>{t(1,e=ye(ye({},e),ke(o))),"value"in o&&t(0,s=o.value)},e=ke(e),[s,e,n]}class ia extends He{constructor(e){super(),xe(this,e,ra,oa,ze,{value:0})}}const ca={layout:{default:["§ 1 2 3 4 5 6 7 8 9 0 + ´ {bksp}","{tab} q w e r t y u i o p å ¨ {enter}","{lock} a s d f g h j k l ö ä '","{shift} < z x c v b n m , . - {shift}",".com @ {space}"],shift:['° ! " # $ % & / ( ) = ? ` {bksp}',"{tab} Q W E R T Y U I O P Å ^","{lock} A S D F G H J K L Ö Ä * {enter}","{shift} > Z X C V B N M ; : _ {shift}",".com @ {space}"]}},ua=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];class fa{constructor(e={layout:"middle-row"}){this.language="en",this.rows=[[],[],[],[]],this.opts=e,this.setLayout(ca)}setOptions(e){this.opts={...this.opts,...e}}setLayout(e){const t=[[],[],[],[]];e.layout.default.forEach((s,n)=>{s.split(" ").forEach((o,a)=>{n<4&&t[n].push({key:o,code:ua[n][a]})})}),this.rows=t}setNotes(e){this.opts.layout==="middle-row"&&(this.rows[1].forEach((t,s)=>{s===2?this.rows[1][s].note=e.get(1):s===3?this.rows[1][s].note=e.get(3):s===5?this.rows[1][s].note=e.get(6):s===6?this.rows[1][s].note=e.get(8):s===7?this.rows[1][s].note=e.get(10):s===9?(this.rows[1][s].note={...e.get(1)},this.rows[1][s].note.semitones+=12):s===10&&(this.rows[1][s].note={...e.get(3)},this.rows[1][s].note.semitones+=12)}),this.rows[2].forEach((t,s)=>{s===1?this.rows[2][s].note=e.get(0):s===2?this.rows[2][s].note=e.get(2):s===3?this.rows[2][s].note=e.get(4):s===4?this.rows[2][s].note=e.get(5):s===5?this.rows[2][s].note=e.get(7):s===6?this.rows[2][s].note=e.get(9):s===7?this.rows[2][s].note=e.get(11):s===8?(this.rows[2][s].note={...e.get(0)},this.rows[2][s].note.semitones+=12):s===9?(this.rows[2][s].note={...e.get(2)},this.rows[2][s].note.semitones+=12):s===10?(this.rows[2][s].note={...e.get(4)},this.rows[2][s].note.semitones+=12):s===11?(this.rows[2][s].note={...e.get(5)},this.rows[2][s].note.semitones+=12):s===12&&(this.rows[2][s].note={...e.get(7)},this.rows[2][s].note.semitones+=12)}))}}const ha=ct(Ge({layout:"middle-row"}),{key:"keyboard-options"}),Ql=yt([bt,ha],([l,e])=>{const t=new fa(e);return t.setNotes(l.notesMap),t}),da=yt(Ql,l=>l.rows.map(e=>e.map((t,s)=>{let n;return t.key==="{bksp}"?n=2:t.key==="{tab}"?n=1.5:t.key==="{enter}"?n=2:t.key==="{lock}"?n=1.75:t.key==="{shift}"&&s===0?n=1.5:t.key==="{shift}"&&(n=2.5),n?{...t,size:n}:t}))),Yl=yt(Ql,l=>new Map([...l.rows[0].map(e=>[e.code,e]),...l.rows[1].map(e=>[e.code,e]),...l.rows[2].map(e=>[e.code,e]),...l.rows[3].map(e=>[e.code,e])]));yt(Yl,l=>Array.from(l.values()).map(e=>e.note).filter(e=>e!==void 0));function Zs(l,e,t){const s=l.slice();return s[7]=e[t],s[9]=t,s}function el(l,e,t){const s=l.slice();return s[10]=e[t],s}function tl(l){let e,t;return e=new ia({props:{value:l[10]}}),{c(){_e(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,n){ve(e,s,n),t=!0},p(s,n){const o={};n&4&&(o.value=s[10]),e.$set(o)},i(s){t||(z(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){ge(e,s)}}}function sl(l){let e,t,s,n,o=se(l[7]),a=[];for(let i=0;i<o.length;i+=1)a[i]=tl(el(l,o,i));const r=i=>$(a[i],1,1,()=>{a[i]=null});return{c(){e=v("li"),t=G();for(let i=0;i<a.length;i+=1)a[i].c();s=De(),this.h()},l(i){e=g(i,"LI",{class:!0}),A(e).forEach(m),t=M(i);for(let c=0;c<a.length;c+=1)a[c].l(i);s=De(),this.h()},h(){d(e,"class","col-span-2 svelte-cgcsqn")},m(i,c){U(i,e,c),U(i,t,c);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(i,c);U(i,s,c),n=!0},p(i,c){if(c&4){o=se(i[7]);let h;for(h=0;h<o.length;h+=1){const f=el(i,o,h);a[h]?(a[h].p(f,c),z(a[h],1)):(a[h]=tl(f),a[h].c(),z(a[h],1),a[h].m(s.parentNode,s))}for(tt(),h=o.length;h<a.length;h+=1)r(h);st()}},i(i){if(!n){for(let c=0;c<o.length;c+=1)z(a[c]);n=!0}},o(i){a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)$(a[c]);n=!1},d(i){i&&(m(e),m(t),m(s)),je(a,i)}}}function ma(l){let e,t,s,n,o="Middle-row",a,r,i,c,h,f="Two rows",_,b,p,w,y,T,N,L,E,j=se(l[2]),C=[];for(let D=0;D<j.length;D+=1)C[D]=sl(Zs(l,j,D));const S=D=>$(C[D],1,1,()=>{C[D]=null});return{c(){e=v("div"),t=v("div"),s=v("div"),n=v("label"),n.textContent=o,a=G(),r=v("input"),i=G(),c=v("div"),h=v("label"),h.textContent=f,_=G(),b=v("input"),p=G(),w=v("div"),y=v("ul");for(let D=0;D<C.length;D+=1)C[D].c();this.h()},l(D){e=g(D,"DIV",{class:!0});var I=A(e);t=g(I,"DIV",{class:!0});var F=A(t);s=g(F,"DIV",{class:!0});var k=A(s);n=g(k,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1ssbs6o"&&(n.textContent=o),a=M(k),r=g(k,"INPUT",{class:!0,id:!0,type:!0}),k.forEach(m),i=M(F),c=g(F,"DIV",{class:!0});var V=A(c);h=g(V,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(h)!=="svelte-3aw9ul"&&(h.textContent=f),_=M(V),b=g(V,"INPUT",{class:!0,id:!0,type:!0}),V.forEach(m),F.forEach(m),p=M(I),w=g(I,"DIV",{class:!0});var P=A(w);y=g(P,"UL",{class:!0});var O=A(y);for(let B=0;B<C.length;B+=1)C[B].l(O);O.forEach(m),P.forEach(m),I.forEach(m),this.h()},h(){d(n,"class","font-bold mr-4"),d(n,"for","middle-row"),d(r,"class","h-[20px]"),d(r,"id","middle-row"),d(r,"type","checkbox"),d(s,"class","my-1 flex items-center justify-between mr-12"),d(h,"class","font-bold mr-4"),d(h,"for","two-rows"),d(b,"class","h-[20px]"),d(b,"id","two-rows"),d(b,"type","checkbox"),d(c,"class","my-1 flex items-center justify-between mr-12"),d(t,"class","flex"),d(y,"class","keyboard svelte-cgcsqn"),d(w,"class","flex flex-col gap-1.5"),d(e,"class",T=Se(`${l[3].class||""} `)+" svelte-cgcsqn")},m(D,I){U(D,e,I),u(e,t),u(t,s),u(s,n),u(s,a),u(s,r),r.checked=l[0],u(t,i),u(t,c),u(c,h),u(c,_),u(c,b),b.checked=l[1],u(e,p),u(e,w),u(w,y);for(let F=0;F<C.length;F+=1)C[F]&&C[F].m(y,null);N=!0,L||(E=[x(r,"change",l[4]),x(b,"change",l[5])],L=!0)},p(D,[I]){if(I&1&&(r.checked=D[0]),I&2&&(b.checked=D[1]),I&4){j=se(D[2]);let F;for(F=0;F<j.length;F+=1){const k=Zs(D,j,F);C[F]?(C[F].p(k,I),z(C[F],1)):(C[F]=sl(k),C[F].c(),z(C[F],1),C[F].m(y,null))}for(tt(),F=j.length;F<C.length;F+=1)S(F);st()}(!N||I&8&&T!==(T=Se(`${D[3].class||""} `)+" svelte-cgcsqn"))&&d(e,"class",T)},i(D){if(!N){for(let I=0;I<j.length;I+=1)z(C[I]);N=!0}},o(D){C=C.filter(Boolean);for(let I=0;I<C.length;I+=1)$(C[I]);N=!1},d(D){D&&m(e),je(C,D),L=!1,at(E)}}}function _a(l,e,t){let s,n;re(l,Yl,c=>t(6,s=c)),re(l,da,c=>t(2,n=c)),Gl(()=>{console.log(s)});let o=!0,a=!1;function r(){o=this.checked,t(0,o)}function i(){a=this.checked,t(1,a)}return l.$$set=c=>{t(3,e=ye(ye({},e),ke(c)))},e=ke(e),[o,a,n,e,r,i]}class pa extends He{constructor(e){super(),xe(this,e,_a,ma,ze,{})}}function ll(l){let e,t;return e=new pa({props:{class:"mt-4"}}),{c(){_e(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,n){ve(e,s,n),t=!0},i(s){t||(z(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){ge(e,s)}}}function va(l){let e,t,s,n,o="I/O",a,r,i,c,h="Device",f,_,b,p,w,y,T="Prompt",N,L,E="Disable",j,C,S,D,I="Sound",F,k,V,P,O,B,K="Fixed velocity",H,ee,te,ce,ae,Te,Fe="Keyboard",Me,me,qe,Ue,Ne,oe,Ae="Hotkeys",de,W,le,R,Y,ie,X="Auto-octave",we,Le,lt,We,Ve,Ie,Ce,Tt="Set keys",kt,Ke,ut,ms="Fade timeout",Qt,Ye,Yt,ft,jt,Xt,ht,_s="Reset all",Zt,Dt,$e,es,ps,Pe=l[2]&&ll();return{c(){e=v("div"),t=v("fieldset"),s=v("legend"),n=v("button"),n.textContent=o,a=G(),r=v("div"),i=v("div"),c=v("label"),c.textContent=h,f=G(),_=v("input"),p=G(),w=v("div"),y=v("button"),y.textContent=T,N=G(),L=v("button"),L.textContent=E,j=G(),C=v("div"),S=v("div"),D=v("label"),D.textContent=I,F=G(),k=v("input"),P=G(),O=v("div"),B=v("label"),B.textContent=K,H=G(),ee=v("input"),te=G(),ce=v("div"),ae=v("div"),Te=v("label"),Te.textContent=Fe,Me=G(),me=v("input"),Ue=G(),Ne=v("div"),oe=v("label"),oe.textContent=Ae,de=G(),W=v("input"),R=G(),Y=v("div"),ie=v("label"),ie.textContent=X,we=G(),Le=v("input"),We=G(),Ve=v("div"),Ie=v("div"),Ce=v("button"),Ce.textContent=Tt,kt=G(),Ke=v("div"),ut=v("label"),ut.textContent=ms,Qt=G(),Ye=v("input"),Yt=G(),ft=v("div"),jt=v("div"),Xt=G(),ht=v("button"),ht.textContent=_s,Zt=G(),Pe&&Pe.c(),this.h()},l(Ee){e=g(Ee,"DIV",{class:!0});var Oe=A(e);t=g(Oe,"FIELDSET",{class:!0});var ot=A(t);s=g(ot,"LEGEND",{class:!0});var vs=A(s);n=g(vs,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-1jbbsti"&&(n.textContent=o),vs.forEach(m),a=M(ot),r=g(ot,"DIV",{class:!0});var dt=A(r);i=g(dt,"DIV",{class:!0});var wt=A(i);c=g(wt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(c)!=="svelte-crpa7y"&&(c.textContent=h),f=M(wt),_=g(wt,"INPUT",{class:!0,id:!0}),p=M(wt),w=g(wt,"DIV",{class:!0});var Lt=A(w);y=g(Lt,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(y)!=="svelte-mj6mct"&&(y.textContent=T),N=M(Lt),L=g(Lt,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(L)!=="svelte-1sl6oxh"&&(L.textContent=E),Lt.forEach(m),wt.forEach(m),j=M(dt),C=g(dt,"DIV",{class:!0});var Pt=A(C);S=g(Pt,"DIV",{class:!0});var Bt=A(S);D=g(Bt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(D)!=="svelte-wgxtkw"&&(D.textContent=I),F=M(Bt),k=g(Bt,"INPUT",{class:!0,id:!0,type:!0}),Bt.forEach(m),P=M(Pt),O=g(Pt,"DIV",{class:!0});var Gt=A(O);B=g(Gt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(B)!=="svelte-1tm2bth"&&(B.textContent=K),H=M(Gt),ee=g(Gt,"INPUT",{class:!0,id:!0,placeholder:!0}),Gt.forEach(m),Pt.forEach(m),te=M(dt),ce=g(dt,"DIV",{class:!0});var Ct=A(ce);ae=g(Ct,"DIV",{class:!0});var Mt=A(ae);Te=g(Mt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(Te)!=="svelte-1js269u"&&(Te.textContent=Fe),Me=M(Mt),me=g(Mt,"INPUT",{class:!0,id:!0,type:!0}),Mt.forEach(m),Ue=M(Ct),Ne=g(Ct,"DIV",{class:!0});var Vt=A(Ne);oe=g(Vt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(oe)!=="svelte-21h39k"&&(oe.textContent=Ae),de=M(Vt),W=g(Vt,"INPUT",{class:!0,id:!0,type:!0}),Vt.forEach(m),R=M(Ct),Y=g(Ct,"DIV",{class:!0});var Kt=A(Y);ie=g(Kt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(ie)!=="svelte-33lczu"&&(ie.textContent=X),we=M(Kt),Le=g(Kt,"INPUT",{class:!0,id:!0,type:!0}),Kt.forEach(m),Ct.forEach(m),We=M(dt),Ve=g(dt,"DIV",{class:!0});var Et=A(Ve);Ie=g(Et,"DIV",{class:!0});var gs=A(Ie);Ce=g(gs,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(Ce)!=="svelte-1npcis2"&&(Ce.textContent=Tt),gs.forEach(m),kt=M(Et),Ke=g(Et,"DIV",{class:!0});var Ot=A(Ke);ut=g(Ot,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(ut)!=="svelte-vd5i27"&&(ut.textContent=ms),Qt=M(Ot),Ye=g(Ot,"INPUT",{class:!0,id:!0}),Ot.forEach(m),Yt=M(Et),ft=g(Et,"DIV",{class:!0});var Ut=A(ft);jt=g(Ut,"DIV",{}),A(jt).forEach(m),Xt=M(Ut),ht=g(Ut,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(ht)!=="svelte-jjt0c3"&&(ht.textContent=_s),Ut.forEach(m),Et.forEach(m),dt.forEach(m),Zt=M(ot),Pe&&Pe.l(ot),ot.forEach(m),Oe.forEach(m),this.h()},h(){var Ee;d(n,"class","px-1 rounded hover:bg-gray-100"),d(s,"class","text-base"),d(c,"class","font-bold"),d(c,"for","device"),d(_,"class","px-1 my-1 rounded w-50"),d(_,"id","device"),_.disabled=!0,_.value=b=((Ee=l[5])==null?void 0:Ee.name)??"No device",d(y,"class","btn-sm primary mr-2"),d(L,"class","btn-sm primary"),d(w,"class","flex my-[auto]"),d(i,"class","h-full flex flex-col"),d(D,"class","font-bold"),d(D,"for","sound"),d(k,"class","h-[20px]"),d(k,"id","sound"),d(k,"type","checkbox"),k.checked=V=l[3].useSound,d(S,"class","my-1 flex justify-between mr-12"),d(B,"class","font-bold"),d(B,"for","fixed-velocity"),d(ee,"class","h-[20px] w-16"),d(ee,"id","fixed-velocity"),d(ee,"placeholder","0-127"),d(O,"class","flex justify-between"),d(C,"class","flex flex-col h-full"),d(Te,"class","font-bold"),d(Te,"for","keyboard"),d(me,"class","h-[20px]"),d(me,"id","keyboard"),d(me,"type","checkbox"),me.checked=qe=l[3].useKeyboard,d(ae,"class","my-1 flex justify-between mr-12"),d(oe,"class","font-bold"),d(oe,"for","hotkeys"),d(W,"class","h-[20px]"),d(W,"id","hotkeys"),d(W,"type","checkbox"),W.checked=le=l[3].useHotkeys,d(Ne,"class","my-1 flex justify-between mr-12"),d(ie,"class","font-bold"),d(ie,"for","auto-octave"),d(Le,"class","h-[20px]"),d(Le,"id","auto-octave"),d(Le,"type","checkbox"),Le.checked=lt=l[3].useAutoOctave,d(Y,"class","my-1 flex justify-between mr-12"),d(ce,"class","flex flex-col h-full"),d(Ce,"class","w-full btn-sm primary"),d(Ie,"class","flex justify-between"),d(ut,"class","font-bold"),d(ut,"for","fade-timeout"),d(Ye,"class","h-[20px] w-16"),d(Ye,"id","fade-timeout"),Ye.value=l[1],d(Ke,"class","flex justify-between"),d(ht,"class","btn-sm primary"),d(ft,"class","flex justify-between"),d(Ve,"class","flex flex-col justify-between h-full"),d(r,"class","body svelte-1bpw69s"),q(r,"hidden",l[4]),d(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-1bpw69s"),q(t,"collapsed",l[4]),d(e,"class",Dt=Se(`${l[11].class||""}`)+" svelte-1bpw69s")},m(Ee,Oe){U(Ee,e,Oe),u(e,t),u(t,s),u(s,n),u(t,a),u(t,r),u(r,i),u(i,c),u(i,f),u(i,_),u(i,p),u(i,w),u(w,y),u(w,N),u(w,L),u(r,j),u(r,C),u(C,S),u(S,D),u(S,F),u(S,k),u(C,P),u(C,O),u(O,B),u(O,H),u(O,ee),Je(ee,l[0]),u(r,te),u(r,ce),u(ce,ae),u(ae,Te),u(ae,Me),u(ae,me),u(ce,Ue),u(ce,Ne),u(Ne,oe),u(Ne,de),u(Ne,W),u(ce,R),u(ce,Y),u(Y,ie),u(Y,we),u(Y,Le),u(r,We),u(r,Ve),u(Ve,Ie),u(Ie,Ce),u(Ve,kt),u(Ve,Ke),u(Ke,ut),u(Ke,Qt),u(Ke,Ye),u(Ve,Yt),u(Ve,ft),u(ft,jt),u(ft,Xt),u(ft,ht),u(t,Zt),Pe&&Pe.m(t,null),$e=!0,es||(ps=[x(n,"click",l[7]),x(y,"click",fe.openMidi),x(L,"click",fe.disableMidi),x(k,"change",l[12]),x(ee,"input",l[13]),x(ee,"focus",l[14]),x(ee,"change",l[8]),x(me,"change",l[15]),x(W,"change",l[16]),x(Le,"change",l[17]),x(Ce,"click",l[18]),x(Ye,"focus",l[19]),x(Ye,"blur",l[20]),x(Ye,"input",l[9]),x(ht,"click",l[10])],es=!0)},p(Ee,[Oe]){var ot;(!$e||Oe&32&&b!==(b=((ot=Ee[5])==null?void 0:ot.name)??"No device")&&_.value!==b)&&(_.value=b),(!$e||Oe&8&&V!==(V=Ee[3].useSound))&&(k.checked=V),Oe&1&&ee.value!==Ee[0]&&Je(ee,Ee[0]),(!$e||Oe&8&&qe!==(qe=Ee[3].useKeyboard))&&(me.checked=qe),(!$e||Oe&8&&le!==(le=Ee[3].useHotkeys))&&(W.checked=le),(!$e||Oe&8&&lt!==(lt=Ee[3].useAutoOctave))&&(Le.checked=lt),(!$e||Oe&2&&Ye.value!==Ee[1])&&(Ye.value=Ee[1]),(!$e||Oe&16)&&q(r,"hidden",Ee[4]),Ee[2]?Pe?Oe&4&&z(Pe,1):(Pe=ll(),Pe.c(),z(Pe,1),Pe.m(t,null)):Pe&&(tt(),$(Pe,1,1,()=>{Pe=null}),st()),(!$e||Oe&16)&&q(t,"collapsed",Ee[4]),(!$e||Oe&2048&&Dt!==(Dt=Se(`${Ee[11].class||""}`)+" svelte-1bpw69s"))&&d(e,"class",Dt)},i(Ee){$e||(z(Pe),$e=!0)},o(Ee){$(Pe),$e=!1},d(Ee){Ee&&m(e),Pe&&Pe.d(),es=!1,at(ps)}}}function ga(l,e,t){let s,n,o;re(l,vt,S=>t(3,s=S)),re(l,$t,S=>t(5,o=S));const a=ct(Ge(!1),{key:"inputs-hidden"});re(l,a,S=>t(4,n=S));let r=s.fixedVelocity??"",i=s.keyFadeTimeout,c=!1;vt.subscribe(S=>{t(0,r=S.fixedVelocity??""),t(1,i=S.keyFadeTimeout)});function h(){a.update(S=>!S)}function f(S){const{value:D}=S.currentTarget;let I;if(D)try{I=parseInt(D)}catch{}I!==void 0&&I>=0&&I<=127?fe.setInputValue("fixedVelocity",I):D?t(0,r=s.fixedVelocity||""):fe.setInputValue("fixedVelocity",void 0),fe.setKeyboardFocus(!0)}function _(S){try{const D=parseInt(S.currentTarget.value);fe.setInputValue("keyFadeTimeout",D)}catch{t(1,i=s.keyFadeTimeout)}}function b(){Tn()}const p=S=>fe.setInputValue("useSound",S.currentTarget.checked);function w(){r=this.value,t(0,r)}const y=()=>fe.setKeyboardFocus(!1),T=S=>fe.setInputValue("useKeyboard",S.currentTarget.checked),N=S=>fe.setInputValue("useHotkeys",S.currentTarget.checked),L=S=>fe.setInputValue("useAutoOctave",S.currentTarget.checked),E=()=>t(2,c=!c),j=()=>fe.setKeyboardFocus(!1),C=()=>fe.setKeyboardFocus(!0);return l.$$set=S=>{t(11,e=ye(ye({},e),ke(S)))},e=ke(e),[r,i,c,s,n,o,a,h,f,_,b,e,p,w,y,T,N,L,E,j,C]}class ba extends He{constructor(e){super(),xe(this,e,ga,va,ze,{})}}function ya(l){let e;return{c(){e=J(" ")},l(t){e=Q(t," ")},m(t,s){U(t,e,s)},p:he,d(t){t&&m(e)}}}function ka(l){let e,t=l[2].note+"",s;return{c(){e=J("Input: "),s=J(t)},l(n){e=Q(n,"Input: "),s=Q(n,t)},m(n,o){U(n,e,o),U(n,s,o)},p(n,o){o&4&&t!==(t=n[2].note+"")&&ne(s,t)},d(n){n&&(m(e),m(s))}}}function wa(l){let e,t;return{c(){e=J("Input: "),t=J(l[1])},l(s){e=Q(s,"Input: "),t=Q(s,l[1])},m(s,n){U(s,e,n),U(s,t,n)},p(s,n){n&2&&ne(t,s[1])},d(s){s&&(m(e),m(t))}}}function Ca(l){let e;return{c(){e=J(l[0])},l(t){e=Q(t,l[0])},m(t,s){U(t,e,s)},p(t,s){s&1&&ne(e,t[0])},d(t){t&&m(e)}}}function Ea(l){let e,t,s,n;function o(i,c){return i[3].useKeyboard&&i[0]?Ca:i[3].useKeyboard&&i[1]?wa:i[3].useKeyboard&&i[2]?ka:ya}let a=o(l),r=a(l);return{c(){e=v("div"),r.c(),this.h()},l(i){e=g(i,"DIV",{class:!0});var c=A(e);r.l(c),c.forEach(m),this.h()},h(){d(e,"class",t=`${l[5].class||""}`)},m(i,c){U(i,e,c),r.m(e,null),s||(n=x(window,"keydown",l[4]),s=!0)},p(i,[c]){a===(a=o(i))&&r?r.p(i,c):(r.d(1),r=a(i),r&&(r.c(),r.m(e,null))),c&32&&t!==(t=`${i[5].class||""}`)&&d(e,"class",t)},i:he,o:he,d(i){i&&m(e),r.d(),s=!1,n()}}}const Sa=/^[a-gA-G]$/,Aa=/^[♭Bb#♯sS]$/,Ta=/^[0-9]$/;function Na(l,e,t){let s,n,o,a,r;re(l,vt,w=>t(3,s=w)),re(l,$l,w=>t(7,n=w)),re(l,pt,w=>t(8,o=w)),re(l,Wl,w=>t(9,a=w)),re(l,Jt,w=>t(10,r=w));let{debounced:i}=e;const c=sn();let h="",f="",_;function b(w){const y=w.key.toUpperCase(),T=n;let N;if(!_&&s.useHotkeys&&y in T){const L=T[y];t(2,_=L),t(0,h=""),s.useAutoOctave&&(N=zl(r[0].midi))}else!s.useHotkeys&&f.length===0&&Sa.test(y)?t(1,f+=y):!s.useHotkeys&&f.length>0&&Aa.test(y)&&(y==="B"?t(1,f+="♭"):t(1,f+="♯"));if(Ta.test(y))try{N=parseInt(y)}catch{}if(_&&N!==void 0){const L=_.semitones+(N+1+(w.shiftKey?1:0))*12;c("note",L),t(2,_=void 0)}else if(f&&N!==void 0){const L=ue.findNote(f),E=L?L.semitones+(N+1)*12:void 0;E!==void 0&&c("note",E),t(1,f="")}else w.key==="Backspace"&&(t(2,_=void 0),t(1,f=f.slice(0,-1)))}function p(w){if(i||!a)return;const y=o;if(y instanceof It){const T=w.key.toUpperCase(),N=n;if(f.length===0&&T in N){const L=N[T].note;c("guessed-key",L),t(1,f="")}else w.key==="Backspace"&&t(1,f=f.slice(0,-1))}else if(y instanceof rt&&y.type==="chords-write")if(w.key==="Enter"&&f.length>0){let T={note:"",flats:0,sharps:0,chord:""};for(let N=0;N<f.length;N+=1)N===0?T.note+=f[N]:T.chord.length>0?T.chord+=f[N]:f[N]==="b"||f[N]==="♭"?T.flats+=1:f[N]==="#"||f[N]==="♯"?T.sharps+=1:T.chord+=f[N];c("guessed-chord",T),t(1,f="")}else w.key==="Backspace"?t(1,f=f.slice(0,-1)):w.key.length===1&&(t(1,f+=w.key),f.length===1&&t(1,f=f.toUpperCase()));else s.useKeyboard&&b(w)}return l.$$set=w=>{t(5,e=ye(ye({},e),ke(w))),"debounced"in w&&t(6,i=w.debounced)},e=ke(e),[h,f,_,s,p,e,i]}class Ia extends He{constructor(e){super(),xe(this,e,Na,Ea,ze,{debounced:6})}}function ja(l){let e,t,s,n="Count",o,a,r,i,c,h="Duplicates",f,_,b,p,w,y,T="Autoplay",N,L,E,j,C,S,D="Wait seconds",I,F,k,V,P;return{c(){e=v("ul"),t=v("li"),s=v("label"),s.textContent=n,o=G(),a=v("input"),r=G(),i=v("li"),c=v("label"),c.textContent=h,f=G(),_=v("input"),p=G(),w=v("li"),y=v("label"),y.textContent=T,N=G(),L=v("input"),j=G(),C=v("li"),S=v("label"),S.textContent=D,I=G(),F=v("input"),this.h()},l(O){e=g(O,"UL",{class:!0});var B=A(e);t=g(B,"LI",{class:!0});var K=A(t);s=g(K,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(s)!=="svelte-wgq9fc"&&(s.textContent=n),o=M(K),a=g(K,"INPUT",{class:!0,id:!0,type:!0}),K.forEach(m),r=M(B),i=g(B,"LI",{class:!0});var H=A(i);c=g(H,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(c)!=="svelte-hcg9dq"&&(c.textContent=h),f=M(H),_=g(H,"INPUT",{class:!0,id:!0,type:!0}),H.forEach(m),p=M(B),w=g(B,"LI",{class:!0});var ee=A(w);y=g(ee,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(y)!=="svelte-lr68n2"&&(y.textContent=T),N=M(ee),L=g(ee,"INPUT",{class:!0,id:!0,type:!0}),ee.forEach(m),j=M(B),C=g(B,"LI",{class:!0});var te=A(C);S=g(te,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(S)!=="svelte-1qj2vcy"&&(S.textContent=D),I=M(te),F=g(te,"INPUT",{class:!0,id:!0,type:!0}),te.forEach(m),B.forEach(m),this.h()},h(){d(s,"class","font-bold"),d(s,"for","guess-count"),d(a,"class","h-[20px] w-10"),d(a,"id","guess-count"),d(a,"type","number"),d(t,"class","flex items-center justify-between svelte-1elvih2"),d(c,"class","font-bold"),d(c,"for","duplicates"),d(_,"class","h-[20px]"),d(_,"id","duplicates"),d(_,"type","checkbox"),_.checked=b=l[2].duplicates,d(i,"class","flex items-center justify-between mr-6 svelte-1elvih2"),d(y,"class","font-bold"),d(y,"for","autoplay"),d(L,"class","h-[20px]"),d(L,"id","autoplay"),d(L,"type","checkbox"),L.checked=E=l[2].autoplay,d(w,"class","flex items-center justify-between mr-6 svelte-1elvih2"),d(S,"class","font-bold"),d(S,"for","wait-ms"),d(F,"class","h-[20px] w-10"),d(F,"id","wait-ms"),d(F,"type","number"),d(C,"class","flex items-center justify-between svelte-1elvih2"),d(e,"class",k=Se(`${l[5].class||""}`)+" svelte-1elvih2")},m(O,B){U(O,e,B),u(e,t),u(t,s),u(t,o),u(t,a),Je(a,l[0]),u(e,r),u(e,i),u(i,c),u(i,f),u(i,_),u(e,p),u(e,w),u(w,y),u(w,N),u(w,L),u(e,j),u(e,C),u(C,S),u(C,I),u(C,F),Je(F,l[1]),V||(P=[x(a,"input",l[6]),x(a,"input",l[3]),x(_,"input",l[7]),x(L,"input",l[8]),x(F,"input",l[9]),x(F,"input",l[4])],V=!0)},p(O,[B]){B&1&&xt(a.value)!==O[0]&&Je(a,O[0]),B&4&&b!==(b=O[2].duplicates)&&(_.checked=b),B&4&&E!==(E=O[2].autoplay)&&(L.checked=E),B&2&&xt(F.value)!==O[1]&&Je(F,O[1]),B&32&&k!==(k=Se(`${O[5].class||""}`)+" svelte-1elvih2")&&d(e,"class",k)},i:he,o:he,d(O){O&&m(e),V=!1,at(P)}}}function Da(l,e,t){let s;re(l,it,_=>t(2,s=_));let n=s.count||"",o=s.waitSeconds||"";it.subscribe(_=>{t(0,n=_.count||""),t(1,o=_.waitSeconds||"")});function a({currentTarget:{value:_}}){let b;try{b=parseInt(_),b<=0&&(b=1),be.setOptionValue("count",b)}catch{t(0,n=s.count)}}function r({currentTarget:{value:_}}){let b;try{b=parseInt(_),b<0&&(b=0),be.setOptionValue("waitSeconds",b)}catch{t(1,o=s.waitSeconds)}}function i(){n=xt(this.value),t(0,n)}const c=_=>be.setOptionValue("duplicates",_.currentTarget.checked),h=_=>be.setOptionValue("autoplay",_.currentTarget.checked);function f(){o=xt(this.value),t(1,o)}return l.$$set=_=>{t(5,e=ye(ye({},e),ke(_)))},e=ke(e),[n,o,s,a,r,e,i,c,h,f]}class La extends He{constructor(e){super(),xe(this,e,Da,ja,ze,{})}}function nl(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function al(l,e,t){const s=l.slice();return s[20]=e[t].key,s[21]=e[t].value,s}function ol(l){let e,t,s=l[21]+"",n,o,a,r,i,c,h,f;function _(){return l[13](l[20])}r=new nt({props:{icon:ns,width:20}});function b(...p){return l[14](l[20],...p)}return{c(){e=v("li"),t=v("button"),n=J(s),o=G(),a=v("button"),_e(r.$$.fragment),i=G(),this.h()},l(p){e=g(p,"LI",{class:!0});var w=A(e);t=g(w,"BUTTON",{class:!0});var y=A(t);n=Q(y,s),y.forEach(m),o=M(w),a=g(w,"BUTTON",{class:!0});var T=A(a);pe(r.$$.fragment,T),T.forEach(m),i=M(w),w.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-vja54t"),q(t,"selected",l[20]===l[0]),d(a,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),d(e,"class","flex svelte-vja54t")},m(p,w){U(p,e,w),u(e,t),u(t,n),u(e,o),u(e,a),ve(r,a,null),u(e,i),c=!0,h||(f=[x(t,"click",_),x(a,"click",b)],h=!0)},p(p,w){l=p,(!c||w&17)&&q(t,"selected",l[20]===l[0])},i(p){c||(z(r.$$.fragment,p),c=!0)},o(p){$(r.$$.fragment,p),c=!1},d(p){p&&m(e),ge(r),h=!1,at(f)}}}function rl(l){let e,t=se(l[2]),s=[];for(let n=0;n<t.length;n+=1)s[n]=il(nl(l,t,n));return{c(){e=v("ul");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=g(n,"UL",{class:!0});var o=A(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","svelte-vja54t")},m(n,o){U(n,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,o){if(o&518){t=se(n[2]);let a;for(a=0;a<t.length;a+=1){const r=nl(n,t,a);s[a]?s[a].p(r,o):(s[a]=il(r),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function il(l){let e,t,s=l[21]+"",n,o,a,r;function i(){return l[15](l[20])}return{c(){e=v("li"),t=v("button"),n=J(s),o=G(),this.h()},l(c){e=g(c,"LI",{class:!0});var h=A(e);t=g(h,"BUTTON",{class:!0});var f=A(t);n=Q(f,s),f.forEach(m),o=M(h),h.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-vja54t"),q(t,"selected",l[20]===l[1]),d(e,"class","svelte-vja54t")},m(c,h){U(c,e,h),u(e,t),u(t,n),u(e,o),a||(r=x(t,"click",i),a=!0)},p(c,h){l=c,h&4&&s!==(s=l[21]+"")&&ne(n,s),h&6&&q(t,"selected",l[20]===l[1])},d(c){c&&m(e),a=!1,r()}}}function Pa(l){let e,t,s="Play",n,o,a,r,i,c,h,f,_,b,p,w="Reset",y,T,N,L,E=l[3]?"Quit":"Play",j,C,S,D,I,F=se(l[4]),k=[];for(let O=0;O<F.length;O+=1)k[O]=ol(al(l,F,O));const V=O=>$(k[O],1,1,()=>{k[O]=null});let P=(l[0]==="chords-write"||l[0]==="chords-play")&&rl(l);return f=new La({}),N=new nt({props:{class:"mr-1",icon:l[3]?Es:ns,width:20}}),{c(){e=v("fieldset"),t=v("legend"),t.textContent=s,n=G(),o=v("div"),a=v("ul");for(let O=0;O<k.length;O+=1)k[O].c();r=G(),i=v("div"),P&&P.c(),c=G(),h=v("div"),_e(f.$$.fragment),_=G(),b=v("div"),p=v("button"),p.textContent=w,y=G(),T=v("button"),_e(N.$$.fragment),L=G(),j=J(E),this.h()},l(O){e=g(O,"FIELDSET",{class:!0});var B=A(e);t=g(B,"LEGEND",{class:!0,"data-svelte-h":!0}),Z(t)!=="svelte-1409tnk"&&(t.textContent=s),n=M(B),o=g(B,"DIV",{class:!0});var K=A(o);a=g(K,"UL",{class:!0});var H=A(a);for(let Te=0;Te<k.length;Te+=1)k[Te].l(H);H.forEach(m),r=M(K),i=g(K,"DIV",{});var ee=A(i);P&&P.l(ee),ee.forEach(m),c=M(K),h=g(K,"DIV",{class:!0});var te=A(h);pe(f.$$.fragment,te),_=M(te),b=g(te,"DIV",{});var ce=A(b);p=g(ce,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(p)!=="svelte-10rv0bu"&&(p.textContent=w),y=M(ce),T=g(ce,"BUTTON",{class:!0});var ae=A(T);pe(N.$$.fragment,ae),L=M(ae),j=Q(ae,E),ae.forEach(m),ce.forEach(m),te.forEach(m),K.forEach(m),B.forEach(m),this.h()},h(){d(t,"class","px-1 text-base"),d(a,"class","options svelte-vja54t"),d(p,"class","w-full btn hover:bg-gray-200"),d(T,"class","w-full mt-2 flex items-center justify-center btn primary"),d(h,"class","h-full flex flex-col justify-between"),d(o,"class","body pb-2 h-full svelte-vja54t"),d(e,"class",C=Se(`${l[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-vja54t")},m(O,B){U(O,e,B),u(e,t),u(e,n),u(e,o),u(o,a);for(let K=0;K<k.length;K+=1)k[K]&&k[K].m(a,null);u(o,r),u(o,i),P&&P.m(i,null),u(o,c),u(o,h),ve(f,h,null),u(h,_),u(h,b),u(b,p),u(b,y),u(b,T),ve(N,T,null),u(T,L),u(T,j),S=!0,D||(I=[x(p,"click",l[5]),x(T,"click",l[16])],D=!0)},p(O,[B]){if(B&401){F=se(O[4]);let H;for(H=0;H<F.length;H+=1){const ee=al(O,F,H);k[H]?(k[H].p(ee,B),z(k[H],1)):(k[H]=ol(ee),k[H].c(),z(k[H],1),k[H].m(a,null))}for(tt(),H=F.length;H<k.length;H+=1)V(H);st()}O[0]==="chords-write"||O[0]==="chords-play"?P?P.p(O,B):(P=rl(O),P.c(),P.m(i,null)):P&&(P.d(1),P=null);const K={};B&8&&(K.icon=O[3]?Es:ns),N.$set(K),(!S||B&8)&&E!==(E=O[3]?"Quit":"Play")&&ne(j,E),(!S||B&1024&&C!==(C=Se(`${O[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-vja54t"))&&d(e,"class",C)},i(O){if(!S){for(let B=0;B<F.length;B+=1)z(k[B]);z(f.$$.fragment,O),z(N.$$.fragment,O),S=!0}},o(O){k=k.filter(Boolean);for(let B=0;B<k.length;B+=1)$(k[B]);$(f.$$.fragment,O),$(N.$$.fragment,O),S=!1},d(O){O&&m(e),je(k,O),P&&P.d(),ge(f),ge(N),D=!1,at(I)}}}function Ba(l,e,t){let s,n,o,a,r;re(l,ds,E=>t(12,o=E)),re(l,it,E=>t(19,a=E)),re(l,pt,E=>t(3,r=E));const i=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let c=i[4].key,h="maj-m";a.count,a.waitSeconds,it.subscribe(E=>{E.count,E.waitSeconds});function f(){be.clearGame(!0)}function _(E,j){if(j==="chords-write"||j==="chords-play"||j==="chords-diatonic"){let C=[];h==="selected"?C=o.filter(S=>S.selected):h==="all"?C=o:h==="maj-m"?C=o.filter(S=>S.suffixes[0]==="maj"||S.suffixes[0]==="m"):h==="seventh"&&(C=o.filter(S=>S.suffixes[0]==="maj7"||S.suffixes[0]==="m7"||S.suffixes[0]==="7"||S.suffixes[0]==="dim7"||S.suffixes[0]==="aug7")),be.play(j,{chords:C})}else be.play(j,void 0);E.currentTarget instanceof HTMLElement&&E.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function b(E){t(0,c=E)}function p(E,j){t(0,c=j),_(E,j)}function w(E){t(1,h=E)}const y=E=>b(E),T=(E,j)=>p(j,E),N=E=>w(E),L=E=>_(E,c);return l.$$set=E=>{t(10,e=ye(ye({},e),ke(E)))},l.$$.update=()=>{l.$$.dirty&4096&&t(11,s=o.reduce((E,j)=>j.selected?E+1:E,0)),l.$$.dirty&2048&&t(2,n=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${s} chords`},{key:"all",value:"All"}])},e=ke(e),[c,h,n,r,i,f,_,b,p,w,e,s,o,y,T,N,L]}class Ga extends He{constructor(e){super(),xe(this,e,Ba,Pa,ze,{})}}function cl(l,e,t){const s=l.slice();return s[7]=e[t],s}function ul(l,e,t){const s=l.slice();return s[4]=e[t],s}function Ma(l){let e,t=se(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=fl(cl(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=De()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=De()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);U(n,e,o)},p(n,o){if(o&2){t=se(n[1]);let a;for(a=0;a<t.length;a+=1){const r=cl(n,t,a);s[a]?s[a].p(r,o):(s[a]=fl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Va(l){let e,t=se(l[0].scaleNotes||[]),s=[];for(let n=0;n<t.length;n+=1)s[n]=hl(ul(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=De()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=De()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);U(n,e,o)},p(n,o){if(o&1){t=se(n[0].scaleNotes||[]);let a;for(a=0;a<t.length;a+=1){const r=ul(n,t,a);s[a]?s[a].p(r,o):(s[a]=hl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function fl(l){let e,t=l[7].interval+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=A(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-my4m0t")},m(n,o){U(n,e,o),u(e,s)},p(n,o){o&2&&t!==(t=n[7].interval+"")&&ne(s,t)},d(n){n&&m(e)}}}function hl(l){let e,t=l[4].note+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=A(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-my4m0t")},m(n,o){U(n,e,o),u(e,s)},p(n,o){o&1&&t!==(t=n[4].note+"")&&ne(s,t)},d(n){n&&m(e)}}}function Ka(l){let e,t,s,n,o,a;function r(h,f){return h[0]?Va:Ma}let i=r(l),c=i(l);return{c(){e=v("div"),t=v("button"),c.c(),this.h()},l(h){e=g(h,"DIV",{class:!0,title:!0});var f=A(e);t=g(f,"BUTTON",{class:!0});var _=A(t);c.l(_),_.forEach(m),f.forEach(m),this.h()},h(){d(t,"class","intervals svelte-my4m0t"),d(e,"class",s=`${l[2].class||""} `),d(e,"title",n=l[1].map(dl).join("-"))},m(h,f){U(h,e,f),u(e,t),c.m(t,null),o||(a=x(t,"click",l[3]),o=!0)},p(h,[f]){i===(i=r(h))&&c?c.p(h,f):(c.d(1),c=i(h),c&&(c.c(),c.m(t,null))),f&4&&s!==(s=`${h[2].class||""} `)&&d(e,"class",s),f&2&&n!==(n=h[1].map(dl).join("-"))&&d(e,"title",n)},i:he,o:he,d(h){h&&m(e),c.d(),o=!1,a()}}}const dl=l=>l.interval;function Oa(l,e,t){let{scale:s,intervals:n}=e;function o(a){cs.call(this,l,a)}return l.$$set=a=>{t(2,e=ye(ye({},e),ke(a))),"scale"in a&&t(0,s=a.scale),"intervals"in a&&t(1,n=a.intervals)},e=ke(e),[s,n,e,o]}class Xl extends He{constructor(e){super(),xe(this,e,Oa,Ka,ze,{scale:0,intervals:1})}}function ml(l,e,t){const s=l.slice();return s[7]=e[t],s}function _l(l,e,t){const s=l.slice();return s[4]=e[t],s}function Ua(l){let e,t=se(l[0]),s=[];for(let n=0;n<t.length;n+=1)s[n]=pl(ml(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=De()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=De()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);U(n,e,o)},p(n,o){if(o&1){t=se(n[0]);let a;for(a=0;a<t.length;a+=1){const r=ml(n,t,a);s[a]?s[a].p(r,o):(s[a]=pl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Fa(l){let e,t=se(l[1]),s=[];for(let n=0;n<t.length;n+=1)s[n]=vl(_l(l,t,n));return{c(){for(let n=0;n<s.length;n+=1)s[n].c();e=De()},l(n){for(let o=0;o<s.length;o+=1)s[o].l(n);e=De()},m(n,o){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(n,o);U(n,e,o)},p(n,o){if(o&2){t=se(n[1]);let a;for(a=0;a<t.length;a+=1){const r=_l(n,t,a);s[a]?s[a].p(r,o):(s[a]=vl(r),s[a].c(),s[a].m(e.parentNode,e))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function pl(l){let e,t,s=l[7].roman+"",n,o,a,r=l[7].suffix+"",i,c;return{c(){e=v("span"),t=v("span"),n=J(s),o=G(),a=v("sup"),i=J(r),c=G(),this.h()},l(h){e=g(h,"SPAN",{class:!0});var f=A(e);t=g(f,"SPAN",{class:!0});var _=A(t);n=Q(_,s),_.forEach(m),o=M(f),a=g(f,"SUP",{class:!0});var b=A(a);i=Q(b,r),b.forEach(m),c=M(f),f.forEach(m),this.h()},h(){d(t,"class","block"),d(a,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),q(a,"super-text",l[7].suffix.length>2),d(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(h,f){U(h,e,f),u(e,t),u(t,n),u(e,o),u(e,a),u(a,i),u(e,c)},p(h,f){f&1&&s!==(s=h[7].roman+"")&&ne(n,s),f&1&&r!==(r=h[7].suffix+"")&&ne(i,r),f&1&&q(a,"super-text",h[7].suffix.length>2)},d(h){h&&m(e)}}}function vl(l){let e,t,s=l[4]+"",n,o;return{c(){e=v("span"),t=v("span"),n=J(s),o=G(),this.h()},l(a){e=g(a,"SPAN",{class:!0});var r=A(e);t=g(r,"SPAN",{});var i=A(t);n=Q(i,s),i.forEach(m),o=M(r),r.forEach(m),this.h()},h(){d(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(a,r){U(a,e,r),u(e,t),u(t,n),u(e,o)},p(a,r){r&2&&s!==(s=a[4]+"")&&ne(n,s)},d(a){a&&m(e)}}}function Ra(l){let e,t,s,n,o,a;function r(h,f){return h[1].length>0?Fa:Ua}let i=r(l),c=i(l);return{c(){e=v("div"),t=v("button"),c.c(),this.h()},l(h){e=g(h,"DIV",{class:!0,title:!0});var f=A(e);t=g(f,"BUTTON",{class:!0});var _=A(t);c.l(_),_.forEach(m),f.forEach(m),this.h()},h(){d(t,"class","triads flex flex-wrap svelte-1roj1mi"),d(e,"class",s=Se(`${l[2].class||""} `)+" svelte-1roj1mi"),d(e,"title",n=l[0].map(gl).join("-"))},m(h,f){U(h,e,f),u(e,t),c.m(t,null),o||(a=x(t,"click",l[3]),o=!0)},p(h,[f]){i===(i=r(h))&&c?c.p(h,f):(c.d(1),c=i(h),c&&(c.c(),c.m(t,null))),f&4&&s!==(s=Se(`${h[2].class||""} `)+" svelte-1roj1mi")&&d(e,"class",s),f&1&&n!==(n=h[0].map(gl).join("-"))&&d(e,"title",n)},i:he,o:he,d(h){h&&m(e),c.d(),o=!1,a()}}}const gl=l=>l.roman+l.suffix;function Ha(l,e,t){let{triads:s,chords:n}=e;function o(a){cs.call(this,l,a)}return l.$$set=a=>{t(2,e=ye(ye({},e),ke(a))),"triads"in a&&t(0,s=a.triads),"chords"in a&&t(1,n=a.chords)},e=ke(e),[s,n,e,o]}class Zl extends He{constructor(e){super(),xe(this,e,Ha,Ra,ze,{triads:0,chords:1})}}function bl(l,e,t){const s=l.slice();return s[25]=e[t],s}function yl(l,e,t){const s=l.slice();return s[25]=e[t],s}function kl(l){let e,t,s=l[25].raw.names[0]+"",n,o,a,r,i,c,h;function f(){return l[13](l[25])}a=new Xl({props:{scale:l[25].scale,intervals:l[25].raw.intervals}}),a.$on("click",f);function _(){return l[14](l[25])}return i=new Zl({props:{triads:l[25].triads,chords:l[25].triadChords}}),i.$on("click",_),{c(){e=v("li"),t=v("div"),n=J(s),o=G(),_e(a.$$.fragment),r=G(),_e(i.$$.fragment),c=G(),this.h()},l(b){e=g(b,"LI",{class:!0});var p=A(e);t=g(p,"DIV",{class:!0});var w=A(t);n=Q(w,s),w.forEach(m),o=M(p),pe(a.$$.fragment,p),r=M(p),pe(i.$$.fragment,p),c=M(p),p.forEach(m),this.h()},h(){d(t,"class","text-xs font-bold"),d(e,"class","svelte-4hctsl")},m(b,p){U(b,e,p),u(e,t),u(t,n),u(e,o),ve(a,e,null),u(e,r),ve(i,e,null),u(e,c),h=!0},p(b,p){l=b,(!h||p&4)&&s!==(s=l[25].raw.names[0]+"")&&ne(n,s);const w={};p&4&&(w.scale=l[25].scale),p&4&&(w.intervals=l[25].raw.intervals),a.$set(w);const y={};p&4&&(y.triads=l[25].triads),p&4&&(y.chords=l[25].triadChords),i.$set(y)},i(b){h||(z(a.$$.fragment,b),z(i.$$.fragment,b),h=!0)},o(b){$(a.$$.fragment,b),$(i.$$.fragment,b),h=!1},d(b){b&&m(e),ge(a),ge(i)}}}function wl(l){let e,t,s=l[25].raw.names[0]+"",n,o,a,r,i,c,h;function f(){return l[15](l[25])}a=new Xl({props:{scale:l[25].scale,intervals:l[25].raw.intervals}}),a.$on("click",f);function _(){return l[16](l[25])}return i=new Zl({props:{triads:l[25].triads,chords:l[25].triadChords}}),i.$on("click",_),{c(){e=v("li"),t=v("div"),n=J(s),o=G(),_e(a.$$.fragment),r=G(),_e(i.$$.fragment),c=G(),this.h()},l(b){e=g(b,"LI",{class:!0});var p=A(e);t=g(p,"DIV",{class:!0});var w=A(t);n=Q(w,s),w.forEach(m),o=M(p),pe(a.$$.fragment,p),r=M(p),pe(i.$$.fragment,p),c=M(p),p.forEach(m),this.h()},h(){d(t,"class","text-xs font-bold"),d(e,"class","svelte-4hctsl")},m(b,p){U(b,e,p),u(e,t),u(t,n),u(e,o),ve(a,e,null),u(e,r),ve(i,e,null),u(e,c),h=!0},p(b,p){l=b,(!h||p&2)&&s!==(s=l[25].raw.names[0]+"")&&ne(n,s);const w={};p&2&&(w.scale=l[25].scale),p&2&&(w.intervals=l[25].raw.intervals),a.$set(w);const y={};p&2&&(y.triads=l[25].triads),p&2&&(y.chords=l[25].triadChords),i.$set(y)},i(b){h||(z(a.$$.fragment,b),z(i.$$.fragment,b),h=!0)},o(b){$(a.$$.fragment,b),$(i.$$.fragment,b),h=!1},d(b){b&&m(e),ge(a),ge(i)}}}function xa(l){let e,t,s,n,o="Scales",a,r,i,c,h="Key",f,_,b,p,w,y,T,N,L,E,j=se(l[2]),C=[];for(let k=0;k<j.length;k+=1)C[k]=kl(yl(l,j,k));const S=k=>$(C[k],1,1,()=>{C[k]=null});let D=se(l[1]),I=[];for(let k=0;k<D.length;k+=1)I[k]=wl(bl(l,D,k));const F=k=>$(I[k],1,1,()=>{I[k]=null});return{c(){e=v("div"),t=v("fieldset"),s=v("legend"),n=v("button"),n.textContent=o,a=G(),r=v("div"),i=v("div"),c=v("label"),c.textContent=h,f=G(),_=v("input"),b=G(),p=v("ul");for(let k=0;k<C.length;k+=1)C[k].c();w=G(),y=v("ul");for(let k=0;k<I.length;k+=1)I[k].c();this.h()},l(k){e=g(k,"DIV",{class:!0});var V=A(e);t=g(V,"FIELDSET",{class:!0});var P=A(t);s=g(P,"LEGEND",{class:!0});var O=A(s);n=g(O,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-lhx60e"&&(n.textContent=o),O.forEach(m),a=M(P),r=g(P,"DIV",{class:!0});var B=A(r);i=g(B,"DIV",{class:!0});var K=A(i);c=g(K,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(c)!=="svelte-14m38zf"&&(c.textContent=h),f=M(K),_=g(K,"INPUT",{class:!0,id:!0}),K.forEach(m),b=M(B),p=g(B,"UL",{class:!0});var H=A(p);for(let te=0;te<C.length;te+=1)C[te].l(H);H.forEach(m),w=M(B),y=g(B,"UL",{class:!0});var ee=A(y);for(let te=0;te<I.length;te+=1)I[te].l(ee);ee.forEach(m),B.forEach(m),P.forEach(m),V.forEach(m),this.h()},h(){d(n,"class","px-1 rounded hover:bg-gray-100"),d(s,"class","text-base"),d(c,"class","mr-4 font-bold"),d(c,"for","scale-key"),d(_,"class","bg-gray-100 w-16 px-1 rounded"),d(_,"id","scale-key"),_.value=l[0],d(i,"class","flex w-1/2 mb-2 input svelte-4hctsl"),d(p,"class","list odd w-full svelte-4hctsl"),d(y,"class","list even w-full svelte-4hctsl"),d(r,"class","body svelte-4hctsl"),q(r,"hidden",l[3]),d(t,"class","flex flex-col rounded border-2 px-4 py-2 my-4 text-sm svelte-4hctsl"),q(t,"collapsed",l[3]),d(e,"class",T=Se(`${l[9].class||""}`)+" svelte-4hctsl")},m(k,V){U(k,e,V),u(e,t),u(t,s),u(s,n),u(t,a),u(t,r),u(r,i),u(i,c),u(i,f),u(i,_),u(r,b),u(r,p);for(let P=0;P<C.length;P+=1)C[P]&&C[P].m(p,null);u(r,w),u(r,y);for(let P=0;P<I.length;P+=1)I[P]&&I[P].m(y,null);N=!0,L||(E=[x(n,"click",l[5]),x(_,"input",l[6]),x(_,"focus",l[11]),x(_,"blur",l[12])],L=!0)},p(k,[V]){if((!N||V&1&&_.value!==k[0])&&(_.value=k[0]),V&388){j=se(k[2]);let P;for(P=0;P<j.length;P+=1){const O=yl(k,j,P);C[P]?(C[P].p(O,V),z(C[P],1)):(C[P]=kl(O),C[P].c(),z(C[P],1),C[P].m(p,null))}for(tt(),P=j.length;P<C.length;P+=1)S(P);st()}if(V&386){D=se(k[1]);let P;for(P=0;P<D.length;P+=1){const O=bl(k,D,P);I[P]?(I[P].p(O,V),z(I[P],1)):(I[P]=wl(O),I[P].c(),z(I[P],1),I[P].m(y,null))}for(tt(),P=D.length;P<I.length;P+=1)F(P);st()}(!N||V&8)&&q(r,"hidden",k[3]),(!N||V&8)&&q(t,"collapsed",k[3]),(!N||V&512&&T!==(T=Se(`${k[9].class||""}`)+" svelte-4hctsl"))&&d(e,"class",T)},i(k){if(!N){for(let V=0;V<j.length;V+=1)z(C[V]);for(let V=0;V<D.length;V+=1)z(I[V]);N=!0}},o(k){C=C.filter(Boolean);for(let V=0;V<C.length;V+=1)$(C[V]);I=I.filter(Boolean);for(let V=0;V<I.length;V+=1)$(I[V]);N=!1},d(k){k&&m(e),je(C,k),je(I,k),L=!1,at(E)}}}function za(l,e,t){let s,n,o,a,r,i,c;re(l,Jt,k=>t(19,o=k)),re(l,bt,k=>t(20,a=k)),re(l,vt,k=>t(21,r=k)),re(l,et,k=>t(22,i=k));let f=us().map(k=>({key:k.names[0],raw:k,scale:void 0,triads:k.triads,triadChords:[]})),_="",b=[a.key,a.scale],p;const w=ct(Ge(!0),{key:"scales-hidden"});re(l,w,k=>t(3,c=k));function y(){w.update(k=>!k)}function T({currentTarget:{value:k}}){t(0,_=`${k.charAt(0).toUpperCase()}${k.charAt(1).toLowerCase()}`),t(10,f=f.map(V=>{const P=Wt(_,V.key),O=_&&"data"in P?P.data:void 0;let B=[];return O&&(B=V.triads.map((K,H)=>`${O.scaleNotes[H].note}${!K.suffix.includes("°")&&K.minor?"m":""}${K.suffix}`)),{...V,scale:O,triadChords:B}}))}function N(k,V,P){if(k<V.length){const O=V[k++];ue.setPlayed(O),i==null||i.playChord(O.map(B=>B.midi),r.fixedVelocity),p=setTimeout(()=>N(k,V,P),P)}else ue.setPlayed([]),ue.setKeyAndScale(b[0],b[1])}function L(k){clearTimeout(p);let V,P;k.scale?(P=k.scale,b=[a.key,a.scale],ue.setKeyAndScale(k.scale.key,k.scale.scale)):P=a;const O=o[0].midi+P.scaleNotes[0].semitones;V=k.raw.intervals.map(B=>[{...P.notesMap.get(B.semitones%12),midi:O+B.semitones}]),V[0][0].semitones!==V[V.length-1][0].semitones&&V.push(V[0].map(B=>({...B,midi:B.midi+12}))),N(0,V,500)}function E(k){clearTimeout(p);const{intervals:V}=k.raw;let P,O;k.scale?(O=k.scale,b=[a.key,a.scale],ue.setKeyAndScale(k.scale.key,k.scale.scale)):O=a;const B=o[0].midi+O.scaleNotes[0].semitones;P=xl(k.triads).map((H,ee)=>as(B+O.intervals[ee].semitones,O,H.intervals)),V[V.length-1].interval_seq!==1&&P.push(P[0].map(H=>({...H,midi:H.midi+12}))),N(0,P,750)}const j=()=>fe.setKeyboardFocus(!1),C=()=>fe.setKeyboardFocus(!0),S=k=>L(k),D=k=>E(k),I=k=>L(k),F=k=>E(k);return l.$$set=k=>{t(9,e=ye(ye({},e),ke(k)))},l.$$.update=()=>{l.$$.dirty&1024&&t(2,s=f.filter((k,V)=>V<f.length/2)),l.$$.dirty&1024&&t(1,n=f.filter((k,V)=>V>=f.length/2))},e=ke(e),[_,n,s,c,w,y,T,L,E,e,f,j,C,S,D,I,F]}class qa extends He{constructor(e){super(),xe(this,e,za,xa,ze,{})}}function Cl(l,e,t){const s=l.slice();return s[14]=e[t].key,s[15]=e[t].value,s[16]=e[t].icon,s[18]=t,s}const Wa=l=>({}),El=l=>({}),$a=l=>({}),Sl=l=>({});function Al(l){let e,t,s,n,o,a,r,i,c,h;const f=l[11].header,_=Ml(f,l,l[10],El);let b=se(l[0]),p=[];for(let y=0;y<b.length;y+=1)p[y]=Tl(Cl(l,b,y));const w=y=>$(p[y],1,1,()=>{p[y]=null});return{c(){e=v("button"),s=G(),n=v("ul"),o=v("li"),_&&_.c(),a=G();for(let y=0;y<p.length;y+=1)p[y].c();this.h()},l(y){e=g(y,"BUTTON",{class:!0,tabindex:!0}),A(e).forEach(m),s=M(y),n=g(y,"UL",{class:!0});var T=A(n);o=g(T,"LI",{});var N=A(o);_&&_.l(N),N.forEach(m),a=M(T);for(let L=0;L<p.length;L+=1)p[L].l(T);T.forEach(m),this.h()},h(){d(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),d(e,"tabindex","-1"),d(n,"class","items-list bg-white py-1.5 py-2 w-48 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl svelte-h65upg")},m(y,T){U(y,e,T),U(y,s,T),U(y,n,T),u(n,o),_&&_.m(o,null),u(n,a);for(let N=0;N<p.length;N+=1)p[N]&&p[N].m(n,null);i=!0,c||(h=x(e,"click",l[6]),c=!0)},p(y,T){if(l=y,_&&_.p&&(!i||T&1024)&&Vl(_,f,l,l[10],i?Ol(f,l[10],T,Wa):Kl(l[10]),El),T&133){b=se(l[0]);let N;for(N=0;N<b.length;N+=1){const L=Cl(l,b,N);p[N]?(p[N].p(L,T),z(p[N],1)):(p[N]=Tl(L),p[N].c(),z(p[N],1),p[N].m(n,null))}for(tt(),N=b.length;N<p.length;N+=1)w(N);st()}},i(y){if(!i){y&&bs(()=>{i&&(t||(t=Ft(e,ys,{duration:Ht},!0)),t.run(1))}),z(_,y);for(let T=0;T<b.length;T+=1)z(p[T]);y&&bs(()=>{i&&(r||(r=Ft(n,ks,{duration:Ht},!0)),r.run(1))}),i=!0}},o(y){y&&(t||(t=Ft(e,ys,{duration:Ht},!1)),t.run(0)),$(_,y),p=p.filter(Boolean);for(let T=0;T<p.length;T+=1)$(p[T]);y&&(r||(r=Ft(n,ks,{duration:Ht},!1)),r.run(0)),i=!1},d(y){y&&(m(e),m(s),m(n)),y&&t&&t.end(),_&&_.d(y),je(p,y),y&&r&&r.end(),c=!1,h()}}}function Ja(l){let e;return{c(){e=v("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),A(e).forEach(m),this.h()},h(){d(e,"class","w-[24px]")},m(t,s){U(t,e,s)},p:he,i:he,o:he,d(t){t&&m(e)}}}function Qa(l){let e,t;return e=new nt({props:{class:"mr-2",icon:l[16],width:16}}),{c(){_e(e.$$.fragment)},l(s){pe(e.$$.fragment,s)},m(s,n){ve(e,s,n),t=!0},p(s,n){const o={};n&1&&(o.icon=s[16]),e.$set(o)},i(s){t||(z(e.$$.fragment,s),t=!0)},o(s){$(e.$$.fragment,s),t=!1},d(s){ge(e,s)}}}function Tl(l){let e,t,s,n,o,a,r=l[15]+"",i,c,h,f,_;const b=[Qa,Ja],p=[];function w(T,N){return T[16]?0:1}s=w(l),n=p[s]=b[s](l);function y(){return l[12](l[14])}return{c(){e=v("li"),t=v("button"),n.c(),o=G(),a=v("div"),i=J(r),c=G(),this.h()},l(T){e=g(T,"LI",{});var N=A(e);t=g(N,"BUTTON",{class:!0});var L=A(t);n.l(L),o=M(L),a=g(L,"DIV",{});var E=A(a);i=Q(E,r),E.forEach(m),L.forEach(m),c=M(N),N.forEach(m),this.h()},h(){d(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),q(t,"selected",l[14]===l[2])},m(T,N){U(T,e,N),u(e,t),p[s].m(t,null),u(t,o),u(t,a),u(a,i),u(e,c),h=!0,f||(_=x(t,"click",y),f=!0)},p(T,N){l=T;let L=s;s=w(l),s===L?p[s].p(l,N):(tt(),$(p[L],1,1,()=>{p[L]=null}),st(),n=p[s],n?n.p(l,N):(n=p[s]=b[s](l),n.c()),z(n,1),n.m(t,o)),(!h||N&1)&&r!==(r=l[15]+"")&&ne(i,r),(!h||N&5)&&q(t,"selected",l[14]===l[2])},i(T){h||(z(n),h=!0)},o(T){$(n),h=!1},d(T){T&&m(e),p[s].d(),f=!1,_()}}}function Ya(l){let e,t,s,n,o,a,r,i;const c=l[11].value,h=Ml(c,l,l[10],Sl);let f=l[5]&&Al(l);return{c(){e=v("div"),t=v("button"),h&&h.c(),o=G(),f&&f.c(),this.h()},l(_){e=g(_,"DIV",{class:!0,id:!0});var b=A(e);t=g(b,"BUTTON",{class:!0,title:!0});var p=A(t);h&&h.l(p),p.forEach(m),o=M(b),f&&f.l(b),b.forEach(m),this.h()},h(){d(t,"class",s=Se(`${l[8].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),d(t,"title",n=l[8].title||""),q(t,"disabled",l[3]),q(t,"open",l[5]),d(e,"class","relative"),d(e,"id",l[1])},m(_,b){U(_,e,b),u(e,t),h&&h.m(t,null),u(e,o),f&&f.m(e,null),l[13](e),a=!0,r||(i=x(t,"click",l[6]),r=!0)},p(_,[b]){h&&h.p&&(!a||b&1024)&&Vl(h,c,_,_[10],a?Ol(c,_[10],b,$a):Kl(_[10]),Sl),(!a||b&256&&s!==(s=Se(`${_[8].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&d(t,"class",s),(!a||b&256&&n!==(n=_[8].title||""))&&d(t,"title",n),(!a||b&264)&&q(t,"disabled",_[3]),(!a||b&288)&&q(t,"open",_[5]),_[5]?f?(f.p(_,b),b&32&&z(f,1)):(f=Al(_),f.c(),z(f,1),f.m(e,null)):f&&(tt(),$(f,1,1,()=>{f=null}),st()),(!a||b&2)&&d(e,"id",_[1])},i(_){a||(z(h,_),z(f),a=!0)},o(_){$(h,_),$(f),a=!1},d(_){_&&m(e),h&&h.d(_),f&&f.d(),l[13](null),r=!1,i()}}}const Ht=400;function Xa(l,e,t){let{$$slots:s={},$$scope:n}=e,{options:o,id:a=void 0,selected:r=void 0,disabled:i=void 0,onSelect:c}=e,h,f=!1;function _(){i||t(5,f=!f)}function b(y){t(5,f=c(y))}const p=y=>b(y);function w(y){ln[y?"unshift":"push"](()=>{h=y,t(4,h)})}return l.$$set=y=>{t(8,e=ye(ye({},e),ke(y))),"options"in y&&t(0,o=y.options),"id"in y&&t(1,a=y.id),"selected"in y&&t(2,r=y.selected),"disabled"in y&&t(3,i=y.disabled),"onSelect"in y&&t(9,c=y.onSelect),"$$scope"in y&&t(10,n=y.$$scope)},e=ke(e),[o,a,r,i,h,f,_,b,e,c,n,s,p,w]}class Za extends He{constructor(e){super(),xe(this,e,Xa,Ya,ze,{options:0,id:1,selected:2,disabled:3,onSelect:9})}}function Nl(l,e,t){const s=l.slice();return s[30]=e[t],s}function Il(l,e,t){const s=l.slice();return s[33]=e[t],s}function jl(l){let e,t;return{c(){e=v("div"),t=J(l[3]),this.h()},l(s){e=g(s,"DIV",{class:!0});var n=A(e);t=Q(n,l[3]),n.forEach(m),this.h()},h(){d(e,"class","error svelte-1u7ze7x")},m(s,n){U(s,e,n),u(e,t)},p(s,n){n[0]&8&&ne(t,s[3])},d(s){s&&m(e)}}}function eo(l){let e,t;return{c(){e=v("div"),t=J(l[0]),this.h()},l(s){e=g(s,"DIV",{slot:!0});var n=A(e);t=Q(n,l[0]),n.forEach(m),this.h()},h(){d(e,"slot","value")},m(s,n){U(s,e,n),u(e,t)},p(s,n){n[0]&1&&ne(t,s[0])},d(s){s&&m(e)}}}function Dl(l){let e,t=se(l[5]),s=[];for(let n=0;n<t.length;n+=1)s[n]=Ll(Il(l,t,n));return{c(){e=v("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=g(n,"DIV",{class:!0});var o=A(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,o){U(n,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,o){if(o[0]&32){t=se(n[5]);let a;for(a=0;a<t.length;a+=1){const r=Il(n,t,a);s[a]?s[a].p(r,o):(s[a]=Ll(r),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Ll(l){let e,t=l[33].interval+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=A(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-1u7ze7x")},m(n,o){U(n,e,o),u(e,s)},p(n,o){o[0]&32&&t!==(t=n[33].interval+"")&&ne(s,t)},d(n){n&&m(e)}}}function Pl(l){let e,t=se(l[8].scaleNotes),s=[];for(let n=0;n<t.length;n+=1)s[n]=Bl(Nl(l,t,n));return{c(){e=v("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=g(n,"DIV",{class:!0});var o=A(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(m),this.h()},h(){d(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,o){U(n,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null)},p(n,o){if(o[0]&256){t=se(n[8].scaleNotes);let a;for(a=0;a<t.length;a+=1){const r=Nl(n,t,a);s[a]?s[a].p(r,o):(s[a]=Bl(r),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=t.length}},d(n){n&&m(e),je(s,n)}}}function Bl(l){let e,t=l[30].note+"",s;return{c(){e=v("span"),s=J(t),this.h()},l(n){e=g(n,"SPAN",{class:!0});var o=A(e);s=Q(o,t),o.forEach(m),this.h()},h(){d(e,"class","svelte-1u7ze7x")},m(n,o){U(n,e,o),u(e,s)},p(n,o){o[0]&256&&t!==(t=n[30].note+"")&&ne(s,t)},d(n){n&&m(e)}}}function to(l){let e,t,s,n="Score",o,a,r,i,c,h,f,_="Range",b,p,w,y,T,N="—",L,E,j,C,S,D,I,F="Scale",k,V,P,O,B,K,H,ee="Key",te,ce,ae,Te,Fe,Me,me="",qe,Ue,Ne,oe;r=new nt({props:{icon:Ul,width:16}});let Ae=l[3]&&jl(l);P=new Za({props:{id:"scales",class:"p-1",options:l[10],onSelect:l[14],$$slots:{value:[eo]},$$scope:{ctx:l}}});let de=!l[7]&&Dl(l),W=!l[7]&&Pl(l);return{c(){e=v("fieldset"),t=v("legend"),s=v("button"),s.textContent=n,o=G(),a=v("button"),_e(r.$$.fragment),i=G(),c=v("div"),h=v("div"),f=v("label"),f.textContent=_,b=G(),p=v("div"),w=v("input"),y=G(),T=v("span"),T.textContent=N,L=G(),E=v("input"),j=G(),C=v("div"),Ae&&Ae.c(),S=G(),D=v("div"),I=v("label"),I.textContent=F,k=G(),V=v("div"),_e(P.$$.fragment),O=G(),de&&de.c(),B=G(),K=v("div"),H=v("label"),H.textContent=ee,te=G(),ce=v("div"),ae=v("input"),Te=G(),W&&W.c(),Fe=G(),Me=v("div"),Me.innerHTML=me,this.h()},l(le){e=g(le,"FIELDSET",{class:!0});var R=A(e);t=g(R,"LEGEND",{class:!0});var Y=A(t);s=g(Y,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-lqyol"&&(s.textContent=n),Y.forEach(m),o=M(R),a=g(R,"BUTTON",{class:!0});var ie=A(a);pe(r.$$.fragment,ie),ie.forEach(m),i=M(R),c=g(R,"DIV",{class:!0});var X=A(c);h=g(X,"DIV",{class:!0});var we=A(h);f=g(we,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(f)!=="svelte-10u0679"&&(f.textContent=_),b=M(we),p=g(we,"DIV",{class:!0});var Le=A(p);w=g(Le,"INPUT",{class:!0,id:!0}),y=M(Le),T=g(Le,"SPAN",{class:!0,"data-svelte-h":!0}),Z(T)!=="svelte-8q1xz4"&&(T.textContent=N),L=M(Le),E=g(Le,"INPUT",{class:!0,id:!0}),Le.forEach(m),j=M(we),C=g(we,"DIV",{class:!0});var lt=A(C);Ae&&Ae.l(lt),lt.forEach(m),we.forEach(m),S=M(X),D=g(X,"DIV",{class:!0});var We=A(D);I=g(We,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(I)!=="svelte-ld2d07"&&(I.textContent=F),k=M(We),V=g(We,"DIV",{class:!0});var Ve=A(V);pe(P.$$.fragment,Ve),Ve.forEach(m),O=M(We),de&&de.l(We),We.forEach(m),B=M(X),K=g(X,"DIV",{class:!0});var Ie=A(K);H=g(Ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Z(H)!=="svelte-17pcm6g"&&(H.textContent=ee),te=M(Ie),ce=g(Ie,"DIV",{class:!0});var Ce=A(ce);ae=g(Ce,"INPUT",{class:!0,id:!0}),Ce.forEach(m),Te=M(Ie),W&&W.l(Ie),Ie.forEach(m),Fe=M(X),Me=g(X,"DIV",{class:!0,"data-svelte-h":!0}),Z(Me)!=="svelte-hp3bkp"&&(Me.innerHTML=me),X.forEach(m),R.forEach(m),this.h()},h(){d(s,"class","px-1 rounded hover:bg-gray-100"),d(t,"class","px-1 text-base"),d(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),q(a,"hidden",l[6]),d(f,"class","font-bold"),d(f,"for","range_min"),d(w,"class","h-[28px] w-full"),d(w,"id","range_min"),d(T,"class","mx-2 mt-1"),d(E,"class","h-[28px] w-full"),d(E,"id","range_max"),d(p,"class","my-1 flex w-full"),d(C,"class","flex justify-between my-1"),d(h,"class","flex flex-col h-full"),d(I,"class","font-bold"),d(I,"for","scales"),d(V,"class","my-1 w-full"),d(D,"class","flex flex-col h-full"),d(H,"class","font-bold"),d(H,"for","key"),d(ae,"class","h-[28px]"),d(ae,"id","key"),d(ce,"class","my-1 flex"),d(K,"class","flex flex-col h-full"),d(Me,"class","h-full flex flex-col justify-between"),d(c,"class","options svelte-1u7ze7x"),q(c,"hidden",l[6]),d(e,"class",qe=Se(`${l[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),q(e,"collapsed",l[6])},m(le,R){U(le,e,R),u(e,t),u(t,s),u(e,o),u(e,a),ve(r,a,null),u(e,i),u(e,c),u(c,h),u(h,f),u(h,b),u(h,p),u(p,w),Je(w,l[1]),u(p,y),u(p,T),u(p,L),u(p,E),Je(E,l[2]),u(h,j),u(h,C),Ae&&Ae.m(C,null),u(c,S),u(c,D),u(D,I),u(D,k),u(D,V),ve(P,V,null),u(D,O),de&&de.m(D,null),u(c,B),u(c,K),u(K,H),u(K,te),u(K,ce),u(ce,ae),Je(ae,l[4]),u(K,Te),W&&W.m(K,null),u(c,Fe),u(c,Me),Ue=!0,Ne||(oe=[x(s,"click",l[15]),x(a,"click",l[16]),x(w,"input",l[18]),x(w,"change",l[19]),x(w,"focus",l[12]),x(w,"blur",l[20]),x(E,"input",l[21]),x(E,"change",l[22]),x(E,"focus",l[12]),x(E,"blur",l[23]),x(ae,"input",l[24]),x(ae,"input",l[13]),x(ae,"focus",l[25]),x(ae,"blur",l[26])],Ne=!0)},p(le,R){(!Ue||R[0]&64)&&q(a,"hidden",le[6]),R[0]&2&&w.value!==le[1]&&Je(w,le[1]),R[0]&4&&E.value!==le[2]&&Je(E,le[2]),le[3]?Ae?Ae.p(le,R):(Ae=jl(le),Ae.c(),Ae.m(C,null)):Ae&&(Ae.d(1),Ae=null);const Y={};R[0]&1|R[1]&32&&(Y.$$scope={dirty:R,ctx:le}),P.$set(Y),le[7]?de&&(de.d(1),de=null):de?de.p(le,R):(de=Dl(le),de.c(),de.m(D,null)),R[0]&16&&ae.value!==le[4]&&Je(ae,le[4]),le[7]?W&&(W.d(1),W=null):W?W.p(le,R):(W=Pl(le),W.c(),W.m(K,null)),(!Ue||R[0]&64)&&q(c,"hidden",le[6]),(!Ue||R[0]&131072&&qe!==(qe=Se(`${le[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&d(e,"class",qe),(!Ue||R[0]&131136)&&q(e,"collapsed",le[6])},i(le){Ue||(z(r.$$.fragment,le),z(P.$$.fragment,le),Ue=!0)},o(le){$(r.$$.fragment,le),$(P.$$.fragment,le),Ue=!1},d(le){le&&m(e),ge(r),Ae&&Ae.d(),ge(P),de&&de.d(),W&&W.d(),Ne=!1,at(oe)}}}function so(l,e,t){let s,n,o,a,r,i;re(l,Jt,K=>t(27,n=K)),re(l,gt,K=>t(28,o=K)),re(l,pt,K=>t(7,r=K)),re(l,bt,K=>t(8,i=K));let c=Qe(n[0]),h=Qe(n[1]),f="";const _=ct(Ge(!1),{key:"score-options-hidden"});re(l,_,K=>t(6,a=K));let b=o[0],p=o[1];const w=us(),y=w.map(K=>({key:K.names[0],value:K.names[0]}));Jt.subscribe(K=>{t(1,c=Qe(K[0])),t(2,h=Qe(K[1]))}),gt.subscribe(K=>{t(4,b=K[0]),t(0,p=K[1])});function T(K,H){const ee=kn(H.currentTarget.value,!0,!0);if("data"in ee){const{midi:te}=ee.data,ce=n,ae=[K==="min"?te:ce[0].midi,K==="max"?te:ce[1].midi];fe.setMidiRange(ae),t(3,f="")}else t(3,f=ee.err),K==="min"?t(1,c=Qe(n[0])):t(2,h=Qe(n[1]))}function N(){t(3,f=""),fe.setKeyboardFocus(!1)}function L({currentTarget:{value:K}}){t(4,b=`${K.charAt(0).toUpperCase()}${K.charAt(1).toLowerCase()}`),ue.setKey(b)}function E(K){var H;return t(0,p=(H=y.find(ee=>K===ee.key))==null?void 0:H.value),ue.setScale(p),!1}function j(){_.update(K=>!K)}function C(){ue.clearScore(!0),fe.setMidiRange([60,84])}function S(){c=this.value,t(1,c)}const D=K=>T("min",K),I=()=>fe.setKeyboardFocus(!0);function F(){h=this.value,t(2,h)}const k=K=>T("max",K),V=()=>fe.setKeyboardFocus(!0);function P(){b=this.value,t(4,b)}const O=()=>fe.setKeyboardFocus(!1),B=()=>fe.setKeyboardFocus(!0);return l.$$set=K=>{t(17,e=ye(ye({},e),ke(K)))},l.$$.update=()=>{var K;l.$$.dirty[0]&1&&t(5,s=((K=w.find(H=>H.names[0]===p))==null?void 0:K.intervals)||[])},e=ke(e),[p,c,h,f,b,s,a,r,i,_,y,T,N,L,E,j,C,e,S,D,I,F,k,V,P,O,B]}class lo extends He{constructor(e){super(),xe(this,e,so,to,ze,{},null,[-1,-1])}}function no(l){l[19]=l[20].default}function ao(l){return{c:he,l:he,m:he,i:he,o:he,d:he}}function oo(l){no(l);let e,t,s;var n=l[19];function o(a,r){return{props:{class:"px-4 md:px-0"}}}return n&&(e=on(n,o())),{c(){e&&_e(e.$$.fragment),t=De()},l(a){e&&pe(e.$$.fragment,a),t=De()},m(a,r){e&&ve(e,a,r),U(a,t,r),s=!0},i(a){s||(e&&z(e.$$.fragment,a),s=!0)},o(a){e&&$(e.$$.fragment,a),s=!1},d(a){a&&m(t),e&&ge(e,a)}}}function ro(l){let e;return{c(){e=J(" ")},l(t){e=Q(t," ")},m(t,s){U(t,e,s)},i:he,o:he,d(t){t&&m(e)}}}function io(l){let e,t,s,n='<a class="hover:underline" href="https://github.com/TeemuKoivisto/midi-note-trainer">MIDI Note Trainer</a>',o,a,r,i,c,h,f,_,b,p,w,y,T,N,L,E,j,C,S;r=new ba({}),c=new qa({}),f=new qn({}),p=new lo({props:{class:"mr-4"}}),y=new Ga({});let D={ctx:l,current:null,token:null,hasCatch:!1,pending:ro,then:oo,catch:ao,value:20,blocks:[,,,]};return nn(en(()=>import("./Score.551a1e9d.js"),["./Score.551a1e9d.js","./vendor_svelte.8af766b0.js","./vendor.1acf520b.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),D),E=new Ia({props:{class:"min-h-32",debounced:!!l[0]}}),E.$on("guessed-chord",l[2]),E.$on("guessed-key",l[3]),E.$on("note",l[4]),C=new aa({props:{game:l[1]}}),{c(){e=v("meta"),t=G(),s=v("h1"),s.innerHTML=n,o=G(),a=v("section"),_e(r.$$.fragment),i=G(),_e(c.$$.fragment),h=G(),_e(f.$$.fragment),_=G(),b=v("div"),_e(p.$$.fragment),w=G(),_e(y.$$.fragment),T=G(),D.block.c(),N=G(),L=v("section"),_e(E.$$.fragment),j=G(),_e(C.$$.fragment),this.h()},l(I){const F=an("svelte-1w2oado",document.head);e=g(F,"META",{name:!0,content:!0}),F.forEach(m),t=M(I),s=g(I,"H1",{class:!0,"data-svelte-h":!0}),Z(s)!=="svelte-1l8ebwf"&&(s.innerHTML=n),o=M(I),a=g(I,"SECTION",{class:!0});var k=A(a);pe(r.$$.fragment,k),i=M(k),pe(c.$$.fragment,k),h=M(k),pe(f.$$.fragment,k),_=M(k),b=g(k,"DIV",{class:!0});var V=A(b);pe(p.$$.fragment,V),w=M(V),pe(y.$$.fragment,V),V.forEach(m),k.forEach(m),T=M(I),D.block.l(I),N=M(I),L=g(I,"SECTION",{class:!0});var P=A(L);pe(E.$$.fragment,P),j=M(P),pe(C.$$.fragment,P),P.forEach(m),this.h()},h(){d(e,"name","description"),d(e,"content","App to practise music notation, scales and chords using MIDI"),d(s,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight"),d(b,"class","play svelte-1shyohv"),d(a,"class","px-4 md:px-0"),d(L,"class","mb-8 px-4 md:px-0 flex flex-col")},m(I,F){u(document.head,e),U(I,t,F),U(I,s,F),U(I,o,F),U(I,a,F),ve(r,a,null),u(a,i),ve(c,a,null),u(a,h),ve(f,a,null),u(a,_),u(a,b),ve(p,b,null),u(b,w),ve(y,b,null),U(I,T,F),D.block.m(I,D.anchor=F),D.mount=()=>N.parentNode,D.anchor=N,U(I,N,F),U(I,L,F),ve(E,L,null),u(L,j),ve(C,L,null),S=!0},p(I,[F]){l=I;const k={};F&1&&(k.debounced=!!l[0]),E.$set(k);const V={};F&2&&(V.game=l[1]),C.$set(V)},i(I){S||(z(r.$$.fragment,I),z(c.$$.fragment,I),z(f.$$.fragment,I),z(p.$$.fragment,I),z(y.$$.fragment,I),z(D.block),z(E.$$.fragment,I),z(C.$$.fragment,I),S=!0)},o(I){$(r.$$.fragment,I),$(c.$$.fragment,I),$(f.$$.fragment,I),$(p.$$.fragment,I),$(y.$$.fragment,I);for(let F=0;F<3;F+=1){const k=D.blocks[F];$(k)}$(E.$$.fragment,I),$(C.$$.fragment,I),S=!1},d(I){I&&(m(t),m(s),m(o),m(a),m(T),m(N),m(L)),m(e),ge(r),ge(c),ge(f),ge(p),ge(y),D.block.d(I),D.token=null,D=null,ge(E),ge(C)}}}function co(l,e,t){let s,n,o,a,r,i;re(l,_t,j=>t(7,s=j)),re(l,pt,j=>t(1,n=j)),re(l,it,j=>t(8,o=j)),re(l,vt,j=>t(9,a=j)),re(l,et,j=>t(10,r=j)),re(l,rs,j=>t(11,i=j));let c,h;Gl(()=>(i&&E(),window.addEventListener("keydown",f),window.addEventListener("mousedown",f),window.addEventListener("touchstart",f),()=>{window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)})),$t.subscribe(j=>{j&&j.channels[1].addListener("noteon",_)});function f(){fe.initAudio(),window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)}function _(j){if(c)return;const C=j.rawData;b(C[1],C[2])}function b(j,C){const S=n;S instanceof At&&!(S!=null&&S.ended)&&s==="waiting"?y(j):S instanceof rt&&!(S!=null&&S.ended)&&s==="waiting"?(S.addPlayedNote(j),h||(h=setTimeout(w,2e3))):S||ue.pushPlayed(j),r&&r.noteOn(j,a.fixedVelocity??C)}function p(){o.autoplay&&o.waitSeconds>0?t(0,c=setTimeout(()=>{o.autoplay&&be.nextGuess(),t(0,c=void 0)},o.waitSeconds*1e3)):o.autoplay?be.nextGuess():t(0,c=void 0)}function w(){var C;const j=n;if(j instanceof rt){const S=j.guess();ue.setPlayed(((C=j.latestGuess.guessed)==null?void 0:C.notes)||[],S,-1),be.updateState(S?"correct":"wrong"),p()}h=void 0}function y(j){const C=n;if(C instanceof At&&s==="waiting"){ue.setTarget([ue.getNote(C.current)]);const S=C.guess(j);be.updateState(S?"correct":"wrong"),ue.pushPlayed(j,S,4e3),p()}}function T(j){const C=n;if(C instanceof rt&&s==="waiting"){const S=C.guessWrittenChord(j.detail);be.updateState(S?"correct":"wrong"),p()}}function N(j){const C=n;if(C instanceof It&&s==="waiting"){const S=j.detail.replaceAll("♭","b").replaceAll("♯","#"),D=C.guess(S);be.updateState(D?"correct":"wrong"),p()}}function L(j){b(j.detail,80)}async function E(){const j=await fe.openMidi();"data"in j?j.data.name:(j.err,console.error(j.err))}return[c,n,T,N,L]}class mo extends He{constructor(e){super(),xe(this,e,co,io,ze,{})}}export{As as F,rt as G,mo as P,hn as S,At as a,be as b,pt as c,mt as d,zl as e,_t as g,et as p,bt as s,Is as t};
