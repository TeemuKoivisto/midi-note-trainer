import{_ as Ce}from"./preload-helper.a4192956.js";import{S as qe,i as We,s as Je,e as b,b as j,g as y,h as C,f as B,j as p,k as m,_ as Ie,P as Y,l as K,n as u,$ as et,y as $,t as x,J as xe,q as W,C as Fe,a0 as Xe,R as Te,T as Ae,c as Ps,a1 as fe,u as Os,o as Vs,p as js,W as rs,X as Ct,Y as as,a2 as is,a3 as Oe,B as Pe,L as Bs,G as Z,H as ee,I as _e,z as he,O as Ue,a as pe,d as ge,m as ve,r as be,v as Ee,U as Ht,w as Ve,x as oe,Q as me,a4 as ms,A as vn,a5 as Bn,a6 as cs,a7 as Gn,N as Mn}from"./vendor_svelte.0a361f11.js";import{w as ss,c as Rn,e as Un,f as Ys,g as Qs,h as zt,i as us,j as fs,k as Bt,l as Gt,m as Kn,a as Xs,n as Ts}from"./vendor.e9b0235c.js";import{a as xn}from"./modal.501042bf.js";function Zs(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l[24]=e[t].icon,l[26]=t,l}const Fn=s=>({}),el=s=>({});function tl(s){let e,t,l,n,r,o,a,i,c,d,f;const g=s[17].header,_=Ps(g,s,s[16],el);let h=fe(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=ll(Zs(s,h,k));const D=k=>W(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),l=j(),n=b("ul"),r=b("li"),_&&_.c(),o=j();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(p),l=B(k),n=y(k,"UL",{class:!0});var w=C(n);r=y(w,"LI",{});var L=C(r);_&&_.l(L),L.forEach(p),o=B(w);for(let P=0;P<v.length;P+=1)v[P].l(w);w.forEach(p),this.h()},h(){m(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),m(e,"tabindex","-1"),m(n,"class",a=Ie(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,w){K(k,e,w),K(k,l,w),K(k,n,w),u(n,r),_&&_.m(r,null),u(n,o);for(let L=0;L<v.length;L+=1)v[L]&&v[L].m(n,null);c=!0,d||(f=$(e,"click",s[11]),d=!0)},p(k,w){if(s=k,_&&_.p&&(!c||w&65536)&&Os(_,g,s,s[16],c?js(g,s[16],w,Fn):Vs(s[16]),el),w&8457){h=fe(s[0]);let L;for(L=0;L<h.length;L+=1){const P=Zs(s,h,L);v[L]?(v[L].p(P,w),x(v[L],1)):(v[L]=ll(P),v[L].c(),x(v[L],1),v[L].m(n,null))}for(xe(),L=h.length;L<v.length;L+=1)D(L);Fe()}(!c||w&4&&a!==(a=Ie(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&m(n,"class",a)},i(k){if(!c){k&&rs(()=>{c&&(t||(t=Ct(e,as,{duration:ls},!0)),t.run(1))}),x(_,k);for(let w=0;w<h.length;w+=1)x(v[w]);k&&rs(()=>{c&&(i||(i=Ct(n,is,{duration:ls},!0)),i.run(1))}),c=!0}},o(k){k&&(t||(t=Ct(e,as,{duration:ls},!1)),t.run(0)),W(_,k),v=v.filter(Boolean);for(let w=0;w<v.length;w+=1)W(v[w]);k&&(i||(i=Ct(n,is,{duration:ls},!1)),i.run(0)),c=!1},d(k){k&&(p(e),p(l),p(n)),k&&t&&t.end(),_&&_.d(k),Oe(v,k),k&&i&&i.end(),d=!1,f()}}}function sl(s){let e,t,l,n,r,o,a=s[23]+"",i,c,d,f,g;const _=[zn,Hn],h=[];function v(k,w){return k[24]?0:1}l=v(s),n=h[l]=_[l](s);function D(){return s[20](s[22])}return{c(){e=b("li"),t=b("button"),n.c(),r=j(),o=b("div"),i=Z(a),c=j(),this.h()},l(k){e=y(k,"LI",{});var w=C(e);t=y(w,"BUTTON",{class:!0});var L=C(t);n.l(L),r=B(L),o=y(L,"DIV",{});var P=C(o);i=ee(P,a),P.forEach(p),L.forEach(p),c=B(w),w.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),Y(t,"selected",s[22]===s[3])},m(k,w){K(k,e,w),u(e,t),h[l].m(t,null),u(t,r),u(t,o),u(o,i),u(e,c),d=!0,f||(g=$(t,"click",D),f=!0)},p(k,w){s=k;let L=l;l=v(s),l===L?h[l].p(s,w):(xe(),W(h[L],1,1,()=>{h[L]=null}),Fe(),n=h[l],n?n.p(s,w):(n=h[l]=_[l](s),n.c()),x(n,1),n.m(t,r)),(!d||w&1)&&a!==(a=s[23]+"")&&_e(i,a),(!d||w&9)&&Y(t,"selected",s[22]===s[3])},i(k){d||(x(n),d=!0)},o(k){W(n),d=!1},d(k){k&&p(e),h[l].d(),f=!1,g()}}}function Hn(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","w-[24px]")},m(t,l){K(t,e,l)},p:he,i:he,o:he,d(t){t&&p(e)}}}function zn(s){let e,t;return e=new Ue({props:{class:"mr-2",icon:s[24],width:16}}),{c(){pe(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,n){ve(e,l,n),t=!0},p(l,n){const r={};n&1&&(r.icon=l[24]),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){be(e,l)}}}function ll(s){let e,t,l=!s[8][s[26]]&&sl(s);return{c(){l&&l.c(),e=Pe()},l(n){l&&l.l(n),e=Pe()},m(n,r){l&&l.m(n,r),K(n,e,r),t=!0},p(n,r){n[8][n[26]]?l&&(xe(),W(l,1,1,()=>{l=null}),Fe()):l?(l.p(n,r),r&256&&x(l,1)):(l=sl(n),l.c(),x(l,1),l.m(e.parentNode,e))},i(n){t||(x(l),t=!0)},o(n){W(l),t=!1},d(n){n&&p(e),l&&l.d(n)}}}function qn(s){let e,t,l,n,r,o,a,i,c,d=s[6]&&tl(s);return{c(){e=b("div"),t=b("input"),r=j(),d&&d.c(),this.h()},l(f){e=y(f,"DIV",{class:!0,id:!0});var g=C(e);t=y(g,"INPUT",{class:!0,title:!0}),r=B(g),d&&d.l(g),g.forEach(p),this.h()},h(){m(t,"class",l=Ie(`${s[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"),m(t,"title",n=s[14].title||""),Y(t,"disabled",s[4]),Y(t,"open",s[6]),m(e,"class",o=Ie(`relative ${s[2]||""}`)+" svelte-h65upg"),m(e,"id",s[1])},m(f,g){K(f,e,g),u(e,t),et(t,s[7]),u(e,r),d&&d.m(e,null),s[21](e),a=!0,i||(c=[$(t,"input",s[18]),$(t,"click",s[9]),$(t,"focus",s[19]),$(t,"input",s[10]),$(t,"keydown",s[12])],i=!0)},p(f,[g]){(!a||g&16384&&l!==(l=Ie(`${f[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"))&&m(t,"class",l),(!a||g&16384&&n!==(n=f[14].title||""))&&m(t,"title",n),g&128&&t.value!==f[7]&&et(t,f[7]),(!a||g&16400)&&Y(t,"disabled",f[4]),(!a||g&16448)&&Y(t,"open",f[6]),f[6]?d?(d.p(f,g),g&64&&x(d,1)):(d=tl(f),d.c(),x(d,1),d.m(e,null)):d&&(xe(),W(d,1,1,()=>{d=null}),Fe()),(!a||g&4&&o!==(o=Ie(`relative ${f[2]||""}`)+" svelte-h65upg"))&&m(e,"class",o),(!a||g&2)&&m(e,"id",f[1])},i(f){a||(x(d),a=!0)},o(f){W(d),a=!1},d(f){f&&p(e),d&&d.d(),s[21](null),i=!1,Xe(c)}}}const ls=400;function Wn(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:r,id:o=void 0,containerClass:a=void 0,selected:i,disabled:c=void 0,onSelect:d}=e,f,g=!1,_=i,h=r.map(A=>!1);function v(){c||t(6,g=!g)}function D(A){t(8,h=r.map(E=>!E.value.toLowerCase().includes(A.currentTarget.value.toLowerCase())))}function k(){t(7,_=i),t(6,g=!1),t(8,h=r.map(A=>!1))}function w(A){if(A.key==="Enter"){const E=h.findIndex(T=>!T);_===i?k():E>-1&&t(6,g=d(r[E].key)),g||(t(8,h=r.map(T=>!1)),A.currentTarget instanceof HTMLElement&&A.currentTarget.blur())}else A.key==="Escape"&&(k(),A.currentTarget instanceof HTMLElement&&A.currentTarget.blur())}function L(A){t(6,g=d(A))}function P(){_=this.value,t(7,_),t(3,i)}const U=()=>t(6,g=!0),O=A=>L(A);function I(A){Bs[A?"unshift":"push"](()=>{f=A,t(5,f)})}return s.$$set=A=>{t(14,e=Te(Te({},e),Ae(A))),"options"in A&&t(0,r=A.options),"id"in A&&t(1,o=A.id),"containerClass"in A&&t(2,a=A.containerClass),"selected"in A&&t(3,i=A.selected),"disabled"in A&&t(4,c=A.disabled),"onSelect"in A&&t(15,d=A.onSelect),"$$scope"in A&&t(16,n=A.$$scope)},s.$$.update=()=>{s.$$.dirty&8&&t(7,_=i),s.$$.dirty&1&&t(8,h=r.map(A=>!1))},e=Ae(e),[r,o,a,i,c,f,g,_,h,v,D,k,w,L,e,d,n,l,P,U,O,I]}class bn extends qe{constructor(e){super(),We(this,e,Wn,qn,Je,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:15})}}const nl={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Ze(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:yn(s,e,t),flats:e,sharps:t}}function yn(s,e,t){return(s<8?nl[s]:nl[s%7])-e+t+Math.floor(s/8)*12}function kn(s){let e,t=0,l=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(l=Math.floor(s/100),e=s%100):e=s;const n=yn(e,t,l);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(l)}`,interval_seq:e,semitones:n,flats:t,sharps:l}}const Jn=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let Es=[];function wn(){return Jn.map(s=>{const e=s[3].map(kn);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function Ut(s){Es.length===0&&(Es=wn());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return Es.find(t=>t.suffixes.find(l=>l===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function $n(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const o=Math.min(l,n);l-=o,n-=o}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function os(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const r=t[n],o=s+r.semitones,a=e.scaleNotes.find(g=>g.semitones===o%12),i=r.flats>0,c=r.sharps>0,d=(i?o+1:c?o-1:o)%12,f=i?-1:c?1:0;l.push($n(a??e.notesMap.get(d),a?0:f,o))}return l}const ol=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],Yn=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],rl=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Qn(s){let e=0,t=0;for(let l=0;l<ol.length;l+=1){const n=s.find(o=>o.note.slice(0,2)===ol[l]),r=s.find(o=>o.note.slice(0,2)===Yn[l]);if(n)e+=1;else if(r)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:rl.get(e*-1)}:{flats:0,sharps:t,majorSignature:rl.get(t)}}function Xn(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function En(s){return s.map(e=>{const t=[Ze(1)];let l;return e.major?(t.push(Ze(3)),e.suffix.startsWith("+")?t.push(Ze(5,0,1)):e.suffix.startsWith("6")?t.push(Ze(6)):e.suffix.startsWith("7")?t.push(Ze(7,1)):e.suffix.startsWith("maj7")?t.push(Ze(7)):l=Ut("maj")):e.minor?(t.push(Ze(3,1)),e.suffix.startsWith("°")?t.push(Ze(5,1)):e.suffix.startsWith("6")?(t.push(Ze(6)),l=Ut("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Ze(7,1)),l=Ut("m"+e.suffix)):l=Ut("m")):e.suffix.startsWith("sus2")?t.push(Ze(2)):e.suffix.startsWith("sus4")&&t.push(Ze(4)),t.length<=2&&t.push(Ze(5)),t.length<=2&&t.push(Ze(8)),l||(l=Ut(e.suffix)),{...l,intervals:t}})}function Zn(s,e){let t=e.has(4)&&e.has(7),l=e.has(3)&&e.has(7);const n=Xn(s);let r="";return t||l||(e.has(3)&&e.has(6)?(r="°",l=!0):e.has(4)&&e.has(8)?(r="+",t=!0):e.has(3)&&e.has(10)?(l=!0,r="7"):e.has(4)&&e.has(10)?(r="7",t=!0):e.has(4)&&e.has(11)?(r="maj7",t=!0):e.has(3)&&e.has(8)?(r="6",l=!0):e.has(4)&&e.has(9)?(r="6",t=!0):e.has(2)?r="sus2":e.has(5)?r="sus4":e.has(7)?r="5":r="?"),{degree:s,roman:l?n.toLowerCase():n,suffix:r,major:t,minor:l,semitones:e}}function eo(s){const e=s.length;return s.map((t,l)=>{const n=t.semitones,r=new Set;for(let o=1;o<e;o+=1){const a=s[(l+o)%e].semitones,i=a<=n?a+12-n:a-n;r.add(i)}return Zn(t.interval_seq,r)})}const to=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let Cs=[];function _s(){return to.map(s=>{const e=s[0],t=s[1].map(kn),l=eo(t);return{names:e,intervals:t,triads:l}})}function so(s){Cs.length===0&&(Cs=_s());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return Cs.find(t=>t.names.find(l=>l.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const lo=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,no=/^[0-9]$/,at=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function ds(s){const e=s.midi+s.flats-s.sharps;return e===12?1:Math.floor((e-12)/12)}function dt(s){return`${s.note}${ds(s)}`}function al(s){const t=(s-12)%12;return{...at[t],semitones:t,midi:s}}function oo(s,e=!0,t=!1){if(e&&!lo.test(s))return{err:`Unrecognized note "${s}"`,code:400};const l=s.trim(),n=l.charAt(0).toUpperCase(),r=at.find(f=>f.note.charAt(0)===n&&f.note.length===1);if(!r)return{err:`Unable to find note ${l}`,code:500};const o=l.slice(1).split("").reduce((f,g)=>f+(g.toLowerCase()==="b"||g==="♭"?-1:g==="#"||g==="♯"?1:0),0);let a;if(no.test(l.charAt(l.length-1)))try{a=parseInt(l.charAt(l.length-1),10)}catch{}if(t&&a===void 0)return{err:`No octave provided: ${s}`,code:400};a===void 0&&(a=0);let i=(r.semitones+o)%12;i=i<0?i+12:i;const c=o<0?-o:0,d=o>0?o:0;return{data:{note:`${n}${"♭".repeat(c)}${"♯".repeat(d)}`,semitones:i,midi:12+a*12+i,flats:c,sharps:d}}}function Gs(s){const e=at.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((n,r)=>n+(r.toLowerCase()==="b"||r==="♭"?-1:r==="#"||r==="♯"?1:0),0),l=(e.semitones+t)%12;return{note:s,semitones:l<0?l+12:l,flats:t<0?-t:0,sharps:t>0?t:0}}}const ro=/^[a-gA-G][♭b#♯]?$/,Is="ABCDEFG";function ao(s,e){return e.map(t=>Is.charAt((Is.indexOf(s)+t.interval_seq-1)%Is.length))}function io(s,e,t){return t.map((l,n)=>{const r=e[n],o=(s+l.semitones)%12,a=at[o],i=a.note.charAt(0);if(i<r&&(i!=="A"||r!=="G")||i==="G"&&r==="A"){let c=1,d=at[(o+c)%12];for(;d.note.charAt(0)!==r;)c+=1,d=at[(o+c)%12];return{semitones:o,note:d.note+"♭".repeat(c),flats:c+(d.note.includes("♭")?1:0),sharps:0}}else if(i>r||i==="A"&&r==="G"){let c=1,d=o===0?at.length-1:o-c,f=at[d];for(;f.note.charAt(0)!==r;)c+=1,d=d===0?at.length-1:d-1,f=at[d];return{semitones:o,note:f.note+"♯".repeat(c),flats:0,sharps:c+(f.note.includes("♯")?1:0)}}else return{semitones:o,note:a.note,flats:a.flats,sharps:a.sharps}})}function xt(s,e){if(!ro.test(s))return{err:`Unknown key: ${s}`,code:400};const t=so(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const l=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,n=Gs(l);if(!n)return{err:`Unable to find root for note: ${l}`,code:404};const r=ao(l.charAt(0),t.intervals),o=io(n.semitones,r,t.intervals),a=new Map(at.map(i=>{const c=o.find(d=>d.semitones===i.semitones);return c?[i.semitones,c]:[i.semitones,{...i}]}));return{data:{key:l,scale:t.names[0],names:t.names,...Qn(o),intervals:t.intervals.map(i=>({...i})),triads:t.triads.map(i=>({...i})),scaleNotes:o,notesMap:a}}}const As=new Map;function co(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function uo(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(l){return{err:`Failed to store the value: ${l}`,code:400}}}function gt(s,e){const{key:t,storage:l="local",namespace:n="default"}=e,r=co(t,l),o=Ee(s);"data"in r?s.set(e.deserialize?e.deserialize(r.data):r.data):"err"in r&&(e!=null&&e.debug)&&console.info(r.err);const a=s.subscribe(c=>{const d=uo(e.serialize?e.serialize(c):c,t,l);"err"in d&&(e!=null&&e.debug)&&console.error(d.err)}),i=As.get(n);return i?i.push({key:t,storage:l,value:s,defaultValue:o,unsubscribe:a}):As.set(n,[{key:t,storage:l,value:s,defaultValue:o,unsubscribe:a}]),s}function fo(s=["default"],e){s.forEach(t=>{var l;(l=As.get(t))==null||l.forEach(n=>{if(e!=null&&e.cb)e==null||e.cb(n);else try{e!=null&&e.unsubscribe&&n.unsubscribe(),n.value.set(n.defaultValue),(n.storage==="local"?window.localStorage:window.sessionStorage).removeItem(n.key)}catch{}})})}async function ho(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const l=await t.arrayBuffer();return{data:await e.decodeAudioData(l)}}async function mo(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],l=await Promise.all(t.map(r=>ho(`${s}${r}`,e))),n=[];return l.forEach(r=>{"err"in r?console.error(`Failed to load audio: ${r.err}`):n.push(r.data)}),n}class _o{constructor(e,t,l,n){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(l),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=n,this.damp.connect(l))}on(e,t,l,n,r,o,a,i){this.noteA.buffer=e,this.noteA.playbackRate.value=l,this.biquadFilter.frequency.value=r,this.gainA.gain.value=o,this.gain.gain.value=i,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=n,this.gainB.gain.value=a,this.noteB.start(0)),this.noteA.start(0)}off(e,t,l){var n;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(l),this.noteB.stop(l),(n=this.damp)==null||n.start(0)}}class po{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,l)=>{this.bufferlists.push(t),l===8?this.damper=t:l===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(l=>{this.noteOn(l,t)})}noteOn(e,t=80){if(e<109&&e>20){const l=this.notes.get(e);l&&(l.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const n=Math.floor((e-21)/12),r=n+1,o=n*12+21,a=2**((e-69)/12)*440,i=t/127;let c=a*(2-(e-21)/50)+3*a*i;e<60&&(c=440*(3-(60-21)/50)+3*a*i);const d=1-(e%12/12+1)/12,f=Math.pow(2,(e-o)/12),g=0,_=0,h=i**1.4,v=new _o(e,this.context,this.directGain,this.damper);v.on(this.bufferlists[n],this.bufferlists[r],f,g,c,d,_,h),this.notes.set(e,v)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const go="/midi-note-trainer/",Ns=gt(Ve(!1),{key:"midi-access"}),hs=Ve(void 0),ps=gt(Ve([60,84]),{key:"midi-range",storage:"session"}),Mt=Ht(ps,s=>[al(s[0]),al(s[1])]),il=Ve(void 0),lt=Ve(void 0),nt=gt(Ve({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),Be={async openMidi(){return ss.enable().then(()=>(Ns.set(!0),ss.inputs.length>0?(hs.set(ss.inputs[0]),{data:ss.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(s=>({err:s.toString(),code:403}))},disableMidi(){Ns.set(!1),hs.set(void 0)},setMidiRange(s){ps.set(s)},setInputValue(s,e){nt.update(t=>({...t,[s]:e})),s==="useSound"&&!e?lt.set(void 0):s==="useSound"&&!Ee(lt)&&this.initAudio()},async initAudio(){let s=Ee(il);if(s||(s=new AudioContext,il.set(s)),!Ee(lt)){const e=new po(s),t=await mo(`${go}audio`,s);e.load(t),lt.set(e)}}};let rt;const At=Ve(["C","Major"]),pt=Ht(At,s=>{const e=xt(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),cl=Ve([]),wt=Ve([]);function Ss(s,e){if(s.length>0){const t=Date.now();let l=t;const n=s.filter(r=>(r.started+e>t&&(l=Math.min(l,r.started)),r.started+e>t));return!rt&&n.length>0&&(rt=setTimeout(()=>{rt=void 0,wt.update(r=>Ss(r,e))},e-(t-l)+100)),n}return s}const Se={setKey(s){At.update(e=>[s,e[1]])},setScale(s){At.update(e=>[e[0],s])},setKeyAndScale(s,e){At.set([s,e])},setTarget(s=[]){cl.set(s)},getNote(s){return{...Ee(pt).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const n={...Ee(pt).notesMap.get(s%12),midi:s},r=Date.now(),o=e===void 0?"default":e?"correct":"wrong";if(wt.update(a=>{const i=a.findIndex(c=>c.midi===s);return i>=0&&a.splice(i,1),[...a,{...n,color:o,started:r}]}),!rt&&t!==-1){const a=t??Ee(nt).keyFadeTimeout;rt=setTimeout(()=>{rt=void 0,wt.update(i=>Ss(i,a))},a)}},setPlayed(s,e,t){const l=Date.now(),n=e===void 0?"default":e?"correct":"wrong";if(wt.update(r=>[...s.map(o=>({...o,color:n,started:l}))]),!rt&&t!==-1){const r=t??Ee(nt).keyFadeTimeout;rt=setTimeout(()=>{rt=void 0,wt.update(o=>Ss(o,r))},r)}},clearPlayed(){wt.set([]),clearTimeout(rt),rt=void 0},clearScore(s=!1){s&&At.set(["C","Major"]),cl.set([]),wt.set([])}};class Ms{constructor(e,t,l){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=l;const n=[],{count:r}=l,o=t.map(i=>typeof i=="object"&&i!==null?{...i}:i);let a=l.duplicates;!l.duplicates&&r>o.length&&(console.warn(`Trying to create game with count ${r} larger than available unique values ${t.length}`),a=!0);for(let i=0;i<r;i+=1){const c=Math.floor(Math.random()*o.length);if(a)n.push(o[c]);else{const d=o.splice(c,1);d.length>0&&n.push(d[0])}}this.sampled=n,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function vo(s,e,t){let l=e<0?s.flats-e:s.flats,n=e>0?s.sharps+e:s.sharps;if(l>0&&n>0){const o=Math.min(l,n);l-=o,n-=o}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(l)}${"♯".repeat(n)}`,flats:l,sharps:n,midi:t}}function bo(s,e,t){const l=[];for(let n=0;n<t.length;n+=1){const r=t[n],o=s+r.semitones,a=e.scaleNotes.find(g=>g.semitones===o%12),i=r.flats>0,c=r.sharps>0,d=(i?o+1:c?o-1:o)%12,f=i?-1:c?1:0;l.push(vo(a??e.notesMap.get(d),a?0:f,o))}return l}const yo=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function ko(s){const t=(s-12)%12;return{...yo[t],semitones:t,midi:s}}function wo(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class mt extends Ms{constructor(e,t,l){const n=t.range[0],r=t.range[1],o=new Set(t.scale.scaleNotes.map(i=>i.semitones)),a=l.chords.flatMap(i=>{const c=[],d=i.intervals.reduce((f,g)=>g.semitones>f?g.semitones:f,0);for(let f=n;f<=r-d;f+=1)if((!l.onlyScale||o.has(f%12))&&(!i.allowed||i.allowed.has(f%12))){const g=bo(f,t.scale,i.intervals);c.push({...i,rootNote:g[0].note,chord:`${g[0].note}${i.suffixes[0]}`,notes:g})}return c});super(e,a,t),this.played=new Set,this.opts=l}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${wo(e)}${e.chord.toLowerCase()}`,notes:[]};let l=this.current.chord===t.chord;return this.current.chord.slice(-3)==="maj"&&!l&&(l=this.current.chord.slice(0,-3)===t.chord),this.addGuessed(t,l)}guess(){const e=Array.from(this.played.values()).map(n=>ko(n)).sort((n,r)=>n.midi-r.midi);this.played.clear();const t={chord:"",notes:e},l=this.current.notes.every(n=>e.find(r=>r.midi%12===n.midi%12));return this.addGuessed(t,l)}}const Eo={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class Ft extends Ms{constructor(e,t){const l=e==="keys-major"?"major":"minor";super(e,Object.keys(Eo[l]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class jt extends Ms{constructor(e,t){const l=t.range[0],n=t.range[1];super(e,Array.from(new Array(n-l+1)).map((r,o)=>l+o),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const Cn={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},ht=Ve("waiting"),_t=gt(Ve(Cn),{key:"game-options"}),It=Ve(void 0),Rs=Ve(wn().map(s=>({...s,selected:!0}))),De={play(...[s,e]){var i,c,d;let t;const l=Ee(pt),n=Ee(ps),r=Ee(_t),o={scale:l,range:n,duplicates:r.duplicates,count:r.count};let a=[l.key,l.scale];if(s==="notes")t=new jt(s,o),Se.setTarget([Se.getNote(t.current)]),(i=Ee(lt))==null||i.noteOn(t.current);else if(s==="pitches")t=new jt(s,o),Se.setTarget(),Be.setInputValue("useSound",!0),(c=Ee(lt))==null||c.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new Ft(s,o),a=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new mt(s,o,e);else if(s==="chords-diatonic"){const f=En(l.triads).map((g,_)=>({...g,allowed:new Set([l.scaleNotes[_].semitones])}));t=new mt(s,o,{chords:f})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((d=Ee(lt))==null||d.playChord(t.current.notes.map(f=>f.midi)),Se.setTarget(t.current.notes)),Se.setKeyAndScale(a[0],a[1]),Se.clearPlayed(),ht.set("waiting"),It.set(t),t},updateState(s){ht.set(s)},setOptionValue(s,e){_t.update(t=>({...t,[s]:e}))},toggleChords(s){Rs.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Ee(It);s!=null&&s.ended?ht.set("ended"):s instanceof jt?(s.type==="notes"?Se.setTarget([Se.getNote(s.current)]):Se.setTarget(),Se.clearPlayed(),(e=Ee(lt))==null||e.noteOn(s.current),De.updateState("waiting"),s.startTime()):s instanceof mt?(Se.setTarget(s.current.notes),Se.clearPlayed(),(t=Ee(lt))==null||t.playChord(s==null?void 0:s.current.notes.map(l=>l.midi)),ht.set("waiting"),s.startTime()):s instanceof Ft&&(Se.setKey(s.current),ht.set("waiting"),s.startTime())},clearGame(s=!1){const e=Ee(It);e&&Se.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&_t.set(Cn),It.set(void 0),ht.set("waiting"),Se.clearScore()}};function ul(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function fl(s,e,t){const l=s.slice();return l[40]=e[t],l}function dl(s,e,t){const l=s.slice();return l[9]=e[t],l}function hl(s,e,t){const l=s.slice();return l[35]=e[t],l[37]=t,l}function ml(s,e,t){const l=s.slice();return l[40]=e[t],l}function _l(s,e,t){const l=s.slice();return l[9]=e[t],l}function Co(s){let e,t=fe(s[35].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=pl(ml(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);K(n,e,r)},p(n,r){if(r[0]&128){t=fe(n[35].intervals);let o;for(o=0;o<t.length;o+=1){const a=ml(n,t,o);l[o]?l[o].p(a,r):(l[o]=pl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function Io(s){let e,t=fe(s[3][s[37]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=gl(_l(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);K(n,e,r)},p(n,r){if(r[0]&8){t=fe(n[3][n[37]]);let o;for(o=0;o<t.length;o+=1){const a=_l(n,t,o);l[o]?l[o].p(a,r):(l[o]=gl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function pl(s){let e,t=s[40].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){K(n,e,r),u(e,l)},p(n,r){r[0]&128&&t!==(t=n[40].interval+"")&&_e(l,t)},d(n){n&&p(e)}}}function gl(s){let e,t=s[9].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){K(n,e,r),u(e,l)},p(n,r){r[0]&8&&t!==(t=n[9].note+"")&&_e(l,t)},d(n){n&&p(e)}}}function vl(s){let e,t,l,n,r,o,a=s[35].suffixes[0]+"",i,c,d,f,g,_,h,v=s[35].name+"",D,k,w,L,P;n=new Ue({props:{icon:s[35].selected?us:fs,width:12}});function U(){return s[25](s[35])}function O(T,N){return T[3][T[37]]&&T[3][T[37]].length>0?Io:Co}let I=O(s),A=I(s);function E(){return s[26](s[35])}return{c(){e=b("li"),t=b("button"),l=b("span"),pe(n.$$.fragment),r=j(),o=b("div"),i=Z(a),c=j(),d=b("li"),A.c(),g=j(),_=b("li"),h=b("button"),D=Z(v),k=j(),this.h()},l(T){e=y(T,"LI",{});var N=C(e);t=y(N,"BUTTON",{class:!0});var S=C(t);l=y(S,"SPAN",{class:!0});var V=C(l);ge(n.$$.fragment,V),V.forEach(p),r=B(S),o=y(S,"DIV",{class:!0});var G=C(o);i=ee(G,a),G.forEach(p),S.forEach(p),N.forEach(p),c=B(T),d=y(T,"LI",{class:!0,title:!0});var R=C(d);A.l(R),R.forEach(p),g=B(T),_=y(T,"LI",{class:!0});var H=C(_);h=y(H,"BUTTON",{class:!0});var Q=C(h);D=ee(Q,v),Q.forEach(p),k=B(H),H.forEach(p),this.h()},h(){m(l,"class","px-1 py-1 rounded"),Y(l,"text-green-500",s[35].selected),Y(l,"text-gray-400",!s[35].selected),m(o,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),m(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),Y(t,"hidden",s[8]),m(d,"class","intervals svelte-1rg0xw5"),m(d,"title",f=s[35].intervals.map(wl).join("-")),m(h,"class","text-start"),m(_,"class","text-xs")},m(T,N){K(T,e,N),u(e,t),u(t,l),ve(n,l,null),u(t,r),u(t,o),u(o,i),K(T,c,N),K(T,d,N),A.m(d,null),K(T,g,N),K(T,_,N),u(_,h),u(h,D),u(_,k),w=!0,L||(P=[$(t,"click",U),$(h,"click",E)],L=!0)},p(T,N){s=T;const S={};N[0]&128&&(S.icon=s[35].selected?us:fs),n.$set(S),(!w||N[0]&128)&&Y(l,"text-green-500",s[35].selected),(!w||N[0]&128)&&Y(l,"text-gray-400",!s[35].selected),(!w||N[0]&128)&&a!==(a=s[35].suffixes[0]+"")&&_e(i,a),(!w||N[0]&256)&&Y(t,"hidden",s[8]),I===(I=O(s))&&A?A.p(s,N):(A.d(1),A=I(s),A&&(A.c(),A.m(d,null))),(!w||N[0]&128&&f!==(f=s[35].intervals.map(wl).join("-")))&&m(d,"title",f),(!w||N[0]&128)&&v!==(v=s[35].name+"")&&_e(D,v)},i(T){w||(x(n.$$.fragment,T),w=!0)},o(T){W(n.$$.fragment,T),w=!1},d(T){T&&(p(e),p(c),p(d),p(g),p(_)),be(n),A.d(),L=!1,Xe(P)}}}function To(s){let e,t=fe(s[35].intervals),l=[];for(let n=0;n<t.length;n+=1)l[n]=bl(fl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);K(n,e,r)},p(n,r){if(r[0]&64){t=fe(n[35].intervals);let o;for(o=0;o<t.length;o+=1){const a=fl(n,t,o);l[o]?l[o].p(a,r):(l[o]=bl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function Ao(s){let e,t=fe(s[4][s[37]]),l=[];for(let n=0;n<t.length;n+=1)l[n]=yl(dl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);K(n,e,r)},p(n,r){if(r[0]&16){t=fe(n[4][n[37]]);let o;for(o=0;o<t.length;o+=1){const a=dl(n,t,o);l[o]?l[o].p(a,r):(l[o]=yl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function bl(s){let e,t=s[40].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){K(n,e,r),u(e,l)},p(n,r){r[0]&64&&t!==(t=n[40].interval+"")&&_e(l,t)},d(n){n&&p(e)}}}function yl(s){let e,t=s[9].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1rg0xw5")},m(n,r){K(n,e,r),u(e,l)},p(n,r){r[0]&16&&t!==(t=n[9].note+"")&&_e(l,t)},d(n){n&&p(e)}}}function kl(s){let e,t,l,n,r,o,a=s[35].suffixes[0]+"",i,c,d,f,g,_,h,v=s[35].name+"",D,k,w,L,P;n=new Ue({props:{icon:s[35].selected?us:fs,width:12}});function U(){return s[27](s[35])}function O(T,N){return T[4][T[37]]&&T[4][T[37]].length>0?Ao:To}let I=O(s),A=I(s);function E(){return s[28](s[35])}return{c(){e=b("li"),t=b("button"),l=b("span"),pe(n.$$.fragment),r=j(),o=b("div"),i=Z(a),c=j(),d=b("li"),A.c(),g=j(),_=b("li"),h=b("button"),D=Z(v),k=j(),this.h()},l(T){e=y(T,"LI",{});var N=C(e);t=y(N,"BUTTON",{class:!0});var S=C(t);l=y(S,"SPAN",{class:!0});var V=C(l);ge(n.$$.fragment,V),V.forEach(p),r=B(S),o=y(S,"DIV",{class:!0});var G=C(o);i=ee(G,a),G.forEach(p),S.forEach(p),N.forEach(p),c=B(T),d=y(T,"LI",{class:!0,title:!0});var R=C(d);A.l(R),R.forEach(p),g=B(T),_=y(T,"LI",{class:!0});var H=C(_);h=y(H,"BUTTON",{class:!0});var Q=C(h);D=ee(Q,v),Q.forEach(p),k=B(H),H.forEach(p),this.h()},h(){m(l,"class","px-1 py-1 rounded"),Y(l,"text-green-500",s[35].selected),Y(l,"text-gray-400",!s[35].selected),m(o,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),m(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),Y(t,"hidden",s[8]),m(d,"class","intervals svelte-1rg0xw5"),m(d,"title",f=s[35].intervals.map(El).join("-")),m(h,"class","text-start"),m(_,"class","text-xs")},m(T,N){K(T,e,N),u(e,t),u(t,l),ve(n,l,null),u(t,r),u(t,o),u(o,i),K(T,c,N),K(T,d,N),A.m(d,null),K(T,g,N),K(T,_,N),u(_,h),u(h,D),u(_,k),w=!0,L||(P=[$(t,"click",U),$(h,"click",E)],L=!0)},p(T,N){s=T;const S={};N[0]&64&&(S.icon=s[35].selected?us:fs),n.$set(S),(!w||N[0]&64)&&Y(l,"text-green-500",s[35].selected),(!w||N[0]&64)&&Y(l,"text-gray-400",!s[35].selected),(!w||N[0]&64)&&a!==(a=s[35].suffixes[0]+"")&&_e(i,a),(!w||N[0]&256)&&Y(t,"hidden",s[8]),I===(I=O(s))&&A?A.p(s,N):(A.d(1),A=I(s),A&&(A.c(),A.m(d,null))),(!w||N[0]&64&&f!==(f=s[35].intervals.map(El).join("-")))&&m(d,"title",f),(!w||N[0]&64)&&v!==(v=s[35].name+"")&&_e(D,v)},i(T){w||(x(n.$$.fragment,T),w=!0)},o(T){W(n.$$.fragment,T),w=!1},d(T){T&&(p(e),p(c),p(d),p(g),p(_)),be(n),A.d(),L=!1,Xe(P)}}}function No(s){let e,t,l,n,r="Chords",o,a,i,c,d,f,g,_,h,v,D,k,w,L,P,U,O,I="Key",A,E,T,N,S="Scale",V,G,R,H,Q="Note",z,J,de,M,re,F,te,ae,Le,ie;c=new Ue({props:{icon:Rn,width:20}}),g=new Ue({props:{icon:Un,width:16}}),v=new Ue({props:{icon:s[5]?Ys:Qs,width:16}}),w=new Ue({props:{icon:zt,width:16}}),G=new bn({props:{class:"bg-gray-100 w-48",containerClass:"input w-48",selected:s[1],options:s[10],onSelect:s[14]}});let ye=fe(s[7]),X=[];for(let q=0;q<ye.length;q+=1)X[q]=vl(hl(s,ye,q));const ce=q=>W(X[q],1,1,()=>{X[q]=null});let we=fe(s[6]),ue=[];for(let q=0;q<we.length;q+=1)ue[q]=kl(ul(s,we,q));const He=q=>W(ue[q],1,1,()=>{ue[q]=null});return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,o=j(),a=b("div"),i=b("button"),pe(c.$$.fragment),d=j(),f=b("button"),pe(g.$$.fragment),_=j(),h=b("button"),pe(v.$$.fragment),D=j(),k=b("button"),pe(w.$$.fragment),L=j(),P=b("div"),U=b("div"),O=b("label"),O.textContent=I,A=j(),E=b("input"),T=j(),N=b("label"),N.textContent=S,V=j(),pe(G.$$.fragment),R=j(),H=b("label"),H.textContent=Q,z=j(),J=b("input"),de=j(),M=b("ul");for(let q=0;q<X.length;q+=1)X[q].c();re=j(),F=b("ul");for(let q=0;q<ue.length;q+=1)ue[q].c();this.h()},l(q){e=y(q,"DIV",{class:!0});var ne=C(e);t=y(ne,"FIELDSET",{class:!0});var ke=C(t);l=y(ke,"LEGEND",{class:!0});var tt=C(l);n=y(tt,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1knqzl6"&&(n.textContent=r),tt.forEach(p),o=B(ke),a=y(ke,"DIV",{class:!0});var le=C(a);i=y(le,"BUTTON",{class:!0});var je=C(i);ge(c.$$.fragment,je),je.forEach(p),d=B(le),f=y(le,"BUTTON",{class:!0});var Me=C(f);ge(g.$$.fragment,Me),Me.forEach(p),_=B(le),h=y(le,"BUTTON",{class:!0});var vt=C(h);ge(v.$$.fragment,vt),vt.forEach(p),D=B(le),k=y(le,"BUTTON",{class:!0});var Nt=C(k);ge(w.$$.fragment,Nt),Nt.forEach(p),le.forEach(p),L=B(ke),P=y(ke,"DIV",{class:!0});var ze=C(P);U=y(ze,"DIV",{class:!0});var Ke=C(U);O=y(Ke,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(O)!=="svelte-14m38zf"&&(O.textContent=I),A=B(Ke),E=y(Ke,"INPUT",{class:!0,id:!0}),T=B(Ke),N=y(Ke,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(N)!=="svelte-bxhcb0"&&(N.textContent=S),V=B(Ke),ge(G.$$.fragment,Ke),R=B(Ke),H=y(Ke,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(H)!=="svelte-dmbfli"&&(H.textContent=Q),z=B(Ke),J=y(Ke,"INPUT",{class:!0,id:!0}),Ke.forEach(p),de=B(ze),M=y(ze,"UL",{class:!0});var St=C(M);for(let $e=0;$e<X.length;$e+=1)X[$e].l(St);St.forEach(p),re=B(ze),F=y(ze,"UL",{class:!0});var st=C(F);for(let $e=0;$e<ue.length;$e+=1)ue[$e].l(st);st.forEach(p),ze.forEach(p),ke.forEach(p),ne.forEach(p),this.h()},h(){m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(i,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),Y(i,"hidden",s[8]),m(f,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),Y(f,"hidden",s[8]),m(h,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),Y(h,"hidden",s[8]),m(k,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),Y(k,"hidden",s[8]),m(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),m(O,"class","mr-4 font-bold svelte-1rg0xw5"),m(O,"for","scale-key"),m(E,"class","input bg-gray-100 w-12 px-1 rounded"),m(E,"id","scale-key"),E.value=s[0],m(N,"class","font-bold svelte-1rg0xw5"),m(N,"for","scale-key"),m(H,"class","font-bold svelte-1rg0xw5"),m(H,"for","scale-key"),m(J,"class","input bg-gray-100 w-12 px-1 rounded"),m(J,"id","scale-key"),J.value=s[2],m(U,"class","flex mb-2 options svelte-1rg0xw5"),m(M,"class","chord-list w-full svelte-1rg0xw5"),m(F,"class","chord-list w-full svelte-1rg0xw5"),m(P,"class","body svelte-1rg0xw5"),Y(P,"hidden",s[8]),m(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1rg0xw5"),Y(t,"collapsed",s[8]),m(e,"class",te=Ie(`${s[22].class||""}`)+" svelte-1rg0xw5")},m(q,ne){K(q,e,ne),u(e,t),u(t,l),u(l,n),u(t,o),u(t,a),u(a,i),ve(c,i,null),u(a,d),u(a,f),ve(g,f,null),u(a,_),u(a,h),ve(v,h,null),u(a,D),u(a,k),ve(w,k,null),u(t,L),u(t,P),u(P,U),u(U,O),u(U,A),u(U,E),u(U,T),u(U,N),u(U,V),ve(G,U,null),u(U,R),u(U,H),u(U,z),u(U,J),u(P,de),u(P,M);for(let ke=0;ke<X.length;ke+=1)X[ke]&&X[ke].m(M,null);u(P,re),u(P,F);for(let ke=0;ke<ue.length;ke+=1)ue[ke]&&ue[ke].m(F,null);ae=!0,Le||(ie=[$(n,"click",s[12]),$(i,"click",s[17]),$(f,"click",s[18]),$(h,"click",s[19]),$(k,"click",s[20]),$(E,"input",s[13]),$(J,"input",s[15])],Le=!0)},p(q,ne){(!ae||ne[0]&256)&&Y(i,"hidden",q[8]),(!ae||ne[0]&256)&&Y(f,"hidden",q[8]);const ke={};ne[0]&32&&(ke.icon=q[5]?Ys:Qs),v.$set(ke),(!ae||ne[0]&256)&&Y(h,"hidden",q[8]),(!ae||ne[0]&256)&&Y(k,"hidden",q[8]),(!ae||ne[0]&1&&E.value!==q[0])&&(E.value=q[0]);const tt={};if(ne[0]&2&&(tt.selected=q[1]),G.$set(tt),(!ae||ne[0]&4&&J.value!==q[2])&&(J.value=q[2]),ne[0]&2163080){ye=fe(q[7]);let le;for(le=0;le<ye.length;le+=1){const je=hl(q,ye,le);X[le]?(X[le].p(je,ne),x(X[le],1)):(X[le]=vl(je),X[le].c(),x(X[le],1),X[le].m(M,null))}for(xe(),le=ye.length;le<X.length;le+=1)ce(le);Fe()}if(ne[0]&2163024){we=fe(q[6]);let le;for(le=0;le<we.length;le+=1){const je=ul(q,we,le);ue[le]?(ue[le].p(je,ne),x(ue[le],1)):(ue[le]=kl(je),ue[le].c(),x(ue[le],1),ue[le].m(F,null))}for(xe(),le=we.length;le<ue.length;le+=1)He(le);Fe()}(!ae||ne[0]&256)&&Y(P,"hidden",q[8]),(!ae||ne[0]&256)&&Y(t,"collapsed",q[8]),(!ae||ne[0]&4194304&&te!==(te=Ie(`${q[22].class||""}`)+" svelte-1rg0xw5"))&&m(e,"class",te)},i(q){if(!ae){x(c.$$.fragment,q),x(g.$$.fragment,q),x(v.$$.fragment,q),x(w.$$.fragment,q),x(G.$$.fragment,q);for(let ne=0;ne<ye.length;ne+=1)x(X[ne]);for(let ne=0;ne<we.length;ne+=1)x(ue[ne]);ae=!0}},o(q){W(c.$$.fragment,q),W(g.$$.fragment,q),W(v.$$.fragment,q),W(w.$$.fragment,q),W(G.$$.fragment,q),X=X.filter(Boolean);for(let ne=0;ne<X.length;ne+=1)W(X[ne]);ue=ue.filter(Boolean);for(let ne=0;ne<ue.length;ne+=1)W(ue[ne]);ae=!1},d(q){q&&p(e),be(c),be(g),be(v),be(w),be(G),Oe(X,q),Oe(ue,q),Le=!1,Xe(ie)}}}const wl=s=>s.interval,El=s=>s.interval;function So(s,e,t){let l,n,r,o,a,i,c,d,f;me(s,nt,M=>t(30,a=M)),me(s,lt,M=>t(31,i=M)),me(s,Mt,M=>t(32,c=M)),me(s,Rs,M=>t(24,d=M));let g="C",_="Major",h=xt(g,_),v="",D,k=[],w=[];const P=_s().map(M=>({key:M.names[0],value:M.names[0]})),U=gt(Ve(!0),{key:"chords-hidden"});me(s,U,M=>t(8,f=M));function O(){U.update(M=>!M)}function I(){const M=D&&60+D.semitones;if("err"in h||!M)t(3,k=[]),t(4,w=[]);else{const re=h.data;t(3,k=n.map(F=>os(M,re,F.intervals))),t(4,w=r.map(F=>os(M,re,F.intervals)))}}function A({currentTarget:{value:M}}){t(0,g=`${M.charAt(0).toUpperCase()}${M.charAt(1).toLowerCase()}`),h=xt(g,_),I()}function E(M){var re;return t(1,_=(re=P.find(F=>M===F.key))==null?void 0:re.value),h=xt(g,_),I(),!1}function T({currentTarget:{value:M}}){t(2,v=`${M.charAt(0).toUpperCase()}${M.charAt(1).toLowerCase()}`),t(9,D=Gs(v)),I()}function N(M){De.toggleChords(re=>re.name===M.name?!re.selected:re.selected)}function S(){const M=F=>F.suffixes[0]==="maj"||F.suffixes[0]==="m",re=d.filter(M).every(F=>F.selected);De.toggleChords(F=>M(F)?!re:F.selected)}function V(){const M=F=>F.suffixes[0]==="maj7"||F.suffixes[0]==="m7"||F.suffixes[0]==="7"||F.suffixes[0]==="dim7"||F.suffixes[0]==="aug7",re=d.filter(M).every(F=>F.selected);De.toggleChords(F=>M(F)?!re:F.selected)}function G(){De.toggleChords(M=>!o)}function R(){De.toggleChords(M=>!0)}function H(M){if("err"in h)return;const re=c[0].midi+((D==null?void 0:D.semitones)||0),F=os(re,h.data,M.intervals);i==null||i.playChord(F.map(te=>te.midi),a.fixedVelocity)}const Q=M=>N(M),z=M=>H(M),J=M=>N(M),de=M=>H(M);return s.$$set=M=>{t(22,e=Te(Te({},e),Ae(M)))},s.$$.update=()=>{s.$$.dirty[0]&16777216&&t(23,l=d),s.$$.dirty[0]&8388608&&t(7,n=l.filter((M,re)=>re<l.length/2)),s.$$.dirty[0]&8388608&&t(6,r=l.filter((M,re)=>re>=l.length/2)),s.$$.dirty[0]&8388608&&t(5,o=l.every(M=>M.selected))},e=Ae(e),[g,_,v,k,w,o,r,n,f,D,P,U,O,A,E,T,N,S,V,G,R,H,e,l,d,Q,z,J,de]}class Do extends qe{constructor(e){super(),We(this,e,So,No,Je,{},null,[-1,-1])}}function Cl(s,e,t){const l=s.slice();return l[12]=e[t],l}function Lo(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){K(t,e,l)},p:he,i:he,o:he,d(t){t&&p(e)}}}function Po(s){let e,t,l="Played:",n,r=fe(s[2]),o=[];for(let a=0;a<r.length;a+=1)o[a]=Il(Cl(s,r,a));return{c(){e=b("div"),t=b("span"),t.textContent=l,n=j();for(let a=0;a<o.length;a+=1)o[a].c()},l(a){e=y(a,"DIV",{});var i=C(e);t=y(i,"SPAN",{"data-svelte-h":!0}),oe(t)!=="svelte-1g6xxhn"&&(t.textContent=l),n=B(i);for(let c=0;c<o.length;c+=1)o[c].l(i);i.forEach(p)},m(a,i){K(a,e,i),u(e,t),u(e,n);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(e,null)},p(a,i){if(i&4){r=fe(a[2]);let c;for(c=0;c<r.length;c+=1){const d=Cl(a,r,c);o[c]?o[c].p(d,i):(o[c]=Il(d),o[c].c(),o[c].m(e,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=r.length}},i:he,o:he,d(a){a&&p(e),Oe(o,a)}}}function Oo(s){let e,t,l="Result:",n,r,o,a=s[0].correct+"",i,c,d=s[0].sampled.length+"",f,g,_,h,v,D=s[0].avgTime+"",k,w;return{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),o=Z("["),i=Z(a),c=Z(" / "),f=Z(d),g=Z("]"),_=j(),h=b("span"),v=Z("avg "),k=Z(D),w=Z("s"),this.h()},l(L){e=y(L,"DIV",{class:!0});var P=C(e);t=y(P,"SPAN",{"data-svelte-h":!0}),oe(t)!=="svelte-1eqfbgx"&&(t.textContent=l),n=B(P),r=y(P,"SPAN",{class:!0});var U=C(r);o=ee(U,"["),i=ee(U,a),c=ee(U," / "),f=ee(U,d),g=ee(U,"]"),U.forEach(p),_=B(P),h=y(P,"SPAN",{});var O=C(h);v=ee(O,"avg "),k=ee(O,D),w=ee(O,"s"),O.forEach(p),P.forEach(p),this.h()},h(){m(r,"class","mx-2"),m(e,"class","flex")},m(L,P){K(L,e,P),u(e,t),u(e,n),u(e,r),u(r,o),u(r,i),u(r,c),u(r,f),u(r,g),u(e,_),u(e,h),u(h,v),u(h,k),u(h,w)},p(L,P){P&1&&a!==(a=L[0].correct+"")&&_e(i,a),P&1&&d!==(d=L[0].sampled.length+"")&&_e(f,d),P&1&&D!==(D=L[0].avgTime+"")&&_e(k,D)},i:he,o:he,d(L){L&&p(e)}}}function Vo(s){var T,N,S,V;let e,t,l="Target:",n,r,o=((T=s[0].latestGuess.target)==null?void 0:T.chord)+"",a,i,c,d=((N=s[0].latestGuess.target)==null?void 0:N.notes.map(Tl).join(" "))+"",f,g,_,h,v,D,k,w,L=((S=s[0].latestGuess.guessed)==null?void 0:S.chord)+"",P,U,O,I=((V=s[0].latestGuess.guessed)==null?void 0:V.notes.map(Al).join(" "))+"",A,E;return v=new Ue({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),a=Z(o),i=j(),c=b("span"),f=Z(d),g=j(),_=b("span"),h=b("div"),pe(v.$$.fragment),D=Z(`
        Guessed:`),k=j(),w=b("span"),P=Z(L),U=j(),O=b("span"),A=Z(I),this.h()},l(G){e=y(G,"DIV",{class:!0});var R=C(e);t=y(R,"SPAN",{"data-svelte-h":!0}),oe(t)!=="svelte-1pddpsb"&&(t.textContent=l),n=B(R),r=y(R,"SPAN",{});var H=C(r);a=ee(H,o),H.forEach(p),i=B(R),c=y(R,"SPAN",{});var Q=C(c);f=ee(Q,d),Q.forEach(p),g=B(R),_=y(R,"SPAN",{class:!0});var z=C(_);h=y(z,"DIV",{class:!0});var J=C(h);ge(v.$$.fragment,J),J.forEach(p),D=ee(z,`
        Guessed:`),z.forEach(p),k=B(R),w=y(R,"SPAN",{});var de=C(w);P=ee(de,L),de.forEach(p),U=B(R),O=y(R,"SPAN",{});var M=C(O);A=ee(M,I),M.forEach(p),R.forEach(p),this.h()},h(){m(h,"class","absolute left-[-2rem] p-1"),m(_,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(G,R){K(G,e,R),u(e,t),u(e,n),u(e,r),u(r,a),u(e,i),u(e,c),u(c,f),u(e,g),u(e,_),u(_,h),ve(v,h,null),u(_,D),u(e,k),u(e,w),u(w,P),u(e,U),u(e,O),u(O,A),E=!0},p(G,R){var Q,z,J,de;(!E||R&1)&&o!==(o=((Q=G[0].latestGuess.target)==null?void 0:Q.chord)+"")&&_e(a,o),(!E||R&1)&&d!==(d=((z=G[0].latestGuess.target)==null?void 0:z.notes.map(Tl).join(" "))+"")&&_e(f,d);const H={};R&2&&(H.icon=G[1]==="correct"?Bt:Gt),v.$set(H),(!E||R&1)&&L!==(L=((J=G[0].latestGuess.guessed)==null?void 0:J.chord)+"")&&_e(P,L),(!E||R&1)&&I!==(I=((de=G[0].latestGuess.guessed)==null?void 0:de.notes.map(Al).join(" "))+"")&&_e(A,I)},i(G){E||(x(v.$$.fragment,G),E=!0)},o(G){W(v.$$.fragment,G),E=!1},d(G){G&&p(e),be(v)}}}function jo(s){let e,t,l="Target:",n,r,o=s[0].latestGuess.target+"",a,i,c,d,f,g,_,h,v,D,k=s[0].latestGuess.guessed+"",w,L,P,U;return _=new Ue({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),a=Z(o),i=j(),c=b("span"),d=j(),f=b("span"),g=b("div"),pe(_.$$.fragment),h=Z(`
        Guessed:`),v=j(),D=b("span"),w=Z(k),L=j(),P=b("span"),this.h()},l(O){e=y(O,"DIV",{class:!0});var I=C(e);t=y(I,"SPAN",{"data-svelte-h":!0}),oe(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=B(I),r=y(I,"SPAN",{});var A=C(r);a=ee(A,o),A.forEach(p),i=B(I),c=y(I,"SPAN",{}),C(c).forEach(p),d=B(I),f=y(I,"SPAN",{class:!0});var E=C(f);g=y(E,"DIV",{class:!0});var T=C(g);ge(_.$$.fragment,T),T.forEach(p),h=ee(E,`
        Guessed:`),E.forEach(p),v=B(I),D=y(I,"SPAN",{});var N=C(D);w=ee(N,k),N.forEach(p),L=B(I),P=y(I,"SPAN",{}),C(P).forEach(p),I.forEach(p),this.h()},h(){m(g,"class","absolute left-[-2rem] p-1"),m(f,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(O,I){K(O,e,I),u(e,t),u(e,n),u(e,r),u(r,a),u(e,i),u(e,c),u(e,d),u(e,f),u(f,g),ve(_,g,null),u(f,h),u(e,v),u(e,D),u(D,w),u(e,L),u(e,P),U=!0},p(O,I){(!U||I&1)&&o!==(o=O[0].latestGuess.target+"")&&_e(a,o);const A={};I&2&&(A.icon=O[1]==="correct"?Bt:Gt),_.$set(A),(!U||I&1)&&k!==(k=O[0].latestGuess.guessed+"")&&_e(w,k)},i(O){U||(x(_.$$.fragment,O),U=!0)},o(O){W(_.$$.fragment,O),U=!1},d(O){O&&p(e),be(_)}}}function Bo(s){let e,t,l="Target:",n,r,o=s[8](s[0].latestGuess.target||0)+"",a,i,c,d,f,g,_,h,v,D,k=s[8](s[0].latestGuess.guessed||0)+"",w,L,P,U="",O;return _=new Ue({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=l,n=j(),r=b("span"),a=Z(o),i=j(),c=b("span"),d=j(),f=b("span"),g=b("div"),pe(_.$$.fragment),h=Z(`
        Guessed:`),v=j(),D=b("span"),w=Z(k),L=j(),P=b("span"),P.innerHTML=U,this.h()},l(I){e=y(I,"DIV",{class:!0});var A=C(e);t=y(A,"SPAN",{"data-svelte-h":!0}),oe(t)!=="svelte-1s5czg5"&&(t.textContent=l),n=B(A),r=y(A,"SPAN",{});var E=C(r);a=ee(E,o),E.forEach(p),i=B(A),c=y(A,"SPAN",{}),C(c).forEach(p),d=B(A),f=y(A,"SPAN",{class:!0});var T=C(f);g=y(T,"DIV",{class:!0});var N=C(g);ge(_.$$.fragment,N),N.forEach(p),h=ee(T,`
        Guessed:`),T.forEach(p),v=B(A),D=y(A,"SPAN",{});var S=C(D);w=ee(S,k),S.forEach(p),L=B(A),P=y(A,"SPAN",{"data-svelte-h":!0}),oe(P)!=="svelte-1qufua2"&&(P.innerHTML=U),A.forEach(p),this.h()},h(){m(g,"class","absolute left-[-2rem] p-1"),m(f,"class","relative"),m(e,"class","guessed svelte-1lxfpqs")},m(I,A){K(I,e,A),u(e,t),u(e,n),u(e,r),u(r,a),u(e,i),u(e,c),u(e,d),u(e,f),u(f,g),ve(_,g,null),u(f,h),u(e,v),u(e,D),u(D,w),u(e,L),u(e,P),O=!0},p(I,A){(!O||A&1)&&o!==(o=I[8](I[0].latestGuess.target||0)+"")&&_e(a,o);const E={};A&2&&(E.icon=I[1]==="correct"?Bt:Gt),_.$set(E),(!O||A&1)&&k!==(k=I[8](I[0].latestGuess.guessed||0)+"")&&_e(w,k)},i(I){O||(x(_.$$.fragment,I),O=!0)},o(I){W(_.$$.fragment,I),O=!1},d(I){I&&p(e),be(_)}}}function Il(s){let e,t=dt(s[12])+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","mx-1")},m(n,r){K(n,e,r),u(e,l)},p(n,r){r&4&&t!==(t=dt(n[12])+"")&&_e(l,t)},d(n){n&&p(e)}}}function Go(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){K(t,e,l)},p:he,d(t){t&&p(e)}}}function Mo(s){let e,t="Next",l,n,r="Autoplay",o,a;return{c(){e=b("button"),e.textContent=t,l=j(),n=b("button"),n.textContent=r,this.h()},l(i){e=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(e)!=="svelte-uy473n"&&(e.textContent=t),l=B(i),n=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1cfj1sl"&&(n.textContent=r),this.h()},h(){m(e,"class","btn primary mr-1"),m(n,"class","btn primary")},m(i,c){K(i,e,c),K(i,l,c),K(i,n,c),o||(a=[$(e,"click",s[4]),$(n,"click",s[5])],o=!0)},p:he,d(i){i&&(p(e),p(l),p(n)),o=!1,Xe(a)}}}function Ro(s){let e,t="Stop autoplay",l,n;return{c(){e=b("button"),e.textContent=t,this.h()},l(r){e=y(r,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){m(e,"class","btn primary")},m(r,o){K(r,e,o),l||(n=$(e,"click",s[10]),l=!0)},p:he,d(r){r&&p(e),l=!1,n()}}}function Uo(s){let e,t="Try Again",l,n,r="Clear",o,a;return{c(){e=b("button"),e.textContent=t,l=j(),n=b("button"),n.textContent=r,this.h()},l(i){e=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(e)!=="svelte-15zs1cu"&&(e.textContent=t),l=B(i),n=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-11mnk9v"&&(n.textContent=r),this.h()},h(){m(e,"class","btn primary mr-1"),m(n,"class","btn primary")},m(i,c){K(i,e,c),K(i,l,c),K(i,n,c),o||(a=[$(e,"click",s[6]),$(n,"click",s[7])],o=!0)},p:he,d(i){i&&(p(e),p(l),p(n)),o=!1,Xe(a)}}}function Ko(s){let e,t,l,n,r,o,a;const i=[Bo,jo,Vo,Oo,Po,Lo],c=[];function d(h,v){return h[0]instanceof jt&&(h[1]==="correct"||h[1]==="wrong")?0:h[0]instanceof Ft&&(h[1]==="correct"||h[1]==="wrong")?1:h[0]instanceof mt&&(h[1]==="correct"||h[1]==="wrong")?2:h[0]&&h[1]==="ended"?3:h[2].length>0?4:5}t=d(s),l=c[t]=i[t](s);function f(h,v){return h[0]&&h[1]==="ended"?Uo:h[0]&&h[3].autoplay?Ro:h[0]?Mo:Go}let g=f(s),_=g(s);return{c(){e=b("div"),l.c(),r=j(),o=b("div"),_.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var v=C(e);l.l(v),v.forEach(p),r=B(h),o=y(h,"DIV",{class:!0});var D=C(o);_.l(D),D.forEach(p),this.h()},h(){m(e,"class",n=Ie(`${s[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),m(o,"class","mt-2 h-8 flex items-center")},m(h,v){K(h,e,v),c[t].m(e,null),K(h,r,v),K(h,o,v),_.m(o,null),a=!0},p(h,[v]){let D=t;t=d(h),t===D?c[t].p(h,v):(xe(),W(c[D],1,1,()=>{c[D]=null}),Fe(),l=c[t],l?l.p(h,v):(l=c[t]=i[t](h),l.c()),x(l,1),l.m(e,null)),(!a||v&512&&n!==(n=Ie(`${h[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"))&&m(e,"class",n),g===(g=f(h))&&_?_.p(h,v):(_.d(1),_=g(h),_&&(_.c(),_.m(o,null)))},i(h){a||(x(l),a=!0)},o(h){W(l),a=!1},d(h){h&&(p(e),p(r),p(o)),c[t].d(),_.d()}}}const Tl=s=>s.note,Al=s=>s.note;function xo(s,e,t){let l,n,r,o;me(s,pt,h=>t(11,l=h)),me(s,ht,h=>t(1,n=h)),me(s,wt,h=>t(2,r=h)),me(s,_t,h=>t(3,o=h));let{game:a}=e;function i(){De.nextGuess()}function c(){De.setOptionValue("autoplay",!0),De.nextGuess()}function d(){a instanceof mt?De.play(a.type,a.opts):a&&De.play(a.type,void 0)}function f(){De.clearGame()}function g(h){const v=l.notesMap.get(h%12);return dt({midi:h,...v})}const _=()=>De.setOptionValue("autoplay",!1);return s.$$set=h=>{t(9,e=Te(Te({},e),Ae(h))),"game"in h&&t(0,a=h.game)},e=Ae(e),[a,n,r,o,i,c,d,f,g,e,_]}class Fo extends qe{constructor(e){super(),We(this,e,xo,Ko,Je,{game:0})}}const Ds={ar:{name:"Arabic",import:Ce(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:Ce(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:Ce(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:Ce(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:Ce(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:Ce(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:Ce(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:Ce(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:Ce(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>zo)},fa:{name:"Farsi",import:Ce(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:Ce(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:Ce(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:Ce(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:Ce(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:Ce(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:Ce(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:Ce(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:Ce(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:Ce(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:Ce(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:Ce(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:Ce(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:Ce(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:Ce(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:Ce(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:Ce(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:Ce(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:Ce(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:Ce(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:Ce(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:Ce(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:Ce(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:Ce(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function In(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default.slice(0,4)}}async function Ho(s=["en"]){let e={code:"en",layout:Ds.en,index:99};Object.entries(Ds).forEach(([l,n])=>{for(let r=0;r<s.length;r+=1)l===s[r]&&(!e||e.index>r)&&(e={code:l,layout:n,index:r})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:In(t.default)}}const Tn={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},zo=Object.freeze(Object.defineProperty({__proto__:null,default:Tn},Symbol.toStringTag,{value:"Module"})),An=[0,2,4,5,7,9,11],Nn=[1,3,-1,6,8,10,-1];function qo(s,e,t){const l=s.keyType==="white"?An:Nn,n=l[t%l.length];let r;if(n>=0){r=e[n];const o=Math.floor(t/l.length);return{...r,semitones:r.semitones+(o>0?o:0)*12}}}function Vt(s,e,t=0,l=0){const n=s.keyType==="white"?An:Nn;let r=-1,o=0,a=0;return s.keys.forEach((i,c)=>{if(i.key.charAt(0)!=="{"&&c>=t&&r===-1?r=c:r!==-1&&i.key==="{empty}"&&(o+=1),r!==-1&&i.key.charAt(0)!=="{"){const d=c-o-r+l,f=n[d%n.length];if(f>=0){const g=e[f],_=Math.floor(d/n.length);i.note={...g,semitones:g.semitones+(_>0?_:0)*12},a=c-r}}}),{firstIndex:r,lastIndex:a}}const Sn=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function Wo(s,e){let t=[];const l=s.default.map((o,a)=>{if(a===0){const i=o.split(" ").filter(c=>c!=="{bksp}");for(;i.length!==13;)i.length<13?i.unshift("{empty}"):i.shift();return[...i,"{bksp}"]}else if(a===1){const i=o.split(" ");return t=i.slice(13),[...i.slice(0,13),"{enter}"]}else{if(a===2)return[...o.split(" ").slice(0,13).filter(i=>i!=="{enter}"),...t].slice(0,13);if(a===3){const i=["{shift}",...o.split(" ").slice(1,12).filter(d=>d!=="{shift}"),"{shift}"];let c=1;for(;i.length<13;)i.splice(c,0,"{empty}"),c=c===1?-1:1;return i}else return o.split(" ")}});let n;s.codes?n=s.codes.map(o=>o.split(" ")):n=Sn;const r=[0,1,2,3].map(o=>l[o].map((a,i)=>({key:a,code:n[o][i]})));return[{keyType:e==="two-rows"?"black":null,startNoteOffset:2,availableNotes:11,keys:r[0]},{keyType:e==="two-rows"?"white":"black",startNoteOffset:e==="two-rows"?1:2,availableNotes:12,keys:r[1]},{keyType:e==="two-rows"?"black":"white",startNoteOffset:1,availableNotes:12,keys:r[2]},{keyType:e==="two-rows"?"white":null,startNoteOffset:1,availableNotes:11,keys:r[3]}]}const Nl=[{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]}];class Dn{constructor(e){return this.rows=Nl,this.setCustomRow={row:Nl[0],rowIndex:0,nextKeyIdx:-1,nextNoteOffset:0},this.opts={hotkeydRows:"middle-row",isCustom:!1,layout:{code:"en",name:"English",imported:In(Tn)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=Wo(e,this.opts.hotkeydRows),this}setRows(e){return this.rows=e,this}setNotes(e){if(this.opts.hotkeydRows==="middle-row"){const{firstIndex:t}=Vt(this.rows[2],e);Vt(this.rows[1],e,1+t)}else{const{firstIndex:t,lastIndex:l}=Vt(this.rows[3],e);Vt(this.rows[2],e,t);const{firstIndex:n}=Vt(this.rows[1],e,0,l+1);Vt(this.rows[0],e,1+n,l+1)}}startSetCustomRow(e){const t={...this.rows[e],keys:this.rows[e].keys.map(a=>({...a}))},{availableNotes:l,startNoteOffset:n}=t,r=this.opts.hotkeydRows==="two-rows"&&(e===0||e===1)?3:-1,o=r!==-1?this.rows[r].keys.reduce((a,i)=>(a===-1&&i.note?a=0:a!==-1&&(i.key[0]!=="{"||i.key==="{empty}")&&(a+=1),a),-1)+1:0;return this.setCustomRow={row:t,rowIndex:e,nextKeyIdx:n,nextNoteOffset:o},{first:n,count:l}}setNextCustomNote(e,t,l){let n;const{nextKeyIdx:r,nextNoteOffset:o,row:a}=this.setCustomRow,i=r+o-a.startNoteOffset,c=qo(a,l,i);return c?n={key:e,code:t,note:c}:n={key:e,code:t},this.setCustomRow.nextKeyIdx+=1,{index:this.setCustomRow.nextKeyIdx,key:n}}skipNextCustomNote(){return this.setCustomRow.nextKeyIdx+=1,this.setCustomRow.nextNoteOffset-=1,{index:this.setCustomRow.nextKeyIdx,key:{code:"EMPTY",key:"{empty}"}}}}function Jo(s){const e=[...s.map(n=>n.keys.map(r=>r.key).join(" "))],t=["","","",""];let l=!1;return s.forEach((n,r)=>{const o=[];for(let a=0;a<n.keys.length;a+=1)o.push(n.keys[a].code),l=l||n.keys[a].code!==Sn[r][a];t[r]=o.join(" ")}),l?{default:e,codes:t}:{default:e}}function Sl(s,e,t){const l=s.slice();return l[15]=e[t].key,l[16]=e[t].value,l[17]=e[t].icon,l[19]=t,l}const $o=s=>({}),Dl=s=>({}),Yo=s=>({}),Ll=s=>({});function Pl(s){let e,t,l,n,r,o,a,i,c,d,f;const g=s[12].header,_=Ps(g,s,s[11],Dl);let h=fe(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=Ol(Sl(s,h,k));const D=k=>W(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),l=j(),n=b("ul"),r=b("li"),_&&_.c(),o=j();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(p),l=B(k),n=y(k,"UL",{class:!0});var w=C(n);r=y(w,"LI",{});var L=C(r);_&&_.l(L),L.forEach(p),o=B(w);for(let P=0;P<v.length;P+=1)v[P].l(w);w.forEach(p),this.h()},h(){m(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),m(e,"tabindex","-1"),m(n,"class",a=Ie(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,w){K(k,e,w),K(k,l,w),K(k,n,w),u(n,r),_&&_.m(r,null),u(n,o);for(let L=0;L<v.length;L+=1)v[L]&&v[L].m(n,null);c=!0,d||(f=$(e,"click",s[7]),d=!0)},p(k,w){if(s=k,_&&_.p&&(!c||w&2048)&&Os(_,g,s,s[11],c?js(g,s[11],w,$o):Vs(s[11]),Dl),w&265){h=fe(s[0]);let L;for(L=0;L<h.length;L+=1){const P=Sl(s,h,L);v[L]?(v[L].p(P,w),x(v[L],1)):(v[L]=Ol(P),v[L].c(),x(v[L],1),v[L].m(n,null))}for(xe(),L=h.length;L<v.length;L+=1)D(L);Fe()}(!c||w&4&&a!==(a=Ie(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&m(n,"class",a)},i(k){if(!c){k&&rs(()=>{c&&(t||(t=Ct(e,as,{duration:ns},!0)),t.run(1))}),x(_,k);for(let w=0;w<h.length;w+=1)x(v[w]);k&&rs(()=>{c&&(i||(i=Ct(n,is,{duration:ns},!0)),i.run(1))}),c=!0}},o(k){k&&(t||(t=Ct(e,as,{duration:ns},!1)),t.run(0)),W(_,k),v=v.filter(Boolean);for(let w=0;w<v.length;w+=1)W(v[w]);k&&(i||(i=Ct(n,is,{duration:ns},!1)),i.run(0)),c=!1},d(k){k&&(p(e),p(l),p(n)),k&&t&&t.end(),_&&_.d(k),Oe(v,k),k&&i&&i.end(),d=!1,f()}}}function Qo(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","w-[24px]")},m(t,l){K(t,e,l)},p:he,i:he,o:he,d(t){t&&p(e)}}}function Xo(s){let e,t;return e=new Ue({props:{class:"mr-2",icon:s[17],width:16}}),{c(){pe(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,n){ve(e,l,n),t=!0},p(l,n){const r={};n&1&&(r.icon=l[17]),e.$set(r)},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){be(e,l)}}}function Ol(s){let e,t,l,n,r,o,a=s[16]+"",i,c,d,f,g;const _=[Xo,Qo],h=[];function v(k,w){return k[17]?0:1}l=v(s),n=h[l]=_[l](s);function D(){return s[13](s[15])}return{c(){e=b("li"),t=b("button"),n.c(),r=j(),o=b("div"),i=Z(a),c=j(),this.h()},l(k){e=y(k,"LI",{});var w=C(e);t=y(w,"BUTTON",{class:!0});var L=C(t);n.l(L),r=B(L),o=y(L,"DIV",{});var P=C(o);i=ee(P,a),P.forEach(p),L.forEach(p),c=B(w),w.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),Y(t,"selected",s[15]===s[3])},m(k,w){K(k,e,w),u(e,t),h[l].m(t,null),u(t,r),u(t,o),u(o,i),u(e,c),d=!0,f||(g=$(t,"click",D),f=!0)},p(k,w){s=k;let L=l;l=v(s),l===L?h[l].p(s,w):(xe(),W(h[L],1,1,()=>{h[L]=null}),Fe(),n=h[l],n?n.p(s,w):(n=h[l]=_[l](s),n.c()),x(n,1),n.m(t,r)),(!d||w&1)&&a!==(a=s[16]+"")&&_e(i,a),(!d||w&9)&&Y(t,"selected",s[15]===s[3])},i(k){d||(x(n),d=!0)},o(k){W(n),d=!1},d(k){k&&p(e),h[l].d(),f=!1,g()}}}function Zo(s){let e,t,l,n,r,o,a,i,c;const d=s[12].value,f=Ps(d,s,s[11],Ll);let g=s[6]&&Pl(s);return{c(){e=b("div"),t=b("button"),f&&f.c(),r=j(),g&&g.c(),this.h()},l(_){e=y(_,"DIV",{class:!0,id:!0});var h=C(e);t=y(h,"BUTTON",{class:!0,title:!0});var v=C(t);f&&f.l(v),v.forEach(p),r=B(h),g&&g.l(h),h.forEach(p),this.h()},h(){m(t,"class",l=Ie(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),m(t,"title",n=s[9].title||""),Y(t,"disabled",s[4]),Y(t,"open",s[6]),m(e,"class",o=Ie(`relative ${s[2]||""}`)+" svelte-h65upg"),m(e,"id",s[1])},m(_,h){K(_,e,h),u(e,t),f&&f.m(t,null),u(e,r),g&&g.m(e,null),s[14](e),a=!0,i||(c=$(t,"click",s[7]),i=!0)},p(_,[h]){f&&f.p&&(!a||h&2048)&&Os(f,d,_,_[11],a?js(d,_[11],h,Yo):Vs(_[11]),Ll),(!a||h&512&&l!==(l=Ie(`${_[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&m(t,"class",l),(!a||h&512&&n!==(n=_[9].title||""))&&m(t,"title",n),(!a||h&528)&&Y(t,"disabled",_[4]),(!a||h&576)&&Y(t,"open",_[6]),_[6]?g?(g.p(_,h),h&64&&x(g,1)):(g=Pl(_),g.c(),x(g,1),g.m(e,null)):g&&(xe(),W(g,1,1,()=>{g=null}),Fe()),(!a||h&4&&o!==(o=Ie(`relative ${_[2]||""}`)+" svelte-h65upg"))&&m(e,"class",o),(!a||h&2)&&m(e,"id",_[1])},i(_){a||(x(f,_),x(g),a=!0)},o(_){W(f,_),W(g),a=!1},d(_){_&&p(e),f&&f.d(_),g&&g.d(),s[14](null),i=!1,c()}}}const ns=400;function er(s,e,t){let{$$slots:l={},$$scope:n}=e,{options:r,id:o=void 0,containerClass:a=void 0,selected:i=void 0,disabled:c=void 0,onSelect:d}=e,f,g=!1;function _(){c||t(6,g=!g)}function h(k){t(6,g=d(k))}const v=k=>h(k);function D(k){Bs[k?"unshift":"push"](()=>{f=k,t(5,f)})}return s.$$set=k=>{t(9,e=Te(Te({},e),Ae(k))),"options"in k&&t(0,r=k.options),"id"in k&&t(1,o=k.id),"containerClass"in k&&t(2,a=k.containerClass),"selected"in k&&t(3,i=k.selected),"disabled"in k&&t(4,c=k.disabled),"onSelect"in k&&t(10,d=k.onSelect),"$$scope"in k&&t(11,n=k.$$scope)},e=Ae(e),[r,o,a,i,c,f,g,_,h,e,d,n,l,v,D]}class tr extends qe{constructor(e){super(),We(this,e,er,Zo,Je,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function sr(s){let e,t,l,n,r,o,a;return{c(){e=b("label"),t=b("input"),l=j(),n=b("div"),this.h()},l(i){e=y(i,"LABEL",{class:!0});var c=C(e);t=y(c,"INPUT",{type:!0,class:!0}),l=B(c),n=y(c,"DIV",{class:!0}),C(n).forEach(p),c.forEach(p),this.h()},h(){t.checked=s[0],m(t,"type","checkbox"),m(t,"class","svelte-k5zciy"),m(n,"class","slider svelte-k5zciy"),m(e,"class",r=Ie(`${s[3].class||""} toggle`)+" svelte-k5zciy")},m(i,c){K(i,e,c),u(e,t),s[5](t),u(e,l),u(e,n),o||(a=[$(t,"change",s[4]),$(t,"keydown",s[2])],o=!0)},p(i,[c]){c&1&&(t.checked=i[0]),c&8&&r!==(r=Ie(`${i[3].class||""} toggle`)+" svelte-k5zciy")&&m(e,"class",r)},i:he,o:he,d(i){i&&p(e),s[5](null),o=!1,Xe(a)}}}function lr(s,e,t){let{checked:l}=e,n;function r(i){i.key==="Enter"&&n.click()}function o(i){ms.call(this,s,i)}function a(i){Bs[i?"unshift":"push"](()=>{n=i,t(1,n)})}return s.$$set=i=>{t(3,e=Te(Te({},e),Ae(i))),"checked"in i&&t(0,l=i.checked)},e=Ae(e),[l,n,r,e,o,a]}class nr extends qe{constructor(e){super(),We(this,e,lr,sr,Je,{checked:0})}}function or(s,e,t){return e==="Escape"?{e:"hotkeys-cancel"}:e==="Space"?{e:"hotkeys-skip-key"}:s.has(e)?{e:"hotkeys-no-key"}:(s.add(e),{e:"hotkeys-captured-key",data:{code:e,key:t}})}const Us=/^[a-gA-G]$/,Ln=/^[♭Bb#♯sS]$/,rr=/^[0-9]$/;let se="",Qe;function ar(s,e){const{useHotkeys:t}=Ee(nt),l=Ee(On).get(s);if(t&&se.length===0&&l&&l.note)return se="",{e:"guessed-key",data:l.note.note};if(!t&&se.length===0&&Us.test(e))return se+=e.toUpperCase(),{e:"string",data:se};if(!t&&se.length>0&&Ln.test(e))return e==="b"||e==="B"?se+="♭":se+="♯",{e:"string",data:se};if(s==="Backspace"&&se.length>0)return se=se.slice(0,-1),{e:"string",data:se};if(s==="Enter"&&se.length>0){const n=se;return se="",{e:"guessed-key",data:n}}return!1}function ir(s,e){if(s==="Enter"&&se.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let l=0;l<se.length;l+=1)l===0?t.note+=se[l]:t.chord.length>0?t.chord+=se[l].toLowerCase():se[l]==="♭"?(t.note+=se[l],t.flats+=1):se[l]==="♯"?(t.note+=se[l],t.sharps+=1):t.chord+=se[l].toLowerCase();return se="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&se.length>0)return se=se.slice(0,-1),{e:"string",data:se};if(se.length===0&&Us.test(e))return se+=e.toUpperCase(),{e:"string",data:se};if(se.length>0&&e.length===1)return se.length===1&&(e==="b"||e==="B")?se+="♭":se.length===1&&e==="#"?se+="♯":se+=e,{e:"string",data:se}}return!1}function cr(s,e,t){const{useAutoOctave:l,useHotkeys:n}=Ee(nt);let r;const a=Ee(On).get(s),i=(a==null?void 0:a.key)||"";let c=!1;if(!Qe&&n&&(a!=null&&a.note)?(Qe=a.note,l&&(r=ds({midi:Ee(Mt)[0].midi,flats:0,sharps:0})),c="note"):!n&&se.length===0&&Us.test(e)?(se+=e.toUpperCase(),c="input"):!n&&se.length>0&&Ln.test(e)?(e==="b"||e==="B"?se+="♭":se+="♯",c="input"):!n&&se.length>0&&s==="Enter"&&l&&(r=ds({midi:Ee(Mt)[0].midi,flats:0,sharps:0}),c="octave"),!c&&rr.test(i))try{r=parseInt(i),c="octave"}catch{}if(c&&(Qe||se)&&r!==void 0){const d=(Qe==null?void 0:Qe.note)??se;return t&&(r+=1),Qe&&(Qe==null?void 0:Qe.semitones)>=12&&(r+=Math.floor(Qe.semitones/12)),Qe=void 0,se="",{e:"guessed-note",data:{note:d,octave:r}}}else if(s==="Backspace"&&(Qe||se.length>0))return Qe=void 0,se=se.slice(0,-1),{e:"string",data:se};return c==="note"?{e:"note",data:Qe}:c==="input"?{e:"string",data:se}:!1}const Ks={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}"]}},Kt=new Set,Pn=new Dn({layout:Ks}),ft=Ve(void 0);Ht(ft,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const Et=gt(Ve({isCustom:!1,layout:Ks,hotkeydRows:"middle-row"}),{key:"keyboard-options"}),Rt=Ve(Pn.rows),Tt=Ve(Pn);pt.subscribe(s=>{const e=Ee(Tt);e.setNotes(Array.from(s.notesMap.values())),Rt.set(e.rows),Tt.set(e)});Et.subscribe(s=>{const e=new Dn(s),t=Ee(pt);e.setNotes(Array.from(t.notesMap.values())),Rt.set(e.rows),Tt.set(e)});const On=Ht(Tt,s=>new Map(s.rows.flatMap(e=>e.keys.map(t=>[t.code,t])))),ur=Ht(Tt,s=>s.rows.flatMap(e=>e.keys).map(e=>e.note).filter(e=>e!==void 0).sort((e,t)=>e.semitones-t.semitones)),it={async setLayout(s){const e=await Ho(s),t=Ee(Et);e.code!==t.layout.code&&Et.update(l=>({...l,isCustom:!1,layout:e}))},async setCustomLayout(s){s?Et.update(e=>({...e,isCustom:s,layout:{code:"custom",name:"Custom",imported:e.layout.imported}})):this.setLayout(navigator.languages)},toggleRows(s){Et.update(e=>({...e,hotkeydRows:s??(e.hotkeydRows==="middle-row"?"two-rows":"middle-row")}))},captureHotkeyRow(s){const e=Ee(Tt),t=Ee(pt),{first:l,count:n}=e.startSetCustomRow(s);ft.set({nextIndex:l,rowIndex:s,count:n,scaleNotes:Array.from(t.notesMap.values())})},findNote(s){return Ee(ur).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((l,n)=>l+(n.toLowerCase()==="b"||n==="♭"?-1:n.toLowerCase()==="s"||n==="#"||n==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleHotkeyInput(s,e,t){const l=or(Kt,e,t),n=Ee(Tt);let r;const o=n.setCustomRow.nextKeyIdx;l.e==="hotkeys-cancel"?(ft.set(void 0),Kt.clear()):l.e==="hotkeys-skip-key"?r=n.skipNextCustomNote():l.e==="hotkeys-captured-key"&&(r=n.setNextCustomNote(l.data.key,l.data.code,s.scaleNotes));const a=Ee(Rt);if(r&&(a[s.rowIndex].keys[o]=r.key,Rt.set(a),ft.update(i=>i?{...i,nextIndex:r.index}:void 0)),s.count===o){const i=Jo(a);Et.update(c=>({...c,layout:{...c.layout,imported:i}})),ft.set(void 0),Kt.clear()}return l},handleInput(s,e,t=!1){const l=Ee(It),n=Ee(ft);return n?this.handleHotkeyInput(n,s,e):l instanceof Ft?ar(s,e.toUpperCase()):l instanceof mt&&l.type==="chords-write"?ir(s,e):Ee(nt).useKeyboard?cr(s,e.toUpperCase(),t):!1},cancelCapture(){ft.set(void 0),Kt.clear()},reset(){Et.set({isCustom:!1,layout:Ks,hotkeydRows:"middle-row"}),ft.set(void 0),Kt.clear()}};function Vl(s){let e;return{c(){e=b("li"),this.h()},l(t){e=y(t,"LI",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","m-[0.175rem] mr-0")},m(t,l){K(t,e,l)},d(t){t&&p(e)}}}function jl(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(p),this.h()},h(){m(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,l){K(t,e,l)},d(t){t&&p(e)}}}function Bl(s){let e,t=s[0].note.note+"",l,n;return{c(){e=b("div"),l=Z(t),n=Z(s[3]),this.h()},l(r){e=y(r,"DIV",{class:!0});var o=C(e);l=ee(o,t),n=ee(o,s[3]),o.forEach(p),this.h()},h(){m(e,"class","absolute top-0 left-0")},m(r,o){K(r,e,o),u(e,l),u(e,n)},p(r,o){o&1&&t!==(t=r[0].note.note+"")&&_e(l,t),o&8&&_e(n,r[3])},d(r){r&&p(e)}}}function fr(s){let e,t,l,n,r,o,a=Ml(s[0].key)+"",i,c,d,f,g=s[0].key==="{enter}"&&Vl(),_=s[0].key==="{enter}"&&jl(),h=s[0].note&&Bl(s);return{c(){g&&g.c(),e=j(),t=b("li"),l=b("button"),_&&_.c(),n=j(),h&&h.c(),r=j(),o=b("div"),i=Z(a),this.h()},l(v){g&&g.l(v),e=B(v),t=y(v,"LI",{class:!0});var D=C(t);l=y(D,"BUTTON",{class:!0});var k=C(l);_&&_.l(k),n=B(k),h&&h.l(k),r=B(k),o=y(k,"DIV",{});var w=C(o);i=ee(w,a),w.forEach(p),k.forEach(p),D.forEach(p),this.h()},h(){m(l,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),Y(l,"items-center",!s[0].note),Y(l,"items-end",s[0].note),m(t,"class",c=Ie(`${s[4].class||""} m-[0.175rem] ${Gl(s[1])} min-w-[32px]`)+" svelte-1479mcy"),Y(t,"enter",s[0].key==="{enter}"),Y(t,"captured",s[2])},m(v,D){g&&g.m(v,D),K(v,e,D),K(v,t,D),u(t,l),_&&_.m(l,null),u(l,n),h&&h.m(l,null),u(l,r),u(l,o),u(o,i),d||(f=$(l,"click",s[10]),d=!0)},p(v,[D]){v[0].key==="{enter}"?g||(g=Vl(),g.c(),g.m(e.parentNode,e)):g&&(g.d(1),g=null),v[0].key==="{enter}"?_||(_=jl(),_.c(),_.m(l,n)):_&&(_.d(1),_=null),v[0].note?h?h.p(v,D):(h=Bl(v),h.c(),h.m(l,r)):h&&(h.d(1),h=null),D&1&&a!==(a=Ml(v[0].key)+"")&&_e(i,a),D&1&&Y(l,"items-center",!v[0].note),D&1&&Y(l,"items-end",v[0].note),D&18&&c!==(c=Ie(`${v[4].class||""} m-[0.175rem] ${Gl(v[1])} min-w-[32px]`)+" svelte-1479mcy")&&m(t,"class",c),D&19&&Y(t,"enter",v[0].key==="{enter}"),D&22&&Y(t,"captured",v[2])},i:he,o:he,d(v){v&&(p(e),p(t)),g&&g.d(v),_&&_.d(),h&&h.d(),d=!1,f()}}}function Gl(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function Ml(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function dr(s,e,t){let l,n,r,o,a,i;me(s,ft,_=>t(7,o=_)),me(s,ps,_=>t(8,a=_)),me(s,Rt,_=>t(9,i=_));let{rowIndex:c,keyIndex:d}=e,f;function g(_){ms.call(this,s,_)}return s.$$set=_=>{t(4,e=Te(Te({},e),Ae(_))),"rowIndex"in _&&t(5,c=_.rowIndex),"keyIndex"in _&&t(6,d=_.keyIndex)},s.$$.update=()=>{s.$$.dirty&608&&t(0,l=i[c].keys[d]),s.$$.dirty&257&&t(3,n=l.note?ds({midi:l.note.semitones+a[0],flats:0,sharps:0}):0),s.$$.dirty&224&&t(2,r=o&&o.rowIndex===c&&o.nextIndex===d),s.$$.dirty&65&&(l.key==="{bksp}"?t(1,f=2):l.key==="{tab}"?t(1,f=1.5):l.key==="{enter}"?t(1,f=2):l.key==="{lock}"?t(1,f=1.75):l.key==="{shift}"&&d===0?t(1,f=1.5):l.key==="{shift}"?t(1,f=2.5):t(1,f=1))},e=Ae(e),[l,f,r,n,e,c,d,o,a,i,g]}class hr extends qe{constructor(e){super(),We(this,e,dr,fr,Je,{rowIndex:5,keyIndex:6})}}function Rl(s,e,t){const l=s.slice();return l[13]=e[t],l[15]=t,l}function Ul(s,e,t){const l=s.slice();return l[16]=e[t],l[18]=t,l}function mr(s){let e,t=s[0].layout.name+"",l;return{c(){e=b("div"),l=Z(t),this.h()},l(n){e=y(n,"DIV",{slot:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"slot","value")},m(n,r){K(n,e,r),u(e,l)},p(n,r){r&1&&t!==(t=n[0].layout.name+"")&&_e(l,t)},d(n){n&&p(e)}}}function Kl(s){let e,t,l,n,r;t=new Ue({props:{icon:Kn,width:20}});function o(){return s[12](s[15])}return{c(){e=b("button"),pe(t.$$.fragment),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var i=C(e);ge(t.$$.fragment,i),i.forEach(p),this.h()},h(){m(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(a,i){K(a,e,i),ve(t,e,null),l=!0,n||(r=$(e,"click",o),n=!0)},p(a,i){s=a},i(a){l||(x(t.$$.fragment,a),l=!0)},o(a){W(t.$$.fragment,a),l=!1},d(a){a&&p(e),be(t),n=!1,r()}}}function xl(s){let e,t;return e=new hr({props:{rowIndex:s[15],keyIndex:s[18]}}),{c(){pe(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,n){ve(e,l,n),t=!0},p:he,i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){be(e,l)}}}function Fl(s){let e,t,l,n,r=s[2][s[15]]&&s[0].isCustom&&Kl(s),o=fe(s[13].keys),a=[];for(let c=0;c<o.length;c+=1)a[c]=xl(Ul(s,o,c));const i=c=>W(a[c],1,1,()=>{a[c]=null});return{c(){e=b("li"),r&&r.c(),t=j();for(let c=0;c<a.length;c+=1)a[c].c();l=Pe(),this.h()},l(c){e=y(c,"LI",{class:!0});var d=C(e);r&&r.l(d),d.forEach(p),t=B(c);for(let f=0;f<a.length;f+=1)a[f].l(c);l=Pe(),this.h()},h(){m(e,"class","col-span-2 svelte-1av9wwd")},m(c,d){K(c,e,d),r&&r.m(e,null),K(c,t,d);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(c,d);K(c,l,d),n=!0},p(c,d){if(c[2][c[15]]&&c[0].isCustom?r?(r.p(c,d),d&5&&x(r,1)):(r=Kl(c),r.c(),x(r,1),r.m(e,null)):r&&(xe(),W(r,1,1,()=>{r=null}),Fe()),d&8){o=fe(c[13].keys);let f;for(f=0;f<o.length;f+=1){const g=Ul(c,o,f);a[f]?(a[f].p(g,d),x(a[f],1)):(a[f]=xl(g),a[f].c(),x(a[f],1),a[f].m(l.parentNode,l))}for(xe(),f=o.length;f<a.length;f+=1)i(f);Fe()}},i(c){if(!n){x(r);for(let d=0;d<o.length;d+=1)x(a[d]);n=!0}},o(c){W(r),a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)W(a[d]);n=!1},d(c){c&&(p(e),p(t),p(l)),r&&r.d(),Oe(a,c)}}}function _r(s){let e,t,l,n,r,o="Layout",a,i,c,d,f,g="Custom",_,h,v,D,k,w,L="One row",P,U,O,I,A="Two rows",E,T,N,S,V,G,R,H,Q,z,J;i=new tr({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1 w-36",options:s[4],onSelect:s[6],$$slots:{value:[mr]},$$scope:{ctx:s}}}),U=new nr({props:{checked:!s[1]}}),U.$on("change",s[9]),S=new Ue({props:{icon:zt,width:16}});let de=fe(s[3].rows),M=[];for(let F=0;F<de.length;F+=1)M[F]=Fl(Rl(s,de,F));const re=F=>W(M[F],1,1,()=>{M[F]=null});return{c(){e=b("div"),t=b("div"),l=b("div"),n=b("div"),r=b("label"),r.textContent=o,a=j(),pe(i.$$.fragment),c=j(),d=b("div"),f=b("label"),f.textContent=g,_=j(),h=b("input"),D=j(),k=b("div"),w=b("label"),w.textContent=L,P=j(),pe(U.$$.fragment),O=j(),I=b("label"),I.textContent=A,E=j(),T=b("div"),N=b("button"),pe(S.$$.fragment),V=j(),G=b("div"),R=b("ul");for(let F=0;F<M.length;F+=1)M[F].c();this.h()},l(F){e=y(F,"DIV",{class:!0});var te=C(e);t=y(te,"DIV",{class:!0});var ae=C(t);l=y(ae,"DIV",{class:!0});var Le=C(l);n=y(Le,"DIV",{class:!0});var ie=C(n);r=y(ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(r)!=="svelte-1xsr9lq"&&(r.textContent=o),a=B(ie),ge(i.$$.fragment,ie),ie.forEach(p),c=B(Le),d=y(Le,"DIV",{class:!0});var ye=C(d);f=y(ye,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(f)!=="svelte-11aw8ub"&&(f.textContent=g),_=B(ye),h=y(ye,"INPUT",{class:!0,id:!0,type:!0}),ye.forEach(p),D=B(Le),k=y(Le,"DIV",{class:!0});var X=C(k);w=y(X,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(w)!=="svelte-17p0yvw"&&(w.textContent=L),P=B(X),ge(U.$$.fragment,X),O=B(X),I=y(X,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(I)!=="svelte-1wr3nwv"&&(I.textContent=A),X.forEach(p),Le.forEach(p),E=B(ae),T=y(ae,"DIV",{class:!0});var ce=C(T);N=y(ce,"BUTTON",{class:!0});var we=C(N);ge(S.$$.fragment,we),we.forEach(p),ce.forEach(p),ae.forEach(p),V=B(te),G=y(te,"DIV",{class:!0});var ue=C(G);R=y(ue,"UL",{class:!0});var He=C(R);for(let q=0;q<M.length;q+=1)M[q].l(He);He.forEach(p),ue.forEach(p),te.forEach(p),this.h()},h(){m(r,"class","font-bold mr-4"),m(r,"for","middle-row"),m(n,"class","my-1 flex items-center justify-between mr-2"),m(f,"class","font-bold mr-4"),m(f,"for","custom-layout"),m(h,"class","h-[20px]"),m(h,"id","custom-layout"),m(h,"type","checkbox"),h.checked=v=s[0].isCustom,m(d,"class","my-1 flex items-center"),m(w,"class","font-bold mr-4"),m(w,"for","two-rows"),m(I,"class","font-bold ml-4"),m(I,"for","two-rows"),m(k,"class","my-1 flex items-center"),m(l,"class","options svelte-1av9wwd"),m(N,"class","rounded px-1 py-1 hover:bg-gray-200"),m(T,"class","flex items-center justify-center"),m(t,"class","flex justify-between"),m(R,"class","keyboard svelte-1av9wwd"),m(G,"class","flex flex-col"),m(e,"class",H=Ie(`${s[10].class||""} relative`)+" svelte-1av9wwd")},m(F,te){K(F,e,te),u(e,t),u(t,l),u(l,n),u(n,r),u(n,a),ve(i,n,null),u(l,c),u(l,d),u(d,f),u(d,_),u(d,h),u(l,D),u(l,k),u(k,w),u(k,P),ve(U,k,null),u(k,O),u(k,I),u(t,E),u(t,T),u(T,N),ve(S,N,null),u(e,V),u(e,G),u(G,R);for(let ae=0;ae<M.length;ae+=1)M[ae]&&M[ae].m(R,null);Q=!0,z||(J=[$(h,"change",s[7]),$(N,"click",s[5])],z=!0)},p(F,[te]){const ae={};te&524289&&(ae.$$scope={dirty:te,ctx:F}),i.$set(ae),(!Q||te&1&&v!==(v=F[0].isCustom))&&(h.checked=v);const Le={};if(te&2&&(Le.checked=!F[1]),U.$set(Le),te&269){de=fe(F[3].rows);let ie;for(ie=0;ie<de.length;ie+=1){const ye=Rl(F,de,ie);M[ie]?(M[ie].p(ye,te),x(M[ie],1)):(M[ie]=Fl(ye),M[ie].c(),x(M[ie],1),M[ie].m(R,null))}for(xe(),ie=de.length;ie<M.length;ie+=1)re(ie);Fe()}(!Q||te&1024&&H!==(H=Ie(`${F[10].class||""} relative`)+" svelte-1av9wwd"))&&m(e,"class",H)},i(F){if(!Q){x(i.$$.fragment,F),x(U.$$.fragment,F),x(S.$$.fragment,F);for(let te=0;te<de.length;te+=1)x(M[te]);Q=!0}},o(F){W(i.$$.fragment,F),W(U.$$.fragment,F),W(S.$$.fragment,F),M=M.filter(Boolean);for(let te=0;te<M.length;te+=1)W(M[te]);Q=!1},d(F){F&&p(e),be(i),be(U),be(S),Oe(M,F),z=!1,Xe(J)}}}function pr(s,e,t){let l,n,r,o,a;me(s,Et,v=>t(0,r=v)),me(s,Rt,v=>t(11,o=v)),me(s,Tt,v=>t(3,a=v)),vn(()=>{a.opts.isCustom||it.setLayout(navigator.languages)});const i=Object.entries(Ds).map(([v,D])=>({key:v,value:D.name}));function c(){it.reset(),it.setLayout(navigator.languages)}function d(v){return it.setLayout([v]),!1}function f(v){it.setCustomLayout(v.currentTarget.checked)}function g(v){it.captureHotkeyRow(v)}function _(){it.toggleRows()}const h=v=>g(v);return s.$$set=v=>{t(10,e=Te(Te({},e),Ae(v)))},s.$$.update=()=>{s.$$.dirty&2049&&t(2,l=o.map((v,D)=>r.hotkeydRows==="middle-row"?D===1||D===2:!0)),s.$$.dirty&1&&t(1,n=r.hotkeydRows==="middle-row")},e=Ae(e),[r,n,l,a,i,c,d,f,g,_,e,o,h]}class gr extends qe{constructor(e){super(),We(this,e,pr,_r,Je,{})}}function Hl(s){let e,t;return e=new gr({props:{class:"mt-4"}}),{c(){pe(e.$$.fragment)},l(l){ge(e.$$.fragment,l)},m(l,n){ve(e,l,n),t=!0},i(l){t||(x(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){be(e,l)}}}function vr(s){let e,t,l,n,r="I/O",o,a,i,c,d,f,g,_,h="Device",v,D,k,w,L,P,U="Prompt",O,I,A="Disable",E,T,N,S,V="Sound",G,R,H,Q,z,J,de="Fixed velocity",M,re,F,te,ae,Le,ie="Keyboard",ye,X,ce,we,ue,He,q="Hotkeys",ne,ke,tt,le,je,Me,vt="Auto-octave",Nt,ze,Ke,St,st,$e,xs=" ",gs,Dt,ct,vs,qt,bs,bt,yt,Fs="Fade timeout",ys,ut,ks,Wt,Ye,ws,Hs;c=new Ue({props:{icon:zt,width:16}});let Ge=s[2]&&!s[4]&&Hl();return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,o=j(),a=b("div"),i=b("button"),pe(c.$$.fragment),d=j(),f=b("div"),g=b("div"),_=b("label"),_.textContent=h,v=j(),D=b("input"),w=j(),L=b("div"),P=b("button"),P.textContent=U,O=j(),I=b("button"),I.textContent=A,E=j(),T=b("div"),N=b("div"),S=b("label"),S.textContent=V,G=j(),R=b("input"),Q=j(),z=b("div"),J=b("label"),J.textContent=de,M=j(),re=b("input"),F=j(),te=b("div"),ae=b("div"),Le=b("label"),Le.textContent=ie,ye=j(),X=b("input"),we=j(),ue=b("div"),He=b("label"),He.textContent=q,ne=j(),ke=b("input"),le=j(),je=b("div"),Me=b("label"),Me.textContent=vt,Nt=j(),ze=b("input"),St=j(),st=b("div"),$e=b("div"),$e.textContent=xs,gs=j(),Dt=b("div"),ct=b("button"),vs=Z("Set hotkeys"),bs=j(),bt=b("div"),yt=b("label"),yt.textContent=Fs,ys=j(),ut=b("input"),ks=j(),Ge&&Ge.c(),this.h()},l(Ne){e=y(Ne,"DIV",{class:!0});var Re=C(e);t=y(Re,"FIELDSET",{class:!0});var ot=C(t);l=y(ot,"LEGEND",{class:!0});var zs=C(l);n=y(zs,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-1jbbsti"&&(n.textContent=r),zs.forEach(p),o=B(ot),a=y(ot,"DIV",{class:!0});var qs=C(a);i=y(qs,"BUTTON",{class:!0});var Ws=C(i);ge(c.$$.fragment,Ws),Ws.forEach(p),qs.forEach(p),d=B(ot),f=y(ot,"DIV",{class:!0});var kt=C(f);g=y(kt,"DIV",{class:!0});var Lt=C(g);_=y(Lt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(_)!=="svelte-crpa7y"&&(_.textContent=h),v=B(Lt),D=y(Lt,"INPUT",{class:!0,id:!0}),w=B(Lt),L=y(Lt,"DIV",{class:!0});var Jt=C(L);P=y(Jt,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(P)!=="svelte-mj6mct"&&(P.textContent=U),O=B(Jt),I=y(Jt,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(I)!=="svelte-1sl6oxh"&&(I.textContent=A),Jt.forEach(p),Lt.forEach(p),E=B(kt),T=y(kt,"DIV",{class:!0});var $t=C(T);N=y($t,"DIV",{class:!0});var Yt=C(N);S=y(Yt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(S)!=="svelte-wgxtkw"&&(S.textContent=V),G=B(Yt),R=y(Yt,"INPUT",{class:!0,id:!0,type:!0}),Yt.forEach(p),Q=B($t),z=y($t,"DIV",{class:!0});var Qt=C(z);J=y(Qt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(J)!=="svelte-1tm2bth"&&(J.textContent=de),M=B(Qt),re=y(Qt,"INPUT",{class:!0,id:!0,placeholder:!0}),Qt.forEach(p),$t.forEach(p),F=B(kt),te=y(kt,"DIV",{class:!0});var Pt=C(te);ae=y(Pt,"DIV",{class:!0});var Xt=C(ae);Le=y(Xt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(Le)!=="svelte-1js269u"&&(Le.textContent=ie),ye=B(Xt),X=y(Xt,"INPUT",{class:!0,id:!0,type:!0}),Xt.forEach(p),we=B(Pt),ue=y(Pt,"DIV",{class:!0});var Zt=C(ue);He=y(Zt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(He)!=="svelte-21h39k"&&(He.textContent=q),ne=B(Zt),ke=y(Zt,"INPUT",{class:!0,id:!0,type:!0}),Zt.forEach(p),le=B(Pt),je=y(Pt,"DIV",{class:!0});var es=C(je);Me=y(es,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(Me)!=="svelte-33lczu"&&(Me.textContent=vt),Nt=B(es),ze=y(es,"INPUT",{class:!0,id:!0,type:!0}),es.forEach(p),Pt.forEach(p),St=B(kt),st=y(kt,"DIV",{class:!0});var Ot=C(st);$e=y(Ot,"DIV",{class:!0,"data-svelte-h":!0}),oe($e)!=="svelte-dgefms"&&($e.textContent=xs),gs=B(Ot),Dt=y(Ot,"DIV",{class:!0});var Js=C(Dt);ct=y(Js,"BUTTON",{class:!0});var $s=C(ct);vs=ee($s,"Set hotkeys"),$s.forEach(p),Js.forEach(p),bs=B(Ot),bt=y(Ot,"DIV",{class:!0});var ts=C(bt);yt=y(ts,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(yt)!=="svelte-vd5i27"&&(yt.textContent=Fs),ys=B(ts),ut=y(ts,"INPUT",{class:!0,id:!0}),ts.forEach(p),Ot.forEach(p),kt.forEach(p),ks=B(ot),Ge&&Ge.l(ot),ot.forEach(p),Re.forEach(p),this.h()},h(){var Ne;m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(i,"class","rounded px-1 py-1 hover:bg-gray-200"),m(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center"),Y(a,"hidden",s[4]),m(_,"class","font-bold"),m(_,"for","device"),m(D,"class","px-1 my-1 rounded w-50"),m(D,"id","device"),D.disabled=!0,D.value=k=((Ne=s[5])==null?void 0:Ne.name)??"No device",m(P,"class","btn-sm primary mr-2"),m(I,"class","btn-sm primary"),m(L,"class","flex my-[auto]"),m(g,"class","h-full flex flex-col"),m(S,"class","font-bold"),m(S,"for","sound"),m(R,"class","h-[20px]"),m(R,"id","sound"),m(R,"type","checkbox"),R.checked=H=s[3].useSound,m(N,"class","my-1 flex justify-between mr-12"),m(J,"class","font-bold"),m(J,"for","fixed-velocity"),m(re,"class","h-[20px] w-16"),m(re,"id","fixed-velocity"),m(re,"placeholder","0-127"),m(z,"class","flex justify-between"),m(T,"class","flex flex-col h-full"),m(Le,"class","font-bold"),m(Le,"for","keyboard"),m(X,"class","h-[20px]"),m(X,"id","keyboard"),m(X,"type","checkbox"),X.checked=ce=s[3].useKeyboard,m(ae,"class","my-1 flex justify-between mr-12"),m(He,"class","font-bold"),m(He,"for","hotkeys"),m(ke,"class","h-[20px]"),m(ke,"id","hotkeys"),m(ke,"type","checkbox"),ke.checked=tt=s[3].useHotkeys,m(ue,"class","my-1 flex justify-between mr-12"),m(Me,"class","font-bold"),m(Me,"for","auto-octave"),m(ze,"class","h-[20px]"),m(ze,"id","auto-octave"),m(ze,"type","checkbox"),ze.checked=Ke=s[3].useAutoOctave,m(je,"class","my-1 flex justify-between mr-12"),m(te,"class","flex flex-col h-full"),m($e,"class","h-[28px]"),m(ct,"class","w-full btn-sm primary"),ct.disabled=qt=!s[3].useHotkeys,m(Dt,"class","my-[2px] flex justify-between"),m(yt,"class","font-bold"),m(yt,"for","fade-timeout"),m(ut,"class","h-[20px] w-16"),m(ut,"id","fade-timeout"),ut.value=s[1],m(bt,"class","my-1 flex justify-between"),m(st,"class","flex flex-col h-full"),m(f,"class","body svelte-1bpw69s"),Y(f,"hidden",s[4]),m(t,"class","relative flex flex-col max-w-full rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),Y(t,"collapsed",s[4]),m(e,"class",Wt=Ie(`${s[12].class||""}`)+" svelte-1bpw69s")},m(Ne,Re){K(Ne,e,Re),u(e,t),u(t,l),u(l,n),u(t,o),u(t,a),u(a,i),ve(c,i,null),u(t,d),u(t,f),u(f,g),u(g,_),u(g,v),u(g,D),u(g,w),u(g,L),u(L,P),u(L,O),u(L,I),u(f,E),u(f,T),u(T,N),u(N,S),u(N,G),u(N,R),u(T,Q),u(T,z),u(z,J),u(z,M),u(z,re),et(re,s[0]),u(f,F),u(f,te),u(te,ae),u(ae,Le),u(ae,ye),u(ae,X),u(te,we),u(te,ue),u(ue,He),u(ue,ne),u(ue,ke),u(te,le),u(te,je),u(je,Me),u(je,Nt),u(je,ze),u(f,St),u(f,st),u(st,$e),u(st,gs),u(st,Dt),u(Dt,ct),u(ct,vs),u(st,bs),u(st,bt),u(bt,yt),u(bt,ys),u(bt,ut),u(t,ks),Ge&&Ge.m(t,null),Ye=!0,ws||(Hs=[$(n,"click",s[7]),$(i,"click",s[11]),$(P,"click",Be.openMidi),$(I,"click",Be.disableMidi),$(R,"change",s[13]),$(re,"input",s[14]),$(re,"change",s[8]),$(X,"change",s[15]),$(ke,"change",s[9]),$(ze,"change",s[16]),$(ct,"click",s[17]),$(ut,"input",s[10])],ws=!0)},p(Ne,[Re]){var ot;(!Ye||Re&16)&&Y(a,"hidden",Ne[4]),(!Ye||Re&32&&k!==(k=((ot=Ne[5])==null?void 0:ot.name)??"No device")&&D.value!==k)&&(D.value=k),(!Ye||Re&8&&H!==(H=Ne[3].useSound))&&(R.checked=H),Re&1&&re.value!==Ne[0]&&et(re,Ne[0]),(!Ye||Re&8&&ce!==(ce=Ne[3].useKeyboard))&&(X.checked=ce),(!Ye||Re&8&&tt!==(tt=Ne[3].useHotkeys))&&(ke.checked=tt),(!Ye||Re&8&&Ke!==(Ke=Ne[3].useAutoOctave))&&(ze.checked=Ke),(!Ye||Re&8&&qt!==(qt=!Ne[3].useHotkeys))&&(ct.disabled=qt),(!Ye||Re&2&&ut.value!==Ne[1])&&(ut.value=Ne[1]),(!Ye||Re&16)&&Y(f,"hidden",Ne[4]),Ne[2]&&!Ne[4]?Ge?Re&20&&x(Ge,1):(Ge=Hl(),Ge.c(),x(Ge,1),Ge.m(t,null)):Ge&&(xe(),W(Ge,1,1,()=>{Ge=null}),Fe()),(!Ye||Re&16)&&Y(t,"collapsed",Ne[4]),(!Ye||Re&4096&&Wt!==(Wt=Ie(`${Ne[12].class||""}`)+" svelte-1bpw69s"))&&m(e,"class",Wt)},i(Ne){Ye||(x(c.$$.fragment,Ne),x(Ge),Ye=!0)},o(Ne){W(c.$$.fragment,Ne),W(Ge),Ye=!1},d(Ne){Ne&&p(e),be(c),Ge&&Ge.d(),ws=!1,Xe(Hs)}}}function br(s,e,t){let l,n,r;me(s,nt,P=>t(3,l=P)),me(s,hs,P=>t(5,r=P));const o=gt(Ve(!1),{key:"inputs-hidden"});me(s,o,P=>t(4,n=P));let a=l.fixedVelocity??"",i=l.keyFadeTimeout,c=!1;nt.subscribe(P=>{t(0,a=P.fixedVelocity??""),t(1,i=P.keyFadeTimeout)});function d(){o.update(P=>!P)}function f(P){const{value:U}=P.currentTarget;let O;if(U)try{O=parseInt(U)}catch{}O!==void 0&&O>=0&&O<=127?Be.setInputValue("fixedVelocity",O):U?t(0,a=l.fixedVelocity||""):Be.setInputValue("fixedVelocity",void 0)}function g(P){Be.setInputValue("useHotkeys",P.currentTarget.checked),P.currentTarget.checked||(t(2,c=!1),it.cancelCapture())}function _(P){try{const U=parseInt(P.currentTarget.value);Be.setInputValue("keyFadeTimeout",U)}catch{t(1,i=l.keyFadeTimeout)}}function h(){Be.setInputValue("useSound",!0),Be.setInputValue("fixedVelocity",void 0),Be.setInputValue("useKeyboard",!0),Be.setInputValue("useHotkeys",!0),Be.setInputValue("useAutoOctave",!0),Be.setInputValue("keyFadeTimeout",1500)}const v=P=>Be.setInputValue("useSound",P.currentTarget.checked);function D(){a=this.value,t(0,a)}const k=P=>Be.setInputValue("useKeyboard",P.currentTarget.checked),w=P=>Be.setInputValue("useAutoOctave",P.currentTarget.checked),L=()=>t(2,c=!c);return s.$$set=P=>{t(12,e=Te(Te({},e),Ae(P)))},e=Ae(e),[a,i,c,l,n,r,o,d,f,g,_,h,e,v,D,k,w,L]}class yr extends qe{constructor(e){super(),We(this,e,br,vr,Je,{})}}function kr(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){K(t,e,l)},p:he,d(t){t&&p(e)}}}function wr(s){let e,t=s[1].note+"",l;return{c(){e=Z("Input: "),l=Z(t)},l(n){e=ee(n,"Input: "),l=ee(n,t)},m(n,r){K(n,e,r),K(n,l,r)},p(n,r){r&2&&t!==(t=n[1].note+"")&&_e(l,t)},d(n){n&&(p(e),p(l))}}}function Er(s){let e,t;return{c(){e=Z("Input: "),t=Z(s[0])},l(l){e=ee(l,"Input: "),t=ee(l,s[0])},m(l,n){K(l,e,n),K(l,t,n)},p(l,n){n&1&&_e(t,l[0])},d(l){l&&(p(e),p(t))}}}function Cr(s){let e;return{c(){e=Z(Ls)},l(t){e=ee(t,Ls)},m(t,l){K(t,e,l)},p:he,d(t){t&&p(e)}}}function Ir(s){let e,t,l,n;function r(i,c){return i[2].useKeyboard&&Ls?Cr:i[2].useKeyboard&&i[0]?Er:i[2].useKeyboard&&i[1]?wr:kr}let o=r(s),a=o(s);return{c(){e=b("div"),a.c(),this.h()},l(i){e=y(i,"DIV",{class:!0});var c=C(e);a.l(c),c.forEach(p),this.h()},h(){m(e,"class",t=`${s[4].class||""}`)},m(i,c){K(i,e,c),a.m(e,null),l||(n=$(window,"keydown",s[3]),l=!0)},p(i,[c]){o===(o=r(i))&&a?a.p(i,c):(a.d(1),a=o(i),a&&(a.c(),a.m(e,null))),c&16&&t!==(t=`${i[4].class||""}`)&&m(e,"class",t)},i:he,o:he,d(i){i&&p(e),a.d(),l=!1,n()}}}let Ls="";function Tr(s,e,t){let l;me(s,nt,c=>t(2,l=c));let{debounced:n}=e,r="",o;const a=Bn();function i(c){const d=c.target;if(n||!(d instanceof HTMLElement)||d.tagName==="INPUT")return;const f=it.handleInput(c.code,c.key,c.shiftKey);f&&f.e==="note"?t(1,o=f.data):f&&f.e==="string"?t(0,r=f.data):f&&(f.e==="guessed-key"||f.e==="guessed-chord"||f.e==="guessed-note")?(t(0,r=""),t(1,o=void 0),a(f.e,f.data),c.code==="Enter"&&c.preventDefault()):f&&c.preventDefault()}return s.$$set=c=>{t(4,e=Te(Te({},e),Ae(c))),"debounced"in c&&t(5,n=c.debounced)},e=Ae(e),[r,o,l,i,e,n]}class Ar extends qe{constructor(e){super(),We(this,e,Tr,Ir,Je,{debounced:5})}}function Nr(s){let e,t,l,n="Count",r,o,a,i,c,d="Duplicates",f,g,_,h,v,D,k="Autoplay",w,L,P,U,O,I,A="Wait seconds",E,T,N,S,V;return{c(){e=b("ul"),t=b("li"),l=b("label"),l.textContent=n,r=j(),o=b("input"),a=j(),i=b("li"),c=b("label"),c.textContent=d,f=j(),g=b("input"),h=j(),v=b("li"),D=b("label"),D.textContent=k,w=j(),L=b("input"),U=j(),O=b("li"),I=b("label"),I.textContent=A,E=j(),T=b("input"),this.h()},l(G){e=y(G,"UL",{class:!0});var R=C(e);t=y(R,"LI",{class:!0});var H=C(t);l=y(H,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(l)!=="svelte-wgq9fc"&&(l.textContent=n),r=B(H),o=y(H,"INPUT",{class:!0,id:!0,type:!0}),H.forEach(p),a=B(R),i=y(R,"LI",{class:!0});var Q=C(i);c=y(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(c)!=="svelte-hcg9dq"&&(c.textContent=d),f=B(Q),g=y(Q,"INPUT",{class:!0,id:!0,type:!0}),Q.forEach(p),h=B(R),v=y(R,"LI",{class:!0});var z=C(v);D=y(z,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(D)!=="svelte-lr68n2"&&(D.textContent=k),w=B(z),L=y(z,"INPUT",{class:!0,id:!0,type:!0}),z.forEach(p),U=B(R),O=y(R,"LI",{class:!0});var J=C(O);I=y(J,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(I)!=="svelte-1qj2vcy"&&(I.textContent=A),E=B(J),T=y(J,"INPUT",{class:!0,id:!0,type:!0}),J.forEach(p),R.forEach(p),this.h()},h(){m(l,"class","font-bold"),m(l,"for","guess-count"),m(o,"class","h-[20px] w-10"),m(o,"id","guess-count"),m(o,"type","number"),m(t,"class","flex items-center justify-between svelte-1elvih2"),m(c,"class","font-bold"),m(c,"for","duplicates"),m(g,"class","h-[20px]"),m(g,"id","duplicates"),m(g,"type","checkbox"),g.checked=_=s[2].duplicates,m(i,"class","flex items-center justify-between mr-6 svelte-1elvih2"),m(D,"class","font-bold"),m(D,"for","autoplay"),m(L,"class","h-[20px]"),m(L,"id","autoplay"),m(L,"type","checkbox"),L.checked=P=s[2].autoplay,m(v,"class","flex items-center justify-between mr-6 svelte-1elvih2"),m(I,"class","font-bold"),m(I,"for","wait-ms"),m(T,"class","h-[20px] w-10"),m(T,"id","wait-ms"),m(T,"type","number"),m(O,"class","flex items-center justify-between svelte-1elvih2"),m(e,"class",N=Ie(`${s[5].class||""}`)+" svelte-1elvih2")},m(G,R){K(G,e,R),u(e,t),u(t,l),u(t,r),u(t,o),et(o,s[0]),u(e,a),u(e,i),u(i,c),u(i,f),u(i,g),u(e,h),u(e,v),u(v,D),u(v,w),u(v,L),u(e,U),u(e,O),u(O,I),u(O,E),u(O,T),et(T,s[1]),S||(V=[$(o,"input",s[6]),$(o,"input",s[3]),$(g,"input",s[7]),$(L,"input",s[8]),$(T,"input",s[9]),$(T,"input",s[4])],S=!0)},p(G,[R]){R&1&&cs(o.value)!==G[0]&&et(o,G[0]),R&4&&_!==(_=G[2].duplicates)&&(g.checked=_),R&4&&P!==(P=G[2].autoplay)&&(L.checked=P),R&2&&cs(T.value)!==G[1]&&et(T,G[1]),R&32&&N!==(N=Ie(`${G[5].class||""}`)+" svelte-1elvih2")&&m(e,"class",N)},i:he,o:he,d(G){G&&p(e),S=!1,Xe(V)}}}function Sr(s,e,t){let l;me(s,_t,g=>t(2,l=g));let n=l.count||"",r=l.waitSeconds||"";_t.subscribe(g=>{t(0,n=g.count||""),t(1,r=g.waitSeconds||"")});function o({currentTarget:{value:g}}){let _;try{_=parseInt(g),_<=0&&(_=1),De.setOptionValue("count",_)}catch{t(0,n=l.count)}}function a({currentTarget:{value:g}}){let _;try{_=parseInt(g),_<0&&(_=0),De.setOptionValue("waitSeconds",_)}catch{t(1,r=l.waitSeconds)}}function i(){n=cs(this.value),t(0,n)}const c=g=>De.setOptionValue("duplicates",g.currentTarget.checked),d=g=>De.setOptionValue("autoplay",g.currentTarget.checked);function f(){r=cs(this.value),t(1,r)}return s.$$set=g=>{t(5,e=Te(Te({},e),Ae(g)))},e=Ae(e),[n,r,l,o,a,e,i,c,d,f]}class Dr extends qe{constructor(e){super(),We(this,e,Sr,Nr,Je,{})}}function zl(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l}function ql(s,e,t){const l=s.slice();return l[22]=e[t].key,l[23]=e[t].value,l}function Wl(s){let e,t,l=s[23]+"",n,r,o,a,i,c,d,f;function g(){return s[15](s[22])}a=new Ue({props:{icon:Ts,width:20}});function _(...h){return s[16](s[22],...h)}return{c(){e=b("li"),t=b("button"),n=Z(l),r=j(),o=b("button"),pe(a.$$.fragment),i=j(),this.h()},l(h){e=y(h,"LI",{class:!0});var v=C(e);t=y(v,"BUTTON",{class:!0});var D=C(t);n=ee(D,l),D.forEach(p),r=B(v),o=y(v,"BUTTON",{class:!0});var k=C(o);ge(a.$$.fragment,k),k.forEach(p),i=B(v),v.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),Y(t,"selected",s[22]===s[0]),m(o,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),m(e,"class","flex svelte-1okhpct")},m(h,v){K(h,e,v),u(e,t),u(t,n),u(e,r),u(e,o),ve(a,o,null),u(e,i),c=!0,d||(f=[$(t,"click",g),$(o,"click",_)],d=!0)},p(h,v){s=h,(!c||v&17)&&Y(t,"selected",s[22]===s[0])},i(h){c||(x(a.$$.fragment,h),c=!0)},o(h){W(a.$$.fragment,h),c=!1},d(h){h&&p(e),be(a),d=!1,Xe(f)}}}function Jl(s){let e,t=fe(s[3]),l=[];for(let n=0;n<t.length;n+=1)l[n]=$l(zl(s,t,n));return{c(){e=b("ul");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=y(n,"UL",{class:!0});var r=C(e);for(let o=0;o<l.length;o+=1)l[o].l(r);r.forEach(p),this.h()},h(){m(e,"class","svelte-1okhpct")},m(n,r){K(n,e,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null)},p(n,r){if(r&138){t=fe(n[3]);let o;for(o=0;o<t.length;o+=1){const a=zl(n,t,o);l[o]?l[o].p(a,r):(l[o]=$l(a),l[o].c(),l[o].m(e,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function $l(s){let e,t,l=s[23]+"",n,r,o,a;function i(){return s[17](s[22])}return{c(){e=b("li"),t=b("button"),n=Z(l),r=j(),this.h()},l(c){e=y(c,"LI",{class:!0});var d=C(e);t=y(d,"BUTTON",{class:!0});var f=C(t);n=ee(f,l),f.forEach(p),r=B(d),d.forEach(p),this.h()},h(){m(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),Y(t,"selected",s[22]===s[1]),m(e,"class","svelte-1okhpct")},m(c,d){K(c,e,d),u(e,t),u(t,n),u(e,r),o||(a=$(t,"click",i),o=!0)},p(c,d){s=c,d&8&&l!==(l=s[23]+"")&&_e(n,l),d&10&&Y(t,"selected",s[22]===s[1])},d(c){c&&p(e),o=!1,a()}}}function Lr(s){let e,t,l="Play",n,r,o,a,i,c,d,f,g,_,h="Reset",v,D,k,w,L=s[2]?"Quit":"Play",P,U,O,I,A,E=fe(s[4]),T=[];for(let V=0;V<E.length;V+=1)T[V]=Wl(ql(s,E,V));const N=V=>W(T[V],1,1,()=>{T[V]=null});let S=(s[0]==="chords-write"||s[0]==="chords-play")&&Jl(s);return d=new Dr({props:{class:"game-options"}}),k=new Ue({props:{class:"mr-1",icon:s[2]?Xs:Ts,width:20}}),{c(){e=b("fieldset"),t=b("legend"),t.textContent=l,n=j(),r=b("div"),o=b("ul");for(let V=0;V<T.length;V+=1)T[V].c();a=j(),i=b("div"),S&&S.c(),c=j(),pe(d.$$.fragment),f=j(),g=b("div"),_=b("button"),_.textContent=h,v=j(),D=b("button"),pe(k.$$.fragment),w=j(),P=Z(L),this.h()},l(V){e=y(V,"FIELDSET",{class:!0});var G=C(e);t=y(G,"LEGEND",{class:!0,"data-svelte-h":!0}),oe(t)!=="svelte-1409tnk"&&(t.textContent=l),n=B(G),r=y(G,"DIV",{class:!0});var R=C(r);o=y(R,"UL",{class:!0});var H=C(o);for(let de=0;de<T.length;de+=1)T[de].l(H);H.forEach(p),a=B(R),i=y(R,"DIV",{class:!0});var Q=C(i);S&&S.l(Q),Q.forEach(p),c=B(R),ge(d.$$.fragment,R),f=B(R),g=y(R,"DIV",{class:!0});var z=C(g);_=y(z,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(_)!=="svelte-10rv0bu"&&(_.textContent=h),v=B(z),D=y(z,"BUTTON",{class:!0});var J=C(D);ge(k.$$.fragment,J),w=B(J),P=ee(J,L),J.forEach(p),z.forEach(p),R.forEach(p),G.forEach(p),this.h()},h(){m(t,"class","px-1 text-base"),m(o,"class","games svelte-1okhpct"),m(i,"class","options svelte-1okhpct"),m(_,"class","w-full btn hover:bg-gray-200"),m(D,"class","w-full mt-2 flex items-center justify-center btn primary"),m(g,"class","h-full flex flex-col justify-end"),m(r,"class","body pb-2 h-full svelte-1okhpct"),m(e,"class",U=Ie(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(V,G){K(V,e,G),u(e,t),u(e,n),u(e,r),u(r,o);for(let R=0;R<T.length;R+=1)T[R]&&T[R].m(o,null);u(r,a),u(r,i),S&&S.m(i,null),u(r,c),ve(d,r,null),u(r,f),u(r,g),u(g,_),u(g,v),u(g,D),ve(k,D,null),u(D,w),u(D,P),O=!0,I||(A=[$(_,"click",s[8]),$(D,"click",s[9])],I=!0)},p(V,[G]){if(G&113){E=fe(V[4]);let H;for(H=0;H<E.length;H+=1){const Q=ql(V,E,H);T[H]?(T[H].p(Q,G),x(T[H],1)):(T[H]=Wl(Q),T[H].c(),x(T[H],1),T[H].m(o,null))}for(xe(),H=E.length;H<T.length;H+=1)N(H);Fe()}V[0]==="chords-write"||V[0]==="chords-play"?S?S.p(V,G):(S=Jl(V),S.c(),S.m(i,null)):S&&(S.d(1),S=null);const R={};G&4&&(R.icon=V[2]?Xs:Ts),k.$set(R),(!O||G&4)&&L!==(L=V[2]?"Quit":"Play")&&_e(P,L),(!O||G&1024&&U!==(U=Ie(`${V[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&m(e,"class",U)},i(V){if(!O){for(let G=0;G<E.length;G+=1)x(T[G]);x(d.$$.fragment,V),x(k.$$.fragment,V),O=!0}},o(V){T=T.filter(Boolean);for(let G=0;G<T.length;G+=1)W(T[G]);W(d.$$.fragment,V),W(k.$$.fragment,V),O=!1},d(V){V&&p(e),Oe(T,V),S&&S.d(),be(d),be(k),I=!1,Xe(A)}}}function Pr(s,e,t){let l,n,r,o,a,i,c;me(s,Rs,O=>t(12,o=O)),me(s,_t,O=>t(20,a=O)),me(s,ht,O=>t(13,i=O)),me(s,It,O=>t(14,c=O));const d=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let f=d[4].key,g="maj-m";a.count,a.waitSeconds,_t.subscribe(O=>{O.count,O.waitSeconds});function _(O,I){if(I==="chords-write"||I==="chords-play"||I==="chords-diatonic"){let A=[];g==="selected"?A=o.filter(E=>E.selected):g==="all"?A=o:g==="maj-m"?A=o.filter(E=>E.suffixes[0]==="maj"||E.suffixes[0]==="m"):g==="seventh"&&(A=o.filter(E=>E.suffixes[0]==="maj7"||E.suffixes[0]==="m7"||E.suffixes[0]==="7"||E.suffixes[0]==="dim7"||E.suffixes[0]==="aug7")),De.play(I,{chords:A})}else De.play(I,void 0);O.currentTarget instanceof HTMLElement&&O.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function h(O){t(0,f=O)}function v(O,I){t(0,f=I),_(O,I)}function D(O){t(1,g=O)}function k(){De.clearGame(!0)}function w(O){l?De.clearGame():_(O,f)}const L=O=>h(O),P=(O,I)=>v(I,O),U=O=>D(O);return s.$$set=O=>{t(10,e=Te(Te({},e),Ae(O)))},s.$$.update=()=>{s.$$.dirty&24576&&t(2,l=!!c&&i!=="ended"),s.$$.dirty&4096&&t(11,n=o.reduce((O,I)=>I.selected?O+1:O,0)),s.$$.dirty&2048&&t(3,r=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${n} chords`},{key:"all",value:"All"}])},e=Ae(e),[f,g,l,r,d,h,v,D,k,w,e,n,o,i,c,L,P,U]}class Or extends qe{constructor(e){super(),We(this,e,Pr,Lr,Je,{})}}function Yl(s,e,t){const l=s.slice();return l[7]=e[t],l}function Ql(s,e,t){const l=s.slice();return l[4]=e[t],l}function Vr(s){let e,t=fe(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Xl(Yl(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);K(n,e,r)},p(n,r){if(r&2){t=fe(n[1]);let o;for(o=0;o<t.length;o+=1){const a=Yl(n,t,o);l[o]?l[o].p(a,r):(l[o]=Xl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function jr(s){let e,t=fe(s[0].scaleNotes||[]),l=[];for(let n=0;n<t.length;n+=1)l[n]=Zl(Ql(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);K(n,e,r)},p(n,r){if(r&1){t=fe(n[0].scaleNotes||[]);let o;for(o=0;o<t.length;o+=1){const a=Ql(n,t,o);l[o]?l[o].p(a,r):(l[o]=Zl(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function Xl(s){let e,t=s[7].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-my4m0t")},m(n,r){K(n,e,r),u(e,l)},p(n,r){r&2&&t!==(t=n[7].interval+"")&&_e(l,t)},d(n){n&&p(e)}}}function Zl(s){let e,t=s[4].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-my4m0t")},m(n,r){K(n,e,r),u(e,l)},p(n,r){r&1&&t!==(t=n[4].note+"")&&_e(l,t)},d(n){n&&p(e)}}}function Br(s){let e,t,l,n,r,o;function a(d,f){return d[0]?jr:Vr}let i=a(s),c=i(s);return{c(){e=b("div"),t=b("button"),c.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,title:!0});var f=C(e);t=y(f,"BUTTON",{class:!0});var g=C(t);c.l(g),g.forEach(p),f.forEach(p),this.h()},h(){m(t,"class","intervals svelte-my4m0t"),m(e,"class",l=`${s[2].class||""} `),m(e,"title",n=s[1].map(en).join("-"))},m(d,f){K(d,e,f),u(e,t),c.m(t,null),r||(o=$(t,"click",s[3]),r=!0)},p(d,[f]){i===(i=a(d))&&c?c.p(d,f):(c.d(1),c=i(d),c&&(c.c(),c.m(t,null))),f&4&&l!==(l=`${d[2].class||""} `)&&m(e,"class",l),f&2&&n!==(n=d[1].map(en).join("-"))&&m(e,"title",n)},i:he,o:he,d(d){d&&p(e),c.d(),r=!1,o()}}}const en=s=>s.interval;function Gr(s,e,t){let{scale:l,intervals:n}=e;function r(o){ms.call(this,s,o)}return s.$$set=o=>{t(2,e=Te(Te({},e),Ae(o))),"scale"in o&&t(0,l=o.scale),"intervals"in o&&t(1,n=o.intervals)},e=Ae(e),[l,n,e,r]}class Vn extends qe{constructor(e){super(),We(this,e,Gr,Br,Je,{scale:0,intervals:1})}}function tn(s,e,t){const l=s.slice();return l[7]=e[t],l}function sn(s,e,t){const l=s.slice();return l[4]=e[t],l}function Mr(s){let e,t=fe(s[0]),l=[];for(let n=0;n<t.length;n+=1)l[n]=ln(tn(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);K(n,e,r)},p(n,r){if(r&1){t=fe(n[0]);let o;for(o=0;o<t.length;o+=1){const a=tn(n,t,o);l[o]?l[o].p(a,r):(l[o]=ln(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function Rr(s){let e,t=fe(s[1]),l=[];for(let n=0;n<t.length;n+=1)l[n]=nn(sn(s,t,n));return{c(){for(let n=0;n<l.length;n+=1)l[n].c();e=Pe()},l(n){for(let r=0;r<l.length;r+=1)l[r].l(n);e=Pe()},m(n,r){for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(n,r);K(n,e,r)},p(n,r){if(r&2){t=fe(n[1]);let o;for(o=0;o<t.length;o+=1){const a=sn(n,t,o);l[o]?l[o].p(a,r):(l[o]=nn(a),l[o].c(),l[o].m(e.parentNode,e))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function ln(s){let e,t,l=s[7].roman+"",n,r,o,a=s[7].suffix+"",i,c;return{c(){e=b("span"),t=b("span"),n=Z(l),r=j(),o=b("sup"),i=Z(a),c=j(),this.h()},l(d){e=y(d,"SPAN",{class:!0});var f=C(e);t=y(f,"SPAN",{class:!0});var g=C(t);n=ee(g,l),g.forEach(p),r=B(f),o=y(f,"SUP",{class:!0});var _=C(o);i=ee(_,a),_.forEach(p),c=B(f),f.forEach(p),this.h()},h(){m(t,"class","block"),m(o,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),Y(o,"super-text",s[7].suffix.length>2),m(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(d,f){K(d,e,f),u(e,t),u(t,n),u(e,r),u(e,o),u(o,i),u(e,c)},p(d,f){f&1&&l!==(l=d[7].roman+"")&&_e(n,l),f&1&&a!==(a=d[7].suffix+"")&&_e(i,a),f&1&&Y(o,"super-text",d[7].suffix.length>2)},d(d){d&&p(e)}}}function nn(s){let e,t,l=s[4]+"",n,r;return{c(){e=b("span"),t=b("span"),n=Z(l),r=j(),this.h()},l(o){e=y(o,"SPAN",{class:!0});var a=C(e);t=y(a,"SPAN",{});var i=C(t);n=ee(i,l),i.forEach(p),r=B(a),a.forEach(p),this.h()},h(){m(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(o,a){K(o,e,a),u(e,t),u(t,n),u(e,r)},p(o,a){a&2&&l!==(l=o[4]+"")&&_e(n,l)},d(o){o&&p(e)}}}function Ur(s){let e,t,l,n,r,o;function a(d,f){return d[1].length>0?Rr:Mr}let i=a(s),c=i(s);return{c(){e=b("div"),t=b("button"),c.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,title:!0});var f=C(e);t=y(f,"BUTTON",{class:!0});var g=C(t);c.l(g),g.forEach(p),f.forEach(p),this.h()},h(){m(t,"class","triads flex flex-wrap svelte-1roj1mi"),m(e,"class",l=Ie(`${s[2].class||""} `)+" svelte-1roj1mi"),m(e,"title",n=s[0].map(on).join("-"))},m(d,f){K(d,e,f),u(e,t),c.m(t,null),r||(o=$(t,"click",s[3]),r=!0)},p(d,[f]){i===(i=a(d))&&c?c.p(d,f):(c.d(1),c=i(d),c&&(c.c(),c.m(t,null))),f&4&&l!==(l=Ie(`${d[2].class||""} `)+" svelte-1roj1mi")&&m(e,"class",l),f&1&&n!==(n=d[0].map(on).join("-"))&&m(e,"title",n)},i:he,o:he,d(d){d&&p(e),c.d(),r=!1,o()}}}const on=s=>s.roman+s.suffix;function Kr(s,e,t){let{triads:l,chords:n}=e;function r(o){ms.call(this,s,o)}return s.$$set=o=>{t(2,e=Te(Te({},e),Ae(o))),"triads"in o&&t(0,l=o.triads),"chords"in o&&t(1,n=o.chords)},e=Ae(e),[l,n,e,r]}class jn extends qe{constructor(e){super(),We(this,e,Kr,Ur,Je,{triads:0,chords:1})}}function rn(s,e,t){const l=s.slice();return l[23]=e[t],l}function an(s,e,t){const l=s.slice();return l[23]=e[t],l}function cn(s){let e,t,l=s[23].raw.names[0]+"",n,r,o,a,i,c,d;function f(){return s[11](s[23])}o=new Vn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),o.$on("click",f);function g(){return s[12](s[23])}return i=new jn({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",g),{c(){e=b("li"),t=b("div"),n=Z(l),r=j(),pe(o.$$.fragment),a=j(),pe(i.$$.fragment),c=j(),this.h()},l(_){e=y(_,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);n=ee(v,l),v.forEach(p),r=B(h),ge(o.$$.fragment,h),a=B(h),ge(i.$$.fragment,h),c=B(h),h.forEach(p),this.h()},h(){m(t,"class","text-xs font-bold"),m(e,"class","svelte-4hctsl")},m(_,h){K(_,e,h),u(e,t),u(t,n),u(e,r),ve(o,e,null),u(e,a),ve(i,e,null),u(e,c),d=!0},p(_,h){s=_,(!d||h&4)&&l!==(l=s[23].raw.names[0]+"")&&_e(n,l);const v={};h&4&&(v.scale=s[23].scale),h&4&&(v.intervals=s[23].raw.intervals),o.$set(v);const D={};h&4&&(D.triads=s[23].triads),h&4&&(D.chords=s[23].triadChords),i.$set(D)},i(_){d||(x(o.$$.fragment,_),x(i.$$.fragment,_),d=!0)},o(_){W(o.$$.fragment,_),W(i.$$.fragment,_),d=!1},d(_){_&&p(e),be(o),be(i)}}}function un(s){let e,t,l=s[23].raw.names[0]+"",n,r,o,a,i,c,d;function f(){return s[13](s[23])}o=new Vn({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),o.$on("click",f);function g(){return s[14](s[23])}return i=new jn({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",g),{c(){e=b("li"),t=b("div"),n=Z(l),r=j(),pe(o.$$.fragment),a=j(),pe(i.$$.fragment),c=j(),this.h()},l(_){e=y(_,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);n=ee(v,l),v.forEach(p),r=B(h),ge(o.$$.fragment,h),a=B(h),ge(i.$$.fragment,h),c=B(h),h.forEach(p),this.h()},h(){m(t,"class","text-xs font-bold"),m(e,"class","svelte-4hctsl")},m(_,h){K(_,e,h),u(e,t),u(t,n),u(e,r),ve(o,e,null),u(e,a),ve(i,e,null),u(e,c),d=!0},p(_,h){s=_,(!d||h&2)&&l!==(l=s[23].raw.names[0]+"")&&_e(n,l);const v={};h&2&&(v.scale=s[23].scale),h&2&&(v.intervals=s[23].raw.intervals),o.$set(v);const D={};h&2&&(D.triads=s[23].triads),h&2&&(D.chords=s[23].triadChords),i.$set(D)},i(_){d||(x(o.$$.fragment,_),x(i.$$.fragment,_),d=!0)},o(_){W(o.$$.fragment,_),W(i.$$.fragment,_),d=!1},d(_){_&&p(e),be(o),be(i)}}}function xr(s){let e,t,l,n,r="Scales",o,a,i,c="Key",d,f,g,_,h,v,D,k,w,L,P,U=fe(s[2]),O=[];for(let N=0;N<U.length;N+=1)O[N]=cn(an(s,U,N));const I=N=>W(O[N],1,1,()=>{O[N]=null});let A=fe(s[1]),E=[];for(let N=0;N<A.length;N+=1)E[N]=un(rn(s,A,N));const T=N=>W(E[N],1,1,()=>{E[N]=null});return{c(){e=b("div"),t=b("fieldset"),l=b("legend"),n=b("button"),n.textContent=r,o=j(),a=b("div"),i=b("label"),i.textContent=c,d=j(),f=b("input"),g=j(),_=b("div"),h=b("ul");for(let N=0;N<O.length;N+=1)O[N].c();v=j(),D=b("ul");for(let N=0;N<E.length;N+=1)E[N].c();this.h()},l(N){e=y(N,"DIV",{class:!0});var S=C(e);t=y(S,"FIELDSET",{class:!0});var V=C(t);l=y(V,"LEGEND",{class:!0});var G=C(l);n=y(G,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(n)!=="svelte-lhx60e"&&(n.textContent=r),G.forEach(p),o=B(V),a=y(V,"DIV",{class:!0});var R=C(a);i=y(R,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(i)!=="svelte-14m38zf"&&(i.textContent=c),d=B(R),f=y(R,"INPUT",{class:!0,id:!0}),R.forEach(p),g=B(V),_=y(V,"DIV",{class:!0});var H=C(_);h=y(H,"UL",{class:!0});var Q=C(h);for(let J=0;J<O.length;J+=1)O[J].l(Q);Q.forEach(p),v=B(H),D=y(H,"UL",{class:!0});var z=C(D);for(let J=0;J<E.length;J+=1)E[J].l(z);z.forEach(p),H.forEach(p),V.forEach(p),S.forEach(p),this.h()},h(){m(n,"class","px-1 rounded hover:bg-gray-100"),m(l,"class","text-base"),m(i,"class","mr-4 font-bold"),m(i,"for","scale-key"),m(f,"class","bg-gray-100 w-16 px-1 rounded"),m(f,"id","scale-key"),f.value=s[0],m(a,"class","flex mb-2 input svelte-4hctsl"),Y(a,"hidden",s[3]),m(h,"class","list odd w-full svelte-4hctsl"),m(D,"class","list even w-full svelte-4hctsl"),m(_,"class","body max-h-[30rem] overflow-scroll svelte-4hctsl"),Y(_,"hidden",s[3]),m(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),Y(t,"collapsed",s[3]),m(e,"class",k=Ie(`${s[9].class||""}`)+" svelte-4hctsl")},m(N,S){K(N,e,S),u(e,t),u(t,l),u(l,n),u(t,o),u(t,a),u(a,i),u(a,d),u(a,f),u(t,g),u(t,_),u(_,h);for(let V=0;V<O.length;V+=1)O[V]&&O[V].m(h,null);u(_,v),u(_,D);for(let V=0;V<E.length;V+=1)E[V]&&E[V].m(D,null);w=!0,L||(P=[$(n,"click",s[5]),$(f,"input",s[6])],L=!0)},p(N,[S]){if((!w||S&1&&f.value!==N[0])&&(f.value=N[0]),(!w||S&8)&&Y(a,"hidden",N[3]),S&388){U=fe(N[2]);let V;for(V=0;V<U.length;V+=1){const G=an(N,U,V);O[V]?(O[V].p(G,S),x(O[V],1)):(O[V]=cn(G),O[V].c(),x(O[V],1),O[V].m(h,null))}for(xe(),V=U.length;V<O.length;V+=1)I(V);Fe()}if(S&386){A=fe(N[1]);let V;for(V=0;V<A.length;V+=1){const G=rn(N,A,V);E[V]?(E[V].p(G,S),x(E[V],1)):(E[V]=un(G),E[V].c(),x(E[V],1),E[V].m(D,null))}for(xe(),V=A.length;V<E.length;V+=1)T(V);Fe()}(!w||S&8)&&Y(_,"hidden",N[3]),(!w||S&8)&&Y(t,"collapsed",N[3]),(!w||S&512&&k!==(k=Ie(`${N[9].class||""}`)+" svelte-4hctsl"))&&m(e,"class",k)},i(N){if(!w){for(let S=0;S<U.length;S+=1)x(O[S]);for(let S=0;S<A.length;S+=1)x(E[S]);w=!0}},o(N){O=O.filter(Boolean);for(let S=0;S<O.length;S+=1)W(O[S]);E=E.filter(Boolean);for(let S=0;S<E.length;S+=1)W(E[S]);w=!1},d(N){N&&p(e),Oe(O,N),Oe(E,N),L=!1,Xe(P)}}}function Fr(s,e,t){let l,n,r,o,a,i,c;me(s,Mt,E=>t(17,r=E)),me(s,pt,E=>t(18,o=E)),me(s,nt,E=>t(19,a=E)),me(s,lt,E=>t(20,i=E));let f=_s().map(E=>({key:E.names[0],raw:E,scale:void 0,triads:E.triads,triadChords:[]})),g="",_=[o.key,o.scale],h;const v=gt(Ve(!0),{key:"scales-hidden"});me(s,v,E=>t(3,c=E));function D(){v.update(E=>!E)}function k({currentTarget:{value:E}}){t(0,g=`${E.charAt(0).toUpperCase()}${E.charAt(1).toLowerCase()}`),t(10,f=f.map(T=>{const N=xt(g,T.key),S=g&&"data"in N?N.data:void 0;let V=[];return S&&(V=T.triads.map((G,R)=>`${S.scaleNotes[R].note}${!G.suffix.includes("°")&&G.minor?"m":""}${G.suffix}`)),{...T,scale:S,triadChords:V}}))}function w(E,T,N){if(E<T.length){const S=T[E++];Se.setPlayed(S),i==null||i.playChord(S.map(V=>V.midi),a.fixedVelocity),h=setTimeout(()=>w(E,T,N),N)}else Se.setPlayed([]),Se.setKeyAndScale(_[0],_[1])}function L(E){clearTimeout(h);let T,N;E.scale?(N=E.scale,_=[o.key,o.scale],Se.setKeyAndScale(E.scale.key,E.scale.scale)):N=o;const S=r[0].midi+N.scaleNotes[0].semitones;T=E.raw.intervals.map(V=>[{...N.notesMap.get(V.semitones%12),midi:S+V.semitones}]),T[0][0].semitones!==T[T.length-1][0].semitones&&T.push(T[0].map(V=>({...V,midi:V.midi+12}))),w(0,T,500)}function P(E){clearTimeout(h);const{intervals:T}=E.raw;let N,S;E.scale?(S=E.scale,_=[o.key,o.scale],Se.setKeyAndScale(E.scale.key,E.scale.scale)):S=o;const V=r[0].midi+S.scaleNotes[0].semitones;N=En(E.triads).map((R,H)=>os(V+S.intervals[H].semitones,S,R.intervals)),T[T.length-1].interval_seq!==1&&N.push(N[0].map(R=>({...R,midi:R.midi+12}))),w(0,N,750)}const U=E=>L(E),O=E=>P(E),I=E=>L(E),A=E=>P(E);return s.$$set=E=>{t(9,e=Te(Te({},e),Ae(E)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,l=f.filter((E,T)=>T<f.length/2)),s.$$.dirty&1024&&t(1,n=f.filter((E,T)=>T>=f.length/2))},e=Ae(e),[g,n,l,c,v,D,k,L,P,e,f,U,O,I,A]}class Hr extends qe{constructor(e){super(),We(this,e,Fr,xr,Je,{})}}function fn(s,e,t){const l=s.slice();return l[26]=e[t],l}function dn(s,e,t){const l=s.slice();return l[29]=e[t],l}function hn(s){let e,t;return{c(){e=b("div"),t=Z(s[3]),this.h()},l(l){e=y(l,"DIV",{class:!0});var n=C(e);t=ee(n,s[3]),n.forEach(p),this.h()},h(){m(e,"class","error svelte-1u7ze7x")},m(l,n){K(l,e,n),u(e,t)},p(l,n){n[0]&8&&_e(t,l[3])},d(l){l&&p(e)}}}function mn(s){let e,t=fe(s[5]),l=[];for(let n=0;n<t.length;n+=1)l[n]=_n(dn(s,t,n));return{c(){e=b("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=y(n,"DIV",{class:!0});var r=C(e);for(let o=0;o<l.length;o+=1)l[o].l(r);r.forEach(p),this.h()},h(){m(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){K(n,e,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null)},p(n,r){if(r[0]&32){t=fe(n[5]);let o;for(o=0;o<t.length;o+=1){const a=dn(n,t,o);l[o]?l[o].p(a,r):(l[o]=_n(a),l[o].c(),l[o].m(e,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function _n(s){let e,t=s[29].interval+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1u7ze7x")},m(n,r){K(n,e,r),u(e,l)},p(n,r){r[0]&32&&t!==(t=n[29].interval+"")&&_e(l,t)},d(n){n&&p(e)}}}function pn(s){let e,t=fe(s[8].scaleNotes),l=[];for(let n=0;n<t.length;n+=1)l[n]=gn(fn(s,t,n));return{c(){e=b("div");for(let n=0;n<l.length;n+=1)l[n].c();this.h()},l(n){e=y(n,"DIV",{class:!0});var r=C(e);for(let o=0;o<l.length;o+=1)l[o].l(r);r.forEach(p),this.h()},h(){m(e,"class","intervals my-1 svelte-1u7ze7x")},m(n,r){K(n,e,r);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(e,null)},p(n,r){if(r[0]&256){t=fe(n[8].scaleNotes);let o;for(o=0;o<t.length;o+=1){const a=fn(n,t,o);l[o]?l[o].p(a,r):(l[o]=gn(a),l[o].c(),l[o].m(e,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=t.length}},d(n){n&&p(e),Oe(l,n)}}}function gn(s){let e,t=s[26].note+"",l;return{c(){e=b("span"),l=Z(t),this.h()},l(n){e=y(n,"SPAN",{class:!0});var r=C(e);l=ee(r,t),r.forEach(p),this.h()},h(){m(e,"class","svelte-1u7ze7x")},m(n,r){K(n,e,r),u(e,l)},p(n,r){r[0]&256&&t!==(t=n[26].note+"")&&_e(l,t)},d(n){n&&p(e)}}}function zr(s){let e,t,l,n="Score",r,o,a,i,c,d,f,g="Range",_,h,v,D,k,w="—",L,P,U,O,I,A,E,T="Scale",N,S,V,G,R,H,Q,z="Key",J,de,M,re,F,te,ae,Le;a=new Ue({props:{icon:zt,width:16}});let ie=s[3]&&hn(s);V=new bn({props:{class:"p-1 pl-[2px] w-48",containerClass:"w-48",selected:s[0],options:s[10],onSelect:s[14]}});let ye=!s[7]&&mn(s),X=!s[7]&&pn(s);return{c(){e=b("fieldset"),t=b("legend"),l=b("button"),l.textContent=n,r=j(),o=b("button"),pe(a.$$.fragment),i=j(),c=b("div"),d=b("div"),f=b("label"),f.textContent=g,_=j(),h=b("div"),v=b("input"),D=j(),k=b("span"),k.textContent=w,L=j(),P=b("input"),U=j(),O=b("div"),ie&&ie.c(),I=j(),A=b("div"),E=b("label"),E.textContent=T,N=j(),S=b("div"),pe(V.$$.fragment),G=j(),ye&&ye.c(),R=j(),H=b("div"),Q=b("label"),Q.textContent=z,J=j(),de=b("div"),M=b("input"),re=j(),X&&X.c(),this.h()},l(ce){e=y(ce,"FIELDSET",{class:!0});var we=C(e);t=y(we,"LEGEND",{class:!0});var ue=C(t);l=y(ue,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(l)!=="svelte-lqyol"&&(l.textContent=n),ue.forEach(p),r=B(we),o=y(we,"BUTTON",{class:!0});var He=C(o);ge(a.$$.fragment,He),He.forEach(p),i=B(we),c=y(we,"DIV",{class:!0});var q=C(c);d=y(q,"DIV",{class:!0});var ne=C(d);f=y(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(f)!=="svelte-10u0679"&&(f.textContent=g),_=B(ne),h=y(ne,"DIV",{class:!0});var ke=C(h);v=y(ke,"INPUT",{class:!0,id:!0}),D=B(ke),k=y(ke,"SPAN",{class:!0,"data-svelte-h":!0}),oe(k)!=="svelte-8q1xz4"&&(k.textContent=w),L=B(ke),P=y(ke,"INPUT",{class:!0,id:!0}),ke.forEach(p),U=B(ne),O=y(ne,"DIV",{class:!0});var tt=C(O);ie&&ie.l(tt),tt.forEach(p),ne.forEach(p),I=B(q),A=y(q,"DIV",{class:!0});var le=C(A);E=y(le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(E)!=="svelte-ld2d07"&&(E.textContent=T),N=B(le),S=y(le,"DIV",{class:!0});var je=C(S);ge(V.$$.fragment,je),je.forEach(p),G=B(le),ye&&ye.l(le),le.forEach(p),R=B(q),H=y(q,"DIV",{class:!0});var Me=C(H);Q=y(Me,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),oe(Q)!=="svelte-17pcm6g"&&(Q.textContent=z),J=B(Me),de=y(Me,"DIV",{class:!0});var vt=C(de);M=y(vt,"INPUT",{class:!0,id:!0}),vt.forEach(p),re=B(Me),X&&X.l(Me),Me.forEach(p),q.forEach(p),we.forEach(p),this.h()},h(){m(l,"class","px-1 rounded hover:bg-gray-100"),m(t,"class","text-base"),m(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),Y(o,"hidden",s[6]),m(f,"class","font-bold"),m(f,"for","range_min"),m(v,"class","h-[28px] w-full"),m(v,"id","range_min"),m(k,"class","mx-2 mt-1"),m(P,"class","h-[28px] w-full"),m(P,"id","range_max"),m(h,"class","my-1 flex w-full"),m(O,"class","flex justify-between my-1"),m(d,"class","flex flex-col h-full"),m(E,"class","font-bold"),m(E,"for","scales"),m(S,"class","my-1 w-full"),m(A,"class","flex flex-col h-full"),m(Q,"class","font-bold"),m(Q,"for","key"),m(M,"class","h-[28px]"),m(M,"id","key"),m(de,"class","my-1 flex"),m(H,"class","flex flex-col h-full"),m(c,"class","options svelte-1u7ze7x"),Y(c,"hidden",s[6]),m(e,"class",F=Ie(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),Y(e,"collapsed",s[6])},m(ce,we){K(ce,e,we),u(e,t),u(t,l),u(e,r),u(e,o),ve(a,o,null),u(e,i),u(e,c),u(c,d),u(d,f),u(d,_),u(d,h),u(h,v),et(v,s[1]),u(h,D),u(h,k),u(h,L),u(h,P),et(P,s[2]),u(d,U),u(d,O),ie&&ie.m(O,null),u(c,I),u(c,A),u(A,E),u(A,N),u(A,S),ve(V,S,null),u(A,G),ye&&ye.m(A,null),u(c,R),u(c,H),u(H,Q),u(H,J),u(H,de),u(de,M),et(M,s[4]),u(H,re),X&&X.m(H,null),te=!0,ae||(Le=[$(l,"click",s[15]),$(o,"click",s[16]),$(v,"input",s[18]),$(v,"change",s[19]),$(v,"focus",s[12]),$(P,"input",s[20]),$(P,"change",s[21]),$(P,"focus",s[12]),$(M,"input",s[22]),$(M,"input",s[13])],ae=!0)},p(ce,we){(!te||we[0]&64)&&Y(o,"hidden",ce[6]),we[0]&2&&v.value!==ce[1]&&et(v,ce[1]),we[0]&4&&P.value!==ce[2]&&et(P,ce[2]),ce[3]?ie?ie.p(ce,we):(ie=hn(ce),ie.c(),ie.m(O,null)):ie&&(ie.d(1),ie=null);const ue={};we[0]&1&&(ue.selected=ce[0]),V.$set(ue),ce[7]?ye&&(ye.d(1),ye=null):ye?ye.p(ce,we):(ye=mn(ce),ye.c(),ye.m(A,null)),we[0]&16&&M.value!==ce[4]&&et(M,ce[4]),ce[7]?X&&(X.d(1),X=null):X?X.p(ce,we):(X=pn(ce),X.c(),X.m(H,null)),(!te||we[0]&64)&&Y(c,"hidden",ce[6]),(!te||we[0]&131072&&F!==(F=Ie(`${ce[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&m(e,"class",F),(!te||we[0]&131136)&&Y(e,"collapsed",ce[6])},i(ce){te||(x(a.$$.fragment,ce),x(V.$$.fragment,ce),te=!0)},o(ce){W(a.$$.fragment,ce),W(V.$$.fragment,ce),te=!1},d(ce){ce&&p(e),be(a),ie&&ie.d(),be(V),ye&&ye.d(),X&&X.d(),ae=!1,Xe(Le)}}}function qr(s,e,t){let l,n,r,o,a,i;me(s,Mt,S=>t(23,n=S)),me(s,At,S=>t(24,r=S)),me(s,It,S=>t(7,a=S)),me(s,pt,S=>t(8,i=S));let c=dt(n[0]),d=dt(n[1]),f="";const g=gt(Ve(!1),{key:"score-options-hidden"});me(s,g,S=>t(6,o=S));let _=r[0],h=r[1];const v=_s(),D=v.map(S=>({key:S.names[0],value:S.names[0]}));Mt.subscribe(S=>{t(1,c=dt(S[0])),t(2,d=dt(S[1]))}),At.subscribe(S=>{t(4,_=S[0]),t(0,h=S[1])});function k(S,V){const G=oo(V.currentTarget.value,!0,!0);if("data"in G){const{midi:R}=G.data,H=n,Q=[S==="min"?R:H[0].midi,S==="max"?R:H[1].midi];Be.setMidiRange(Q),t(3,f="")}else t(3,f=G.err),S==="min"?t(1,c=dt(n[0])):t(2,d=dt(n[1]))}function w(){t(3,f="")}function L({currentTarget:{value:S}}){t(4,_=`${S.charAt(0).toUpperCase()}${S.charAt(1).toLowerCase()}`),Se.setKey(_)}function P(S){var V;return t(0,h=(V=D.find(G=>S===G.key))==null?void 0:V.value),Se.setScale(h),!1}function U(){g.update(S=>!S)}function O(){Se.clearScore(!0),Be.setMidiRange([60,84])}function I(){c=this.value,t(1,c)}const A=S=>k("min",S);function E(){d=this.value,t(2,d)}const T=S=>k("max",S);function N(){_=this.value,t(4,_)}return s.$$set=S=>{t(17,e=Te(Te({},e),Ae(S)))},s.$$.update=()=>{var S;s.$$.dirty[0]&1&&t(5,l=((S=v.find(V=>V.names[0]===h))==null?void 0:S.intervals)||[])},e=Ae(e),[h,c,d,f,_,l,o,a,i,g,D,k,w,L,P,U,O,e,I,A,E,T,N]}class Wr extends qe{constructor(e){super(),We(this,e,qr,zr,Je,{},null,[-1,-1])}}function Jr(s){s[21]=s[22].default}function $r(s){return{c:he,l:he,m:he,i:he,o:he,d:he}}function Yr(s){Jr(s);let e,t,l;var n=s[21];function r(o,a){return{props:{class:"mx-4 md:mx-0"}}}return n&&(e=Mn(n,r())),{c(){e&&pe(e.$$.fragment),t=Pe()},l(o){e&&ge(e.$$.fragment,o),t=Pe()},m(o,a){e&&ve(e,o,a),K(o,t,a),l=!0},i(o){l||(e&&x(e.$$.fragment,o),l=!0)},o(o){e&&W(e.$$.fragment,o),l=!1},d(o){o&&p(t),e&&be(e,o)}}}function Qr(s){let e;return{c(){e=Z(" ")},l(t){e=ee(t," ")},m(t,l){K(t,e,l)},i:he,o:he,d(t){t&&p(e)}}}function Xr(s){let e,t,l="MIDI Note Trainer",n,r,o,a,i,c,d,f="Introduction",g,_,h,v,D,k,w,L,P,U,O,I,A,E,T,N,S,V,G,R,H;a=new Ue({props:{icon:zt,width:24}}),h=new yr({}),D=new Hr({}),w=new Do({}),U=new Wr({props:{class:"score-options mr-4"}}),I=new Or({props:{class:"play-form"}});let Q={ctx:s,current:null,token:null,hasCatch:!1,pending:Qr,then:Yr,catch:$r,value:22,blocks:[,,,]};return Gn(Ce(()=>import("./Score.d3e25df0.js"),["./Score.d3e25df0.js","./vendor_svelte.0a361f11.js","./vendor.e9b0235c.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),Q),N=new Ar({props:{class:"min-h-32",debounced:!!s[0]}}),N.$on("guessed-chord",s[2]),N.$on("guessed-key",s[3]),N.$on("guessed-note",s[4]),V=new Fo({props:{game:s[1]}}),{c(){e=b("h1"),t=b("a"),t.textContent=l,n=j(),r=b("div"),o=b("button"),pe(a.$$.fragment),i=j(),c=b("div"),d=b("button"),d.textContent=f,g=j(),_=b("section"),pe(h.$$.fragment),v=j(),pe(D.$$.fragment),k=j(),pe(w.$$.fragment),L=j(),P=b("div"),pe(U.$$.fragment),O=j(),pe(I.$$.fragment),A=j(),Q.block.c(),E=j(),T=b("section"),pe(N.$$.fragment),S=j(),pe(V.$$.fragment),this.h()},l(z){e=y(z,"H1",{class:!0});var J=C(e);t=y(J,"A",{class:!0,href:!0,"data-svelte-h":!0}),oe(t)!=="svelte-km4jns"&&(t.textContent=l),n=B(J),r=y(J,"DIV",{class:!0});var de=C(r);o=y(de,"BUTTON",{class:!0});var M=C(o);ge(a.$$.fragment,M),M.forEach(p),de.forEach(p),J.forEach(p),i=B(z),c=y(z,"DIV",{class:!0});var re=C(c);d=y(re,"BUTTON",{class:!0,"data-svelte-h":!0}),oe(d)!=="svelte-f34gar"&&(d.textContent=f),re.forEach(p),g=B(z),_=y(z,"SECTION",{class:!0});var F=C(_);ge(h.$$.fragment,F),v=B(F),ge(D.$$.fragment,F),k=B(F),ge(w.$$.fragment,F),L=B(F),P=y(F,"DIV",{class:!0});var te=C(P);ge(U.$$.fragment,te),O=B(te),ge(I.$$.fragment,te),te.forEach(p),F.forEach(p),A=B(z),Q.block.l(z),E=B(z),T=y(z,"SECTION",{class:!0});var ae=C(T);ge(N.$$.fragment,ae),S=B(ae),ge(V.$$.fragment,ae),ae.forEach(p),this.h()},h(){m(t,"class","hover:underline"),m(t,"href","https://github.com/TeemuKoivisto/midi-note-trainer"),m(o,"class","rounded p-2 hover:bg-gray-200"),m(r,"class","flex items-center justify-center"),m(e,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight flex items-center justify-between"),m(d,"class","btn-pill border-2 border-gray-300 hover:bg-gray-200"),m(c,"class","px-4 md:px-0"),m(P,"class","play svelte-qjpqy3"),m(_,"class","mx-4 md:mx-0"),m(T,"class","mb-8 ml-16 flex flex-col")},m(z,J){K(z,e,J),u(e,t),u(e,n),u(e,r),u(r,o),ve(a,o,null),K(z,i,J),K(z,c,J),u(c,d),K(z,g,J),K(z,_,J),ve(h,_,null),u(_,v),ve(D,_,null),u(_,k),ve(w,_,null),u(_,L),u(_,P),ve(U,P,null),u(P,O),ve(I,P,null),K(z,A,J),Q.block.m(z,Q.anchor=J),Q.mount=()=>E.parentNode,Q.anchor=E,K(z,E,J),K(z,T,J),ve(N,T,null),u(T,S),ve(V,T,null),G=!0,R||(H=[$(o,"click",s[5]),$(d,"click",s[6])],R=!0)},p(z,[J]){s=z;const de={};J&1&&(de.debounced=!!s[0]),N.$set(de);const M={};J&2&&(M.game=s[1]),V.$set(M)},i(z){G||(x(a.$$.fragment,z),x(h.$$.fragment,z),x(D.$$.fragment,z),x(w.$$.fragment,z),x(U.$$.fragment,z),x(I.$$.fragment,z),x(Q.block),x(N.$$.fragment,z),x(V.$$.fragment,z),G=!0)},o(z){W(a.$$.fragment,z),W(h.$$.fragment,z),W(D.$$.fragment,z),W(w.$$.fragment,z),W(U.$$.fragment,z),W(I.$$.fragment,z);for(let J=0;J<3;J+=1){const de=Q.blocks[J];W(de)}W(N.$$.fragment,z),W(V.$$.fragment,z),G=!1},d(z){z&&(p(e),p(i),p(c),p(g),p(_),p(A),p(E),p(T)),be(a),be(h),be(D),be(w),be(U),be(I),Q.block.d(z),Q.token=null,Q=null,be(N),be(V),R=!1,Xe(H)}}}function Zr(s,e,t){let l,n,r,o,a,i;me(s,ht,I=>t(9,l=I)),me(s,It,I=>t(1,n=I)),me(s,_t,I=>t(10,r=I)),me(s,nt,I=>t(11,o=I)),me(s,lt,I=>t(12,a=I)),me(s,Ns,I=>t(13,i=I));let c,d;vn(()=>(i&&P(),window.addEventListener("keydown",f),window.addEventListener("mousedown",f),window.addEventListener("touchstart",f),()=>{window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)})),hs.subscribe(I=>{I&&I.channels[1].addListener("noteon",g)});function f(){Be.initAudio(),window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)}function g(I){if(c)return;const A=I.rawData;_(A[1],A[2])}function _(I,A){const E=n;E instanceof jt&&!(E!=null&&E.ended)&&l==="waiting"?D(I):E instanceof mt&&!(E!=null&&E.ended)&&l==="waiting"?(E.addPlayedNote(I),d||(d=setTimeout(v,2e3))):E||Se.pushPlayed(I),a&&a.noteOn(I,o.fixedVelocity??A)}function h(){r.autoplay&&r.waitSeconds>0?t(0,c=setTimeout(()=>{r.autoplay&&De.nextGuess(),t(0,c=void 0)},r.waitSeconds*1e3)):r.autoplay?De.nextGuess():t(0,c=void 0)}function v(){var A;const I=n;if(I instanceof mt){const E=I.guess();Se.setPlayed(((A=I.latestGuess.guessed)==null?void 0:A.notes)||[],E,-1),De.updateState(E?"correct":"wrong"),h()}d=void 0}function D(I){const A=n;if(A instanceof jt&&l==="waiting"){Se.setTarget([Se.getNote(A.current)]);const E=A.guess(I);De.updateState(E?"correct":"wrong"),Se.pushPlayed(I,E,4e3),h()}}function k(I){const A=n;if(A instanceof mt&&l==="waiting"){const E=A.guessWrittenChord(I.detail);De.updateState(E?"correct":"wrong"),h()}}function w(I){const A=n;if(A instanceof Ft&&l==="waiting"){const E=I.detail.replaceAll("♭","b").replaceAll("♯","#"),T=A.guess(E);De.updateState(T?"correct":"wrong"),h()}}function L(I){const A=it.findNote(I.detail.note)??Gs(I.detail.note);A&&_(A.semitones+12+I.detail.octave*12,80)}async function P(){const I=await Be.openMidi();"data"in I?I.data.name:(I.err,console.error(I.err))}function U(){fo(),window.location.reload()}return[c,n,k,w,L,U,()=>xn.open("introduction",void 0)]}class na extends qe{constructor(e){super(),We(this,e,Zr,Xr,Je,{})}}export{ol as F,mt as G,na as P,Yn as S,jt as a,De as b,It as c,wt as d,ds as e,ht as g,lt as p,pt as s,cl as t};
