import{_ as Ce}from"./preload-helper.a4192956.js";import{S as Ke,i as xe,s as Fe,T as Ie,e as v,b as O,g as b,h as T,f as P,j as _,a0 as Ht,Q as W,k as p,a1 as Ne,l as M,n as u,a2 as Ze,y as Y,t as U,K as ze,q as H,C as He,X as qe,U as Ae,c as js,a3 as _e,u as Bs,o as Gs,p as Ms,Y as cs,Z as Ct,_ as us,a4 as fs,a5 as Ve,B as Le,N as gs,G as ee,H as te,z as ge,P as Me,a as ue,d as fe,m as de,r as he,v as Te,V as Wt,w as Oe,x as ae,R as be,I as ye,a6 as pl,a7 as jt,A as gl,a8 as jl,a9 as ds,aa as Bl,O as Gl}from"./vendor_svelte.d5c29075.js";import{w as Ts,c as Ml,e as $l,f as Ws,g as Js,h as Jt,i as hs,j as ms,k as Bt,l as Gt,m as Rl,a as Ys,n as Ss}from"./vendor.e9b0235c.js";import{G as Ul}from"./config.844a564f.js";import{a as Kl}from"./modal.7e868971.js";function Qs(s,e,t){const n=s.slice();return n[22]=e[t].key,n[23]=e[t].value,n[24]=e[t].icon,n[26]=t,n}const xl=s=>({}),Xs=s=>({});function Zs(s){let e,t,n,l,o,r,a,c,i,d;const f=s[15].header,g=js(f,s,s[14],Xs);let m=_e(s[4]),h=[];for(let w=0;w<m.length;w+=1)h[w]=tn(Qs(s,m,w));const y=w=>H(h[w],1,1,()=>{h[w]=null});return{c(){e=v("button"),n=O(),l=v("ul"),o=v("li"),g&&g.c(),r=O();for(let w=0;w<h.length;w+=1)h[w].c();this.h()},l(w){e=b(w,"BUTTON",{class:!0,tabindex:!0}),T(e).forEach(_),n=P(w),l=b(w,"UL",{class:!0});var k=T(l);o=b(k,"LI",{});var C=T(o);g&&g.l(C),C.forEach(_),r=P(k);for(let B=0;B<h.length;B+=1)h[B].l(k);k.forEach(_),this.h()},h(){p(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),p(e,"tabindex","-1"),p(l,"class",Ne("items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl width")+" svelte-13810m9")},m(w,k){M(w,e,k),M(w,n,k),M(w,l,k),u(l,o),g&&g.m(o,null),u(l,r);for(let C=0;C<h.length;C+=1)h[C]&&h[C].m(l,null);c=!0,i||(d=Y(e,"click",s[11]),i=!0)},p(w,k){if(s=w,g&&g.p&&(!c||k&16384)&&Bs(g,f,s,s[14],c?Ms(f,s[14],k,xl):Gs(s[14]),Xs),k&8760){m=_e(s[4]);let C;for(C=0;C<m.length;C+=1){const B=Qs(s,m,C);h[C]?(h[C].p(B,k),U(h[C],1)):(h[C]=tn(B),h[C].c(),U(h[C],1),h[C].m(l,null))}for(ze(),C=m.length;C<h.length;C+=1)y(C);He()}},i(w){if(!c){w&&cs(()=>{c&&(t||(t=Ct(e,us,{duration:os},!0)),t.run(1))}),U(g,w);for(let k=0;k<m.length;k+=1)U(h[k]);w&&cs(()=>{c&&(a||(a=Ct(l,fs,{duration:os},!0)),a.run(1))}),c=!0}},o(w){w&&(t||(t=Ct(e,us,{duration:os},!1)),t.run(0)),H(g,w),h=h.filter(Boolean);for(let k=0;k<h.length;k+=1)H(h[k]);w&&(a||(a=Ct(l,fs,{duration:os},!1)),a.run(0)),c=!1},d(w){w&&(_(e),_(n),_(l)),w&&t&&t.end(),g&&g.d(w),Ve(h,w),w&&a&&a.end(),i=!1,d()}}}function en(s){let e,t,n,l,o,r,a=s[23]+"",c,i,d,f,g;const m=[zl,Fl],h=[];function y(k,C){return k[24]?0:1}n=y(s),l=h[n]=m[n](s);function w(){return s[18](s[22])}return{c(){e=v("li"),t=v("button"),l.c(),o=O(),r=v("div"),c=ee(a),i=O(),this.h()},l(k){e=b(k,"LI",{});var C=T(e);t=b(C,"BUTTON",{class:!0});var B=T(t);l.l(B),o=P(B),r=b(B,"DIV",{});var D=T(r);c=te(D,a),D.forEach(_),B.forEach(_),i=P(C),C.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-13810m9"),W(t,"selected",s[22]===s[5])},m(k,C){M(k,e,C),u(e,t),h[n].m(t,null),u(t,o),u(t,r),u(r,c),u(e,i),d=!0,f||(g=[Y(t,"click",w),Y(t,"blur",s[9])],f=!0)},p(k,C){s=k,l.p(s,C)},i(k){d||(U(l),d=!0)},o(k){H(l),d=!1},d(k){k&&_(e),h[n].d(),f=!1,qe(g)}}}function Fl(s){let e;return{c(){e=v("div"),this.h()},l(t){e=b(t,"DIV",{class:!0}),T(e).forEach(_),this.h()},h(){p(e,"class","w-[24px]")},m(t,n){M(t,e,n)},p:ge,i:ge,o:ge,d(t){t&&_(e)}}}function zl(s){let e,t;return e=new Me({props:{class:"mr-2",icon:s[24],width:16}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p:ge,i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function tn(s){let e,t,n=!s[3][s[26]]&&en(s);return{c(){n&&n.c(),e=Le()},l(l){n&&n.l(l),e=Le()},m(l,o){n&&n.m(l,o),M(l,e,o),t=!0},p(l,o){l[3][l[26]]?n&&(ze(),H(n,1,1,()=>{n=null}),He()):n?(n.p(l,o),o&8&&U(n,1)):(n=en(l),n.c(),U(n,1),n.m(e.parentNode,e))},i(l){t||(U(n),t=!0)},o(l){H(n),t=!1},d(l){l&&_(e),n&&n.d(l)}}}function Hl(s){let e,t,n,l,o,r,a=[{class:`${s[7]||""} open-btn text-justify text-sm rounded`},s[8]],c={};for(let d=0;d<a.length;d+=1)c=Ie(c,a[d]);let i=s[1]&&Zs(s);return{c(){e=v("div"),t=v("input"),n=O(),i&&i.c(),this.h()},l(d){e=b(d,"DIV",{class:!0});var f=T(e);t=b(f,"INPUT",{class:!0}),n=P(f),i&&i.l(f),f.forEach(_),this.h()},h(){Ht(t,c),W(t,"open",s[1]),W(t,"svelte-13810m9",!0),p(e,"class",Ne(`search-dropdown relative width ${s[6]||""}`)+" svelte-13810m9")},m(d,f){M(d,e,f),u(e,t),t.autofocus&&t.focus(),Ze(t,s[2]),u(e,n),i&&i.m(e,null),s[19](e),l=!0,o||(r=[Y(t,"input",s[16]),Y(t,"focus",s[17]),Y(t,"input",s[10]),Y(t,"keydown",s[12])],o=!0)},p(d,[f]){f&4&&t.value!==d[2]&&Ze(t,d[2]),(!l||f&2)&&W(t,"open",d[1]),W(t,"svelte-13810m9",!0),d[1]?i?(i.p(d,f),f&2&&U(i,1)):(i=Zs(d),i.c(),U(i,1),i.m(e,null)):i&&(ze(),H(i,1,1,()=>{i=null}),He())},i(d){l||(U(i),l=!0)},o(d){H(i),l=!1},d(d){d&&_(e),i&&i.d(),s[19](null),o=!1,qe(r)}}}const os=400;function ql(s,e,t){let{$$slots:n={},$$scope:l}=e;const{options:o,selected:r,containerClass:a,onSelect:c,class:i,...d}=e;let f,g=!1,m=r,h=o.map(N=>!1);function y(N){t(1,g=f.contains(N.relatedTarget))}function w(N){t(3,h=o.map(I=>!I.value.toLowerCase().includes(N.currentTarget.value.toLowerCase())))}function k(){t(2,m=r),t(1,g=!1),t(3,h=o.map(N=>!1))}function C(N){if(N.key==="Enter"){const I=h.findIndex(L=>!L);m===r?k():I>-1&&t(1,g=c(o[I].key)),g||(t(3,h=o.map(L=>!1)),N.currentTarget instanceof HTMLElement&&N.currentTarget.blur())}else N.key==="Escape"&&(k(),N.currentTarget instanceof HTMLElement&&N.currentTarget.blur())}function B(N){t(1,g=c(N))}function D(){m=this.value,t(2,m)}const $=()=>t(1,g=!0),E=N=>B(N);function j(N){gs[N?"unshift":"push"](()=>{f=N,t(0,f)})}return s.$$set=N=>{t(21,e=Ie(Ie({},e),Ae(N))),"$$scope"in N&&t(14,l=N.$$scope)},t(2,m=r),t(3,h=o.map(N=>!1)),e=Ae(e),[f,g,m,h,o,r,a,i,d,y,w,k,C,B,l,n,D,$,E,j]}class vl extends Ke{constructor(e){super(),xe(this,e,ql,Hl,Fe,{})}}const sn={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Xe(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:bl(s,e,t),flats:e,sharps:t}}function bl(s,e,t){return(s<8?sn[s]:sn[s%7])-e+t+Math.floor(s/8)*12}function yl(s){let e,t=0,n=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(n=Math.floor(s/100),e=s%100):e=s;const l=bl(e,t,n);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(n)}`,interval_seq:e,semitones:l,flats:t,sharps:n}}const Wl=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6","△6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9","△6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7","△7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9","△9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11","△11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13","△13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let Is=[];function kl(){return Wl.map(s=>{const e=s[3].map(yl);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function xt(s){Is.length===0&&(Is=kl());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return Is.find(t=>t.suffixes.find(n=>n===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function Jl(s,e,t){let n=e<0?s.flats-e:s.flats,l=e>0?s.sharps+e:s.sharps;if(n>0&&l>0){const r=Math.min(n,l);n-=r,l-=r}const o=(s.semitones+e)%12;return{...s,semitones:o<0?o+12:o,note:`${s.note.charAt(0)}${"♭".repeat(n)}${"♯".repeat(l)}`,flats:n,sharps:l,midi:t}}function is(s,e,t){const n=[];for(let l=0;l<t.length;l+=1){const o=t[l],r=s+o.semitones,a=e.scaleNotes.find(g=>g.semitones===r%12),c=o.flats>0,i=o.sharps>0,d=(c?r+1:i?r-1:r)%12,f=c?-1:i?1:0;n.push(Jl(a??e.notesMap.get(d),a?0:f,r))}return n}const nn=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],Yl=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],ln=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Ql(s){let e=0,t=0;for(let n=0;n<nn.length;n+=1){const l=s.find(r=>r.note.slice(0,2)===nn[n]),o=s.find(r=>r.note.slice(0,2)===Yl[n]);if(l)e+=1;else if(o)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:ln.get(e*-1)}:{flats:0,sharps:t,majorSignature:ln.get(t)}}function Xl(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function wl(s){return s.map(e=>{const t=[Xe(1)];let n;return e.major?(t.push(Xe(3)),e.suffix.startsWith("+")?t.push(Xe(5,0,1)):e.suffix.startsWith("6")?t.push(Xe(6)):e.suffix.startsWith("7")?t.push(Xe(7,1)):e.suffix.startsWith("maj7")?t.push(Xe(7)):n=xt("maj")):e.minor?(t.push(Xe(3,1)),e.suffix.startsWith("°")?t.push(Xe(5,1)):e.suffix.startsWith("6")?(t.push(Xe(6)),n=xt("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Xe(7,1)),n=xt("m"+e.suffix)):n=xt("m")):e.suffix.startsWith("sus2")?t.push(Xe(2)):e.suffix.startsWith("sus4")&&t.push(Xe(4)),t.length<=2&&t.push(Xe(5)),t.length<=2&&t.push(Xe(8)),n||(n=xt(e.suffix)),{...n,intervals:t}})}function Zl(s,e){let t=e.has(4)&&e.has(7),n=e.has(3)&&e.has(7);const l=Xl(s);let o="";return t||n||(e.has(3)&&e.has(6)?(o="°",n=!0):e.has(4)&&e.has(8)?(o="+",t=!0):e.has(3)&&e.has(10)?(n=!0,o="7"):e.has(4)&&e.has(10)?(o="7",t=!0):e.has(4)&&e.has(11)?(o="maj7",t=!0):e.has(3)&&e.has(8)?(o="6",n=!0):e.has(4)&&e.has(9)?(o="6",t=!0):e.has(2)?o="sus2":e.has(5)?o="sus4":e.has(7)?o="5":o="?"),{degree:s,roman:n?l.toLowerCase():l,suffix:o,major:t,minor:n,semitones:e}}function er(s){const e=s.length;return s.map((t,n)=>{const l=t.semitones,o=new Set;for(let r=1;r<e;r+=1){const a=s[(n+r)%e].semitones,c=a<=l?a+12-l:a-l;o.add(c)}return Zl(t.interval_seq,o)})}const tr=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let As=[];function vs(){return tr.map(s=>{const e=s[0],t=s[1].map(yl),n=er(t);return{names:e,intervals:t,triads:n}})}function sr(s){As.length===0&&(As=vs());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return As.find(t=>t.names.find(n=>n.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const nr=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,lr=/^[0-9]$/,at=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function _s(s){const e=s.midi+s.flats-s.sharps;return e===12?1:Math.floor((e-12)/12)}function ht(s){return`${s.note}${_s(s)}`}function rn(s){const t=(s-12)%12;return{...at[t],semitones:t,midi:s}}function rr(s,e=!0,t=!1){if(e&&!nr.test(s))return{err:`Unrecognized note "${s}"`,code:400};const n=s.trim(),l=n.charAt(0).toUpperCase(),o=at.find(f=>f.note.charAt(0)===l&&f.note.length===1);if(!o)return{err:`Unable to find note ${n}`,code:500};const r=n.slice(1).split("").reduce((f,g)=>f+(g.toLowerCase()==="b"||g==="♭"?-1:g==="#"||g==="♯"?1:0),0);let a;if(lr.test(n.charAt(n.length-1)))try{a=parseInt(n.charAt(n.length-1),10)}catch{}if(t&&a===void 0)return{err:`No octave provided: ${s}`,code:400};a===void 0&&(a=0);let c=(o.semitones+r)%12;c=c<0?c+12:c;const i=r<0?-r:0,d=r>0?r:0;return{data:{note:`${l}${"♭".repeat(i)}${"♯".repeat(d)}`,semitones:c,midi:12+a*12+c,flats:i,sharps:d}}}function $s(s){const e=at.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((l,o)=>l+(o.toLowerCase()==="b"||o==="♭"?-1:o==="#"||o==="♯"?1:0),0),n=(e.semitones+t)%12;return{note:s,semitones:n<0?n+12:n,flats:t<0?-t:0,sharps:t>0?t:0}}}const or=/^[a-gA-G][♭b#♯]?$/,Ns="ABCDEFG";function ar(s,e){return e.map(t=>Ns.charAt((Ns.indexOf(s)+t.interval_seq-1)%Ns.length))}function ir(s,e,t){return t.map((n,l)=>{const o=e[l],r=(s+n.semitones)%12,a=at[r],c=a.note.charAt(0);if(c<o&&(c!=="A"||o!=="G")||c==="G"&&o==="A"){let i=1,d=at[(r+i)%12];for(;d.note.charAt(0)!==o;)i+=1,d=at[(r+i)%12];return{semitones:r,note:d.note+"♭".repeat(i),flats:i+(d.note.includes("♭")?1:0),sharps:0}}else if(c>o||c==="A"&&o==="G"){let i=1,d=r===0?at.length-1:r-i,f=at[d];for(;f.note.charAt(0)!==o;)i+=1,d=d===0?at.length-1:d-1,f=at[d];return{semitones:r,note:f.note+"♯".repeat(i),flats:0,sharps:i+(f.note.includes("♯")?1:0)}}else return{semitones:r,note:a.note,flats:a.flats,sharps:a.sharps}})}function zt(s,e){if(!or.test(s))return{err:`Unknown key: ${s}`,code:400};const t=sr(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const n=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,l=$s(n);if(!l)return{err:`Unable to find root for note: ${n}`,code:404};const o=ar(n.charAt(0),t.intervals),r=ir(l.semitones,o,t.intervals),a=new Map(at.map(c=>{const i=r.find(d=>d.semitones===c.semitones);return i?[c.semitones,i]:[c.semitones,{...c}]}));return{data:{key:n,scale:t.names[0],names:t.names,...Ql(r),intervals:t.intervals.map(c=>({...c})),triads:t.triads.map(c=>({...c})),scaleNotes:r,notesMap:a}}}const Ds=new Map;function cr(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function ur(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(n){return{err:`Failed to store the value: ${n}`,code:400}}}function vt(s,e){const{key:t,storage:n="local",namespace:l="default"}=e,o=cr(t,n),r=Te(s);"data"in o?s.set(e.deserialize?e.deserialize(o.data):o.data):"err"in o&&(e!=null&&e.debug)&&console.info(o.err);const a=s.subscribe(i=>{const d=ur(e.serialize?e.serialize(i):i,t,n);"err"in d&&(e!=null&&e.debug)&&console.error(d.err)}),c=Ds.get(l);return c?c.push({key:t,storage:n,value:s,defaultValue:r,unsubscribe:a}):Ds.set(l,[{key:t,storage:n,value:s,defaultValue:r,unsubscribe:a}]),s}function fr(s=["default"],e){s.forEach(t=>{var n;(n=Ds.get(t))==null||n.forEach(l=>{if(e!=null&&e.cb)e==null||e.cb(l);else try{e!=null&&e.unsubscribe&&l.unsubscribe(),l.value.set(l.defaultValue),(l.storage==="local"?window.localStorage:window.sessionStorage).removeItem(l.key)}catch{}})})}async function dr(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const n=await t.arrayBuffer();return{data:await e.decodeAudioData(n)}}async function hr(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],n=await Promise.all(t.map(o=>dr(`${s}${o}`,e))),l=[];return n.forEach(o=>{"err"in o?console.error(`Failed to load audio: ${o.err}`):l.push(o.data)}),l}class mr{constructor(e,t,n,l){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(n),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=l,this.damp.connect(n))}on(e,t,n,l,o,r,a,c){this.noteA.buffer=e,this.noteA.playbackRate.value=n,this.biquadFilter.frequency.value=o,this.gainA.gain.value=r,this.gain.gain.value=c,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=l,this.gainB.gain.value=a,this.noteB.start(0)),this.noteA.start(0)}off(e,t,n){var l;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(n),this.noteB.stop(n),(l=this.damp)==null||l.start(0)}}class _r{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,n)=>{this.bufferlists.push(t),n===8?this.damper=t:n===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(n=>{this.noteOn(n,t)})}noteOn(e,t=80){if(e<109&&e>20){const n=this.notes.get(e);n&&(n.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const l=Math.floor((e-21)/12),o=l+1,r=l*12+21,a=2**((e-69)/12)*440,c=t/127;let i=a*(2-(e-21)/50)+3*a*c;e<60&&(i=440*(3-(60-21)/50)+3*a*c);const d=1-(e%12/12+1)/12,f=Math.pow(2,(e-r)/12),g=0,m=0,h=c**1.4,y=new mr(e,this.context,this.directGain,this.damper);y.on(this.bufferlists[l],this.bufferlists[o],f,g,i,d,m,h),this.notes.set(e,y)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const Ls=vt(Oe(!1),{key:"midi-access"}),ps=Oe({err:"Uninitialized",code:400}),bs=vt(Oe([60,84]),{key:"midi-range",storage:"session"}),Mt=Wt(bs,s=>[rn(s[0]),rn(s[1])]),on=Oe(void 0),st=Oe(void 0),nt=vt(Oe({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),Pe={async openMidi(){const s=await Ts.enable().then(()=>(Ls.set(!0),Ts.inputs.length>0?{data:Ts.inputs[0]}:{err:"No MIDI device found",code:404})).catch(e=>({err:e.toString(),code:403}));return"err"in s&&console.error(s.err),ps.set(s),s},disableMidi(){Ls.set(!1),ps.set({err:"Uninitialized",code:400})},setMidiRange(s){bs.set(s)},setInputValue(s,e){nt.update(t=>({...t,[s]:e})),s==="useSound"&&!e?st.set(void 0):s==="useSound"&&!Te(st)&&this.initAudio()},async initAudio(){let s=Te(on);if(s||(s=new AudioContext,on.set(s)),!Te(st)){const e=new _r(s),t=await hr(`${Ul}audio`,s);e.load(t),st.set(e)}}};let ot;const At=Oe(["C","Major"]),gt=Wt(At,s=>{const e=zt(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),an=Oe([]),wt=Oe([]);function Vs(s,e){if(s.length>0){const t=Date.now();let n=t;const l=s.filter(o=>(o.started+e>t&&(n=Math.min(n,o.started)),o.started+e>t));return!ot&&l.length>0&&(ot=setTimeout(()=>{ot=void 0,wt.update(o=>Vs(o,e))},e-(t-n)+100)),l}return s}const Se={setKey(s){At.update(e=>[s,e[1]])},setScale(s){At.update(e=>[e[0],s])},setKeyAndScale(s,e){At.set([s,e])},setTarget(s=[]){an.set(s)},getNote(s){return{...Te(gt).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const l={...Te(gt).notesMap.get(s%12),midi:s},o=Date.now(),r=e===void 0?"default":e?"correct":"wrong";if(wt.update(a=>{const c=a.findIndex(i=>i.midi===s);return c>=0&&a.splice(c,1),[...a,{...l,color:r,started:o}]}),!ot&&t!==-1){const a=t??Te(nt).keyFadeTimeout;ot=setTimeout(()=>{ot=void 0,wt.update(c=>Vs(c,a))},a)}},setPlayed(s,e,t){const n=Date.now(),l=e===void 0?"default":e?"correct":"wrong";if(wt.update(o=>[...s.map(r=>({...r,color:l,started:n}))]),!ot&&t!==-1){const o=t??Te(nt).keyFadeTimeout;ot=setTimeout(()=>{ot=void 0,wt.update(r=>Vs(r,o))},o)}},clearPlayed(){wt.set([]),clearTimeout(ot),ot=void 0},clearScore(s=!1){s&&At.set(["C","Major"]),an.set([]),wt.set([])}};class Rs{constructor(e,t,n){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=n;const l=[],{count:o}=n,r=t.map(c=>typeof c=="object"&&c!==null?{...c}:c);let a=n.duplicates;!n.duplicates&&o>r.length&&(console.warn(`Trying to create game with count ${o} larger than available unique values ${t.length}`),a=!0);for(let c=0;c<o;c+=1){const i=Math.floor(Math.random()*r.length);if(a)l.push(r[i]);else{const d=r.splice(i,1);d.length>0&&l.push(d[0])}}this.sampled=l,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function pr(s,e,t){let n=e<0?s.flats-e:s.flats,l=e>0?s.sharps+e:s.sharps;if(n>0&&l>0){const r=Math.min(n,l);n-=r,l-=r}const o=(s.semitones+e)%12;return{...s,semitones:o<0?o+12:o,note:`${s.note.charAt(0)}${"♭".repeat(n)}${"♯".repeat(l)}`,flats:n,sharps:l,midi:t}}function gr(s,e,t){const n=[];for(let l=0;l<t.length;l+=1){const o=t[l],r=s+o.semitones,a=e.scaleNotes.find(g=>g.semitones===r%12),c=o.flats>0,i=o.sharps>0,d=(c?r+1:i?r-1:r)%12,f=c?-1:i?1:0;n.push(pr(a??e.notesMap.get(d),a?0:f,r))}return n}const vr=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function br(s){const t=(s-12)%12;return{...vr[t],semitones:t,midi:s}}function yr(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class _t extends Rs{constructor(e,t,n){const l=t.range[0],o=t.range[1],r=new Set(t.scale.scaleNotes.map(c=>c.semitones)),a=n.chords.flatMap(c=>{const i=[],d=c.intervals.reduce((f,g)=>g.semitones>f?g.semitones:f,0);for(let f=l;f<=o-d;f+=1)if((!n.onlyScale||r.has(f%12))&&(!c.allowed||c.allowed.has(f%12))){const g=gr(f,t.scale,c.intervals);i.push({...c,rootNote:g[0].note,chord:`${g[0].note}${c.suffixes[0]}`,notes:g})}return i});super(e,a,t),this.played=new Set,this.opts=n}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${yr(e)}${e.chord.toLowerCase()}`,notes:[]};let n=this.current.chord===t.chord;return this.current.chord.slice(-3)==="maj"&&!n&&(n=this.current.chord.slice(0,-3)===t.chord),this.addGuessed(t,n)}guess(){const e=Array.from(this.played.values()).map(l=>br(l)).sort((l,o)=>l.midi-o.midi);this.played.clear();const t={chord:"",notes:e},n=this.current.notes.every(l=>e.find(o=>o.midi%12===l.midi%12));return this.addGuessed(t,n)}}const kr={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class qt extends Rs{constructor(e,t){const n=e==="keys-major"?"major":"minor";super(e,Object.keys(kr[n]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class Pt extends Rs{constructor(e,t){const n=t.range[0],l=t.range[1];super(e,Array.from(new Array(l-n+1)).map((o,r)=>n+r),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const El={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},mt=Oe("waiting"),pt=vt(Oe(El),{key:"game-options"}),Tt=Oe(void 0),Us=Oe(kl().map(s=>({...s,selected:!0}))),De={play(...[s,e]){var c,i,d;let t;const n=Te(gt),l=Te(bs),o=Te(pt),r={scale:n,range:l,duplicates:o.duplicates,count:o.count};let a=[n.key,n.scale];if(s==="notes")t=new Pt(s,r),Se.setTarget([Se.getNote(t.current)]),(c=Te(st))==null||c.noteOn(t.current);else if(s==="pitches")t=new Pt(s,r),Se.setTarget(),Pe.setInputValue("useSound",!0),(i=Te(st))==null||i.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new qt(s,r),a=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new _t(s,r,e);else if(s==="chords-diatonic"){const f=wl(n.triads).map((g,m)=>({...g,allowed:new Set([n.scaleNotes[m].semitones])}));t=new _t(s,r,{chords:f})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((d=Te(st))==null||d.playChord(t.current.notes.map(f=>f.midi)),Se.setTarget(t.current.notes)),Se.setKeyAndScale(a[0],a[1]),Se.clearPlayed(),mt.set("waiting"),Tt.set(t),t},updateState(s){mt.set(s)},setOptionValue(s,e){pt.update(t=>({...t,[s]:e}))},toggleChords(s){Us.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Te(Tt);s!=null&&s.ended?mt.set("ended"):s instanceof Pt?(s.type==="notes"?Se.setTarget([Se.getNote(s.current)]):Se.setTarget(),Se.clearPlayed(),(e=Te(st))==null||e.noteOn(s.current),De.updateState("waiting"),s.startTime()):s instanceof _t?(Se.setTarget(s.current.notes),Se.clearPlayed(),(t=Te(st))==null||t.playChord(s==null?void 0:s.current.notes.map(n=>n.midi)),mt.set("waiting"),s.startTime()):s instanceof qt&&(Se.setKey(s.current),mt.set("waiting"),s.startTime())},clearGame(s=!1){const e=Te(Tt);e&&Se.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&pt.set(El),Tt.set(void 0),mt.set("waiting"),Se.clearScore()}};function cn(s,e,t){const n=s.slice();return n[35]=e[t],n[37]=t,n}function un(s,e,t){const n=s.slice();return n[40]=e[t],n}function fn(s,e,t){const n=s.slice();return n[9]=e[t],n}function dn(s,e,t){const n=s.slice();return n[35]=e[t],n[37]=t,n}function hn(s,e,t){const n=s.slice();return n[40]=e[t],n}function mn(s,e,t){const n=s.slice();return n[9]=e[t],n}function wr(s){let e,t=_e(s[35].intervals),n=[];for(let l=0;l<t.length;l+=1)n[l]=_n(hn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);M(l,e,o)},p(l,o){if(o[0]&128){t=_e(l[35].intervals);let r;for(r=0;r<t.length;r+=1){const a=hn(l,t,r);n[r]?n[r].p(a,o):(n[r]=_n(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function Er(s){let e,t=_e(s[3][s[37]]),n=[];for(let l=0;l<t.length;l+=1)n[l]=pn(mn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);M(l,e,o)},p(l,o){if(o[0]&8){t=_e(l[3][l[37]]);let r;for(r=0;r<t.length;r+=1){const a=mn(l,t,r);n[r]?n[r].p(a,o):(n[r]=pn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function _n(s){let e,t=s[40].interval+"",n;return{c(){e=v("span"),n=ee(t),this.h()},l(l){e=b(l,"SPAN",{class:!0});var o=T(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-zd92lx")},m(l,o){M(l,e,o),u(e,n)},p(l,o){o[0]&128&&t!==(t=l[40].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function pn(s){let e,t=s[9].note+"",n;return{c(){e=v("span"),n=ee(t),this.h()},l(l){e=b(l,"SPAN",{class:!0});var o=T(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-zd92lx")},m(l,o){M(l,e,o),u(e,n)},p(l,o){o[0]&8&&t!==(t=l[9].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function gn(s){let e,t,n,l,o,r,a=s[35].suffixes[0]+"",c,i,d,f,g,m,h,y=s[35].name+"",w,k,C,B,D;l=new Me({props:{icon:s[35].selected?hs:ms,width:12}});function $(){return s[25](s[35])}function E(L,S){return L[3][L[37]]&&L[3][L[37]].length>0?Er:wr}let j=E(s),N=j(s);function I(){return s[26](s[35])}return{c(){e=v("li"),t=v("button"),n=v("span"),ue(l.$$.fragment),o=O(),r=v("div"),c=ee(a),i=O(),d=v("li"),N.c(),g=O(),m=v("li"),h=v("button"),w=ee(y),k=O(),this.h()},l(L){e=b(L,"LI",{});var S=T(e);t=b(S,"BUTTON",{class:!0});var V=T(t);n=b(V,"SPAN",{class:!0});var A=T(n);fe(l.$$.fragment,A),A.forEach(_),o=P(V),r=b(V,"DIV",{class:!0});var G=T(r);c=te(G,a),G.forEach(_),V.forEach(_),S.forEach(_),i=P(L),d=b(L,"LI",{class:!0,title:!0});var R=T(d);N.l(R),R.forEach(_),g=P(L),m=b(L,"LI",{class:!0});var x=T(m);h=b(x,"BUTTON",{class:!0});var Q=T(h);w=te(Q,y),Q.forEach(_),k=P(x),x.forEach(_),this.h()},h(){p(n,"class","px-1 py-1 rounded"),W(n,"text-green-500",s[35].selected),W(n,"text-gray-400",!s[35].selected),p(r,"class","ml-1 px-1 w-full bg-gray-200 svelte-zd92lx"),p(t,"class","flex items-center justify-center w-full select-btn svelte-zd92lx"),W(t,"hidden",s[8]),p(d,"class","intervals svelte-zd92lx"),p(d,"title",f=s[35].intervals.map(kn).join("-")),p(h,"class","text-start"),p(m,"class","text-xs")},m(L,S){M(L,e,S),u(e,t),u(t,n),de(l,n,null),u(t,o),u(t,r),u(r,c),M(L,i,S),M(L,d,S),N.m(d,null),M(L,g,S),M(L,m,S),u(m,h),u(h,w),u(m,k),C=!0,B||(D=[Y(t,"click",$),Y(h,"click",I)],B=!0)},p(L,S){s=L;const V={};S[0]&128&&(V.icon=s[35].selected?hs:ms),l.$set(V),(!C||S[0]&128)&&W(n,"text-green-500",s[35].selected),(!C||S[0]&128)&&W(n,"text-gray-400",!s[35].selected),(!C||S[0]&128)&&a!==(a=s[35].suffixes[0]+"")&&ye(c,a),(!C||S[0]&256)&&W(t,"hidden",s[8]),j===(j=E(s))&&N?N.p(s,S):(N.d(1),N=j(s),N&&(N.c(),N.m(d,null))),(!C||S[0]&128&&f!==(f=s[35].intervals.map(kn).join("-")))&&p(d,"title",f),(!C||S[0]&128)&&y!==(y=s[35].name+"")&&ye(w,y)},i(L){C||(U(l.$$.fragment,L),C=!0)},o(L){H(l.$$.fragment,L),C=!1},d(L){L&&(_(e),_(i),_(d),_(g),_(m)),he(l),N.d(),B=!1,qe(D)}}}function Cr(s){let e,t=_e(s[35].intervals),n=[];for(let l=0;l<t.length;l+=1)n[l]=vn(un(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);M(l,e,o)},p(l,o){if(o[0]&64){t=_e(l[35].intervals);let r;for(r=0;r<t.length;r+=1){const a=un(l,t,r);n[r]?n[r].p(a,o):(n[r]=vn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function Tr(s){let e,t=_e(s[4][s[37]]),n=[];for(let l=0;l<t.length;l+=1)n[l]=bn(fn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);M(l,e,o)},p(l,o){if(o[0]&16){t=_e(l[4][l[37]]);let r;for(r=0;r<t.length;r+=1){const a=fn(l,t,r);n[r]?n[r].p(a,o):(n[r]=bn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function vn(s){let e,t=s[40].interval+"",n;return{c(){e=v("span"),n=ee(t),this.h()},l(l){e=b(l,"SPAN",{class:!0});var o=T(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-zd92lx")},m(l,o){M(l,e,o),u(e,n)},p(l,o){o[0]&64&&t!==(t=l[40].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function bn(s){let e,t=s[9].note+"",n;return{c(){e=v("span"),n=ee(t),this.h()},l(l){e=b(l,"SPAN",{class:!0});var o=T(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-zd92lx")},m(l,o){M(l,e,o),u(e,n)},p(l,o){o[0]&16&&t!==(t=l[9].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function yn(s){let e,t,n,l,o,r,a=s[35].suffixes[0]+"",c,i,d,f,g,m,h,y=s[35].name+"",w,k,C,B,D;l=new Me({props:{icon:s[35].selected?hs:ms,width:12}});function $(){return s[27](s[35])}function E(L,S){return L[4][L[37]]&&L[4][L[37]].length>0?Tr:Cr}let j=E(s),N=j(s);function I(){return s[28](s[35])}return{c(){e=v("li"),t=v("button"),n=v("span"),ue(l.$$.fragment),o=O(),r=v("div"),c=ee(a),i=O(),d=v("li"),N.c(),g=O(),m=v("li"),h=v("button"),w=ee(y),k=O(),this.h()},l(L){e=b(L,"LI",{});var S=T(e);t=b(S,"BUTTON",{class:!0});var V=T(t);n=b(V,"SPAN",{class:!0});var A=T(n);fe(l.$$.fragment,A),A.forEach(_),o=P(V),r=b(V,"DIV",{class:!0});var G=T(r);c=te(G,a),G.forEach(_),V.forEach(_),S.forEach(_),i=P(L),d=b(L,"LI",{class:!0,title:!0});var R=T(d);N.l(R),R.forEach(_),g=P(L),m=b(L,"LI",{class:!0});var x=T(m);h=b(x,"BUTTON",{class:!0});var Q=T(h);w=te(Q,y),Q.forEach(_),k=P(x),x.forEach(_),this.h()},h(){p(n,"class","px-1 py-1 rounded"),W(n,"text-green-500",s[35].selected),W(n,"text-gray-400",!s[35].selected),p(r,"class","ml-1 px-1 w-full bg-gray-200 svelte-zd92lx"),p(t,"class","flex items-center justify-center w-full select-btn svelte-zd92lx"),W(t,"hidden",s[8]),p(d,"class","intervals svelte-zd92lx"),p(d,"title",f=s[35].intervals.map(wn).join("-")),p(h,"class","text-start"),p(m,"class","text-xs")},m(L,S){M(L,e,S),u(e,t),u(t,n),de(l,n,null),u(t,o),u(t,r),u(r,c),M(L,i,S),M(L,d,S),N.m(d,null),M(L,g,S),M(L,m,S),u(m,h),u(h,w),u(m,k),C=!0,B||(D=[Y(t,"click",$),Y(h,"click",I)],B=!0)},p(L,S){s=L;const V={};S[0]&64&&(V.icon=s[35].selected?hs:ms),l.$set(V),(!C||S[0]&64)&&W(n,"text-green-500",s[35].selected),(!C||S[0]&64)&&W(n,"text-gray-400",!s[35].selected),(!C||S[0]&64)&&a!==(a=s[35].suffixes[0]+"")&&ye(c,a),(!C||S[0]&256)&&W(t,"hidden",s[8]),j===(j=E(s))&&N?N.p(s,S):(N.d(1),N=j(s),N&&(N.c(),N.m(d,null))),(!C||S[0]&64&&f!==(f=s[35].intervals.map(wn).join("-")))&&p(d,"title",f),(!C||S[0]&64)&&y!==(y=s[35].name+"")&&ye(w,y)},i(L){C||(U(l.$$.fragment,L),C=!0)},o(L){H(l.$$.fragment,L),C=!1},d(L){L&&(_(e),_(i),_(d),_(g),_(m)),he(l),N.d(),B=!1,qe(D)}}}function Ir(s){let e,t,n,l,o="Chords",r,a,c,i,d,f,g,m,h,y,w,k,C,B,D,$,E,j="Key",N,I,L,S,V="Scale",A,G,R,x,Q="Note",F,X,Z,K,J,z,me,pe,$e,ie;i=new Me({props:{icon:Ml,width:20}}),g=new Me({props:{icon:$l,width:16}}),y=new Me({props:{icon:s[5]?Ws:Js,width:16}}),C=new Me({props:{icon:Jt,width:16}}),G=new vl({props:{id:"chords-scale",class:"bg-gray-100 pl-1",containerClass:"input",selected:s[1],options:s[10],onSelect:s[14]}});let ce=_e(s[7]),le=[];for(let q=0;q<ce.length;q+=1)le[q]=gn(dn(s,ce,q));const oe=q=>H(le[q],1,1,()=>{le[q]=null});let ve=_e(s[6]),ke=[];for(let q=0;q<ve.length;q+=1)ke[q]=yn(cn(s,ve,q));const tt=q=>H(ke[q],1,1,()=>{ke[q]=null});return{c(){e=v("div"),t=v("fieldset"),n=v("legend"),l=v("button"),l.textContent=o,r=O(),a=v("div"),c=v("button"),ue(i.$$.fragment),d=O(),f=v("button"),ue(g.$$.fragment),m=O(),h=v("button"),ue(y.$$.fragment),w=O(),k=v("button"),ue(C.$$.fragment),B=O(),D=v("div"),$=v("div"),E=v("label"),E.textContent=j,N=O(),I=v("input"),L=O(),S=v("label"),S.textContent=V,A=O(),ue(G.$$.fragment),R=O(),x=v("label"),x.textContent=Q,F=O(),X=v("input"),Z=O(),K=v("ul");for(let q=0;q<le.length;q+=1)le[q].c();J=O(),z=v("ul");for(let q=0;q<ke.length;q+=1)ke[q].c();this.h()},l(q){e=b(q,"DIV",{class:!0});var re=T(e);t=b(re,"FIELDSET",{class:!0});var Ee=T(t);n=b(Ee,"LEGEND",{class:!0});var Re=T(n);l=b(Re,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1knqzl6"&&(l.textContent=o),Re.forEach(_),r=P(Ee),a=b(Ee,"DIV",{class:!0});var ne=T(a);c=b(ne,"BUTTON",{class:!0});var We=T(c);fe(i.$$.fragment,We),We.forEach(_),d=P(ne),f=b(ne,"BUTTON",{class:!0});var je=T(f);fe(g.$$.fragment,je),je.forEach(_),m=P(ne),h=b(ne,"BUTTON",{class:!0});var ct=T(h);fe(y.$$.fragment,ct),ct.forEach(_),w=P(ne),k=b(ne,"BUTTON",{class:!0});var et=T(k);fe(C.$$.fragment,et),et.forEach(_),ne.forEach(_),B=P(Ee),D=b(Ee,"DIV",{class:!0});var Qe=T(D);$=b(Qe,"DIV",{class:!0});var Je=T($);E=b(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(E)!=="svelte-4jiw22"&&(E.textContent=j),N=P(Je),I=b(Je,"INPUT",{class:!0,id:!0}),L=P(Je),S=b(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(S)!=="svelte-162gpi4"&&(S.textContent=V),A=P(Je),fe(G.$$.fragment,Je),R=P(Je),x=b(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(x)!=="svelte-nkwohg"&&(x.textContent=Q),F=P(Je),X=b(Je,"INPUT",{class:!0,id:!0}),Je.forEach(_),Z=P(Qe),K=b(Qe,"UL",{class:!0});var St=T(K);for(let Ue=0;Ue<le.length;Ue+=1)le[Ue].l(St);St.forEach(_),J=P(Qe),z=b(Qe,"UL",{class:!0});var ut=T(z);for(let Ue=0;Ue<ke.length;Ue+=1)ke[Ue].l(ut);ut.forEach(_),Qe.forEach(_),Ee.forEach(_),re.forEach(_),this.h()},h(){p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(c,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),W(c,"hidden",s[8]),p(f,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(f,"hidden",s[8]),p(h,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(h,"hidden",s[8]),p(k,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(k,"hidden",s[8]),p(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),p(E,"class","mr-4 font-bold svelte-zd92lx"),p(E,"for","chords-key"),p(I,"class","input bg-gray-100 w-12 px-1 rounded"),p(I,"id","chords-key"),I.value=s[0],p(S,"class","font-bold svelte-zd92lx"),p(S,"for","chords-scale"),p(x,"class","font-bold svelte-zd92lx"),p(x,"for","chords-note"),p(X,"class","input bg-gray-100 w-12 px-1 rounded"),p(X,"id","chords-note"),X.value=s[2],p($,"class","flex mb-2 options svelte-zd92lx"),p(K,"class","chord-list w-full svelte-zd92lx"),p(z,"class","chord-list w-full svelte-zd92lx"),p(D,"class","body svelte-zd92lx"),W(D,"hidden",s[8]),p(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-zd92lx"),W(t,"collapsed",s[8]),p(e,"class",me=Ne(`${s[22].class||""}`)+" svelte-zd92lx")},m(q,re){M(q,e,re),u(e,t),u(t,n),u(n,l),u(t,r),u(t,a),u(a,c),de(i,c,null),u(a,d),u(a,f),de(g,f,null),u(a,m),u(a,h),de(y,h,null),u(a,w),u(a,k),de(C,k,null),u(t,B),u(t,D),u(D,$),u($,E),u($,N),u($,I),u($,L),u($,S),u($,A),de(G,$,null),u($,R),u($,x),u($,F),u($,X),u(D,Z),u(D,K);for(let Ee=0;Ee<le.length;Ee+=1)le[Ee]&&le[Ee].m(K,null);u(D,J),u(D,z);for(let Ee=0;Ee<ke.length;Ee+=1)ke[Ee]&&ke[Ee].m(z,null);pe=!0,$e||(ie=[Y(l,"click",s[12]),Y(c,"click",s[17]),Y(f,"click",s[18]),Y(h,"click",s[19]),Y(k,"click",s[20]),Y(I,"input",s[13]),Y(X,"input",s[15])],$e=!0)},p(q,re){(!pe||re[0]&256)&&W(c,"hidden",q[8]),(!pe||re[0]&256)&&W(f,"hidden",q[8]);const Ee={};re[0]&32&&(Ee.icon=q[5]?Ws:Js),y.$set(Ee),(!pe||re[0]&256)&&W(h,"hidden",q[8]),(!pe||re[0]&256)&&W(k,"hidden",q[8]),(!pe||re[0]&1&&I.value!==q[0])&&(I.value=q[0]);const Re={};if(re[0]&2&&(Re.selected=q[1]),G.$set(Re),(!pe||re[0]&4&&X.value!==q[2])&&(X.value=q[2]),re[0]&2163080){ce=_e(q[7]);let ne;for(ne=0;ne<ce.length;ne+=1){const We=dn(q,ce,ne);le[ne]?(le[ne].p(We,re),U(le[ne],1)):(le[ne]=gn(We),le[ne].c(),U(le[ne],1),le[ne].m(K,null))}for(ze(),ne=ce.length;ne<le.length;ne+=1)oe(ne);He()}if(re[0]&2163024){ve=_e(q[6]);let ne;for(ne=0;ne<ve.length;ne+=1){const We=cn(q,ve,ne);ke[ne]?(ke[ne].p(We,re),U(ke[ne],1)):(ke[ne]=yn(We),ke[ne].c(),U(ke[ne],1),ke[ne].m(z,null))}for(ze(),ne=ve.length;ne<ke.length;ne+=1)tt(ne);He()}(!pe||re[0]&256)&&W(D,"hidden",q[8]),(!pe||re[0]&256)&&W(t,"collapsed",q[8]),(!pe||re[0]&4194304&&me!==(me=Ne(`${q[22].class||""}`)+" svelte-zd92lx"))&&p(e,"class",me)},i(q){if(!pe){U(i.$$.fragment,q),U(g.$$.fragment,q),U(y.$$.fragment,q),U(C.$$.fragment,q),U(G.$$.fragment,q);for(let re=0;re<ce.length;re+=1)U(le[re]);for(let re=0;re<ve.length;re+=1)U(ke[re]);pe=!0}},o(q){H(i.$$.fragment,q),H(g.$$.fragment,q),H(y.$$.fragment,q),H(C.$$.fragment,q),H(G.$$.fragment,q),le=le.filter(Boolean);for(let re=0;re<le.length;re+=1)H(le[re]);ke=ke.filter(Boolean);for(let re=0;re<ke.length;re+=1)H(ke[re]);pe=!1},d(q){q&&_(e),he(i),he(g),he(y),he(C),he(G),Ve(le,q),Ve(ke,q),$e=!1,qe(ie)}}}const kn=s=>s.interval,wn=s=>s.interval;function Ar(s,e,t){let n,l,o,r,a,c,i,d,f;be(s,nt,K=>t(30,a=K)),be(s,st,K=>t(31,c=K)),be(s,Mt,K=>t(32,i=K)),be(s,Us,K=>t(24,d=K));let g="C",m="Major",h=zt(g,m),y="",w,k=[],C=[];const D=vs().map(K=>({key:K.names[0],value:K.names[0]})),$=vt(Oe(!0),{key:"chords-hidden"});be(s,$,K=>t(8,f=K));function E(){$.update(K=>!K)}function j(){const K=w&&60+w.semitones;if("err"in h||!K)t(3,k=[]),t(4,C=[]);else{const J=h.data;t(3,k=l.map(z=>is(K,J,z.intervals))),t(4,C=o.map(z=>is(K,J,z.intervals)))}}function N({currentTarget:{value:K}}){t(0,g=`${K.charAt(0).toUpperCase()}${K.charAt(1).toLowerCase()}`),h=zt(g,m),j()}function I(K){var J;return t(1,m=(J=D.find(z=>K===z.key))==null?void 0:J.value),h=zt(g,m),j(),!1}function L({currentTarget:{value:K}}){t(2,y=`${K.charAt(0).toUpperCase()}${K.charAt(1).toLowerCase()}`),t(9,w=$s(y)),j()}function S(K){De.toggleChords(J=>J.name===K.name?!J.selected:J.selected)}function V(){const K=z=>z.suffixes[0]==="maj"||z.suffixes[0]==="m",J=d.filter(K).every(z=>z.selected);De.toggleChords(z=>K(z)?!J:z.selected)}function A(){const K=z=>z.suffixes[0]==="maj7"||z.suffixes[0]==="m7"||z.suffixes[0]==="7"||z.suffixes[0]==="dim7"||z.suffixes[0]==="aug7",J=d.filter(K).every(z=>z.selected);De.toggleChords(z=>K(z)?!J:z.selected)}function G(){De.toggleChords(K=>!r)}function R(){De.toggleChords(K=>!0)}function x(K){if("err"in h)return;const J=i[0].midi+((w==null?void 0:w.semitones)||0),z=is(J,h.data,K.intervals);c==null||c.playChord(z.map(me=>me.midi),a.fixedVelocity)}const Q=K=>S(K),F=K=>x(K),X=K=>S(K),Z=K=>x(K);return s.$$set=K=>{t(22,e=Ie(Ie({},e),Ae(K)))},s.$$.update=()=>{s.$$.dirty[0]&16777216&&t(23,n=d),s.$$.dirty[0]&8388608&&t(7,l=n.filter((K,J)=>J<n.length/2)),s.$$.dirty[0]&8388608&&t(6,o=n.filter((K,J)=>J>=n.length/2)),s.$$.dirty[0]&8388608&&t(5,r=n.every(K=>K.selected))},e=Ae(e),[g,m,y,k,C,r,o,l,f,w,D,$,E,N,I,L,S,V,A,G,R,x,e,n,d,Q,F,X,Z]}class Nr extends Ke{constructor(e){super(),xe(this,e,Ar,Ir,Fe,{},null,[-1,-1])}}function En(s,e,t){const n=s.slice();return n[12]=e[t],n}function Sr(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){M(t,e,n)},p:ge,i:ge,o:ge,d(t){t&&_(e)}}}function Dr(s){let e,t,n="Played:",l,o=_e(s[2]),r=[];for(let a=0;a<o.length;a+=1)r[a]=Cn(En(s,o,a));return{c(){e=v("div"),t=v("span"),t.textContent=n,l=O();for(let a=0;a<r.length;a+=1)r[a].c()},l(a){e=b(a,"DIV",{});var c=T(e);t=b(c,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1g6xxhn"&&(t.textContent=n),l=P(c);for(let i=0;i<r.length;i+=1)r[i].l(c);c.forEach(_)},m(a,c){M(a,e,c),u(e,t),u(e,l);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(e,null)},p(a,c){if(c&4){o=_e(a[2]);let i;for(i=0;i<o.length;i+=1){const d=En(a,o,i);r[i]?r[i].p(d,c):(r[i]=Cn(d),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=o.length}},i:ge,o:ge,d(a){a&&_(e),Ve(r,a)}}}function Lr(s){let e,t,n="Result:",l,o,r,a=s[0].correct+"",c,i,d=s[0].sampled.length+"",f,g,m,h,y,w=s[0].avgTime+"",k,C;return{c(){e=v("div"),t=v("span"),t.textContent=n,l=O(),o=v("span"),r=ee("["),c=ee(a),i=ee(" / "),f=ee(d),g=ee("]"),m=O(),h=v("span"),y=ee("avg "),k=ee(w),C=ee("s"),this.h()},l(B){e=b(B,"DIV",{class:!0});var D=T(e);t=b(D,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1eqfbgx"&&(t.textContent=n),l=P(D),o=b(D,"SPAN",{class:!0});var $=T(o);r=te($,"["),c=te($,a),i=te($," / "),f=te($,d),g=te($,"]"),$.forEach(_),m=P(D),h=b(D,"SPAN",{});var E=T(h);y=te(E,"avg "),k=te(E,w),C=te(E,"s"),E.forEach(_),D.forEach(_),this.h()},h(){p(o,"class","mx-2"),p(e,"class","flex")},m(B,D){M(B,e,D),u(e,t),u(e,l),u(e,o),u(o,r),u(o,c),u(o,i),u(o,f),u(o,g),u(e,m),u(e,h),u(h,y),u(h,k),u(h,C)},p(B,D){D&1&&a!==(a=B[0].correct+"")&&ye(c,a),D&1&&d!==(d=B[0].sampled.length+"")&&ye(f,d),D&1&&w!==(w=B[0].avgTime+"")&&ye(k,w)},i:ge,o:ge,d(B){B&&_(e)}}}function Vr(s){var L,S,V,A;let e,t,n="Target:",l,o,r=((L=s[0].latestGuess.target)==null?void 0:L.chord)+"",a,c,i,d=((S=s[0].latestGuess.target)==null?void 0:S.notes.map(Tn).join(" "))+"",f,g,m,h,y,w,k,C,B=((V=s[0].latestGuess.guessed)==null?void 0:V.chord)+"",D,$,E,j=((A=s[0].latestGuess.guessed)==null?void 0:A.notes.map(In).join(" "))+"",N,I;return y=new Me({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=v("div"),t=v("span"),t.textContent=n,l=O(),o=v("span"),a=ee(r),c=O(),i=v("span"),f=ee(d),g=O(),m=v("span"),h=v("div"),ue(y.$$.fragment),w=ee(`
        Guessed:`),k=O(),C=v("span"),D=ee(B),$=O(),E=v("span"),N=ee(j),this.h()},l(G){e=b(G,"DIV",{class:!0});var R=T(e);t=b(R,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1pddpsb"&&(t.textContent=n),l=P(R),o=b(R,"SPAN",{});var x=T(o);a=te(x,r),x.forEach(_),c=P(R),i=b(R,"SPAN",{});var Q=T(i);f=te(Q,d),Q.forEach(_),g=P(R),m=b(R,"SPAN",{class:!0});var F=T(m);h=b(F,"DIV",{class:!0});var X=T(h);fe(y.$$.fragment,X),X.forEach(_),w=te(F,`
        Guessed:`),F.forEach(_),k=P(R),C=b(R,"SPAN",{});var Z=T(C);D=te(Z,B),Z.forEach(_),$=P(R),E=b(R,"SPAN",{});var K=T(E);N=te(K,j),K.forEach(_),R.forEach(_),this.h()},h(){p(h,"class","absolute left-[-2rem] p-1"),p(m,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(G,R){M(G,e,R),u(e,t),u(e,l),u(e,o),u(o,a),u(e,c),u(e,i),u(i,f),u(e,g),u(e,m),u(m,h),de(y,h,null),u(m,w),u(e,k),u(e,C),u(C,D),u(e,$),u(e,E),u(E,N),I=!0},p(G,R){var Q,F,X,Z;(!I||R&1)&&r!==(r=((Q=G[0].latestGuess.target)==null?void 0:Q.chord)+"")&&ye(a,r),(!I||R&1)&&d!==(d=((F=G[0].latestGuess.target)==null?void 0:F.notes.map(Tn).join(" "))+"")&&ye(f,d);const x={};R&2&&(x.icon=G[1]==="correct"?Bt:Gt),y.$set(x),(!I||R&1)&&B!==(B=((X=G[0].latestGuess.guessed)==null?void 0:X.chord)+"")&&ye(D,B),(!I||R&1)&&j!==(j=((Z=G[0].latestGuess.guessed)==null?void 0:Z.notes.map(In).join(" "))+"")&&ye(N,j)},i(G){I||(U(y.$$.fragment,G),I=!0)},o(G){H(y.$$.fragment,G),I=!1},d(G){G&&_(e),he(y)}}}function Or(s){let e,t,n="Target:",l,o,r=s[0].latestGuess.target+"",a,c,i,d,f,g,m,h,y,w,k=s[0].latestGuess.guessed+"",C,B,D,$;return m=new Me({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=v("div"),t=v("span"),t.textContent=n,l=O(),o=v("span"),a=ee(r),c=O(),i=v("span"),d=O(),f=v("span"),g=v("div"),ue(m.$$.fragment),h=ee(`
        Guessed:`),y=O(),w=v("span"),C=ee(k),B=O(),D=v("span"),this.h()},l(E){e=b(E,"DIV",{class:!0});var j=T(e);t=b(j,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=n),l=P(j),o=b(j,"SPAN",{});var N=T(o);a=te(N,r),N.forEach(_),c=P(j),i=b(j,"SPAN",{}),T(i).forEach(_),d=P(j),f=b(j,"SPAN",{class:!0});var I=T(f);g=b(I,"DIV",{class:!0});var L=T(g);fe(m.$$.fragment,L),L.forEach(_),h=te(I,`
        Guessed:`),I.forEach(_),y=P(j),w=b(j,"SPAN",{});var S=T(w);C=te(S,k),S.forEach(_),B=P(j),D=b(j,"SPAN",{}),T(D).forEach(_),j.forEach(_),this.h()},h(){p(g,"class","absolute left-[-2rem] p-1"),p(f,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(E,j){M(E,e,j),u(e,t),u(e,l),u(e,o),u(o,a),u(e,c),u(e,i),u(e,d),u(e,f),u(f,g),de(m,g,null),u(f,h),u(e,y),u(e,w),u(w,C),u(e,B),u(e,D),$=!0},p(E,j){(!$||j&1)&&r!==(r=E[0].latestGuess.target+"")&&ye(a,r);const N={};j&2&&(N.icon=E[1]==="correct"?Bt:Gt),m.$set(N),(!$||j&1)&&k!==(k=E[0].latestGuess.guessed+"")&&ye(C,k)},i(E){$||(U(m.$$.fragment,E),$=!0)},o(E){H(m.$$.fragment,E),$=!1},d(E){E&&_(e),he(m)}}}function Pr(s){let e,t,n="Target:",l,o,r=s[8](s[0].latestGuess.target||0)+"",a,c,i,d,f,g,m,h,y,w,k=s[8](s[0].latestGuess.guessed||0)+"",C,B,D,$="",E;return m=new Me({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=v("div"),t=v("span"),t.textContent=n,l=O(),o=v("span"),a=ee(r),c=O(),i=v("span"),d=O(),f=v("span"),g=v("div"),ue(m.$$.fragment),h=ee(`
        Guessed:`),y=O(),w=v("span"),C=ee(k),B=O(),D=v("span"),D.innerHTML=$,this.h()},l(j){e=b(j,"DIV",{class:!0});var N=T(e);t=b(N,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=n),l=P(N),o=b(N,"SPAN",{});var I=T(o);a=te(I,r),I.forEach(_),c=P(N),i=b(N,"SPAN",{}),T(i).forEach(_),d=P(N),f=b(N,"SPAN",{class:!0});var L=T(f);g=b(L,"DIV",{class:!0});var S=T(g);fe(m.$$.fragment,S),S.forEach(_),h=te(L,`
        Guessed:`),L.forEach(_),y=P(N),w=b(N,"SPAN",{});var V=T(w);C=te(V,k),V.forEach(_),B=P(N),D=b(N,"SPAN",{"data-svelte-h":!0}),ae(D)!=="svelte-1qufua2"&&(D.innerHTML=$),N.forEach(_),this.h()},h(){p(g,"class","absolute left-[-2rem] p-1"),p(f,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(j,N){M(j,e,N),u(e,t),u(e,l),u(e,o),u(o,a),u(e,c),u(e,i),u(e,d),u(e,f),u(f,g),de(m,g,null),u(f,h),u(e,y),u(e,w),u(w,C),u(e,B),u(e,D),E=!0},p(j,N){(!E||N&1)&&r!==(r=j[8](j[0].latestGuess.target||0)+"")&&ye(a,r);const I={};N&2&&(I.icon=j[1]==="correct"?Bt:Gt),m.$set(I),(!E||N&1)&&k!==(k=j[8](j[0].latestGuess.guessed||0)+"")&&ye(C,k)},i(j){E||(U(m.$$.fragment,j),E=!0)},o(j){H(m.$$.fragment,j),E=!1},d(j){j&&_(e),he(m)}}}function Cn(s){let e,t=ht(s[12])+"",n;return{c(){e=v("span"),n=ee(t),this.h()},l(l){e=b(l,"SPAN",{class:!0});var o=T(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","mx-1")},m(l,o){M(l,e,o),u(e,n)},p(l,o){o&4&&t!==(t=ht(l[12])+"")&&ye(n,t)},d(l){l&&_(e)}}}function jr(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){M(t,e,n)},p:ge,d(t){t&&_(e)}}}function Br(s){let e,t="Next",n,l,o="Autoplay",r,a;return{c(){e=v("button"),e.textContent=t,n=O(),l=v("button"),l.textContent=o,this.h()},l(c){e=b(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-uy473n"&&(e.textContent=t),n=P(c),l=b(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1cfj1sl"&&(l.textContent=o),this.h()},h(){p(e,"class","btn primary mr-1"),p(l,"class","btn primary")},m(c,i){M(c,e,i),M(c,n,i),M(c,l,i),r||(a=[Y(e,"click",s[4]),Y(l,"click",s[5])],r=!0)},p:ge,d(c){c&&(_(e),_(n),_(l)),r=!1,qe(a)}}}function Gr(s){let e,t="Stop autoplay",n,l;return{c(){e=v("button"),e.textContent=t,this.h()},l(o){e=b(o,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){p(e,"class","btn primary")},m(o,r){M(o,e,r),n||(l=Y(e,"click",s[10]),n=!0)},p:ge,d(o){o&&_(e),n=!1,l()}}}function Mr(s){let e,t="Try Again",n,l,o="Clear",r,a;return{c(){e=v("button"),e.textContent=t,n=O(),l=v("button"),l.textContent=o,this.h()},l(c){e=b(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-15zs1cu"&&(e.textContent=t),n=P(c),l=b(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-11mnk9v"&&(l.textContent=o),this.h()},h(){p(e,"class","btn primary mr-1"),p(l,"class","btn primary")},m(c,i){M(c,e,i),M(c,n,i),M(c,l,i),r||(a=[Y(e,"click",s[6]),Y(l,"click",s[7])],r=!0)},p:ge,d(c){c&&(_(e),_(n),_(l)),r=!1,qe(a)}}}function $r(s){let e,t,n,l,o,r,a;const c=[Pr,Or,Vr,Lr,Dr,Sr],i=[];function d(h,y){return h[0]instanceof Pt&&(h[1]==="correct"||h[1]==="wrong")?0:h[0]instanceof qt&&(h[1]==="correct"||h[1]==="wrong")?1:h[0]instanceof _t&&(h[1]==="correct"||h[1]==="wrong")?2:h[0]&&h[1]==="ended"?3:h[2].length>0?4:5}t=d(s),n=i[t]=c[t](s);function f(h,y){return h[0]&&h[1]==="ended"?Mr:h[0]&&h[3].autoplay?Gr:h[0]?Br:jr}let g=f(s),m=g(s);return{c(){e=v("div"),n.c(),o=O(),r=v("div"),m.c(),this.h()},l(h){e=b(h,"DIV",{class:!0});var y=T(e);n.l(y),y.forEach(_),o=P(h),r=b(h,"DIV",{class:!0});var w=T(r);m.l(w),w.forEach(_),this.h()},h(){p(e,"class",l=Ne(`${s[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),p(r,"class","mt-2 h-8 flex items-center")},m(h,y){M(h,e,y),i[t].m(e,null),M(h,o,y),M(h,r,y),m.m(r,null),a=!0},p(h,[y]){let w=t;t=d(h),t===w?i[t].p(h,y):(ze(),H(i[w],1,1,()=>{i[w]=null}),He(),n=i[t],n?n.p(h,y):(n=i[t]=c[t](h),n.c()),U(n,1),n.m(e,null)),(!a||y&512&&l!==(l=Ne(`${h[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"))&&p(e,"class",l),g===(g=f(h))&&m?m.p(h,y):(m.d(1),m=g(h),m&&(m.c(),m.m(r,null)))},i(h){a||(U(n),a=!0)},o(h){H(n),a=!1},d(h){h&&(_(e),_(o),_(r)),i[t].d(),m.d()}}}const Tn=s=>s.note,In=s=>s.note;function Rr(s,e,t){let n,l,o,r;be(s,gt,h=>t(11,n=h)),be(s,mt,h=>t(1,l=h)),be(s,wt,h=>t(2,o=h)),be(s,pt,h=>t(3,r=h));let{game:a}=e;function c(){De.nextGuess()}function i(){De.setOptionValue("autoplay",!0),De.nextGuess()}function d(){a instanceof _t?De.play(a.type,a.opts):a&&De.play(a.type,void 0)}function f(){De.clearGame()}function g(h){const y=n.notesMap.get(h%12);return ht({midi:h,...y})}const m=()=>De.setOptionValue("autoplay",!1);return s.$$set=h=>{t(9,e=Ie(Ie({},e),Ae(h))),"game"in h&&t(0,a=h.game)},e=Ae(e),[a,l,o,r,c,i,d,f,g,e,m]}class Ur extends Ke{constructor(e){super(),xe(this,e,Rr,$r,Fe,{game:0})}}function Kr(s){let e,t,n,l=[{type:"checkbox"},s[2]],o={};for(let r=0;r<l.length;r+=1)o=Ie(o,l[r]);return{c(){e=v("input"),this.h()},l(r){e=b(r,"INPUT",{type:!0}),this.h()},h(){Ht(e,o),W(e,"svelte-mzrxuq",!0)},m(r,a){M(r,e,a),e.autofocus&&e.focus(),s[5](e),t||(n=[Y(e,"change",s[3]),Y(e,"input",s[4]),Y(e,"keydown",s[1])],t=!0)},p(r,[a]){Ht(e,o=pl(l,[{type:"checkbox"},a&4&&r[2]])),W(e,"svelte-mzrxuq",!0)},i:ge,o:ge,d(r){r&&_(e),s[5](null),t=!1,qe(n)}}}function xr(s,e,t){let n;function l(c){c.key==="Enter"&&n.click()}function o(c){jt.call(this,s,c)}function r(c){jt.call(this,s,c)}function a(c){gs[c?"unshift":"push"](()=>{n=c,t(0,n)})}return s.$$set=c=>{t(2,e=Ie(Ie({},e),Ae(c)))},e=Ae(e),[n,l,e,o,r,a]}class Nt extends Ke{constructor(e){super(),xe(this,e,xr,Kr,Fe,{})}}const Os={ar:{name:"Arabic",import:Ce(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:Ce(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:Ce(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:Ce(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:Ce(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:Ce(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:Ce(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:Ce(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:Ce(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>zr)},fa:{name:"Farsi",import:Ce(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fi:{name:"Finnish",import:Ce(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},fr:{name:"French",import:Ce(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:Ce(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:Ce(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:Ce(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:Ce(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:Ce(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:Ce(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:Ce(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:Ce(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:Ce(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:Ce(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:Ce(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:Ce(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:Ce(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:Ce(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:Ce(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:Ce(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:Ce(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:Ce(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:Ce(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:Ce(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:Ce(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:Ce(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function Cl(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default.slice(0,4)}}async function Fr(s=["en"]){let e={code:"en",layout:Os.en,index:99};Object.entries(Os).forEach(([n,l])=>{for(let o=0;o<s.length;o+=1)n===s[o]&&(!e||e.index>o)&&(e={code:n,layout:l,index:o})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:Cl(t.default)}}const Tl={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},zr=Object.freeze(Object.defineProperty({__proto__:null,default:Tl},Symbol.toStringTag,{value:"Module"})),Il=[0,2,4,5,7,9,11],Al=[1,3,-1,6,8,10,-1];function Hr(s,e,t){const n=s.keyType==="white"?Il:Al,l=n[t%n.length];let o;if(l>=0){o=e[l];const r=Math.floor(t/n.length);return{...o,semitones:o.semitones+(r>0?r:0)*12}}}function Ot(s,e,t=0,n=0){const l=s.keyType==="white"?Il:Al;let o=-1,r=0,a=0;return s.keys.forEach((c,i)=>{if(c.key.charAt(0)!=="{"&&i>=t&&o===-1?o=i:o!==-1&&c.key==="{empty}"&&(r+=1),o!==-1&&c.key.charAt(0)!=="{"){const d=i-r-o+n,f=l[d%l.length];if(f>=0){const g=e[f],m=Math.floor(d/l.length);c.note={...g,semitones:g.semitones+(m>0?m:0)*12},a=i-o}}}),{firstIndex:o,lastIndex:a}}const Nl=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function qr(s,e){let t=[];const n=s.default.map((r,a)=>{if(a===0){const c=r.split(" ").filter(i=>i!=="{bksp}");for(;c.length!==13;)c.length<13?c.unshift("{empty}"):c.shift();return[...c,"{bksp}"]}else if(a===1){const c=r.split(" ");return t=c.slice(13),[...c.slice(0,13),"{enter}"]}else{if(a===2)return[...r.split(" ").slice(0,13).filter(c=>c!=="{enter}"),...t].slice(0,13);if(a===3){const c=["{shift}",...r.split(" ").slice(1,12).filter(d=>d!=="{shift}"),"{shift}"];let i=1;for(;c.length<13;)c.splice(i,0,"{empty}"),i=i===1?-1:1;return c}else return r.split(" ")}});let l;s.codes?l=s.codes.map(r=>r.split(" ")):l=Nl;const o=[0,1,2,3].map(r=>n[r].map((a,c)=>({key:a,code:l[r][c]})));return[{keyType:e==="two-rows"?"black":null,startNoteOffset:2,availableNotes:11,keys:o[0]},{keyType:e==="two-rows"?"white":"black",startNoteOffset:e==="two-rows"?1:2,availableNotes:12,keys:o[1]},{keyType:e==="two-rows"?"black":"white",startNoteOffset:1,availableNotes:12,keys:o[2]},{keyType:e==="two-rows"?"white":null,startNoteOffset:1,availableNotes:11,keys:o[3]}]}const An=[{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]}];class Sl{constructor(e){return this.rows=An,this.setCustomRow={row:An[0],rowIndex:0,nextKeyIdx:-1,nextNoteOffset:0},this.opts={hotkeydRows:"middle-row",isCustom:!1,layout:{code:"en",name:"English",imported:Cl(Tl)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=qr(e,this.opts.hotkeydRows),this}setRows(e){return this.rows=e,this}setNotes(e){if(this.opts.hotkeydRows==="middle-row"){const{firstIndex:t}=Ot(this.rows[2],e);Ot(this.rows[1],e,1+t)}else{const{firstIndex:t,lastIndex:n}=Ot(this.rows[3],e);Ot(this.rows[2],e,t);const{firstIndex:l}=Ot(this.rows[1],e,0,n+1);Ot(this.rows[0],e,1+l,n+1)}}startSetCustomRow(e){const t={...this.rows[e],keys:this.rows[e].keys.map(a=>({...a}))},{availableNotes:n,startNoteOffset:l}=t,o=this.opts.hotkeydRows==="two-rows"&&(e===0||e===1)?3:-1,r=o!==-1?this.rows[o].keys.reduce((a,c)=>(a===-1&&c.note?a=0:a!==-1&&(c.key[0]!=="{"||c.key==="{empty}")&&(a+=1),a),-1)+1:0;return this.setCustomRow={row:t,rowIndex:e,nextKeyIdx:l,nextNoteOffset:r},{first:l,count:n}}setNextCustomNote(e,t,n){let l;const{nextKeyIdx:o,nextNoteOffset:r,row:a}=this.setCustomRow,c=o+r-a.startNoteOffset,i=Hr(a,n,c);return i?l={key:e,code:t,note:i}:l={key:e,code:t},this.setCustomRow.nextKeyIdx+=1,{index:this.setCustomRow.nextKeyIdx,key:l}}skipNextCustomNote(){return this.setCustomRow.nextKeyIdx+=1,this.setCustomRow.nextNoteOffset-=1,{index:this.setCustomRow.nextKeyIdx,key:{code:"EMPTY",key:"{empty}"}}}}function Wr(s){const e=[...s.map(l=>l.keys.map(o=>o.key).join(" "))],t=["","","",""];let n=!1;return s.forEach((l,o)=>{const r=[];for(let a=0;a<l.keys.length;a+=1)r.push(l.keys[a].code),n=n||l.keys[a].code!==Nl[o][a];t[o]=r.join(" ")}),n?{default:e,codes:t}:{default:e}}function Nn(s,e,t){const n=s.slice();return n[15]=e[t].key,n[16]=e[t].value,n[17]=e[t].icon,n[19]=t,n}const Jr=s=>({}),Sn=s=>({}),Yr=s=>({}),Dn=s=>({});function Ln(s){let e,t,n,l,o,r,a,c,i,d,f;const g=s[12].header,m=js(g,s,s[11],Sn);let h=_e(s[0]),y=[];for(let k=0;k<h.length;k+=1)y[k]=Vn(Nn(s,h,k));const w=k=>H(y[k],1,1,()=>{y[k]=null});return{c(){e=v("button"),n=O(),l=v("ul"),o=v("li"),m&&m.c(),r=O();for(let k=0;k<y.length;k+=1)y[k].c();this.h()},l(k){e=b(k,"BUTTON",{class:!0,tabindex:!0}),T(e).forEach(_),n=P(k),l=b(k,"UL",{class:!0});var C=T(l);o=b(C,"LI",{});var B=T(o);m&&m.l(B),B.forEach(_),r=P(C);for(let D=0;D<y.length;D+=1)y[D].l(C);C.forEach(_),this.h()},h(){p(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),p(e,"tabindex","-1"),p(l,"class",a=Ne(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,C){M(k,e,C),M(k,n,C),M(k,l,C),u(l,o),m&&m.m(o,null),u(l,r);for(let B=0;B<y.length;B+=1)y[B]&&y[B].m(l,null);i=!0,d||(f=Y(e,"click",s[7]),d=!0)},p(k,C){if(s=k,m&&m.p&&(!i||C&2048)&&Bs(m,g,s,s[11],i?Ms(g,s[11],C,Jr):Gs(s[11]),Sn),C&265){h=_e(s[0]);let B;for(B=0;B<h.length;B+=1){const D=Nn(s,h,B);y[B]?(y[B].p(D,C),U(y[B],1)):(y[B]=Vn(D),y[B].c(),U(y[B],1),y[B].m(l,null))}for(ze(),B=h.length;B<y.length;B+=1)w(B);He()}(!i||C&4&&a!==(a=Ne(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&p(l,"class",a)},i(k){if(!i){k&&cs(()=>{i&&(t||(t=Ct(e,us,{duration:as},!0)),t.run(1))}),U(m,k);for(let C=0;C<h.length;C+=1)U(y[C]);k&&cs(()=>{i&&(c||(c=Ct(l,fs,{duration:as},!0)),c.run(1))}),i=!0}},o(k){k&&(t||(t=Ct(e,us,{duration:as},!1)),t.run(0)),H(m,k),y=y.filter(Boolean);for(let C=0;C<y.length;C+=1)H(y[C]);k&&(c||(c=Ct(l,fs,{duration:as},!1)),c.run(0)),i=!1},d(k){k&&(_(e),_(n),_(l)),k&&t&&t.end(),m&&m.d(k),Ve(y,k),k&&c&&c.end(),d=!1,f()}}}function Qr(s){let e;return{c(){e=v("div"),this.h()},l(t){e=b(t,"DIV",{class:!0}),T(e).forEach(_),this.h()},h(){p(e,"class","w-[24px]")},m(t,n){M(t,e,n)},p:ge,i:ge,o:ge,d(t){t&&_(e)}}}function Xr(s){let e,t;return e=new Me({props:{class:"mr-2",icon:s[17],width:16}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p(n,l){const o={};l&1&&(o.icon=n[17]),e.$set(o)},i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function Vn(s){let e,t,n,l,o,r,a=s[16]+"",c,i,d,f,g;const m=[Xr,Qr],h=[];function y(k,C){return k[17]?0:1}n=y(s),l=h[n]=m[n](s);function w(){return s[13](s[15])}return{c(){e=v("li"),t=v("button"),l.c(),o=O(),r=v("div"),c=ee(a),i=O(),this.h()},l(k){e=b(k,"LI",{});var C=T(e);t=b(C,"BUTTON",{class:!0});var B=T(t);l.l(B),o=P(B),r=b(B,"DIV",{});var D=T(r);c=te(D,a),D.forEach(_),B.forEach(_),i=P(C),C.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),W(t,"selected",s[15]===s[3])},m(k,C){M(k,e,C),u(e,t),h[n].m(t,null),u(t,o),u(t,r),u(r,c),u(e,i),d=!0,f||(g=Y(t,"click",w),f=!0)},p(k,C){s=k;let B=n;n=y(s),n===B?h[n].p(s,C):(ze(),H(h[B],1,1,()=>{h[B]=null}),He(),l=h[n],l?l.p(s,C):(l=h[n]=m[n](s),l.c()),U(l,1),l.m(t,o)),(!d||C&1)&&a!==(a=s[16]+"")&&ye(c,a),(!d||C&9)&&W(t,"selected",s[15]===s[3])},i(k){d||(U(l),d=!0)},o(k){H(l),d=!1},d(k){k&&_(e),h[n].d(),f=!1,g()}}}function Zr(s){let e,t,n,l,o,r,a,c,i;const d=s[12].value,f=js(d,s,s[11],Dn);let g=s[6]&&Ln(s);return{c(){e=v("div"),t=v("button"),f&&f.c(),o=O(),g&&g.c(),this.h()},l(m){e=b(m,"DIV",{class:!0,id:!0});var h=T(e);t=b(h,"BUTTON",{class:!0,title:!0});var y=T(t);f&&f.l(y),y.forEach(_),o=P(h),g&&g.l(h),h.forEach(_),this.h()},h(){p(t,"class",n=Ne(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),p(t,"title",l=s[9].title||""),W(t,"disabled",s[4]),W(t,"open",s[6]),p(e,"class",r=Ne(`relative ${s[2]||""}`)+" svelte-h65upg"),p(e,"id",s[1])},m(m,h){M(m,e,h),u(e,t),f&&f.m(t,null),u(e,o),g&&g.m(e,null),s[14](e),a=!0,c||(i=Y(t,"click",s[7]),c=!0)},p(m,[h]){f&&f.p&&(!a||h&2048)&&Bs(f,d,m,m[11],a?Ms(d,m[11],h,Yr):Gs(m[11]),Dn),(!a||h&512&&n!==(n=Ne(`${m[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&p(t,"class",n),(!a||h&512&&l!==(l=m[9].title||""))&&p(t,"title",l),(!a||h&528)&&W(t,"disabled",m[4]),(!a||h&576)&&W(t,"open",m[6]),m[6]?g?(g.p(m,h),h&64&&U(g,1)):(g=Ln(m),g.c(),U(g,1),g.m(e,null)):g&&(ze(),H(g,1,1,()=>{g=null}),He()),(!a||h&4&&r!==(r=Ne(`relative ${m[2]||""}`)+" svelte-h65upg"))&&p(e,"class",r),(!a||h&2)&&p(e,"id",m[1])},i(m){a||(U(f,m),U(g),a=!0)},o(m){H(f,m),H(g),a=!1},d(m){m&&_(e),f&&f.d(m),g&&g.d(),s[14](null),c=!1,i()}}}const as=400;function eo(s,e,t){let{$$slots:n={},$$scope:l}=e,{options:o,id:r=void 0,containerClass:a=void 0,selected:c=void 0,disabled:i=void 0,onSelect:d}=e,f,g=!1;function m(){i||t(6,g=!g)}function h(k){t(6,g=d(k))}const y=k=>h(k);function w(k){gs[k?"unshift":"push"](()=>{f=k,t(5,f)})}return s.$$set=k=>{t(9,e=Ie(Ie({},e),Ae(k))),"options"in k&&t(0,o=k.options),"id"in k&&t(1,r=k.id),"containerClass"in k&&t(2,a=k.containerClass),"selected"in k&&t(3,c=k.selected),"disabled"in k&&t(4,i=k.disabled),"onSelect"in k&&t(10,d=k.onSelect),"$$scope"in k&&t(11,l=k.$$scope)},e=Ae(e),[o,r,a,c,i,f,g,m,h,e,d,l,n,y,w]}class to extends Ke{constructor(e){super(),xe(this,e,eo,Zr,Fe,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function so(s){let e,t,n,l,o,r,a,c=[s[2],{type:"checkbox"}],i={};for(let d=0;d<c.length;d+=1)i=Ie(i,c[d]);return{c(){e=v("label"),t=v("input"),n=O(),l=v("div"),this.h()},l(d){e=b(d,"LABEL",{class:!0});var f=T(e);t=b(f,"INPUT",{type:!0}),n=P(f),l=b(f,"DIV",{class:!0}),T(l).forEach(_),f.forEach(_),this.h()},h(){Ht(t,i),W(t,"svelte-k5zciy",!0),p(l,"class","slider svelte-k5zciy"),p(e,"class",o=Ne(`${s[2].containerClass||""} toggle`)+" svelte-k5zciy")},m(d,f){M(d,e,f),u(e,t),t.autofocus&&t.focus(),s[4](t),u(e,n),u(e,l),r||(a=[Y(t,"change",s[3]),Y(t,"keydown",s[1])],r=!0)},p(d,[f]){Ht(t,i=pl(c,[f&4&&d[2],{type:"checkbox"}])),W(t,"svelte-k5zciy",!0),f&4&&o!==(o=Ne(`${d[2].containerClass||""} toggle`)+" svelte-k5zciy")&&p(e,"class",o)},i:ge,o:ge,d(d){d&&_(e),s[4](null),r=!1,qe(a)}}}function no(s,e,t){let n;function l(a){a.key==="Enter"&&n.click()}function o(a){jt.call(this,s,a)}function r(a){gs[a?"unshift":"push"](()=>{n=a,t(0,n)})}return s.$$set=a=>{t(2,e=Ie(Ie({},e),Ae(a)))},e=Ae(e),[n,l,e,o,r]}class lo extends Ke{constructor(e){super(),xe(this,e,no,so,Fe,{})}}function ro(s,e,t){return e==="Escape"?{e:"hotkeys-cancel"}:e==="Space"?{e:"hotkeys-skip-key"}:s.has(e)?{e:"hotkeys-no-key"}:(s.add(e),{e:"hotkeys-captured-key",data:{code:e,key:t}})}const Ks=/^[a-gA-G]$/,Dl=/^[♭Bb#♯sS]$/,oo=/^[0-9]$/;let se="",Ye;function ao(s,e){const{useHotkeys:t}=Te(nt),n=Te(Vl).get(s);if(t&&se.length===0&&n&&n.note)return se="",{e:"guessed-key",data:n.note.note};if(!t&&se.length===0&&Ks.test(e))return se+=e.toUpperCase(),{e:"string",data:se};if(!t&&se.length>0&&Dl.test(e))return e==="b"||e==="B"?se+="♭":se+="♯",{e:"string",data:se};if(s==="Backspace"&&se.length>0)return se=se.slice(0,-1),{e:"string",data:se};if(s==="Enter"&&se.length>0){const l=se;return se="",{e:"guessed-key",data:l}}return!1}function io(s,e){if(s==="Enter"&&se.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let n=0;n<se.length;n+=1)n===0?t.note+=se[n]:t.chord.length>0?t.chord+=se[n].toLowerCase():se[n]==="♭"?(t.note+=se[n],t.flats+=1):se[n]==="♯"?(t.note+=se[n],t.sharps+=1):t.chord+=se[n].toLowerCase();return se="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&se.length>0)return se=se.slice(0,-1),{e:"string",data:se};if(se.length===0&&Ks.test(e))return se+=e.toUpperCase(),{e:"string",data:se};if(se.length>0&&e.length===1)return se.length===1&&(e==="b"||e==="B")?se+="♭":se.length===1&&e==="#"?se+="♯":se+=e,{e:"string",data:se}}return!1}function co(s,e,t){const{useAutoOctave:n,useHotkeys:l}=Te(nt);let o;const a=Te(Vl).get(s),c=(a==null?void 0:a.key)||"";let i=!1;if(!Ye&&l&&(a!=null&&a.note)?(Ye=a.note,n&&(o=_s({midi:Te(Mt)[0].midi,flats:0,sharps:0})),i="note"):!l&&se.length===0&&Ks.test(e)?(se+=e.toUpperCase(),i="input"):!l&&se.length>0&&Dl.test(e)?(e==="b"||e==="B"?se+="♭":se+="♯",i="input"):!l&&se.length>0&&s==="Enter"&&n&&(o=_s({midi:Te(Mt)[0].midi,flats:0,sharps:0}),i="octave"),!i&&oo.test(c))try{o=parseInt(c),i="octave"}catch{}if(i&&(Ye||se)&&o!==void 0){const d=(Ye==null?void 0:Ye.note)??se;return t&&(o+=1),Ye&&(Ye==null?void 0:Ye.semitones)>=12&&(o+=Math.floor(Ye.semitones/12)),Ye=void 0,se="",{e:"guessed-note",data:{note:d,octave:o}}}else if(s==="Backspace"&&(Ye||se.length>0))return Ye=void 0,se=se.slice(0,-1),{e:"string",data:se};return i==="note"?{e:"note",data:Ye}:i==="input"?{e:"string",data:se}:!1}const xs={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}"]}},Ft=new Set,Ll=new Sl({layout:xs}),dt=Oe(void 0);Wt(dt,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const Et=vt(Oe({isCustom:!1,layout:xs,hotkeydRows:"middle-row"}),{key:"keyboard-options"}),$t=Oe(Ll.rows),It=Oe(Ll);gt.subscribe(s=>{const e=Te(It);e.setNotes(Array.from(s.notesMap.values())),$t.set(e.rows),It.set(e)});Et.subscribe(s=>{const e=new Sl(s),t=Te(gt);e.setNotes(Array.from(t.notesMap.values())),$t.set(e.rows),It.set(e)});const Vl=Wt(It,s=>new Map(s.rows.flatMap(e=>e.keys.map(t=>[t.code,t])))),uo=Wt(It,s=>s.rows.flatMap(e=>e.keys).map(e=>e.note).filter(e=>e!==void 0).sort((e,t)=>e.semitones-t.semitones)),it={async setLayout(s){const e=await Fr(s),t=Te(Et);e.code!==t.layout.code&&Et.update(n=>({...n,isCustom:!1,layout:e}))},async setCustomLayout(s){s?Et.update(e=>({...e,isCustom:s,layout:{code:"custom",name:"Custom",imported:e.layout.imported}})):this.setLayout(navigator.languages)},toggleRows(s){Et.update(e=>({...e,hotkeydRows:s??(e.hotkeydRows==="middle-row"?"two-rows":"middle-row")}))},captureHotkeyRow(s){const e=Te(It),t=Te(gt),{first:n,count:l}=e.startSetCustomRow(s);dt.set({nextIndex:n,rowIndex:s,count:l,scaleNotes:Array.from(t.notesMap.values())})},findNote(s){return Te(uo).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((n,l)=>n+(l.toLowerCase()==="b"||l==="♭"?-1:l.toLowerCase()==="s"||l==="#"||l==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleHotkeyInput(s,e,t){const n=ro(Ft,e,t),l=Te(It);let o;const r=l.setCustomRow.nextKeyIdx;n.e==="hotkeys-cancel"?(dt.set(void 0),Ft.clear()):n.e==="hotkeys-skip-key"?o=l.skipNextCustomNote():n.e==="hotkeys-captured-key"&&(o=l.setNextCustomNote(n.data.key,n.data.code,s.scaleNotes));const a=Te($t);if(o&&(a[s.rowIndex].keys[r]=o.key,$t.set(a),dt.update(c=>c?{...c,nextIndex:o.index}:void 0)),s.count===r){const c=Wr(a);Et.update(i=>({...i,layout:{...i.layout,imported:c}})),dt.set(void 0),Ft.clear()}return n},handleInput(s,e,t=!1){const n=Te(Tt),l=Te(dt);return l?this.handleHotkeyInput(l,s,e):n instanceof qt?ao(s,e.toUpperCase()):n instanceof _t&&n.type==="chords-write"?io(s,e):Te(nt).useKeyboard?co(s,e.toUpperCase(),t):!1},cancelCapture(){dt.set(void 0),Ft.clear()},reset(){Et.set({isCustom:!1,layout:xs,hotkeydRows:"middle-row"}),dt.set(void 0),Ft.clear()}};function On(s){let e;return{c(){e=v("li"),this.h()},l(t){e=b(t,"LI",{class:!0}),T(e).forEach(_),this.h()},h(){p(e,"class","m-[0.175rem] mr-0")},m(t,n){M(t,e,n)},d(t){t&&_(e)}}}function Pn(s){let e;return{c(){e=v("div"),this.h()},l(t){e=b(t,"DIV",{class:!0}),T(e).forEach(_),this.h()},h(){p(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,n){M(t,e,n)},d(t){t&&_(e)}}}function jn(s){let e,t=s[0].note.note+"",n,l;return{c(){e=v("div"),n=ee(t),l=ee(s[3]),this.h()},l(o){e=b(o,"DIV",{class:!0});var r=T(e);n=te(r,t),l=te(r,s[3]),r.forEach(_),this.h()},h(){p(e,"class","absolute top-0 left-0")},m(o,r){M(o,e,r),u(e,n),u(e,l)},p(o,r){r&1&&t!==(t=o[0].note.note+"")&&ye(n,t),r&8&&ye(l,o[3])},d(o){o&&_(e)}}}function fo(s){let e,t,n,l,o,r,a=Gn(s[0].key)+"",c,i,d,f,g=s[0].key==="{enter}"&&On(),m=s[0].key==="{enter}"&&Pn(),h=s[0].note&&jn(s);return{c(){g&&g.c(),e=O(),t=v("li"),n=v("button"),m&&m.c(),l=O(),h&&h.c(),o=O(),r=v("div"),c=ee(a),this.h()},l(y){g&&g.l(y),e=P(y),t=b(y,"LI",{class:!0});var w=T(t);n=b(w,"BUTTON",{class:!0});var k=T(n);m&&m.l(k),l=P(k),h&&h.l(k),o=P(k),r=b(k,"DIV",{});var C=T(r);c=te(C,a),C.forEach(_),k.forEach(_),w.forEach(_),this.h()},h(){p(n,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),W(n,"items-center",!s[0].note),W(n,"items-end",s[0].note),p(t,"class",i=Ne(`${s[4].class||""} m-[0.175rem] ${Bn(s[1])} min-w-[32px]`)+" svelte-1479mcy"),W(t,"enter",s[0].key==="{enter}"),W(t,"captured",s[2])},m(y,w){g&&g.m(y,w),M(y,e,w),M(y,t,w),u(t,n),m&&m.m(n,null),u(n,l),h&&h.m(n,null),u(n,o),u(n,r),u(r,c),d||(f=Y(n,"click",s[10]),d=!0)},p(y,[w]){y[0].key==="{enter}"?g||(g=On(),g.c(),g.m(e.parentNode,e)):g&&(g.d(1),g=null),y[0].key==="{enter}"?m||(m=Pn(),m.c(),m.m(n,l)):m&&(m.d(1),m=null),y[0].note?h?h.p(y,w):(h=jn(y),h.c(),h.m(n,o)):h&&(h.d(1),h=null),w&1&&a!==(a=Gn(y[0].key)+"")&&ye(c,a),w&1&&W(n,"items-center",!y[0].note),w&1&&W(n,"items-end",y[0].note),w&18&&i!==(i=Ne(`${y[4].class||""} m-[0.175rem] ${Bn(y[1])} min-w-[32px]`)+" svelte-1479mcy")&&p(t,"class",i),w&19&&W(t,"enter",y[0].key==="{enter}"),w&22&&W(t,"captured",y[2])},i:ge,o:ge,d(y){y&&(_(e),_(t)),g&&g.d(y),m&&m.d(),h&&h.d(),d=!1,f()}}}function Bn(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function Gn(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function ho(s,e,t){let n,l,o,r,a,c;be(s,dt,m=>t(7,r=m)),be(s,bs,m=>t(8,a=m)),be(s,$t,m=>t(9,c=m));let{rowIndex:i,keyIndex:d}=e,f;function g(m){jt.call(this,s,m)}return s.$$set=m=>{t(4,e=Ie(Ie({},e),Ae(m))),"rowIndex"in m&&t(5,i=m.rowIndex),"keyIndex"in m&&t(6,d=m.keyIndex)},s.$$.update=()=>{s.$$.dirty&608&&t(0,n=c[i].keys[d]),s.$$.dirty&257&&t(3,l=n.note?_s({midi:n.note.semitones+a[0],flats:0,sharps:0}):0),s.$$.dirty&224&&t(2,o=r&&r.rowIndex===i&&r.nextIndex===d),s.$$.dirty&65&&(n.key==="{bksp}"?t(1,f=2):n.key==="{tab}"?t(1,f=1.5):n.key==="{enter}"?t(1,f=2):n.key==="{lock}"?t(1,f=1.75):n.key==="{shift}"&&d===0?t(1,f=1.5):n.key==="{shift}"?t(1,f=2.5):t(1,f=1))},e=Ae(e),[n,f,o,l,e,i,d,r,a,c,g]}class mo extends Ke{constructor(e){super(),xe(this,e,ho,fo,Fe,{rowIndex:5,keyIndex:6})}}function Mn(s,e,t){const n=s.slice();return n[13]=e[t],n[15]=t,n}function $n(s,e,t){const n=s.slice();return n[16]=e[t],n[18]=t,n}function _o(s){let e,t=s[0].layout.name+"",n;return{c(){e=v("div"),n=ee(t),this.h()},l(l){e=b(l,"DIV",{slot:!0});var o=T(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"slot","value")},m(l,o){M(l,e,o),u(e,n)},p(l,o){o&1&&t!==(t=l[0].layout.name+"")&&ye(n,t)},d(l){l&&_(e)}}}function Rn(s){let e,t,n,l,o;t=new Me({props:{icon:Rl,width:20}});function r(){return s[12](s[15])}return{c(){e=v("button"),ue(t.$$.fragment),this.h()},l(a){e=b(a,"BUTTON",{class:!0});var c=T(e);fe(t.$$.fragment,c),c.forEach(_),this.h()},h(){p(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(a,c){M(a,e,c),de(t,e,null),n=!0,l||(o=Y(e,"click",r),l=!0)},p(a,c){s=a},i(a){n||(U(t.$$.fragment,a),n=!0)},o(a){H(t.$$.fragment,a),n=!1},d(a){a&&_(e),he(t),l=!1,o()}}}function Un(s){let e,t;return e=new mo({props:{rowIndex:s[15],keyIndex:s[18]}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p:ge,i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){H(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function Kn(s){let e,t,n,l,o=s[2][s[15]]&&s[0].isCustom&&Rn(s),r=_e(s[13].keys),a=[];for(let i=0;i<r.length;i+=1)a[i]=Un($n(s,r,i));const c=i=>H(a[i],1,1,()=>{a[i]=null});return{c(){e=v("li"),o&&o.c(),t=O();for(let i=0;i<a.length;i+=1)a[i].c();n=Le(),this.h()},l(i){e=b(i,"LI",{class:!0});var d=T(e);o&&o.l(d),d.forEach(_),t=P(i);for(let f=0;f<a.length;f+=1)a[f].l(i);n=Le(),this.h()},h(){p(e,"class","col-span-2 svelte-1av9wwd")},m(i,d){M(i,e,d),o&&o.m(e,null),M(i,t,d);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(i,d);M(i,n,d),l=!0},p(i,d){if(i[2][i[15]]&&i[0].isCustom?o?(o.p(i,d),d&5&&U(o,1)):(o=Rn(i),o.c(),U(o,1),o.m(e,null)):o&&(ze(),H(o,1,1,()=>{o=null}),He()),d&8){r=_e(i[13].keys);let f;for(f=0;f<r.length;f+=1){const g=$n(i,r,f);a[f]?(a[f].p(g,d),U(a[f],1)):(a[f]=Un(g),a[f].c(),U(a[f],1),a[f].m(n.parentNode,n))}for(ze(),f=r.length;f<a.length;f+=1)c(f);He()}},i(i){if(!l){U(o);for(let d=0;d<r.length;d+=1)U(a[d]);l=!0}},o(i){H(o),a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)H(a[d]);l=!1},d(i){i&&(_(e),_(t),_(n)),o&&o.d(),Ve(a,i)}}}function po(s){let e,t,n,l,o,r="Layout",a,c,i,d,f,g="Custom",m,h,y,w,k,C="One row",B,D,$,E,j="Two rows",N,I,L,S,V,A,G,R,x,Q,F;c=new to({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1 w-36",options:s[4],onSelect:s[6],$$slots:{value:[_o]},$$scope:{ctx:s}}}),h=new Nt({props:{id:"custom-layout",checked:s[0].isCustom}}),h.$on("change",s[7]),D=new lo({props:{checked:!s[1]}}),D.$on("change",s[9]),S=new Me({props:{icon:Jt,width:16}});let X=_e(s[3].rows),Z=[];for(let J=0;J<X.length;J+=1)Z[J]=Kn(Mn(s,X,J));const K=J=>H(Z[J],1,1,()=>{Z[J]=null});return{c(){e=v("div"),t=v("div"),n=v("div"),l=v("div"),o=v("label"),o.textContent=r,a=O(),ue(c.$$.fragment),i=O(),d=v("div"),f=v("label"),f.textContent=g,m=O(),ue(h.$$.fragment),y=O(),w=v("div"),k=v("label"),k.textContent=C,B=O(),ue(D.$$.fragment),$=O(),E=v("label"),E.textContent=j,N=O(),I=v("div"),L=v("button"),ue(S.$$.fragment),V=O(),A=v("div"),G=v("ul");for(let J=0;J<Z.length;J+=1)Z[J].c();this.h()},l(J){e=b(J,"DIV",{class:!0});var z=T(e);t=b(z,"DIV",{class:!0});var me=T(t);n=b(me,"DIV",{class:!0});var pe=T(n);l=b(pe,"DIV",{class:!0});var $e=T(l);o=b($e,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(o)!=="svelte-1xsr9lq"&&(o.textContent=r),a=P($e),fe(c.$$.fragment,$e),$e.forEach(_),i=P(pe),d=b(pe,"DIV",{class:!0});var ie=T(d);f=b(ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(f)!=="svelte-11aw8ub"&&(f.textContent=g),m=P(ie),fe(h.$$.fragment,ie),ie.forEach(_),y=P(pe),w=b(pe,"DIV",{class:!0});var ce=T(w);k=b(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(k)!=="svelte-17p0yvw"&&(k.textContent=C),B=P(ce),fe(D.$$.fragment,ce),$=P(ce),E=b(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(E)!=="svelte-1wr3nwv"&&(E.textContent=j),ce.forEach(_),pe.forEach(_),N=P(me),I=b(me,"DIV",{class:!0});var le=T(I);L=b(le,"BUTTON",{class:!0});var oe=T(L);fe(S.$$.fragment,oe),oe.forEach(_),le.forEach(_),me.forEach(_),V=P(z),A=b(z,"DIV",{class:!0});var ve=T(A);G=b(ve,"UL",{class:!0});var ke=T(G);for(let tt=0;tt<Z.length;tt+=1)Z[tt].l(ke);ke.forEach(_),ve.forEach(_),z.forEach(_),this.h()},h(){p(o,"class","font-bold mr-4"),p(o,"for","middle-row"),p(l,"class","my-1 flex items-center justify-between mr-2"),p(f,"class","font-bold mr-4"),p(f,"for","custom-layout"),p(d,"class","my-1 flex items-center"),p(k,"class","font-bold mr-4"),p(k,"for","two-rows"),p(E,"class","font-bold ml-4"),p(E,"for","two-rows"),p(w,"class","my-1 flex items-center"),p(n,"class","options svelte-1av9wwd"),p(L,"class","rounded px-1 py-1 hover:bg-gray-200"),p(I,"class","flex items-center justify-center"),p(t,"class","flex justify-between"),p(G,"class","keyboard svelte-1av9wwd"),p(A,"class","flex flex-col"),p(e,"class",R=Ne(`${s[10].class||""} relative`)+" svelte-1av9wwd")},m(J,z){M(J,e,z),u(e,t),u(t,n),u(n,l),u(l,o),u(l,a),de(c,l,null),u(n,i),u(n,d),u(d,f),u(d,m),de(h,d,null),u(n,y),u(n,w),u(w,k),u(w,B),de(D,w,null),u(w,$),u(w,E),u(t,N),u(t,I),u(I,L),de(S,L,null),u(e,V),u(e,A),u(A,G);for(let me=0;me<Z.length;me+=1)Z[me]&&Z[me].m(G,null);x=!0,Q||(F=Y(L,"click",s[5]),Q=!0)},p(J,[z]){const me={};z&524289&&(me.$$scope={dirty:z,ctx:J}),c.$set(me);const pe={};z&1&&(pe.checked=J[0].isCustom),h.$set(pe);const $e={};if(z&2&&($e.checked=!J[1]),D.$set($e),z&269){X=_e(J[3].rows);let ie;for(ie=0;ie<X.length;ie+=1){const ce=Mn(J,X,ie);Z[ie]?(Z[ie].p(ce,z),U(Z[ie],1)):(Z[ie]=Kn(ce),Z[ie].c(),U(Z[ie],1),Z[ie].m(G,null))}for(ze(),ie=X.length;ie<Z.length;ie+=1)K(ie);He()}(!x||z&1024&&R!==(R=Ne(`${J[10].class||""} relative`)+" svelte-1av9wwd"))&&p(e,"class",R)},i(J){if(!x){U(c.$$.fragment,J),U(h.$$.fragment,J),U(D.$$.fragment,J),U(S.$$.fragment,J);for(let z=0;z<X.length;z+=1)U(Z[z]);x=!0}},o(J){H(c.$$.fragment,J),H(h.$$.fragment,J),H(D.$$.fragment,J),H(S.$$.fragment,J),Z=Z.filter(Boolean);for(let z=0;z<Z.length;z+=1)H(Z[z]);x=!1},d(J){J&&_(e),he(c),he(h),he(D),he(S),Ve(Z,J),Q=!1,F()}}}function go(s,e,t){let n,l,o,r,a;be(s,Et,y=>t(0,o=y)),be(s,$t,y=>t(11,r=y)),be(s,It,y=>t(3,a=y)),gl(()=>{a.opts.isCustom||it.setLayout(navigator.languages)});const c=Object.entries(Os).map(([y,w])=>({key:y,value:w.name}));function i(){it.reset(),it.setLayout(navigator.languages)}function d(y){return it.setLayout([y]),!1}function f(y){it.setCustomLayout(y.currentTarget.checked)}function g(y){it.captureHotkeyRow(y)}function m(){it.toggleRows()}const h=y=>g(y);return s.$$set=y=>{t(10,e=Ie(Ie({},e),Ae(y)))},s.$$.update=()=>{s.$$.dirty&2049&&t(2,n=r.map((y,w)=>o.hotkeydRows==="middle-row"?w===1||w===2:!0)),s.$$.dirty&1&&t(1,l=o.hotkeydRows==="middle-row")},e=Ae(e),[o,l,n,a,c,i,d,f,g,m,e,r,h]}class vo extends Ke{constructor(e){super(),xe(this,e,go,po,Fe,{})}}function xn(s){let e,t="Hotkeys",n,l,o;return l=new vo({}),{c(){e=v("h4"),e.textContent=t,n=O(),ue(l.$$.fragment),this.h()},l(r){e=b(r,"H4",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-q0v9va"&&(e.textContent=t),n=P(r),fe(l.$$.fragment,r),this.h()},h(){p(e,"class","mt-4 font-bold text-lg")},m(r,a){M(r,e,a),M(r,n,a),de(l,r,a),o=!0},i(r){o||(U(l.$$.fragment,r),o=!0)},o(r){H(l.$$.fragment,r),o=!1},d(r){r&&(_(e),_(n)),he(l,r)}}}function bo(s){let e,t,n,l,o="I/O",r,a,c,i,d,f,g,m,h="Device",y,w,k,C,B,D,$="Prompt",E,j,N="Disable",I,L,S,V,A="Sound",G,R,x,Q,F,X="Fixed velocity",Z,K,J,z,me,pe,$e="Keyboard",ie,ce,le,oe,ve,ke="Hotkeys",tt,q,re,Ee,Re,ne="Auto-octave",We,je,ct,et,Qe,Je=" ",St,ut,Ue,ys,Yt,ks,bt,yt,Fs="Fade timeout",ws,ft,Es,Qt,lt,Cs,zs;i=new Me({props:{icon:Jt,width:16}}),R=new Nt({props:{id:"sound",checked:s[3].useSound}}),R.$on("change",s[13]),ce=new Nt({props:{id:"keyboard",checked:s[3].useKeyboard}}),ce.$on("change",s[15]),q=new Nt({props:{id:"hotkeys",checked:s[3].useHotkeys}}),q.$on("change",s[9]),je=new Nt({props:{id:"auto-octave",checked:s[3].useAutoOctave}}),je.$on("change",s[16]);let Be=s[2]&&!s[4]&&xn();return{c(){e=v("div"),t=v("fieldset"),n=v("legend"),l=v("button"),l.textContent=o,r=O(),a=v("div"),c=v("button"),ue(i.$$.fragment),d=O(),f=v("div"),g=v("div"),m=v("label"),m.textContent=h,y=O(),w=v("input"),C=O(),B=v("div"),D=v("button"),D.textContent=$,E=O(),j=v("button"),j.textContent=N,I=O(),L=v("div"),S=v("div"),V=v("label"),V.textContent=A,G=O(),ue(R.$$.fragment),x=O(),Q=v("div"),F=v("label"),F.textContent=X,Z=O(),K=v("input"),J=O(),z=v("div"),me=v("div"),pe=v("label"),pe.textContent=$e,ie=O(),ue(ce.$$.fragment),le=O(),oe=v("div"),ve=v("label"),ve.textContent=ke,tt=O(),ue(q.$$.fragment),re=O(),Ee=v("div"),Re=v("label"),Re.textContent=ne,We=O(),ue(je.$$.fragment),ct=O(),et=v("div"),Qe=v("div"),Qe.textContent=Je,St=O(),ut=v("div"),Ue=v("button"),ys=ee("Set hotkeys"),ks=O(),bt=v("div"),yt=v("label"),yt.textContent=Fs,ws=O(),ft=v("input"),Es=O(),Be&&Be.c(),this.h()},l(we){e=b(we,"DIV",{class:!0});var Ge=T(e);t=b(Ge,"FIELDSET",{class:!0});var rt=T(t);n=b(rt,"LEGEND",{class:!0});var Rt=T(n);l=b(Rt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1jbbsti"&&(l.textContent=o),Rt.forEach(_),r=P(rt),a=b(rt,"DIV",{class:!0});var Ut=T(a);c=b(Ut,"BUTTON",{class:!0});var Kt=T(c);fe(i.$$.fragment,Kt),Kt.forEach(_),Ut.forEach(_),d=P(rt),f=b(rt,"DIV",{class:!0});var kt=T(f);g=b(kt,"DIV",{class:!0});var Dt=T(g);m=b(Dt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(m)!=="svelte-crpa7y"&&(m.textContent=h),y=P(Dt),w=b(Dt,"INPUT",{class:!0,id:!0}),C=P(Dt),B=b(Dt,"DIV",{class:!0});var Xt=T(B);D=b(Xt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(D)!=="svelte-mj6mct"&&(D.textContent=$),E=P(Xt),j=b(Xt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(j)!=="svelte-1sl6oxh"&&(j.textContent=N),Xt.forEach(_),Dt.forEach(_),I=P(kt),L=b(kt,"DIV",{class:!0});var Zt=T(L);S=b(Zt,"DIV",{class:!0});var es=T(S);V=b(es,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(V)!=="svelte-wgxtkw"&&(V.textContent=A),G=P(es),fe(R.$$.fragment,es),es.forEach(_),x=P(Zt),Q=b(Zt,"DIV",{class:!0});var ts=T(Q);F=b(ts,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(F)!=="svelte-1tm2bth"&&(F.textContent=X),Z=P(ts),K=b(ts,"INPUT",{class:!0,id:!0,placeholder:!0}),ts.forEach(_),Zt.forEach(_),J=P(kt),z=b(kt,"DIV",{class:!0});var Lt=T(z);me=b(Lt,"DIV",{class:!0});var ss=T(me);pe=b(ss,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(pe)!=="svelte-1js269u"&&(pe.textContent=$e),ie=P(ss),fe(ce.$$.fragment,ss),ss.forEach(_),le=P(Lt),oe=b(Lt,"DIV",{class:!0});var ns=T(oe);ve=b(ns,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(ve)!=="svelte-21h39k"&&(ve.textContent=ke),tt=P(ns),fe(q.$$.fragment,ns),ns.forEach(_),re=P(Lt),Ee=b(Lt,"DIV",{class:!0});var ls=T(Ee);Re=b(ls,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Re)!=="svelte-33lczu"&&(Re.textContent=ne),We=P(ls),fe(je.$$.fragment,ls),ls.forEach(_),Lt.forEach(_),ct=P(kt),et=b(kt,"DIV",{class:!0});var Vt=T(et);Qe=b(Vt,"DIV",{class:!0,"data-svelte-h":!0}),ae(Qe)!=="svelte-dgefms"&&(Qe.textContent=Je),St=P(Vt),ut=b(Vt,"DIV",{class:!0});var Hs=T(ut);Ue=b(Hs,"BUTTON",{class:!0});var qs=T(Ue);ys=te(qs,"Set hotkeys"),qs.forEach(_),Hs.forEach(_),ks=P(Vt),bt=b(Vt,"DIV",{class:!0});var rs=T(bt);yt=b(rs,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(yt)!=="svelte-vd5i27"&&(yt.textContent=Fs),ws=P(rs),ft=b(rs,"INPUT",{class:!0,id:!0}),rs.forEach(_),Vt.forEach(_),kt.forEach(_),Es=P(rt),Be&&Be.l(rt),rt.forEach(_),Ge.forEach(_),this.h()},h(){p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(c,"class","rounded px-1 py-1 hover:bg-gray-200"),p(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center"),W(a,"hidden",s[4]),p(m,"class","font-bold"),p(m,"for","device"),p(w,"class","px-1 my-1 rounded w-50"),p(w,"id","device"),w.disabled=!0,w.value=k="data"in s[5]?s[5].data.name:s[5].err,p(D,"class","btn-sm primary mr-2"),p(j,"class","btn-sm primary"),p(B,"class","flex my-[auto]"),p(g,"class","h-full flex flex-col"),p(V,"class","font-bold"),p(V,"for","sound"),p(S,"class","my-1 flex justify-between items-center mr-12"),p(F,"class","font-bold"),p(F,"for","fixed-velocity"),p(K,"class","h-[20px] w-16"),p(K,"id","fixed-velocity"),p(K,"placeholder","0-127"),p(Q,"class","flex justify-between"),p(L,"class","flex flex-col h-full"),p(pe,"class","font-bold"),p(pe,"for","keyboard"),p(me,"class","my-1 flex justify-between items-center mr-12"),p(ve,"class","font-bold"),p(ve,"for","hotkeys"),p(oe,"class","my-1 flex justify-between items-center mr-12"),p(Re,"class","font-bold"),p(Re,"for","auto-octave"),p(Ee,"class","my-1 flex justify-between items-center mr-12"),p(z,"class","flex flex-col h-full"),p(Qe,"class","h-[28px]"),p(Ue,"class","w-full btn-sm primary"),Ue.disabled=Yt=!s[3].useHotkeys,p(ut,"class","my-[2px] flex justify-between"),p(yt,"class","font-bold"),p(yt,"for","fade-timeout"),p(ft,"class","h-[20px] w-16"),p(ft,"id","fade-timeout"),ft.value=s[1],p(bt,"class","my-1 flex justify-between"),p(et,"class","flex flex-col h-full"),p(f,"class","body svelte-1bpw69s"),W(f,"hidden",s[4]),p(t,"class","relative flex flex-col max-w-full rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),W(t,"collapsed",s[4]),p(e,"class",Qt=Ne(`${s[12].class||""}`)+" svelte-1bpw69s")},m(we,Ge){M(we,e,Ge),u(e,t),u(t,n),u(n,l),u(t,r),u(t,a),u(a,c),de(i,c,null),u(t,d),u(t,f),u(f,g),u(g,m),u(g,y),u(g,w),u(g,C),u(g,B),u(B,D),u(B,E),u(B,j),u(f,I),u(f,L),u(L,S),u(S,V),u(S,G),de(R,S,null),u(L,x),u(L,Q),u(Q,F),u(Q,Z),u(Q,K),Ze(K,s[0]),u(f,J),u(f,z),u(z,me),u(me,pe),u(me,ie),de(ce,me,null),u(z,le),u(z,oe),u(oe,ve),u(oe,tt),de(q,oe,null),u(z,re),u(z,Ee),u(Ee,Re),u(Ee,We),de(je,Ee,null),u(f,ct),u(f,et),u(et,Qe),u(et,St),u(et,ut),u(ut,Ue),u(Ue,ys),u(et,ks),u(et,bt),u(bt,yt),u(bt,ws),u(bt,ft),u(t,Es),Be&&Be.m(t,null),lt=!0,Cs||(zs=[Y(l,"click",s[7]),Y(c,"click",s[11]),Y(D,"click",Pe.openMidi),Y(j,"click",Pe.disableMidi),Y(K,"input",s[14]),Y(K,"change",s[8]),Y(Ue,"click",s[17]),Y(ft,"input",s[10])],Cs=!0)},p(we,[Ge]){(!lt||Ge&16)&&W(a,"hidden",we[4]),(!lt||Ge&32&&k!==(k="data"in we[5]?we[5].data.name:we[5].err)&&w.value!==k)&&(w.value=k);const rt={};Ge&8&&(rt.checked=we[3].useSound),R.$set(rt),Ge&1&&K.value!==we[0]&&Ze(K,we[0]);const Rt={};Ge&8&&(Rt.checked=we[3].useKeyboard),ce.$set(Rt);const Ut={};Ge&8&&(Ut.checked=we[3].useHotkeys),q.$set(Ut);const Kt={};Ge&8&&(Kt.checked=we[3].useAutoOctave),je.$set(Kt),(!lt||Ge&8&&Yt!==(Yt=!we[3].useHotkeys))&&(Ue.disabled=Yt),(!lt||Ge&2&&ft.value!==we[1])&&(ft.value=we[1]),(!lt||Ge&16)&&W(f,"hidden",we[4]),we[2]&&!we[4]?Be?Ge&20&&U(Be,1):(Be=xn(),Be.c(),U(Be,1),Be.m(t,null)):Be&&(ze(),H(Be,1,1,()=>{Be=null}),He()),(!lt||Ge&16)&&W(t,"collapsed",we[4]),(!lt||Ge&4096&&Qt!==(Qt=Ne(`${we[12].class||""}`)+" svelte-1bpw69s"))&&p(e,"class",Qt)},i(we){lt||(U(i.$$.fragment,we),U(R.$$.fragment,we),U(ce.$$.fragment,we),U(q.$$.fragment,we),U(je.$$.fragment,we),U(Be),lt=!0)},o(we){H(i.$$.fragment,we),H(R.$$.fragment,we),H(ce.$$.fragment,we),H(q.$$.fragment,we),H(je.$$.fragment,we),H(Be),lt=!1},d(we){we&&_(e),he(i),he(R),he(ce),he(q),he(je),Be&&Be.d(),Cs=!1,qe(zs)}}}function yo(s,e,t){let n,l,o;be(s,nt,D=>t(3,n=D)),be(s,ps,D=>t(5,o=D));const r=vt(Oe(!1),{key:"inputs-hidden"});be(s,r,D=>t(4,l=D));let a=n.fixedVelocity??"",c=n.keyFadeTimeout,i=!1;nt.subscribe(D=>{t(0,a=D.fixedVelocity??""),t(1,c=D.keyFadeTimeout)});function d(){r.update(D=>!D)}function f(D){const{value:$}=D.currentTarget;let E;if($)try{E=parseInt($)}catch{}E!==void 0&&E>=0&&E<=127?Pe.setInputValue("fixedVelocity",E):$?t(0,a=n.fixedVelocity||""):Pe.setInputValue("fixedVelocity",void 0)}function g(D){Pe.setInputValue("useHotkeys",D.currentTarget.checked),D.currentTarget.checked||(t(2,i=!1),it.cancelCapture())}function m(D){try{const $=parseInt(D.currentTarget.value);Pe.setInputValue("keyFadeTimeout",$)}catch{t(1,c=n.keyFadeTimeout)}}function h(){Pe.setInputValue("useSound",!0),Pe.setInputValue("fixedVelocity",void 0),Pe.setInputValue("useKeyboard",!0),Pe.setInputValue("useHotkeys",!0),Pe.setInputValue("useAutoOctave",!0),Pe.setInputValue("keyFadeTimeout",1500)}const y=D=>Pe.setInputValue("useSound",D.currentTarget.checked);function w(){a=this.value,t(0,a)}const k=D=>Pe.setInputValue("useKeyboard",D.currentTarget.checked),C=D=>Pe.setInputValue("useAutoOctave",D.currentTarget.checked),B=()=>t(2,i=!i);return s.$$set=D=>{t(12,e=Ie(Ie({},e),Ae(D)))},e=Ae(e),[a,c,i,n,l,o,r,d,f,g,m,h,e,y,w,k,C,B]}class ko extends Ke{constructor(e){super(),xe(this,e,yo,bo,Fe,{})}}function wo(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){M(t,e,n)},p:ge,d(t){t&&_(e)}}}function Eo(s){let e,t=s[1].note+"",n;return{c(){e=ee("Input: "),n=ee(t)},l(l){e=te(l,"Input: "),n=te(l,t)},m(l,o){M(l,e,o),M(l,n,o)},p(l,o){o&2&&t!==(t=l[1].note+"")&&ye(n,t)},d(l){l&&(_(e),_(n))}}}function Co(s){let e,t;return{c(){e=ee("Input: "),t=ee(s[0])},l(n){e=te(n,"Input: "),t=te(n,s[0])},m(n,l){M(n,e,l),M(n,t,l)},p(n,l){l&1&&ye(t,n[0])},d(n){n&&(_(e),_(t))}}}function To(s){let e;return{c(){e=ee(Ps)},l(t){e=te(t,Ps)},m(t,n){M(t,e,n)},p:ge,d(t){t&&_(e)}}}function Io(s){let e,t,n,l;function o(c,i){return c[2].useKeyboard&&Ps?To:c[2].useKeyboard&&c[0]?Co:c[2].useKeyboard&&c[1]?Eo:wo}let r=o(s),a=r(s);return{c(){e=v("div"),a.c(),this.h()},l(c){e=b(c,"DIV",{class:!0});var i=T(e);a.l(i),i.forEach(_),this.h()},h(){p(e,"class",t=`${s[4].class||""}`)},m(c,i){M(c,e,i),a.m(e,null),n||(l=Y(window,"keydown",s[3]),n=!0)},p(c,[i]){r===(r=o(c))&&a?a.p(c,i):(a.d(1),a=r(c),a&&(a.c(),a.m(e,null))),i&16&&t!==(t=`${c[4].class||""}`)&&p(e,"class",t)},i:ge,o:ge,d(c){c&&_(e),a.d(),n=!1,l()}}}let Ps="";function Ao(s,e,t){let n;be(s,nt,i=>t(2,n=i));let{debounced:l}=e,o="",r;const a=jl();function c(i){const d=i.target;if(l||!(d instanceof HTMLElement)||d.tagName==="INPUT")return;const f=it.handleInput(i.code,i.key,i.shiftKey);f&&f.e==="note"?t(1,r=f.data):f&&f.e==="string"?t(0,o=f.data):f&&(f.e==="guessed-key"||f.e==="guessed-chord"||f.e==="guessed-note")?(t(0,o=""),t(1,r=void 0),a(f.e,f.data),i.code==="Enter"&&i.preventDefault()):f&&i.preventDefault()}return s.$$set=i=>{t(4,e=Ie(Ie({},e),Ae(i))),"debounced"in i&&t(5,l=i.debounced)},e=Ae(e),[o,r,n,c,e,l]}class No extends Ke{constructor(e){super(),xe(this,e,Ao,Io,Fe,{debounced:5})}}function So(s){let e,t,n,l="Count",o,r,a,c,i,d="Duplicates",f,g,m,h,y,w="Autoplay",k,C,B,D,$,E="Wait seconds",j,N,I,L,S,V;return g=new Nt({props:{id:"duplicates",checked:s[2].duplicates}}),g.$on("input",s[7]),C=new Nt({props:{id:"autoplay",checked:s[2].autoplay}}),C.$on("input",s[8]),{c(){e=v("ul"),t=v("li"),n=v("label"),n.textContent=l,o=O(),r=v("input"),a=O(),c=v("li"),i=v("label"),i.textContent=d,f=O(),ue(g.$$.fragment),m=O(),h=v("li"),y=v("label"),y.textContent=w,k=O(),ue(C.$$.fragment),B=O(),D=v("li"),$=v("label"),$.textContent=E,j=O(),N=v("input"),this.h()},l(A){e=b(A,"UL",{class:!0});var G=T(e);t=b(G,"LI",{class:!0});var R=T(t);n=b(R,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(n)!=="svelte-wgq9fc"&&(n.textContent=l),o=P(R),r=b(R,"INPUT",{class:!0,id:!0,type:!0}),R.forEach(_),a=P(G),c=b(G,"LI",{class:!0});var x=T(c);i=b(x,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(i)!=="svelte-hcg9dq"&&(i.textContent=d),f=P(x),fe(g.$$.fragment,x),x.forEach(_),m=P(G),h=b(G,"LI",{class:!0});var Q=T(h);y=b(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(y)!=="svelte-lr68n2"&&(y.textContent=w),k=P(Q),fe(C.$$.fragment,Q),Q.forEach(_),B=P(G),D=b(G,"LI",{class:!0});var F=T(D);$=b(F,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae($)!=="svelte-1qj2vcy"&&($.textContent=E),j=P(F),N=b(F,"INPUT",{class:!0,id:!0,type:!0}),F.forEach(_),G.forEach(_),this.h()},h(){p(n,"class","font-bold"),p(n,"for","guess-count"),p(r,"class","h-[20px] w-10"),p(r,"id","guess-count"),p(r,"type","number"),p(t,"class","flex items-center justify-between svelte-1elvih2"),p(i,"class","font-bold"),p(i,"for","duplicates"),p(c,"class","flex items-center justify-between items-center mr-6 svelte-1elvih2"),p(y,"class","font-bold"),p(y,"for","autoplay"),p(h,"class","flex items-center justify-between items-center mr-6 svelte-1elvih2"),p($,"class","font-bold"),p($,"for","wait-ms"),p(N,"class","h-[20px] w-10"),p(N,"id","wait-ms"),p(N,"type","number"),p(D,"class","flex items-center justify-between svelte-1elvih2"),p(e,"class",I=Ne(`${s[5].class||""}`)+" svelte-1elvih2")},m(A,G){M(A,e,G),u(e,t),u(t,n),u(t,o),u(t,r),Ze(r,s[0]),u(e,a),u(e,c),u(c,i),u(c,f),de(g,c,null),u(e,m),u(e,h),u(h,y),u(h,k),de(C,h,null),u(e,B),u(e,D),u(D,$),u(D,j),u(D,N),Ze(N,s[1]),L=!0,S||(V=[Y(r,"input",s[6]),Y(r,"input",s[3]),Y(N,"input",s[9]),Y(N,"input",s[4])],S=!0)},p(A,[G]){G&1&&ds(r.value)!==A[0]&&Ze(r,A[0]);const R={};G&4&&(R.checked=A[2].duplicates),g.$set(R);const x={};G&4&&(x.checked=A[2].autoplay),C.$set(x),G&2&&ds(N.value)!==A[1]&&Ze(N,A[1]),(!L||G&32&&I!==(I=Ne(`${A[5].class||""}`)+" svelte-1elvih2"))&&p(e,"class",I)},i(A){L||(U(g.$$.fragment,A),U(C.$$.fragment,A),L=!0)},o(A){H(g.$$.fragment,A),H(C.$$.fragment,A),L=!1},d(A){A&&_(e),he(g),he(C),S=!1,qe(V)}}}function Do(s,e,t){let n;be(s,pt,g=>t(2,n=g));let l=n.count||"",o=n.waitSeconds||"";pt.subscribe(g=>{t(0,l=g.count||""),t(1,o=g.waitSeconds||"")});function r({currentTarget:{value:g}}){let m;try{m=parseInt(g),m<=0&&(m=1),De.setOptionValue("count",m)}catch{t(0,l=n.count)}}function a({currentTarget:{value:g}}){let m;try{m=parseInt(g),m<0&&(m=0),De.setOptionValue("waitSeconds",m)}catch{t(1,o=n.waitSeconds)}}function c(){l=ds(this.value),t(0,l)}const i=g=>De.setOptionValue("duplicates",g.currentTarget.checked),d=g=>De.setOptionValue("autoplay",g.currentTarget.checked);function f(){o=ds(this.value),t(1,o)}return s.$$set=g=>{t(5,e=Ie(Ie({},e),Ae(g)))},e=Ae(e),[l,o,n,r,a,e,c,i,d,f]}class Lo extends Ke{constructor(e){super(),xe(this,e,Do,So,Fe,{})}}function Fn(s,e,t){const n=s.slice();return n[22]=e[t].key,n[23]=e[t].value,n}function zn(s,e,t){const n=s.slice();return n[22]=e[t].key,n[23]=e[t].value,n}function Hn(s){let e,t,n=s[23]+"",l,o,r,a,c,i,d,f;function g(){return s[15](s[22])}a=new Me({props:{icon:Ss,width:20}});function m(...h){return s[16](s[22],...h)}return{c(){e=v("li"),t=v("button"),l=ee(n),o=O(),r=v("button"),ue(a.$$.fragment),c=O(),this.h()},l(h){e=b(h,"LI",{class:!0});var y=T(e);t=b(y,"BUTTON",{class:!0});var w=T(t);l=te(w,n),w.forEach(_),o=P(y),r=b(y,"BUTTON",{class:!0});var k=T(r);fe(a.$$.fragment,k),k.forEach(_),c=P(y),y.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded text-left hover:bg-[#eee] svelte-1okhpct"),W(t,"selected",s[22]===s[0]),p(r,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),p(e,"class","flex svelte-1okhpct")},m(h,y){M(h,e,y),u(e,t),u(t,l),u(e,o),u(e,r),de(a,r,null),u(e,c),i=!0,d||(f=[Y(t,"click",g),Y(r,"click",m)],d=!0)},p(h,y){s=h,(!i||y&17)&&W(t,"selected",s[22]===s[0])},i(h){i||(U(a.$$.fragment,h),i=!0)},o(h){H(a.$$.fragment,h),i=!1},d(h){h&&_(e),he(a),d=!1,qe(f)}}}function qn(s){let e,t=_e(s[3]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Wn(Fn(s,t,l));return{c(){e=v("ul");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=b(l,"UL",{class:!0});var o=T(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(_),this.h()},h(){p(e,"class","svelte-1okhpct")},m(l,o){M(l,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(l,o){if(o&138){t=_e(l[3]);let r;for(r=0;r<t.length;r+=1){const a=Fn(l,t,r);n[r]?n[r].p(a,o):(n[r]=Wn(a),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function Wn(s){let e,t,n=s[23]+"",l,o,r,a;function c(){return s[17](s[22])}return{c(){e=v("li"),t=v("button"),l=ee(n),o=O(),this.h()},l(i){e=b(i,"LI",{class:!0});var d=T(e);t=b(d,"BUTTON",{class:!0});var f=T(t);l=te(f,n),f.forEach(_),o=P(d),d.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded text-left hover:bg-[#eee] svelte-1okhpct"),W(t,"selected",s[22]===s[1]),p(e,"class","svelte-1okhpct")},m(i,d){M(i,e,d),u(e,t),u(t,l),u(e,o),r||(a=Y(t,"click",c),r=!0)},p(i,d){s=i,d&8&&n!==(n=s[23]+"")&&ye(l,n),d&10&&W(t,"selected",s[22]===s[1])},d(i){i&&_(e),r=!1,a()}}}function Vo(s){let e,t,n="Play",l,o,r,a,c,i,d,f,g,m,h="Reset",y,w,k,C,B=s[2]?"Quit":"Play",D,$,E,j,N,I=_e(s[4]),L=[];for(let A=0;A<I.length;A+=1)L[A]=Hn(zn(s,I,A));const S=A=>H(L[A],1,1,()=>{L[A]=null});let V=(s[0]==="chords-write"||s[0]==="chords-play")&&qn(s);return d=new Lo({props:{class:"game-options"}}),k=new Me({props:{class:"mr-1",icon:s[2]?Ys:Ss,width:20}}),{c(){e=v("fieldset"),t=v("legend"),t.textContent=n,l=O(),o=v("div"),r=v("ul");for(let A=0;A<L.length;A+=1)L[A].c();a=O(),c=v("div"),V&&V.c(),i=O(),ue(d.$$.fragment),f=O(),g=v("div"),m=v("button"),m.textContent=h,y=O(),w=v("button"),ue(k.$$.fragment),C=O(),D=ee(B),this.h()},l(A){e=b(A,"FIELDSET",{class:!0});var G=T(e);t=b(G,"LEGEND",{class:!0,"data-svelte-h":!0}),ae(t)!=="svelte-1409tnk"&&(t.textContent=n),l=P(G),o=b(G,"DIV",{class:!0});var R=T(o);r=b(R,"UL",{class:!0});var x=T(r);for(let Z=0;Z<L.length;Z+=1)L[Z].l(x);x.forEach(_),a=P(R),c=b(R,"DIV",{class:!0});var Q=T(c);V&&V.l(Q),Q.forEach(_),i=P(R),fe(d.$$.fragment,R),f=P(R),g=b(R,"DIV",{class:!0});var F=T(g);m=b(F,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(m)!=="svelte-10rv0bu"&&(m.textContent=h),y=P(F),w=b(F,"BUTTON",{class:!0});var X=T(w);fe(k.$$.fragment,X),C=P(X),D=te(X,B),X.forEach(_),F.forEach(_),R.forEach(_),G.forEach(_),this.h()},h(){p(t,"class","px-1 text-base"),p(r,"class","games svelte-1okhpct"),p(c,"class","options svelte-1okhpct"),p(m,"class","w-full btn hover:bg-gray-200"),p(w,"class","w-full mt-2 flex items-center justify-center btn primary"),p(g,"class","h-full flex flex-col justify-end"),p(o,"class","body pb-2 h-full svelte-1okhpct"),p(e,"class",$=Ne(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(A,G){M(A,e,G),u(e,t),u(e,l),u(e,o),u(o,r);for(let R=0;R<L.length;R+=1)L[R]&&L[R].m(r,null);u(o,a),u(o,c),V&&V.m(c,null),u(o,i),de(d,o,null),u(o,f),u(o,g),u(g,m),u(g,y),u(g,w),de(k,w,null),u(w,C),u(w,D),E=!0,j||(N=[Y(m,"click",s[8]),Y(w,"click",s[9])],j=!0)},p(A,[G]){if(G&113){I=_e(A[4]);let x;for(x=0;x<I.length;x+=1){const Q=zn(A,I,x);L[x]?(L[x].p(Q,G),U(L[x],1)):(L[x]=Hn(Q),L[x].c(),U(L[x],1),L[x].m(r,null))}for(ze(),x=I.length;x<L.length;x+=1)S(x);He()}A[0]==="chords-write"||A[0]==="chords-play"?V?V.p(A,G):(V=qn(A),V.c(),V.m(c,null)):V&&(V.d(1),V=null);const R={};G&4&&(R.icon=A[2]?Ys:Ss),k.$set(R),(!E||G&4)&&B!==(B=A[2]?"Quit":"Play")&&ye(D,B),(!E||G&1024&&$!==($=Ne(`${A[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&p(e,"class",$)},i(A){if(!E){for(let G=0;G<I.length;G+=1)U(L[G]);U(d.$$.fragment,A),U(k.$$.fragment,A),E=!0}},o(A){L=L.filter(Boolean);for(let G=0;G<L.length;G+=1)H(L[G]);H(d.$$.fragment,A),H(k.$$.fragment,A),E=!1},d(A){A&&_(e),Ve(L,A),V&&V.d(),he(d),he(k),j=!1,qe(N)}}}function Oo(s,e,t){let n,l,o,r,a,c,i;be(s,Us,E=>t(12,r=E)),be(s,pt,E=>t(20,a=E)),be(s,mt,E=>t(13,c=E)),be(s,Tt,E=>t(14,i=E));const d=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let f=d[4].key,g="maj-m";a.count,a.waitSeconds,pt.subscribe(E=>{E.count,E.waitSeconds});function m(E,j){if(j==="chords-write"||j==="chords-play"||j==="chords-diatonic"){let N=[];g==="selected"?N=r.filter(I=>I.selected):g==="all"?N=r:g==="maj-m"?N=r.filter(I=>I.suffixes[0]==="maj"||I.suffixes[0]==="m"):g==="seventh"&&(N=r.filter(I=>I.suffixes[0]==="maj7"||I.suffixes[0]==="m7"||I.suffixes[0]==="7"||I.suffixes[0]==="dim7"||I.suffixes[0]==="aug7")),De.play(j,{chords:N})}else De.play(j,void 0);E.currentTarget instanceof HTMLElement&&E.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function h(E){t(0,f=E)}function y(E,j){t(0,f=j),m(E,j)}function w(E){t(1,g=E)}function k(){De.clearGame(!0)}function C(E){n?De.clearGame():m(E,f)}const B=E=>h(E),D=(E,j)=>y(j,E),$=E=>w(E);return s.$$set=E=>{t(10,e=Ie(Ie({},e),Ae(E)))},s.$$.update=()=>{s.$$.dirty&24576&&t(2,n=!!i&&c!=="ended"),s.$$.dirty&4096&&t(11,l=r.reduce((E,j)=>j.selected?E+1:E,0)),s.$$.dirty&2048&&t(3,o=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${l} chords`},{key:"all",value:"All"}])},e=Ae(e),[f,g,n,o,d,h,y,w,k,C,e,l,r,c,i,B,D,$]}class Po extends Ke{constructor(e){super(),xe(this,e,Oo,Vo,Fe,{})}}function Jn(s,e,t){const n=s.slice();return n[7]=e[t],n}function Yn(s,e,t){const n=s.slice();return n[4]=e[t],n}function jo(s){let e,t=_e(s[1]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Qn(Jn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);M(l,e,o)},p(l,o){if(o&2){t=_e(l[1]);let r;for(r=0;r<t.length;r+=1){const a=Jn(l,t,r);n[r]?n[r].p(a,o):(n[r]=Qn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function Bo(s){let e,t=_e(s[0].scaleNotes||[]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Xn(Yn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);M(l,e,o)},p(l,o){if(o&1){t=_e(l[0].scaleNotes||[]);let r;for(r=0;r<t.length;r+=1){const a=Yn(l,t,r);n[r]?n[r].p(a,o):(n[r]=Xn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function Qn(s){let e,t=s[7].interval+"",n;return{c(){e=v("span"),n=ee(t),this.h()},l(l){e=b(l,"SPAN",{class:!0});var o=T(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-my4m0t")},m(l,o){M(l,e,o),u(e,n)},p(l,o){o&2&&t!==(t=l[7].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function Xn(s){let e,t=s[4].note+"",n;return{c(){e=v("span"),n=ee(t),this.h()},l(l){e=b(l,"SPAN",{class:!0});var o=T(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-my4m0t")},m(l,o){M(l,e,o),u(e,n)},p(l,o){o&1&&t!==(t=l[4].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function Go(s){let e,t,n,l,o,r;function a(d,f){return d[0]?Bo:jo}let c=a(s),i=c(s);return{c(){e=v("div"),t=v("button"),i.c(),this.h()},l(d){e=b(d,"DIV",{class:!0,title:!0});var f=T(e);t=b(f,"BUTTON",{class:!0});var g=T(t);i.l(g),g.forEach(_),f.forEach(_),this.h()},h(){p(t,"class","intervals svelte-my4m0t"),p(e,"class",n=`${s[2].class||""} `),p(e,"title",l=s[1].map(Zn).join("-"))},m(d,f){M(d,e,f),u(e,t),i.m(t,null),o||(r=Y(t,"click",s[3]),o=!0)},p(d,[f]){c===(c=a(d))&&i?i.p(d,f):(i.d(1),i=c(d),i&&(i.c(),i.m(t,null))),f&4&&n!==(n=`${d[2].class||""} `)&&p(e,"class",n),f&2&&l!==(l=d[1].map(Zn).join("-"))&&p(e,"title",l)},i:ge,o:ge,d(d){d&&_(e),i.d(),o=!1,r()}}}const Zn=s=>s.interval;function Mo(s,e,t){let{scale:n,intervals:l}=e;function o(r){jt.call(this,s,r)}return s.$$set=r=>{t(2,e=Ie(Ie({},e),Ae(r))),"scale"in r&&t(0,n=r.scale),"intervals"in r&&t(1,l=r.intervals)},e=Ae(e),[n,l,e,o]}class Ol extends Ke{constructor(e){super(),xe(this,e,Mo,Go,Fe,{scale:0,intervals:1})}}function el(s,e,t){const n=s.slice();return n[7]=e[t],n}function tl(s,e,t){const n=s.slice();return n[4]=e[t],n}function $o(s){let e,t=_e(s[0]),n=[];for(let l=0;l<t.length;l+=1)n[l]=sl(el(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);M(l,e,o)},p(l,o){if(o&1){t=_e(l[0]);let r;for(r=0;r<t.length;r+=1){const a=el(l,t,r);n[r]?n[r].p(a,o):(n[r]=sl(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function Ro(s){let e,t=_e(s[1]),n=[];for(let l=0;l<t.length;l+=1)n[l]=nl(tl(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);M(l,e,o)},p(l,o){if(o&2){t=_e(l[1]);let r;for(r=0;r<t.length;r+=1){const a=tl(l,t,r);n[r]?n[r].p(a,o):(n[r]=nl(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function sl(s){let e,t,n=s[7].roman+"",l,o,r,a=s[7].suffix+"",c,i;return{c(){e=v("span"),t=v("span"),l=ee(n),o=O(),r=v("sup"),c=ee(a),i=O(),this.h()},l(d){e=b(d,"SPAN",{class:!0});var f=T(e);t=b(f,"SPAN",{class:!0});var g=T(t);l=te(g,n),g.forEach(_),o=P(f),r=b(f,"SUP",{class:!0});var m=T(r);c=te(m,a),m.forEach(_),i=P(f),f.forEach(_),this.h()},h(){p(t,"class","block"),p(r,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),W(r,"super-text",s[7].suffix.length>2),p(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(d,f){M(d,e,f),u(e,t),u(t,l),u(e,o),u(e,r),u(r,c),u(e,i)},p(d,f){f&1&&n!==(n=d[7].roman+"")&&ye(l,n),f&1&&a!==(a=d[7].suffix+"")&&ye(c,a),f&1&&W(r,"super-text",d[7].suffix.length>2)},d(d){d&&_(e)}}}function nl(s){let e,t,n=s[4]+"",l,o;return{c(){e=v("span"),t=v("span"),l=ee(n),o=O(),this.h()},l(r){e=b(r,"SPAN",{class:!0});var a=T(e);t=b(a,"SPAN",{});var c=T(t);l=te(c,n),c.forEach(_),o=P(a),a.forEach(_),this.h()},h(){p(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(r,a){M(r,e,a),u(e,t),u(t,l),u(e,o)},p(r,a){a&2&&n!==(n=r[4]+"")&&ye(l,n)},d(r){r&&_(e)}}}function Uo(s){let e,t,n,l,o,r;function a(d,f){return d[1].length>0?Ro:$o}let c=a(s),i=c(s);return{c(){e=v("div"),t=v("button"),i.c(),this.h()},l(d){e=b(d,"DIV",{class:!0,title:!0});var f=T(e);t=b(f,"BUTTON",{class:!0});var g=T(t);i.l(g),g.forEach(_),f.forEach(_),this.h()},h(){p(t,"class","triads flex flex-wrap svelte-1roj1mi"),p(e,"class",n=Ne(`${s[2].class||""} `)+" svelte-1roj1mi"),p(e,"title",l=s[0].map(ll).join("-"))},m(d,f){M(d,e,f),u(e,t),i.m(t,null),o||(r=Y(t,"click",s[3]),o=!0)},p(d,[f]){c===(c=a(d))&&i?i.p(d,f):(i.d(1),i=c(d),i&&(i.c(),i.m(t,null))),f&4&&n!==(n=Ne(`${d[2].class||""} `)+" svelte-1roj1mi")&&p(e,"class",n),f&1&&l!==(l=d[0].map(ll).join("-"))&&p(e,"title",l)},i:ge,o:ge,d(d){d&&_(e),i.d(),o=!1,r()}}}const ll=s=>s.roman+s.suffix;function Ko(s,e,t){let{triads:n,chords:l}=e;function o(r){jt.call(this,s,r)}return s.$$set=r=>{t(2,e=Ie(Ie({},e),Ae(r))),"triads"in r&&t(0,n=r.triads),"chords"in r&&t(1,l=r.chords)},e=Ae(e),[n,l,e,o]}class Pl extends Ke{constructor(e){super(),xe(this,e,Ko,Uo,Fe,{triads:0,chords:1})}}function rl(s,e,t){const n=s.slice();return n[23]=e[t],n}function ol(s,e,t){const n=s.slice();return n[23]=e[t],n}function al(s){let e,t,n=s[23].raw.names[0]+"",l,o,r,a,c,i,d;function f(){return s[11](s[23])}r=new Ol({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),r.$on("click",f);function g(){return s[12](s[23])}return c=new Pl({props:{triads:s[23].triads,chords:s[23].triadChords}}),c.$on("click",g),{c(){e=v("li"),t=v("div"),l=ee(n),o=O(),ue(r.$$.fragment),a=O(),ue(c.$$.fragment),i=O(),this.h()},l(m){e=b(m,"LI",{class:!0});var h=T(e);t=b(h,"DIV",{class:!0});var y=T(t);l=te(y,n),y.forEach(_),o=P(h),fe(r.$$.fragment,h),a=P(h),fe(c.$$.fragment,h),i=P(h),h.forEach(_),this.h()},h(){p(t,"class","text-xs font-bold"),p(e,"class","svelte-4hctsl")},m(m,h){M(m,e,h),u(e,t),u(t,l),u(e,o),de(r,e,null),u(e,a),de(c,e,null),u(e,i),d=!0},p(m,h){s=m,(!d||h&4)&&n!==(n=s[23].raw.names[0]+"")&&ye(l,n);const y={};h&4&&(y.scale=s[23].scale),h&4&&(y.intervals=s[23].raw.intervals),r.$set(y);const w={};h&4&&(w.triads=s[23].triads),h&4&&(w.chords=s[23].triadChords),c.$set(w)},i(m){d||(U(r.$$.fragment,m),U(c.$$.fragment,m),d=!0)},o(m){H(r.$$.fragment,m),H(c.$$.fragment,m),d=!1},d(m){m&&_(e),he(r),he(c)}}}function il(s){let e,t,n=s[23].raw.names[0]+"",l,o,r,a,c,i,d;function f(){return s[13](s[23])}r=new Ol({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),r.$on("click",f);function g(){return s[14](s[23])}return c=new Pl({props:{triads:s[23].triads,chords:s[23].triadChords}}),c.$on("click",g),{c(){e=v("li"),t=v("div"),l=ee(n),o=O(),ue(r.$$.fragment),a=O(),ue(c.$$.fragment),i=O(),this.h()},l(m){e=b(m,"LI",{class:!0});var h=T(e);t=b(h,"DIV",{class:!0});var y=T(t);l=te(y,n),y.forEach(_),o=P(h),fe(r.$$.fragment,h),a=P(h),fe(c.$$.fragment,h),i=P(h),h.forEach(_),this.h()},h(){p(t,"class","text-xs font-bold"),p(e,"class","svelte-4hctsl")},m(m,h){M(m,e,h),u(e,t),u(t,l),u(e,o),de(r,e,null),u(e,a),de(c,e,null),u(e,i),d=!0},p(m,h){s=m,(!d||h&2)&&n!==(n=s[23].raw.names[0]+"")&&ye(l,n);const y={};h&2&&(y.scale=s[23].scale),h&2&&(y.intervals=s[23].raw.intervals),r.$set(y);const w={};h&2&&(w.triads=s[23].triads),h&2&&(w.chords=s[23].triadChords),c.$set(w)},i(m){d||(U(r.$$.fragment,m),U(c.$$.fragment,m),d=!0)},o(m){H(r.$$.fragment,m),H(c.$$.fragment,m),d=!1},d(m){m&&_(e),he(r),he(c)}}}function xo(s){let e,t,n,l,o="Scales",r,a,c,i="Key",d,f,g,m,h,y,w,k,C,B,D,$=_e(s[2]),E=[];for(let S=0;S<$.length;S+=1)E[S]=al(ol(s,$,S));const j=S=>H(E[S],1,1,()=>{E[S]=null});let N=_e(s[1]),I=[];for(let S=0;S<N.length;S+=1)I[S]=il(rl(s,N,S));const L=S=>H(I[S],1,1,()=>{I[S]=null});return{c(){e=v("div"),t=v("fieldset"),n=v("legend"),l=v("button"),l.textContent=o,r=O(),a=v("div"),c=v("label"),c.textContent=i,d=O(),f=v("input"),g=O(),m=v("div"),h=v("ul");for(let S=0;S<E.length;S+=1)E[S].c();y=O(),w=v("ul");for(let S=0;S<I.length;S+=1)I[S].c();this.h()},l(S){e=b(S,"DIV",{class:!0});var V=T(e);t=b(V,"FIELDSET",{class:!0});var A=T(t);n=b(A,"LEGEND",{class:!0});var G=T(n);l=b(G,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-lhx60e"&&(l.textContent=o),G.forEach(_),r=P(A),a=b(A,"DIV",{class:!0});var R=T(a);c=b(R,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(c)!=="svelte-14m38zf"&&(c.textContent=i),d=P(R),f=b(R,"INPUT",{class:!0,id:!0}),R.forEach(_),g=P(A),m=b(A,"DIV",{class:!0});var x=T(m);h=b(x,"UL",{class:!0});var Q=T(h);for(let X=0;X<E.length;X+=1)E[X].l(Q);Q.forEach(_),y=P(x),w=b(x,"UL",{class:!0});var F=T(w);for(let X=0;X<I.length;X+=1)I[X].l(F);F.forEach(_),x.forEach(_),A.forEach(_),V.forEach(_),this.h()},h(){p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(c,"class","mr-4 font-bold"),p(c,"for","scale-key"),p(f,"class","bg-gray-100 w-16 px-1 rounded"),p(f,"id","scale-key"),f.value=s[0],p(a,"class","flex mb-2 input svelte-4hctsl"),W(a,"hidden",s[3]),p(h,"class","list odd w-full svelte-4hctsl"),p(w,"class","list even w-full svelte-4hctsl"),p(m,"class","body max-h-[30rem] overflow-scroll svelte-4hctsl"),W(m,"hidden",s[3]),p(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),W(t,"collapsed",s[3]),p(e,"class",k=Ne(`${s[9].class||""}`)+" svelte-4hctsl")},m(S,V){M(S,e,V),u(e,t),u(t,n),u(n,l),u(t,r),u(t,a),u(a,c),u(a,d),u(a,f),u(t,g),u(t,m),u(m,h);for(let A=0;A<E.length;A+=1)E[A]&&E[A].m(h,null);u(m,y),u(m,w);for(let A=0;A<I.length;A+=1)I[A]&&I[A].m(w,null);C=!0,B||(D=[Y(l,"click",s[5]),Y(f,"input",s[6])],B=!0)},p(S,[V]){if((!C||V&1&&f.value!==S[0])&&(f.value=S[0]),(!C||V&8)&&W(a,"hidden",S[3]),V&388){$=_e(S[2]);let A;for(A=0;A<$.length;A+=1){const G=ol(S,$,A);E[A]?(E[A].p(G,V),U(E[A],1)):(E[A]=al(G),E[A].c(),U(E[A],1),E[A].m(h,null))}for(ze(),A=$.length;A<E.length;A+=1)j(A);He()}if(V&386){N=_e(S[1]);let A;for(A=0;A<N.length;A+=1){const G=rl(S,N,A);I[A]?(I[A].p(G,V),U(I[A],1)):(I[A]=il(G),I[A].c(),U(I[A],1),I[A].m(w,null))}for(ze(),A=N.length;A<I.length;A+=1)L(A);He()}(!C||V&8)&&W(m,"hidden",S[3]),(!C||V&8)&&W(t,"collapsed",S[3]),(!C||V&512&&k!==(k=Ne(`${S[9].class||""}`)+" svelte-4hctsl"))&&p(e,"class",k)},i(S){if(!C){for(let V=0;V<$.length;V+=1)U(E[V]);for(let V=0;V<N.length;V+=1)U(I[V]);C=!0}},o(S){E=E.filter(Boolean);for(let V=0;V<E.length;V+=1)H(E[V]);I=I.filter(Boolean);for(let V=0;V<I.length;V+=1)H(I[V]);C=!1},d(S){S&&_(e),Ve(E,S),Ve(I,S),B=!1,qe(D)}}}function Fo(s,e,t){let n,l,o,r,a,c,i;be(s,Mt,I=>t(17,o=I)),be(s,gt,I=>t(18,r=I)),be(s,nt,I=>t(19,a=I)),be(s,st,I=>t(20,c=I));let f=vs().map(I=>({key:I.names[0],raw:I,scale:void 0,triads:I.triads,triadChords:[]})),g="",m=[r.key,r.scale],h;const y=vt(Oe(!0),{key:"scales-hidden"});be(s,y,I=>t(3,i=I));function w(){y.update(I=>!I)}function k({currentTarget:{value:I}}){t(0,g=`${I.charAt(0).toUpperCase()}${I.charAt(1).toLowerCase()}`),t(10,f=f.map(L=>{const S=zt(g,L.key),V=g&&"data"in S?S.data:void 0;let A=[];return V&&(A=L.triads.map((G,R)=>`${V.scaleNotes[R].note}${!G.suffix.includes("°")&&G.minor?"m":""}${G.suffix}`)),{...L,scale:V,triadChords:A}}))}function C(I,L,S){if(I<L.length){const V=L[I++];Se.setPlayed(V),c==null||c.playChord(V.map(A=>A.midi),a.fixedVelocity),h=setTimeout(()=>C(I,L,S),S)}else Se.setPlayed([]),Se.setKeyAndScale(m[0],m[1])}function B(I){clearTimeout(h);let L,S;I.scale?(S=I.scale,m=[r.key,r.scale],Se.setKeyAndScale(I.scale.key,I.scale.scale)):S=r;const V=o[0].midi+S.scaleNotes[0].semitones;L=I.raw.intervals.map(A=>[{...S.notesMap.get(A.semitones%12),midi:V+A.semitones}]),L[0][0].semitones!==L[L.length-1][0].semitones&&L.push(L[0].map(A=>({...A,midi:A.midi+12}))),C(0,L,500)}function D(I){clearTimeout(h);const{intervals:L}=I.raw;let S,V;I.scale?(V=I.scale,m=[r.key,r.scale],Se.setKeyAndScale(I.scale.key,I.scale.scale)):V=r;const A=o[0].midi+V.scaleNotes[0].semitones;S=wl(I.triads).map((R,x)=>is(A+V.intervals[x].semitones,V,R.intervals)),L[L.length-1].interval_seq!==1&&S.push(S[0].map(R=>({...R,midi:R.midi+12}))),C(0,S,750)}const $=I=>B(I),E=I=>D(I),j=I=>B(I),N=I=>D(I);return s.$$set=I=>{t(9,e=Ie(Ie({},e),Ae(I)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,n=f.filter((I,L)=>L<f.length/2)),s.$$.dirty&1024&&t(1,l=f.filter((I,L)=>L>=f.length/2))},e=Ae(e),[g,l,n,i,y,w,k,B,D,e,f,$,E,j,N]}class zo extends Ke{constructor(e){super(),xe(this,e,Fo,xo,Fe,{})}}function cl(s,e,t){const n=s.slice();return n[26]=e[t],n}function ul(s,e,t){const n=s.slice();return n[29]=e[t],n}function fl(s){let e,t;return{c(){e=v("div"),t=ee(s[3]),this.h()},l(n){e=b(n,"DIV",{class:!0});var l=T(e);t=te(l,s[3]),l.forEach(_),this.h()},h(){p(e,"class","error svelte-y741yg")},m(n,l){M(n,e,l),u(e,t)},p(n,l){l[0]&8&&ye(t,n[3])},d(n){n&&_(e)}}}function dl(s){let e,t=_e(s[5]),n=[];for(let l=0;l<t.length;l+=1)n[l]=hl(ul(s,t,l));return{c(){e=v("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=b(l,"DIV",{class:!0});var o=T(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(_),this.h()},h(){p(e,"class","intervals my-1 svelte-y741yg")},m(l,o){M(l,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(l,o){if(o[0]&32){t=_e(l[5]);let r;for(r=0;r<t.length;r+=1){const a=ul(l,t,r);n[r]?n[r].p(a,o):(n[r]=hl(a),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function hl(s){let e,t=s[29].interval+"",n;return{c(){e=v("span"),n=ee(t),this.h()},l(l){e=b(l,"SPAN",{class:!0});var o=T(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-y741yg")},m(l,o){M(l,e,o),u(e,n)},p(l,o){o[0]&32&&t!==(t=l[29].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function ml(s){let e,t=_e(s[8].scaleNotes),n=[];for(let l=0;l<t.length;l+=1)n[l]=_l(cl(s,t,l));return{c(){e=v("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=b(l,"DIV",{class:!0});var o=T(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(_),this.h()},h(){p(e,"class","intervals my-1 svelte-y741yg")},m(l,o){M(l,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(l,o){if(o[0]&256){t=_e(l[8].scaleNotes);let r;for(r=0;r<t.length;r+=1){const a=cl(l,t,r);n[r]?n[r].p(a,o):(n[r]=_l(a),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Ve(n,l)}}}function _l(s){let e,t=s[26].note+"",n;return{c(){e=v("span"),n=ee(t),this.h()},l(l){e=b(l,"SPAN",{class:!0});var o=T(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-y741yg")},m(l,o){M(l,e,o),u(e,n)},p(l,o){o[0]&256&&t!==(t=l[26].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function Ho(s){let e,t,n,l="Score",o,r,a,c,i,d,f,g="Range",m,h,y,w,k,C="—",B,D,$,E,j,N,I,L="Scale",S,V,A,G,R,x,Q,F="Key",X,Z,K,J,z,me,pe,$e;a=new Me({props:{icon:Jt,width:16}});let ie=s[3]&&fl(s);A=new vl({props:{id:"score-scale",class:"p-1 pl-[2px]",selected:s[0],options:s[10],onSelect:s[14]}});let ce=!s[7]&&dl(s),le=!s[7]&&ml(s);return{c(){e=v("fieldset"),t=v("legend"),n=v("button"),n.textContent=l,o=O(),r=v("button"),ue(a.$$.fragment),c=O(),i=v("div"),d=v("div"),f=v("label"),f.textContent=g,m=O(),h=v("div"),y=v("input"),w=O(),k=v("span"),k.textContent=C,B=O(),D=v("input"),$=O(),E=v("div"),ie&&ie.c(),j=O(),N=v("div"),I=v("label"),I.textContent=L,S=O(),V=v("div"),ue(A.$$.fragment),G=O(),ce&&ce.c(),R=O(),x=v("div"),Q=v("label"),Q.textContent=F,X=O(),Z=v("div"),K=v("input"),J=O(),le&&le.c(),this.h()},l(oe){e=b(oe,"FIELDSET",{class:!0});var ve=T(e);t=b(ve,"LEGEND",{class:!0});var ke=T(t);n=b(ke,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-lqyol"&&(n.textContent=l),ke.forEach(_),o=P(ve),r=b(ve,"BUTTON",{class:!0});var tt=T(r);fe(a.$$.fragment,tt),tt.forEach(_),c=P(ve),i=b(ve,"DIV",{class:!0});var q=T(i);d=b(q,"DIV",{class:!0});var re=T(d);f=b(re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(f)!=="svelte-10u0679"&&(f.textContent=g),m=P(re),h=b(re,"DIV",{class:!0});var Ee=T(h);y=b(Ee,"INPUT",{class:!0,id:!0}),w=P(Ee),k=b(Ee,"SPAN",{class:!0,"data-svelte-h":!0}),ae(k)!=="svelte-8q1xz4"&&(k.textContent=C),B=P(Ee),D=b(Ee,"INPUT",{class:!0,id:!0}),Ee.forEach(_),$=P(re),E=b(re,"DIV",{class:!0});var Re=T(E);ie&&ie.l(Re),Re.forEach(_),re.forEach(_),j=P(q),N=b(q,"DIV",{class:!0});var ne=T(N);I=b(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(I)!=="svelte-1nrdbqn"&&(I.textContent=L),S=P(ne),V=b(ne,"DIV",{class:!0});var We=T(V);fe(A.$$.fragment,We),We.forEach(_),G=P(ne),ce&&ce.l(ne),ne.forEach(_),R=P(q),x=b(q,"DIV",{class:!0});var je=T(x);Q=b(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Q)!=="svelte-17pcm6g"&&(Q.textContent=F),X=P(je),Z=b(je,"DIV",{class:!0});var ct=T(Z);K=b(ct,"INPUT",{class:!0,id:!0}),ct.forEach(_),J=P(je),le&&le.l(je),je.forEach(_),q.forEach(_),ve.forEach(_),this.h()},h(){p(n,"class","px-1 rounded hover:bg-gray-100"),p(t,"class","text-base"),p(r,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(r,"hidden",s[6]),p(f,"class","font-bold"),p(f,"for","range_min"),p(y,"class","h-[28px] w-full"),p(y,"id","range_min"),p(k,"class","mx-2 mt-1"),p(D,"class","h-[28px] w-full"),p(D,"id","range_max"),p(h,"class","my-1 flex w-full"),p(E,"class","flex justify-between my-1"),p(d,"class","range flex flex-col h-full svelte-y741yg"),p(I,"class","font-bold"),p(I,"for","score-scale"),p(V,"class","scale-dropdown my-1 w-full svelte-y741yg"),p(N,"class","flex flex-col h-full"),p(Q,"class","font-bold"),p(Q,"for","key"),p(K,"class","h-[28px] svelte-y741yg"),p(K,"id","key"),p(Z,"class","my-1 flex"),p(x,"class","flex flex-col h-full"),p(i,"class","options svelte-y741yg"),W(i,"hidden",s[6]),p(e,"class",z=Ne(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-y741yg"),W(e,"collapsed",s[6])},m(oe,ve){M(oe,e,ve),u(e,t),u(t,n),u(e,o),u(e,r),de(a,r,null),u(e,c),u(e,i),u(i,d),u(d,f),u(d,m),u(d,h),u(h,y),Ze(y,s[1]),u(h,w),u(h,k),u(h,B),u(h,D),Ze(D,s[2]),u(d,$),u(d,E),ie&&ie.m(E,null),u(i,j),u(i,N),u(N,I),u(N,S),u(N,V),de(A,V,null),u(N,G),ce&&ce.m(N,null),u(i,R),u(i,x),u(x,Q),u(x,X),u(x,Z),u(Z,K),Ze(K,s[4]),u(x,J),le&&le.m(x,null),me=!0,pe||($e=[Y(n,"click",s[15]),Y(r,"click",s[16]),Y(y,"input",s[18]),Y(y,"change",s[19]),Y(y,"focus",s[12]),Y(D,"input",s[20]),Y(D,"change",s[21]),Y(D,"focus",s[12]),Y(K,"input",s[22]),Y(K,"input",s[13])],pe=!0)},p(oe,ve){(!me||ve[0]&64)&&W(r,"hidden",oe[6]),ve[0]&2&&y.value!==oe[1]&&Ze(y,oe[1]),ve[0]&4&&D.value!==oe[2]&&Ze(D,oe[2]),oe[3]?ie?ie.p(oe,ve):(ie=fl(oe),ie.c(),ie.m(E,null)):ie&&(ie.d(1),ie=null);const ke={};ve[0]&1&&(ke.selected=oe[0]),A.$set(ke),oe[7]?ce&&(ce.d(1),ce=null):ce?ce.p(oe,ve):(ce=dl(oe),ce.c(),ce.m(N,null)),ve[0]&16&&K.value!==oe[4]&&Ze(K,oe[4]),oe[7]?le&&(le.d(1),le=null):le?le.p(oe,ve):(le=ml(oe),le.c(),le.m(x,null)),(!me||ve[0]&64)&&W(i,"hidden",oe[6]),(!me||ve[0]&131072&&z!==(z=Ne(`${oe[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-y741yg"))&&p(e,"class",z),(!me||ve[0]&131136)&&W(e,"collapsed",oe[6])},i(oe){me||(U(a.$$.fragment,oe),U(A.$$.fragment,oe),me=!0)},o(oe){H(a.$$.fragment,oe),H(A.$$.fragment,oe),me=!1},d(oe){oe&&_(e),he(a),ie&&ie.d(),he(A),ce&&ce.d(),le&&le.d(),pe=!1,qe($e)}}}function qo(s,e,t){let n,l,o,r,a,c;be(s,Mt,V=>t(23,l=V)),be(s,At,V=>t(24,o=V)),be(s,Tt,V=>t(7,a=V)),be(s,gt,V=>t(8,c=V));let i=ht(l[0]),d=ht(l[1]),f="";const g=vt(Oe(!1),{key:"score-options-hidden"});be(s,g,V=>t(6,r=V));let m=o[0],h=o[1];const y=vs(),w=y.map(V=>({key:V.names[0],value:V.names[0]}));Mt.subscribe(V=>{t(1,i=ht(V[0])),t(2,d=ht(V[1]))}),At.subscribe(V=>{t(4,m=V[0]),t(0,h=V[1])});function k(V,A){const G=rr(A.currentTarget.value,!0,!0);if("data"in G){const{midi:R}=G.data,x=l,Q=[V==="min"?R:x[0].midi,V==="max"?R:x[1].midi];Pe.setMidiRange(Q),t(3,f="")}else t(3,f=G.err),V==="min"?t(1,i=ht(l[0])):t(2,d=ht(l[1]))}function C(){t(3,f="")}function B({currentTarget:{value:V}}){t(4,m=`${V.charAt(0).toUpperCase()}${V.charAt(1).toLowerCase()}`),Se.setKey(m)}function D(V){var A;return t(0,h=(A=w.find(G=>V===G.key))==null?void 0:A.value),Se.setScale(h),!1}function $(){g.update(V=>!V)}function E(){Se.clearScore(!0),Pe.setMidiRange([60,84])}function j(){i=this.value,t(1,i)}const N=V=>k("min",V);function I(){d=this.value,t(2,d)}const L=V=>k("max",V);function S(){m=this.value,t(4,m)}return s.$$set=V=>{t(17,e=Ie(Ie({},e),Ae(V)))},s.$$.update=()=>{var V;s.$$.dirty[0]&1&&t(5,n=((V=y.find(A=>A.names[0]===h))==null?void 0:V.intervals)||[])},e=Ae(e),[h,i,d,f,m,n,r,a,c,g,w,k,C,B,D,$,E,e,j,N,I,L,S]}class Wo extends Ke{constructor(e){super(),xe(this,e,qo,Ho,Fe,{},null,[-1,-1])}}function Jo(s){s[19]=s[20].default}function Yo(s){return{c:ge,l:ge,m:ge,i:ge,o:ge,d:ge}}function Qo(s){Jo(s);let e,t,n;var l=s[19];function o(r,a){return{props:{class:"mx-4 md:mx-0"}}}return l&&(e=Gl(l,o())),{c(){e&&ue(e.$$.fragment),t=Le()},l(r){e&&fe(e.$$.fragment,r),t=Le()},m(r,a){e&&de(e,r,a),M(r,t,a),n=!0},i(r){n||(e&&U(e.$$.fragment,r),n=!0)},o(r){e&&H(e.$$.fragment,r),n=!1},d(r){r&&_(t),e&&he(e,r)}}}function Xo(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){M(t,e,n)},i:ge,o:ge,d(t){t&&_(e)}}}function Zo(s){let e,t,n="MIDI Note Trainer",l,o,r,a,c,i,d,f="Introduction",g,m,h,y,w,k,C,B,D,$,E,j,N,I,L,S,V,A,G,R,x;a=new Me({props:{icon:Jt,width:24}}),h=new ko({}),w=new zo({}),C=new Nr({}),$=new Wo({props:{class:"score-options mr-4"}}),j=new Po({props:{class:"play-form"}});let Q={ctx:s,current:null,token:null,hasCatch:!1,pending:Xo,then:Qo,catch:Yo,value:20,blocks:[,,,]};return Bl(Ce(()=>import("./Score.dda7dfa6.js"),["./Score.dda7dfa6.js","./vendor_svelte.d5c29075.js","./vendor.e9b0235c.js","./vendor_vexflow.2dfca40b.js","../assets/Score.f15e100e.css"],import.meta.url),Q),S=new No({props:{class:"min-h-32",debounced:!!s[0]}}),S.$on("guessed-chord",s[2]),S.$on("guessed-key",s[3]),S.$on("guessed-note",s[4]),A=new Ur({props:{game:s[1]}}),{c(){e=v("h1"),t=v("a"),t.textContent=n,l=O(),o=v("div"),r=v("button"),ue(a.$$.fragment),c=O(),i=v("div"),d=v("button"),d.textContent=f,g=O(),m=v("section"),ue(h.$$.fragment),y=O(),ue(w.$$.fragment),k=O(),ue(C.$$.fragment),B=O(),D=v("div"),ue($.$$.fragment),E=O(),ue(j.$$.fragment),N=O(),Q.block.c(),I=O(),L=v("section"),ue(S.$$.fragment),V=O(),ue(A.$$.fragment),this.h()},l(F){e=b(F,"H1",{class:!0});var X=T(e);t=b(X,"A",{class:!0,href:!0,"data-svelte-h":!0}),ae(t)!=="svelte-km4jns"&&(t.textContent=n),l=P(X),o=b(X,"DIV",{class:!0});var Z=T(o);r=b(Z,"BUTTON",{class:!0});var K=T(r);fe(a.$$.fragment,K),K.forEach(_),Z.forEach(_),X.forEach(_),c=P(F),i=b(F,"DIV",{class:!0});var J=T(i);d=b(J,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(d)!=="svelte-f34gar"&&(d.textContent=f),J.forEach(_),g=P(F),m=b(F,"SECTION",{class:!0});var z=T(m);fe(h.$$.fragment,z),y=P(z),fe(w.$$.fragment,z),k=P(z),fe(C.$$.fragment,z),B=P(z),D=b(z,"DIV",{class:!0});var me=T(D);fe($.$$.fragment,me),E=P(me),fe(j.$$.fragment,me),me.forEach(_),z.forEach(_),N=P(F),Q.block.l(F),I=P(F),L=b(F,"SECTION",{class:!0});var pe=T(L);fe(S.$$.fragment,pe),V=P(pe),fe(A.$$.fragment,pe),pe.forEach(_),this.h()},h(){p(t,"class","hover:underline"),p(t,"href","https://github.com/TeemuKoivisto/midi-note-trainer"),p(r,"class","rounded p-2 hover:bg-gray-200"),p(o,"class","flex items-center justify-center"),p(e,"class","mt-12 mb-4 md:mt-16 px-4 md:px-0 text-4xl md:text-5xl font-bold tracking-tight flex items-center justify-between"),p(d,"class","btn-pill border-2 border-gray-300 hover:bg-gray-200"),p(i,"class","px-4 md:px-0 mb-8 md:mb-10"),p(D,"class","play svelte-qjpqy3"),p(m,"class","mx-4 md:mx-0"),p(L,"class","mb-8 ml-16 flex flex-col")},m(F,X){M(F,e,X),u(e,t),u(e,l),u(e,o),u(o,r),de(a,r,null),M(F,c,X),M(F,i,X),u(i,d),M(F,g,X),M(F,m,X),de(h,m,null),u(m,y),de(w,m,null),u(m,k),de(C,m,null),u(m,B),u(m,D),de($,D,null),u(D,E),de(j,D,null),M(F,N,X),Q.block.m(F,Q.anchor=X),Q.mount=()=>I.parentNode,Q.anchor=I,M(F,I,X),M(F,L,X),de(S,L,null),u(L,V),de(A,L,null),G=!0,R||(x=[Y(r,"click",s[5]),Y(d,"click",s[6])],R=!0)},p(F,[X]){s=F;const Z={};X&1&&(Z.debounced=!!s[0]),S.$set(Z);const K={};X&2&&(K.game=s[1]),A.$set(K)},i(F){G||(U(a.$$.fragment,F),U(h.$$.fragment,F),U(w.$$.fragment,F),U(C.$$.fragment,F),U($.$$.fragment,F),U(j.$$.fragment,F),U(Q.block),U(S.$$.fragment,F),U(A.$$.fragment,F),G=!0)},o(F){H(a.$$.fragment,F),H(h.$$.fragment,F),H(w.$$.fragment,F),H(C.$$.fragment,F),H($.$$.fragment,F),H(j.$$.fragment,F);for(let X=0;X<3;X+=1){const Z=Q.blocks[X];H(Z)}H(S.$$.fragment,F),H(A.$$.fragment,F),G=!1},d(F){F&&(_(e),_(c),_(i),_(g),_(m),_(N),_(I),_(L)),he(a),he(h),he(w),he(C),he($),he(j),Q.block.d(F),Q.token=null,Q=null,he(S),he(A),R=!1,qe(x)}}}function ea(s,e,t){let n,l,o,r,a,c;be(s,mt,E=>t(8,n=E)),be(s,Tt,E=>t(1,l=E)),be(s,pt,E=>t(9,o=E)),be(s,nt,E=>t(10,r=E)),be(s,st,E=>t(11,a=E)),be(s,Ls,E=>t(12,c=E));let i,d;gl(()=>(c&&Pe.openMidi(),window.addEventListener("keydown",f),window.addEventListener("mousedown",f),window.addEventListener("touchstart",f),()=>{window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)})),ps.subscribe(E=>{"data"in E&&E.data.channels[1].addListener("noteon",g)});function f(){Pe.initAudio(),window.removeEventListener("keydown",f),window.removeEventListener("mousedown",f),window.removeEventListener("touchstart",f)}function g(E){if(i)return;const j=E.rawData;m(j[1],j[2])}function m(E,j){const N=l;N instanceof Pt&&!(N!=null&&N.ended)&&n==="waiting"?w(E):N instanceof _t&&!(N!=null&&N.ended)&&n==="waiting"?(N.addPlayedNote(E),d||(d=setTimeout(y,2e3))):N||Se.pushPlayed(E),a&&a.noteOn(E,r.fixedVelocity??j)}function h(){o.autoplay&&o.waitSeconds>0?t(0,i=setTimeout(()=>{o.autoplay&&De.nextGuess(),t(0,i=void 0)},o.waitSeconds*1e3)):o.autoplay?De.nextGuess():t(0,i=void 0)}function y(){var j;const E=l;if(E instanceof _t){const N=E.guess();Se.setPlayed(((j=E.latestGuess.guessed)==null?void 0:j.notes)||[],N,-1),De.updateState(N?"correct":"wrong"),h()}d=void 0}function w(E){const j=l;if(j instanceof Pt&&n==="waiting"){Se.setTarget([Se.getNote(j.current)]);const N=j.guess(E);De.updateState(N?"correct":"wrong"),Se.pushPlayed(E,N,4e3),h()}}function k(E){const j=l;if(j instanceof _t&&n==="waiting"){const N=j.guessWrittenChord(E.detail);De.updateState(N?"correct":"wrong"),h()}}function C(E){const j=l;if(j instanceof qt&&n==="waiting"){const N=E.detail.replaceAll("♭","b").replaceAll("♯","#"),I=j.guess(N);De.updateState(I?"correct":"wrong"),h()}}function B(E){const j=it.findNote(E.detail.note)??$s(E.detail.note);j&&m(j.semitones+12+E.detail.octave*12,80)}function D(){fr(),window.location.reload()}return[i,l,k,C,B,D,()=>Kl.open("introduction",void 0)]}class oa extends Ke{constructor(e){super(),xe(this,e,ea,Zo,Fe,{})}}export{nn as F,_t as G,oa as P,Yl as S,Pt as a,De as b,Tt as c,wt as d,_s as e,mt as g,st as p,gt as s,an as t};
