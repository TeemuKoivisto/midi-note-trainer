import{_ as Te}from"./preload-helper.a4192956.js";import{S as Fe,i as He,s as ze,R as Ie,e as b,b as j,g as y,h as C,f as B,j as _,_ as jt,P as W,k as p,$ as Ae,l as R,n as f,a0 as Ze,y as Y,a1 as js,t as x,J as Ue,q as z,C as Ke,a2 as qe,T as Ne,c as Bs,a3 as _e,u as Gs,o as Ms,p as Rs,W as us,X as Ct,Y as fs,a4 as ds,a5 as Oe,B as Le,L as vs,G as ee,H as te,I as ye,z as ve,O as Me,a as ue,d as fe,m as de,r as he,v as Ce,U as Wt,w as Ve,x as ae,Q as be,a6 as Bt,A as gl,a7 as jl,a8 as hs,a9 as Bl,N as Gl}from"./vendor_svelte.43fe9e59.js";import{w as os,c as Ml,e as Rl,f as Js,g as Ys,h as Jt,i as ms,j as _s,k as Gt,l as Mt,m as xl,a as Qs,n as Ss}from"./vendor.e9b0235c.js";import{a as $l}from"./modal.ab8dc632.js";function Xs(s,e,t){const n=s.slice();return n[19]=e[t].key,n[20]=e[t].value,n[21]=e[t].icon,n[23]=t,n}const Ul=s=>({}),Zs=s=>({});function en(s){let e,t,n,l,o,r,a,c,i,d,u;const g=s[14].header,m=Bs(g,s,s[13],Zs);let h=_e(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=sn(Xs(s,h,k));const N=k=>z(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),n=j(),l=b("ul"),o=b("li"),m&&m.c(),r=j();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(_),n=B(k),l=y(k,"UL",{class:!0});var w=C(l);o=y(w,"LI",{});var V=C(o);m&&m.l(V),V.forEach(_),r=B(w);for(let I=0;I<v.length;I+=1)v[I].l(w);w.forEach(_),this.h()},h(){p(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),p(e,"tabindex","-1"),p(l,"class",a=Ae(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[11].containerClass||""}`)+" svelte-1tx2rz0")},m(k,w){R(k,e,w),R(k,n,w),R(k,l,w),f(l,o),m&&m.m(o,null),f(l,r);for(let V=0;V<v.length;V+=1)v[V]&&v[V].m(l,null);i=!0,d||(u=Y(e,"click",s[8]),d=!0)},p(k,w){if(s=k,m&&m.p&&(!i||w&8192)&&Gs(m,g,s,s[13],i?Rs(g,s[13],w,Ul):Ms(s[13]),Zs),w&1123){h=_e(s[0]);let V;for(V=0;V<h.length;V+=1){const I=Xs(s,h,V);v[V]?(v[V].p(I,w),x(v[V],1)):(v[V]=sn(I),v[V].c(),x(v[V],1),v[V].m(l,null))}for(Ue(),V=h.length;V<v.length;V+=1)N(V);Ke()}(!i||w&2048&&a!==(a=Ae(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[11].containerClass||""}`)+" svelte-1tx2rz0"))&&p(l,"class",a)},i(k){if(!i){k&&us(()=>{i&&(t||(t=Ct(e,fs,{duration:as},!0)),t.run(1))}),x(m,k);for(let w=0;w<h.length;w+=1)x(v[w]);k&&us(()=>{i&&(c||(c=Ct(l,ds,{duration:as},!0)),c.run(1))}),i=!0}},o(k){k&&(t||(t=Ct(e,fs,{duration:as},!1)),t.run(0)),z(m,k),v=v.filter(Boolean);for(let w=0;w<v.length;w+=1)z(v[w]);k&&(c||(c=Ct(l,ds,{duration:as},!1)),c.run(0)),i=!1},d(k){k&&(_(e),_(n),_(l)),k&&t&&t.end(),m&&m.d(k),Oe(v,k),k&&c&&c.end(),d=!1,u()}}}function tn(s){let e,t,n,l,o,r,a=s[20]+"",c,i,d,u,g;const m=[Fl,Kl],h=[];function v(k,w){return k[21]?0:1}n=v(s),l=h[n]=m[n](s);function N(){return s[17](s[19])}return{c(){e=b("li"),t=b("button"),l.c(),o=j(),r=b("div"),c=ee(a),i=j(),this.h()},l(k){e=y(k,"LI",{});var w=C(e);t=y(w,"BUTTON",{class:!0});var V=C(t);l.l(V),o=B(V),r=y(V,"DIV",{});var I=C(r);c=te(I,a),I.forEach(_),V.forEach(_),i=B(w),w.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-1tx2rz0"),W(t,"selected",s[19]===s[1])},m(k,w){R(k,e,w),f(e,t),h[n].m(t,null),f(t,o),f(t,r),f(r,c),f(e,i),d=!0,u||(g=[Y(t,"click",N),Y(t,"blur",s[6])],u=!0)},p(k,w){s=k;let V=n;n=v(s),n===V?h[n].p(s,w):(Ue(),z(h[V],1,1,()=>{h[V]=null}),Ke(),l=h[n],l?l.p(s,w):(l=h[n]=m[n](s),l.c()),x(l,1),l.m(t,o)),(!d||w&1)&&a!==(a=s[20]+"")&&ye(c,a),(!d||w&3)&&W(t,"selected",s[19]===s[1])},i(k){d||(x(l),d=!0)},o(k){z(l),d=!1},d(k){k&&_(e),h[n].d(),u=!1,qe(g)}}}function Kl(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","w-[24px]")},m(t,n){R(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&_(e)}}}function Fl(s){let e,t;return e=new Me({props:{class:"mr-2",icon:s[21],width:16}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p(n,l){const o={};l&1&&(o.icon=n[21]),e.$set(o)},i(n){t||(x(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function sn(s){let e,t,n=!s[5][s[23]]&&tn(s);return{c(){n&&n.c(),e=Le()},l(l){n&&n.l(l),e=Le()},m(l,o){n&&n.m(l,o),R(l,e,o),t=!0},p(l,o){l[5][l[23]]?n&&(Ue(),z(n,1,1,()=>{n=null}),Ke()):n?(n.p(l,o),o&32&&x(n,1)):(n=tn(l),n.c(),x(n,1),n.m(e.parentNode,e))},i(l){t||(x(n),t=!0)},o(l){z(n),t=!1},d(l){l&&_(e),n&&n.d(l)}}}function Hl(s){let e,t,n,l,o,r,a,c,i=[{class:n=`${s[11].class||""} open-btn text-justify text-sm rounded`},s[11]],d={};for(let g=0;g<i.length;g+=1)d=Ie(d,i[g]);let u=s[3]&&en(s);return{c(){e=b("div"),t=b("input"),l=j(),u&&u.c(),this.h()},l(g){e=y(g,"DIV",{class:!0});var m=C(e);t=y(m,"INPUT",{class:!0}),l=B(m),u&&u.l(m),m.forEach(_),this.h()},h(){jt(t,d),W(t,"open",s[3]),W(t,"svelte-1tx2rz0",!0),p(e,"class",o=Ae(`relative ${s[11].containerClass||""}`)+" svelte-1tx2rz0")},m(g,m){R(g,e,m),f(e,t),t.autofocus&&t.focus(),Ze(t,s[4]),f(e,l),u&&u.m(e,null),s[18](e),r=!0,a||(c=[Y(t,"input",s[15]),Y(t,"focus",s[16]),Y(t,"blur",s[6]),Y(t,"input",s[7]),Y(t,"keydown",s[9])],a=!0)},p(g,[m]){jt(t,d=js(i,[(!r||m&2048&&n!==(n=`${g[11].class||""} open-btn text-justify text-sm rounded`))&&{class:n},m&2048&&g[11]])),m&16&&t.value!==g[4]&&Ze(t,g[4]),W(t,"open",g[3]),W(t,"svelte-1tx2rz0",!0),g[3]?u?(u.p(g,m),m&8&&x(u,1)):(u=en(g),u.c(),x(u,1),u.m(e,null)):u&&(Ue(),z(u,1,1,()=>{u=null}),Ke()),(!r||m&2048&&o!==(o=Ae(`relative ${g[11].containerClass||""}`)+" svelte-1tx2rz0"))&&p(e,"class",o)},i(g){r||(x(u),r=!0)},o(g){z(u),r=!1},d(g){g&&_(e),u&&u.d(),s[18](null),a=!1,qe(c)}}}const as=400;function zl(s,e,t){let{$$slots:n={},$$scope:l}=e,{options:o,selected:r,onSelect:a}=e,c,i=!1,d=r,u=o.map(G=>!1);function g(G){t(3,i=c.contains(G.relatedTarget))}function m(G){t(5,u=o.map(S=>!S.value.toLowerCase().includes(G.currentTarget.value.toLowerCase())))}function h(){t(4,d=r),t(3,i=!1),t(5,u=o.map(G=>!1))}function v(G){if(G.key==="Enter"){const S=u.findIndex(O=>!O);d===r?h():S>-1&&t(3,i=a(o[S].key)),i||(t(5,u=o.map(O=>!1)),G.currentTarget instanceof HTMLElement&&G.currentTarget.blur())}else G.key==="Escape"&&(h(),G.currentTarget instanceof HTMLElement&&G.currentTarget.blur())}function N(G){t(3,i=a(G))}function k(){d=this.value,t(4,d),t(1,r)}const w=()=>t(3,i=!0),V=G=>N(G);function I(G){vs[G?"unshift":"push"](()=>{c=G,t(2,c)})}return s.$$set=G=>{t(11,e=Ie(Ie({},e),Ne(G))),"options"in G&&t(0,o=G.options),"selected"in G&&t(1,r=G.selected),"onSelect"in G&&t(12,a=G.onSelect),"$$scope"in G&&t(13,l=G.$$scope)},s.$$.update=()=>{s.$$.dirty&2&&t(4,d=r),s.$$.dirty&1&&t(5,u=o.map(G=>!1))},e=Ne(e),[o,r,c,i,d,u,g,m,h,v,N,e,a,l,n,k,w,V,I]}class vl extends Fe{constructor(e){super(),He(this,e,zl,Hl,ze,{options:0,selected:1,onSelect:12})}}const nn={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Xe(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:bl(s,e,t),flats:e,sharps:t}}function bl(s,e,t){return(s<8?nn[s]:nn[s%7])-e+t+Math.floor(s/8)*12}function yl(s){let e,t=0,n=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(n=Math.floor(s/100),e=s%100):e=s;const l=bl(e,t,n);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(n)}`,interval_seq:e,semitones:l,flats:t,sharps:n}}const ql=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6","△6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9","△6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7","△7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9","△9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11","△11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13","△13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let Ts=[];function kl(){return ql.map(s=>{const e=s[3].map(yl);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function Ft(s){Ts.length===0&&(Ts=kl());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return Ts.find(t=>t.suffixes.find(n=>n===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function Wl(s,e,t){let n=e<0?s.flats-e:s.flats,l=e>0?s.sharps+e:s.sharps;if(n>0&&l>0){const r=Math.min(n,l);n-=r,l-=r}const o=(s.semitones+e)%12;return{...s,semitones:o<0?o+12:o,note:`${s.note.charAt(0)}${"♭".repeat(n)}${"♯".repeat(l)}`,flats:n,sharps:l,midi:t}}function cs(s,e,t){const n=[];for(let l=0;l<t.length;l+=1){const o=t[l],r=s+o.semitones,a=e.scaleNotes.find(g=>g.semitones===r%12),c=o.flats>0,i=o.sharps>0,d=(c?r+1:i?r-1:r)%12,u=c?-1:i?1:0;n.push(Wl(a??e.notesMap.get(d),a?0:u,r))}return n}const ln=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],Jl=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],rn=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Yl(s){let e=0,t=0;for(let n=0;n<ln.length;n+=1){const l=s.find(r=>r.note.slice(0,2)===ln[n]),o=s.find(r=>r.note.slice(0,2)===Jl[n]);if(l)e+=1;else if(o)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:rn.get(e*-1)}:{flats:0,sharps:t,majorSignature:rn.get(t)}}function Ql(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function wl(s){return s.map(e=>{const t=[Xe(1)];let n;return e.major?(t.push(Xe(3)),e.suffix.startsWith("+")?t.push(Xe(5,0,1)):e.suffix.startsWith("6")?t.push(Xe(6)):e.suffix.startsWith("7")?t.push(Xe(7,1)):e.suffix.startsWith("maj7")?t.push(Xe(7)):n=Ft("maj")):e.minor?(t.push(Xe(3,1)),e.suffix.startsWith("°")?t.push(Xe(5,1)):e.suffix.startsWith("6")?(t.push(Xe(6)),n=Ft("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Xe(7,1)),n=Ft("m"+e.suffix)):n=Ft("m")):e.suffix.startsWith("sus2")?t.push(Xe(2)):e.suffix.startsWith("sus4")&&t.push(Xe(4)),t.length<=2&&t.push(Xe(5)),t.length<=2&&t.push(Xe(8)),n||(n=Ft(e.suffix)),{...n,intervals:t}})}function Xl(s,e){let t=e.has(4)&&e.has(7),n=e.has(3)&&e.has(7);const l=Ql(s);let o="";return t||n||(e.has(3)&&e.has(6)?(o="°",n=!0):e.has(4)&&e.has(8)?(o="+",t=!0):e.has(3)&&e.has(10)?(n=!0,o="7"):e.has(4)&&e.has(10)?(o="7",t=!0):e.has(4)&&e.has(11)?(o="maj7",t=!0):e.has(3)&&e.has(8)?(o="6",n=!0):e.has(4)&&e.has(9)?(o="6",t=!0):e.has(2)?o="sus2":e.has(5)?o="sus4":e.has(7)?o="5":o="?"),{degree:s,roman:n?l.toLowerCase():l,suffix:o,major:t,minor:n,semitones:e}}function Zl(s){const e=s.length;return s.map((t,n)=>{const l=t.semitones,o=new Set;for(let r=1;r<e;r+=1){const a=s[(n+r)%e].semitones,c=a<=l?a+12-l:a-l;o.add(c)}return Xl(t.interval_seq,o)})}const er=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let As=[];function bs(){return er.map(s=>{const e=s[0],t=s[1].map(yl),n=Zl(t);return{names:e,intervals:t,triads:n}})}function tr(s){As.length===0&&(As=bs());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return As.find(t=>t.names.find(n=>n.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const sr=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,nr=/^[0-9]$/,it=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function ps(s){const e=s.midi+s.flats-s.sharps;return e===12?1:Math.floor((e-12)/12)}function mt(s){return`${s.note}${ps(s)}`}function on(s){const t=(s-12)%12;return{...it[t],semitones:t,midi:s}}function lr(s,e=!0,t=!1){if(e&&!sr.test(s))return{err:`Unrecognized note "${s}"`,code:400};const n=s.trim(),l=n.charAt(0).toUpperCase(),o=it.find(u=>u.note.charAt(0)===l&&u.note.length===1);if(!o)return{err:`Unable to find note ${n}`,code:500};const r=n.slice(1).split("").reduce((u,g)=>u+(g.toLowerCase()==="b"||g==="♭"?-1:g==="#"||g==="♯"?1:0),0);let a;if(nr.test(n.charAt(n.length-1)))try{a=parseInt(n.charAt(n.length-1),10)}catch{}if(t&&a===void 0)return{err:`No octave provided: ${s}`,code:400};a===void 0&&(a=0);let c=(o.semitones+r)%12;c=c<0?c+12:c;const i=r<0?-r:0,d=r>0?r:0;return{data:{note:`${l}${"♭".repeat(i)}${"♯".repeat(d)}`,semitones:c,midi:12+a*12+c,flats:i,sharps:d}}}function xs(s){const e=it.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((l,o)=>l+(o.toLowerCase()==="b"||o==="♭"?-1:o==="#"||o==="♯"?1:0),0),n=(e.semitones+t)%12;return{note:s,semitones:n<0?n+12:n,flats:t<0?-t:0,sharps:t>0?t:0}}}const rr=/^[a-gA-G][♭b#♯]?$/,Ns="ABCDEFG";function or(s,e){return e.map(t=>Ns.charAt((Ns.indexOf(s)+t.interval_seq-1)%Ns.length))}function ar(s,e,t){return t.map((n,l)=>{const o=e[l],r=(s+n.semitones)%12,a=it[r],c=a.note.charAt(0);if(c<o&&(c!=="A"||o!=="G")||c==="G"&&o==="A"){let i=1,d=it[(r+i)%12];for(;d.note.charAt(0)!==o;)i+=1,d=it[(r+i)%12];return{semitones:r,note:d.note+"♭".repeat(i),flats:i+(d.note.includes("♭")?1:0),sharps:0}}else if(c>o||c==="A"&&o==="G"){let i=1,d=r===0?it.length-1:r-i,u=it[d];for(;u.note.charAt(0)!==o;)i+=1,d=d===0?it.length-1:d-1,u=it[d];return{semitones:r,note:u.note+"♯".repeat(i),flats:0,sharps:i+(u.note.includes("♯")?1:0)}}else return{semitones:r,note:a.note,flats:a.flats,sharps:a.sharps}})}function zt(s,e){if(!rr.test(s))return{err:`Unknown key: ${s}`,code:400};const t=tr(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const n=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,l=xs(n);if(!l)return{err:`Unable to find root for note: ${n}`,code:404};const o=or(n.charAt(0),t.intervals),r=ar(l.semitones,o,t.intervals),a=new Map(it.map(c=>{const i=r.find(d=>d.semitones===c.semitones);return i?[c.semitones,i]:[c.semitones,{...c}]}));return{data:{key:n,scale:t.names[0],names:t.names,...Yl(r),intervals:t.intervals.map(c=>({...c})),triads:t.triads.map(c=>({...c})),scaleNotes:r,notesMap:a}}}const Ds=new Map;function ir(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function cr(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(n){return{err:`Failed to store the value: ${n}`,code:400}}}function bt(s,e){const{key:t,storage:n="local",namespace:l="default"}=e,o=ir(t,n),r=Ce(s);"data"in o?s.set(e.deserialize?e.deserialize(o.data):o.data):"err"in o&&(e!=null&&e.debug)&&console.info(o.err);const a=s.subscribe(i=>{const d=cr(e.serialize?e.serialize(i):i,t,n);"err"in d&&(e!=null&&e.debug)&&console.error(d.err)}),c=Ds.get(l);return c?c.push({key:t,storage:n,value:s,defaultValue:r,unsubscribe:a}):Ds.set(l,[{key:t,storage:n,value:s,defaultValue:r,unsubscribe:a}]),s}function ur(s=["default"],e){s.forEach(t=>{var n;(n=Ds.get(t))==null||n.forEach(l=>{if(e!=null&&e.cb)e==null||e.cb(l);else try{e!=null&&e.unsubscribe&&l.unsubscribe(),l.value.set(l.defaultValue),(l.storage==="local"?window.localStorage:window.sessionStorage).removeItem(l.key)}catch{}})})}async function fr(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const n=await t.arrayBuffer();return{data:await e.decodeAudioData(n)}}async function dr(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],n=await Promise.all(t.map(o=>fr(`${s}${o}`,e))),l=[];return n.forEach(o=>{"err"in o?console.error(`Failed to load audio: ${o.err}`):l.push(o.data)}),l}class hr{constructor(e,t,n,l){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(n),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=l,this.damp.connect(n))}on(e,t,n,l,o,r,a,c){this.noteA.buffer=e,this.noteA.playbackRate.value=n,this.biquadFilter.frequency.value=o,this.gainA.gain.value=r,this.gain.gain.value=c,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=l,this.gainB.gain.value=a,this.noteB.start(0)),this.noteA.start(0)}off(e,t,n){var l;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(n),this.noteB.stop(n),(l=this.damp)==null||l.start(0)}}class mr{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,n)=>{this.bufferlists.push(t),n===8?this.damper=t:n===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(n=>{this.noteOn(n,t)})}noteOn(e,t=80){if(e<109&&e>20){const n=this.notes.get(e);n&&(n.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const l=Math.floor((e-21)/12),o=l+1,r=l*12+21,a=2**((e-69)/12)*440,c=t/127;let i=a*(2-(e-21)/50)+3*a*c;e<60&&(i=440*(3-(60-21)/50)+3*a*c);const d=1-(e%12/12+1)/12,u=Math.pow(2,(e-r)/12),g=0,m=0,h=c**1.4,v=new hr(e,this.context,this.directGain,this.damper);v.on(this.bufferlists[l],this.bufferlists[o],u,g,i,d,m,h),this.notes.set(e,v)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const _r="/midi-note-trainer/",Ls=bt(Ve(!1),{key:"midi-access"}),gs=Ve(void 0),ys=bt(Ve([60,84]),{key:"midi-range",storage:"session"}),Rt=Wt(ys,s=>[on(s[0]),on(s[1])]),an=Ve(void 0),st=Ve(void 0),nt=bt(Ve({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),Pe={async openMidi(){return os.enable().then(()=>(Ls.set(!0),os.inputs.length>0?(gs.set(os.inputs[0]),{data:os.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(s=>({err:s.toString(),code:403}))},disableMidi(){Ls.set(!1),gs.set(void 0)},setMidiRange(s){ys.set(s)},setInputValue(s,e){nt.update(t=>({...t,[s]:e})),s==="useSound"&&!e?st.set(void 0):s==="useSound"&&!Ce(st)&&this.initAudio()},async initAudio(){let s=Ce(an);if(s||(s=new AudioContext,an.set(s)),!Ce(st)){const e=new mr(s),t=await dr(`${_r}audio`,s);e.load(t),st.set(e)}}};let at;const At=Ve(["C","Major"]),vt=Wt(At,s=>{const e=zt(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),cn=Ve([]),wt=Ve([]);function Os(s,e){if(s.length>0){const t=Date.now();let n=t;const l=s.filter(o=>(o.started+e>t&&(n=Math.min(n,o.started)),o.started+e>t));return!at&&l.length>0&&(at=setTimeout(()=>{at=void 0,wt.update(o=>Os(o,e))},e-(t-n)+100)),l}return s}const Se={setKey(s){At.update(e=>[s,e[1]])},setScale(s){At.update(e=>[e[0],s])},setKeyAndScale(s,e){At.set([s,e])},setTarget(s=[]){cn.set(s)},getNote(s){return{...Ce(vt).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const l={...Ce(vt).notesMap.get(s%12),midi:s},o=Date.now(),r=e===void 0?"default":e?"correct":"wrong";if(wt.update(a=>{const c=a.findIndex(i=>i.midi===s);return c>=0&&a.splice(c,1),[...a,{...l,color:r,started:o}]}),!at&&t!==-1){const a=t??Ce(nt).keyFadeTimeout;at=setTimeout(()=>{at=void 0,wt.update(c=>Os(c,a))},a)}},setPlayed(s,e,t){const n=Date.now(),l=e===void 0?"default":e?"correct":"wrong";if(wt.update(o=>[...s.map(r=>({...r,color:l,started:n}))]),!at&&t!==-1){const o=t??Ce(nt).keyFadeTimeout;at=setTimeout(()=>{at=void 0,wt.update(r=>Os(r,o))},o)}},clearPlayed(){wt.set([]),clearTimeout(at),at=void 0},clearScore(s=!1){s&&At.set(["C","Major"]),cn.set([]),wt.set([])}};class $s{constructor(e,t,n){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=n;const l=[],{count:o}=n,r=t.map(c=>typeof c=="object"&&c!==null?{...c}:c);let a=n.duplicates;!n.duplicates&&o>r.length&&(console.warn(`Trying to create game with count ${o} larger than available unique values ${t.length}`),a=!0);for(let c=0;c<o;c+=1){const i=Math.floor(Math.random()*r.length);if(a)l.push(r[i]);else{const d=r.splice(i,1);d.length>0&&l.push(d[0])}}this.sampled=l,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function pr(s,e,t){let n=e<0?s.flats-e:s.flats,l=e>0?s.sharps+e:s.sharps;if(n>0&&l>0){const r=Math.min(n,l);n-=r,l-=r}const o=(s.semitones+e)%12;return{...s,semitones:o<0?o+12:o,note:`${s.note.charAt(0)}${"♭".repeat(n)}${"♯".repeat(l)}`,flats:n,sharps:l,midi:t}}function gr(s,e,t){const n=[];for(let l=0;l<t.length;l+=1){const o=t[l],r=s+o.semitones,a=e.scaleNotes.find(g=>g.semitones===r%12),c=o.flats>0,i=o.sharps>0,d=(c?r+1:i?r-1:r)%12,u=c?-1:i?1:0;n.push(pr(a??e.notesMap.get(d),a?0:u,r))}return n}const vr=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function br(s){const t=(s-12)%12;return{...vr[t],semitones:t,midi:s}}function yr(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class pt extends $s{constructor(e,t,n){const l=t.range[0],o=t.range[1],r=new Set(t.scale.scaleNotes.map(c=>c.semitones)),a=n.chords.flatMap(c=>{const i=[],d=c.intervals.reduce((u,g)=>g.semitones>u?g.semitones:u,0);for(let u=l;u<=o-d;u+=1)if((!n.onlyScale||r.has(u%12))&&(!c.allowed||c.allowed.has(u%12))){const g=gr(u,t.scale,c.intervals);i.push({...c,rootNote:g[0].note,chord:`${g[0].note}${c.suffixes[0]}`,notes:g})}return i});super(e,a,t),this.played=new Set,this.opts=n}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${yr(e)}${e.chord.toLowerCase()}`,notes:[]};let n=this.current.chord===t.chord;return this.current.chord.slice(-3)==="maj"&&!n&&(n=this.current.chord.slice(0,-3)===t.chord),this.addGuessed(t,n)}guess(){const e=Array.from(this.played.values()).map(l=>br(l)).sort((l,o)=>l.midi-o.midi);this.played.clear();const t={chord:"",notes:e},n=this.current.notes.every(l=>e.find(o=>o.midi%12===l.midi%12));return this.addGuessed(t,n)}}const kr={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class qt extends $s{constructor(e,t){const n=e==="keys-major"?"major":"minor";super(e,Object.keys(kr[n]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class Pt extends $s{constructor(e,t){const n=t.range[0],l=t.range[1];super(e,Array.from(new Array(l-n+1)).map((o,r)=>n+r),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const El={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},_t=Ve("waiting"),gt=bt(Ve(El),{key:"game-options"}),It=Ve(void 0),Us=Ve(kl().map(s=>({...s,selected:!0}))),De={play(...[s,e]){var c,i,d;let t;const n=Ce(vt),l=Ce(ys),o=Ce(gt),r={scale:n,range:l,duplicates:o.duplicates,count:o.count};let a=[n.key,n.scale];if(s==="notes")t=new Pt(s,r),Se.setTarget([Se.getNote(t.current)]),(c=Ce(st))==null||c.noteOn(t.current);else if(s==="pitches")t=new Pt(s,r),Se.setTarget(),Pe.setInputValue("useSound",!0),(i=Ce(st))==null||i.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new qt(s,r),a=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new pt(s,r,e);else if(s==="chords-diatonic"){const u=wl(n.triads).map((g,m)=>({...g,allowed:new Set([n.scaleNotes[m].semitones])}));t=new pt(s,r,{chords:u})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((d=Ce(st))==null||d.playChord(t.current.notes.map(u=>u.midi)),Se.setTarget(t.current.notes)),Se.setKeyAndScale(a[0],a[1]),Se.clearPlayed(),_t.set("waiting"),It.set(t),t},updateState(s){_t.set(s)},setOptionValue(s,e){gt.update(t=>({...t,[s]:e}))},toggleChords(s){Us.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Ce(It);s!=null&&s.ended?_t.set("ended"):s instanceof Pt?(s.type==="notes"?Se.setTarget([Se.getNote(s.current)]):Se.setTarget(),Se.clearPlayed(),(e=Ce(st))==null||e.noteOn(s.current),De.updateState("waiting"),s.startTime()):s instanceof pt?(Se.setTarget(s.current.notes),Se.clearPlayed(),(t=Ce(st))==null||t.playChord(s==null?void 0:s.current.notes.map(n=>n.midi)),_t.set("waiting"),s.startTime()):s instanceof qt&&(Se.setKey(s.current),_t.set("waiting"),s.startTime())},clearGame(s=!1){const e=Ce(It);e&&Se.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&gt.set(El),It.set(void 0),_t.set("waiting"),Se.clearScore()}};function un(s,e,t){const n=s.slice();return n[35]=e[t],n[37]=t,n}function fn(s,e,t){const n=s.slice();return n[40]=e[t],n}function dn(s,e,t){const n=s.slice();return n[9]=e[t],n}function hn(s,e,t){const n=s.slice();return n[35]=e[t],n[37]=t,n}function mn(s,e,t){const n=s.slice();return n[40]=e[t],n}function _n(s,e,t){const n=s.slice();return n[9]=e[t],n}function wr(s){let e,t=_e(s[35].intervals),n=[];for(let l=0;l<t.length;l+=1)n[l]=pn(mn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o[0]&128){t=_e(l[35].intervals);let r;for(r=0;r<t.length;r+=1){const a=mn(l,t,r);n[r]?n[r].p(a,o):(n[r]=pn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Er(s){let e,t=_e(s[3][s[37]]),n=[];for(let l=0;l<t.length;l+=1)n[l]=gn(_n(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o[0]&8){t=_e(l[3][l[37]]);let r;for(r=0;r<t.length;r+=1){const a=_n(l,t,r);n[r]?n[r].p(a,o):(n[r]=gn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function pn(s){let e,t=s[40].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&128&&t!==(t=l[40].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function gn(s){let e,t=s[9].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&8&&t!==(t=l[9].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function vn(s){let e,t,n,l,o,r,a=s[35].suffixes[0]+"",c,i,d,u,g,m,h,v=s[35].name+"",N,k,w,V,I;l=new Me({props:{icon:s[35].selected?ms:_s,width:12}});function G(){return s[25](s[35])}function S(D,A){return D[3][D[37]]&&D[3][D[37]].length>0?Er:wr}let O=S(s),P=O(s);function E(){return s[26](s[35])}return{c(){e=b("li"),t=b("button"),n=b("span"),ue(l.$$.fragment),o=j(),r=b("div"),c=ee(a),i=j(),d=b("li"),P.c(),g=j(),m=b("li"),h=b("button"),N=ee(v),k=j(),this.h()},l(D){e=y(D,"LI",{});var A=C(e);t=y(A,"BUTTON",{class:!0});var L=C(t);n=y(L,"SPAN",{class:!0});var T=C(n);fe(l.$$.fragment,T),T.forEach(_),o=B(L),r=y(L,"DIV",{class:!0});var M=C(r);c=te(M,a),M.forEach(_),L.forEach(_),A.forEach(_),i=B(D),d=y(D,"LI",{class:!0,title:!0});var $=C(d);P.l($),$.forEach(_),g=B(D),m=y(D,"LI",{class:!0});var K=C(m);h=y(K,"BUTTON",{class:!0});var Q=C(h);N=te(Q,v),Q.forEach(_),k=B(K),K.forEach(_),this.h()},h(){p(n,"class","px-1 py-1 rounded"),W(n,"text-green-500",s[35].selected),W(n,"text-gray-400",!s[35].selected),p(r,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),p(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),W(t,"hidden",s[8]),p(d,"class","intervals svelte-1rg0xw5"),p(d,"title",u=s[35].intervals.map(wn).join("-")),p(h,"class","text-start"),p(m,"class","text-xs")},m(D,A){R(D,e,A),f(e,t),f(t,n),de(l,n,null),f(t,o),f(t,r),f(r,c),R(D,i,A),R(D,d,A),P.m(d,null),R(D,g,A),R(D,m,A),f(m,h),f(h,N),f(m,k),w=!0,V||(I=[Y(t,"click",G),Y(h,"click",E)],V=!0)},p(D,A){s=D;const L={};A[0]&128&&(L.icon=s[35].selected?ms:_s),l.$set(L),(!w||A[0]&128)&&W(n,"text-green-500",s[35].selected),(!w||A[0]&128)&&W(n,"text-gray-400",!s[35].selected),(!w||A[0]&128)&&a!==(a=s[35].suffixes[0]+"")&&ye(c,a),(!w||A[0]&256)&&W(t,"hidden",s[8]),O===(O=S(s))&&P?P.p(s,A):(P.d(1),P=O(s),P&&(P.c(),P.m(d,null))),(!w||A[0]&128&&u!==(u=s[35].intervals.map(wn).join("-")))&&p(d,"title",u),(!w||A[0]&128)&&v!==(v=s[35].name+"")&&ye(N,v)},i(D){w||(x(l.$$.fragment,D),w=!0)},o(D){z(l.$$.fragment,D),w=!1},d(D){D&&(_(e),_(i),_(d),_(g),_(m)),he(l),P.d(),V=!1,qe(I)}}}function Cr(s){let e,t=_e(s[35].intervals),n=[];for(let l=0;l<t.length;l+=1)n[l]=bn(fn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o[0]&64){t=_e(l[35].intervals);let r;for(r=0;r<t.length;r+=1){const a=fn(l,t,r);n[r]?n[r].p(a,o):(n[r]=bn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Ir(s){let e,t=_e(s[4][s[37]]),n=[];for(let l=0;l<t.length;l+=1)n[l]=yn(dn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o[0]&16){t=_e(l[4][l[37]]);let r;for(r=0;r<t.length;r+=1){const a=dn(l,t,r);n[r]?n[r].p(a,o):(n[r]=yn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function bn(s){let e,t=s[40].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&64&&t!==(t=l[40].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function yn(s){let e,t=s[9].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&16&&t!==(t=l[9].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function kn(s){let e,t,n,l,o,r,a=s[35].suffixes[0]+"",c,i,d,u,g,m,h,v=s[35].name+"",N,k,w,V,I;l=new Me({props:{icon:s[35].selected?ms:_s,width:12}});function G(){return s[27](s[35])}function S(D,A){return D[4][D[37]]&&D[4][D[37]].length>0?Ir:Cr}let O=S(s),P=O(s);function E(){return s[28](s[35])}return{c(){e=b("li"),t=b("button"),n=b("span"),ue(l.$$.fragment),o=j(),r=b("div"),c=ee(a),i=j(),d=b("li"),P.c(),g=j(),m=b("li"),h=b("button"),N=ee(v),k=j(),this.h()},l(D){e=y(D,"LI",{});var A=C(e);t=y(A,"BUTTON",{class:!0});var L=C(t);n=y(L,"SPAN",{class:!0});var T=C(n);fe(l.$$.fragment,T),T.forEach(_),o=B(L),r=y(L,"DIV",{class:!0});var M=C(r);c=te(M,a),M.forEach(_),L.forEach(_),A.forEach(_),i=B(D),d=y(D,"LI",{class:!0,title:!0});var $=C(d);P.l($),$.forEach(_),g=B(D),m=y(D,"LI",{class:!0});var K=C(m);h=y(K,"BUTTON",{class:!0});var Q=C(h);N=te(Q,v),Q.forEach(_),k=B(K),K.forEach(_),this.h()},h(){p(n,"class","px-1 py-1 rounded"),W(n,"text-green-500",s[35].selected),W(n,"text-gray-400",!s[35].selected),p(r,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),p(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),W(t,"hidden",s[8]),p(d,"class","intervals svelte-1rg0xw5"),p(d,"title",u=s[35].intervals.map(En).join("-")),p(h,"class","text-start"),p(m,"class","text-xs")},m(D,A){R(D,e,A),f(e,t),f(t,n),de(l,n,null),f(t,o),f(t,r),f(r,c),R(D,i,A),R(D,d,A),P.m(d,null),R(D,g,A),R(D,m,A),f(m,h),f(h,N),f(m,k),w=!0,V||(I=[Y(t,"click",G),Y(h,"click",E)],V=!0)},p(D,A){s=D;const L={};A[0]&64&&(L.icon=s[35].selected?ms:_s),l.$set(L),(!w||A[0]&64)&&W(n,"text-green-500",s[35].selected),(!w||A[0]&64)&&W(n,"text-gray-400",!s[35].selected),(!w||A[0]&64)&&a!==(a=s[35].suffixes[0]+"")&&ye(c,a),(!w||A[0]&256)&&W(t,"hidden",s[8]),O===(O=S(s))&&P?P.p(s,A):(P.d(1),P=O(s),P&&(P.c(),P.m(d,null))),(!w||A[0]&64&&u!==(u=s[35].intervals.map(En).join("-")))&&p(d,"title",u),(!w||A[0]&64)&&v!==(v=s[35].name+"")&&ye(N,v)},i(D){w||(x(l.$$.fragment,D),w=!0)},o(D){z(l.$$.fragment,D),w=!1},d(D){D&&(_(e),_(i),_(d),_(g),_(m)),he(l),P.d(),V=!1,qe(I)}}}function Tr(s){let e,t,n,l,o="Chords",r,a,c,i,d,u,g,m,h,v,N,k,w,V,I,G,S,O="Key",P,E,D,A,L="Scale",T,M,$,K,Q="Note",F,X,Z,U,J,H,me,pe,Re,ie;i=new Me({props:{icon:Ml,width:20}}),g=new Me({props:{icon:Rl,width:16}}),v=new Me({props:{icon:s[5]?Js:Ys,width:16}}),w=new Me({props:{icon:Jt,width:16}}),M=new vl({props:{id:"chords-scale",class:"bg-gray-100 w-48",containerClass:"input w-48",selected:s[1],options:s[10],onSelect:s[14]}});let ce=_e(s[7]),le=[];for(let q=0;q<ce.length;q+=1)le[q]=vn(hn(s,ce,q));const oe=q=>z(le[q],1,1,()=>{le[q]=null});let ge=_e(s[6]),we=[];for(let q=0;q<ge.length;q+=1)we[q]=kn(un(s,ge,q));const tt=q=>z(we[q],1,1,()=>{we[q]=null});return{c(){e=b("div"),t=b("fieldset"),n=b("legend"),l=b("button"),l.textContent=o,r=j(),a=b("div"),c=b("button"),ue(i.$$.fragment),d=j(),u=b("button"),ue(g.$$.fragment),m=j(),h=b("button"),ue(v.$$.fragment),N=j(),k=b("button"),ue(w.$$.fragment),V=j(),I=b("div"),G=b("div"),S=b("label"),S.textContent=O,P=j(),E=b("input"),D=j(),A=b("label"),A.textContent=L,T=j(),ue(M.$$.fragment),$=j(),K=b("label"),K.textContent=Q,F=j(),X=b("input"),Z=j(),U=b("ul");for(let q=0;q<le.length;q+=1)le[q].c();J=j(),H=b("ul");for(let q=0;q<we.length;q+=1)we[q].c();this.h()},l(q){e=y(q,"DIV",{class:!0});var re=C(e);t=y(re,"FIELDSET",{class:!0});var Ee=C(t);n=y(Ee,"LEGEND",{class:!0});var xe=C(n);l=y(xe,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1knqzl6"&&(l.textContent=o),xe.forEach(_),r=B(Ee),a=y(Ee,"DIV",{class:!0});var ne=C(a);c=y(ne,"BUTTON",{class:!0});var We=C(c);fe(i.$$.fragment,We),We.forEach(_),d=B(ne),u=y(ne,"BUTTON",{class:!0});var je=C(u);fe(g.$$.fragment,je),je.forEach(_),m=B(ne),h=y(ne,"BUTTON",{class:!0});var ut=C(h);fe(v.$$.fragment,ut),ut.forEach(_),N=B(ne),k=y(ne,"BUTTON",{class:!0});var et=C(k);fe(w.$$.fragment,et),et.forEach(_),ne.forEach(_),V=B(Ee),I=y(Ee,"DIV",{class:!0});var Qe=C(I);G=y(Qe,"DIV",{class:!0});var Je=C(G);S=y(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(S)!=="svelte-4jiw22"&&(S.textContent=O),P=B(Je),E=y(Je,"INPUT",{class:!0,id:!0}),D=B(Je),A=y(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(A)!=="svelte-162gpi4"&&(A.textContent=L),T=B(Je),fe(M.$$.fragment,Je),$=B(Je),K=y(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(K)!=="svelte-nkwohg"&&(K.textContent=Q),F=B(Je),X=y(Je,"INPUT",{class:!0,id:!0}),Je.forEach(_),Z=B(Qe),U=y(Qe,"UL",{class:!0});var St=C(U);for(let $e=0;$e<le.length;$e+=1)le[$e].l(St);St.forEach(_),J=B(Qe),H=y(Qe,"UL",{class:!0});var ft=C(H);for(let $e=0;$e<we.length;$e+=1)we[$e].l(ft);ft.forEach(_),Qe.forEach(_),Ee.forEach(_),re.forEach(_),this.h()},h(){p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(c,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),W(c,"hidden",s[8]),p(u,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(u,"hidden",s[8]),p(h,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(h,"hidden",s[8]),p(k,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(k,"hidden",s[8]),p(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),p(S,"class","mr-4 font-bold svelte-1rg0xw5"),p(S,"for","chords-key"),p(E,"class","input bg-gray-100 w-12 px-1 rounded"),p(E,"id","chords-key"),E.value=s[0],p(A,"class","font-bold svelte-1rg0xw5"),p(A,"for","chords-scale"),p(K,"class","font-bold svelte-1rg0xw5"),p(K,"for","chords-note"),p(X,"class","input bg-gray-100 w-12 px-1 rounded"),p(X,"id","chords-note"),X.value=s[2],p(G,"class","flex mb-2 options svelte-1rg0xw5"),p(U,"class","chord-list w-full svelte-1rg0xw5"),p(H,"class","chord-list w-full svelte-1rg0xw5"),p(I,"class","body svelte-1rg0xw5"),W(I,"hidden",s[8]),p(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1rg0xw5"),W(t,"collapsed",s[8]),p(e,"class",me=Ae(`${s[22].class||""}`)+" svelte-1rg0xw5")},m(q,re){R(q,e,re),f(e,t),f(t,n),f(n,l),f(t,r),f(t,a),f(a,c),de(i,c,null),f(a,d),f(a,u),de(g,u,null),f(a,m),f(a,h),de(v,h,null),f(a,N),f(a,k),de(w,k,null),f(t,V),f(t,I),f(I,G),f(G,S),f(G,P),f(G,E),f(G,D),f(G,A),f(G,T),de(M,G,null),f(G,$),f(G,K),f(G,F),f(G,X),f(I,Z),f(I,U);for(let Ee=0;Ee<le.length;Ee+=1)le[Ee]&&le[Ee].m(U,null);f(I,J),f(I,H);for(let Ee=0;Ee<we.length;Ee+=1)we[Ee]&&we[Ee].m(H,null);pe=!0,Re||(ie=[Y(l,"click",s[12]),Y(c,"click",s[17]),Y(u,"click",s[18]),Y(h,"click",s[19]),Y(k,"click",s[20]),Y(E,"input",s[13]),Y(X,"input",s[15])],Re=!0)},p(q,re){(!pe||re[0]&256)&&W(c,"hidden",q[8]),(!pe||re[0]&256)&&W(u,"hidden",q[8]);const Ee={};re[0]&32&&(Ee.icon=q[5]?Js:Ys),v.$set(Ee),(!pe||re[0]&256)&&W(h,"hidden",q[8]),(!pe||re[0]&256)&&W(k,"hidden",q[8]),(!pe||re[0]&1&&E.value!==q[0])&&(E.value=q[0]);const xe={};if(re[0]&2&&(xe.selected=q[1]),M.$set(xe),(!pe||re[0]&4&&X.value!==q[2])&&(X.value=q[2]),re[0]&2163080){ce=_e(q[7]);let ne;for(ne=0;ne<ce.length;ne+=1){const We=hn(q,ce,ne);le[ne]?(le[ne].p(We,re),x(le[ne],1)):(le[ne]=vn(We),le[ne].c(),x(le[ne],1),le[ne].m(U,null))}for(Ue(),ne=ce.length;ne<le.length;ne+=1)oe(ne);Ke()}if(re[0]&2163024){ge=_e(q[6]);let ne;for(ne=0;ne<ge.length;ne+=1){const We=un(q,ge,ne);we[ne]?(we[ne].p(We,re),x(we[ne],1)):(we[ne]=kn(We),we[ne].c(),x(we[ne],1),we[ne].m(H,null))}for(Ue(),ne=ge.length;ne<we.length;ne+=1)tt(ne);Ke()}(!pe||re[0]&256)&&W(I,"hidden",q[8]),(!pe||re[0]&256)&&W(t,"collapsed",q[8]),(!pe||re[0]&4194304&&me!==(me=Ae(`${q[22].class||""}`)+" svelte-1rg0xw5"))&&p(e,"class",me)},i(q){if(!pe){x(i.$$.fragment,q),x(g.$$.fragment,q),x(v.$$.fragment,q),x(w.$$.fragment,q),x(M.$$.fragment,q);for(let re=0;re<ce.length;re+=1)x(le[re]);for(let re=0;re<ge.length;re+=1)x(we[re]);pe=!0}},o(q){z(i.$$.fragment,q),z(g.$$.fragment,q),z(v.$$.fragment,q),z(w.$$.fragment,q),z(M.$$.fragment,q),le=le.filter(Boolean);for(let re=0;re<le.length;re+=1)z(le[re]);we=we.filter(Boolean);for(let re=0;re<we.length;re+=1)z(we[re]);pe=!1},d(q){q&&_(e),he(i),he(g),he(v),he(w),he(M),Oe(le,q),Oe(we,q),Re=!1,qe(ie)}}}const wn=s=>s.interval,En=s=>s.interval;function Ar(s,e,t){let n,l,o,r,a,c,i,d,u;be(s,nt,U=>t(30,a=U)),be(s,st,U=>t(31,c=U)),be(s,Rt,U=>t(32,i=U)),be(s,Us,U=>t(24,d=U));let g="C",m="Major",h=zt(g,m),v="",N,k=[],w=[];const I=bs().map(U=>({key:U.names[0],value:U.names[0]})),G=bt(Ve(!0),{key:"chords-hidden"});be(s,G,U=>t(8,u=U));function S(){G.update(U=>!U)}function O(){const U=N&&60+N.semitones;if("err"in h||!U)t(3,k=[]),t(4,w=[]);else{const J=h.data;t(3,k=l.map(H=>cs(U,J,H.intervals))),t(4,w=o.map(H=>cs(U,J,H.intervals)))}}function P({currentTarget:{value:U}}){t(0,g=`${U.charAt(0).toUpperCase()}${U.charAt(1).toLowerCase()}`),h=zt(g,m),O()}function E(U){var J;return t(1,m=(J=I.find(H=>U===H.key))==null?void 0:J.value),h=zt(g,m),O(),!1}function D({currentTarget:{value:U}}){t(2,v=`${U.charAt(0).toUpperCase()}${U.charAt(1).toLowerCase()}`),t(9,N=xs(v)),O()}function A(U){De.toggleChords(J=>J.name===U.name?!J.selected:J.selected)}function L(){const U=H=>H.suffixes[0]==="maj"||H.suffixes[0]==="m",J=d.filter(U).every(H=>H.selected);De.toggleChords(H=>U(H)?!J:H.selected)}function T(){const U=H=>H.suffixes[0]==="maj7"||H.suffixes[0]==="m7"||H.suffixes[0]==="7"||H.suffixes[0]==="dim7"||H.suffixes[0]==="aug7",J=d.filter(U).every(H=>H.selected);De.toggleChords(H=>U(H)?!J:H.selected)}function M(){De.toggleChords(U=>!r)}function $(){De.toggleChords(U=>!0)}function K(U){if("err"in h)return;const J=i[0].midi+((N==null?void 0:N.semitones)||0),H=cs(J,h.data,U.intervals);c==null||c.playChord(H.map(me=>me.midi),a.fixedVelocity)}const Q=U=>A(U),F=U=>K(U),X=U=>A(U),Z=U=>K(U);return s.$$set=U=>{t(22,e=Ie(Ie({},e),Ne(U)))},s.$$.update=()=>{s.$$.dirty[0]&16777216&&t(23,n=d),s.$$.dirty[0]&8388608&&t(7,l=n.filter((U,J)=>J<n.length/2)),s.$$.dirty[0]&8388608&&t(6,o=n.filter((U,J)=>J>=n.length/2)),s.$$.dirty[0]&8388608&&t(5,r=n.every(U=>U.selected))},e=Ne(e),[g,m,v,k,w,r,o,l,u,N,I,G,S,P,E,D,A,L,T,M,$,K,e,n,d,Q,F,X,Z]}class Nr extends Fe{constructor(e){super(),He(this,e,Ar,Tr,ze,{},null,[-1,-1])}}function Cn(s,e,t){const n=s.slice();return n[12]=e[t],n}function Sr(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){R(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&_(e)}}}function Dr(s){let e,t,n="Played:",l,o=_e(s[2]),r=[];for(let a=0;a<o.length;a+=1)r[a]=In(Cn(s,o,a));return{c(){e=b("div"),t=b("span"),t.textContent=n,l=j();for(let a=0;a<r.length;a+=1)r[a].c()},l(a){e=y(a,"DIV",{});var c=C(e);t=y(c,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1g6xxhn"&&(t.textContent=n),l=B(c);for(let i=0;i<r.length;i+=1)r[i].l(c);c.forEach(_)},m(a,c){R(a,e,c),f(e,t),f(e,l);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(e,null)},p(a,c){if(c&4){o=_e(a[2]);let i;for(i=0;i<o.length;i+=1){const d=Cn(a,o,i);r[i]?r[i].p(d,c):(r[i]=In(d),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=o.length}},i:ve,o:ve,d(a){a&&_(e),Oe(r,a)}}}function Lr(s){let e,t,n="Result:",l,o,r,a=s[0].correct+"",c,i,d=s[0].sampled.length+"",u,g,m,h,v,N=s[0].avgTime+"",k,w;return{c(){e=b("div"),t=b("span"),t.textContent=n,l=j(),o=b("span"),r=ee("["),c=ee(a),i=ee(" / "),u=ee(d),g=ee("]"),m=j(),h=b("span"),v=ee("avg "),k=ee(N),w=ee("s"),this.h()},l(V){e=y(V,"DIV",{class:!0});var I=C(e);t=y(I,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1eqfbgx"&&(t.textContent=n),l=B(I),o=y(I,"SPAN",{class:!0});var G=C(o);r=te(G,"["),c=te(G,a),i=te(G," / "),u=te(G,d),g=te(G,"]"),G.forEach(_),m=B(I),h=y(I,"SPAN",{});var S=C(h);v=te(S,"avg "),k=te(S,N),w=te(S,"s"),S.forEach(_),I.forEach(_),this.h()},h(){p(o,"class","mx-2"),p(e,"class","flex")},m(V,I){R(V,e,I),f(e,t),f(e,l),f(e,o),f(o,r),f(o,c),f(o,i),f(o,u),f(o,g),f(e,m),f(e,h),f(h,v),f(h,k),f(h,w)},p(V,I){I&1&&a!==(a=V[0].correct+"")&&ye(c,a),I&1&&d!==(d=V[0].sampled.length+"")&&ye(u,d),I&1&&N!==(N=V[0].avgTime+"")&&ye(k,N)},i:ve,o:ve,d(V){V&&_(e)}}}function Or(s){var D,A,L,T;let e,t,n="Target:",l,o,r=((D=s[0].latestGuess.target)==null?void 0:D.chord)+"",a,c,i,d=((A=s[0].latestGuess.target)==null?void 0:A.notes.map(Tn).join(" "))+"",u,g,m,h,v,N,k,w,V=((L=s[0].latestGuess.guessed)==null?void 0:L.chord)+"",I,G,S,O=((T=s[0].latestGuess.guessed)==null?void 0:T.notes.map(An).join(" "))+"",P,E;return v=new Me({props:{icon:s[1]==="correct"?Gt:Mt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=n,l=j(),o=b("span"),a=ee(r),c=j(),i=b("span"),u=ee(d),g=j(),m=b("span"),h=b("div"),ue(v.$$.fragment),N=ee(`
        Guessed:`),k=j(),w=b("span"),I=ee(V),G=j(),S=b("span"),P=ee(O),this.h()},l(M){e=y(M,"DIV",{class:!0});var $=C(e);t=y($,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1pddpsb"&&(t.textContent=n),l=B($),o=y($,"SPAN",{});var K=C(o);a=te(K,r),K.forEach(_),c=B($),i=y($,"SPAN",{});var Q=C(i);u=te(Q,d),Q.forEach(_),g=B($),m=y($,"SPAN",{class:!0});var F=C(m);h=y(F,"DIV",{class:!0});var X=C(h);fe(v.$$.fragment,X),X.forEach(_),N=te(F,`
        Guessed:`),F.forEach(_),k=B($),w=y($,"SPAN",{});var Z=C(w);I=te(Z,V),Z.forEach(_),G=B($),S=y($,"SPAN",{});var U=C(S);P=te(U,O),U.forEach(_),$.forEach(_),this.h()},h(){p(h,"class","absolute left-[-2rem] p-1"),p(m,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(M,$){R(M,e,$),f(e,t),f(e,l),f(e,o),f(o,a),f(e,c),f(e,i),f(i,u),f(e,g),f(e,m),f(m,h),de(v,h,null),f(m,N),f(e,k),f(e,w),f(w,I),f(e,G),f(e,S),f(S,P),E=!0},p(M,$){var Q,F,X,Z;(!E||$&1)&&r!==(r=((Q=M[0].latestGuess.target)==null?void 0:Q.chord)+"")&&ye(a,r),(!E||$&1)&&d!==(d=((F=M[0].latestGuess.target)==null?void 0:F.notes.map(Tn).join(" "))+"")&&ye(u,d);const K={};$&2&&(K.icon=M[1]==="correct"?Gt:Mt),v.$set(K),(!E||$&1)&&V!==(V=((X=M[0].latestGuess.guessed)==null?void 0:X.chord)+"")&&ye(I,V),(!E||$&1)&&O!==(O=((Z=M[0].latestGuess.guessed)==null?void 0:Z.notes.map(An).join(" "))+"")&&ye(P,O)},i(M){E||(x(v.$$.fragment,M),E=!0)},o(M){z(v.$$.fragment,M),E=!1},d(M){M&&_(e),he(v)}}}function Vr(s){let e,t,n="Target:",l,o,r=s[0].latestGuess.target+"",a,c,i,d,u,g,m,h,v,N,k=s[0].latestGuess.guessed+"",w,V,I,G;return m=new Me({props:{icon:s[1]==="correct"?Gt:Mt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=n,l=j(),o=b("span"),a=ee(r),c=j(),i=b("span"),d=j(),u=b("span"),g=b("div"),ue(m.$$.fragment),h=ee(`
        Guessed:`),v=j(),N=b("span"),w=ee(k),V=j(),I=b("span"),this.h()},l(S){e=y(S,"DIV",{class:!0});var O=C(e);t=y(O,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=n),l=B(O),o=y(O,"SPAN",{});var P=C(o);a=te(P,r),P.forEach(_),c=B(O),i=y(O,"SPAN",{}),C(i).forEach(_),d=B(O),u=y(O,"SPAN",{class:!0});var E=C(u);g=y(E,"DIV",{class:!0});var D=C(g);fe(m.$$.fragment,D),D.forEach(_),h=te(E,`
        Guessed:`),E.forEach(_),v=B(O),N=y(O,"SPAN",{});var A=C(N);w=te(A,k),A.forEach(_),V=B(O),I=y(O,"SPAN",{}),C(I).forEach(_),O.forEach(_),this.h()},h(){p(g,"class","absolute left-[-2rem] p-1"),p(u,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(S,O){R(S,e,O),f(e,t),f(e,l),f(e,o),f(o,a),f(e,c),f(e,i),f(e,d),f(e,u),f(u,g),de(m,g,null),f(u,h),f(e,v),f(e,N),f(N,w),f(e,V),f(e,I),G=!0},p(S,O){(!G||O&1)&&r!==(r=S[0].latestGuess.target+"")&&ye(a,r);const P={};O&2&&(P.icon=S[1]==="correct"?Gt:Mt),m.$set(P),(!G||O&1)&&k!==(k=S[0].latestGuess.guessed+"")&&ye(w,k)},i(S){G||(x(m.$$.fragment,S),G=!0)},o(S){z(m.$$.fragment,S),G=!1},d(S){S&&_(e),he(m)}}}function Pr(s){let e,t,n="Target:",l,o,r=s[8](s[0].latestGuess.target||0)+"",a,c,i,d,u,g,m,h,v,N,k=s[8](s[0].latestGuess.guessed||0)+"",w,V,I,G="",S;return m=new Me({props:{icon:s[1]==="correct"?Gt:Mt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=n,l=j(),o=b("span"),a=ee(r),c=j(),i=b("span"),d=j(),u=b("span"),g=b("div"),ue(m.$$.fragment),h=ee(`
        Guessed:`),v=j(),N=b("span"),w=ee(k),V=j(),I=b("span"),I.innerHTML=G,this.h()},l(O){e=y(O,"DIV",{class:!0});var P=C(e);t=y(P,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=n),l=B(P),o=y(P,"SPAN",{});var E=C(o);a=te(E,r),E.forEach(_),c=B(P),i=y(P,"SPAN",{}),C(i).forEach(_),d=B(P),u=y(P,"SPAN",{class:!0});var D=C(u);g=y(D,"DIV",{class:!0});var A=C(g);fe(m.$$.fragment,A),A.forEach(_),h=te(D,`
        Guessed:`),D.forEach(_),v=B(P),N=y(P,"SPAN",{});var L=C(N);w=te(L,k),L.forEach(_),V=B(P),I=y(P,"SPAN",{"data-svelte-h":!0}),ae(I)!=="svelte-1qufua2"&&(I.innerHTML=G),P.forEach(_),this.h()},h(){p(g,"class","absolute left-[-2rem] p-1"),p(u,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(O,P){R(O,e,P),f(e,t),f(e,l),f(e,o),f(o,a),f(e,c),f(e,i),f(e,d),f(e,u),f(u,g),de(m,g,null),f(u,h),f(e,v),f(e,N),f(N,w),f(e,V),f(e,I),S=!0},p(O,P){(!S||P&1)&&r!==(r=O[8](O[0].latestGuess.target||0)+"")&&ye(a,r);const E={};P&2&&(E.icon=O[1]==="correct"?Gt:Mt),m.$set(E),(!S||P&1)&&k!==(k=O[8](O[0].latestGuess.guessed||0)+"")&&ye(w,k)},i(O){S||(x(m.$$.fragment,O),S=!0)},o(O){z(m.$$.fragment,O),S=!1},d(O){O&&_(e),he(m)}}}function In(s){let e,t=mt(s[12])+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","mx-1")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o&4&&t!==(t=mt(l[12])+"")&&ye(n,t)},d(l){l&&_(e)}}}function jr(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){R(t,e,n)},p:ve,d(t){t&&_(e)}}}function Br(s){let e,t="Next",n,l,o="Autoplay",r,a;return{c(){e=b("button"),e.textContent=t,n=j(),l=b("button"),l.textContent=o,this.h()},l(c){e=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-uy473n"&&(e.textContent=t),n=B(c),l=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1cfj1sl"&&(l.textContent=o),this.h()},h(){p(e,"class","btn primary mr-1"),p(l,"class","btn primary")},m(c,i){R(c,e,i),R(c,n,i),R(c,l,i),r||(a=[Y(e,"click",s[4]),Y(l,"click",s[5])],r=!0)},p:ve,d(c){c&&(_(e),_(n),_(l)),r=!1,qe(a)}}}function Gr(s){let e,t="Stop autoplay",n,l;return{c(){e=b("button"),e.textContent=t,this.h()},l(o){e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){p(e,"class","btn primary")},m(o,r){R(o,e,r),n||(l=Y(e,"click",s[10]),n=!0)},p:ve,d(o){o&&_(e),n=!1,l()}}}function Mr(s){let e,t="Try Again",n,l,o="Clear",r,a;return{c(){e=b("button"),e.textContent=t,n=j(),l=b("button"),l.textContent=o,this.h()},l(c){e=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-15zs1cu"&&(e.textContent=t),n=B(c),l=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-11mnk9v"&&(l.textContent=o),this.h()},h(){p(e,"class","btn primary mr-1"),p(l,"class","btn primary")},m(c,i){R(c,e,i),R(c,n,i),R(c,l,i),r||(a=[Y(e,"click",s[6]),Y(l,"click",s[7])],r=!0)},p:ve,d(c){c&&(_(e),_(n),_(l)),r=!1,qe(a)}}}function Rr(s){let e,t,n,l,o,r,a;const c=[Pr,Vr,Or,Lr,Dr,Sr],i=[];function d(h,v){return h[0]instanceof Pt&&(h[1]==="correct"||h[1]==="wrong")?0:h[0]instanceof qt&&(h[1]==="correct"||h[1]==="wrong")?1:h[0]instanceof pt&&(h[1]==="correct"||h[1]==="wrong")?2:h[0]&&h[1]==="ended"?3:h[2].length>0?4:5}t=d(s),n=i[t]=c[t](s);function u(h,v){return h[0]&&h[1]==="ended"?Mr:h[0]&&h[3].autoplay?Gr:h[0]?Br:jr}let g=u(s),m=g(s);return{c(){e=b("div"),n.c(),o=j(),r=b("div"),m.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var v=C(e);n.l(v),v.forEach(_),o=B(h),r=y(h,"DIV",{class:!0});var N=C(r);m.l(N),N.forEach(_),this.h()},h(){p(e,"class",l=Ae(`${s[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),p(r,"class","mt-2 h-8 flex items-center")},m(h,v){R(h,e,v),i[t].m(e,null),R(h,o,v),R(h,r,v),m.m(r,null),a=!0},p(h,[v]){let N=t;t=d(h),t===N?i[t].p(h,v):(Ue(),z(i[N],1,1,()=>{i[N]=null}),Ke(),n=i[t],n?n.p(h,v):(n=i[t]=c[t](h),n.c()),x(n,1),n.m(e,null)),(!a||v&512&&l!==(l=Ae(`${h[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"))&&p(e,"class",l),g===(g=u(h))&&m?m.p(h,v):(m.d(1),m=g(h),m&&(m.c(),m.m(r,null)))},i(h){a||(x(n),a=!0)},o(h){z(n),a=!1},d(h){h&&(_(e),_(o),_(r)),i[t].d(),m.d()}}}const Tn=s=>s.note,An=s=>s.note;function xr(s,e,t){let n,l,o,r;be(s,vt,h=>t(11,n=h)),be(s,_t,h=>t(1,l=h)),be(s,wt,h=>t(2,o=h)),be(s,gt,h=>t(3,r=h));let{game:a}=e;function c(){De.nextGuess()}function i(){De.setOptionValue("autoplay",!0),De.nextGuess()}function d(){a instanceof pt?De.play(a.type,a.opts):a&&De.play(a.type,void 0)}function u(){De.clearGame()}function g(h){const v=n.notesMap.get(h%12);return mt({midi:h,...v})}const m=()=>De.setOptionValue("autoplay",!1);return s.$$set=h=>{t(9,e=Ie(Ie({},e),Ne(h))),"game"in h&&t(0,a=h.game)},e=Ne(e),[a,l,o,r,c,i,d,u,g,e,m]}class $r extends Fe{constructor(e){super(),He(this,e,xr,Rr,ze,{game:0})}}function Ur(s){let e,t,n,l=[{type:"checkbox"},s[2]],o={};for(let r=0;r<l.length;r+=1)o=Ie(o,l[r]);return{c(){e=b("input"),this.h()},l(r){e=y(r,"INPUT",{type:!0}),this.h()},h(){jt(e,o),W(e,"svelte-mzrxuq",!0)},m(r,a){R(r,e,a),e.autofocus&&e.focus(),s[5](e),t||(n=[Y(e,"change",s[3]),Y(e,"input",s[4]),Y(e,"keydown",s[1])],t=!0)},p(r,[a]){jt(e,o=js(l,[{type:"checkbox"},a&4&&r[2]])),W(e,"svelte-mzrxuq",!0)},i:ve,o:ve,d(r){r&&_(e),s[5](null),t=!1,qe(n)}}}function Kr(s,e,t){let n;function l(c){c.key==="Enter"&&n.click()}function o(c){Bt.call(this,s,c)}function r(c){Bt.call(this,s,c)}function a(c){vs[c?"unshift":"push"](()=>{n=c,t(0,n)})}return s.$$set=c=>{t(2,e=Ie(Ie({},e),Ne(c)))},e=Ne(e),[n,l,e,o,r,a]}class Nt extends Fe{constructor(e){super(),He(this,e,Kr,Ur,ze,{})}}const Vs={ar:{name:"Arabic",import:Te(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:Te(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:Te(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:Te(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:Te(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:Te(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:Te(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:Te(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:Te(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>Hr)},fa:{name:"Farsi",import:Te(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:Te(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:Te(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:Te(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:Te(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:Te(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:Te(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:Te(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:Te(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:Te(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:Te(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:Te(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:Te(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:Te(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:Te(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:Te(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:Te(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:Te(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:Te(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:Te(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:Te(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:Te(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:Te(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:Te(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function Cl(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default.slice(0,4)}}async function Fr(s=["en"]){let e={code:"en",layout:Vs.en,index:99};Object.entries(Vs).forEach(([n,l])=>{for(let o=0;o<s.length;o+=1)n===s[o]&&(!e||e.index>o)&&(e={code:n,layout:l,index:o})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:Cl(t.default)}}const Il={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Hr=Object.freeze(Object.defineProperty({__proto__:null,default:Il},Symbol.toStringTag,{value:"Module"})),Tl=[0,2,4,5,7,9,11],Al=[1,3,-1,6,8,10,-1];function zr(s,e,t){const n=s.keyType==="white"?Tl:Al,l=n[t%n.length];let o;if(l>=0){o=e[l];const r=Math.floor(t/n.length);return{...o,semitones:o.semitones+(r>0?r:0)*12}}}function Vt(s,e,t=0,n=0){const l=s.keyType==="white"?Tl:Al;let o=-1,r=0,a=0;return s.keys.forEach((c,i)=>{if(c.key.charAt(0)!=="{"&&i>=t&&o===-1?o=i:o!==-1&&c.key==="{empty}"&&(r+=1),o!==-1&&c.key.charAt(0)!=="{"){const d=i-r-o+n,u=l[d%l.length];if(u>=0){const g=e[u],m=Math.floor(d/l.length);c.note={...g,semitones:g.semitones+(m>0?m:0)*12},a=i-o}}}),{firstIndex:o,lastIndex:a}}const Nl=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function qr(s,e){let t=[];const n=s.default.map((r,a)=>{if(a===0){const c=r.split(" ").filter(i=>i!=="{bksp}");for(;c.length!==13;)c.length<13?c.unshift("{empty}"):c.shift();return[...c,"{bksp}"]}else if(a===1){const c=r.split(" ");return t=c.slice(13),[...c.slice(0,13),"{enter}"]}else{if(a===2)return[...r.split(" ").slice(0,13).filter(c=>c!=="{enter}"),...t].slice(0,13);if(a===3){const c=["{shift}",...r.split(" ").slice(1,12).filter(d=>d!=="{shift}"),"{shift}"];let i=1;for(;c.length<13;)c.splice(i,0,"{empty}"),i=i===1?-1:1;return c}else return r.split(" ")}});let l;s.codes?l=s.codes.map(r=>r.split(" ")):l=Nl;const o=[0,1,2,3].map(r=>n[r].map((a,c)=>({key:a,code:l[r][c]})));return[{keyType:e==="two-rows"?"black":null,startNoteOffset:2,availableNotes:11,keys:o[0]},{keyType:e==="two-rows"?"white":"black",startNoteOffset:e==="two-rows"?1:2,availableNotes:12,keys:o[1]},{keyType:e==="two-rows"?"black":"white",startNoteOffset:1,availableNotes:12,keys:o[2]},{keyType:e==="two-rows"?"white":null,startNoteOffset:1,availableNotes:11,keys:o[3]}]}const Nn=[{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]}];class Sl{constructor(e){return this.rows=Nn,this.setCustomRow={row:Nn[0],rowIndex:0,nextKeyIdx:-1,nextNoteOffset:0},this.opts={hotkeydRows:"middle-row",isCustom:!1,layout:{code:"en",name:"English",imported:Cl(Il)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=qr(e,this.opts.hotkeydRows),this}setRows(e){return this.rows=e,this}setNotes(e){if(this.opts.hotkeydRows==="middle-row"){const{firstIndex:t}=Vt(this.rows[2],e);Vt(this.rows[1],e,1+t)}else{const{firstIndex:t,lastIndex:n}=Vt(this.rows[3],e);Vt(this.rows[2],e,t);const{firstIndex:l}=Vt(this.rows[1],e,0,n+1);Vt(this.rows[0],e,1+l,n+1)}}startSetCustomRow(e){const t={...this.rows[e],keys:this.rows[e].keys.map(a=>({...a}))},{availableNotes:n,startNoteOffset:l}=t,o=this.opts.hotkeydRows==="two-rows"&&(e===0||e===1)?3:-1,r=o!==-1?this.rows[o].keys.reduce((a,c)=>(a===-1&&c.note?a=0:a!==-1&&(c.key[0]!=="{"||c.key==="{empty}")&&(a+=1),a),-1)+1:0;return this.setCustomRow={row:t,rowIndex:e,nextKeyIdx:l,nextNoteOffset:r},{first:l,count:n}}setNextCustomNote(e,t,n){let l;const{nextKeyIdx:o,nextNoteOffset:r,row:a}=this.setCustomRow,c=o+r-a.startNoteOffset,i=zr(a,n,c);return i?l={key:e,code:t,note:i}:l={key:e,code:t},this.setCustomRow.nextKeyIdx+=1,{index:this.setCustomRow.nextKeyIdx,key:l}}skipNextCustomNote(){return this.setCustomRow.nextKeyIdx+=1,this.setCustomRow.nextNoteOffset-=1,{index:this.setCustomRow.nextKeyIdx,key:{code:"EMPTY",key:"{empty}"}}}}function Wr(s){const e=[...s.map(l=>l.keys.map(o=>o.key).join(" "))],t=["","","",""];let n=!1;return s.forEach((l,o)=>{const r=[];for(let a=0;a<l.keys.length;a+=1)r.push(l.keys[a].code),n=n||l.keys[a].code!==Nl[o][a];t[o]=r.join(" ")}),n?{default:e,codes:t}:{default:e}}function Sn(s,e,t){const n=s.slice();return n[15]=e[t].key,n[16]=e[t].value,n[17]=e[t].icon,n[19]=t,n}const Jr=s=>({}),Dn=s=>({}),Yr=s=>({}),Ln=s=>({});function On(s){let e,t,n,l,o,r,a,c,i,d,u;const g=s[12].header,m=Bs(g,s,s[11],Dn);let h=_e(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=Vn(Sn(s,h,k));const N=k=>z(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),n=j(),l=b("ul"),o=b("li"),m&&m.c(),r=j();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(_),n=B(k),l=y(k,"UL",{class:!0});var w=C(l);o=y(w,"LI",{});var V=C(o);m&&m.l(V),V.forEach(_),r=B(w);for(let I=0;I<v.length;I+=1)v[I].l(w);w.forEach(_),this.h()},h(){p(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),p(e,"tabindex","-1"),p(l,"class",a=Ae(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,w){R(k,e,w),R(k,n,w),R(k,l,w),f(l,o),m&&m.m(o,null),f(l,r);for(let V=0;V<v.length;V+=1)v[V]&&v[V].m(l,null);i=!0,d||(u=Y(e,"click",s[7]),d=!0)},p(k,w){if(s=k,m&&m.p&&(!i||w&2048)&&Gs(m,g,s,s[11],i?Rs(g,s[11],w,Jr):Ms(s[11]),Dn),w&265){h=_e(s[0]);let V;for(V=0;V<h.length;V+=1){const I=Sn(s,h,V);v[V]?(v[V].p(I,w),x(v[V],1)):(v[V]=Vn(I),v[V].c(),x(v[V],1),v[V].m(l,null))}for(Ue(),V=h.length;V<v.length;V+=1)N(V);Ke()}(!i||w&4&&a!==(a=Ae(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&p(l,"class",a)},i(k){if(!i){k&&us(()=>{i&&(t||(t=Ct(e,fs,{duration:is},!0)),t.run(1))}),x(m,k);for(let w=0;w<h.length;w+=1)x(v[w]);k&&us(()=>{i&&(c||(c=Ct(l,ds,{duration:is},!0)),c.run(1))}),i=!0}},o(k){k&&(t||(t=Ct(e,fs,{duration:is},!1)),t.run(0)),z(m,k),v=v.filter(Boolean);for(let w=0;w<v.length;w+=1)z(v[w]);k&&(c||(c=Ct(l,ds,{duration:is},!1)),c.run(0)),i=!1},d(k){k&&(_(e),_(n),_(l)),k&&t&&t.end(),m&&m.d(k),Oe(v,k),k&&c&&c.end(),d=!1,u()}}}function Qr(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","w-[24px]")},m(t,n){R(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&_(e)}}}function Xr(s){let e,t;return e=new Me({props:{class:"mr-2",icon:s[17],width:16}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p(n,l){const o={};l&1&&(o.icon=n[17]),e.$set(o)},i(n){t||(x(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function Vn(s){let e,t,n,l,o,r,a=s[16]+"",c,i,d,u,g;const m=[Xr,Qr],h=[];function v(k,w){return k[17]?0:1}n=v(s),l=h[n]=m[n](s);function N(){return s[13](s[15])}return{c(){e=b("li"),t=b("button"),l.c(),o=j(),r=b("div"),c=ee(a),i=j(),this.h()},l(k){e=y(k,"LI",{});var w=C(e);t=y(w,"BUTTON",{class:!0});var V=C(t);l.l(V),o=B(V),r=y(V,"DIV",{});var I=C(r);c=te(I,a),I.forEach(_),V.forEach(_),i=B(w),w.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),W(t,"selected",s[15]===s[3])},m(k,w){R(k,e,w),f(e,t),h[n].m(t,null),f(t,o),f(t,r),f(r,c),f(e,i),d=!0,u||(g=Y(t,"click",N),u=!0)},p(k,w){s=k;let V=n;n=v(s),n===V?h[n].p(s,w):(Ue(),z(h[V],1,1,()=>{h[V]=null}),Ke(),l=h[n],l?l.p(s,w):(l=h[n]=m[n](s),l.c()),x(l,1),l.m(t,o)),(!d||w&1)&&a!==(a=s[16]+"")&&ye(c,a),(!d||w&9)&&W(t,"selected",s[15]===s[3])},i(k){d||(x(l),d=!0)},o(k){z(l),d=!1},d(k){k&&_(e),h[n].d(),u=!1,g()}}}function Zr(s){let e,t,n,l,o,r,a,c,i;const d=s[12].value,u=Bs(d,s,s[11],Ln);let g=s[6]&&On(s);return{c(){e=b("div"),t=b("button"),u&&u.c(),o=j(),g&&g.c(),this.h()},l(m){e=y(m,"DIV",{class:!0,id:!0});var h=C(e);t=y(h,"BUTTON",{class:!0,title:!0});var v=C(t);u&&u.l(v),v.forEach(_),o=B(h),g&&g.l(h),h.forEach(_),this.h()},h(){p(t,"class",n=Ae(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),p(t,"title",l=s[9].title||""),W(t,"disabled",s[4]),W(t,"open",s[6]),p(e,"class",r=Ae(`relative ${s[2]||""}`)+" svelte-h65upg"),p(e,"id",s[1])},m(m,h){R(m,e,h),f(e,t),u&&u.m(t,null),f(e,o),g&&g.m(e,null),s[14](e),a=!0,c||(i=Y(t,"click",s[7]),c=!0)},p(m,[h]){u&&u.p&&(!a||h&2048)&&Gs(u,d,m,m[11],a?Rs(d,m[11],h,Yr):Ms(m[11]),Ln),(!a||h&512&&n!==(n=Ae(`${m[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&p(t,"class",n),(!a||h&512&&l!==(l=m[9].title||""))&&p(t,"title",l),(!a||h&528)&&W(t,"disabled",m[4]),(!a||h&576)&&W(t,"open",m[6]),m[6]?g?(g.p(m,h),h&64&&x(g,1)):(g=On(m),g.c(),x(g,1),g.m(e,null)):g&&(Ue(),z(g,1,1,()=>{g=null}),Ke()),(!a||h&4&&r!==(r=Ae(`relative ${m[2]||""}`)+" svelte-h65upg"))&&p(e,"class",r),(!a||h&2)&&p(e,"id",m[1])},i(m){a||(x(u,m),x(g),a=!0)},o(m){z(u,m),z(g),a=!1},d(m){m&&_(e),u&&u.d(m),g&&g.d(),s[14](null),c=!1,i()}}}const is=400;function eo(s,e,t){let{$$slots:n={},$$scope:l}=e,{options:o,id:r=void 0,containerClass:a=void 0,selected:c=void 0,disabled:i=void 0,onSelect:d}=e,u,g=!1;function m(){i||t(6,g=!g)}function h(k){t(6,g=d(k))}const v=k=>h(k);function N(k){vs[k?"unshift":"push"](()=>{u=k,t(5,u)})}return s.$$set=k=>{t(9,e=Ie(Ie({},e),Ne(k))),"options"in k&&t(0,o=k.options),"id"in k&&t(1,r=k.id),"containerClass"in k&&t(2,a=k.containerClass),"selected"in k&&t(3,c=k.selected),"disabled"in k&&t(4,i=k.disabled),"onSelect"in k&&t(10,d=k.onSelect),"$$scope"in k&&t(11,l=k.$$scope)},e=Ne(e),[o,r,a,c,i,u,g,m,h,e,d,l,n,v,N]}class to extends Fe{constructor(e){super(),He(this,e,eo,Zr,ze,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function so(s){let e,t,n,l,o,r,a,c=[s[2],{type:"checkbox"}],i={};for(let d=0;d<c.length;d+=1)i=Ie(i,c[d]);return{c(){e=b("label"),t=b("input"),n=j(),l=b("div"),this.h()},l(d){e=y(d,"LABEL",{class:!0});var u=C(e);t=y(u,"INPUT",{type:!0}),n=B(u),l=y(u,"DIV",{class:!0}),C(l).forEach(_),u.forEach(_),this.h()},h(){jt(t,i),W(t,"svelte-k5zciy",!0),p(l,"class","slider svelte-k5zciy"),p(e,"class",o=Ae(`${s[2].containerClass||""} toggle`)+" svelte-k5zciy")},m(d,u){R(d,e,u),f(e,t),t.autofocus&&t.focus(),s[4](t),f(e,n),f(e,l),r||(a=[Y(t,"change",s[3]),Y(t,"keydown",s[1])],r=!0)},p(d,[u]){jt(t,i=js(c,[u&4&&d[2],{type:"checkbox"}])),W(t,"svelte-k5zciy",!0),u&4&&o!==(o=Ae(`${d[2].containerClass||""} toggle`)+" svelte-k5zciy")&&p(e,"class",o)},i:ve,o:ve,d(d){d&&_(e),s[4](null),r=!1,qe(a)}}}function no(s,e,t){let n;function l(a){a.key==="Enter"&&n.click()}function o(a){Bt.call(this,s,a)}function r(a){vs[a?"unshift":"push"](()=>{n=a,t(0,n)})}return s.$$set=a=>{t(2,e=Ie(Ie({},e),Ne(a)))},e=Ne(e),[n,l,e,o,r]}class lo extends Fe{constructor(e){super(),He(this,e,no,so,ze,{})}}function ro(s,e,t){return e==="Escape"?{e:"hotkeys-cancel"}:e==="Space"?{e:"hotkeys-skip-key"}:s.has(e)?{e:"hotkeys-no-key"}:(s.add(e),{e:"hotkeys-captured-key",data:{code:e,key:t}})}const Ks=/^[a-gA-G]$/,Dl=/^[♭Bb#♯sS]$/,oo=/^[0-9]$/;let se="",Ye;function ao(s,e){const{useHotkeys:t}=Ce(nt),n=Ce(Ol).get(s);if(t&&se.length===0&&n&&n.note)return se="",{e:"guessed-key",data:n.note.note};if(!t&&se.length===0&&Ks.test(e))return se+=e.toUpperCase(),{e:"string",data:se};if(!t&&se.length>0&&Dl.test(e))return e==="b"||e==="B"?se+="♭":se+="♯",{e:"string",data:se};if(s==="Backspace"&&se.length>0)return se=se.slice(0,-1),{e:"string",data:se};if(s==="Enter"&&se.length>0){const l=se;return se="",{e:"guessed-key",data:l}}return!1}function io(s,e){if(s==="Enter"&&se.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let n=0;n<se.length;n+=1)n===0?t.note+=se[n]:t.chord.length>0?t.chord+=se[n].toLowerCase():se[n]==="♭"?(t.note+=se[n],t.flats+=1):se[n]==="♯"?(t.note+=se[n],t.sharps+=1):t.chord+=se[n].toLowerCase();return se="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&se.length>0)return se=se.slice(0,-1),{e:"string",data:se};if(se.length===0&&Ks.test(e))return se+=e.toUpperCase(),{e:"string",data:se};if(se.length>0&&e.length===1)return se.length===1&&(e==="b"||e==="B")?se+="♭":se.length===1&&e==="#"?se+="♯":se+=e,{e:"string",data:se}}return!1}function co(s,e,t){const{useAutoOctave:n,useHotkeys:l}=Ce(nt);let o;const a=Ce(Ol).get(s),c=(a==null?void 0:a.key)||"";let i=!1;if(!Ye&&l&&(a!=null&&a.note)?(Ye=a.note,n&&(o=ps({midi:Ce(Rt)[0].midi,flats:0,sharps:0})),i="note"):!l&&se.length===0&&Ks.test(e)?(se+=e.toUpperCase(),i="input"):!l&&se.length>0&&Dl.test(e)?(e==="b"||e==="B"?se+="♭":se+="♯",i="input"):!l&&se.length>0&&s==="Enter"&&n&&(o=ps({midi:Ce(Rt)[0].midi,flats:0,sharps:0}),i="octave"),!i&&oo.test(c))try{o=parseInt(c),i="octave"}catch{}if(i&&(Ye||se)&&o!==void 0){const d=(Ye==null?void 0:Ye.note)??se;return t&&(o+=1),Ye&&(Ye==null?void 0:Ye.semitones)>=12&&(o+=Math.floor(Ye.semitones/12)),Ye=void 0,se="",{e:"guessed-note",data:{note:d,octave:o}}}else if(s==="Backspace"&&(Ye||se.length>0))return Ye=void 0,se=se.slice(0,-1),{e:"string",data:se};return i==="note"?{e:"note",data:Ye}:i==="input"?{e:"string",data:se}:!1}const Fs={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}"]}},Ht=new Set,Ll=new Sl({layout:Fs}),ht=Ve(void 0);Wt(ht,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const Et=bt(Ve({isCustom:!1,layout:Fs,hotkeydRows:"middle-row"}),{key:"keyboard-options"}),xt=Ve(Ll.rows),Tt=Ve(Ll);vt.subscribe(s=>{const e=Ce(Tt);e.setNotes(Array.from(s.notesMap.values())),xt.set(e.rows),Tt.set(e)});Et.subscribe(s=>{const e=new Sl(s),t=Ce(vt);e.setNotes(Array.from(t.notesMap.values())),xt.set(e.rows),Tt.set(e)});const Ol=Wt(Tt,s=>new Map(s.rows.flatMap(e=>e.keys.map(t=>[t.code,t])))),uo=Wt(Tt,s=>s.rows.flatMap(e=>e.keys).map(e=>e.note).filter(e=>e!==void 0).sort((e,t)=>e.semitones-t.semitones)),ct={async setLayout(s){const e=await Fr(s),t=Ce(Et);e.code!==t.layout.code&&Et.update(n=>({...n,isCustom:!1,layout:e}))},async setCustomLayout(s){s?Et.update(e=>({...e,isCustom:s,layout:{code:"custom",name:"Custom",imported:e.layout.imported}})):this.setLayout(navigator.languages)},toggleRows(s){Et.update(e=>({...e,hotkeydRows:s??(e.hotkeydRows==="middle-row"?"two-rows":"middle-row")}))},captureHotkeyRow(s){const e=Ce(Tt),t=Ce(vt),{first:n,count:l}=e.startSetCustomRow(s);ht.set({nextIndex:n,rowIndex:s,count:l,scaleNotes:Array.from(t.notesMap.values())})},findNote(s){return Ce(uo).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((n,l)=>n+(l.toLowerCase()==="b"||l==="♭"?-1:l.toLowerCase()==="s"||l==="#"||l==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleHotkeyInput(s,e,t){const n=ro(Ht,e,t),l=Ce(Tt);let o;const r=l.setCustomRow.nextKeyIdx;n.e==="hotkeys-cancel"?(ht.set(void 0),Ht.clear()):n.e==="hotkeys-skip-key"?o=l.skipNextCustomNote():n.e==="hotkeys-captured-key"&&(o=l.setNextCustomNote(n.data.key,n.data.code,s.scaleNotes));const a=Ce(xt);if(o&&(a[s.rowIndex].keys[r]=o.key,xt.set(a),ht.update(c=>c?{...c,nextIndex:o.index}:void 0)),s.count===r){const c=Wr(a);Et.update(i=>({...i,layout:{...i.layout,imported:c}})),ht.set(void 0),Ht.clear()}return n},handleInput(s,e,t=!1){const n=Ce(It),l=Ce(ht);return l?this.handleHotkeyInput(l,s,e):n instanceof qt?ao(s,e.toUpperCase()):n instanceof pt&&n.type==="chords-write"?io(s,e):Ce(nt).useKeyboard?co(s,e.toUpperCase(),t):!1},cancelCapture(){ht.set(void 0),Ht.clear()},reset(){Et.set({isCustom:!1,layout:Fs,hotkeydRows:"middle-row"}),ht.set(void 0),Ht.clear()}};function Pn(s){let e;return{c(){e=b("li"),this.h()},l(t){e=y(t,"LI",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","m-[0.175rem] mr-0")},m(t,n){R(t,e,n)},d(t){t&&_(e)}}}function jn(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,n){R(t,e,n)},d(t){t&&_(e)}}}function Bn(s){let e,t=s[0].note.note+"",n,l;return{c(){e=b("div"),n=ee(t),l=ee(s[3]),this.h()},l(o){e=y(o,"DIV",{class:!0});var r=C(e);n=te(r,t),l=te(r,s[3]),r.forEach(_),this.h()},h(){p(e,"class","absolute top-0 left-0")},m(o,r){R(o,e,r),f(e,n),f(e,l)},p(o,r){r&1&&t!==(t=o[0].note.note+"")&&ye(n,t),r&8&&ye(l,o[3])},d(o){o&&_(e)}}}function fo(s){let e,t,n,l,o,r,a=Mn(s[0].key)+"",c,i,d,u,g=s[0].key==="{enter}"&&Pn(),m=s[0].key==="{enter}"&&jn(),h=s[0].note&&Bn(s);return{c(){g&&g.c(),e=j(),t=b("li"),n=b("button"),m&&m.c(),l=j(),h&&h.c(),o=j(),r=b("div"),c=ee(a),this.h()},l(v){g&&g.l(v),e=B(v),t=y(v,"LI",{class:!0});var N=C(t);n=y(N,"BUTTON",{class:!0});var k=C(n);m&&m.l(k),l=B(k),h&&h.l(k),o=B(k),r=y(k,"DIV",{});var w=C(r);c=te(w,a),w.forEach(_),k.forEach(_),N.forEach(_),this.h()},h(){p(n,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),W(n,"items-center",!s[0].note),W(n,"items-end",s[0].note),p(t,"class",i=Ae(`${s[4].class||""} m-[0.175rem] ${Gn(s[1])} min-w-[32px]`)+" svelte-1479mcy"),W(t,"enter",s[0].key==="{enter}"),W(t,"captured",s[2])},m(v,N){g&&g.m(v,N),R(v,e,N),R(v,t,N),f(t,n),m&&m.m(n,null),f(n,l),h&&h.m(n,null),f(n,o),f(n,r),f(r,c),d||(u=Y(n,"click",s[10]),d=!0)},p(v,[N]){v[0].key==="{enter}"?g||(g=Pn(),g.c(),g.m(e.parentNode,e)):g&&(g.d(1),g=null),v[0].key==="{enter}"?m||(m=jn(),m.c(),m.m(n,l)):m&&(m.d(1),m=null),v[0].note?h?h.p(v,N):(h=Bn(v),h.c(),h.m(n,o)):h&&(h.d(1),h=null),N&1&&a!==(a=Mn(v[0].key)+"")&&ye(c,a),N&1&&W(n,"items-center",!v[0].note),N&1&&W(n,"items-end",v[0].note),N&18&&i!==(i=Ae(`${v[4].class||""} m-[0.175rem] ${Gn(v[1])} min-w-[32px]`)+" svelte-1479mcy")&&p(t,"class",i),N&19&&W(t,"enter",v[0].key==="{enter}"),N&22&&W(t,"captured",v[2])},i:ve,o:ve,d(v){v&&(_(e),_(t)),g&&g.d(v),m&&m.d(),h&&h.d(),d=!1,u()}}}function Gn(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function Mn(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function ho(s,e,t){let n,l,o,r,a,c;be(s,ht,m=>t(7,r=m)),be(s,ys,m=>t(8,a=m)),be(s,xt,m=>t(9,c=m));let{rowIndex:i,keyIndex:d}=e,u;function g(m){Bt.call(this,s,m)}return s.$$set=m=>{t(4,e=Ie(Ie({},e),Ne(m))),"rowIndex"in m&&t(5,i=m.rowIndex),"keyIndex"in m&&t(6,d=m.keyIndex)},s.$$.update=()=>{s.$$.dirty&608&&t(0,n=c[i].keys[d]),s.$$.dirty&257&&t(3,l=n.note?ps({midi:n.note.semitones+a[0],flats:0,sharps:0}):0),s.$$.dirty&224&&t(2,o=r&&r.rowIndex===i&&r.nextIndex===d),s.$$.dirty&65&&(n.key==="{bksp}"?t(1,u=2):n.key==="{tab}"?t(1,u=1.5):n.key==="{enter}"?t(1,u=2):n.key==="{lock}"?t(1,u=1.75):n.key==="{shift}"&&d===0?t(1,u=1.5):n.key==="{shift}"?t(1,u=2.5):t(1,u=1))},e=Ne(e),[n,u,o,l,e,i,d,r,a,c,g]}class mo extends Fe{constructor(e){super(),He(this,e,ho,fo,ze,{rowIndex:5,keyIndex:6})}}function Rn(s,e,t){const n=s.slice();return n[13]=e[t],n[15]=t,n}function xn(s,e,t){const n=s.slice();return n[16]=e[t],n[18]=t,n}function _o(s){let e,t=s[0].layout.name+"",n;return{c(){e=b("div"),n=ee(t),this.h()},l(l){e=y(l,"DIV",{slot:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"slot","value")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o&1&&t!==(t=l[0].layout.name+"")&&ye(n,t)},d(l){l&&_(e)}}}function $n(s){let e,t,n,l,o;t=new Me({props:{icon:xl,width:20}});function r(){return s[12](s[15])}return{c(){e=b("button"),ue(t.$$.fragment),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var c=C(e);fe(t.$$.fragment,c),c.forEach(_),this.h()},h(){p(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(a,c){R(a,e,c),de(t,e,null),n=!0,l||(o=Y(e,"click",r),l=!0)},p(a,c){s=a},i(a){n||(x(t.$$.fragment,a),n=!0)},o(a){z(t.$$.fragment,a),n=!1},d(a){a&&_(e),he(t),l=!1,o()}}}function Un(s){let e,t;return e=new mo({props:{rowIndex:s[15],keyIndex:s[18]}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p:ve,i(n){t||(x(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function Kn(s){let e,t,n,l,o=s[2][s[15]]&&s[0].isCustom&&$n(s),r=_e(s[13].keys),a=[];for(let i=0;i<r.length;i+=1)a[i]=Un(xn(s,r,i));const c=i=>z(a[i],1,1,()=>{a[i]=null});return{c(){e=b("li"),o&&o.c(),t=j();for(let i=0;i<a.length;i+=1)a[i].c();n=Le(),this.h()},l(i){e=y(i,"LI",{class:!0});var d=C(e);o&&o.l(d),d.forEach(_),t=B(i);for(let u=0;u<a.length;u+=1)a[u].l(i);n=Le(),this.h()},h(){p(e,"class","col-span-2 svelte-1av9wwd")},m(i,d){R(i,e,d),o&&o.m(e,null),R(i,t,d);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(i,d);R(i,n,d),l=!0},p(i,d){if(i[2][i[15]]&&i[0].isCustom?o?(o.p(i,d),d&5&&x(o,1)):(o=$n(i),o.c(),x(o,1),o.m(e,null)):o&&(Ue(),z(o,1,1,()=>{o=null}),Ke()),d&8){r=_e(i[13].keys);let u;for(u=0;u<r.length;u+=1){const g=xn(i,r,u);a[u]?(a[u].p(g,d),x(a[u],1)):(a[u]=Un(g),a[u].c(),x(a[u],1),a[u].m(n.parentNode,n))}for(Ue(),u=r.length;u<a.length;u+=1)c(u);Ke()}},i(i){if(!l){x(o);for(let d=0;d<r.length;d+=1)x(a[d]);l=!0}},o(i){z(o),a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)z(a[d]);l=!1},d(i){i&&(_(e),_(t),_(n)),o&&o.d(),Oe(a,i)}}}function po(s){let e,t,n,l,o,r="Layout",a,c,i,d,u,g="Custom",m,h,v,N,k,w="One row",V,I,G,S,O="Two rows",P,E,D,A,L,T,M,$,K,Q,F;c=new to({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1 w-36",options:s[4],onSelect:s[6],$$slots:{value:[_o]},$$scope:{ctx:s}}}),h=new Nt({props:{id:"custom-layout",checked:s[0].isCustom}}),h.$on("change",s[7]),I=new lo({props:{checked:!s[1]}}),I.$on("change",s[9]),A=new Me({props:{icon:Jt,width:16}});let X=_e(s[3].rows),Z=[];for(let J=0;J<X.length;J+=1)Z[J]=Kn(Rn(s,X,J));const U=J=>z(Z[J],1,1,()=>{Z[J]=null});return{c(){e=b("div"),t=b("div"),n=b("div"),l=b("div"),o=b("label"),o.textContent=r,a=j(),ue(c.$$.fragment),i=j(),d=b("div"),u=b("label"),u.textContent=g,m=j(),ue(h.$$.fragment),v=j(),N=b("div"),k=b("label"),k.textContent=w,V=j(),ue(I.$$.fragment),G=j(),S=b("label"),S.textContent=O,P=j(),E=b("div"),D=b("button"),ue(A.$$.fragment),L=j(),T=b("div"),M=b("ul");for(let J=0;J<Z.length;J+=1)Z[J].c();this.h()},l(J){e=y(J,"DIV",{class:!0});var H=C(e);t=y(H,"DIV",{class:!0});var me=C(t);n=y(me,"DIV",{class:!0});var pe=C(n);l=y(pe,"DIV",{class:!0});var Re=C(l);o=y(Re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(o)!=="svelte-1xsr9lq"&&(o.textContent=r),a=B(Re),fe(c.$$.fragment,Re),Re.forEach(_),i=B(pe),d=y(pe,"DIV",{class:!0});var ie=C(d);u=y(ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(u)!=="svelte-11aw8ub"&&(u.textContent=g),m=B(ie),fe(h.$$.fragment,ie),ie.forEach(_),v=B(pe),N=y(pe,"DIV",{class:!0});var ce=C(N);k=y(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(k)!=="svelte-17p0yvw"&&(k.textContent=w),V=B(ce),fe(I.$$.fragment,ce),G=B(ce),S=y(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(S)!=="svelte-1wr3nwv"&&(S.textContent=O),ce.forEach(_),pe.forEach(_),P=B(me),E=y(me,"DIV",{class:!0});var le=C(E);D=y(le,"BUTTON",{class:!0});var oe=C(D);fe(A.$$.fragment,oe),oe.forEach(_),le.forEach(_),me.forEach(_),L=B(H),T=y(H,"DIV",{class:!0});var ge=C(T);M=y(ge,"UL",{class:!0});var we=C(M);for(let tt=0;tt<Z.length;tt+=1)Z[tt].l(we);we.forEach(_),ge.forEach(_),H.forEach(_),this.h()},h(){p(o,"class","font-bold mr-4"),p(o,"for","middle-row"),p(l,"class","my-1 flex items-center justify-between mr-2"),p(u,"class","font-bold mr-4"),p(u,"for","custom-layout"),p(d,"class","my-1 flex items-center"),p(k,"class","font-bold mr-4"),p(k,"for","two-rows"),p(S,"class","font-bold ml-4"),p(S,"for","two-rows"),p(N,"class","my-1 flex items-center"),p(n,"class","options svelte-1av9wwd"),p(D,"class","rounded px-1 py-1 hover:bg-gray-200"),p(E,"class","flex items-center justify-center"),p(t,"class","flex justify-between"),p(M,"class","keyboard svelte-1av9wwd"),p(T,"class","flex flex-col"),p(e,"class",$=Ae(`${s[10].class||""} relative`)+" svelte-1av9wwd")},m(J,H){R(J,e,H),f(e,t),f(t,n),f(n,l),f(l,o),f(l,a),de(c,l,null),f(n,i),f(n,d),f(d,u),f(d,m),de(h,d,null),f(n,v),f(n,N),f(N,k),f(N,V),de(I,N,null),f(N,G),f(N,S),f(t,P),f(t,E),f(E,D),de(A,D,null),f(e,L),f(e,T),f(T,M);for(let me=0;me<Z.length;me+=1)Z[me]&&Z[me].m(M,null);K=!0,Q||(F=Y(D,"click",s[5]),Q=!0)},p(J,[H]){const me={};H&524289&&(me.$$scope={dirty:H,ctx:J}),c.$set(me);const pe={};H&1&&(pe.checked=J[0].isCustom),h.$set(pe);const Re={};if(H&2&&(Re.checked=!J[1]),I.$set(Re),H&269){X=_e(J[3].rows);let ie;for(ie=0;ie<X.length;ie+=1){const ce=Rn(J,X,ie);Z[ie]?(Z[ie].p(ce,H),x(Z[ie],1)):(Z[ie]=Kn(ce),Z[ie].c(),x(Z[ie],1),Z[ie].m(M,null))}for(Ue(),ie=X.length;ie<Z.length;ie+=1)U(ie);Ke()}(!K||H&1024&&$!==($=Ae(`${J[10].class||""} relative`)+" svelte-1av9wwd"))&&p(e,"class",$)},i(J){if(!K){x(c.$$.fragment,J),x(h.$$.fragment,J),x(I.$$.fragment,J),x(A.$$.fragment,J);for(let H=0;H<X.length;H+=1)x(Z[H]);K=!0}},o(J){z(c.$$.fragment,J),z(h.$$.fragment,J),z(I.$$.fragment,J),z(A.$$.fragment,J),Z=Z.filter(Boolean);for(let H=0;H<Z.length;H+=1)z(Z[H]);K=!1},d(J){J&&_(e),he(c),he(h),he(I),he(A),Oe(Z,J),Q=!1,F()}}}function go(s,e,t){let n,l,o,r,a;be(s,Et,v=>t(0,o=v)),be(s,xt,v=>t(11,r=v)),be(s,Tt,v=>t(3,a=v)),gl(()=>{a.opts.isCustom||ct.setLayout(navigator.languages)});const c=Object.entries(Vs).map(([v,N])=>({key:v,value:N.name}));function i(){ct.reset(),ct.setLayout(navigator.languages)}function d(v){return ct.setLayout([v]),!1}function u(v){ct.setCustomLayout(v.currentTarget.checked)}function g(v){ct.captureHotkeyRow(v)}function m(){ct.toggleRows()}const h=v=>g(v);return s.$$set=v=>{t(10,e=Ie(Ie({},e),Ne(v)))},s.$$.update=()=>{s.$$.dirty&2049&&t(2,n=r.map((v,N)=>o.hotkeydRows==="middle-row"?N===1||N===2:!0)),s.$$.dirty&1&&t(1,l=o.hotkeydRows==="middle-row")},e=Ne(e),[o,l,n,a,c,i,d,u,g,m,e,r,h]}class vo extends Fe{constructor(e){super(),He(this,e,go,po,ze,{})}}function Fn(s){let e,t="Hotkey Map",n,l,o;return l=new vo({}),{c(){e=b("h4"),e.textContent=t,n=j(),ue(l.$$.fragment),this.h()},l(r){e=y(r,"H4",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-qx6hm8"&&(e.textContent=t),n=B(r),fe(l.$$.fragment,r),this.h()},h(){p(e,"class","mt-4 text-lg")},m(r,a){R(r,e,a),R(r,n,a),de(l,r,a),o=!0},i(r){o||(x(l.$$.fragment,r),o=!0)},o(r){z(l.$$.fragment,r),o=!1},d(r){r&&(_(e),_(n)),he(l,r)}}}function bo(s){let e,t,n,l,o="I/O",r,a,c,i,d,u,g,m,h="Device",v,N,k,w,V,I,G="Prompt",S,O,P="Disable",E,D,A,L,T="Sound",M,$,K,Q,F,X="Fixed velocity",Z,U,J,H,me,pe,Re="Keyboard",ie,ce,le,oe,ge,we="Hotkeys",tt,q,re,Ee,xe,ne="Auto-octave",We,je,ut,et,Qe,Je=" ",St,ft,$e,ks,Yt,ws,yt,kt,Hs="Fade timeout",Es,dt,Cs,Qt,lt,Is,zs;i=new Me({props:{icon:Jt,width:16}}),$=new Nt({props:{id:"sound",checked:s[3].useSound}}),$.$on("change",s[13]),ce=new Nt({props:{id:"keyboard",checked:s[3].useKeyboard}}),ce.$on("change",s[15]),q=new Nt({props:{id:"hotkeys",checked:s[3].useHotkeys}}),q.$on("change",s[9]),je=new Nt({props:{id:"auto-octave",checked:s[3].useAutoOctave}}),je.$on("change",s[16]);let Be=s[2]&&!s[4]&&Fn();return{c(){e=b("div"),t=b("fieldset"),n=b("legend"),l=b("button"),l.textContent=o,r=j(),a=b("div"),c=b("button"),ue(i.$$.fragment),d=j(),u=b("div"),g=b("div"),m=b("label"),m.textContent=h,v=j(),N=b("input"),w=j(),V=b("div"),I=b("button"),I.textContent=G,S=j(),O=b("button"),O.textContent=P,E=j(),D=b("div"),A=b("div"),L=b("label"),L.textContent=T,M=j(),ue($.$$.fragment),K=j(),Q=b("div"),F=b("label"),F.textContent=X,Z=j(),U=b("input"),J=j(),H=b("div"),me=b("div"),pe=b("label"),pe.textContent=Re,ie=j(),ue(ce.$$.fragment),le=j(),oe=b("div"),ge=b("label"),ge.textContent=we,tt=j(),ue(q.$$.fragment),re=j(),Ee=b("div"),xe=b("label"),xe.textContent=ne,We=j(),ue(je.$$.fragment),ut=j(),et=b("div"),Qe=b("div"),Qe.textContent=Je,St=j(),ft=b("div"),$e=b("button"),ks=ee("Set hotkeys"),ws=j(),yt=b("div"),kt=b("label"),kt.textContent=Hs,Es=j(),dt=b("input"),Cs=j(),Be&&Be.c(),this.h()},l(ke){e=y(ke,"DIV",{class:!0});var Ge=C(e);t=y(Ge,"FIELDSET",{class:!0});var rt=C(t);n=y(rt,"LEGEND",{class:!0});var $t=C(n);l=y($t,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1jbbsti"&&(l.textContent=o),$t.forEach(_),r=B(rt),a=y(rt,"DIV",{class:!0});var Ut=C(a);c=y(Ut,"BUTTON",{class:!0});var Kt=C(c);fe(i.$$.fragment,Kt),Kt.forEach(_),Ut.forEach(_),d=B(rt),u=y(rt,"DIV",{class:!0});var ot=C(u);g=y(ot,"DIV",{class:!0});var Dt=C(g);m=y(Dt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(m)!=="svelte-crpa7y"&&(m.textContent=h),v=B(Dt),N=y(Dt,"INPUT",{class:!0,id:!0}),w=B(Dt),V=y(Dt,"DIV",{class:!0});var Xt=C(V);I=y(Xt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(I)!=="svelte-mj6mct"&&(I.textContent=G),S=B(Xt),O=y(Xt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(O)!=="svelte-1sl6oxh"&&(O.textContent=P),Xt.forEach(_),Dt.forEach(_),E=B(ot),D=y(ot,"DIV",{class:!0});var Zt=C(D);A=y(Zt,"DIV",{class:!0});var es=C(A);L=y(es,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(L)!=="svelte-wgxtkw"&&(L.textContent=T),M=B(es),fe($.$$.fragment,es),es.forEach(_),K=B(Zt),Q=y(Zt,"DIV",{class:!0});var ts=C(Q);F=y(ts,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(F)!=="svelte-1tm2bth"&&(F.textContent=X),Z=B(ts),U=y(ts,"INPUT",{class:!0,id:!0,placeholder:!0}),ts.forEach(_),Zt.forEach(_),J=B(ot),H=y(ot,"DIV",{class:!0});var Lt=C(H);me=y(Lt,"DIV",{class:!0});var ss=C(me);pe=y(ss,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(pe)!=="svelte-1js269u"&&(pe.textContent=Re),ie=B(ss),fe(ce.$$.fragment,ss),ss.forEach(_),le=B(Lt),oe=y(Lt,"DIV",{class:!0});var ns=C(oe);ge=y(ns,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(ge)!=="svelte-21h39k"&&(ge.textContent=we),tt=B(ns),fe(q.$$.fragment,ns),ns.forEach(_),re=B(Lt),Ee=y(Lt,"DIV",{class:!0});var ls=C(Ee);xe=y(ls,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(xe)!=="svelte-33lczu"&&(xe.textContent=ne),We=B(ls),fe(je.$$.fragment,ls),ls.forEach(_),Lt.forEach(_),ut=B(ot),et=y(ot,"DIV",{class:!0});var Ot=C(et);Qe=y(Ot,"DIV",{class:!0,"data-svelte-h":!0}),ae(Qe)!=="svelte-dgefms"&&(Qe.textContent=Je),St=B(Ot),ft=y(Ot,"DIV",{class:!0});var qs=C(ft);$e=y(qs,"BUTTON",{class:!0});var Ws=C($e);ks=te(Ws,"Set hotkeys"),Ws.forEach(_),qs.forEach(_),ws=B(Ot),yt=y(Ot,"DIV",{class:!0});var rs=C(yt);kt=y(rs,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(kt)!=="svelte-vd5i27"&&(kt.textContent=Hs),Es=B(rs),dt=y(rs,"INPUT",{class:!0,id:!0}),rs.forEach(_),Ot.forEach(_),ot.forEach(_),Cs=B(rt),Be&&Be.l(rt),rt.forEach(_),Ge.forEach(_),this.h()},h(){var ke;p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(c,"class","rounded px-1 py-1 hover:bg-gray-200"),p(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center"),W(a,"hidden",s[4]),p(m,"class","font-bold"),p(m,"for","device"),p(N,"class","px-1 my-1 rounded w-50"),p(N,"id","device"),N.disabled=!0,N.value=k=((ke=s[5])==null?void 0:ke.name)??"No device",p(I,"class","btn-sm primary mr-2"),p(O,"class","btn-sm primary"),p(V,"class","flex my-[auto]"),p(g,"class","h-full flex flex-col"),p(L,"class","font-bold"),p(L,"for","sound"),p(A,"class","my-1 flex justify-between items-center mr-12"),p(F,"class","font-bold"),p(F,"for","fixed-velocity"),p(U,"class","h-[20px] w-16"),p(U,"id","fixed-velocity"),p(U,"placeholder","0-127"),p(Q,"class","flex justify-between"),p(D,"class","flex flex-col h-full"),p(pe,"class","font-bold"),p(pe,"for","keyboard"),p(me,"class","my-1 flex justify-between items-center mr-12"),p(ge,"class","font-bold"),p(ge,"for","hotkeys"),p(oe,"class","my-1 flex justify-between items-center mr-12"),p(xe,"class","font-bold"),p(xe,"for","auto-octave"),p(Ee,"class","my-1 flex justify-between items-center mr-12"),p(H,"class","flex flex-col h-full"),p(Qe,"class","h-[28px]"),p($e,"class","w-full btn-sm primary"),$e.disabled=Yt=!s[3].useHotkeys,p(ft,"class","my-[2px] flex justify-between"),p(kt,"class","font-bold"),p(kt,"for","fade-timeout"),p(dt,"class","h-[20px] w-16"),p(dt,"id","fade-timeout"),dt.value=s[1],p(yt,"class","my-1 flex justify-between"),p(et,"class","flex flex-col h-full"),p(u,"class","body svelte-1bpw69s"),W(u,"hidden",s[4]),p(t,"class","relative flex flex-col max-w-full rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),W(t,"collapsed",s[4]),p(e,"class",Qt=Ae(`${s[12].class||""}`)+" svelte-1bpw69s")},m(ke,Ge){R(ke,e,Ge),f(e,t),f(t,n),f(n,l),f(t,r),f(t,a),f(a,c),de(i,c,null),f(t,d),f(t,u),f(u,g),f(g,m),f(g,v),f(g,N),f(g,w),f(g,V),f(V,I),f(V,S),f(V,O),f(u,E),f(u,D),f(D,A),f(A,L),f(A,M),de($,A,null),f(D,K),f(D,Q),f(Q,F),f(Q,Z),f(Q,U),Ze(U,s[0]),f(u,J),f(u,H),f(H,me),f(me,pe),f(me,ie),de(ce,me,null),f(H,le),f(H,oe),f(oe,ge),f(oe,tt),de(q,oe,null),f(H,re),f(H,Ee),f(Ee,xe),f(Ee,We),de(je,Ee,null),f(u,ut),f(u,et),f(et,Qe),f(et,St),f(et,ft),f(ft,$e),f($e,ks),f(et,ws),f(et,yt),f(yt,kt),f(yt,Es),f(yt,dt),f(t,Cs),Be&&Be.m(t,null),lt=!0,Is||(zs=[Y(l,"click",s[7]),Y(c,"click",s[11]),Y(I,"click",Pe.openMidi),Y(O,"click",Pe.disableMidi),Y(U,"input",s[14]),Y(U,"change",s[8]),Y($e,"click",s[17]),Y(dt,"input",s[10])],Is=!0)},p(ke,[Ge]){var ot;(!lt||Ge&16)&&W(a,"hidden",ke[4]),(!lt||Ge&32&&k!==(k=((ot=ke[5])==null?void 0:ot.name)??"No device")&&N.value!==k)&&(N.value=k);const rt={};Ge&8&&(rt.checked=ke[3].useSound),$.$set(rt),Ge&1&&U.value!==ke[0]&&Ze(U,ke[0]);const $t={};Ge&8&&($t.checked=ke[3].useKeyboard),ce.$set($t);const Ut={};Ge&8&&(Ut.checked=ke[3].useHotkeys),q.$set(Ut);const Kt={};Ge&8&&(Kt.checked=ke[3].useAutoOctave),je.$set(Kt),(!lt||Ge&8&&Yt!==(Yt=!ke[3].useHotkeys))&&($e.disabled=Yt),(!lt||Ge&2&&dt.value!==ke[1])&&(dt.value=ke[1]),(!lt||Ge&16)&&W(u,"hidden",ke[4]),ke[2]&&!ke[4]?Be?Ge&20&&x(Be,1):(Be=Fn(),Be.c(),x(Be,1),Be.m(t,null)):Be&&(Ue(),z(Be,1,1,()=>{Be=null}),Ke()),(!lt||Ge&16)&&W(t,"collapsed",ke[4]),(!lt||Ge&4096&&Qt!==(Qt=Ae(`${ke[12].class||""}`)+" svelte-1bpw69s"))&&p(e,"class",Qt)},i(ke){lt||(x(i.$$.fragment,ke),x($.$$.fragment,ke),x(ce.$$.fragment,ke),x(q.$$.fragment,ke),x(je.$$.fragment,ke),x(Be),lt=!0)},o(ke){z(i.$$.fragment,ke),z($.$$.fragment,ke),z(ce.$$.fragment,ke),z(q.$$.fragment,ke),z(je.$$.fragment,ke),z(Be),lt=!1},d(ke){ke&&_(e),he(i),he($),he(ce),he(q),he(je),Be&&Be.d(),Is=!1,qe(zs)}}}function yo(s,e,t){let n,l,o;be(s,nt,I=>t(3,n=I)),be(s,gs,I=>t(5,o=I));const r=bt(Ve(!1),{key:"inputs-hidden"});be(s,r,I=>t(4,l=I));let a=n.fixedVelocity??"",c=n.keyFadeTimeout,i=!1;nt.subscribe(I=>{t(0,a=I.fixedVelocity??""),t(1,c=I.keyFadeTimeout)});function d(){r.update(I=>!I)}function u(I){const{value:G}=I.currentTarget;let S;if(G)try{S=parseInt(G)}catch{}S!==void 0&&S>=0&&S<=127?Pe.setInputValue("fixedVelocity",S):G?t(0,a=n.fixedVelocity||""):Pe.setInputValue("fixedVelocity",void 0)}function g(I){Pe.setInputValue("useHotkeys",I.currentTarget.checked),I.currentTarget.checked||(t(2,i=!1),ct.cancelCapture())}function m(I){try{const G=parseInt(I.currentTarget.value);Pe.setInputValue("keyFadeTimeout",G)}catch{t(1,c=n.keyFadeTimeout)}}function h(){Pe.setInputValue("useSound",!0),Pe.setInputValue("fixedVelocity",void 0),Pe.setInputValue("useKeyboard",!0),Pe.setInputValue("useHotkeys",!0),Pe.setInputValue("useAutoOctave",!0),Pe.setInputValue("keyFadeTimeout",1500)}const v=I=>Pe.setInputValue("useSound",I.currentTarget.checked);function N(){a=this.value,t(0,a)}const k=I=>Pe.setInputValue("useKeyboard",I.currentTarget.checked),w=I=>Pe.setInputValue("useAutoOctave",I.currentTarget.checked),V=()=>t(2,i=!i);return s.$$set=I=>{t(12,e=Ie(Ie({},e),Ne(I)))},e=Ne(e),[a,c,i,n,l,o,r,d,u,g,m,h,e,v,N,k,w,V]}class ko extends Fe{constructor(e){super(),He(this,e,yo,bo,ze,{})}}function wo(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){R(t,e,n)},p:ve,d(t){t&&_(e)}}}function Eo(s){let e,t=s[1].note+"",n;return{c(){e=ee("Input: "),n=ee(t)},l(l){e=te(l,"Input: "),n=te(l,t)},m(l,o){R(l,e,o),R(l,n,o)},p(l,o){o&2&&t!==(t=l[1].note+"")&&ye(n,t)},d(l){l&&(_(e),_(n))}}}function Co(s){let e,t;return{c(){e=ee("Input: "),t=ee(s[0])},l(n){e=te(n,"Input: "),t=te(n,s[0])},m(n,l){R(n,e,l),R(n,t,l)},p(n,l){l&1&&ye(t,n[0])},d(n){n&&(_(e),_(t))}}}function Io(s){let e;return{c(){e=ee(Ps)},l(t){e=te(t,Ps)},m(t,n){R(t,e,n)},p:ve,d(t){t&&_(e)}}}function To(s){let e,t,n,l;function o(c,i){return c[2].useKeyboard&&Ps?Io:c[2].useKeyboard&&c[0]?Co:c[2].useKeyboard&&c[1]?Eo:wo}let r=o(s),a=r(s);return{c(){e=b("div"),a.c(),this.h()},l(c){e=y(c,"DIV",{class:!0});var i=C(e);a.l(i),i.forEach(_),this.h()},h(){p(e,"class",t=`${s[4].class||""}`)},m(c,i){R(c,e,i),a.m(e,null),n||(l=Y(window,"keydown",s[3]),n=!0)},p(c,[i]){r===(r=o(c))&&a?a.p(c,i):(a.d(1),a=r(c),a&&(a.c(),a.m(e,null))),i&16&&t!==(t=`${c[4].class||""}`)&&p(e,"class",t)},i:ve,o:ve,d(c){c&&_(e),a.d(),n=!1,l()}}}let Ps="";function Ao(s,e,t){let n;be(s,nt,i=>t(2,n=i));let{debounced:l}=e,o="",r;const a=jl();function c(i){const d=i.target;if(l||!(d instanceof HTMLElement)||d.tagName==="INPUT")return;const u=ct.handleInput(i.code,i.key,i.shiftKey);u&&u.e==="note"?t(1,r=u.data):u&&u.e==="string"?t(0,o=u.data):u&&(u.e==="guessed-key"||u.e==="guessed-chord"||u.e==="guessed-note")?(t(0,o=""),t(1,r=void 0),a(u.e,u.data),i.code==="Enter"&&i.preventDefault()):u&&i.preventDefault()}return s.$$set=i=>{t(4,e=Ie(Ie({},e),Ne(i))),"debounced"in i&&t(5,l=i.debounced)},e=Ne(e),[o,r,n,c,e,l]}class No extends Fe{constructor(e){super(),He(this,e,Ao,To,ze,{debounced:5})}}function So(s){let e,t,n,l="Count",o,r,a,c,i,d="Duplicates",u,g,m,h,v,N="Autoplay",k,w,V,I,G,S="Wait seconds",O,P,E,D,A,L;return g=new Nt({props:{id:"duplicates",checked:s[2].duplicates}}),g.$on("input",s[7]),w=new Nt({props:{id:"autoplay",checked:s[2].autoplay}}),w.$on("input",s[8]),{c(){e=b("ul"),t=b("li"),n=b("label"),n.textContent=l,o=j(),r=b("input"),a=j(),c=b("li"),i=b("label"),i.textContent=d,u=j(),ue(g.$$.fragment),m=j(),h=b("li"),v=b("label"),v.textContent=N,k=j(),ue(w.$$.fragment),V=j(),I=b("li"),G=b("label"),G.textContent=S,O=j(),P=b("input"),this.h()},l(T){e=y(T,"UL",{class:!0});var M=C(e);t=y(M,"LI",{class:!0});var $=C(t);n=y($,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(n)!=="svelte-wgq9fc"&&(n.textContent=l),o=B($),r=y($,"INPUT",{class:!0,id:!0,type:!0}),$.forEach(_),a=B(M),c=y(M,"LI",{class:!0});var K=C(c);i=y(K,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(i)!=="svelte-hcg9dq"&&(i.textContent=d),u=B(K),fe(g.$$.fragment,K),K.forEach(_),m=B(M),h=y(M,"LI",{class:!0});var Q=C(h);v=y(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(v)!=="svelte-lr68n2"&&(v.textContent=N),k=B(Q),fe(w.$$.fragment,Q),Q.forEach(_),V=B(M),I=y(M,"LI",{class:!0});var F=C(I);G=y(F,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(G)!=="svelte-1qj2vcy"&&(G.textContent=S),O=B(F),P=y(F,"INPUT",{class:!0,id:!0,type:!0}),F.forEach(_),M.forEach(_),this.h()},h(){p(n,"class","font-bold"),p(n,"for","guess-count"),p(r,"class","h-[20px] w-10"),p(r,"id","guess-count"),p(r,"type","number"),p(t,"class","flex items-center justify-between svelte-1elvih2"),p(i,"class","font-bold"),p(i,"for","duplicates"),p(c,"class","flex items-center justify-between items-center mr-6 svelte-1elvih2"),p(v,"class","font-bold"),p(v,"for","autoplay"),p(h,"class","flex items-center justify-between items-center mr-6 svelte-1elvih2"),p(G,"class","font-bold"),p(G,"for","wait-ms"),p(P,"class","h-[20px] w-10"),p(P,"id","wait-ms"),p(P,"type","number"),p(I,"class","flex items-center justify-between svelte-1elvih2"),p(e,"class",E=Ae(`${s[5].class||""}`)+" svelte-1elvih2")},m(T,M){R(T,e,M),f(e,t),f(t,n),f(t,o),f(t,r),Ze(r,s[0]),f(e,a),f(e,c),f(c,i),f(c,u),de(g,c,null),f(e,m),f(e,h),f(h,v),f(h,k),de(w,h,null),f(e,V),f(e,I),f(I,G),f(I,O),f(I,P),Ze(P,s[1]),D=!0,A||(L=[Y(r,"input",s[6]),Y(r,"input",s[3]),Y(P,"input",s[9]),Y(P,"input",s[4])],A=!0)},p(T,[M]){M&1&&hs(r.value)!==T[0]&&Ze(r,T[0]);const $={};M&4&&($.checked=T[2].duplicates),g.$set($);const K={};M&4&&(K.checked=T[2].autoplay),w.$set(K),M&2&&hs(P.value)!==T[1]&&Ze(P,T[1]),(!D||M&32&&E!==(E=Ae(`${T[5].class||""}`)+" svelte-1elvih2"))&&p(e,"class",E)},i(T){D||(x(g.$$.fragment,T),x(w.$$.fragment,T),D=!0)},o(T){z(g.$$.fragment,T),z(w.$$.fragment,T),D=!1},d(T){T&&_(e),he(g),he(w),A=!1,qe(L)}}}function Do(s,e,t){let n;be(s,gt,g=>t(2,n=g));let l=n.count||"",o=n.waitSeconds||"";gt.subscribe(g=>{t(0,l=g.count||""),t(1,o=g.waitSeconds||"")});function r({currentTarget:{value:g}}){let m;try{m=parseInt(g),m<=0&&(m=1),De.setOptionValue("count",m)}catch{t(0,l=n.count)}}function a({currentTarget:{value:g}}){let m;try{m=parseInt(g),m<0&&(m=0),De.setOptionValue("waitSeconds",m)}catch{t(1,o=n.waitSeconds)}}function c(){l=hs(this.value),t(0,l)}const i=g=>De.setOptionValue("duplicates",g.currentTarget.checked),d=g=>De.setOptionValue("autoplay",g.currentTarget.checked);function u(){o=hs(this.value),t(1,o)}return s.$$set=g=>{t(5,e=Ie(Ie({},e),Ne(g)))},e=Ne(e),[l,o,n,r,a,e,c,i,d,u]}class Lo extends Fe{constructor(e){super(),He(this,e,Do,So,ze,{})}}function Hn(s,e,t){const n=s.slice();return n[22]=e[t].key,n[23]=e[t].value,n}function zn(s,e,t){const n=s.slice();return n[22]=e[t].key,n[23]=e[t].value,n}function qn(s){let e,t,n=s[23]+"",l,o,r,a,c,i,d,u;function g(){return s[15](s[22])}a=new Me({props:{icon:Ss,width:20}});function m(...h){return s[16](s[22],...h)}return{c(){e=b("li"),t=b("button"),l=ee(n),o=j(),r=b("button"),ue(a.$$.fragment),c=j(),this.h()},l(h){e=y(h,"LI",{class:!0});var v=C(e);t=y(v,"BUTTON",{class:!0});var N=C(t);l=te(N,n),N.forEach(_),o=B(v),r=y(v,"BUTTON",{class:!0});var k=C(r);fe(a.$$.fragment,k),k.forEach(_),c=B(v),v.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),W(t,"selected",s[22]===s[0]),p(r,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),p(e,"class","flex svelte-1okhpct")},m(h,v){R(h,e,v),f(e,t),f(t,l),f(e,o),f(e,r),de(a,r,null),f(e,c),i=!0,d||(u=[Y(t,"click",g),Y(r,"click",m)],d=!0)},p(h,v){s=h,(!i||v&17)&&W(t,"selected",s[22]===s[0])},i(h){i||(x(a.$$.fragment,h),i=!0)},o(h){z(a.$$.fragment,h),i=!1},d(h){h&&_(e),he(a),d=!1,qe(u)}}}function Wn(s){let e,t=_e(s[3]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Jn(Hn(s,t,l));return{c(){e=b("ul");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=y(l,"UL",{class:!0});var o=C(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(_),this.h()},h(){p(e,"class","svelte-1okhpct")},m(l,o){R(l,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(l,o){if(o&138){t=_e(l[3]);let r;for(r=0;r<t.length;r+=1){const a=Hn(l,t,r);n[r]?n[r].p(a,o):(n[r]=Jn(a),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Jn(s){let e,t,n=s[23]+"",l,o,r,a;function c(){return s[17](s[22])}return{c(){e=b("li"),t=b("button"),l=ee(n),o=j(),this.h()},l(i){e=y(i,"LI",{class:!0});var d=C(e);t=y(d,"BUTTON",{class:!0});var u=C(t);l=te(u,n),u.forEach(_),o=B(d),d.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),W(t,"selected",s[22]===s[1]),p(e,"class","svelte-1okhpct")},m(i,d){R(i,e,d),f(e,t),f(t,l),f(e,o),r||(a=Y(t,"click",c),r=!0)},p(i,d){s=i,d&8&&n!==(n=s[23]+"")&&ye(l,n),d&10&&W(t,"selected",s[22]===s[1])},d(i){i&&_(e),r=!1,a()}}}function Oo(s){let e,t,n="Play",l,o,r,a,c,i,d,u,g,m,h="Reset",v,N,k,w,V=s[2]?"Quit":"Play",I,G,S,O,P,E=_e(s[4]),D=[];for(let T=0;T<E.length;T+=1)D[T]=qn(zn(s,E,T));const A=T=>z(D[T],1,1,()=>{D[T]=null});let L=(s[0]==="chords-write"||s[0]==="chords-play")&&Wn(s);return d=new Lo({props:{class:"game-options"}}),k=new Me({props:{class:"mr-1",icon:s[2]?Qs:Ss,width:20}}),{c(){e=b("fieldset"),t=b("legend"),t.textContent=n,l=j(),o=b("div"),r=b("ul");for(let T=0;T<D.length;T+=1)D[T].c();a=j(),c=b("div"),L&&L.c(),i=j(),ue(d.$$.fragment),u=j(),g=b("div"),m=b("button"),m.textContent=h,v=j(),N=b("button"),ue(k.$$.fragment),w=j(),I=ee(V),this.h()},l(T){e=y(T,"FIELDSET",{class:!0});var M=C(e);t=y(M,"LEGEND",{class:!0,"data-svelte-h":!0}),ae(t)!=="svelte-1409tnk"&&(t.textContent=n),l=B(M),o=y(M,"DIV",{class:!0});var $=C(o);r=y($,"UL",{class:!0});var K=C(r);for(let Z=0;Z<D.length;Z+=1)D[Z].l(K);K.forEach(_),a=B($),c=y($,"DIV",{class:!0});var Q=C(c);L&&L.l(Q),Q.forEach(_),i=B($),fe(d.$$.fragment,$),u=B($),g=y($,"DIV",{class:!0});var F=C(g);m=y(F,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(m)!=="svelte-10rv0bu"&&(m.textContent=h),v=B(F),N=y(F,"BUTTON",{class:!0});var X=C(N);fe(k.$$.fragment,X),w=B(X),I=te(X,V),X.forEach(_),F.forEach(_),$.forEach(_),M.forEach(_),this.h()},h(){p(t,"class","px-1 text-base"),p(r,"class","games svelte-1okhpct"),p(c,"class","options svelte-1okhpct"),p(m,"class","w-full btn hover:bg-gray-200"),p(N,"class","w-full mt-2 flex items-center justify-center btn primary"),p(g,"class","h-full flex flex-col justify-end"),p(o,"class","body pb-2 h-full svelte-1okhpct"),p(e,"class",G=Ae(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(T,M){R(T,e,M),f(e,t),f(e,l),f(e,o),f(o,r);for(let $=0;$<D.length;$+=1)D[$]&&D[$].m(r,null);f(o,a),f(o,c),L&&L.m(c,null),f(o,i),de(d,o,null),f(o,u),f(o,g),f(g,m),f(g,v),f(g,N),de(k,N,null),f(N,w),f(N,I),S=!0,O||(P=[Y(m,"click",s[8]),Y(N,"click",s[9])],O=!0)},p(T,[M]){if(M&113){E=_e(T[4]);let K;for(K=0;K<E.length;K+=1){const Q=zn(T,E,K);D[K]?(D[K].p(Q,M),x(D[K],1)):(D[K]=qn(Q),D[K].c(),x(D[K],1),D[K].m(r,null))}for(Ue(),K=E.length;K<D.length;K+=1)A(K);Ke()}T[0]==="chords-write"||T[0]==="chords-play"?L?L.p(T,M):(L=Wn(T),L.c(),L.m(c,null)):L&&(L.d(1),L=null);const $={};M&4&&($.icon=T[2]?Qs:Ss),k.$set($),(!S||M&4)&&V!==(V=T[2]?"Quit":"Play")&&ye(I,V),(!S||M&1024&&G!==(G=Ae(`${T[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&p(e,"class",G)},i(T){if(!S){for(let M=0;M<E.length;M+=1)x(D[M]);x(d.$$.fragment,T),x(k.$$.fragment,T),S=!0}},o(T){D=D.filter(Boolean);for(let M=0;M<D.length;M+=1)z(D[M]);z(d.$$.fragment,T),z(k.$$.fragment,T),S=!1},d(T){T&&_(e),Oe(D,T),L&&L.d(),he(d),he(k),O=!1,qe(P)}}}function Vo(s,e,t){let n,l,o,r,a,c,i;be(s,Us,S=>t(12,r=S)),be(s,gt,S=>t(20,a=S)),be(s,_t,S=>t(13,c=S)),be(s,It,S=>t(14,i=S));const d=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let u=d[4].key,g="maj-m";a.count,a.waitSeconds,gt.subscribe(S=>{S.count,S.waitSeconds});function m(S,O){if(O==="chords-write"||O==="chords-play"||O==="chords-diatonic"){let P=[];g==="selected"?P=r.filter(E=>E.selected):g==="all"?P=r:g==="maj-m"?P=r.filter(E=>E.suffixes[0]==="maj"||E.suffixes[0]==="m"):g==="seventh"&&(P=r.filter(E=>E.suffixes[0]==="maj7"||E.suffixes[0]==="m7"||E.suffixes[0]==="7"||E.suffixes[0]==="dim7"||E.suffixes[0]==="aug7")),De.play(O,{chords:P})}else De.play(O,void 0);S.currentTarget instanceof HTMLElement&&S.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function h(S){t(0,u=S)}function v(S,O){t(0,u=O),m(S,O)}function N(S){t(1,g=S)}function k(){De.clearGame(!0)}function w(S){n?De.clearGame():m(S,u)}const V=S=>h(S),I=(S,O)=>v(O,S),G=S=>N(S);return s.$$set=S=>{t(10,e=Ie(Ie({},e),Ne(S)))},s.$$.update=()=>{s.$$.dirty&24576&&t(2,n=!!i&&c!=="ended"),s.$$.dirty&4096&&t(11,l=r.reduce((S,O)=>O.selected?S+1:S,0)),s.$$.dirty&2048&&t(3,o=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${l} chords`},{key:"all",value:"All"}])},e=Ne(e),[u,g,n,o,d,h,v,N,k,w,e,l,r,c,i,V,I,G]}class Po extends Fe{constructor(e){super(),He(this,e,Vo,Oo,ze,{})}}function Yn(s,e,t){const n=s.slice();return n[7]=e[t],n}function Qn(s,e,t){const n=s.slice();return n[4]=e[t],n}function jo(s){let e,t=_e(s[1]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Xn(Yn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o&2){t=_e(l[1]);let r;for(r=0;r<t.length;r+=1){const a=Yn(l,t,r);n[r]?n[r].p(a,o):(n[r]=Xn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Bo(s){let e,t=_e(s[0].scaleNotes||[]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Zn(Qn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o&1){t=_e(l[0].scaleNotes||[]);let r;for(r=0;r<t.length;r+=1){const a=Qn(l,t,r);n[r]?n[r].p(a,o):(n[r]=Zn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Xn(s){let e,t=s[7].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-my4m0t")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o&2&&t!==(t=l[7].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function Zn(s){let e,t=s[4].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-my4m0t")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o&1&&t!==(t=l[4].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function Go(s){let e,t,n,l,o,r;function a(d,u){return d[0]?Bo:jo}let c=a(s),i=c(s);return{c(){e=b("div"),t=b("button"),i.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,title:!0});var u=C(e);t=y(u,"BUTTON",{class:!0});var g=C(t);i.l(g),g.forEach(_),u.forEach(_),this.h()},h(){p(t,"class","intervals svelte-my4m0t"),p(e,"class",n=`${s[2].class||""} `),p(e,"title",l=s[1].map(el).join("-"))},m(d,u){R(d,e,u),f(e,t),i.m(t,null),o||(r=Y(t,"click",s[3]),o=!0)},p(d,[u]){c===(c=a(d))&&i?i.p(d,u):(i.d(1),i=c(d),i&&(i.c(),i.m(t,null))),u&4&&n!==(n=`${d[2].class||""} `)&&p(e,"class",n),u&2&&l!==(l=d[1].map(el).join("-"))&&p(e,"title",l)},i:ve,o:ve,d(d){d&&_(e),i.d(),o=!1,r()}}}const el=s=>s.interval;function Mo(s,e,t){let{scale:n,intervals:l}=e;function o(r){Bt.call(this,s,r)}return s.$$set=r=>{t(2,e=Ie(Ie({},e),Ne(r))),"scale"in r&&t(0,n=r.scale),"intervals"in r&&t(1,l=r.intervals)},e=Ne(e),[n,l,e,o]}class Vl extends Fe{constructor(e){super(),He(this,e,Mo,Go,ze,{scale:0,intervals:1})}}function tl(s,e,t){const n=s.slice();return n[7]=e[t],n}function sl(s,e,t){const n=s.slice();return n[4]=e[t],n}function Ro(s){let e,t=_e(s[0]),n=[];for(let l=0;l<t.length;l+=1)n[l]=nl(tl(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o&1){t=_e(l[0]);let r;for(r=0;r<t.length;r+=1){const a=tl(l,t,r);n[r]?n[r].p(a,o):(n[r]=nl(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function xo(s){let e,t=_e(s[1]),n=[];for(let l=0;l<t.length;l+=1)n[l]=ll(sl(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o&2){t=_e(l[1]);let r;for(r=0;r<t.length;r+=1){const a=sl(l,t,r);n[r]?n[r].p(a,o):(n[r]=ll(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function nl(s){let e,t,n=s[7].roman+"",l,o,r,a=s[7].suffix+"",c,i;return{c(){e=b("span"),t=b("span"),l=ee(n),o=j(),r=b("sup"),c=ee(a),i=j(),this.h()},l(d){e=y(d,"SPAN",{class:!0});var u=C(e);t=y(u,"SPAN",{class:!0});var g=C(t);l=te(g,n),g.forEach(_),o=B(u),r=y(u,"SUP",{class:!0});var m=C(r);c=te(m,a),m.forEach(_),i=B(u),u.forEach(_),this.h()},h(){p(t,"class","block"),p(r,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),W(r,"super-text",s[7].suffix.length>2),p(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(d,u){R(d,e,u),f(e,t),f(t,l),f(e,o),f(e,r),f(r,c),f(e,i)},p(d,u){u&1&&n!==(n=d[7].roman+"")&&ye(l,n),u&1&&a!==(a=d[7].suffix+"")&&ye(c,a),u&1&&W(r,"super-text",d[7].suffix.length>2)},d(d){d&&_(e)}}}function ll(s){let e,t,n=s[4]+"",l,o;return{c(){e=b("span"),t=b("span"),l=ee(n),o=j(),this.h()},l(r){e=y(r,"SPAN",{class:!0});var a=C(e);t=y(a,"SPAN",{});var c=C(t);l=te(c,n),c.forEach(_),o=B(a),a.forEach(_),this.h()},h(){p(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(r,a){R(r,e,a),f(e,t),f(t,l),f(e,o)},p(r,a){a&2&&n!==(n=r[4]+"")&&ye(l,n)},d(r){r&&_(e)}}}function $o(s){let e,t,n,l,o,r;function a(d,u){return d[1].length>0?xo:Ro}let c=a(s),i=c(s);return{c(){e=b("div"),t=b("button"),i.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,title:!0});var u=C(e);t=y(u,"BUTTON",{class:!0});var g=C(t);i.l(g),g.forEach(_),u.forEach(_),this.h()},h(){p(t,"class","triads flex flex-wrap svelte-1roj1mi"),p(e,"class",n=Ae(`${s[2].class||""} `)+" svelte-1roj1mi"),p(e,"title",l=s[0].map(rl).join("-"))},m(d,u){R(d,e,u),f(e,t),i.m(t,null),o||(r=Y(t,"click",s[3]),o=!0)},p(d,[u]){c===(c=a(d))&&i?i.p(d,u):(i.d(1),i=c(d),i&&(i.c(),i.m(t,null))),u&4&&n!==(n=Ae(`${d[2].class||""} `)+" svelte-1roj1mi")&&p(e,"class",n),u&1&&l!==(l=d[0].map(rl).join("-"))&&p(e,"title",l)},i:ve,o:ve,d(d){d&&_(e),i.d(),o=!1,r()}}}const rl=s=>s.roman+s.suffix;function Uo(s,e,t){let{triads:n,chords:l}=e;function o(r){Bt.call(this,s,r)}return s.$$set=r=>{t(2,e=Ie(Ie({},e),Ne(r))),"triads"in r&&t(0,n=r.triads),"chords"in r&&t(1,l=r.chords)},e=Ne(e),[n,l,e,o]}class Pl extends Fe{constructor(e){super(),He(this,e,Uo,$o,ze,{triads:0,chords:1})}}function ol(s,e,t){const n=s.slice();return n[23]=e[t],n}function al(s,e,t){const n=s.slice();return n[23]=e[t],n}function il(s){let e,t,n=s[23].raw.names[0]+"",l,o,r,a,c,i,d;function u(){return s[11](s[23])}r=new Vl({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),r.$on("click",u);function g(){return s[12](s[23])}return c=new Pl({props:{triads:s[23].triads,chords:s[23].triadChords}}),c.$on("click",g),{c(){e=b("li"),t=b("div"),l=ee(n),o=j(),ue(r.$$.fragment),a=j(),ue(c.$$.fragment),i=j(),this.h()},l(m){e=y(m,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);l=te(v,n),v.forEach(_),o=B(h),fe(r.$$.fragment,h),a=B(h),fe(c.$$.fragment,h),i=B(h),h.forEach(_),this.h()},h(){p(t,"class","text-xs font-bold"),p(e,"class","svelte-4hctsl")},m(m,h){R(m,e,h),f(e,t),f(t,l),f(e,o),de(r,e,null),f(e,a),de(c,e,null),f(e,i),d=!0},p(m,h){s=m,(!d||h&4)&&n!==(n=s[23].raw.names[0]+"")&&ye(l,n);const v={};h&4&&(v.scale=s[23].scale),h&4&&(v.intervals=s[23].raw.intervals),r.$set(v);const N={};h&4&&(N.triads=s[23].triads),h&4&&(N.chords=s[23].triadChords),c.$set(N)},i(m){d||(x(r.$$.fragment,m),x(c.$$.fragment,m),d=!0)},o(m){z(r.$$.fragment,m),z(c.$$.fragment,m),d=!1},d(m){m&&_(e),he(r),he(c)}}}function cl(s){let e,t,n=s[23].raw.names[0]+"",l,o,r,a,c,i,d;function u(){return s[13](s[23])}r=new Vl({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),r.$on("click",u);function g(){return s[14](s[23])}return c=new Pl({props:{triads:s[23].triads,chords:s[23].triadChords}}),c.$on("click",g),{c(){e=b("li"),t=b("div"),l=ee(n),o=j(),ue(r.$$.fragment),a=j(),ue(c.$$.fragment),i=j(),this.h()},l(m){e=y(m,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);l=te(v,n),v.forEach(_),o=B(h),fe(r.$$.fragment,h),a=B(h),fe(c.$$.fragment,h),i=B(h),h.forEach(_),this.h()},h(){p(t,"class","text-xs font-bold"),p(e,"class","svelte-4hctsl")},m(m,h){R(m,e,h),f(e,t),f(t,l),f(e,o),de(r,e,null),f(e,a),de(c,e,null),f(e,i),d=!0},p(m,h){s=m,(!d||h&2)&&n!==(n=s[23].raw.names[0]+"")&&ye(l,n);const v={};h&2&&(v.scale=s[23].scale),h&2&&(v.intervals=s[23].raw.intervals),r.$set(v);const N={};h&2&&(N.triads=s[23].triads),h&2&&(N.chords=s[23].triadChords),c.$set(N)},i(m){d||(x(r.$$.fragment,m),x(c.$$.fragment,m),d=!0)},o(m){z(r.$$.fragment,m),z(c.$$.fragment,m),d=!1},d(m){m&&_(e),he(r),he(c)}}}function Ko(s){let e,t,n,l,o="Scales",r,a,c,i="Key",d,u,g,m,h,v,N,k,w,V,I,G=_e(s[2]),S=[];for(let A=0;A<G.length;A+=1)S[A]=il(al(s,G,A));const O=A=>z(S[A],1,1,()=>{S[A]=null});let P=_e(s[1]),E=[];for(let A=0;A<P.length;A+=1)E[A]=cl(ol(s,P,A));const D=A=>z(E[A],1,1,()=>{E[A]=null});return{c(){e=b("div"),t=b("fieldset"),n=b("legend"),l=b("button"),l.textContent=o,r=j(),a=b("div"),c=b("label"),c.textContent=i,d=j(),u=b("input"),g=j(),m=b("div"),h=b("ul");for(let A=0;A<S.length;A+=1)S[A].c();v=j(),N=b("ul");for(let A=0;A<E.length;A+=1)E[A].c();this.h()},l(A){e=y(A,"DIV",{class:!0});var L=C(e);t=y(L,"FIELDSET",{class:!0});var T=C(t);n=y(T,"LEGEND",{class:!0});var M=C(n);l=y(M,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-lhx60e"&&(l.textContent=o),M.forEach(_),r=B(T),a=y(T,"DIV",{class:!0});var $=C(a);c=y($,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(c)!=="svelte-14m38zf"&&(c.textContent=i),d=B($),u=y($,"INPUT",{class:!0,id:!0}),$.forEach(_),g=B(T),m=y(T,"DIV",{class:!0});var K=C(m);h=y(K,"UL",{class:!0});var Q=C(h);for(let X=0;X<S.length;X+=1)S[X].l(Q);Q.forEach(_),v=B(K),N=y(K,"UL",{class:!0});var F=C(N);for(let X=0;X<E.length;X+=1)E[X].l(F);F.forEach(_),K.forEach(_),T.forEach(_),L.forEach(_),this.h()},h(){p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(c,"class","mr-4 font-bold"),p(c,"for","scale-key"),p(u,"class","bg-gray-100 w-16 px-1 rounded"),p(u,"id","scale-key"),u.value=s[0],p(a,"class","flex mb-2 input svelte-4hctsl"),W(a,"hidden",s[3]),p(h,"class","list odd w-full svelte-4hctsl"),p(N,"class","list even w-full svelte-4hctsl"),p(m,"class","body max-h-[30rem] overflow-scroll svelte-4hctsl"),W(m,"hidden",s[3]),p(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),W(t,"collapsed",s[3]),p(e,"class",k=Ae(`${s[9].class||""}`)+" svelte-4hctsl")},m(A,L){R(A,e,L),f(e,t),f(t,n),f(n,l),f(t,r),f(t,a),f(a,c),f(a,d),f(a,u),f(t,g),f(t,m),f(m,h);for(let T=0;T<S.length;T+=1)S[T]&&S[T].m(h,null);f(m,v),f(m,N);for(let T=0;T<E.length;T+=1)E[T]&&E[T].m(N,null);w=!0,V||(I=[Y(l,"click",s[5]),Y(u,"input",s[6])],V=!0)},p(A,[L]){if((!w||L&1&&u.value!==A[0])&&(u.value=A[0]),(!w||L&8)&&W(a,"hidden",A[3]),L&388){G=_e(A[2]);let T;for(T=0;T<G.length;T+=1){const M=al(A,G,T);S[T]?(S[T].p(M,L),x(S[T],1)):(S[T]=il(M),S[T].c(),x(S[T],1),S[T].m(h,null))}for(Ue(),T=G.length;T<S.length;T+=1)O(T);Ke()}if(L&386){P=_e(A[1]);let T;for(T=0;T<P.length;T+=1){const M=ol(A,P,T);E[T]?(E[T].p(M,L),x(E[T],1)):(E[T]=cl(M),E[T].c(),x(E[T],1),E[T].m(N,null))}for(Ue(),T=P.length;T<E.length;T+=1)D(T);Ke()}(!w||L&8)&&W(m,"hidden",A[3]),(!w||L&8)&&W(t,"collapsed",A[3]),(!w||L&512&&k!==(k=Ae(`${A[9].class||""}`)+" svelte-4hctsl"))&&p(e,"class",k)},i(A){if(!w){for(let L=0;L<G.length;L+=1)x(S[L]);for(let L=0;L<P.length;L+=1)x(E[L]);w=!0}},o(A){S=S.filter(Boolean);for(let L=0;L<S.length;L+=1)z(S[L]);E=E.filter(Boolean);for(let L=0;L<E.length;L+=1)z(E[L]);w=!1},d(A){A&&_(e),Oe(S,A),Oe(E,A),V=!1,qe(I)}}}function Fo(s,e,t){let n,l,o,r,a,c,i;be(s,Rt,E=>t(17,o=E)),be(s,vt,E=>t(18,r=E)),be(s,nt,E=>t(19,a=E)),be(s,st,E=>t(20,c=E));let u=bs().map(E=>({key:E.names[0],raw:E,scale:void 0,triads:E.triads,triadChords:[]})),g="",m=[r.key,r.scale],h;const v=bt(Ve(!0),{key:"scales-hidden"});be(s,v,E=>t(3,i=E));function N(){v.update(E=>!E)}function k({currentTarget:{value:E}}){t(0,g=`${E.charAt(0).toUpperCase()}${E.charAt(1).toLowerCase()}`),t(10,u=u.map(D=>{const A=zt(g,D.key),L=g&&"data"in A?A.data:void 0;let T=[];return L&&(T=D.triads.map((M,$)=>`${L.scaleNotes[$].note}${!M.suffix.includes("°")&&M.minor?"m":""}${M.suffix}`)),{...D,scale:L,triadChords:T}}))}function w(E,D,A){if(E<D.length){const L=D[E++];Se.setPlayed(L),c==null||c.playChord(L.map(T=>T.midi),a.fixedVelocity),h=setTimeout(()=>w(E,D,A),A)}else Se.setPlayed([]),Se.setKeyAndScale(m[0],m[1])}function V(E){clearTimeout(h);let D,A;E.scale?(A=E.scale,m=[r.key,r.scale],Se.setKeyAndScale(E.scale.key,E.scale.scale)):A=r;const L=o[0].midi+A.scaleNotes[0].semitones;D=E.raw.intervals.map(T=>[{...A.notesMap.get(T.semitones%12),midi:L+T.semitones}]),D[0][0].semitones!==D[D.length-1][0].semitones&&D.push(D[0].map(T=>({...T,midi:T.midi+12}))),w(0,D,500)}function I(E){clearTimeout(h);const{intervals:D}=E.raw;let A,L;E.scale?(L=E.scale,m=[r.key,r.scale],Se.setKeyAndScale(E.scale.key,E.scale.scale)):L=r;const T=o[0].midi+L.scaleNotes[0].semitones;A=wl(E.triads).map(($,K)=>cs(T+L.intervals[K].semitones,L,$.intervals)),D[D.length-1].interval_seq!==1&&A.push(A[0].map($=>({...$,midi:$.midi+12}))),w(0,A,750)}const G=E=>V(E),S=E=>I(E),O=E=>V(E),P=E=>I(E);return s.$$set=E=>{t(9,e=Ie(Ie({},e),Ne(E)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,n=u.filter((E,D)=>D<u.length/2)),s.$$.dirty&1024&&t(1,l=u.filter((E,D)=>D>=u.length/2))},e=Ne(e),[g,l,n,i,v,N,k,V,I,e,u,G,S,O,P]}class Ho extends Fe{constructor(e){super(),He(this,e,Fo,Ko,ze,{})}}function ul(s,e,t){const n=s.slice();return n[26]=e[t],n}function fl(s,e,t){const n=s.slice();return n[29]=e[t],n}function dl(s){let e,t;return{c(){e=b("div"),t=ee(s[3]),this.h()},l(n){e=y(n,"DIV",{class:!0});var l=C(e);t=te(l,s[3]),l.forEach(_),this.h()},h(){p(e,"class","error svelte-1u7ze7x")},m(n,l){R(n,e,l),f(e,t)},p(n,l){l[0]&8&&ye(t,n[3])},d(n){n&&_(e)}}}function hl(s){let e,t=_e(s[5]),n=[];for(let l=0;l<t.length;l+=1)n[l]=ml(fl(s,t,l));return{c(){e=b("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=y(l,"DIV",{class:!0});var o=C(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(_),this.h()},h(){p(e,"class","intervals my-1 svelte-1u7ze7x")},m(l,o){R(l,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(l,o){if(o[0]&32){t=_e(l[5]);let r;for(r=0;r<t.length;r+=1){const a=fl(l,t,r);n[r]?n[r].p(a,o):(n[r]=ml(a),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function ml(s){let e,t=s[29].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1u7ze7x")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&32&&t!==(t=l[29].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function _l(s){let e,t=_e(s[8].scaleNotes),n=[];for(let l=0;l<t.length;l+=1)n[l]=pl(ul(s,t,l));return{c(){e=b("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=y(l,"DIV",{class:!0});var o=C(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(_),this.h()},h(){p(e,"class","intervals my-1 svelte-1u7ze7x")},m(l,o){R(l,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(l,o){if(o[0]&256){t=_e(l[8].scaleNotes);let r;for(r=0;r<t.length;r+=1){const a=ul(l,t,r);n[r]?n[r].p(a,o):(n[r]=pl(a),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function pl(s){let e,t=s[26].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1u7ze7x")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&256&&t!==(t=l[26].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function zo(s){let e,t,n,l="Score",o,r,a,c,i,d,u,g="Range",m,h,v,N,k,w="—",V,I,G,S,O,P,E,D="Scale",A,L,T,M,$,K,Q,F="Key",X,Z,U,J,H,me,pe,Re;a=new Me({props:{icon:Jt,width:16}});let ie=s[3]&&dl(s);T=new vl({props:{id:"score-scale",class:"p-1 pl-[2px] w-48",containerClass:"w-48",selected:s[0],options:s[10],onSelect:s[14]}});let ce=!s[7]&&hl(s),le=!s[7]&&_l(s);return{c(){e=b("fieldset"),t=b("legend"),n=b("button"),n.textContent=l,o=j(),r=b("button"),ue(a.$$.fragment),c=j(),i=b("div"),d=b("div"),u=b("label"),u.textContent=g,m=j(),h=b("div"),v=b("input"),N=j(),k=b("span"),k.textContent=w,V=j(),I=b("input"),G=j(),S=b("div"),ie&&ie.c(),O=j(),P=b("div"),E=b("label"),E.textContent=D,A=j(),L=b("div"),ue(T.$$.fragment),M=j(),ce&&ce.c(),$=j(),K=b("div"),Q=b("label"),Q.textContent=F,X=j(),Z=b("div"),U=b("input"),J=j(),le&&le.c(),this.h()},l(oe){e=y(oe,"FIELDSET",{class:!0});var ge=C(e);t=y(ge,"LEGEND",{class:!0});var we=C(t);n=y(we,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-lqyol"&&(n.textContent=l),we.forEach(_),o=B(ge),r=y(ge,"BUTTON",{class:!0});var tt=C(r);fe(a.$$.fragment,tt),tt.forEach(_),c=B(ge),i=y(ge,"DIV",{class:!0});var q=C(i);d=y(q,"DIV",{class:!0});var re=C(d);u=y(re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(u)!=="svelte-10u0679"&&(u.textContent=g),m=B(re),h=y(re,"DIV",{class:!0});var Ee=C(h);v=y(Ee,"INPUT",{class:!0,id:!0}),N=B(Ee),k=y(Ee,"SPAN",{class:!0,"data-svelte-h":!0}),ae(k)!=="svelte-8q1xz4"&&(k.textContent=w),V=B(Ee),I=y(Ee,"INPUT",{class:!0,id:!0}),Ee.forEach(_),G=B(re),S=y(re,"DIV",{class:!0});var xe=C(S);ie&&ie.l(xe),xe.forEach(_),re.forEach(_),O=B(q),P=y(q,"DIV",{class:!0});var ne=C(P);E=y(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(E)!=="svelte-1nrdbqn"&&(E.textContent=D),A=B(ne),L=y(ne,"DIV",{class:!0});var We=C(L);fe(T.$$.fragment,We),We.forEach(_),M=B(ne),ce&&ce.l(ne),ne.forEach(_),$=B(q),K=y(q,"DIV",{class:!0});var je=C(K);Q=y(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Q)!=="svelte-17pcm6g"&&(Q.textContent=F),X=B(je),Z=y(je,"DIV",{class:!0});var ut=C(Z);U=y(ut,"INPUT",{class:!0,id:!0}),ut.forEach(_),J=B(je),le&&le.l(je),je.forEach(_),q.forEach(_),ge.forEach(_),this.h()},h(){p(n,"class","px-1 rounded hover:bg-gray-100"),p(t,"class","text-base"),p(r,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(r,"hidden",s[6]),p(u,"class","font-bold"),p(u,"for","range_min"),p(v,"class","h-[28px] w-full"),p(v,"id","range_min"),p(k,"class","mx-2 mt-1"),p(I,"class","h-[28px] w-full"),p(I,"id","range_max"),p(h,"class","my-1 flex w-full"),p(S,"class","flex justify-between my-1"),p(d,"class","flex flex-col h-full"),p(E,"class","font-bold"),p(E,"for","score-scale"),p(L,"class","my-1 w-full"),p(P,"class","flex flex-col h-full"),p(Q,"class","font-bold"),p(Q,"for","key"),p(U,"class","h-[28px]"),p(U,"id","key"),p(Z,"class","my-1 flex"),p(K,"class","flex flex-col h-full"),p(i,"class","options svelte-1u7ze7x"),W(i,"hidden",s[6]),p(e,"class",H=Ae(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),W(e,"collapsed",s[6])},m(oe,ge){R(oe,e,ge),f(e,t),f(t,n),f(e,o),f(e,r),de(a,r,null),f(e,c),f(e,i),f(i,d),f(d,u),f(d,m),f(d,h),f(h,v),Ze(v,s[1]),f(h,N),f(h,k),f(h,V),f(h,I),Ze(I,s[2]),f(d,G),f(d,S),ie&&ie.m(S,null),f(i,O),f(i,P),f(P,E),f(P,A),f(P,L),de(T,L,null),f(P,M),ce&&ce.m(P,null),f(i,$),f(i,K),f(K,Q),f(K,X),f(K,Z),f(Z,U),Ze(U,s[4]),f(K,J),le&&le.m(K,null),me=!0,pe||(Re=[Y(n,"click",s[15]),Y(r,"click",s[16]),Y(v,"input",s[18]),Y(v,"change",s[19]),Y(v,"focus",s[12]),Y(I,"input",s[20]),Y(I,"change",s[21]),Y(I,"focus",s[12]),Y(U,"input",s[22]),Y(U,"input",s[13])],pe=!0)},p(oe,ge){(!me||ge[0]&64)&&W(r,"hidden",oe[6]),ge[0]&2&&v.value!==oe[1]&&Ze(v,oe[1]),ge[0]&4&&I.value!==oe[2]&&Ze(I,oe[2]),oe[3]?ie?ie.p(oe,ge):(ie=dl(oe),ie.c(),ie.m(S,null)):ie&&(ie.d(1),ie=null);const we={};ge[0]&1&&(we.selected=oe[0]),T.$set(we),oe[7]?ce&&(ce.d(1),ce=null):ce?ce.p(oe,ge):(ce=hl(oe),ce.c(),ce.m(P,null)),ge[0]&16&&U.value!==oe[4]&&Ze(U,oe[4]),oe[7]?le&&(le.d(1),le=null):le?le.p(oe,ge):(le=_l(oe),le.c(),le.m(K,null)),(!me||ge[0]&64)&&W(i,"hidden",oe[6]),(!me||ge[0]&131072&&H!==(H=Ae(`${oe[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&p(e,"class",H),(!me||ge[0]&131136)&&W(e,"collapsed",oe[6])},i(oe){me||(x(a.$$.fragment,oe),x(T.$$.fragment,oe),me=!0)},o(oe){z(a.$$.fragment,oe),z(T.$$.fragment,oe),me=!1},d(oe){oe&&_(e),he(a),ie&&ie.d(),he(T),ce&&ce.d(),le&&le.d(),pe=!1,qe(Re)}}}function qo(s,e,t){let n,l,o,r,a,c;be(s,Rt,L=>t(23,l=L)),be(s,At,L=>t(24,o=L)),be(s,It,L=>t(7,a=L)),be(s,vt,L=>t(8,c=L));let i=mt(l[0]),d=mt(l[1]),u="";const g=bt(Ve(!1),{key:"score-options-hidden"});be(s,g,L=>t(6,r=L));let m=o[0],h=o[1];const v=bs(),N=v.map(L=>({key:L.names[0],value:L.names[0]}));Rt.subscribe(L=>{t(1,i=mt(L[0])),t(2,d=mt(L[1]))}),At.subscribe(L=>{t(4,m=L[0]),t(0,h=L[1])});function k(L,T){const M=lr(T.currentTarget.value,!0,!0);if("data"in M){const{midi:$}=M.data,K=l,Q=[L==="min"?$:K[0].midi,L==="max"?$:K[1].midi];Pe.setMidiRange(Q),t(3,u="")}else t(3,u=M.err),L==="min"?t(1,i=mt(l[0])):t(2,d=mt(l[1]))}function w(){t(3,u="")}function V({currentTarget:{value:L}}){t(4,m=`${L.charAt(0).toUpperCase()}${L.charAt(1).toLowerCase()}`),Se.setKey(m)}function I(L){var T;return t(0,h=(T=N.find(M=>L===M.key))==null?void 0:T.value),Se.setScale(h),!1}function G(){g.update(L=>!L)}function S(){Se.clearScore(!0),Pe.setMidiRange([60,84])}function O(){i=this.value,t(1,i)}const P=L=>k("min",L);function E(){d=this.value,t(2,d)}const D=L=>k("max",L);function A(){m=this.value,t(4,m)}return s.$$set=L=>{t(17,e=Ie(Ie({},e),Ne(L)))},s.$$.update=()=>{var L;s.$$.dirty[0]&1&&t(5,n=((L=v.find(T=>T.names[0]===h))==null?void 0:L.intervals)||[])},e=Ne(e),[h,i,d,u,m,n,r,a,c,g,N,k,w,V,I,G,S,e,O,P,E,D,A]}class Wo extends Fe{constructor(e){super(),He(this,e,qo,zo,ze,{},null,[-1,-1])}}function Jo(s){s[21]=s[22].default}function Yo(s){return{c:ve,l:ve,m:ve,i:ve,o:ve,d:ve}}function Qo(s){Jo(s);let e,t,n;var l=s[21];function o(r,a){return{props:{class:"mx-4 md:mx-0"}}}return l&&(e=Gl(l,o())),{c(){e&&ue(e.$$.fragment),t=Le()},l(r){e&&fe(e.$$.fragment,r),t=Le()},m(r,a){e&&de(e,r,a),R(r,t,a),n=!0},i(r){n||(e&&x(e.$$.fragment,r),n=!0)},o(r){e&&z(e.$$.fragment,r),n=!1},d(r){r&&_(t),e&&he(e,r)}}}function Xo(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){R(t,e,n)},i:ve,o:ve,d(t){t&&_(e)}}}function Zo(s){let e,t,n="MIDI Note Trainer",l,o,r,a,c,i,d,u="Introduction",g,m,h,v,N,k,w,V,I,G,S,O,P,E,D,A,L,T,M,$,K;a=new Me({props:{icon:Jt,width:24}}),h=new ko({}),N=new Ho({}),w=new Nr({}),G=new Wo({props:{class:"score-options mr-4"}}),O=new Po({props:{class:"play-form"}});let Q={ctx:s,current:null,token:null,hasCatch:!1,pending:Xo,then:Qo,catch:Yo,value:22,blocks:[,,,]};return Bl(Te(()=>import("./Score.f37c42f4.js"),["./Score.f37c42f4.js","./vendor_svelte.43fe9e59.js","./vendor.e9b0235c.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),Q),A=new No({props:{class:"min-h-32",debounced:!!s[0]}}),A.$on("guessed-chord",s[2]),A.$on("guessed-key",s[3]),A.$on("guessed-note",s[4]),T=new $r({props:{game:s[1]}}),{c(){e=b("h1"),t=b("a"),t.textContent=n,l=j(),o=b("div"),r=b("button"),ue(a.$$.fragment),c=j(),i=b("div"),d=b("button"),d.textContent=u,g=j(),m=b("section"),ue(h.$$.fragment),v=j(),ue(N.$$.fragment),k=j(),ue(w.$$.fragment),V=j(),I=b("div"),ue(G.$$.fragment),S=j(),ue(O.$$.fragment),P=j(),Q.block.c(),E=j(),D=b("section"),ue(A.$$.fragment),L=j(),ue(T.$$.fragment),this.h()},l(F){e=y(F,"H1",{class:!0});var X=C(e);t=y(X,"A",{class:!0,href:!0,"data-svelte-h":!0}),ae(t)!=="svelte-km4jns"&&(t.textContent=n),l=B(X),o=y(X,"DIV",{class:!0});var Z=C(o);r=y(Z,"BUTTON",{class:!0});var U=C(r);fe(a.$$.fragment,U),U.forEach(_),Z.forEach(_),X.forEach(_),c=B(F),i=y(F,"DIV",{class:!0});var J=C(i);d=y(J,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(d)!=="svelte-f34gar"&&(d.textContent=u),J.forEach(_),g=B(F),m=y(F,"SECTION",{class:!0});var H=C(m);fe(h.$$.fragment,H),v=B(H),fe(N.$$.fragment,H),k=B(H),fe(w.$$.fragment,H),V=B(H),I=y(H,"DIV",{class:!0});var me=C(I);fe(G.$$.fragment,me),S=B(me),fe(O.$$.fragment,me),me.forEach(_),H.forEach(_),P=B(F),Q.block.l(F),E=B(F),D=y(F,"SECTION",{class:!0});var pe=C(D);fe(A.$$.fragment,pe),L=B(pe),fe(T.$$.fragment,pe),pe.forEach(_),this.h()},h(){p(t,"class","hover:underline"),p(t,"href","https://github.com/TeemuKoivisto/midi-note-trainer"),p(r,"class","rounded p-2 hover:bg-gray-200"),p(o,"class","flex items-center justify-center"),p(e,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight flex items-center justify-between"),p(d,"class","btn-pill border-2 border-gray-300 hover:bg-gray-200"),p(i,"class","px-4 md:px-0"),p(I,"class","play svelte-qjpqy3"),p(m,"class","mx-4 md:mx-0"),p(D,"class","mb-8 ml-16 flex flex-col")},m(F,X){R(F,e,X),f(e,t),f(e,l),f(e,o),f(o,r),de(a,r,null),R(F,c,X),R(F,i,X),f(i,d),R(F,g,X),R(F,m,X),de(h,m,null),f(m,v),de(N,m,null),f(m,k),de(w,m,null),f(m,V),f(m,I),de(G,I,null),f(I,S),de(O,I,null),R(F,P,X),Q.block.m(F,Q.anchor=X),Q.mount=()=>E.parentNode,Q.anchor=E,R(F,E,X),R(F,D,X),de(A,D,null),f(D,L),de(T,D,null),M=!0,$||(K=[Y(r,"click",s[5]),Y(d,"click",s[6])],$=!0)},p(F,[X]){s=F;const Z={};X&1&&(Z.debounced=!!s[0]),A.$set(Z);const U={};X&2&&(U.game=s[1]),T.$set(U)},i(F){M||(x(a.$$.fragment,F),x(h.$$.fragment,F),x(N.$$.fragment,F),x(w.$$.fragment,F),x(G.$$.fragment,F),x(O.$$.fragment,F),x(Q.block),x(A.$$.fragment,F),x(T.$$.fragment,F),M=!0)},o(F){z(a.$$.fragment,F),z(h.$$.fragment,F),z(N.$$.fragment,F),z(w.$$.fragment,F),z(G.$$.fragment,F),z(O.$$.fragment,F);for(let X=0;X<3;X+=1){const Z=Q.blocks[X];z(Z)}z(A.$$.fragment,F),z(T.$$.fragment,F),M=!1},d(F){F&&(_(e),_(c),_(i),_(g),_(m),_(P),_(E),_(D)),he(a),he(h),he(N),he(w),he(G),he(O),Q.block.d(F),Q.token=null,Q=null,he(A),he(T),$=!1,qe(K)}}}function ea(s,e,t){let n,l,o,r,a,c;be(s,_t,O=>t(9,n=O)),be(s,It,O=>t(1,l=O)),be(s,gt,O=>t(10,o=O)),be(s,nt,O=>t(11,r=O)),be(s,st,O=>t(12,a=O)),be(s,Ls,O=>t(13,c=O));let i,d;gl(()=>(c&&I(),window.addEventListener("keydown",u),window.addEventListener("mousedown",u),window.addEventListener("touchstart",u),()=>{window.removeEventListener("keydown",u),window.removeEventListener("mousedown",u),window.removeEventListener("touchstart",u)})),gs.subscribe(O=>{O&&O.channels[1].addListener("noteon",g)});function u(){Pe.initAudio(),window.removeEventListener("keydown",u),window.removeEventListener("mousedown",u),window.removeEventListener("touchstart",u)}function g(O){if(i)return;const P=O.rawData;m(P[1],P[2])}function m(O,P){const E=l;E instanceof Pt&&!(E!=null&&E.ended)&&n==="waiting"?N(O):E instanceof pt&&!(E!=null&&E.ended)&&n==="waiting"?(E.addPlayedNote(O),d||(d=setTimeout(v,2e3))):E||Se.pushPlayed(O),a&&a.noteOn(O,r.fixedVelocity??P)}function h(){o.autoplay&&o.waitSeconds>0?t(0,i=setTimeout(()=>{o.autoplay&&De.nextGuess(),t(0,i=void 0)},o.waitSeconds*1e3)):o.autoplay?De.nextGuess():t(0,i=void 0)}function v(){var P;const O=l;if(O instanceof pt){const E=O.guess();Se.setPlayed(((P=O.latestGuess.guessed)==null?void 0:P.notes)||[],E,-1),De.updateState(E?"correct":"wrong"),h()}d=void 0}function N(O){const P=l;if(P instanceof Pt&&n==="waiting"){Se.setTarget([Se.getNote(P.current)]);const E=P.guess(O);De.updateState(E?"correct":"wrong"),Se.pushPlayed(O,E,4e3),h()}}function k(O){const P=l;if(P instanceof pt&&n==="waiting"){const E=P.guessWrittenChord(O.detail);De.updateState(E?"correct":"wrong"),h()}}function w(O){const P=l;if(P instanceof qt&&n==="waiting"){const E=O.detail.replaceAll("♭","b").replaceAll("♯","#"),D=P.guess(E);De.updateState(D?"correct":"wrong"),h()}}function V(O){const P=ct.findNote(O.detail.note)??xs(O.detail.note);P&&m(P.semitones+12+O.detail.octave*12,80)}async function I(){const O=await Pe.openMidi();"data"in O?O.data.name:(O.err,console.error(O.err))}function G(){ur(),window.location.reload()}return[i,l,k,w,V,G,()=>$l.open("introduction",void 0)]}class ra extends Fe{constructor(e){super(),He(this,e,ea,Zo,ze,{})}}export{ln as F,pt as G,ra as P,Jl as S,Pt as a,De as b,It as c,wt as d,ps as e,_t as g,st as p,vt as s,cn as t};
