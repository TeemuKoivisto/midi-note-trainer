import{_ as Ie}from"./preload-helper.a4192956.js";import{S as Fe,i as He,s as ze,R as Te,e as b,b as P,g as y,h as C,f as j,j as _,_ as jt,P as W,k as p,$ as Ae,l as R,n as f,a0 as Ze,y as Y,a1 as js,t as U,J as Ke,q as z,C as xe,a2 as qe,T as Ne,c as Bs,a3 as _e,u as Gs,o as Ms,p as Rs,W as cs,X as Ct,Y as us,a4 as fs,a5 as Oe,B as Le,L as gs,G as ee,H as te,I as ye,z as ve,O as Me,a as ue,d as fe,m as de,r as he,v as Ce,U as Wt,w as Ve,x as ae,Q as be,a6 as Bt,A as gl,a7 as jl,a8 as ds,a9 as Bl,N as Gl}from"./vendor_svelte.a281e649.js";import{w as Ts,c as Ml,e as Rl,f as Js,g as Ys,h as Jt,i as hs,j as ms,k as Gt,l as Mt,m as Ul,a as Qs,n as Ss}from"./vendor.e9b0235c.js";import{a as $l}from"./modal.26be6455.js";function Xs(s,e,t){const n=s.slice();return n[19]=e[t].key,n[20]=e[t].value,n[21]=e[t].icon,n[23]=t,n}const Kl=s=>({}),Zs=s=>({});function en(s){let e,t,n,l,o,r,a,c,i,d,u;const g=s[14].header,m=Bs(g,s,s[13],Zs);let h=_e(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=sn(Xs(s,h,k));const S=k=>z(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),n=P(),l=b("ul"),o=b("li"),m&&m.c(),r=P();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(_),n=j(k),l=y(k,"UL",{class:!0});var E=C(l);o=y(E,"LI",{});var O=C(o);m&&m.l(O),O.forEach(_),r=j(E);for(let T=0;T<v.length;T+=1)v[T].l(E);E.forEach(_),this.h()},h(){p(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),p(e,"tabindex","-1"),p(l,"class",a=Ae(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[11].containerClass||""}`)+" svelte-1tx2rz0")},m(k,E){R(k,e,E),R(k,n,E),R(k,l,E),f(l,o),m&&m.m(o,null),f(l,r);for(let O=0;O<v.length;O+=1)v[O]&&v[O].m(l,null);i=!0,d||(u=Y(e,"click",s[8]),d=!0)},p(k,E){if(s=k,m&&m.p&&(!i||E&8192)&&Gs(m,g,s,s[13],i?Rs(g,s[13],E,Kl):Ms(s[13]),Zs),E&1123){h=_e(s[0]);let O;for(O=0;O<h.length;O+=1){const T=Xs(s,h,O);v[O]?(v[O].p(T,E),U(v[O],1)):(v[O]=sn(T),v[O].c(),U(v[O],1),v[O].m(l,null))}for(Ke(),O=h.length;O<v.length;O+=1)S(O);xe()}(!i||E&2048&&a!==(a=Ae(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[11].containerClass||""}`)+" svelte-1tx2rz0"))&&p(l,"class",a)},i(k){if(!i){k&&cs(()=>{i&&(t||(t=Ct(e,us,{duration:os},!0)),t.run(1))}),U(m,k);for(let E=0;E<h.length;E+=1)U(v[E]);k&&cs(()=>{i&&(c||(c=Ct(l,fs,{duration:os},!0)),c.run(1))}),i=!0}},o(k){k&&(t||(t=Ct(e,us,{duration:os},!1)),t.run(0)),z(m,k),v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)z(v[E]);k&&(c||(c=Ct(l,fs,{duration:os},!1)),c.run(0)),i=!1},d(k){k&&(_(e),_(n),_(l)),k&&t&&t.end(),m&&m.d(k),Oe(v,k),k&&c&&c.end(),d=!1,u()}}}function tn(s){let e,t,n,l,o,r,a=s[20]+"",c,i,d,u,g;const m=[Fl,xl],h=[];function v(k,E){return k[21]?0:1}n=v(s),l=h[n]=m[n](s);function S(){return s[17](s[19])}return{c(){e=b("li"),t=b("button"),l.c(),o=P(),r=b("div"),c=ee(a),i=P(),this.h()},l(k){e=y(k,"LI",{});var E=C(e);t=y(E,"BUTTON",{class:!0});var O=C(t);l.l(O),o=j(O),r=y(O,"DIV",{});var T=C(r);c=te(T,a),T.forEach(_),O.forEach(_),i=j(E),E.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-1tx2rz0"),W(t,"selected",s[19]===s[1])},m(k,E){R(k,e,E),f(e,t),h[n].m(t,null),f(t,o),f(t,r),f(r,c),f(e,i),d=!0,u||(g=[Y(t,"click",S),Y(t,"blur",s[6])],u=!0)},p(k,E){s=k;let O=n;n=v(s),n===O?h[n].p(s,E):(Ke(),z(h[O],1,1,()=>{h[O]=null}),xe(),l=h[n],l?l.p(s,E):(l=h[n]=m[n](s),l.c()),U(l,1),l.m(t,o)),(!d||E&1)&&a!==(a=s[20]+"")&&ye(c,a),(!d||E&3)&&W(t,"selected",s[19]===s[1])},i(k){d||(U(l),d=!0)},o(k){z(l),d=!1},d(k){k&&_(e),h[n].d(),u=!1,qe(g)}}}function xl(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","w-[24px]")},m(t,n){R(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&_(e)}}}function Fl(s){let e,t;return e=new Me({props:{class:"mr-2",icon:s[21],width:16}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p(n,l){const o={};l&1&&(o.icon=n[21]),e.$set(o)},i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function sn(s){let e,t,n=!s[5][s[23]]&&tn(s);return{c(){n&&n.c(),e=Le()},l(l){n&&n.l(l),e=Le()},m(l,o){n&&n.m(l,o),R(l,e,o),t=!0},p(l,o){l[5][l[23]]?n&&(Ke(),z(n,1,1,()=>{n=null}),xe()):n?(n.p(l,o),o&32&&U(n,1)):(n=tn(l),n.c(),U(n,1),n.m(e.parentNode,e))},i(l){t||(U(n),t=!0)},o(l){z(n),t=!1},d(l){l&&_(e),n&&n.d(l)}}}function Hl(s){let e,t,n,l,o,r,a,c,i=[{class:n=`${s[11].class||""} open-btn text-justify text-sm rounded`},s[11]],d={};for(let g=0;g<i.length;g+=1)d=Te(d,i[g]);let u=s[3]&&en(s);return{c(){e=b("div"),t=b("input"),l=P(),u&&u.c(),this.h()},l(g){e=y(g,"DIV",{class:!0});var m=C(e);t=y(m,"INPUT",{class:!0}),l=j(m),u&&u.l(m),m.forEach(_),this.h()},h(){jt(t,d),W(t,"open",s[3]),W(t,"svelte-1tx2rz0",!0),p(e,"class",o=Ae(`relative ${s[11].containerClass||""}`)+" svelte-1tx2rz0")},m(g,m){R(g,e,m),f(e,t),t.autofocus&&t.focus(),Ze(t,s[4]),f(e,l),u&&u.m(e,null),s[18](e),r=!0,a||(c=[Y(t,"input",s[15]),Y(t,"focus",s[16]),Y(t,"blur",s[6]),Y(t,"input",s[7]),Y(t,"keydown",s[9])],a=!0)},p(g,[m]){jt(t,d=js(i,[(!r||m&2048&&n!==(n=`${g[11].class||""} open-btn text-justify text-sm rounded`))&&{class:n},m&2048&&g[11]])),m&16&&t.value!==g[4]&&Ze(t,g[4]),W(t,"open",g[3]),W(t,"svelte-1tx2rz0",!0),g[3]?u?(u.p(g,m),m&8&&U(u,1)):(u=en(g),u.c(),U(u,1),u.m(e,null)):u&&(Ke(),z(u,1,1,()=>{u=null}),xe()),(!r||m&2048&&o!==(o=Ae(`relative ${g[11].containerClass||""}`)+" svelte-1tx2rz0"))&&p(e,"class",o)},i(g){r||(U(u),r=!0)},o(g){z(u),r=!1},d(g){g&&_(e),u&&u.d(),s[18](null),a=!1,qe(c)}}}const os=400;function zl(s,e,t){let{$$slots:n={},$$scope:l}=e,{options:o,selected:r,onSelect:a}=e,c,i=!1,d=r,u=o.map(G=>!1);function g(G){t(3,i=c.contains(G.relatedTarget))}function m(G){t(5,u=o.map(w=>!w.value.toLowerCase().includes(G.currentTarget.value.toLowerCase())))}function h(){t(4,d=r),t(3,i=!1),t(5,u=o.map(G=>!1))}function v(G){if(G.key==="Enter"){const w=u.findIndex(B=>!B);d===r?h():w>-1&&t(3,i=a(o[w].key)),i||(t(5,u=o.map(B=>!1)),G.currentTarget instanceof HTMLElement&&G.currentTarget.blur())}else G.key==="Escape"&&(h(),G.currentTarget instanceof HTMLElement&&G.currentTarget.blur())}function S(G){t(3,i=a(G))}function k(){d=this.value,t(4,d),t(1,r)}const E=()=>t(3,i=!0),O=G=>S(G);function T(G){gs[G?"unshift":"push"](()=>{c=G,t(2,c)})}return s.$$set=G=>{t(11,e=Te(Te({},e),Ne(G))),"options"in G&&t(0,o=G.options),"selected"in G&&t(1,r=G.selected),"onSelect"in G&&t(12,a=G.onSelect),"$$scope"in G&&t(13,l=G.$$scope)},s.$$.update=()=>{s.$$.dirty&2&&t(4,d=r),s.$$.dirty&1&&t(5,u=o.map(G=>!1))},e=Ne(e),[o,r,c,i,d,u,g,m,h,v,S,e,a,l,n,k,E,O,T]}class vl extends Fe{constructor(e){super(),He(this,e,zl,Hl,ze,{options:0,selected:1,onSelect:12})}}const nn={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Xe(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:bl(s,e,t),flats:e,sharps:t}}function bl(s,e,t){return(s<8?nn[s]:nn[s%7])-e+t+Math.floor(s/8)*12}function yl(s){let e,t=0,n=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(n=Math.floor(s/100),e=s%100):e=s;const l=bl(e,t,n);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(n)}`,interval_seq:e,semitones:l,flats:t,sharps:n}}const ql=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6","△6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9","△6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7","△7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9","△9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11","△11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13","△13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let Is=[];function kl(){return ql.map(s=>{const e=s[3].map(yl);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function Ft(s){Is.length===0&&(Is=kl());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return Is.find(t=>t.suffixes.find(n=>n===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function Wl(s,e,t){let n=e<0?s.flats-e:s.flats,l=e>0?s.sharps+e:s.sharps;if(n>0&&l>0){const r=Math.min(n,l);n-=r,l-=r}const o=(s.semitones+e)%12;return{...s,semitones:o<0?o+12:o,note:`${s.note.charAt(0)}${"♭".repeat(n)}${"♯".repeat(l)}`,flats:n,sharps:l,midi:t}}function is(s,e,t){const n=[];for(let l=0;l<t.length;l+=1){const o=t[l],r=s+o.semitones,a=e.scaleNotes.find(g=>g.semitones===r%12),c=o.flats>0,i=o.sharps>0,d=(c?r+1:i?r-1:r)%12,u=c?-1:i?1:0;n.push(Wl(a??e.notesMap.get(d),a?0:u,r))}return n}const ln=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],Jl=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],rn=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Yl(s){let e=0,t=0;for(let n=0;n<ln.length;n+=1){const l=s.find(r=>r.note.slice(0,2)===ln[n]),o=s.find(r=>r.note.slice(0,2)===Jl[n]);if(l)e+=1;else if(o)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:rn.get(e*-1)}:{flats:0,sharps:t,majorSignature:rn.get(t)}}function Ql(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function wl(s){return s.map(e=>{const t=[Xe(1)];let n;return e.major?(t.push(Xe(3)),e.suffix.startsWith("+")?t.push(Xe(5,0,1)):e.suffix.startsWith("6")?t.push(Xe(6)):e.suffix.startsWith("7")?t.push(Xe(7,1)):e.suffix.startsWith("maj7")?t.push(Xe(7)):n=Ft("maj")):e.minor?(t.push(Xe(3,1)),e.suffix.startsWith("°")?t.push(Xe(5,1)):e.suffix.startsWith("6")?(t.push(Xe(6)),n=Ft("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Xe(7,1)),n=Ft("m"+e.suffix)):n=Ft("m")):e.suffix.startsWith("sus2")?t.push(Xe(2)):e.suffix.startsWith("sus4")&&t.push(Xe(4)),t.length<=2&&t.push(Xe(5)),t.length<=2&&t.push(Xe(8)),n||(n=Ft(e.suffix)),{...n,intervals:t}})}function Xl(s,e){let t=e.has(4)&&e.has(7),n=e.has(3)&&e.has(7);const l=Ql(s);let o="";return t||n||(e.has(3)&&e.has(6)?(o="°",n=!0):e.has(4)&&e.has(8)?(o="+",t=!0):e.has(3)&&e.has(10)?(n=!0,o="7"):e.has(4)&&e.has(10)?(o="7",t=!0):e.has(4)&&e.has(11)?(o="maj7",t=!0):e.has(3)&&e.has(8)?(o="6",n=!0):e.has(4)&&e.has(9)?(o="6",t=!0):e.has(2)?o="sus2":e.has(5)?o="sus4":e.has(7)?o="5":o="?"),{degree:s,roman:n?l.toLowerCase():l,suffix:o,major:t,minor:n,semitones:e}}function Zl(s){const e=s.length;return s.map((t,n)=>{const l=t.semitones,o=new Set;for(let r=1;r<e;r+=1){const a=s[(n+r)%e].semitones,c=a<=l?a+12-l:a-l;o.add(c)}return Xl(t.interval_seq,o)})}const er=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let As=[];function vs(){return er.map(s=>{const e=s[0],t=s[1].map(yl),n=Zl(t);return{names:e,intervals:t,triads:n}})}function tr(s){As.length===0&&(As=vs());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return As.find(t=>t.names.find(n=>n.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const sr=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,nr=/^[0-9]$/,at=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function _s(s){const e=s.midi+s.flats-s.sharps;return e===12?1:Math.floor((e-12)/12)}function ht(s){return`${s.note}${_s(s)}`}function on(s){const t=(s-12)%12;return{...at[t],semitones:t,midi:s}}function lr(s,e=!0,t=!1){if(e&&!sr.test(s))return{err:`Unrecognized note "${s}"`,code:400};const n=s.trim(),l=n.charAt(0).toUpperCase(),o=at.find(u=>u.note.charAt(0)===l&&u.note.length===1);if(!o)return{err:`Unable to find note ${n}`,code:500};const r=n.slice(1).split("").reduce((u,g)=>u+(g.toLowerCase()==="b"||g==="♭"?-1:g==="#"||g==="♯"?1:0),0);let a;if(nr.test(n.charAt(n.length-1)))try{a=parseInt(n.charAt(n.length-1),10)}catch{}if(t&&a===void 0)return{err:`No octave provided: ${s}`,code:400};a===void 0&&(a=0);let c=(o.semitones+r)%12;c=c<0?c+12:c;const i=r<0?-r:0,d=r>0?r:0;return{data:{note:`${l}${"♭".repeat(i)}${"♯".repeat(d)}`,semitones:c,midi:12+a*12+c,flats:i,sharps:d}}}function Us(s){const e=at.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((l,o)=>l+(o.toLowerCase()==="b"||o==="♭"?-1:o==="#"||o==="♯"?1:0),0),n=(e.semitones+t)%12;return{note:s,semitones:n<0?n+12:n,flats:t<0?-t:0,sharps:t>0?t:0}}}const rr=/^[a-gA-G][♭b#♯]?$/,Ns="ABCDEFG";function or(s,e){return e.map(t=>Ns.charAt((Ns.indexOf(s)+t.interval_seq-1)%Ns.length))}function ar(s,e,t){return t.map((n,l)=>{const o=e[l],r=(s+n.semitones)%12,a=at[r],c=a.note.charAt(0);if(c<o&&(c!=="A"||o!=="G")||c==="G"&&o==="A"){let i=1,d=at[(r+i)%12];for(;d.note.charAt(0)!==o;)i+=1,d=at[(r+i)%12];return{semitones:r,note:d.note+"♭".repeat(i),flats:i+(d.note.includes("♭")?1:0),sharps:0}}else if(c>o||c==="A"&&o==="G"){let i=1,d=r===0?at.length-1:r-i,u=at[d];for(;u.note.charAt(0)!==o;)i+=1,d=d===0?at.length-1:d-1,u=at[d];return{semitones:r,note:u.note+"♯".repeat(i),flats:0,sharps:i+(u.note.includes("♯")?1:0)}}else return{semitones:r,note:a.note,flats:a.flats,sharps:a.sharps}})}function zt(s,e){if(!rr.test(s))return{err:`Unknown key: ${s}`,code:400};const t=tr(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const n=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,l=Us(n);if(!l)return{err:`Unable to find root for note: ${n}`,code:404};const o=or(n.charAt(0),t.intervals),r=ar(l.semitones,o,t.intervals),a=new Map(at.map(c=>{const i=r.find(d=>d.semitones===c.semitones);return i?[c.semitones,i]:[c.semitones,{...c}]}));return{data:{key:n,scale:t.names[0],names:t.names,...Yl(r),intervals:t.intervals.map(c=>({...c})),triads:t.triads.map(c=>({...c})),scaleNotes:r,notesMap:a}}}const Ds=new Map;function ir(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function cr(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(n){return{err:`Failed to store the value: ${n}`,code:400}}}function vt(s,e){const{key:t,storage:n="local",namespace:l="default"}=e,o=ir(t,n),r=Ce(s);"data"in o?s.set(e.deserialize?e.deserialize(o.data):o.data):"err"in o&&(e!=null&&e.debug)&&console.info(o.err);const a=s.subscribe(i=>{const d=cr(e.serialize?e.serialize(i):i,t,n);"err"in d&&(e!=null&&e.debug)&&console.error(d.err)}),c=Ds.get(l);return c?c.push({key:t,storage:n,value:s,defaultValue:r,unsubscribe:a}):Ds.set(l,[{key:t,storage:n,value:s,defaultValue:r,unsubscribe:a}]),s}function ur(s=["default"],e){s.forEach(t=>{var n;(n=Ds.get(t))==null||n.forEach(l=>{if(e!=null&&e.cb)e==null||e.cb(l);else try{e!=null&&e.unsubscribe&&l.unsubscribe(),l.value.set(l.defaultValue),(l.storage==="local"?window.localStorage:window.sessionStorage).removeItem(l.key)}catch{}})})}async function fr(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const n=await t.arrayBuffer();return{data:await e.decodeAudioData(n)}}async function dr(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],n=await Promise.all(t.map(o=>fr(`${s}${o}`,e))),l=[];return n.forEach(o=>{"err"in o?console.error(`Failed to load audio: ${o.err}`):l.push(o.data)}),l}class hr{constructor(e,t,n,l){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(n),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=l,this.damp.connect(n))}on(e,t,n,l,o,r,a,c){this.noteA.buffer=e,this.noteA.playbackRate.value=n,this.biquadFilter.frequency.value=o,this.gainA.gain.value=r,this.gain.gain.value=c,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=l,this.gainB.gain.value=a,this.noteB.start(0)),this.noteA.start(0)}off(e,t,n){var l;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(n),this.noteB.stop(n),(l=this.damp)==null||l.start(0)}}class mr{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,n)=>{this.bufferlists.push(t),n===8?this.damper=t:n===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(n=>{this.noteOn(n,t)})}noteOn(e,t=80){if(e<109&&e>20){const n=this.notes.get(e);n&&(n.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const l=Math.floor((e-21)/12),o=l+1,r=l*12+21,a=2**((e-69)/12)*440,c=t/127;let i=a*(2-(e-21)/50)+3*a*c;e<60&&(i=440*(3-(60-21)/50)+3*a*c);const d=1-(e%12/12+1)/12,u=Math.pow(2,(e-r)/12),g=0,m=0,h=c**1.4,v=new hr(e,this.context,this.directGain,this.damper);v.on(this.bufferlists[l],this.bufferlists[o],u,g,i,d,m,h),this.notes.set(e,v)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const _r="/midi-note-trainer/",Ls=vt(Ve(!1),{key:"midi-access"}),ps=Ve({err:"Uninitialized",code:400}),bs=vt(Ve([60,84]),{key:"midi-range",storage:"session"}),Rt=Wt(bs,s=>[on(s[0]),on(s[1])]),an=Ve(void 0),st=Ve(void 0),nt=vt(Ve({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),Pe={async openMidi(){const s=await Ts.enable().then(()=>(Ls.set(!0),Ts.inputs.length>0?{data:Ts.inputs[0]}:{err:"No MIDI device found",code:404})).catch(e=>({err:e.toString(),code:403}));return"err"in s&&console.error(s.err),ps.set(s),s},disableMidi(){Ls.set(!1),ps.set({err:"Uninitialized",code:400})},setMidiRange(s){bs.set(s)},setInputValue(s,e){nt.update(t=>({...t,[s]:e})),s==="useSound"&&!e?st.set(void 0):s==="useSound"&&!Ce(st)&&this.initAudio()},async initAudio(){let s=Ce(an);if(s||(s=new AudioContext,an.set(s)),!Ce(st)){const e=new mr(s),t=await dr(`${_r}audio`,s);e.load(t),st.set(e)}}};let ot;const At=Ve(["C","Major"]),gt=Wt(At,s=>{const e=zt(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),cn=Ve([]),wt=Ve([]);function Os(s,e){if(s.length>0){const t=Date.now();let n=t;const l=s.filter(o=>(o.started+e>t&&(n=Math.min(n,o.started)),o.started+e>t));return!ot&&l.length>0&&(ot=setTimeout(()=>{ot=void 0,wt.update(o=>Os(o,e))},e-(t-n)+100)),l}return s}const Se={setKey(s){At.update(e=>[s,e[1]])},setScale(s){At.update(e=>[e[0],s])},setKeyAndScale(s,e){At.set([s,e])},setTarget(s=[]){cn.set(s)},getNote(s){return{...Ce(gt).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const l={...Ce(gt).notesMap.get(s%12),midi:s},o=Date.now(),r=e===void 0?"default":e?"correct":"wrong";if(wt.update(a=>{const c=a.findIndex(i=>i.midi===s);return c>=0&&a.splice(c,1),[...a,{...l,color:r,started:o}]}),!ot&&t!==-1){const a=t??Ce(nt).keyFadeTimeout;ot=setTimeout(()=>{ot=void 0,wt.update(c=>Os(c,a))},a)}},setPlayed(s,e,t){const n=Date.now(),l=e===void 0?"default":e?"correct":"wrong";if(wt.update(o=>[...s.map(r=>({...r,color:l,started:n}))]),!ot&&t!==-1){const o=t??Ce(nt).keyFadeTimeout;ot=setTimeout(()=>{ot=void 0,wt.update(r=>Os(r,o))},o)}},clearPlayed(){wt.set([]),clearTimeout(ot),ot=void 0},clearScore(s=!1){s&&At.set(["C","Major"]),cn.set([]),wt.set([])}};class $s{constructor(e,t,n){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=n;const l=[],{count:o}=n,r=t.map(c=>typeof c=="object"&&c!==null?{...c}:c);let a=n.duplicates;!n.duplicates&&o>r.length&&(console.warn(`Trying to create game with count ${o} larger than available unique values ${t.length}`),a=!0);for(let c=0;c<o;c+=1){const i=Math.floor(Math.random()*r.length);if(a)l.push(r[i]);else{const d=r.splice(i,1);d.length>0&&l.push(d[0])}}this.sampled=l,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function pr(s,e,t){let n=e<0?s.flats-e:s.flats,l=e>0?s.sharps+e:s.sharps;if(n>0&&l>0){const r=Math.min(n,l);n-=r,l-=r}const o=(s.semitones+e)%12;return{...s,semitones:o<0?o+12:o,note:`${s.note.charAt(0)}${"♭".repeat(n)}${"♯".repeat(l)}`,flats:n,sharps:l,midi:t}}function gr(s,e,t){const n=[];for(let l=0;l<t.length;l+=1){const o=t[l],r=s+o.semitones,a=e.scaleNotes.find(g=>g.semitones===r%12),c=o.flats>0,i=o.sharps>0,d=(c?r+1:i?r-1:r)%12,u=c?-1:i?1:0;n.push(pr(a??e.notesMap.get(d),a?0:u,r))}return n}const vr=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function br(s){const t=(s-12)%12;return{...vr[t],semitones:t,midi:s}}function yr(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class _t extends $s{constructor(e,t,n){const l=t.range[0],o=t.range[1],r=new Set(t.scale.scaleNotes.map(c=>c.semitones)),a=n.chords.flatMap(c=>{const i=[],d=c.intervals.reduce((u,g)=>g.semitones>u?g.semitones:u,0);for(let u=l;u<=o-d;u+=1)if((!n.onlyScale||r.has(u%12))&&(!c.allowed||c.allowed.has(u%12))){const g=gr(u,t.scale,c.intervals);i.push({...c,rootNote:g[0].note,chord:`${g[0].note}${c.suffixes[0]}`,notes:g})}return i});super(e,a,t),this.played=new Set,this.opts=n}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${yr(e)}${e.chord.toLowerCase()}`,notes:[]};let n=this.current.chord===t.chord;return this.current.chord.slice(-3)==="maj"&&!n&&(n=this.current.chord.slice(0,-3)===t.chord),this.addGuessed(t,n)}guess(){const e=Array.from(this.played.values()).map(l=>br(l)).sort((l,o)=>l.midi-o.midi);this.played.clear();const t={chord:"",notes:e},n=this.current.notes.every(l=>e.find(o=>o.midi%12===l.midi%12));return this.addGuessed(t,n)}}const kr={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class qt extends $s{constructor(e,t){const n=e==="keys-major"?"major":"minor";super(e,Object.keys(kr[n]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class Pt extends $s{constructor(e,t){const n=t.range[0],l=t.range[1];super(e,Array.from(new Array(l-n+1)).map((o,r)=>n+r),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const El={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},mt=Ve("waiting"),pt=vt(Ve(El),{key:"game-options"}),Tt=Ve(void 0),Ks=Ve(kl().map(s=>({...s,selected:!0}))),De={play(...[s,e]){var c,i,d;let t;const n=Ce(gt),l=Ce(bs),o=Ce(pt),r={scale:n,range:l,duplicates:o.duplicates,count:o.count};let a=[n.key,n.scale];if(s==="notes")t=new Pt(s,r),Se.setTarget([Se.getNote(t.current)]),(c=Ce(st))==null||c.noteOn(t.current);else if(s==="pitches")t=new Pt(s,r),Se.setTarget(),Pe.setInputValue("useSound",!0),(i=Ce(st))==null||i.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new qt(s,r),a=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new _t(s,r,e);else if(s==="chords-diatonic"){const u=wl(n.triads).map((g,m)=>({...g,allowed:new Set([n.scaleNotes[m].semitones])}));t=new _t(s,r,{chords:u})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((d=Ce(st))==null||d.playChord(t.current.notes.map(u=>u.midi)),Se.setTarget(t.current.notes)),Se.setKeyAndScale(a[0],a[1]),Se.clearPlayed(),mt.set("waiting"),Tt.set(t),t},updateState(s){mt.set(s)},setOptionValue(s,e){pt.update(t=>({...t,[s]:e}))},toggleChords(s){Ks.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Ce(Tt);s!=null&&s.ended?mt.set("ended"):s instanceof Pt?(s.type==="notes"?Se.setTarget([Se.getNote(s.current)]):Se.setTarget(),Se.clearPlayed(),(e=Ce(st))==null||e.noteOn(s.current),De.updateState("waiting"),s.startTime()):s instanceof _t?(Se.setTarget(s.current.notes),Se.clearPlayed(),(t=Ce(st))==null||t.playChord(s==null?void 0:s.current.notes.map(n=>n.midi)),mt.set("waiting"),s.startTime()):s instanceof qt&&(Se.setKey(s.current),mt.set("waiting"),s.startTime())},clearGame(s=!1){const e=Ce(Tt);e&&Se.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&pt.set(El),Tt.set(void 0),mt.set("waiting"),Se.clearScore()}};function un(s,e,t){const n=s.slice();return n[35]=e[t],n[37]=t,n}function fn(s,e,t){const n=s.slice();return n[40]=e[t],n}function dn(s,e,t){const n=s.slice();return n[9]=e[t],n}function hn(s,e,t){const n=s.slice();return n[35]=e[t],n[37]=t,n}function mn(s,e,t){const n=s.slice();return n[40]=e[t],n}function _n(s,e,t){const n=s.slice();return n[9]=e[t],n}function wr(s){let e,t=_e(s[35].intervals),n=[];for(let l=0;l<t.length;l+=1)n[l]=pn(mn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o[0]&128){t=_e(l[35].intervals);let r;for(r=0;r<t.length;r+=1){const a=mn(l,t,r);n[r]?n[r].p(a,o):(n[r]=pn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Er(s){let e,t=_e(s[3][s[37]]),n=[];for(let l=0;l<t.length;l+=1)n[l]=gn(_n(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o[0]&8){t=_e(l[3][l[37]]);let r;for(r=0;r<t.length;r+=1){const a=_n(l,t,r);n[r]?n[r].p(a,o):(n[r]=gn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function pn(s){let e,t=s[40].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&128&&t!==(t=l[40].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function gn(s){let e,t=s[9].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&8&&t!==(t=l[9].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function vn(s){let e,t,n,l,o,r,a=s[35].suffixes[0]+"",c,i,d,u,g,m,h,v=s[35].name+"",S,k,E,O,T;l=new Me({props:{icon:s[35].selected?hs:ms,width:12}});function G(){return s[25](s[35])}function w(L,N){return L[3][L[37]]&&L[3][L[37]].length>0?Er:wr}let B=w(s),V=B(s);function A(){return s[26](s[35])}return{c(){e=b("li"),t=b("button"),n=b("span"),ue(l.$$.fragment),o=P(),r=b("div"),c=ee(a),i=P(),d=b("li"),V.c(),g=P(),m=b("li"),h=b("button"),S=ee(v),k=P(),this.h()},l(L){e=y(L,"LI",{});var N=C(e);t=y(N,"BUTTON",{class:!0});var D=C(t);n=y(D,"SPAN",{class:!0});var I=C(n);fe(l.$$.fragment,I),I.forEach(_),o=j(D),r=y(D,"DIV",{class:!0});var M=C(r);c=te(M,a),M.forEach(_),D.forEach(_),N.forEach(_),i=j(L),d=y(L,"LI",{class:!0,title:!0});var $=C(d);V.l($),$.forEach(_),g=j(L),m=y(L,"LI",{class:!0});var x=C(m);h=y(x,"BUTTON",{class:!0});var Q=C(h);S=te(Q,v),Q.forEach(_),k=j(x),x.forEach(_),this.h()},h(){p(n,"class","px-1 py-1 rounded"),W(n,"text-green-500",s[35].selected),W(n,"text-gray-400",!s[35].selected),p(r,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),p(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),W(t,"hidden",s[8]),p(d,"class","intervals svelte-1rg0xw5"),p(d,"title",u=s[35].intervals.map(wn).join("-")),p(h,"class","text-start"),p(m,"class","text-xs")},m(L,N){R(L,e,N),f(e,t),f(t,n),de(l,n,null),f(t,o),f(t,r),f(r,c),R(L,i,N),R(L,d,N),V.m(d,null),R(L,g,N),R(L,m,N),f(m,h),f(h,S),f(m,k),E=!0,O||(T=[Y(t,"click",G),Y(h,"click",A)],O=!0)},p(L,N){s=L;const D={};N[0]&128&&(D.icon=s[35].selected?hs:ms),l.$set(D),(!E||N[0]&128)&&W(n,"text-green-500",s[35].selected),(!E||N[0]&128)&&W(n,"text-gray-400",!s[35].selected),(!E||N[0]&128)&&a!==(a=s[35].suffixes[0]+"")&&ye(c,a),(!E||N[0]&256)&&W(t,"hidden",s[8]),B===(B=w(s))&&V?V.p(s,N):(V.d(1),V=B(s),V&&(V.c(),V.m(d,null))),(!E||N[0]&128&&u!==(u=s[35].intervals.map(wn).join("-")))&&p(d,"title",u),(!E||N[0]&128)&&v!==(v=s[35].name+"")&&ye(S,v)},i(L){E||(U(l.$$.fragment,L),E=!0)},o(L){z(l.$$.fragment,L),E=!1},d(L){L&&(_(e),_(i),_(d),_(g),_(m)),he(l),V.d(),O=!1,qe(T)}}}function Cr(s){let e,t=_e(s[35].intervals),n=[];for(let l=0;l<t.length;l+=1)n[l]=bn(fn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o[0]&64){t=_e(l[35].intervals);let r;for(r=0;r<t.length;r+=1){const a=fn(l,t,r);n[r]?n[r].p(a,o):(n[r]=bn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Tr(s){let e,t=_e(s[4][s[37]]),n=[];for(let l=0;l<t.length;l+=1)n[l]=yn(dn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o[0]&16){t=_e(l[4][l[37]]);let r;for(r=0;r<t.length;r+=1){const a=dn(l,t,r);n[r]?n[r].p(a,o):(n[r]=yn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function bn(s){let e,t=s[40].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&64&&t!==(t=l[40].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function yn(s){let e,t=s[9].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&16&&t!==(t=l[9].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function kn(s){let e,t,n,l,o,r,a=s[35].suffixes[0]+"",c,i,d,u,g,m,h,v=s[35].name+"",S,k,E,O,T;l=new Me({props:{icon:s[35].selected?hs:ms,width:12}});function G(){return s[27](s[35])}function w(L,N){return L[4][L[37]]&&L[4][L[37]].length>0?Tr:Cr}let B=w(s),V=B(s);function A(){return s[28](s[35])}return{c(){e=b("li"),t=b("button"),n=b("span"),ue(l.$$.fragment),o=P(),r=b("div"),c=ee(a),i=P(),d=b("li"),V.c(),g=P(),m=b("li"),h=b("button"),S=ee(v),k=P(),this.h()},l(L){e=y(L,"LI",{});var N=C(e);t=y(N,"BUTTON",{class:!0});var D=C(t);n=y(D,"SPAN",{class:!0});var I=C(n);fe(l.$$.fragment,I),I.forEach(_),o=j(D),r=y(D,"DIV",{class:!0});var M=C(r);c=te(M,a),M.forEach(_),D.forEach(_),N.forEach(_),i=j(L),d=y(L,"LI",{class:!0,title:!0});var $=C(d);V.l($),$.forEach(_),g=j(L),m=y(L,"LI",{class:!0});var x=C(m);h=y(x,"BUTTON",{class:!0});var Q=C(h);S=te(Q,v),Q.forEach(_),k=j(x),x.forEach(_),this.h()},h(){p(n,"class","px-1 py-1 rounded"),W(n,"text-green-500",s[35].selected),W(n,"text-gray-400",!s[35].selected),p(r,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),p(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),W(t,"hidden",s[8]),p(d,"class","intervals svelte-1rg0xw5"),p(d,"title",u=s[35].intervals.map(En).join("-")),p(h,"class","text-start"),p(m,"class","text-xs")},m(L,N){R(L,e,N),f(e,t),f(t,n),de(l,n,null),f(t,o),f(t,r),f(r,c),R(L,i,N),R(L,d,N),V.m(d,null),R(L,g,N),R(L,m,N),f(m,h),f(h,S),f(m,k),E=!0,O||(T=[Y(t,"click",G),Y(h,"click",A)],O=!0)},p(L,N){s=L;const D={};N[0]&64&&(D.icon=s[35].selected?hs:ms),l.$set(D),(!E||N[0]&64)&&W(n,"text-green-500",s[35].selected),(!E||N[0]&64)&&W(n,"text-gray-400",!s[35].selected),(!E||N[0]&64)&&a!==(a=s[35].suffixes[0]+"")&&ye(c,a),(!E||N[0]&256)&&W(t,"hidden",s[8]),B===(B=w(s))&&V?V.p(s,N):(V.d(1),V=B(s),V&&(V.c(),V.m(d,null))),(!E||N[0]&64&&u!==(u=s[35].intervals.map(En).join("-")))&&p(d,"title",u),(!E||N[0]&64)&&v!==(v=s[35].name+"")&&ye(S,v)},i(L){E||(U(l.$$.fragment,L),E=!0)},o(L){z(l.$$.fragment,L),E=!1},d(L){L&&(_(e),_(i),_(d),_(g),_(m)),he(l),V.d(),O=!1,qe(T)}}}function Ir(s){let e,t,n,l,o="Chords",r,a,c,i,d,u,g,m,h,v,S,k,E,O,T,G,w,B="Key",V,A,L,N,D="Scale",I,M,$,x,Q="Note",F,X,Z,K,J,H,me,pe,Re,ie;i=new Me({props:{icon:Ml,width:20}}),g=new Me({props:{icon:Rl,width:16}}),v=new Me({props:{icon:s[5]?Js:Ys,width:16}}),E=new Me({props:{icon:Jt,width:16}}),M=new vl({props:{id:"chords-scale",class:"bg-gray-100 w-48",containerClass:"input w-48",selected:s[1],options:s[10],onSelect:s[14]}});let ce=_e(s[7]),le=[];for(let q=0;q<ce.length;q+=1)le[q]=vn(hn(s,ce,q));const oe=q=>z(le[q],1,1,()=>{le[q]=null});let ge=_e(s[6]),ke=[];for(let q=0;q<ge.length;q+=1)ke[q]=kn(un(s,ge,q));const tt=q=>z(ke[q],1,1,()=>{ke[q]=null});return{c(){e=b("div"),t=b("fieldset"),n=b("legend"),l=b("button"),l.textContent=o,r=P(),a=b("div"),c=b("button"),ue(i.$$.fragment),d=P(),u=b("button"),ue(g.$$.fragment),m=P(),h=b("button"),ue(v.$$.fragment),S=P(),k=b("button"),ue(E.$$.fragment),O=P(),T=b("div"),G=b("div"),w=b("label"),w.textContent=B,V=P(),A=b("input"),L=P(),N=b("label"),N.textContent=D,I=P(),ue(M.$$.fragment),$=P(),x=b("label"),x.textContent=Q,F=P(),X=b("input"),Z=P(),K=b("ul");for(let q=0;q<le.length;q+=1)le[q].c();J=P(),H=b("ul");for(let q=0;q<ke.length;q+=1)ke[q].c();this.h()},l(q){e=y(q,"DIV",{class:!0});var re=C(e);t=y(re,"FIELDSET",{class:!0});var Ee=C(t);n=y(Ee,"LEGEND",{class:!0});var Ue=C(n);l=y(Ue,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1knqzl6"&&(l.textContent=o),Ue.forEach(_),r=j(Ee),a=y(Ee,"DIV",{class:!0});var ne=C(a);c=y(ne,"BUTTON",{class:!0});var We=C(c);fe(i.$$.fragment,We),We.forEach(_),d=j(ne),u=y(ne,"BUTTON",{class:!0});var je=C(u);fe(g.$$.fragment,je),je.forEach(_),m=j(ne),h=y(ne,"BUTTON",{class:!0});var ct=C(h);fe(v.$$.fragment,ct),ct.forEach(_),S=j(ne),k=y(ne,"BUTTON",{class:!0});var et=C(k);fe(E.$$.fragment,et),et.forEach(_),ne.forEach(_),O=j(Ee),T=y(Ee,"DIV",{class:!0});var Qe=C(T);G=y(Qe,"DIV",{class:!0});var Je=C(G);w=y(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(w)!=="svelte-4jiw22"&&(w.textContent=B),V=j(Je),A=y(Je,"INPUT",{class:!0,id:!0}),L=j(Je),N=y(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(N)!=="svelte-162gpi4"&&(N.textContent=D),I=j(Je),fe(M.$$.fragment,Je),$=j(Je),x=y(Je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(x)!=="svelte-nkwohg"&&(x.textContent=Q),F=j(Je),X=y(Je,"INPUT",{class:!0,id:!0}),Je.forEach(_),Z=j(Qe),K=y(Qe,"UL",{class:!0});var St=C(K);for(let $e=0;$e<le.length;$e+=1)le[$e].l(St);St.forEach(_),J=j(Qe),H=y(Qe,"UL",{class:!0});var ut=C(H);for(let $e=0;$e<ke.length;$e+=1)ke[$e].l(ut);ut.forEach(_),Qe.forEach(_),Ee.forEach(_),re.forEach(_),this.h()},h(){p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(c,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),W(c,"hidden",s[8]),p(u,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(u,"hidden",s[8]),p(h,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(h,"hidden",s[8]),p(k,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(k,"hidden",s[8]),p(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),p(w,"class","mr-4 font-bold svelte-1rg0xw5"),p(w,"for","chords-key"),p(A,"class","input bg-gray-100 w-12 px-1 rounded"),p(A,"id","chords-key"),A.value=s[0],p(N,"class","font-bold svelte-1rg0xw5"),p(N,"for","chords-scale"),p(x,"class","font-bold svelte-1rg0xw5"),p(x,"for","chords-note"),p(X,"class","input bg-gray-100 w-12 px-1 rounded"),p(X,"id","chords-note"),X.value=s[2],p(G,"class","flex mb-2 options svelte-1rg0xw5"),p(K,"class","chord-list w-full svelte-1rg0xw5"),p(H,"class","chord-list w-full svelte-1rg0xw5"),p(T,"class","body svelte-1rg0xw5"),W(T,"hidden",s[8]),p(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1rg0xw5"),W(t,"collapsed",s[8]),p(e,"class",me=Ae(`${s[22].class||""}`)+" svelte-1rg0xw5")},m(q,re){R(q,e,re),f(e,t),f(t,n),f(n,l),f(t,r),f(t,a),f(a,c),de(i,c,null),f(a,d),f(a,u),de(g,u,null),f(a,m),f(a,h),de(v,h,null),f(a,S),f(a,k),de(E,k,null),f(t,O),f(t,T),f(T,G),f(G,w),f(G,V),f(G,A),f(G,L),f(G,N),f(G,I),de(M,G,null),f(G,$),f(G,x),f(G,F),f(G,X),f(T,Z),f(T,K);for(let Ee=0;Ee<le.length;Ee+=1)le[Ee]&&le[Ee].m(K,null);f(T,J),f(T,H);for(let Ee=0;Ee<ke.length;Ee+=1)ke[Ee]&&ke[Ee].m(H,null);pe=!0,Re||(ie=[Y(l,"click",s[12]),Y(c,"click",s[17]),Y(u,"click",s[18]),Y(h,"click",s[19]),Y(k,"click",s[20]),Y(A,"input",s[13]),Y(X,"input",s[15])],Re=!0)},p(q,re){(!pe||re[0]&256)&&W(c,"hidden",q[8]),(!pe||re[0]&256)&&W(u,"hidden",q[8]);const Ee={};re[0]&32&&(Ee.icon=q[5]?Js:Ys),v.$set(Ee),(!pe||re[0]&256)&&W(h,"hidden",q[8]),(!pe||re[0]&256)&&W(k,"hidden",q[8]),(!pe||re[0]&1&&A.value!==q[0])&&(A.value=q[0]);const Ue={};if(re[0]&2&&(Ue.selected=q[1]),M.$set(Ue),(!pe||re[0]&4&&X.value!==q[2])&&(X.value=q[2]),re[0]&2163080){ce=_e(q[7]);let ne;for(ne=0;ne<ce.length;ne+=1){const We=hn(q,ce,ne);le[ne]?(le[ne].p(We,re),U(le[ne],1)):(le[ne]=vn(We),le[ne].c(),U(le[ne],1),le[ne].m(K,null))}for(Ke(),ne=ce.length;ne<le.length;ne+=1)oe(ne);xe()}if(re[0]&2163024){ge=_e(q[6]);let ne;for(ne=0;ne<ge.length;ne+=1){const We=un(q,ge,ne);ke[ne]?(ke[ne].p(We,re),U(ke[ne],1)):(ke[ne]=kn(We),ke[ne].c(),U(ke[ne],1),ke[ne].m(H,null))}for(Ke(),ne=ge.length;ne<ke.length;ne+=1)tt(ne);xe()}(!pe||re[0]&256)&&W(T,"hidden",q[8]),(!pe||re[0]&256)&&W(t,"collapsed",q[8]),(!pe||re[0]&4194304&&me!==(me=Ae(`${q[22].class||""}`)+" svelte-1rg0xw5"))&&p(e,"class",me)},i(q){if(!pe){U(i.$$.fragment,q),U(g.$$.fragment,q),U(v.$$.fragment,q),U(E.$$.fragment,q),U(M.$$.fragment,q);for(let re=0;re<ce.length;re+=1)U(le[re]);for(let re=0;re<ge.length;re+=1)U(ke[re]);pe=!0}},o(q){z(i.$$.fragment,q),z(g.$$.fragment,q),z(v.$$.fragment,q),z(E.$$.fragment,q),z(M.$$.fragment,q),le=le.filter(Boolean);for(let re=0;re<le.length;re+=1)z(le[re]);ke=ke.filter(Boolean);for(let re=0;re<ke.length;re+=1)z(ke[re]);pe=!1},d(q){q&&_(e),he(i),he(g),he(v),he(E),he(M),Oe(le,q),Oe(ke,q),Re=!1,qe(ie)}}}const wn=s=>s.interval,En=s=>s.interval;function Ar(s,e,t){let n,l,o,r,a,c,i,d,u;be(s,nt,K=>t(30,a=K)),be(s,st,K=>t(31,c=K)),be(s,Rt,K=>t(32,i=K)),be(s,Ks,K=>t(24,d=K));let g="C",m="Major",h=zt(g,m),v="",S,k=[],E=[];const T=vs().map(K=>({key:K.names[0],value:K.names[0]})),G=vt(Ve(!0),{key:"chords-hidden"});be(s,G,K=>t(8,u=K));function w(){G.update(K=>!K)}function B(){const K=S&&60+S.semitones;if("err"in h||!K)t(3,k=[]),t(4,E=[]);else{const J=h.data;t(3,k=l.map(H=>is(K,J,H.intervals))),t(4,E=o.map(H=>is(K,J,H.intervals)))}}function V({currentTarget:{value:K}}){t(0,g=`${K.charAt(0).toUpperCase()}${K.charAt(1).toLowerCase()}`),h=zt(g,m),B()}function A(K){var J;return t(1,m=(J=T.find(H=>K===H.key))==null?void 0:J.value),h=zt(g,m),B(),!1}function L({currentTarget:{value:K}}){t(2,v=`${K.charAt(0).toUpperCase()}${K.charAt(1).toLowerCase()}`),t(9,S=Us(v)),B()}function N(K){De.toggleChords(J=>J.name===K.name?!J.selected:J.selected)}function D(){const K=H=>H.suffixes[0]==="maj"||H.suffixes[0]==="m",J=d.filter(K).every(H=>H.selected);De.toggleChords(H=>K(H)?!J:H.selected)}function I(){const K=H=>H.suffixes[0]==="maj7"||H.suffixes[0]==="m7"||H.suffixes[0]==="7"||H.suffixes[0]==="dim7"||H.suffixes[0]==="aug7",J=d.filter(K).every(H=>H.selected);De.toggleChords(H=>K(H)?!J:H.selected)}function M(){De.toggleChords(K=>!r)}function $(){De.toggleChords(K=>!0)}function x(K){if("err"in h)return;const J=i[0].midi+((S==null?void 0:S.semitones)||0),H=is(J,h.data,K.intervals);c==null||c.playChord(H.map(me=>me.midi),a.fixedVelocity)}const Q=K=>N(K),F=K=>x(K),X=K=>N(K),Z=K=>x(K);return s.$$set=K=>{t(22,e=Te(Te({},e),Ne(K)))},s.$$.update=()=>{s.$$.dirty[0]&16777216&&t(23,n=d),s.$$.dirty[0]&8388608&&t(7,l=n.filter((K,J)=>J<n.length/2)),s.$$.dirty[0]&8388608&&t(6,o=n.filter((K,J)=>J>=n.length/2)),s.$$.dirty[0]&8388608&&t(5,r=n.every(K=>K.selected))},e=Ne(e),[g,m,v,k,E,r,o,l,u,S,T,G,w,V,A,L,N,D,I,M,$,x,e,n,d,Q,F,X,Z]}class Nr extends Fe{constructor(e){super(),He(this,e,Ar,Ir,ze,{},null,[-1,-1])}}function Cn(s,e,t){const n=s.slice();return n[12]=e[t],n}function Sr(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){R(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&_(e)}}}function Dr(s){let e,t,n="Played:",l,o=_e(s[2]),r=[];for(let a=0;a<o.length;a+=1)r[a]=Tn(Cn(s,o,a));return{c(){e=b("div"),t=b("span"),t.textContent=n,l=P();for(let a=0;a<r.length;a+=1)r[a].c()},l(a){e=y(a,"DIV",{});var c=C(e);t=y(c,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1g6xxhn"&&(t.textContent=n),l=j(c);for(let i=0;i<r.length;i+=1)r[i].l(c);c.forEach(_)},m(a,c){R(a,e,c),f(e,t),f(e,l);for(let i=0;i<r.length;i+=1)r[i]&&r[i].m(e,null)},p(a,c){if(c&4){o=_e(a[2]);let i;for(i=0;i<o.length;i+=1){const d=Cn(a,o,i);r[i]?r[i].p(d,c):(r[i]=Tn(d),r[i].c(),r[i].m(e,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=o.length}},i:ve,o:ve,d(a){a&&_(e),Oe(r,a)}}}function Lr(s){let e,t,n="Result:",l,o,r,a=s[0].correct+"",c,i,d=s[0].sampled.length+"",u,g,m,h,v,S=s[0].avgTime+"",k,E;return{c(){e=b("div"),t=b("span"),t.textContent=n,l=P(),o=b("span"),r=ee("["),c=ee(a),i=ee(" / "),u=ee(d),g=ee("]"),m=P(),h=b("span"),v=ee("avg "),k=ee(S),E=ee("s"),this.h()},l(O){e=y(O,"DIV",{class:!0});var T=C(e);t=y(T,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1eqfbgx"&&(t.textContent=n),l=j(T),o=y(T,"SPAN",{class:!0});var G=C(o);r=te(G,"["),c=te(G,a),i=te(G," / "),u=te(G,d),g=te(G,"]"),G.forEach(_),m=j(T),h=y(T,"SPAN",{});var w=C(h);v=te(w,"avg "),k=te(w,S),E=te(w,"s"),w.forEach(_),T.forEach(_),this.h()},h(){p(o,"class","mx-2"),p(e,"class","flex")},m(O,T){R(O,e,T),f(e,t),f(e,l),f(e,o),f(o,r),f(o,c),f(o,i),f(o,u),f(o,g),f(e,m),f(e,h),f(h,v),f(h,k),f(h,E)},p(O,T){T&1&&a!==(a=O[0].correct+"")&&ye(c,a),T&1&&d!==(d=O[0].sampled.length+"")&&ye(u,d),T&1&&S!==(S=O[0].avgTime+"")&&ye(k,S)},i:ve,o:ve,d(O){O&&_(e)}}}function Or(s){var L,N,D,I;let e,t,n="Target:",l,o,r=((L=s[0].latestGuess.target)==null?void 0:L.chord)+"",a,c,i,d=((N=s[0].latestGuess.target)==null?void 0:N.notes.map(In).join(" "))+"",u,g,m,h,v,S,k,E,O=((D=s[0].latestGuess.guessed)==null?void 0:D.chord)+"",T,G,w,B=((I=s[0].latestGuess.guessed)==null?void 0:I.notes.map(An).join(" "))+"",V,A;return v=new Me({props:{icon:s[1]==="correct"?Gt:Mt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=n,l=P(),o=b("span"),a=ee(r),c=P(),i=b("span"),u=ee(d),g=P(),m=b("span"),h=b("div"),ue(v.$$.fragment),S=ee(`
        Guessed:`),k=P(),E=b("span"),T=ee(O),G=P(),w=b("span"),V=ee(B),this.h()},l(M){e=y(M,"DIV",{class:!0});var $=C(e);t=y($,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1pddpsb"&&(t.textContent=n),l=j($),o=y($,"SPAN",{});var x=C(o);a=te(x,r),x.forEach(_),c=j($),i=y($,"SPAN",{});var Q=C(i);u=te(Q,d),Q.forEach(_),g=j($),m=y($,"SPAN",{class:!0});var F=C(m);h=y(F,"DIV",{class:!0});var X=C(h);fe(v.$$.fragment,X),X.forEach(_),S=te(F,`
        Guessed:`),F.forEach(_),k=j($),E=y($,"SPAN",{});var Z=C(E);T=te(Z,O),Z.forEach(_),G=j($),w=y($,"SPAN",{});var K=C(w);V=te(K,B),K.forEach(_),$.forEach(_),this.h()},h(){p(h,"class","absolute left-[-2rem] p-1"),p(m,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(M,$){R(M,e,$),f(e,t),f(e,l),f(e,o),f(o,a),f(e,c),f(e,i),f(i,u),f(e,g),f(e,m),f(m,h),de(v,h,null),f(m,S),f(e,k),f(e,E),f(E,T),f(e,G),f(e,w),f(w,V),A=!0},p(M,$){var Q,F,X,Z;(!A||$&1)&&r!==(r=((Q=M[0].latestGuess.target)==null?void 0:Q.chord)+"")&&ye(a,r),(!A||$&1)&&d!==(d=((F=M[0].latestGuess.target)==null?void 0:F.notes.map(In).join(" "))+"")&&ye(u,d);const x={};$&2&&(x.icon=M[1]==="correct"?Gt:Mt),v.$set(x),(!A||$&1)&&O!==(O=((X=M[0].latestGuess.guessed)==null?void 0:X.chord)+"")&&ye(T,O),(!A||$&1)&&B!==(B=((Z=M[0].latestGuess.guessed)==null?void 0:Z.notes.map(An).join(" "))+"")&&ye(V,B)},i(M){A||(U(v.$$.fragment,M),A=!0)},o(M){z(v.$$.fragment,M),A=!1},d(M){M&&_(e),he(v)}}}function Vr(s){let e,t,n="Target:",l,o,r=s[0].latestGuess.target+"",a,c,i,d,u,g,m,h,v,S,k=s[0].latestGuess.guessed+"",E,O,T,G;return m=new Me({props:{icon:s[1]==="correct"?Gt:Mt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=n,l=P(),o=b("span"),a=ee(r),c=P(),i=b("span"),d=P(),u=b("span"),g=b("div"),ue(m.$$.fragment),h=ee(`
        Guessed:`),v=P(),S=b("span"),E=ee(k),O=P(),T=b("span"),this.h()},l(w){e=y(w,"DIV",{class:!0});var B=C(e);t=y(B,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=n),l=j(B),o=y(B,"SPAN",{});var V=C(o);a=te(V,r),V.forEach(_),c=j(B),i=y(B,"SPAN",{}),C(i).forEach(_),d=j(B),u=y(B,"SPAN",{class:!0});var A=C(u);g=y(A,"DIV",{class:!0});var L=C(g);fe(m.$$.fragment,L),L.forEach(_),h=te(A,`
        Guessed:`),A.forEach(_),v=j(B),S=y(B,"SPAN",{});var N=C(S);E=te(N,k),N.forEach(_),O=j(B),T=y(B,"SPAN",{}),C(T).forEach(_),B.forEach(_),this.h()},h(){p(g,"class","absolute left-[-2rem] p-1"),p(u,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(w,B){R(w,e,B),f(e,t),f(e,l),f(e,o),f(o,a),f(e,c),f(e,i),f(e,d),f(e,u),f(u,g),de(m,g,null),f(u,h),f(e,v),f(e,S),f(S,E),f(e,O),f(e,T),G=!0},p(w,B){(!G||B&1)&&r!==(r=w[0].latestGuess.target+"")&&ye(a,r);const V={};B&2&&(V.icon=w[1]==="correct"?Gt:Mt),m.$set(V),(!G||B&1)&&k!==(k=w[0].latestGuess.guessed+"")&&ye(E,k)},i(w){G||(U(m.$$.fragment,w),G=!0)},o(w){z(m.$$.fragment,w),G=!1},d(w){w&&_(e),he(m)}}}function Pr(s){let e,t,n="Target:",l,o,r=s[8](s[0].latestGuess.target||0)+"",a,c,i,d,u,g,m,h,v,S,k=s[8](s[0].latestGuess.guessed||0)+"",E,O,T,G="",w;return m=new Me({props:{icon:s[1]==="correct"?Gt:Mt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=n,l=P(),o=b("span"),a=ee(r),c=P(),i=b("span"),d=P(),u=b("span"),g=b("div"),ue(m.$$.fragment),h=ee(`
        Guessed:`),v=P(),S=b("span"),E=ee(k),O=P(),T=b("span"),T.innerHTML=G,this.h()},l(B){e=y(B,"DIV",{class:!0});var V=C(e);t=y(V,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=n),l=j(V),o=y(V,"SPAN",{});var A=C(o);a=te(A,r),A.forEach(_),c=j(V),i=y(V,"SPAN",{}),C(i).forEach(_),d=j(V),u=y(V,"SPAN",{class:!0});var L=C(u);g=y(L,"DIV",{class:!0});var N=C(g);fe(m.$$.fragment,N),N.forEach(_),h=te(L,`
        Guessed:`),L.forEach(_),v=j(V),S=y(V,"SPAN",{});var D=C(S);E=te(D,k),D.forEach(_),O=j(V),T=y(V,"SPAN",{"data-svelte-h":!0}),ae(T)!=="svelte-1qufua2"&&(T.innerHTML=G),V.forEach(_),this.h()},h(){p(g,"class","absolute left-[-2rem] p-1"),p(u,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(B,V){R(B,e,V),f(e,t),f(e,l),f(e,o),f(o,a),f(e,c),f(e,i),f(e,d),f(e,u),f(u,g),de(m,g,null),f(u,h),f(e,v),f(e,S),f(S,E),f(e,O),f(e,T),w=!0},p(B,V){(!w||V&1)&&r!==(r=B[8](B[0].latestGuess.target||0)+"")&&ye(a,r);const A={};V&2&&(A.icon=B[1]==="correct"?Gt:Mt),m.$set(A),(!w||V&1)&&k!==(k=B[8](B[0].latestGuess.guessed||0)+"")&&ye(E,k)},i(B){w||(U(m.$$.fragment,B),w=!0)},o(B){z(m.$$.fragment,B),w=!1},d(B){B&&_(e),he(m)}}}function Tn(s){let e,t=ht(s[12])+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","mx-1")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o&4&&t!==(t=ht(l[12])+"")&&ye(n,t)},d(l){l&&_(e)}}}function jr(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){R(t,e,n)},p:ve,d(t){t&&_(e)}}}function Br(s){let e,t="Next",n,l,o="Autoplay",r,a;return{c(){e=b("button"),e.textContent=t,n=P(),l=b("button"),l.textContent=o,this.h()},l(c){e=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-uy473n"&&(e.textContent=t),n=j(c),l=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1cfj1sl"&&(l.textContent=o),this.h()},h(){p(e,"class","btn primary mr-1"),p(l,"class","btn primary")},m(c,i){R(c,e,i),R(c,n,i),R(c,l,i),r||(a=[Y(e,"click",s[4]),Y(l,"click",s[5])],r=!0)},p:ve,d(c){c&&(_(e),_(n),_(l)),r=!1,qe(a)}}}function Gr(s){let e,t="Stop autoplay",n,l;return{c(){e=b("button"),e.textContent=t,this.h()},l(o){e=y(o,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){p(e,"class","btn primary")},m(o,r){R(o,e,r),n||(l=Y(e,"click",s[10]),n=!0)},p:ve,d(o){o&&_(e),n=!1,l()}}}function Mr(s){let e,t="Try Again",n,l,o="Clear",r,a;return{c(){e=b("button"),e.textContent=t,n=P(),l=b("button"),l.textContent=o,this.h()},l(c){e=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-15zs1cu"&&(e.textContent=t),n=j(c),l=y(c,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-11mnk9v"&&(l.textContent=o),this.h()},h(){p(e,"class","btn primary mr-1"),p(l,"class","btn primary")},m(c,i){R(c,e,i),R(c,n,i),R(c,l,i),r||(a=[Y(e,"click",s[6]),Y(l,"click",s[7])],r=!0)},p:ve,d(c){c&&(_(e),_(n),_(l)),r=!1,qe(a)}}}function Rr(s){let e,t,n,l,o,r,a;const c=[Pr,Vr,Or,Lr,Dr,Sr],i=[];function d(h,v){return h[0]instanceof Pt&&(h[1]==="correct"||h[1]==="wrong")?0:h[0]instanceof qt&&(h[1]==="correct"||h[1]==="wrong")?1:h[0]instanceof _t&&(h[1]==="correct"||h[1]==="wrong")?2:h[0]&&h[1]==="ended"?3:h[2].length>0?4:5}t=d(s),n=i[t]=c[t](s);function u(h,v){return h[0]&&h[1]==="ended"?Mr:h[0]&&h[3].autoplay?Gr:h[0]?Br:jr}let g=u(s),m=g(s);return{c(){e=b("div"),n.c(),o=P(),r=b("div"),m.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var v=C(e);n.l(v),v.forEach(_),o=j(h),r=y(h,"DIV",{class:!0});var S=C(r);m.l(S),S.forEach(_),this.h()},h(){p(e,"class",l=Ae(`${s[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),p(r,"class","mt-2 h-8 flex items-center")},m(h,v){R(h,e,v),i[t].m(e,null),R(h,o,v),R(h,r,v),m.m(r,null),a=!0},p(h,[v]){let S=t;t=d(h),t===S?i[t].p(h,v):(Ke(),z(i[S],1,1,()=>{i[S]=null}),xe(),n=i[t],n?n.p(h,v):(n=i[t]=c[t](h),n.c()),U(n,1),n.m(e,null)),(!a||v&512&&l!==(l=Ae(`${h[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"))&&p(e,"class",l),g===(g=u(h))&&m?m.p(h,v):(m.d(1),m=g(h),m&&(m.c(),m.m(r,null)))},i(h){a||(U(n),a=!0)},o(h){z(n),a=!1},d(h){h&&(_(e),_(o),_(r)),i[t].d(),m.d()}}}const In=s=>s.note,An=s=>s.note;function Ur(s,e,t){let n,l,o,r;be(s,gt,h=>t(11,n=h)),be(s,mt,h=>t(1,l=h)),be(s,wt,h=>t(2,o=h)),be(s,pt,h=>t(3,r=h));let{game:a}=e;function c(){De.nextGuess()}function i(){De.setOptionValue("autoplay",!0),De.nextGuess()}function d(){a instanceof _t?De.play(a.type,a.opts):a&&De.play(a.type,void 0)}function u(){De.clearGame()}function g(h){const v=n.notesMap.get(h%12);return ht({midi:h,...v})}const m=()=>De.setOptionValue("autoplay",!1);return s.$$set=h=>{t(9,e=Te(Te({},e),Ne(h))),"game"in h&&t(0,a=h.game)},e=Ne(e),[a,l,o,r,c,i,d,u,g,e,m]}class $r extends Fe{constructor(e){super(),He(this,e,Ur,Rr,ze,{game:0})}}function Kr(s){let e,t,n,l=[{type:"checkbox"},s[2]],o={};for(let r=0;r<l.length;r+=1)o=Te(o,l[r]);return{c(){e=b("input"),this.h()},l(r){e=y(r,"INPUT",{type:!0}),this.h()},h(){jt(e,o),W(e,"svelte-mzrxuq",!0)},m(r,a){R(r,e,a),e.autofocus&&e.focus(),s[5](e),t||(n=[Y(e,"change",s[3]),Y(e,"input",s[4]),Y(e,"keydown",s[1])],t=!0)},p(r,[a]){jt(e,o=js(l,[{type:"checkbox"},a&4&&r[2]])),W(e,"svelte-mzrxuq",!0)},i:ve,o:ve,d(r){r&&_(e),s[5](null),t=!1,qe(n)}}}function xr(s,e,t){let n;function l(c){c.key==="Enter"&&n.click()}function o(c){Bt.call(this,s,c)}function r(c){Bt.call(this,s,c)}function a(c){gs[c?"unshift":"push"](()=>{n=c,t(0,n)})}return s.$$set=c=>{t(2,e=Te(Te({},e),Ne(c)))},e=Ne(e),[n,l,e,o,r,a]}class Nt extends Fe{constructor(e){super(),He(this,e,xr,Kr,ze,{})}}const Vs={ar:{name:"Arabic",import:Ie(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:Ie(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:Ie(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:Ie(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:Ie(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:Ie(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:Ie(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:Ie(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:Ie(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>Hr)},fa:{name:"Farsi",import:Ie(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:Ie(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:Ie(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:Ie(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:Ie(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:Ie(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:Ie(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:Ie(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:Ie(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:Ie(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:Ie(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:Ie(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:Ie(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:Ie(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:Ie(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:Ie(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:Ie(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:Ie(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:Ie(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:Ie(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:Ie(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:Ie(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:Ie(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:Ie(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function Cl(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default.slice(0,4)}}async function Fr(s=["en"]){let e={code:"en",layout:Vs.en,index:99};Object.entries(Vs).forEach(([n,l])=>{for(let o=0;o<s.length;o+=1)n===s[o]&&(!e||e.index>o)&&(e={code:n,layout:l,index:o})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:Cl(t.default)}}const Tl={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},Hr=Object.freeze(Object.defineProperty({__proto__:null,default:Tl},Symbol.toStringTag,{value:"Module"})),Il=[0,2,4,5,7,9,11],Al=[1,3,-1,6,8,10,-1];function zr(s,e,t){const n=s.keyType==="white"?Il:Al,l=n[t%n.length];let o;if(l>=0){o=e[l];const r=Math.floor(t/n.length);return{...o,semitones:o.semitones+(r>0?r:0)*12}}}function Vt(s,e,t=0,n=0){const l=s.keyType==="white"?Il:Al;let o=-1,r=0,a=0;return s.keys.forEach((c,i)=>{if(c.key.charAt(0)!=="{"&&i>=t&&o===-1?o=i:o!==-1&&c.key==="{empty}"&&(r+=1),o!==-1&&c.key.charAt(0)!=="{"){const d=i-r-o+n,u=l[d%l.length];if(u>=0){const g=e[u],m=Math.floor(d/l.length);c.note={...g,semitones:g.semitones+(m>0?m:0)*12},a=i-o}}}),{firstIndex:o,lastIndex:a}}const Nl=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function qr(s,e){let t=[];const n=s.default.map((r,a)=>{if(a===0){const c=r.split(" ").filter(i=>i!=="{bksp}");for(;c.length!==13;)c.length<13?c.unshift("{empty}"):c.shift();return[...c,"{bksp}"]}else if(a===1){const c=r.split(" ");return t=c.slice(13),[...c.slice(0,13),"{enter}"]}else{if(a===2)return[...r.split(" ").slice(0,13).filter(c=>c!=="{enter}"),...t].slice(0,13);if(a===3){const c=["{shift}",...r.split(" ").slice(1,12).filter(d=>d!=="{shift}"),"{shift}"];let i=1;for(;c.length<13;)c.splice(i,0,"{empty}"),i=i===1?-1:1;return c}else return r.split(" ")}});let l;s.codes?l=s.codes.map(r=>r.split(" ")):l=Nl;const o=[0,1,2,3].map(r=>n[r].map((a,c)=>({key:a,code:l[r][c]})));return[{keyType:e==="two-rows"?"black":null,startNoteOffset:2,availableNotes:11,keys:o[0]},{keyType:e==="two-rows"?"white":"black",startNoteOffset:e==="two-rows"?1:2,availableNotes:12,keys:o[1]},{keyType:e==="two-rows"?"black":"white",startNoteOffset:1,availableNotes:12,keys:o[2]},{keyType:e==="two-rows"?"white":null,startNoteOffset:1,availableNotes:11,keys:o[3]}]}const Nn=[{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]}];class Sl{constructor(e){return this.rows=Nn,this.setCustomRow={row:Nn[0],rowIndex:0,nextKeyIdx:-1,nextNoteOffset:0},this.opts={hotkeydRows:"middle-row",isCustom:!1,layout:{code:"en",name:"English",imported:Cl(Tl)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=qr(e,this.opts.hotkeydRows),this}setRows(e){return this.rows=e,this}setNotes(e){if(this.opts.hotkeydRows==="middle-row"){const{firstIndex:t}=Vt(this.rows[2],e);Vt(this.rows[1],e,1+t)}else{const{firstIndex:t,lastIndex:n}=Vt(this.rows[3],e);Vt(this.rows[2],e,t);const{firstIndex:l}=Vt(this.rows[1],e,0,n+1);Vt(this.rows[0],e,1+l,n+1)}}startSetCustomRow(e){const t={...this.rows[e],keys:this.rows[e].keys.map(a=>({...a}))},{availableNotes:n,startNoteOffset:l}=t,o=this.opts.hotkeydRows==="two-rows"&&(e===0||e===1)?3:-1,r=o!==-1?this.rows[o].keys.reduce((a,c)=>(a===-1&&c.note?a=0:a!==-1&&(c.key[0]!=="{"||c.key==="{empty}")&&(a+=1),a),-1)+1:0;return this.setCustomRow={row:t,rowIndex:e,nextKeyIdx:l,nextNoteOffset:r},{first:l,count:n}}setNextCustomNote(e,t,n){let l;const{nextKeyIdx:o,nextNoteOffset:r,row:a}=this.setCustomRow,c=o+r-a.startNoteOffset,i=zr(a,n,c);return i?l={key:e,code:t,note:i}:l={key:e,code:t},this.setCustomRow.nextKeyIdx+=1,{index:this.setCustomRow.nextKeyIdx,key:l}}skipNextCustomNote(){return this.setCustomRow.nextKeyIdx+=1,this.setCustomRow.nextNoteOffset-=1,{index:this.setCustomRow.nextKeyIdx,key:{code:"EMPTY",key:"{empty}"}}}}function Wr(s){const e=[...s.map(l=>l.keys.map(o=>o.key).join(" "))],t=["","","",""];let n=!1;return s.forEach((l,o)=>{const r=[];for(let a=0;a<l.keys.length;a+=1)r.push(l.keys[a].code),n=n||l.keys[a].code!==Nl[o][a];t[o]=r.join(" ")}),n?{default:e,codes:t}:{default:e}}function Sn(s,e,t){const n=s.slice();return n[15]=e[t].key,n[16]=e[t].value,n[17]=e[t].icon,n[19]=t,n}const Jr=s=>({}),Dn=s=>({}),Yr=s=>({}),Ln=s=>({});function On(s){let e,t,n,l,o,r,a,c,i,d,u;const g=s[12].header,m=Bs(g,s,s[11],Dn);let h=_e(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=Vn(Sn(s,h,k));const S=k=>z(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),n=P(),l=b("ul"),o=b("li"),m&&m.c(),r=P();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(_),n=j(k),l=y(k,"UL",{class:!0});var E=C(l);o=y(E,"LI",{});var O=C(o);m&&m.l(O),O.forEach(_),r=j(E);for(let T=0;T<v.length;T+=1)v[T].l(E);E.forEach(_),this.h()},h(){p(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),p(e,"tabindex","-1"),p(l,"class",a=Ae(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,E){R(k,e,E),R(k,n,E),R(k,l,E),f(l,o),m&&m.m(o,null),f(l,r);for(let O=0;O<v.length;O+=1)v[O]&&v[O].m(l,null);i=!0,d||(u=Y(e,"click",s[7]),d=!0)},p(k,E){if(s=k,m&&m.p&&(!i||E&2048)&&Gs(m,g,s,s[11],i?Rs(g,s[11],E,Jr):Ms(s[11]),Dn),E&265){h=_e(s[0]);let O;for(O=0;O<h.length;O+=1){const T=Sn(s,h,O);v[O]?(v[O].p(T,E),U(v[O],1)):(v[O]=Vn(T),v[O].c(),U(v[O],1),v[O].m(l,null))}for(Ke(),O=h.length;O<v.length;O+=1)S(O);xe()}(!i||E&4&&a!==(a=Ae(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&p(l,"class",a)},i(k){if(!i){k&&cs(()=>{i&&(t||(t=Ct(e,us,{duration:as},!0)),t.run(1))}),U(m,k);for(let E=0;E<h.length;E+=1)U(v[E]);k&&cs(()=>{i&&(c||(c=Ct(l,fs,{duration:as},!0)),c.run(1))}),i=!0}},o(k){k&&(t||(t=Ct(e,us,{duration:as},!1)),t.run(0)),z(m,k),v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)z(v[E]);k&&(c||(c=Ct(l,fs,{duration:as},!1)),c.run(0)),i=!1},d(k){k&&(_(e),_(n),_(l)),k&&t&&t.end(),m&&m.d(k),Oe(v,k),k&&c&&c.end(),d=!1,u()}}}function Qr(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","w-[24px]")},m(t,n){R(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&_(e)}}}function Xr(s){let e,t;return e=new Me({props:{class:"mr-2",icon:s[17],width:16}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p(n,l){const o={};l&1&&(o.icon=n[17]),e.$set(o)},i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function Vn(s){let e,t,n,l,o,r,a=s[16]+"",c,i,d,u,g;const m=[Xr,Qr],h=[];function v(k,E){return k[17]?0:1}n=v(s),l=h[n]=m[n](s);function S(){return s[13](s[15])}return{c(){e=b("li"),t=b("button"),l.c(),o=P(),r=b("div"),c=ee(a),i=P(),this.h()},l(k){e=y(k,"LI",{});var E=C(e);t=y(E,"BUTTON",{class:!0});var O=C(t);l.l(O),o=j(O),r=y(O,"DIV",{});var T=C(r);c=te(T,a),T.forEach(_),O.forEach(_),i=j(E),E.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),W(t,"selected",s[15]===s[3])},m(k,E){R(k,e,E),f(e,t),h[n].m(t,null),f(t,o),f(t,r),f(r,c),f(e,i),d=!0,u||(g=Y(t,"click",S),u=!0)},p(k,E){s=k;let O=n;n=v(s),n===O?h[n].p(s,E):(Ke(),z(h[O],1,1,()=>{h[O]=null}),xe(),l=h[n],l?l.p(s,E):(l=h[n]=m[n](s),l.c()),U(l,1),l.m(t,o)),(!d||E&1)&&a!==(a=s[16]+"")&&ye(c,a),(!d||E&9)&&W(t,"selected",s[15]===s[3])},i(k){d||(U(l),d=!0)},o(k){z(l),d=!1},d(k){k&&_(e),h[n].d(),u=!1,g()}}}function Zr(s){let e,t,n,l,o,r,a,c,i;const d=s[12].value,u=Bs(d,s,s[11],Ln);let g=s[6]&&On(s);return{c(){e=b("div"),t=b("button"),u&&u.c(),o=P(),g&&g.c(),this.h()},l(m){e=y(m,"DIV",{class:!0,id:!0});var h=C(e);t=y(h,"BUTTON",{class:!0,title:!0});var v=C(t);u&&u.l(v),v.forEach(_),o=j(h),g&&g.l(h),h.forEach(_),this.h()},h(){p(t,"class",n=Ae(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),p(t,"title",l=s[9].title||""),W(t,"disabled",s[4]),W(t,"open",s[6]),p(e,"class",r=Ae(`relative ${s[2]||""}`)+" svelte-h65upg"),p(e,"id",s[1])},m(m,h){R(m,e,h),f(e,t),u&&u.m(t,null),f(e,o),g&&g.m(e,null),s[14](e),a=!0,c||(i=Y(t,"click",s[7]),c=!0)},p(m,[h]){u&&u.p&&(!a||h&2048)&&Gs(u,d,m,m[11],a?Rs(d,m[11],h,Yr):Ms(m[11]),Ln),(!a||h&512&&n!==(n=Ae(`${m[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&p(t,"class",n),(!a||h&512&&l!==(l=m[9].title||""))&&p(t,"title",l),(!a||h&528)&&W(t,"disabled",m[4]),(!a||h&576)&&W(t,"open",m[6]),m[6]?g?(g.p(m,h),h&64&&U(g,1)):(g=On(m),g.c(),U(g,1),g.m(e,null)):g&&(Ke(),z(g,1,1,()=>{g=null}),xe()),(!a||h&4&&r!==(r=Ae(`relative ${m[2]||""}`)+" svelte-h65upg"))&&p(e,"class",r),(!a||h&2)&&p(e,"id",m[1])},i(m){a||(U(u,m),U(g),a=!0)},o(m){z(u,m),z(g),a=!1},d(m){m&&_(e),u&&u.d(m),g&&g.d(),s[14](null),c=!1,i()}}}const as=400;function eo(s,e,t){let{$$slots:n={},$$scope:l}=e,{options:o,id:r=void 0,containerClass:a=void 0,selected:c=void 0,disabled:i=void 0,onSelect:d}=e,u,g=!1;function m(){i||t(6,g=!g)}function h(k){t(6,g=d(k))}const v=k=>h(k);function S(k){gs[k?"unshift":"push"](()=>{u=k,t(5,u)})}return s.$$set=k=>{t(9,e=Te(Te({},e),Ne(k))),"options"in k&&t(0,o=k.options),"id"in k&&t(1,r=k.id),"containerClass"in k&&t(2,a=k.containerClass),"selected"in k&&t(3,c=k.selected),"disabled"in k&&t(4,i=k.disabled),"onSelect"in k&&t(10,d=k.onSelect),"$$scope"in k&&t(11,l=k.$$scope)},e=Ne(e),[o,r,a,c,i,u,g,m,h,e,d,l,n,v,S]}class to extends Fe{constructor(e){super(),He(this,e,eo,Zr,ze,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function so(s){let e,t,n,l,o,r,a,c=[s[2],{type:"checkbox"}],i={};for(let d=0;d<c.length;d+=1)i=Te(i,c[d]);return{c(){e=b("label"),t=b("input"),n=P(),l=b("div"),this.h()},l(d){e=y(d,"LABEL",{class:!0});var u=C(e);t=y(u,"INPUT",{type:!0}),n=j(u),l=y(u,"DIV",{class:!0}),C(l).forEach(_),u.forEach(_),this.h()},h(){jt(t,i),W(t,"svelte-k5zciy",!0),p(l,"class","slider svelte-k5zciy"),p(e,"class",o=Ae(`${s[2].containerClass||""} toggle`)+" svelte-k5zciy")},m(d,u){R(d,e,u),f(e,t),t.autofocus&&t.focus(),s[4](t),f(e,n),f(e,l),r||(a=[Y(t,"change",s[3]),Y(t,"keydown",s[1])],r=!0)},p(d,[u]){jt(t,i=js(c,[u&4&&d[2],{type:"checkbox"}])),W(t,"svelte-k5zciy",!0),u&4&&o!==(o=Ae(`${d[2].containerClass||""} toggle`)+" svelte-k5zciy")&&p(e,"class",o)},i:ve,o:ve,d(d){d&&_(e),s[4](null),r=!1,qe(a)}}}function no(s,e,t){let n;function l(a){a.key==="Enter"&&n.click()}function o(a){Bt.call(this,s,a)}function r(a){gs[a?"unshift":"push"](()=>{n=a,t(0,n)})}return s.$$set=a=>{t(2,e=Te(Te({},e),Ne(a)))},e=Ne(e),[n,l,e,o,r]}class lo extends Fe{constructor(e){super(),He(this,e,no,so,ze,{})}}function ro(s,e,t){return e==="Escape"?{e:"hotkeys-cancel"}:e==="Space"?{e:"hotkeys-skip-key"}:s.has(e)?{e:"hotkeys-no-key"}:(s.add(e),{e:"hotkeys-captured-key",data:{code:e,key:t}})}const xs=/^[a-gA-G]$/,Dl=/^[♭Bb#♯sS]$/,oo=/^[0-9]$/;let se="",Ye;function ao(s,e){const{useHotkeys:t}=Ce(nt),n=Ce(Ol).get(s);if(t&&se.length===0&&n&&n.note)return se="",{e:"guessed-key",data:n.note.note};if(!t&&se.length===0&&xs.test(e))return se+=e.toUpperCase(),{e:"string",data:se};if(!t&&se.length>0&&Dl.test(e))return e==="b"||e==="B"?se+="♭":se+="♯",{e:"string",data:se};if(s==="Backspace"&&se.length>0)return se=se.slice(0,-1),{e:"string",data:se};if(s==="Enter"&&se.length>0){const l=se;return se="",{e:"guessed-key",data:l}}return!1}function io(s,e){if(s==="Enter"&&se.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let n=0;n<se.length;n+=1)n===0?t.note+=se[n]:t.chord.length>0?t.chord+=se[n].toLowerCase():se[n]==="♭"?(t.note+=se[n],t.flats+=1):se[n]==="♯"?(t.note+=se[n],t.sharps+=1):t.chord+=se[n].toLowerCase();return se="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&se.length>0)return se=se.slice(0,-1),{e:"string",data:se};if(se.length===0&&xs.test(e))return se+=e.toUpperCase(),{e:"string",data:se};if(se.length>0&&e.length===1)return se.length===1&&(e==="b"||e==="B")?se+="♭":se.length===1&&e==="#"?se+="♯":se+=e,{e:"string",data:se}}return!1}function co(s,e,t){const{useAutoOctave:n,useHotkeys:l}=Ce(nt);let o;const a=Ce(Ol).get(s),c=(a==null?void 0:a.key)||"";let i=!1;if(!Ye&&l&&(a!=null&&a.note)?(Ye=a.note,n&&(o=_s({midi:Ce(Rt)[0].midi,flats:0,sharps:0})),i="note"):!l&&se.length===0&&xs.test(e)?(se+=e.toUpperCase(),i="input"):!l&&se.length>0&&Dl.test(e)?(e==="b"||e==="B"?se+="♭":se+="♯",i="input"):!l&&se.length>0&&s==="Enter"&&n&&(o=_s({midi:Ce(Rt)[0].midi,flats:0,sharps:0}),i="octave"),!i&&oo.test(c))try{o=parseInt(c),i="octave"}catch{}if(i&&(Ye||se)&&o!==void 0){const d=(Ye==null?void 0:Ye.note)??se;return t&&(o+=1),Ye&&(Ye==null?void 0:Ye.semitones)>=12&&(o+=Math.floor(Ye.semitones/12)),Ye=void 0,se="",{e:"guessed-note",data:{note:d,octave:o}}}else if(s==="Backspace"&&(Ye||se.length>0))return Ye=void 0,se=se.slice(0,-1),{e:"string",data:se};return i==="note"?{e:"note",data:Ye}:i==="input"?{e:"string",data:se}:!1}const Fs={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}"]}},Ht=new Set,Ll=new Sl({layout:Fs}),dt=Ve(void 0);Wt(dt,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const Et=vt(Ve({isCustom:!1,layout:Fs,hotkeydRows:"middle-row"}),{key:"keyboard-options"}),Ut=Ve(Ll.rows),It=Ve(Ll);gt.subscribe(s=>{const e=Ce(It);e.setNotes(Array.from(s.notesMap.values())),Ut.set(e.rows),It.set(e)});Et.subscribe(s=>{const e=new Sl(s),t=Ce(gt);e.setNotes(Array.from(t.notesMap.values())),Ut.set(e.rows),It.set(e)});const Ol=Wt(It,s=>new Map(s.rows.flatMap(e=>e.keys.map(t=>[t.code,t])))),uo=Wt(It,s=>s.rows.flatMap(e=>e.keys).map(e=>e.note).filter(e=>e!==void 0).sort((e,t)=>e.semitones-t.semitones)),it={async setLayout(s){const e=await Fr(s),t=Ce(Et);e.code!==t.layout.code&&Et.update(n=>({...n,isCustom:!1,layout:e}))},async setCustomLayout(s){s?Et.update(e=>({...e,isCustom:s,layout:{code:"custom",name:"Custom",imported:e.layout.imported}})):this.setLayout(navigator.languages)},toggleRows(s){Et.update(e=>({...e,hotkeydRows:s??(e.hotkeydRows==="middle-row"?"two-rows":"middle-row")}))},captureHotkeyRow(s){const e=Ce(It),t=Ce(gt),{first:n,count:l}=e.startSetCustomRow(s);dt.set({nextIndex:n,rowIndex:s,count:l,scaleNotes:Array.from(t.notesMap.values())})},findNote(s){return Ce(uo).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((n,l)=>n+(l.toLowerCase()==="b"||l==="♭"?-1:l.toLowerCase()==="s"||l==="#"||l==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleHotkeyInput(s,e,t){const n=ro(Ht,e,t),l=Ce(It);let o;const r=l.setCustomRow.nextKeyIdx;n.e==="hotkeys-cancel"?(dt.set(void 0),Ht.clear()):n.e==="hotkeys-skip-key"?o=l.skipNextCustomNote():n.e==="hotkeys-captured-key"&&(o=l.setNextCustomNote(n.data.key,n.data.code,s.scaleNotes));const a=Ce(Ut);if(o&&(a[s.rowIndex].keys[r]=o.key,Ut.set(a),dt.update(c=>c?{...c,nextIndex:o.index}:void 0)),s.count===r){const c=Wr(a);Et.update(i=>({...i,layout:{...i.layout,imported:c}})),dt.set(void 0),Ht.clear()}return n},handleInput(s,e,t=!1){const n=Ce(Tt),l=Ce(dt);return l?this.handleHotkeyInput(l,s,e):n instanceof qt?ao(s,e.toUpperCase()):n instanceof _t&&n.type==="chords-write"?io(s,e):Ce(nt).useKeyboard?co(s,e.toUpperCase(),t):!1},cancelCapture(){dt.set(void 0),Ht.clear()},reset(){Et.set({isCustom:!1,layout:Fs,hotkeydRows:"middle-row"}),dt.set(void 0),Ht.clear()}};function Pn(s){let e;return{c(){e=b("li"),this.h()},l(t){e=y(t,"LI",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","m-[0.175rem] mr-0")},m(t,n){R(t,e,n)},d(t){t&&_(e)}}}function jn(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,n){R(t,e,n)},d(t){t&&_(e)}}}function Bn(s){let e,t=s[0].note.note+"",n,l;return{c(){e=b("div"),n=ee(t),l=ee(s[3]),this.h()},l(o){e=y(o,"DIV",{class:!0});var r=C(e);n=te(r,t),l=te(r,s[3]),r.forEach(_),this.h()},h(){p(e,"class","absolute top-0 left-0")},m(o,r){R(o,e,r),f(e,n),f(e,l)},p(o,r){r&1&&t!==(t=o[0].note.note+"")&&ye(n,t),r&8&&ye(l,o[3])},d(o){o&&_(e)}}}function fo(s){let e,t,n,l,o,r,a=Mn(s[0].key)+"",c,i,d,u,g=s[0].key==="{enter}"&&Pn(),m=s[0].key==="{enter}"&&jn(),h=s[0].note&&Bn(s);return{c(){g&&g.c(),e=P(),t=b("li"),n=b("button"),m&&m.c(),l=P(),h&&h.c(),o=P(),r=b("div"),c=ee(a),this.h()},l(v){g&&g.l(v),e=j(v),t=y(v,"LI",{class:!0});var S=C(t);n=y(S,"BUTTON",{class:!0});var k=C(n);m&&m.l(k),l=j(k),h&&h.l(k),o=j(k),r=y(k,"DIV",{});var E=C(r);c=te(E,a),E.forEach(_),k.forEach(_),S.forEach(_),this.h()},h(){p(n,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),W(n,"items-center",!s[0].note),W(n,"items-end",s[0].note),p(t,"class",i=Ae(`${s[4].class||""} m-[0.175rem] ${Gn(s[1])} min-w-[32px]`)+" svelte-1479mcy"),W(t,"enter",s[0].key==="{enter}"),W(t,"captured",s[2])},m(v,S){g&&g.m(v,S),R(v,e,S),R(v,t,S),f(t,n),m&&m.m(n,null),f(n,l),h&&h.m(n,null),f(n,o),f(n,r),f(r,c),d||(u=Y(n,"click",s[10]),d=!0)},p(v,[S]){v[0].key==="{enter}"?g||(g=Pn(),g.c(),g.m(e.parentNode,e)):g&&(g.d(1),g=null),v[0].key==="{enter}"?m||(m=jn(),m.c(),m.m(n,l)):m&&(m.d(1),m=null),v[0].note?h?h.p(v,S):(h=Bn(v),h.c(),h.m(n,o)):h&&(h.d(1),h=null),S&1&&a!==(a=Mn(v[0].key)+"")&&ye(c,a),S&1&&W(n,"items-center",!v[0].note),S&1&&W(n,"items-end",v[0].note),S&18&&i!==(i=Ae(`${v[4].class||""} m-[0.175rem] ${Gn(v[1])} min-w-[32px]`)+" svelte-1479mcy")&&p(t,"class",i),S&19&&W(t,"enter",v[0].key==="{enter}"),S&22&&W(t,"captured",v[2])},i:ve,o:ve,d(v){v&&(_(e),_(t)),g&&g.d(v),m&&m.d(),h&&h.d(),d=!1,u()}}}function Gn(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function Mn(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function ho(s,e,t){let n,l,o,r,a,c;be(s,dt,m=>t(7,r=m)),be(s,bs,m=>t(8,a=m)),be(s,Ut,m=>t(9,c=m));let{rowIndex:i,keyIndex:d}=e,u;function g(m){Bt.call(this,s,m)}return s.$$set=m=>{t(4,e=Te(Te({},e),Ne(m))),"rowIndex"in m&&t(5,i=m.rowIndex),"keyIndex"in m&&t(6,d=m.keyIndex)},s.$$.update=()=>{s.$$.dirty&608&&t(0,n=c[i].keys[d]),s.$$.dirty&257&&t(3,l=n.note?_s({midi:n.note.semitones+a[0],flats:0,sharps:0}):0),s.$$.dirty&224&&t(2,o=r&&r.rowIndex===i&&r.nextIndex===d),s.$$.dirty&65&&(n.key==="{bksp}"?t(1,u=2):n.key==="{tab}"?t(1,u=1.5):n.key==="{enter}"?t(1,u=2):n.key==="{lock}"?t(1,u=1.75):n.key==="{shift}"&&d===0?t(1,u=1.5):n.key==="{shift}"?t(1,u=2.5):t(1,u=1))},e=Ne(e),[n,u,o,l,e,i,d,r,a,c,g]}class mo extends Fe{constructor(e){super(),He(this,e,ho,fo,ze,{rowIndex:5,keyIndex:6})}}function Rn(s,e,t){const n=s.slice();return n[13]=e[t],n[15]=t,n}function Un(s,e,t){const n=s.slice();return n[16]=e[t],n[18]=t,n}function _o(s){let e,t=s[0].layout.name+"",n;return{c(){e=b("div"),n=ee(t),this.h()},l(l){e=y(l,"DIV",{slot:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"slot","value")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o&1&&t!==(t=l[0].layout.name+"")&&ye(n,t)},d(l){l&&_(e)}}}function $n(s){let e,t,n,l,o;t=new Me({props:{icon:Ul,width:20}});function r(){return s[12](s[15])}return{c(){e=b("button"),ue(t.$$.fragment),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var c=C(e);fe(t.$$.fragment,c),c.forEach(_),this.h()},h(){p(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(a,c){R(a,e,c),de(t,e,null),n=!0,l||(o=Y(e,"click",r),l=!0)},p(a,c){s=a},i(a){n||(U(t.$$.fragment,a),n=!0)},o(a){z(t.$$.fragment,a),n=!1},d(a){a&&_(e),he(t),l=!1,o()}}}function Kn(s){let e,t;return e=new mo({props:{rowIndex:s[15],keyIndex:s[18]}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p:ve,i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function xn(s){let e,t,n,l,o=s[2][s[15]]&&s[0].isCustom&&$n(s),r=_e(s[13].keys),a=[];for(let i=0;i<r.length;i+=1)a[i]=Kn(Un(s,r,i));const c=i=>z(a[i],1,1,()=>{a[i]=null});return{c(){e=b("li"),o&&o.c(),t=P();for(let i=0;i<a.length;i+=1)a[i].c();n=Le(),this.h()},l(i){e=y(i,"LI",{class:!0});var d=C(e);o&&o.l(d),d.forEach(_),t=j(i);for(let u=0;u<a.length;u+=1)a[u].l(i);n=Le(),this.h()},h(){p(e,"class","col-span-2 svelte-1av9wwd")},m(i,d){R(i,e,d),o&&o.m(e,null),R(i,t,d);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(i,d);R(i,n,d),l=!0},p(i,d){if(i[2][i[15]]&&i[0].isCustom?o?(o.p(i,d),d&5&&U(o,1)):(o=$n(i),o.c(),U(o,1),o.m(e,null)):o&&(Ke(),z(o,1,1,()=>{o=null}),xe()),d&8){r=_e(i[13].keys);let u;for(u=0;u<r.length;u+=1){const g=Un(i,r,u);a[u]?(a[u].p(g,d),U(a[u],1)):(a[u]=Kn(g),a[u].c(),U(a[u],1),a[u].m(n.parentNode,n))}for(Ke(),u=r.length;u<a.length;u+=1)c(u);xe()}},i(i){if(!l){U(o);for(let d=0;d<r.length;d+=1)U(a[d]);l=!0}},o(i){z(o),a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)z(a[d]);l=!1},d(i){i&&(_(e),_(t),_(n)),o&&o.d(),Oe(a,i)}}}function po(s){let e,t,n,l,o,r="Layout",a,c,i,d,u,g="Custom",m,h,v,S,k,E="One row",O,T,G,w,B="Two rows",V,A,L,N,D,I,M,$,x,Q,F;c=new to({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1 w-36",options:s[4],onSelect:s[6],$$slots:{value:[_o]},$$scope:{ctx:s}}}),h=new Nt({props:{id:"custom-layout",checked:s[0].isCustom}}),h.$on("change",s[7]),T=new lo({props:{checked:!s[1]}}),T.$on("change",s[9]),N=new Me({props:{icon:Jt,width:16}});let X=_e(s[3].rows),Z=[];for(let J=0;J<X.length;J+=1)Z[J]=xn(Rn(s,X,J));const K=J=>z(Z[J],1,1,()=>{Z[J]=null});return{c(){e=b("div"),t=b("div"),n=b("div"),l=b("div"),o=b("label"),o.textContent=r,a=P(),ue(c.$$.fragment),i=P(),d=b("div"),u=b("label"),u.textContent=g,m=P(),ue(h.$$.fragment),v=P(),S=b("div"),k=b("label"),k.textContent=E,O=P(),ue(T.$$.fragment),G=P(),w=b("label"),w.textContent=B,V=P(),A=b("div"),L=b("button"),ue(N.$$.fragment),D=P(),I=b("div"),M=b("ul");for(let J=0;J<Z.length;J+=1)Z[J].c();this.h()},l(J){e=y(J,"DIV",{class:!0});var H=C(e);t=y(H,"DIV",{class:!0});var me=C(t);n=y(me,"DIV",{class:!0});var pe=C(n);l=y(pe,"DIV",{class:!0});var Re=C(l);o=y(Re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(o)!=="svelte-1xsr9lq"&&(o.textContent=r),a=j(Re),fe(c.$$.fragment,Re),Re.forEach(_),i=j(pe),d=y(pe,"DIV",{class:!0});var ie=C(d);u=y(ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(u)!=="svelte-11aw8ub"&&(u.textContent=g),m=j(ie),fe(h.$$.fragment,ie),ie.forEach(_),v=j(pe),S=y(pe,"DIV",{class:!0});var ce=C(S);k=y(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(k)!=="svelte-17p0yvw"&&(k.textContent=E),O=j(ce),fe(T.$$.fragment,ce),G=j(ce),w=y(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(w)!=="svelte-1wr3nwv"&&(w.textContent=B),ce.forEach(_),pe.forEach(_),V=j(me),A=y(me,"DIV",{class:!0});var le=C(A);L=y(le,"BUTTON",{class:!0});var oe=C(L);fe(N.$$.fragment,oe),oe.forEach(_),le.forEach(_),me.forEach(_),D=j(H),I=y(H,"DIV",{class:!0});var ge=C(I);M=y(ge,"UL",{class:!0});var ke=C(M);for(let tt=0;tt<Z.length;tt+=1)Z[tt].l(ke);ke.forEach(_),ge.forEach(_),H.forEach(_),this.h()},h(){p(o,"class","font-bold mr-4"),p(o,"for","middle-row"),p(l,"class","my-1 flex items-center justify-between mr-2"),p(u,"class","font-bold mr-4"),p(u,"for","custom-layout"),p(d,"class","my-1 flex items-center"),p(k,"class","font-bold mr-4"),p(k,"for","two-rows"),p(w,"class","font-bold ml-4"),p(w,"for","two-rows"),p(S,"class","my-1 flex items-center"),p(n,"class","options svelte-1av9wwd"),p(L,"class","rounded px-1 py-1 hover:bg-gray-200"),p(A,"class","flex items-center justify-center"),p(t,"class","flex justify-between"),p(M,"class","keyboard svelte-1av9wwd"),p(I,"class","flex flex-col"),p(e,"class",$=Ae(`${s[10].class||""} relative`)+" svelte-1av9wwd")},m(J,H){R(J,e,H),f(e,t),f(t,n),f(n,l),f(l,o),f(l,a),de(c,l,null),f(n,i),f(n,d),f(d,u),f(d,m),de(h,d,null),f(n,v),f(n,S),f(S,k),f(S,O),de(T,S,null),f(S,G),f(S,w),f(t,V),f(t,A),f(A,L),de(N,L,null),f(e,D),f(e,I),f(I,M);for(let me=0;me<Z.length;me+=1)Z[me]&&Z[me].m(M,null);x=!0,Q||(F=Y(L,"click",s[5]),Q=!0)},p(J,[H]){const me={};H&524289&&(me.$$scope={dirty:H,ctx:J}),c.$set(me);const pe={};H&1&&(pe.checked=J[0].isCustom),h.$set(pe);const Re={};if(H&2&&(Re.checked=!J[1]),T.$set(Re),H&269){X=_e(J[3].rows);let ie;for(ie=0;ie<X.length;ie+=1){const ce=Rn(J,X,ie);Z[ie]?(Z[ie].p(ce,H),U(Z[ie],1)):(Z[ie]=xn(ce),Z[ie].c(),U(Z[ie],1),Z[ie].m(M,null))}for(Ke(),ie=X.length;ie<Z.length;ie+=1)K(ie);xe()}(!x||H&1024&&$!==($=Ae(`${J[10].class||""} relative`)+" svelte-1av9wwd"))&&p(e,"class",$)},i(J){if(!x){U(c.$$.fragment,J),U(h.$$.fragment,J),U(T.$$.fragment,J),U(N.$$.fragment,J);for(let H=0;H<X.length;H+=1)U(Z[H]);x=!0}},o(J){z(c.$$.fragment,J),z(h.$$.fragment,J),z(T.$$.fragment,J),z(N.$$.fragment,J),Z=Z.filter(Boolean);for(let H=0;H<Z.length;H+=1)z(Z[H]);x=!1},d(J){J&&_(e),he(c),he(h),he(T),he(N),Oe(Z,J),Q=!1,F()}}}function go(s,e,t){let n,l,o,r,a;be(s,Et,v=>t(0,o=v)),be(s,Ut,v=>t(11,r=v)),be(s,It,v=>t(3,a=v)),gl(()=>{a.opts.isCustom||it.setLayout(navigator.languages)});const c=Object.entries(Vs).map(([v,S])=>({key:v,value:S.name}));function i(){it.reset(),it.setLayout(navigator.languages)}function d(v){return it.setLayout([v]),!1}function u(v){it.setCustomLayout(v.currentTarget.checked)}function g(v){it.captureHotkeyRow(v)}function m(){it.toggleRows()}const h=v=>g(v);return s.$$set=v=>{t(10,e=Te(Te({},e),Ne(v)))},s.$$.update=()=>{s.$$.dirty&2049&&t(2,n=r.map((v,S)=>o.hotkeydRows==="middle-row"?S===1||S===2:!0)),s.$$.dirty&1&&t(1,l=o.hotkeydRows==="middle-row")},e=Ne(e),[o,l,n,a,c,i,d,u,g,m,e,r,h]}class vo extends Fe{constructor(e){super(),He(this,e,go,po,ze,{})}}function Fn(s){let e,t="Hotkeys",n,l,o;return l=new vo({}),{c(){e=b("h4"),e.textContent=t,n=P(),ue(l.$$.fragment),this.h()},l(r){e=y(r,"H4",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-q0v9va"&&(e.textContent=t),n=j(r),fe(l.$$.fragment,r),this.h()},h(){p(e,"class","mt-4 font-bold text-lg")},m(r,a){R(r,e,a),R(r,n,a),de(l,r,a),o=!0},i(r){o||(U(l.$$.fragment,r),o=!0)},o(r){z(l.$$.fragment,r),o=!1},d(r){r&&(_(e),_(n)),he(l,r)}}}function bo(s){let e,t,n,l,o="I/O",r,a,c,i,d,u,g,m,h="Device",v,S,k,E,O,T,G="Prompt",w,B,V="Disable",A,L,N,D,I="Sound",M,$,x,Q,F,X="Fixed velocity",Z,K,J,H,me,pe,Re="Keyboard",ie,ce,le,oe,ge,ke="Hotkeys",tt,q,re,Ee,Ue,ne="Auto-octave",We,je,ct,et,Qe,Je=" ",St,ut,$e,ys,Yt,ks,bt,yt,Hs="Fade timeout",ws,ft,Es,Qt,lt,Cs,zs;i=new Me({props:{icon:Jt,width:16}}),$=new Nt({props:{id:"sound",checked:s[3].useSound}}),$.$on("change",s[13]),ce=new Nt({props:{id:"keyboard",checked:s[3].useKeyboard}}),ce.$on("change",s[15]),q=new Nt({props:{id:"hotkeys",checked:s[3].useHotkeys}}),q.$on("change",s[9]),je=new Nt({props:{id:"auto-octave",checked:s[3].useAutoOctave}}),je.$on("change",s[16]);let Be=s[2]&&!s[4]&&Fn();return{c(){e=b("div"),t=b("fieldset"),n=b("legend"),l=b("button"),l.textContent=o,r=P(),a=b("div"),c=b("button"),ue(i.$$.fragment),d=P(),u=b("div"),g=b("div"),m=b("label"),m.textContent=h,v=P(),S=b("input"),E=P(),O=b("div"),T=b("button"),T.textContent=G,w=P(),B=b("button"),B.textContent=V,A=P(),L=b("div"),N=b("div"),D=b("label"),D.textContent=I,M=P(),ue($.$$.fragment),x=P(),Q=b("div"),F=b("label"),F.textContent=X,Z=P(),K=b("input"),J=P(),H=b("div"),me=b("div"),pe=b("label"),pe.textContent=Re,ie=P(),ue(ce.$$.fragment),le=P(),oe=b("div"),ge=b("label"),ge.textContent=ke,tt=P(),ue(q.$$.fragment),re=P(),Ee=b("div"),Ue=b("label"),Ue.textContent=ne,We=P(),ue(je.$$.fragment),ct=P(),et=b("div"),Qe=b("div"),Qe.textContent=Je,St=P(),ut=b("div"),$e=b("button"),ys=ee("Set hotkeys"),ks=P(),bt=b("div"),yt=b("label"),yt.textContent=Hs,ws=P(),ft=b("input"),Es=P(),Be&&Be.c(),this.h()},l(we){e=y(we,"DIV",{class:!0});var Ge=C(e);t=y(Ge,"FIELDSET",{class:!0});var rt=C(t);n=y(rt,"LEGEND",{class:!0});var $t=C(n);l=y($t,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1jbbsti"&&(l.textContent=o),$t.forEach(_),r=j(rt),a=y(rt,"DIV",{class:!0});var Kt=C(a);c=y(Kt,"BUTTON",{class:!0});var xt=C(c);fe(i.$$.fragment,xt),xt.forEach(_),Kt.forEach(_),d=j(rt),u=y(rt,"DIV",{class:!0});var kt=C(u);g=y(kt,"DIV",{class:!0});var Dt=C(g);m=y(Dt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(m)!=="svelte-crpa7y"&&(m.textContent=h),v=j(Dt),S=y(Dt,"INPUT",{class:!0,id:!0}),E=j(Dt),O=y(Dt,"DIV",{class:!0});var Xt=C(O);T=y(Xt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(T)!=="svelte-mj6mct"&&(T.textContent=G),w=j(Xt),B=y(Xt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(B)!=="svelte-1sl6oxh"&&(B.textContent=V),Xt.forEach(_),Dt.forEach(_),A=j(kt),L=y(kt,"DIV",{class:!0});var Zt=C(L);N=y(Zt,"DIV",{class:!0});var es=C(N);D=y(es,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(D)!=="svelte-wgxtkw"&&(D.textContent=I),M=j(es),fe($.$$.fragment,es),es.forEach(_),x=j(Zt),Q=y(Zt,"DIV",{class:!0});var ts=C(Q);F=y(ts,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(F)!=="svelte-1tm2bth"&&(F.textContent=X),Z=j(ts),K=y(ts,"INPUT",{class:!0,id:!0,placeholder:!0}),ts.forEach(_),Zt.forEach(_),J=j(kt),H=y(kt,"DIV",{class:!0});var Lt=C(H);me=y(Lt,"DIV",{class:!0});var ss=C(me);pe=y(ss,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(pe)!=="svelte-1js269u"&&(pe.textContent=Re),ie=j(ss),fe(ce.$$.fragment,ss),ss.forEach(_),le=j(Lt),oe=y(Lt,"DIV",{class:!0});var ns=C(oe);ge=y(ns,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(ge)!=="svelte-21h39k"&&(ge.textContent=ke),tt=j(ns),fe(q.$$.fragment,ns),ns.forEach(_),re=j(Lt),Ee=y(Lt,"DIV",{class:!0});var ls=C(Ee);Ue=y(ls,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Ue)!=="svelte-33lczu"&&(Ue.textContent=ne),We=j(ls),fe(je.$$.fragment,ls),ls.forEach(_),Lt.forEach(_),ct=j(kt),et=y(kt,"DIV",{class:!0});var Ot=C(et);Qe=y(Ot,"DIV",{class:!0,"data-svelte-h":!0}),ae(Qe)!=="svelte-dgefms"&&(Qe.textContent=Je),St=j(Ot),ut=y(Ot,"DIV",{class:!0});var qs=C(ut);$e=y(qs,"BUTTON",{class:!0});var Ws=C($e);ys=te(Ws,"Set hotkeys"),Ws.forEach(_),qs.forEach(_),ks=j(Ot),bt=y(Ot,"DIV",{class:!0});var rs=C(bt);yt=y(rs,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(yt)!=="svelte-vd5i27"&&(yt.textContent=Hs),ws=j(rs),ft=y(rs,"INPUT",{class:!0,id:!0}),rs.forEach(_),Ot.forEach(_),kt.forEach(_),Es=j(rt),Be&&Be.l(rt),rt.forEach(_),Ge.forEach(_),this.h()},h(){p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(c,"class","rounded px-1 py-1 hover:bg-gray-200"),p(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center"),W(a,"hidden",s[4]),p(m,"class","font-bold"),p(m,"for","device"),p(S,"class","px-1 my-1 rounded w-50"),p(S,"id","device"),S.disabled=!0,S.value=k="data"in s[5]?s[5].data.name:s[5].err,p(T,"class","btn-sm primary mr-2"),p(B,"class","btn-sm primary"),p(O,"class","flex my-[auto]"),p(g,"class","h-full flex flex-col"),p(D,"class","font-bold"),p(D,"for","sound"),p(N,"class","my-1 flex justify-between items-center mr-12"),p(F,"class","font-bold"),p(F,"for","fixed-velocity"),p(K,"class","h-[20px] w-16"),p(K,"id","fixed-velocity"),p(K,"placeholder","0-127"),p(Q,"class","flex justify-between"),p(L,"class","flex flex-col h-full"),p(pe,"class","font-bold"),p(pe,"for","keyboard"),p(me,"class","my-1 flex justify-between items-center mr-12"),p(ge,"class","font-bold"),p(ge,"for","hotkeys"),p(oe,"class","my-1 flex justify-between items-center mr-12"),p(Ue,"class","font-bold"),p(Ue,"for","auto-octave"),p(Ee,"class","my-1 flex justify-between items-center mr-12"),p(H,"class","flex flex-col h-full"),p(Qe,"class","h-[28px]"),p($e,"class","w-full btn-sm primary"),$e.disabled=Yt=!s[3].useHotkeys,p(ut,"class","my-[2px] flex justify-between"),p(yt,"class","font-bold"),p(yt,"for","fade-timeout"),p(ft,"class","h-[20px] w-16"),p(ft,"id","fade-timeout"),ft.value=s[1],p(bt,"class","my-1 flex justify-between"),p(et,"class","flex flex-col h-full"),p(u,"class","body svelte-1bpw69s"),W(u,"hidden",s[4]),p(t,"class","relative flex flex-col max-w-full rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),W(t,"collapsed",s[4]),p(e,"class",Qt=Ae(`${s[12].class||""}`)+" svelte-1bpw69s")},m(we,Ge){R(we,e,Ge),f(e,t),f(t,n),f(n,l),f(t,r),f(t,a),f(a,c),de(i,c,null),f(t,d),f(t,u),f(u,g),f(g,m),f(g,v),f(g,S),f(g,E),f(g,O),f(O,T),f(O,w),f(O,B),f(u,A),f(u,L),f(L,N),f(N,D),f(N,M),de($,N,null),f(L,x),f(L,Q),f(Q,F),f(Q,Z),f(Q,K),Ze(K,s[0]),f(u,J),f(u,H),f(H,me),f(me,pe),f(me,ie),de(ce,me,null),f(H,le),f(H,oe),f(oe,ge),f(oe,tt),de(q,oe,null),f(H,re),f(H,Ee),f(Ee,Ue),f(Ee,We),de(je,Ee,null),f(u,ct),f(u,et),f(et,Qe),f(et,St),f(et,ut),f(ut,$e),f($e,ys),f(et,ks),f(et,bt),f(bt,yt),f(bt,ws),f(bt,ft),f(t,Es),Be&&Be.m(t,null),lt=!0,Cs||(zs=[Y(l,"click",s[7]),Y(c,"click",s[11]),Y(T,"click",Pe.openMidi),Y(B,"click",Pe.disableMidi),Y(K,"input",s[14]),Y(K,"change",s[8]),Y($e,"click",s[17]),Y(ft,"input",s[10])],Cs=!0)},p(we,[Ge]){(!lt||Ge&16)&&W(a,"hidden",we[4]),(!lt||Ge&32&&k!==(k="data"in we[5]?we[5].data.name:we[5].err)&&S.value!==k)&&(S.value=k);const rt={};Ge&8&&(rt.checked=we[3].useSound),$.$set(rt),Ge&1&&K.value!==we[0]&&Ze(K,we[0]);const $t={};Ge&8&&($t.checked=we[3].useKeyboard),ce.$set($t);const Kt={};Ge&8&&(Kt.checked=we[3].useHotkeys),q.$set(Kt);const xt={};Ge&8&&(xt.checked=we[3].useAutoOctave),je.$set(xt),(!lt||Ge&8&&Yt!==(Yt=!we[3].useHotkeys))&&($e.disabled=Yt),(!lt||Ge&2&&ft.value!==we[1])&&(ft.value=we[1]),(!lt||Ge&16)&&W(u,"hidden",we[4]),we[2]&&!we[4]?Be?Ge&20&&U(Be,1):(Be=Fn(),Be.c(),U(Be,1),Be.m(t,null)):Be&&(Ke(),z(Be,1,1,()=>{Be=null}),xe()),(!lt||Ge&16)&&W(t,"collapsed",we[4]),(!lt||Ge&4096&&Qt!==(Qt=Ae(`${we[12].class||""}`)+" svelte-1bpw69s"))&&p(e,"class",Qt)},i(we){lt||(U(i.$$.fragment,we),U($.$$.fragment,we),U(ce.$$.fragment,we),U(q.$$.fragment,we),U(je.$$.fragment,we),U(Be),lt=!0)},o(we){z(i.$$.fragment,we),z($.$$.fragment,we),z(ce.$$.fragment,we),z(q.$$.fragment,we),z(je.$$.fragment,we),z(Be),lt=!1},d(we){we&&_(e),he(i),he($),he(ce),he(q),he(je),Be&&Be.d(),Cs=!1,qe(zs)}}}function yo(s,e,t){let n,l,o;be(s,nt,T=>t(3,n=T)),be(s,ps,T=>t(5,o=T));const r=vt(Ve(!1),{key:"inputs-hidden"});be(s,r,T=>t(4,l=T));let a=n.fixedVelocity??"",c=n.keyFadeTimeout,i=!1;nt.subscribe(T=>{t(0,a=T.fixedVelocity??""),t(1,c=T.keyFadeTimeout)});function d(){r.update(T=>!T)}function u(T){const{value:G}=T.currentTarget;let w;if(G)try{w=parseInt(G)}catch{}w!==void 0&&w>=0&&w<=127?Pe.setInputValue("fixedVelocity",w):G?t(0,a=n.fixedVelocity||""):Pe.setInputValue("fixedVelocity",void 0)}function g(T){Pe.setInputValue("useHotkeys",T.currentTarget.checked),T.currentTarget.checked||(t(2,i=!1),it.cancelCapture())}function m(T){try{const G=parseInt(T.currentTarget.value);Pe.setInputValue("keyFadeTimeout",G)}catch{t(1,c=n.keyFadeTimeout)}}function h(){Pe.setInputValue("useSound",!0),Pe.setInputValue("fixedVelocity",void 0),Pe.setInputValue("useKeyboard",!0),Pe.setInputValue("useHotkeys",!0),Pe.setInputValue("useAutoOctave",!0),Pe.setInputValue("keyFadeTimeout",1500)}const v=T=>Pe.setInputValue("useSound",T.currentTarget.checked);function S(){a=this.value,t(0,a)}const k=T=>Pe.setInputValue("useKeyboard",T.currentTarget.checked),E=T=>Pe.setInputValue("useAutoOctave",T.currentTarget.checked),O=()=>t(2,i=!i);return s.$$set=T=>{t(12,e=Te(Te({},e),Ne(T)))},e=Ne(e),[a,c,i,n,l,o,r,d,u,g,m,h,e,v,S,k,E,O]}class ko extends Fe{constructor(e){super(),He(this,e,yo,bo,ze,{})}}function wo(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){R(t,e,n)},p:ve,d(t){t&&_(e)}}}function Eo(s){let e,t=s[1].note+"",n;return{c(){e=ee("Input: "),n=ee(t)},l(l){e=te(l,"Input: "),n=te(l,t)},m(l,o){R(l,e,o),R(l,n,o)},p(l,o){o&2&&t!==(t=l[1].note+"")&&ye(n,t)},d(l){l&&(_(e),_(n))}}}function Co(s){let e,t;return{c(){e=ee("Input: "),t=ee(s[0])},l(n){e=te(n,"Input: "),t=te(n,s[0])},m(n,l){R(n,e,l),R(n,t,l)},p(n,l){l&1&&ye(t,n[0])},d(n){n&&(_(e),_(t))}}}function To(s){let e;return{c(){e=ee(Ps)},l(t){e=te(t,Ps)},m(t,n){R(t,e,n)},p:ve,d(t){t&&_(e)}}}function Io(s){let e,t,n,l;function o(c,i){return c[2].useKeyboard&&Ps?To:c[2].useKeyboard&&c[0]?Co:c[2].useKeyboard&&c[1]?Eo:wo}let r=o(s),a=r(s);return{c(){e=b("div"),a.c(),this.h()},l(c){e=y(c,"DIV",{class:!0});var i=C(e);a.l(i),i.forEach(_),this.h()},h(){p(e,"class",t=`${s[4].class||""}`)},m(c,i){R(c,e,i),a.m(e,null),n||(l=Y(window,"keydown",s[3]),n=!0)},p(c,[i]){r===(r=o(c))&&a?a.p(c,i):(a.d(1),a=r(c),a&&(a.c(),a.m(e,null))),i&16&&t!==(t=`${c[4].class||""}`)&&p(e,"class",t)},i:ve,o:ve,d(c){c&&_(e),a.d(),n=!1,l()}}}let Ps="";function Ao(s,e,t){let n;be(s,nt,i=>t(2,n=i));let{debounced:l}=e,o="",r;const a=jl();function c(i){const d=i.target;if(l||!(d instanceof HTMLElement)||d.tagName==="INPUT")return;const u=it.handleInput(i.code,i.key,i.shiftKey);u&&u.e==="note"?t(1,r=u.data):u&&u.e==="string"?t(0,o=u.data):u&&(u.e==="guessed-key"||u.e==="guessed-chord"||u.e==="guessed-note")?(t(0,o=""),t(1,r=void 0),a(u.e,u.data),i.code==="Enter"&&i.preventDefault()):u&&i.preventDefault()}return s.$$set=i=>{t(4,e=Te(Te({},e),Ne(i))),"debounced"in i&&t(5,l=i.debounced)},e=Ne(e),[o,r,n,c,e,l]}class No extends Fe{constructor(e){super(),He(this,e,Ao,Io,ze,{debounced:5})}}function So(s){let e,t,n,l="Count",o,r,a,c,i,d="Duplicates",u,g,m,h,v,S="Autoplay",k,E,O,T,G,w="Wait seconds",B,V,A,L,N,D;return g=new Nt({props:{id:"duplicates",checked:s[2].duplicates}}),g.$on("input",s[7]),E=new Nt({props:{id:"autoplay",checked:s[2].autoplay}}),E.$on("input",s[8]),{c(){e=b("ul"),t=b("li"),n=b("label"),n.textContent=l,o=P(),r=b("input"),a=P(),c=b("li"),i=b("label"),i.textContent=d,u=P(),ue(g.$$.fragment),m=P(),h=b("li"),v=b("label"),v.textContent=S,k=P(),ue(E.$$.fragment),O=P(),T=b("li"),G=b("label"),G.textContent=w,B=P(),V=b("input"),this.h()},l(I){e=y(I,"UL",{class:!0});var M=C(e);t=y(M,"LI",{class:!0});var $=C(t);n=y($,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(n)!=="svelte-wgq9fc"&&(n.textContent=l),o=j($),r=y($,"INPUT",{class:!0,id:!0,type:!0}),$.forEach(_),a=j(M),c=y(M,"LI",{class:!0});var x=C(c);i=y(x,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(i)!=="svelte-hcg9dq"&&(i.textContent=d),u=j(x),fe(g.$$.fragment,x),x.forEach(_),m=j(M),h=y(M,"LI",{class:!0});var Q=C(h);v=y(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(v)!=="svelte-lr68n2"&&(v.textContent=S),k=j(Q),fe(E.$$.fragment,Q),Q.forEach(_),O=j(M),T=y(M,"LI",{class:!0});var F=C(T);G=y(F,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(G)!=="svelte-1qj2vcy"&&(G.textContent=w),B=j(F),V=y(F,"INPUT",{class:!0,id:!0,type:!0}),F.forEach(_),M.forEach(_),this.h()},h(){p(n,"class","font-bold"),p(n,"for","guess-count"),p(r,"class","h-[20px] w-10"),p(r,"id","guess-count"),p(r,"type","number"),p(t,"class","flex items-center justify-between svelte-1elvih2"),p(i,"class","font-bold"),p(i,"for","duplicates"),p(c,"class","flex items-center justify-between items-center mr-6 svelte-1elvih2"),p(v,"class","font-bold"),p(v,"for","autoplay"),p(h,"class","flex items-center justify-between items-center mr-6 svelte-1elvih2"),p(G,"class","font-bold"),p(G,"for","wait-ms"),p(V,"class","h-[20px] w-10"),p(V,"id","wait-ms"),p(V,"type","number"),p(T,"class","flex items-center justify-between svelte-1elvih2"),p(e,"class",A=Ae(`${s[5].class||""}`)+" svelte-1elvih2")},m(I,M){R(I,e,M),f(e,t),f(t,n),f(t,o),f(t,r),Ze(r,s[0]),f(e,a),f(e,c),f(c,i),f(c,u),de(g,c,null),f(e,m),f(e,h),f(h,v),f(h,k),de(E,h,null),f(e,O),f(e,T),f(T,G),f(T,B),f(T,V),Ze(V,s[1]),L=!0,N||(D=[Y(r,"input",s[6]),Y(r,"input",s[3]),Y(V,"input",s[9]),Y(V,"input",s[4])],N=!0)},p(I,[M]){M&1&&ds(r.value)!==I[0]&&Ze(r,I[0]);const $={};M&4&&($.checked=I[2].duplicates),g.$set($);const x={};M&4&&(x.checked=I[2].autoplay),E.$set(x),M&2&&ds(V.value)!==I[1]&&Ze(V,I[1]),(!L||M&32&&A!==(A=Ae(`${I[5].class||""}`)+" svelte-1elvih2"))&&p(e,"class",A)},i(I){L||(U(g.$$.fragment,I),U(E.$$.fragment,I),L=!0)},o(I){z(g.$$.fragment,I),z(E.$$.fragment,I),L=!1},d(I){I&&_(e),he(g),he(E),N=!1,qe(D)}}}function Do(s,e,t){let n;be(s,pt,g=>t(2,n=g));let l=n.count||"",o=n.waitSeconds||"";pt.subscribe(g=>{t(0,l=g.count||""),t(1,o=g.waitSeconds||"")});function r({currentTarget:{value:g}}){let m;try{m=parseInt(g),m<=0&&(m=1),De.setOptionValue("count",m)}catch{t(0,l=n.count)}}function a({currentTarget:{value:g}}){let m;try{m=parseInt(g),m<0&&(m=0),De.setOptionValue("waitSeconds",m)}catch{t(1,o=n.waitSeconds)}}function c(){l=ds(this.value),t(0,l)}const i=g=>De.setOptionValue("duplicates",g.currentTarget.checked),d=g=>De.setOptionValue("autoplay",g.currentTarget.checked);function u(){o=ds(this.value),t(1,o)}return s.$$set=g=>{t(5,e=Te(Te({},e),Ne(g)))},e=Ne(e),[l,o,n,r,a,e,c,i,d,u]}class Lo extends Fe{constructor(e){super(),He(this,e,Do,So,ze,{})}}function Hn(s,e,t){const n=s.slice();return n[22]=e[t].key,n[23]=e[t].value,n}function zn(s,e,t){const n=s.slice();return n[22]=e[t].key,n[23]=e[t].value,n}function qn(s){let e,t,n=s[23]+"",l,o,r,a,c,i,d,u;function g(){return s[15](s[22])}a=new Me({props:{icon:Ss,width:20}});function m(...h){return s[16](s[22],...h)}return{c(){e=b("li"),t=b("button"),l=ee(n),o=P(),r=b("button"),ue(a.$$.fragment),c=P(),this.h()},l(h){e=y(h,"LI",{class:!0});var v=C(e);t=y(v,"BUTTON",{class:!0});var S=C(t);l=te(S,n),S.forEach(_),o=j(v),r=y(v,"BUTTON",{class:!0});var k=C(r);fe(a.$$.fragment,k),k.forEach(_),c=j(v),v.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),W(t,"selected",s[22]===s[0]),p(r,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),p(e,"class","flex svelte-1okhpct")},m(h,v){R(h,e,v),f(e,t),f(t,l),f(e,o),f(e,r),de(a,r,null),f(e,c),i=!0,d||(u=[Y(t,"click",g),Y(r,"click",m)],d=!0)},p(h,v){s=h,(!i||v&17)&&W(t,"selected",s[22]===s[0])},i(h){i||(U(a.$$.fragment,h),i=!0)},o(h){z(a.$$.fragment,h),i=!1},d(h){h&&_(e),he(a),d=!1,qe(u)}}}function Wn(s){let e,t=_e(s[3]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Jn(Hn(s,t,l));return{c(){e=b("ul");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=y(l,"UL",{class:!0});var o=C(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(_),this.h()},h(){p(e,"class","svelte-1okhpct")},m(l,o){R(l,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(l,o){if(o&138){t=_e(l[3]);let r;for(r=0;r<t.length;r+=1){const a=Hn(l,t,r);n[r]?n[r].p(a,o):(n[r]=Jn(a),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Jn(s){let e,t,n=s[23]+"",l,o,r,a;function c(){return s[17](s[22])}return{c(){e=b("li"),t=b("button"),l=ee(n),o=P(),this.h()},l(i){e=y(i,"LI",{class:!0});var d=C(e);t=y(d,"BUTTON",{class:!0});var u=C(t);l=te(u,n),u.forEach(_),o=j(d),d.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),W(t,"selected",s[22]===s[1]),p(e,"class","svelte-1okhpct")},m(i,d){R(i,e,d),f(e,t),f(t,l),f(e,o),r||(a=Y(t,"click",c),r=!0)},p(i,d){s=i,d&8&&n!==(n=s[23]+"")&&ye(l,n),d&10&&W(t,"selected",s[22]===s[1])},d(i){i&&_(e),r=!1,a()}}}function Oo(s){let e,t,n="Play",l,o,r,a,c,i,d,u,g,m,h="Reset",v,S,k,E,O=s[2]?"Quit":"Play",T,G,w,B,V,A=_e(s[4]),L=[];for(let I=0;I<A.length;I+=1)L[I]=qn(zn(s,A,I));const N=I=>z(L[I],1,1,()=>{L[I]=null});let D=(s[0]==="chords-write"||s[0]==="chords-play")&&Wn(s);return d=new Lo({props:{class:"game-options"}}),k=new Me({props:{class:"mr-1",icon:s[2]?Qs:Ss,width:20}}),{c(){e=b("fieldset"),t=b("legend"),t.textContent=n,l=P(),o=b("div"),r=b("ul");for(let I=0;I<L.length;I+=1)L[I].c();a=P(),c=b("div"),D&&D.c(),i=P(),ue(d.$$.fragment),u=P(),g=b("div"),m=b("button"),m.textContent=h,v=P(),S=b("button"),ue(k.$$.fragment),E=P(),T=ee(O),this.h()},l(I){e=y(I,"FIELDSET",{class:!0});var M=C(e);t=y(M,"LEGEND",{class:!0,"data-svelte-h":!0}),ae(t)!=="svelte-1409tnk"&&(t.textContent=n),l=j(M),o=y(M,"DIV",{class:!0});var $=C(o);r=y($,"UL",{class:!0});var x=C(r);for(let Z=0;Z<L.length;Z+=1)L[Z].l(x);x.forEach(_),a=j($),c=y($,"DIV",{class:!0});var Q=C(c);D&&D.l(Q),Q.forEach(_),i=j($),fe(d.$$.fragment,$),u=j($),g=y($,"DIV",{class:!0});var F=C(g);m=y(F,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(m)!=="svelte-10rv0bu"&&(m.textContent=h),v=j(F),S=y(F,"BUTTON",{class:!0});var X=C(S);fe(k.$$.fragment,X),E=j(X),T=te(X,O),X.forEach(_),F.forEach(_),$.forEach(_),M.forEach(_),this.h()},h(){p(t,"class","px-1 text-base"),p(r,"class","games svelte-1okhpct"),p(c,"class","options svelte-1okhpct"),p(m,"class","w-full btn hover:bg-gray-200"),p(S,"class","w-full mt-2 flex items-center justify-center btn primary"),p(g,"class","h-full flex flex-col justify-end"),p(o,"class","body pb-2 h-full svelte-1okhpct"),p(e,"class",G=Ae(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(I,M){R(I,e,M),f(e,t),f(e,l),f(e,o),f(o,r);for(let $=0;$<L.length;$+=1)L[$]&&L[$].m(r,null);f(o,a),f(o,c),D&&D.m(c,null),f(o,i),de(d,o,null),f(o,u),f(o,g),f(g,m),f(g,v),f(g,S),de(k,S,null),f(S,E),f(S,T),w=!0,B||(V=[Y(m,"click",s[8]),Y(S,"click",s[9])],B=!0)},p(I,[M]){if(M&113){A=_e(I[4]);let x;for(x=0;x<A.length;x+=1){const Q=zn(I,A,x);L[x]?(L[x].p(Q,M),U(L[x],1)):(L[x]=qn(Q),L[x].c(),U(L[x],1),L[x].m(r,null))}for(Ke(),x=A.length;x<L.length;x+=1)N(x);xe()}I[0]==="chords-write"||I[0]==="chords-play"?D?D.p(I,M):(D=Wn(I),D.c(),D.m(c,null)):D&&(D.d(1),D=null);const $={};M&4&&($.icon=I[2]?Qs:Ss),k.$set($),(!w||M&4)&&O!==(O=I[2]?"Quit":"Play")&&ye(T,O),(!w||M&1024&&G!==(G=Ae(`${I[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&p(e,"class",G)},i(I){if(!w){for(let M=0;M<A.length;M+=1)U(L[M]);U(d.$$.fragment,I),U(k.$$.fragment,I),w=!0}},o(I){L=L.filter(Boolean);for(let M=0;M<L.length;M+=1)z(L[M]);z(d.$$.fragment,I),z(k.$$.fragment,I),w=!1},d(I){I&&_(e),Oe(L,I),D&&D.d(),he(d),he(k),B=!1,qe(V)}}}function Vo(s,e,t){let n,l,o,r,a,c,i;be(s,Ks,w=>t(12,r=w)),be(s,pt,w=>t(20,a=w)),be(s,mt,w=>t(13,c=w)),be(s,Tt,w=>t(14,i=w));const d=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let u=d[4].key,g="maj-m";a.count,a.waitSeconds,pt.subscribe(w=>{w.count,w.waitSeconds});function m(w,B){if(B==="chords-write"||B==="chords-play"||B==="chords-diatonic"){let V=[];g==="selected"?V=r.filter(A=>A.selected):g==="all"?V=r:g==="maj-m"?V=r.filter(A=>A.suffixes[0]==="maj"||A.suffixes[0]==="m"):g==="seventh"&&(V=r.filter(A=>A.suffixes[0]==="maj7"||A.suffixes[0]==="m7"||A.suffixes[0]==="7"||A.suffixes[0]==="dim7"||A.suffixes[0]==="aug7")),De.play(B,{chords:V})}else De.play(B,void 0);w.currentTarget instanceof HTMLElement&&w.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function h(w){t(0,u=w)}function v(w,B){t(0,u=B),m(w,B)}function S(w){t(1,g=w)}function k(){De.clearGame(!0)}function E(w){n?De.clearGame():m(w,u)}const O=w=>h(w),T=(w,B)=>v(B,w),G=w=>S(w);return s.$$set=w=>{t(10,e=Te(Te({},e),Ne(w)))},s.$$.update=()=>{s.$$.dirty&24576&&t(2,n=!!i&&c!=="ended"),s.$$.dirty&4096&&t(11,l=r.reduce((w,B)=>B.selected?w+1:w,0)),s.$$.dirty&2048&&t(3,o=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${l} chords`},{key:"all",value:"All"}])},e=Ne(e),[u,g,n,o,d,h,v,S,k,E,e,l,r,c,i,O,T,G]}class Po extends Fe{constructor(e){super(),He(this,e,Vo,Oo,ze,{})}}function Yn(s,e,t){const n=s.slice();return n[7]=e[t],n}function Qn(s,e,t){const n=s.slice();return n[4]=e[t],n}function jo(s){let e,t=_e(s[1]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Xn(Yn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o&2){t=_e(l[1]);let r;for(r=0;r<t.length;r+=1){const a=Yn(l,t,r);n[r]?n[r].p(a,o):(n[r]=Xn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Bo(s){let e,t=_e(s[0].scaleNotes||[]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Zn(Qn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o&1){t=_e(l[0].scaleNotes||[]);let r;for(r=0;r<t.length;r+=1){const a=Qn(l,t,r);n[r]?n[r].p(a,o):(n[r]=Zn(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Xn(s){let e,t=s[7].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-my4m0t")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o&2&&t!==(t=l[7].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function Zn(s){let e,t=s[4].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-my4m0t")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o&1&&t!==(t=l[4].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function Go(s){let e,t,n,l,o,r;function a(d,u){return d[0]?Bo:jo}let c=a(s),i=c(s);return{c(){e=b("div"),t=b("button"),i.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,title:!0});var u=C(e);t=y(u,"BUTTON",{class:!0});var g=C(t);i.l(g),g.forEach(_),u.forEach(_),this.h()},h(){p(t,"class","intervals svelte-my4m0t"),p(e,"class",n=`${s[2].class||""} `),p(e,"title",l=s[1].map(el).join("-"))},m(d,u){R(d,e,u),f(e,t),i.m(t,null),o||(r=Y(t,"click",s[3]),o=!0)},p(d,[u]){c===(c=a(d))&&i?i.p(d,u):(i.d(1),i=c(d),i&&(i.c(),i.m(t,null))),u&4&&n!==(n=`${d[2].class||""} `)&&p(e,"class",n),u&2&&l!==(l=d[1].map(el).join("-"))&&p(e,"title",l)},i:ve,o:ve,d(d){d&&_(e),i.d(),o=!1,r()}}}const el=s=>s.interval;function Mo(s,e,t){let{scale:n,intervals:l}=e;function o(r){Bt.call(this,s,r)}return s.$$set=r=>{t(2,e=Te(Te({},e),Ne(r))),"scale"in r&&t(0,n=r.scale),"intervals"in r&&t(1,l=r.intervals)},e=Ne(e),[n,l,e,o]}class Vl extends Fe{constructor(e){super(),He(this,e,Mo,Go,ze,{scale:0,intervals:1})}}function tl(s,e,t){const n=s.slice();return n[7]=e[t],n}function sl(s,e,t){const n=s.slice();return n[4]=e[t],n}function Ro(s){let e,t=_e(s[0]),n=[];for(let l=0;l<t.length;l+=1)n[l]=nl(tl(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o&1){t=_e(l[0]);let r;for(r=0;r<t.length;r+=1){const a=tl(l,t,r);n[r]?n[r].p(a,o):(n[r]=nl(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Uo(s){let e,t=_e(s[1]),n=[];for(let l=0;l<t.length;l+=1)n[l]=ll(sl(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let o=0;o<n.length;o+=1)n[o].l(l);e=Le()},m(l,o){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(l,o);R(l,e,o)},p(l,o){if(o&2){t=_e(l[1]);let r;for(r=0;r<t.length;r+=1){const a=sl(l,t,r);n[r]?n[r].p(a,o):(n[r]=ll(a),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function nl(s){let e,t,n=s[7].roman+"",l,o,r,a=s[7].suffix+"",c,i;return{c(){e=b("span"),t=b("span"),l=ee(n),o=P(),r=b("sup"),c=ee(a),i=P(),this.h()},l(d){e=y(d,"SPAN",{class:!0});var u=C(e);t=y(u,"SPAN",{class:!0});var g=C(t);l=te(g,n),g.forEach(_),o=j(u),r=y(u,"SUP",{class:!0});var m=C(r);c=te(m,a),m.forEach(_),i=j(u),u.forEach(_),this.h()},h(){p(t,"class","block"),p(r,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),W(r,"super-text",s[7].suffix.length>2),p(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(d,u){R(d,e,u),f(e,t),f(t,l),f(e,o),f(e,r),f(r,c),f(e,i)},p(d,u){u&1&&n!==(n=d[7].roman+"")&&ye(l,n),u&1&&a!==(a=d[7].suffix+"")&&ye(c,a),u&1&&W(r,"super-text",d[7].suffix.length>2)},d(d){d&&_(e)}}}function ll(s){let e,t,n=s[4]+"",l,o;return{c(){e=b("span"),t=b("span"),l=ee(n),o=P(),this.h()},l(r){e=y(r,"SPAN",{class:!0});var a=C(e);t=y(a,"SPAN",{});var c=C(t);l=te(c,n),c.forEach(_),o=j(a),a.forEach(_),this.h()},h(){p(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(r,a){R(r,e,a),f(e,t),f(t,l),f(e,o)},p(r,a){a&2&&n!==(n=r[4]+"")&&ye(l,n)},d(r){r&&_(e)}}}function $o(s){let e,t,n,l,o,r;function a(d,u){return d[1].length>0?Uo:Ro}let c=a(s),i=c(s);return{c(){e=b("div"),t=b("button"),i.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,title:!0});var u=C(e);t=y(u,"BUTTON",{class:!0});var g=C(t);i.l(g),g.forEach(_),u.forEach(_),this.h()},h(){p(t,"class","triads flex flex-wrap svelte-1roj1mi"),p(e,"class",n=Ae(`${s[2].class||""} `)+" svelte-1roj1mi"),p(e,"title",l=s[0].map(rl).join("-"))},m(d,u){R(d,e,u),f(e,t),i.m(t,null),o||(r=Y(t,"click",s[3]),o=!0)},p(d,[u]){c===(c=a(d))&&i?i.p(d,u):(i.d(1),i=c(d),i&&(i.c(),i.m(t,null))),u&4&&n!==(n=Ae(`${d[2].class||""} `)+" svelte-1roj1mi")&&p(e,"class",n),u&1&&l!==(l=d[0].map(rl).join("-"))&&p(e,"title",l)},i:ve,o:ve,d(d){d&&_(e),i.d(),o=!1,r()}}}const rl=s=>s.roman+s.suffix;function Ko(s,e,t){let{triads:n,chords:l}=e;function o(r){Bt.call(this,s,r)}return s.$$set=r=>{t(2,e=Te(Te({},e),Ne(r))),"triads"in r&&t(0,n=r.triads),"chords"in r&&t(1,l=r.chords)},e=Ne(e),[n,l,e,o]}class Pl extends Fe{constructor(e){super(),He(this,e,Ko,$o,ze,{triads:0,chords:1})}}function ol(s,e,t){const n=s.slice();return n[23]=e[t],n}function al(s,e,t){const n=s.slice();return n[23]=e[t],n}function il(s){let e,t,n=s[23].raw.names[0]+"",l,o,r,a,c,i,d;function u(){return s[11](s[23])}r=new Vl({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),r.$on("click",u);function g(){return s[12](s[23])}return c=new Pl({props:{triads:s[23].triads,chords:s[23].triadChords}}),c.$on("click",g),{c(){e=b("li"),t=b("div"),l=ee(n),o=P(),ue(r.$$.fragment),a=P(),ue(c.$$.fragment),i=P(),this.h()},l(m){e=y(m,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);l=te(v,n),v.forEach(_),o=j(h),fe(r.$$.fragment,h),a=j(h),fe(c.$$.fragment,h),i=j(h),h.forEach(_),this.h()},h(){p(t,"class","text-xs font-bold"),p(e,"class","svelte-4hctsl")},m(m,h){R(m,e,h),f(e,t),f(t,l),f(e,o),de(r,e,null),f(e,a),de(c,e,null),f(e,i),d=!0},p(m,h){s=m,(!d||h&4)&&n!==(n=s[23].raw.names[0]+"")&&ye(l,n);const v={};h&4&&(v.scale=s[23].scale),h&4&&(v.intervals=s[23].raw.intervals),r.$set(v);const S={};h&4&&(S.triads=s[23].triads),h&4&&(S.chords=s[23].triadChords),c.$set(S)},i(m){d||(U(r.$$.fragment,m),U(c.$$.fragment,m),d=!0)},o(m){z(r.$$.fragment,m),z(c.$$.fragment,m),d=!1},d(m){m&&_(e),he(r),he(c)}}}function cl(s){let e,t,n=s[23].raw.names[0]+"",l,o,r,a,c,i,d;function u(){return s[13](s[23])}r=new Vl({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),r.$on("click",u);function g(){return s[14](s[23])}return c=new Pl({props:{triads:s[23].triads,chords:s[23].triadChords}}),c.$on("click",g),{c(){e=b("li"),t=b("div"),l=ee(n),o=P(),ue(r.$$.fragment),a=P(),ue(c.$$.fragment),i=P(),this.h()},l(m){e=y(m,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);l=te(v,n),v.forEach(_),o=j(h),fe(r.$$.fragment,h),a=j(h),fe(c.$$.fragment,h),i=j(h),h.forEach(_),this.h()},h(){p(t,"class","text-xs font-bold"),p(e,"class","svelte-4hctsl")},m(m,h){R(m,e,h),f(e,t),f(t,l),f(e,o),de(r,e,null),f(e,a),de(c,e,null),f(e,i),d=!0},p(m,h){s=m,(!d||h&2)&&n!==(n=s[23].raw.names[0]+"")&&ye(l,n);const v={};h&2&&(v.scale=s[23].scale),h&2&&(v.intervals=s[23].raw.intervals),r.$set(v);const S={};h&2&&(S.triads=s[23].triads),h&2&&(S.chords=s[23].triadChords),c.$set(S)},i(m){d||(U(r.$$.fragment,m),U(c.$$.fragment,m),d=!0)},o(m){z(r.$$.fragment,m),z(c.$$.fragment,m),d=!1},d(m){m&&_(e),he(r),he(c)}}}function xo(s){let e,t,n,l,o="Scales",r,a,c,i="Key",d,u,g,m,h,v,S,k,E,O,T,G=_e(s[2]),w=[];for(let N=0;N<G.length;N+=1)w[N]=il(al(s,G,N));const B=N=>z(w[N],1,1,()=>{w[N]=null});let V=_e(s[1]),A=[];for(let N=0;N<V.length;N+=1)A[N]=cl(ol(s,V,N));const L=N=>z(A[N],1,1,()=>{A[N]=null});return{c(){e=b("div"),t=b("fieldset"),n=b("legend"),l=b("button"),l.textContent=o,r=P(),a=b("div"),c=b("label"),c.textContent=i,d=P(),u=b("input"),g=P(),m=b("div"),h=b("ul");for(let N=0;N<w.length;N+=1)w[N].c();v=P(),S=b("ul");for(let N=0;N<A.length;N+=1)A[N].c();this.h()},l(N){e=y(N,"DIV",{class:!0});var D=C(e);t=y(D,"FIELDSET",{class:!0});var I=C(t);n=y(I,"LEGEND",{class:!0});var M=C(n);l=y(M,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-lhx60e"&&(l.textContent=o),M.forEach(_),r=j(I),a=y(I,"DIV",{class:!0});var $=C(a);c=y($,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(c)!=="svelte-14m38zf"&&(c.textContent=i),d=j($),u=y($,"INPUT",{class:!0,id:!0}),$.forEach(_),g=j(I),m=y(I,"DIV",{class:!0});var x=C(m);h=y(x,"UL",{class:!0});var Q=C(h);for(let X=0;X<w.length;X+=1)w[X].l(Q);Q.forEach(_),v=j(x),S=y(x,"UL",{class:!0});var F=C(S);for(let X=0;X<A.length;X+=1)A[X].l(F);F.forEach(_),x.forEach(_),I.forEach(_),D.forEach(_),this.h()},h(){p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(c,"class","mr-4 font-bold"),p(c,"for","scale-key"),p(u,"class","bg-gray-100 w-16 px-1 rounded"),p(u,"id","scale-key"),u.value=s[0],p(a,"class","flex mb-2 input svelte-4hctsl"),W(a,"hidden",s[3]),p(h,"class","list odd w-full svelte-4hctsl"),p(S,"class","list even w-full svelte-4hctsl"),p(m,"class","body max-h-[30rem] overflow-scroll svelte-4hctsl"),W(m,"hidden",s[3]),p(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),W(t,"collapsed",s[3]),p(e,"class",k=Ae(`${s[9].class||""}`)+" svelte-4hctsl")},m(N,D){R(N,e,D),f(e,t),f(t,n),f(n,l),f(t,r),f(t,a),f(a,c),f(a,d),f(a,u),f(t,g),f(t,m),f(m,h);for(let I=0;I<w.length;I+=1)w[I]&&w[I].m(h,null);f(m,v),f(m,S);for(let I=0;I<A.length;I+=1)A[I]&&A[I].m(S,null);E=!0,O||(T=[Y(l,"click",s[5]),Y(u,"input",s[6])],O=!0)},p(N,[D]){if((!E||D&1&&u.value!==N[0])&&(u.value=N[0]),(!E||D&8)&&W(a,"hidden",N[3]),D&388){G=_e(N[2]);let I;for(I=0;I<G.length;I+=1){const M=al(N,G,I);w[I]?(w[I].p(M,D),U(w[I],1)):(w[I]=il(M),w[I].c(),U(w[I],1),w[I].m(h,null))}for(Ke(),I=G.length;I<w.length;I+=1)B(I);xe()}if(D&386){V=_e(N[1]);let I;for(I=0;I<V.length;I+=1){const M=ol(N,V,I);A[I]?(A[I].p(M,D),U(A[I],1)):(A[I]=cl(M),A[I].c(),U(A[I],1),A[I].m(S,null))}for(Ke(),I=V.length;I<A.length;I+=1)L(I);xe()}(!E||D&8)&&W(m,"hidden",N[3]),(!E||D&8)&&W(t,"collapsed",N[3]),(!E||D&512&&k!==(k=Ae(`${N[9].class||""}`)+" svelte-4hctsl"))&&p(e,"class",k)},i(N){if(!E){for(let D=0;D<G.length;D+=1)U(w[D]);for(let D=0;D<V.length;D+=1)U(A[D]);E=!0}},o(N){w=w.filter(Boolean);for(let D=0;D<w.length;D+=1)z(w[D]);A=A.filter(Boolean);for(let D=0;D<A.length;D+=1)z(A[D]);E=!1},d(N){N&&_(e),Oe(w,N),Oe(A,N),O=!1,qe(T)}}}function Fo(s,e,t){let n,l,o,r,a,c,i;be(s,Rt,A=>t(17,o=A)),be(s,gt,A=>t(18,r=A)),be(s,nt,A=>t(19,a=A)),be(s,st,A=>t(20,c=A));let u=vs().map(A=>({key:A.names[0],raw:A,scale:void 0,triads:A.triads,triadChords:[]})),g="",m=[r.key,r.scale],h;const v=vt(Ve(!0),{key:"scales-hidden"});be(s,v,A=>t(3,i=A));function S(){v.update(A=>!A)}function k({currentTarget:{value:A}}){t(0,g=`${A.charAt(0).toUpperCase()}${A.charAt(1).toLowerCase()}`),t(10,u=u.map(L=>{const N=zt(g,L.key),D=g&&"data"in N?N.data:void 0;let I=[];return D&&(I=L.triads.map((M,$)=>`${D.scaleNotes[$].note}${!M.suffix.includes("°")&&M.minor?"m":""}${M.suffix}`)),{...L,scale:D,triadChords:I}}))}function E(A,L,N){if(A<L.length){const D=L[A++];Se.setPlayed(D),c==null||c.playChord(D.map(I=>I.midi),a.fixedVelocity),h=setTimeout(()=>E(A,L,N),N)}else Se.setPlayed([]),Se.setKeyAndScale(m[0],m[1])}function O(A){clearTimeout(h);let L,N;A.scale?(N=A.scale,m=[r.key,r.scale],Se.setKeyAndScale(A.scale.key,A.scale.scale)):N=r;const D=o[0].midi+N.scaleNotes[0].semitones;L=A.raw.intervals.map(I=>[{...N.notesMap.get(I.semitones%12),midi:D+I.semitones}]),L[0][0].semitones!==L[L.length-1][0].semitones&&L.push(L[0].map(I=>({...I,midi:I.midi+12}))),E(0,L,500)}function T(A){clearTimeout(h);const{intervals:L}=A.raw;let N,D;A.scale?(D=A.scale,m=[r.key,r.scale],Se.setKeyAndScale(A.scale.key,A.scale.scale)):D=r;const I=o[0].midi+D.scaleNotes[0].semitones;N=wl(A.triads).map(($,x)=>is(I+D.intervals[x].semitones,D,$.intervals)),L[L.length-1].interval_seq!==1&&N.push(N[0].map($=>({...$,midi:$.midi+12}))),E(0,N,750)}const G=A=>O(A),w=A=>T(A),B=A=>O(A),V=A=>T(A);return s.$$set=A=>{t(9,e=Te(Te({},e),Ne(A)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,n=u.filter((A,L)=>L<u.length/2)),s.$$.dirty&1024&&t(1,l=u.filter((A,L)=>L>=u.length/2))},e=Ne(e),[g,l,n,i,v,S,k,O,T,e,u,G,w,B,V]}class Ho extends Fe{constructor(e){super(),He(this,e,Fo,xo,ze,{})}}function ul(s,e,t){const n=s.slice();return n[26]=e[t],n}function fl(s,e,t){const n=s.slice();return n[29]=e[t],n}function dl(s){let e,t;return{c(){e=b("div"),t=ee(s[3]),this.h()},l(n){e=y(n,"DIV",{class:!0});var l=C(e);t=te(l,s[3]),l.forEach(_),this.h()},h(){p(e,"class","error svelte-1h3nald")},m(n,l){R(n,e,l),f(e,t)},p(n,l){l[0]&8&&ye(t,n[3])},d(n){n&&_(e)}}}function hl(s){let e,t=_e(s[5]),n=[];for(let l=0;l<t.length;l+=1)n[l]=ml(fl(s,t,l));return{c(){e=b("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=y(l,"DIV",{class:!0});var o=C(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(_),this.h()},h(){p(e,"class","intervals my-1 svelte-1h3nald")},m(l,o){R(l,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(l,o){if(o[0]&32){t=_e(l[5]);let r;for(r=0;r<t.length;r+=1){const a=fl(l,t,r);n[r]?n[r].p(a,o):(n[r]=ml(a),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function ml(s){let e,t=s[29].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1h3nald")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&32&&t!==(t=l[29].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function _l(s){let e,t=_e(s[8].scaleNotes),n=[];for(let l=0;l<t.length;l+=1)n[l]=pl(ul(s,t,l));return{c(){e=b("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=y(l,"DIV",{class:!0});var o=C(e);for(let r=0;r<n.length;r+=1)n[r].l(o);o.forEach(_),this.h()},h(){p(e,"class","intervals my-1 svelte-1h3nald")},m(l,o){R(l,e,o);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(l,o){if(o[0]&256){t=_e(l[8].scaleNotes);let r;for(r=0;r<t.length;r+=1){const a=ul(l,t,r);n[r]?n[r].p(a,o):(n[r]=pl(a),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function pl(s){let e,t=s[26].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var o=C(e);n=te(o,t),o.forEach(_),this.h()},h(){p(e,"class","svelte-1h3nald")},m(l,o){R(l,e,o),f(e,n)},p(l,o){o[0]&256&&t!==(t=l[26].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function zo(s){let e,t,n,l="Score",o,r,a,c,i,d,u,g="Range",m,h,v,S,k,E="—",O,T,G,w,B,V,A,L="Scale",N,D,I,M,$,x,Q,F="Key",X,Z,K,J,H,me,pe,Re;a=new Me({props:{icon:Jt,width:16}});let ie=s[3]&&dl(s);I=new vl({props:{id:"score-scale",class:"p-1 pl-[2px] w-48",containerClass:"w-48",selected:s[0],options:s[10],onSelect:s[14]}});let ce=!s[7]&&hl(s),le=!s[7]&&_l(s);return{c(){e=b("fieldset"),t=b("legend"),n=b("button"),n.textContent=l,o=P(),r=b("button"),ue(a.$$.fragment),c=P(),i=b("div"),d=b("div"),u=b("label"),u.textContent=g,m=P(),h=b("div"),v=b("input"),S=P(),k=b("span"),k.textContent=E,O=P(),T=b("input"),G=P(),w=b("div"),ie&&ie.c(),B=P(),V=b("div"),A=b("label"),A.textContent=L,N=P(),D=b("div"),ue(I.$$.fragment),M=P(),ce&&ce.c(),$=P(),x=b("div"),Q=b("label"),Q.textContent=F,X=P(),Z=b("div"),K=b("input"),J=P(),le&&le.c(),this.h()},l(oe){e=y(oe,"FIELDSET",{class:!0});var ge=C(e);t=y(ge,"LEGEND",{class:!0});var ke=C(t);n=y(ke,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-lqyol"&&(n.textContent=l),ke.forEach(_),o=j(ge),r=y(ge,"BUTTON",{class:!0});var tt=C(r);fe(a.$$.fragment,tt),tt.forEach(_),c=j(ge),i=y(ge,"DIV",{class:!0});var q=C(i);d=y(q,"DIV",{class:!0});var re=C(d);u=y(re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(u)!=="svelte-10u0679"&&(u.textContent=g),m=j(re),h=y(re,"DIV",{class:!0});var Ee=C(h);v=y(Ee,"INPUT",{class:!0,id:!0}),S=j(Ee),k=y(Ee,"SPAN",{class:!0,"data-svelte-h":!0}),ae(k)!=="svelte-8q1xz4"&&(k.textContent=E),O=j(Ee),T=y(Ee,"INPUT",{class:!0,id:!0}),Ee.forEach(_),G=j(re),w=y(re,"DIV",{class:!0});var Ue=C(w);ie&&ie.l(Ue),Ue.forEach(_),re.forEach(_),B=j(q),V=y(q,"DIV",{class:!0});var ne=C(V);A=y(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(A)!=="svelte-1nrdbqn"&&(A.textContent=L),N=j(ne),D=y(ne,"DIV",{class:!0});var We=C(D);fe(I.$$.fragment,We),We.forEach(_),M=j(ne),ce&&ce.l(ne),ne.forEach(_),$=j(q),x=y(q,"DIV",{class:!0});var je=C(x);Q=y(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Q)!=="svelte-17pcm6g"&&(Q.textContent=F),X=j(je),Z=y(je,"DIV",{class:!0});var ct=C(Z);K=y(ct,"INPUT",{class:!0,id:!0}),ct.forEach(_),J=j(je),le&&le.l(je),je.forEach(_),q.forEach(_),ge.forEach(_),this.h()},h(){p(n,"class","px-1 rounded hover:bg-gray-100"),p(t,"class","text-base"),p(r,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(r,"hidden",s[6]),p(u,"class","font-bold"),p(u,"for","range_min"),p(v,"class","h-[28px] w-full"),p(v,"id","range_min"),p(k,"class","mx-2 mt-1"),p(T,"class","h-[28px] w-full"),p(T,"id","range_max"),p(h,"class","my-1 flex w-full"),p(w,"class","flex justify-between my-1"),p(d,"class","range flex flex-col h-full"),p(A,"class","font-bold"),p(A,"for","score-scale"),p(D,"class","my-1 w-full"),p(V,"class","flex flex-col h-full"),p(Q,"class","font-bold"),p(Q,"for","key"),p(K,"class","h-[28px]"),p(K,"id","key"),p(Z,"class","my-1 flex"),p(x,"class","flex flex-col h-full"),p(i,"class","options svelte-1h3nald"),W(i,"hidden",s[6]),p(e,"class",H=Ae(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1h3nald"),W(e,"collapsed",s[6])},m(oe,ge){R(oe,e,ge),f(e,t),f(t,n),f(e,o),f(e,r),de(a,r,null),f(e,c),f(e,i),f(i,d),f(d,u),f(d,m),f(d,h),f(h,v),Ze(v,s[1]),f(h,S),f(h,k),f(h,O),f(h,T),Ze(T,s[2]),f(d,G),f(d,w),ie&&ie.m(w,null),f(i,B),f(i,V),f(V,A),f(V,N),f(V,D),de(I,D,null),f(V,M),ce&&ce.m(V,null),f(i,$),f(i,x),f(x,Q),f(x,X),f(x,Z),f(Z,K),Ze(K,s[4]),f(x,J),le&&le.m(x,null),me=!0,pe||(Re=[Y(n,"click",s[15]),Y(r,"click",s[16]),Y(v,"input",s[18]),Y(v,"change",s[19]),Y(v,"focus",s[12]),Y(T,"input",s[20]),Y(T,"change",s[21]),Y(T,"focus",s[12]),Y(K,"input",s[22]),Y(K,"input",s[13])],pe=!0)},p(oe,ge){(!me||ge[0]&64)&&W(r,"hidden",oe[6]),ge[0]&2&&v.value!==oe[1]&&Ze(v,oe[1]),ge[0]&4&&T.value!==oe[2]&&Ze(T,oe[2]),oe[3]?ie?ie.p(oe,ge):(ie=dl(oe),ie.c(),ie.m(w,null)):ie&&(ie.d(1),ie=null);const ke={};ge[0]&1&&(ke.selected=oe[0]),I.$set(ke),oe[7]?ce&&(ce.d(1),ce=null):ce?ce.p(oe,ge):(ce=hl(oe),ce.c(),ce.m(V,null)),ge[0]&16&&K.value!==oe[4]&&Ze(K,oe[4]),oe[7]?le&&(le.d(1),le=null):le?le.p(oe,ge):(le=_l(oe),le.c(),le.m(x,null)),(!me||ge[0]&64)&&W(i,"hidden",oe[6]),(!me||ge[0]&131072&&H!==(H=Ae(`${oe[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1h3nald"))&&p(e,"class",H),(!me||ge[0]&131136)&&W(e,"collapsed",oe[6])},i(oe){me||(U(a.$$.fragment,oe),U(I.$$.fragment,oe),me=!0)},o(oe){z(a.$$.fragment,oe),z(I.$$.fragment,oe),me=!1},d(oe){oe&&_(e),he(a),ie&&ie.d(),he(I),ce&&ce.d(),le&&le.d(),pe=!1,qe(Re)}}}function qo(s,e,t){let n,l,o,r,a,c;be(s,Rt,D=>t(23,l=D)),be(s,At,D=>t(24,o=D)),be(s,Tt,D=>t(7,a=D)),be(s,gt,D=>t(8,c=D));let i=ht(l[0]),d=ht(l[1]),u="";const g=vt(Ve(!1),{key:"score-options-hidden"});be(s,g,D=>t(6,r=D));let m=o[0],h=o[1];const v=vs(),S=v.map(D=>({key:D.names[0],value:D.names[0]}));Rt.subscribe(D=>{t(1,i=ht(D[0])),t(2,d=ht(D[1]))}),At.subscribe(D=>{t(4,m=D[0]),t(0,h=D[1])});function k(D,I){const M=lr(I.currentTarget.value,!0,!0);if("data"in M){const{midi:$}=M.data,x=l,Q=[D==="min"?$:x[0].midi,D==="max"?$:x[1].midi];Pe.setMidiRange(Q),t(3,u="")}else t(3,u=M.err),D==="min"?t(1,i=ht(l[0])):t(2,d=ht(l[1]))}function E(){t(3,u="")}function O({currentTarget:{value:D}}){t(4,m=`${D.charAt(0).toUpperCase()}${D.charAt(1).toLowerCase()}`),Se.setKey(m)}function T(D){var I;return t(0,h=(I=S.find(M=>D===M.key))==null?void 0:I.value),Se.setScale(h),!1}function G(){g.update(D=>!D)}function w(){Se.clearScore(!0),Pe.setMidiRange([60,84])}function B(){i=this.value,t(1,i)}const V=D=>k("min",D);function A(){d=this.value,t(2,d)}const L=D=>k("max",D);function N(){m=this.value,t(4,m)}return s.$$set=D=>{t(17,e=Te(Te({},e),Ne(D)))},s.$$.update=()=>{var D;s.$$.dirty[0]&1&&t(5,n=((D=v.find(I=>I.names[0]===h))==null?void 0:D.intervals)||[])},e=Ne(e),[h,i,d,u,m,n,r,a,c,g,S,k,E,O,T,G,w,e,B,V,A,L,N]}class Wo extends Fe{constructor(e){super(),He(this,e,qo,zo,ze,{},null,[-1,-1])}}function Jo(s){s[19]=s[20].default}function Yo(s){return{c:ve,l:ve,m:ve,i:ve,o:ve,d:ve}}function Qo(s){Jo(s);let e,t,n;var l=s[19];function o(r,a){return{props:{class:"mx-4 md:mx-0"}}}return l&&(e=Gl(l,o())),{c(){e&&ue(e.$$.fragment),t=Le()},l(r){e&&fe(e.$$.fragment,r),t=Le()},m(r,a){e&&de(e,r,a),R(r,t,a),n=!0},i(r){n||(e&&U(e.$$.fragment,r),n=!0)},o(r){e&&z(e.$$.fragment,r),n=!1},d(r){r&&_(t),e&&he(e,r)}}}function Xo(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){R(t,e,n)},i:ve,o:ve,d(t){t&&_(e)}}}function Zo(s){let e,t,n="MIDI Note Trainer",l,o,r,a,c,i,d,u="Introduction",g,m,h,v,S,k,E,O,T,G,w,B,V,A,L,N,D,I,M,$,x;a=new Me({props:{icon:Jt,width:24}}),h=new ko({}),S=new Ho({}),E=new Nr({}),G=new Wo({props:{class:"score-options mr-4"}}),B=new Po({props:{class:"play-form"}});let Q={ctx:s,current:null,token:null,hasCatch:!1,pending:Xo,then:Qo,catch:Yo,value:20,blocks:[,,,]};return Bl(Ie(()=>import("./Score.91a701a2.js"),["./Score.91a701a2.js","./vendor_svelte.a281e649.js","./vendor.e9b0235c.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),Q),N=new No({props:{class:"min-h-32",debounced:!!s[0]}}),N.$on("guessed-chord",s[2]),N.$on("guessed-key",s[3]),N.$on("guessed-note",s[4]),I=new $r({props:{game:s[1]}}),{c(){e=b("h1"),t=b("a"),t.textContent=n,l=P(),o=b("div"),r=b("button"),ue(a.$$.fragment),c=P(),i=b("div"),d=b("button"),d.textContent=u,g=P(),m=b("section"),ue(h.$$.fragment),v=P(),ue(S.$$.fragment),k=P(),ue(E.$$.fragment),O=P(),T=b("div"),ue(G.$$.fragment),w=P(),ue(B.$$.fragment),V=P(),Q.block.c(),A=P(),L=b("section"),ue(N.$$.fragment),D=P(),ue(I.$$.fragment),this.h()},l(F){e=y(F,"H1",{class:!0});var X=C(e);t=y(X,"A",{class:!0,href:!0,"data-svelte-h":!0}),ae(t)!=="svelte-km4jns"&&(t.textContent=n),l=j(X),o=y(X,"DIV",{class:!0});var Z=C(o);r=y(Z,"BUTTON",{class:!0});var K=C(r);fe(a.$$.fragment,K),K.forEach(_),Z.forEach(_),X.forEach(_),c=j(F),i=y(F,"DIV",{class:!0});var J=C(i);d=y(J,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(d)!=="svelte-f34gar"&&(d.textContent=u),J.forEach(_),g=j(F),m=y(F,"SECTION",{class:!0});var H=C(m);fe(h.$$.fragment,H),v=j(H),fe(S.$$.fragment,H),k=j(H),fe(E.$$.fragment,H),O=j(H),T=y(H,"DIV",{class:!0});var me=C(T);fe(G.$$.fragment,me),w=j(me),fe(B.$$.fragment,me),me.forEach(_),H.forEach(_),V=j(F),Q.block.l(F),A=j(F),L=y(F,"SECTION",{class:!0});var pe=C(L);fe(N.$$.fragment,pe),D=j(pe),fe(I.$$.fragment,pe),pe.forEach(_),this.h()},h(){p(t,"class","hover:underline"),p(t,"href","https://github.com/TeemuKoivisto/midi-note-trainer"),p(r,"class","rounded p-2 hover:bg-gray-200"),p(o,"class","flex items-center justify-center"),p(e,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight flex items-center justify-between"),p(d,"class","btn-pill border-2 border-gray-300 hover:bg-gray-200"),p(i,"class","px-4 md:px-0"),p(T,"class","play svelte-qjpqy3"),p(m,"class","mx-4 md:mx-0"),p(L,"class","mb-8 ml-16 flex flex-col")},m(F,X){R(F,e,X),f(e,t),f(e,l),f(e,o),f(o,r),de(a,r,null),R(F,c,X),R(F,i,X),f(i,d),R(F,g,X),R(F,m,X),de(h,m,null),f(m,v),de(S,m,null),f(m,k),de(E,m,null),f(m,O),f(m,T),de(G,T,null),f(T,w),de(B,T,null),R(F,V,X),Q.block.m(F,Q.anchor=X),Q.mount=()=>A.parentNode,Q.anchor=A,R(F,A,X),R(F,L,X),de(N,L,null),f(L,D),de(I,L,null),M=!0,$||(x=[Y(r,"click",s[5]),Y(d,"click",s[6])],$=!0)},p(F,[X]){s=F;const Z={};X&1&&(Z.debounced=!!s[0]),N.$set(Z);const K={};X&2&&(K.game=s[1]),I.$set(K)},i(F){M||(U(a.$$.fragment,F),U(h.$$.fragment,F),U(S.$$.fragment,F),U(E.$$.fragment,F),U(G.$$.fragment,F),U(B.$$.fragment,F),U(Q.block),U(N.$$.fragment,F),U(I.$$.fragment,F),M=!0)},o(F){z(a.$$.fragment,F),z(h.$$.fragment,F),z(S.$$.fragment,F),z(E.$$.fragment,F),z(G.$$.fragment,F),z(B.$$.fragment,F);for(let X=0;X<3;X+=1){const Z=Q.blocks[X];z(Z)}z(N.$$.fragment,F),z(I.$$.fragment,F),M=!1},d(F){F&&(_(e),_(c),_(i),_(g),_(m),_(V),_(A),_(L)),he(a),he(h),he(S),he(E),he(G),he(B),Q.block.d(F),Q.token=null,Q=null,he(N),he(I),$=!1,qe(x)}}}function ea(s,e,t){let n,l,o,r,a,c;be(s,mt,w=>t(8,n=w)),be(s,Tt,w=>t(1,l=w)),be(s,pt,w=>t(9,o=w)),be(s,nt,w=>t(10,r=w)),be(s,st,w=>t(11,a=w)),be(s,Ls,w=>t(12,c=w));let i,d;gl(()=>(c&&Pe.openMidi(),window.addEventListener("keydown",u),window.addEventListener("mousedown",u),window.addEventListener("touchstart",u),()=>{window.removeEventListener("keydown",u),window.removeEventListener("mousedown",u),window.removeEventListener("touchstart",u)})),ps.subscribe(w=>{"data"in w&&w.data.channels[1].addListener("noteon",g)});function u(){Pe.initAudio(),window.removeEventListener("keydown",u),window.removeEventListener("mousedown",u),window.removeEventListener("touchstart",u)}function g(w){if(i)return;const B=w.rawData;m(B[1],B[2])}function m(w,B){const V=l;V instanceof Pt&&!(V!=null&&V.ended)&&n==="waiting"?S(w):V instanceof _t&&!(V!=null&&V.ended)&&n==="waiting"?(V.addPlayedNote(w),d||(d=setTimeout(v,2e3))):V||Se.pushPlayed(w),a&&a.noteOn(w,r.fixedVelocity??B)}function h(){o.autoplay&&o.waitSeconds>0?t(0,i=setTimeout(()=>{o.autoplay&&De.nextGuess(),t(0,i=void 0)},o.waitSeconds*1e3)):o.autoplay?De.nextGuess():t(0,i=void 0)}function v(){var B;const w=l;if(w instanceof _t){const V=w.guess();Se.setPlayed(((B=w.latestGuess.guessed)==null?void 0:B.notes)||[],V,-1),De.updateState(V?"correct":"wrong"),h()}d=void 0}function S(w){const B=l;if(B instanceof Pt&&n==="waiting"){Se.setTarget([Se.getNote(B.current)]);const V=B.guess(w);De.updateState(V?"correct":"wrong"),Se.pushPlayed(w,V,4e3),h()}}function k(w){const B=l;if(B instanceof _t&&n==="waiting"){const V=B.guessWrittenChord(w.detail);De.updateState(V?"correct":"wrong"),h()}}function E(w){const B=l;if(B instanceof qt&&n==="waiting"){const V=w.detail.replaceAll("♭","b").replaceAll("♯","#"),A=B.guess(V);De.updateState(A?"correct":"wrong"),h()}}function O(w){const B=it.findNote(w.detail.note)??Us(w.detail.note);B&&m(B.semitones+12+w.detail.octave*12,80)}function T(){ur(),window.location.reload()}return[i,l,k,E,O,T,()=>$l.open("introduction",void 0)]}class ra extends Fe{constructor(e){super(),He(this,e,ea,Zo,ze,{})}}export{ln as F,_t as G,ra as P,Jl as S,Pt as a,De as b,Tt as c,wt as d,_s as e,mt as g,st as p,gt as s,cn as t};
