import{_ as Ie}from"./preload-helper.a4192956.js";import{S as Fe,i as He,s as ze,e as b,b as j,g as y,h as C,f as B,j as _,k as p,_ as Te,P as W,l as M,n as f,$ as Ze,y as Y,t as U,J as Ke,q as z,C as $e,a0 as Ye,R as Ae,T as Ne,c as js,a1 as _e,u as Bs,o as Gs,p as Ms,W as cs,X as Ct,Y as us,a2 as fs,a3 as Oe,B as Le,L as vs,G as ee,H as te,I as ye,z as ve,O as Me,a as ue,d as fe,m as de,r as he,v as Ce,U as qt,w as Ve,x as ae,Q as be,a4 as ds,a5 as pl,a6 as jt,A as gl,a7 as jl,a8 as hs,a9 as Bl,N as Gl}from"./vendor_svelte.7bc09af0.js";import{w as os,c as Ml,e as Rl,f as Ws,g as Js,h as Wt,i as ms,j as _s,k as Bt,l as Gt,m as Ul,a as Ys,n as Ss}from"./vendor.e9b0235c.js";import{a as xl}from"./modal.5d0c5e5e.js";function Qs(s,e,t){const n=s.slice();return n[22]=e[t].key,n[23]=e[t].value,n[24]=e[t].icon,n[26]=t,n}const Kl=s=>({}),Xs=s=>({});function Zs(s){let e,t,n,l,r,o,a,i,c,u,d;const g=s[17].header,m=js(g,s,s[16],Xs);let h=_e(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=tn(Qs(s,h,k));const S=k=>z(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),n=j(),l=b("ul"),r=b("li"),m&&m.c(),o=j();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(_),n=B(k),l=y(k,"UL",{class:!0});var E=C(l);r=y(E,"LI",{});var P=C(r);m&&m.l(P),P.forEach(_),o=B(E);for(let T=0;T<v.length;T+=1)v[T].l(E);E.forEach(_),this.h()},h(){p(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),p(e,"tabindex","-1"),p(l,"class",a=Te(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,E){M(k,e,E),M(k,n,E),M(k,l,E),f(l,r),m&&m.m(r,null),f(l,o);for(let P=0;P<v.length;P+=1)v[P]&&v[P].m(l,null);c=!0,u||(d=Y(e,"click",s[11]),u=!0)},p(k,E){if(s=k,m&&m.p&&(!c||E&65536)&&Bs(m,g,s,s[16],c?Ms(g,s[16],E,Kl):Gs(s[16]),Xs),E&8457){h=_e(s[0]);let P;for(P=0;P<h.length;P+=1){const T=Qs(s,h,P);v[P]?(v[P].p(T,E),U(v[P],1)):(v[P]=tn(T),v[P].c(),U(v[P],1),v[P].m(l,null))}for(Ke(),P=h.length;P<v.length;P+=1)S(P);$e()}(!c||E&4&&a!==(a=Te(`items-list bg-white py-1.5 py-2 max-h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&p(l,"class",a)},i(k){if(!c){k&&cs(()=>{c&&(t||(t=Ct(e,us,{duration:rs},!0)),t.run(1))}),U(m,k);for(let E=0;E<h.length;E+=1)U(v[E]);k&&cs(()=>{c&&(i||(i=Ct(l,fs,{duration:rs},!0)),i.run(1))}),c=!0}},o(k){k&&(t||(t=Ct(e,us,{duration:rs},!1)),t.run(0)),z(m,k),v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)z(v[E]);k&&(i||(i=Ct(l,fs,{duration:rs},!1)),i.run(0)),c=!1},d(k){k&&(_(e),_(n),_(l)),k&&t&&t.end(),m&&m.d(k),Oe(v,k),k&&i&&i.end(),u=!1,d()}}}function en(s){let e,t,n,l,r,o,a=s[23]+"",i,c,u,d,g;const m=[Fl,$l],h=[];function v(k,E){return k[24]?0:1}n=v(s),l=h[n]=m[n](s);function S(){return s[20](s[22])}return{c(){e=b("li"),t=b("button"),l.c(),r=j(),o=b("div"),i=ee(a),c=j(),this.h()},l(k){e=y(k,"LI",{});var E=C(e);t=y(E,"BUTTON",{class:!0});var P=C(t);l.l(P),r=B(P),o=y(P,"DIV",{});var T=C(o);i=te(T,a),T.forEach(_),P.forEach(_),c=B(E),E.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),W(t,"selected",s[22]===s[3])},m(k,E){M(k,e,E),f(e,t),h[n].m(t,null),f(t,r),f(t,o),f(o,i),f(e,c),u=!0,d||(g=Y(t,"click",S),d=!0)},p(k,E){s=k;let P=n;n=v(s),n===P?h[n].p(s,E):(Ke(),z(h[P],1,1,()=>{h[P]=null}),$e(),l=h[n],l?l.p(s,E):(l=h[n]=m[n](s),l.c()),U(l,1),l.m(t,r)),(!u||E&1)&&a!==(a=s[23]+"")&&ye(i,a),(!u||E&9)&&W(t,"selected",s[22]===s[3])},i(k){u||(U(l),u=!0)},o(k){z(l),u=!1},d(k){k&&_(e),h[n].d(),d=!1,g()}}}function $l(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","w-[24px]")},m(t,n){M(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&_(e)}}}function Fl(s){let e,t;return e=new Me({props:{class:"mr-2",icon:s[24],width:16}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p(n,l){const r={};l&1&&(r.icon=n[24]),e.$set(r)},i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function tn(s){let e,t,n=!s[8][s[26]]&&en(s);return{c(){n&&n.c(),e=Le()},l(l){n&&n.l(l),e=Le()},m(l,r){n&&n.m(l,r),M(l,e,r),t=!0},p(l,r){l[8][l[26]]?n&&(Ke(),z(n,1,1,()=>{n=null}),$e()):n?(n.p(l,r),r&256&&U(n,1)):(n=en(l),n.c(),U(n,1),n.m(e.parentNode,e))},i(l){t||(U(n),t=!0)},o(l){z(n),t=!1},d(l){l&&_(e),n&&n.d(l)}}}function Hl(s){let e,t,n,l,r,o,a,i,c,u=s[6]&&Zs(s);return{c(){e=b("div"),t=b("input"),r=j(),u&&u.c(),this.h()},l(d){e=y(d,"DIV",{class:!0,id:!0});var g=C(e);t=y(g,"INPUT",{class:!0,title:!0}),r=B(g),u&&u.l(g),g.forEach(_),this.h()},h(){p(t,"class",n=Te(`${s[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"),p(t,"title",l=s[14].title||""),W(t,"disabled",s[4]),W(t,"open",s[6]),p(e,"class",o=Te(`relative ${s[2]||""}`)+" svelte-h65upg"),p(e,"id",s[1])},m(d,g){M(d,e,g),f(e,t),Ze(t,s[7]),f(e,r),u&&u.m(e,null),s[21](e),a=!0,i||(c=[Y(t,"input",s[18]),Y(t,"click",s[9]),Y(t,"focus",s[19]),Y(t,"input",s[10]),Y(t,"keydown",s[12])],i=!0)},p(d,[g]){(!a||g&16384&&n!==(n=Te(`${d[14].class||""} open-btn text-justify text-sm rounded`)+" svelte-h65upg"))&&p(t,"class",n),(!a||g&16384&&l!==(l=d[14].title||""))&&p(t,"title",l),g&128&&t.value!==d[7]&&Ze(t,d[7]),(!a||g&16400)&&W(t,"disabled",d[4]),(!a||g&16448)&&W(t,"open",d[6]),d[6]?u?(u.p(d,g),g&64&&U(u,1)):(u=Zs(d),u.c(),U(u,1),u.m(e,null)):u&&(Ke(),z(u,1,1,()=>{u=null}),$e()),(!a||g&4&&o!==(o=Te(`relative ${d[2]||""}`)+" svelte-h65upg"))&&p(e,"class",o),(!a||g&2)&&p(e,"id",d[1])},i(d){a||(U(u),a=!0)},o(d){z(u),a=!1},d(d){d&&_(e),u&&u.d(),s[21](null),i=!1,Ye(c)}}}const rs=400;function zl(s,e,t){let{$$slots:n={},$$scope:l}=e,{options:r,id:o=void 0,containerClass:a=void 0,selected:i,disabled:c=void 0,onSelect:u}=e,d,g=!1,m=i,h=r.map(I=>!1);function v(){c||t(6,g=!g)}function S(I){t(8,h=r.map(w=>!w.value.toLowerCase().includes(I.currentTarget.value.toLowerCase())))}function k(){t(7,m=i),t(6,g=!1),t(8,h=r.map(I=>!1))}function E(I){if(I.key==="Enter"){const w=h.findIndex(D=>!D);m===i?k():w>-1&&t(6,g=u(r[w].key)),g||(t(8,h=r.map(D=>!1)),I.currentTarget instanceof HTMLElement&&I.currentTarget.blur())}else I.key==="Escape"&&(k(),I.currentTarget instanceof HTMLElement&&I.currentTarget.blur())}function P(I){t(6,g=u(I))}function T(){m=this.value,t(7,m),t(3,i)}const R=()=>t(6,g=!0),O=I=>P(I);function V(I){vs[I?"unshift":"push"](()=>{d=I,t(5,d)})}return s.$$set=I=>{t(14,e=Ae(Ae({},e),Ne(I))),"options"in I&&t(0,r=I.options),"id"in I&&t(1,o=I.id),"containerClass"in I&&t(2,a=I.containerClass),"selected"in I&&t(3,i=I.selected),"disabled"in I&&t(4,c=I.disabled),"onSelect"in I&&t(15,u=I.onSelect),"$$scope"in I&&t(16,l=I.$$scope)},s.$$.update=()=>{s.$$.dirty&8&&t(7,m=i),s.$$.dirty&1&&t(8,h=r.map(I=>!1))},e=Ne(e),[r,o,a,i,c,d,g,m,h,v,S,k,E,P,e,u,l,n,T,R,O,V]}class vl extends Fe{constructor(e){super(),He(this,e,zl,Hl,ze,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:15})}}const sn={1:0,2:2,3:4,4:5,5:7,6:9,7:11};function Xe(s,e=0,t=0){return{interval:`${s}${"♭".repeat(e)}${"♯".repeat(t)}`,interval_seq:s,semitones:bl(s,e,t),flats:e,sharps:t}}function bl(s,e,t){return(s<8?sn[s]:sn[s%7])-e+t+Math.floor(s/8)*12}function yl(s){let e,t=0,n=0;s<0?(t=1+Math.floor(-s/100),e=-s%100):s>100?(n=Math.floor(s/100),e=s%100):e=s;const l=bl(e,t,n);return{interval:`${e}${"♭".repeat(t)}${"♯".repeat(n)}`,interval_seq:e,semitones:l,flats:t,sharps:n}}const ql=[[["maj"],["Major Chord"],"major",[1,3,5]],[["6","△6"],["Major 6th Chord"],"major",[1,3,5,6]],[["6/9","△6/9"],["Major 6th/9th Chord"],"major",[1,3,5,6,9]],[["maj7","△7"],["Major 7th Chord"],"major",[1,3,5,7]],[["maj9","△9"],["Major 9th Chord"],"major",[1,3,5,7,9]],[["maj11","△11"],["Major 11th Chord"],"major",[1,3,5,7,9,11]],[["maj13","△13"],["Major 13th Chord"],"major",[1,3,5,7,9,11,13]],[["m"],["Minor Chord"],"minor",[1,-3,5]],[["m6"],["Minor 6th Chord"],"minor",[1,-3,5,6]],[["m7"],["Minor 7th Chord"],"minor",[1,-3,5,-7]],[["m9"],["Minor 9th Chord"],"minor",[1,-3,5,-7,9]],[["m11"],["Minor 11th Chord"],"minor",[1,-3,5,-7,9,11]],[["m13"],["Minor 13th Chord"],"minor",[1,-3,5,-7,9,11,13]],[["sus2"],["Suspended 2nd Chord"],"suspended",[1,2,5]],[["sus4"],["Suspended 4th Chord"],"suspended",[1,4,5]],[["7sus4"],["Suspended 4th Seventh Chord"],"suspended",[1,4,5,-7]],[["7"],["Dominant 7th Chord"],"major",[1,3,5,-7]],[["7#9"],["Dominant 7th Sharp 9th Chord"],"major",[1,3,5,-7,109]],[["9"],["Dominant 9th Chord"],"major",[1,3,5,-7,9]],[["11"],["Dominant 11th Chord"],"major",[1,3,5,-7,9,11]],[["13"],["Dominant 13th Chord"],"major",[1,3,5,-7,9,11,13]],[["5"],["Power Chord"],"indeterminate",[1,5]],[["dim","°"],["Diminished Chord"],"diminished",[1,-3,-5]],[["dim7","°7"],["Diminished 7th Chord"],"diminished",[1,-3,-5,-107]],[["m7b5"],["Half-Diminished 7th Chord"],"diminished",[1,-3,-5,-7]],[["aug","+"],["Augmented Chord"],"augmented",[1,3,105]],[["aug7","+7"],["Augmented 7th Chord"],"augmented",[1,3,105,-7]]];let Ts=[];function kl(){return ql.map(s=>{const e=s[3].map(yl);return{suffixes:s[0],name:s[1][0],type:s[2],intervals:e}})}function $t(s){Ts.length===0&&(Ts=kl());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return Ts.find(t=>t.suffixes.find(n=>n===e)||t.name.replaceAll(/-|\s/g,"").trim().toLowerCase()===e)}function Wl(s,e,t){let n=e<0?s.flats-e:s.flats,l=e>0?s.sharps+e:s.sharps;if(n>0&&l>0){const o=Math.min(n,l);n-=o,l-=o}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(n)}${"♯".repeat(l)}`,flats:n,sharps:l,midi:t}}function is(s,e,t){const n=[];for(let l=0;l<t.length;l+=1){const r=t[l],o=s+r.semitones,a=e.scaleNotes.find(g=>g.semitones===o%12),i=r.flats>0,c=r.sharps>0,u=(i?o+1:c?o-1:o)%12,d=i?-1:c?1:0;n.push(Wl(a??e.notesMap.get(u),a?0:d,o))}return n}const nn=["B♭","E♭","A♭","D♭","G♭","C♭","F♭"],Jl=["F♯","C♯","G♯","D♯","A♯","E♯","B♯"],ln=new Map([[0,"C"],[-1,"F"],[-2,"B♭"],[-3,"E♭"],[-4,"A♭"],[-5,"D♭"],[-6,"G♭"],[-7,"C♭"],[1,"G"],[2,"D"],[3,"A"],[4,"E"],[5,"B"],[6,"F♯"],[7,"C♯"]]);function Yl(s){let e=0,t=0;for(let n=0;n<nn.length;n+=1){const l=s.find(o=>o.note.slice(0,2)===nn[n]),r=s.find(o=>o.note.slice(0,2)===Jl[n]);if(l)e+=1;else if(r)t+=1;else break}return e>t?{flats:e,sharps:0,majorSignature:ln.get(e*-1)}:{flats:0,sharps:t,majorSignature:ln.get(t)}}function Ql(s){return s>=9?`${s>=10?"X":""}${s===9?"IX":"I".repeat(s%10)}`:`${s>=5?"V":""}${s===4?"IV":"I".repeat(s%5)}`}function wl(s){return s.map(e=>{const t=[Xe(1)];let n;return e.major?(t.push(Xe(3)),e.suffix.startsWith("+")?t.push(Xe(5,0,1)):e.suffix.startsWith("6")?t.push(Xe(6)):e.suffix.startsWith("7")?t.push(Xe(7,1)):e.suffix.startsWith("maj7")?t.push(Xe(7)):n=$t("maj")):e.minor?(t.push(Xe(3,1)),e.suffix.startsWith("°")?t.push(Xe(5,1)):e.suffix.startsWith("6")?(t.push(Xe(6)),n=$t("m"+e.suffix)):e.suffix.startsWith("7")?(t.push(Xe(7,1)),n=$t("m"+e.suffix)):n=$t("m")):e.suffix.startsWith("sus2")?t.push(Xe(2)):e.suffix.startsWith("sus4")&&t.push(Xe(4)),t.length<=2&&t.push(Xe(5)),t.length<=2&&t.push(Xe(8)),n||(n=$t(e.suffix)),{...n,intervals:t}})}function Xl(s,e){let t=e.has(4)&&e.has(7),n=e.has(3)&&e.has(7);const l=Ql(s);let r="";return t||n||(e.has(3)&&e.has(6)?(r="°",n=!0):e.has(4)&&e.has(8)?(r="+",t=!0):e.has(3)&&e.has(10)?(n=!0,r="7"):e.has(4)&&e.has(10)?(r="7",t=!0):e.has(4)&&e.has(11)?(r="maj7",t=!0):e.has(3)&&e.has(8)?(r="6",n=!0):e.has(4)&&e.has(9)?(r="6",t=!0):e.has(2)?r="sus2":e.has(5)?r="sus4":e.has(7)?r="5":r="?"),{degree:s,roman:n?l.toLowerCase():l,suffix:r,major:t,minor:n,semitones:e}}function Zl(s){const e=s.length;return s.map((t,n)=>{const l=t.semitones,r=new Set;for(let o=1;o<e;o+=1){const a=s[(n+o)%e].semitones,i=a<=l?a+12-l:a-l;r.add(i)}return Xl(t.interval_seq,r)})}const eo=[[["Major"],[1,2,3,4,5,6,7]],[["Major Pentatonic","Mongolian"],[1,2,3,5,6]],[["Major Pentatonic Blues"],[1,2,-3,3,5,6]],[["Suspended Pentatonic","Egyptian"],[1,2,4,5,-7]],[["Scottish Pentatonic"],[1,2,4,5,6]],[["Harmonic Major"],[1,2,3,4,5,-6,7]],[["Double Harmonic","Byzantine","Arabic"],[1,-2,3,4,5,-6,7]],[["Minor"],[1,2,-3,4,5,-6,-7]],[["Minor Pentatonic"],[1,-3,4,5,-7]],[["Minor Pentatonic Blues"],[1,-3,4,-5,5,-7]],[["Minor 6th Pentatonic"],[1,-3,4,5,6]],[["Harmonic Minor"],[1,2,-3,4,5,-6,7]],[["Melodic Minor Ascending"],[1,2,-3,4,5,6,7]],[["Melodic Minor Descending"],[1,-7,-6,5,4,-3,2,1]],[["Ionian"],[1,2,3,4,5,6,7]],[["Dorian"],[1,2,-3,4,5,6,-7]],[["Phrygian"],[1,-2,-3,4,5,-6,-7]],[["Phrygian Dominant"],[1,-2,3,4,5,-6,-7]],[["Lydian"],[1,2,3,104,5,6,7]],[["Lydian Dominant","Acoustic"],[1,2,3,104,5,6,-7]],[["Aeolian"],[1,2,-3,4,5,-6,-7]],[["Mixolydian"],[1,2,3,4,5,6,-7]],[["Mixolydian Flat-6"],[1,2,3,4,5,-6,-7]],[["Locrian"],[1,-2,-3,4,-5,-6,-7]],[["Locrian Natural-2","Half-Diminished"],[1,2,-3,4,-5,-6,-7]],[["Super Locrian","Altered scale"],[1,-2,-3,-4,-5,-6,-7]],[["Enigmatic Major"],[1,-2,3,104,105,106,7]],[["Enigmatic Minor"],[1,-2,-3,104,5,106,7]],[["Diminished Whole-Half"],[1,2,-3,4,-5,-6,6,7]],[["Diminished Half-Whole"],[1,-2,-3,-4,-5,5,6,-7]],[["Whole Tone"],[1,2,3,104,105,-7]],[["Augmented"],[1,-3,3,5,105,7]],[["Dominant 7th"],[1,2,4,5,6,-7]],[["Prometheus","Mystic"],[1,2,3,104,6,-7]],[["Overtone"],[1,2,3,104,5,6,-7]],[["Leading Tone"],[1,2,3,104,-6,-7,7]],[["Bebop Major"],[1,2,3,4,5,105,6,7]],[["Bebop Minor"],[1,2,-3,3,4,5,6,-7]],[["Bebop Dominant"],[1,2,3,4,5,6,-7,7]],[["Neapolitan Major"],[1,-2,-3,4,5,6,7]],[["Neapolitan Minor"],[1,-2,-3,4,5,-6,7]],[["Hungarian Major"],[1,102,3,104,5,6,-7]],[["Hungarian Minor"],[1,2,-3,104,5,-6,7]],[["Hungarian Gypsy"],[1,2,-3,104,5,-6,-7]],[["Spanish"],[1,-2,-3,3,-5,-6,-7]],[["Spanish Eight Tone","Jewish Eight Tone"],[1,-2,-3,3,4,-5,-6,-7]],[["Spanish Gypsy"],[1,-2,3,4,5,-6,-7]],[["Hirajoshi"],[1,2,-3,5,-6]],[["Japanese A"],[1,-2,4,-5,6]],[["Japanese B"],[1,2,4,-5,6]],[["Yo"],[1,2,4,5,6,-7]],[["Insen"],[1,-2,4,5,-7]],[["Iwato"],[1,-2,4,-5,-7]],[["Oriental"],[1,-2,3,4,-5,6,-7]],[["Persian"],[1,-2,3,4,-5,-6,7]],[["Arabian"],[1,2,3,4,104,105,-7]],[["Balinese"],[1,-2,-3,5,-6]],[["Kumoi"],[1,2,-3,5,6]],[["Pelog"],[1,-2,-3,5,-6]],[["Algerian"],[1,2,-3,4,104,5,-6,7]],[["Chinese"],[1,104,5,7]],[["Romanian Major"],[1,-2,3,104,5,6,-7]],[["Romanian Minor"],[1,2,-3,104,5,6,-7]],[["Hindu"],[1,2,3,4,5,-6,-7]],[["Istrian"],[1,-2,-3,-4,-5,5]],[["Ukrainian Dorian"],[1,2,-3,104,5,6,-7]]];let As=[];function bs(){return eo.map(s=>{const e=s[0],t=s[1].map(yl),n=Zl(t);return{names:e,intervals:t,triads:n}})}function to(s){As.length===0&&(As=bs());const e=s.replaceAll(/-|\s/g,"").toLowerCase().trim();return As.find(t=>t.names.find(n=>n.replaceAll(/-|\s/g,"").trim().toLowerCase()===e))}const so=/^[a-gA-G][♭Bb#♯sS]*[0-9]?$/,no=/^[0-9]$/,it=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function ps(s){const e=s.midi+s.flats-s.sharps;return e===12?1:Math.floor((e-12)/12)}function mt(s){return`${s.note}${ps(s)}`}function on(s){const t=(s-12)%12;return{...it[t],semitones:t,midi:s}}function lo(s,e=!0,t=!1){if(e&&!so.test(s))return{err:`Unrecognized note "${s}"`,code:400};const n=s.trim(),l=n.charAt(0).toUpperCase(),r=it.find(d=>d.note.charAt(0)===l&&d.note.length===1);if(!r)return{err:`Unable to find note ${n}`,code:500};const o=n.slice(1).split("").reduce((d,g)=>d+(g.toLowerCase()==="b"||g==="♭"?-1:g==="#"||g==="♯"?1:0),0);let a;if(no.test(n.charAt(n.length-1)))try{a=parseInt(n.charAt(n.length-1),10)}catch{}if(t&&a===void 0)return{err:`No octave provided: ${s}`,code:400};a===void 0&&(a=0);let i=(r.semitones+o)%12;i=i<0?i+12:i;const c=o<0?-o:0,u=o>0?o:0;return{data:{note:`${l}${"♭".repeat(c)}${"♯".repeat(u)}`,semitones:i,midi:12+a*12+i,flats:c,sharps:u}}}function Rs(s){const e=it.find(t=>t.note.charAt(0)===s.charAt(0)&&t.note.length===1);if(e){const t=s.slice(1).split("").reduce((l,r)=>l+(r.toLowerCase()==="b"||r==="♭"?-1:r==="#"||r==="♯"?1:0),0),n=(e.semitones+t)%12;return{note:s,semitones:n<0?n+12:n,flats:t<0?-t:0,sharps:t>0?t:0}}}const oo=/^[a-gA-G][♭b#♯]?$/,Ns="ABCDEFG";function ro(s,e){return e.map(t=>Ns.charAt((Ns.indexOf(s)+t.interval_seq-1)%Ns.length))}function ao(s,e,t){return t.map((n,l)=>{const r=e[l],o=(s+n.semitones)%12,a=it[o],i=a.note.charAt(0);if(i<r&&(i!=="A"||r!=="G")||i==="G"&&r==="A"){let c=1,u=it[(o+c)%12];for(;u.note.charAt(0)!==r;)c+=1,u=it[(o+c)%12];return{semitones:o,note:u.note+"♭".repeat(c),flats:c+(u.note.includes("♭")?1:0),sharps:0}}else if(i>r||i==="A"&&r==="G"){let c=1,u=o===0?it.length-1:o-c,d=it[u];for(;d.note.charAt(0)!==r;)c+=1,u=u===0?it.length-1:u-1,d=it[u];return{semitones:o,note:d.note+"♯".repeat(c),flats:0,sharps:c+(d.note.includes("♯")?1:0)}}else return{semitones:o,note:a.note,flats:a.flats,sharps:a.sharps}})}function Ht(s,e){if(!oo.test(s))return{err:`Unknown key: ${s}`,code:400};const t=to(e);if(!t)return{err:`Unknown scale: ${e}`,code:404};const n=`${s.charAt(0).toUpperCase()}${s.charAt(1).replace("b","♭").replace("#","♯")}`,l=Rs(n);if(!l)return{err:`Unable to find root for note: ${n}`,code:404};const r=ro(n.charAt(0),t.intervals),o=ao(l.semitones,r,t.intervals),a=new Map(it.map(i=>{const c=o.find(u=>u.semitones===i.semitones);return c?[i.semitones,c]:[i.semitones,{...i}]}));return{data:{key:n,scale:t.names[0],names:t.names,...Yl(o),intervals:t.intervals.map(i=>({...i})),triads:t.triads.map(i=>({...i})),scaleNotes:o,notesMap:a}}}const Ds=new Map;function io(s,e){try{const t=e==="local"?window.localStorage:window.sessionStorage;return{data:JSON.parse(t.getItem(s)||"")}}catch(t){return{err:`Failed to retrieve value from storage: ${t}`,code:400}}}function co(s,e,t){try{return(t==="local"?window.localStorage:window.sessionStorage).setItem(e,JSON.stringify(s)),{data:void 0}}catch(n){return{err:`Failed to store the value: ${n}`,code:400}}}function bt(s,e){const{key:t,storage:n="local",namespace:l="default"}=e,r=io(t,n),o=Ce(s);"data"in r?s.set(e.deserialize?e.deserialize(r.data):r.data):"err"in r&&(e!=null&&e.debug)&&console.info(r.err);const a=s.subscribe(c=>{const u=co(e.serialize?e.serialize(c):c,t,n);"err"in u&&(e!=null&&e.debug)&&console.error(u.err)}),i=Ds.get(l);return i?i.push({key:t,storage:n,value:s,defaultValue:o,unsubscribe:a}):Ds.set(l,[{key:t,storage:n,value:s,defaultValue:o,unsubscribe:a}]),s}function uo(s=["default"],e){s.forEach(t=>{var n;(n=Ds.get(t))==null||n.forEach(l=>{if(e!=null&&e.cb)e==null||e.cb(l);else try{e!=null&&e.unsubscribe&&l.unsubscribe(),l.value.set(l.defaultValue),(l.storage==="local"?window.localStorage:window.sessionStorage).removeItem(l.key)}catch{}})})}async function fo(s,e){const t=await fetch(s);if(!t.ok)return{err:t.statusText,code:t.status};const n=await t.arrayBuffer();return{data:await e.decodeAudioData(n)}}async function ho(s,e){const t=["/a0.mp3","/a1.mp3","/a2.mp3","/a3.mp3","/a4.mp3","/a5.mp3","/a6.mp3","/a7.mp3","/damper.mp3","/Piano Impulse6.mp3"],n=await Promise.all(t.map(r=>fo(`${s}${r}`,e))),l=[];return n.forEach(r=>{"err"in r?console.error(`Failed to load audio: ${r.err}`):l.push(r.data)}),l}class mo{constructor(e,t,n,l){this.noteA=t.createBufferSource(),this.noteB=t.createBufferSource(),this.gainA=t.createGain(),this.gainB=t.createGain(),this.gain=t.createGain(),this.biquadFilter=t.createBiquadFilter(),this.biquadFilter.type="lowpass",this.biquadFilter.connect(n),this.gain.connect(this.biquadFilter),this.gainA.connect(this.gain),this.noteA.connect(this.gainA),this.gainB.connect(this.gain),this.noteB.connect(this.gainB),e<90&&(this.damp=t.createBufferSource(),this.damp.buffer=l,this.damp.connect(n))}on(e,t,n,l,r,o,a,i){this.noteA.buffer=e,this.noteA.playbackRate.value=n,this.biquadFilter.frequency.value=r,this.gainA.gain.value=o,this.gain.gain.value=i,t&&(this.noteB.buffer=t,this.noteB.playbackRate.value=l,this.gainB.gain.value=a,this.noteB.start(0)),this.noteA.start(0)}off(e,t,n){var l;this.gain.gain.setTargetAtTime(0,e,t),this.noteA.stop(n),this.noteB.stop(n),(l=this.damp)==null||l.start(0)}}class _o{constructor(e){return this.bufferlists=[],this.sus=!1,this.sustained=[],this.notes=new Map,this.context=e,this.convolver=e.createConvolver(),this.directGain=e.createGain(),this.convGain=e.createGain(),this.convGainAfter=e.createGain(),this.convGain.connect(this.convolver),this.convolver.connect(this.convGainAfter),this.convGainAfter.connect(e.destination),this.directGain.connect(e.destination),this.directGain.connect(this.convGain),this.directGain.gain.value=.75,this.convGain.gain.value=0,this.convGainAfter.gain.value=0,this}load(e){e.forEach((t,n)=>{this.bufferlists.push(t),n===8?this.damper=t:n===9&&(this.convolver.buffer=t)})}playChord(e,t=80){e.forEach(n=>{this.noteOn(n,t)})}noteOn(e,t=80){if(e<109&&e>20){const n=this.notes.get(e);n&&(n.off(this.context.currentTime,1.1,this.context.currentTime+2),this.sustained.splice(this.sustained.indexOf(e),1));const l=Math.floor((e-21)/12),r=l+1,o=l*12+21,a=2**((e-69)/12)*440,i=t/127;let c=a*(2-(e-21)/50)+3*a*i;e<60&&(c=440*(3-(60-21)/50)+3*a*i);const u=1-(e%12/12+1)/12,d=Math.pow(2,(e-o)/12),g=0,m=0,h=i**1.4,v=new mo(e,this.context,this.directGain,this.damper);v.on(this.bufferlists[l],this.bufferlists[r],d,g,c,u,m,h),this.notes.set(e,v)}}noteOff(e){if(this.sus)this.sustained.push(e);else{const t=this.notes.get(e);e<90&&t&&t.off(this.context.currentTime+.03,.08,this.context.currentTime+2),this.notes.delete(e)}}sustain(e){if(e==127)this.sus=!0,this.convGain.gain.value=1,this.convGainAfter.gain.value=1;else if(e==0){this.sus=!1,this.convGain.gain.value=0,this.convGainAfter.gain.value=0;for(let t=0;t<this.sustained.length;t++)this.notes.has(this.sustained[t])&&this.noteOff(this.sustained[t]);this.sustained.length=0}}}const po="/midi-note-trainer/",Ls=bt(Ve(!1),{key:"midi-access"}),gs=Ve(void 0),ys=bt(Ve([60,84]),{key:"midi-range",storage:"session"}),Mt=qt(ys,s=>[on(s[0]),on(s[1])]),rn=Ve(void 0),st=Ve(void 0),nt=bt(Ve({fixedVelocity:void 0,keyFadeTimeout:1500,useSound:!0,useKeyboard:!0,useHotkeys:!0,useAutoOctave:!0}),{key:"inputs"}),Pe={async openMidi(){return os.enable().then(()=>(Ls.set(!0),os.inputs.length>0?(gs.set(os.inputs[0]),{data:os.inputs[0]}):{err:"No MIDI device found.",code:400})).catch(s=>({err:s.toString(),code:403}))},disableMidi(){Ls.set(!1),gs.set(void 0)},setMidiRange(s){ys.set(s)},setInputValue(s,e){nt.update(t=>({...t,[s]:e})),s==="useSound"&&!e?st.set(void 0):s==="useSound"&&!Ce(st)&&this.initAudio()},async initAudio(){let s=Ce(rn);if(s||(s=new AudioContext,rn.set(s)),!Ce(st)){const e=new _o(s),t=await ho(`${po}audio`,s);e.load(t),st.set(e)}}};let at;const At=Ve(["C","Major"]),vt=qt(At,s=>{const e=Ht(s[0],s[1]);return"data"in e?e.data:{key:s[0],scale:s[1],names:["major"],flats:0,sharps:0,majorSignature:"C",intervals:[],scaleNotes:[],triads:[],notesMap:new Map}}),an=Ve([]),wt=Ve([]);function Os(s,e){if(s.length>0){const t=Date.now();let n=t;const l=s.filter(r=>(r.started+e>t&&(n=Math.min(n,r.started)),r.started+e>t));return!at&&l.length>0&&(at=setTimeout(()=>{at=void 0,wt.update(r=>Os(r,e))},e-(t-n)+100)),l}return s}const Se={setKey(s){At.update(e=>[s,e[1]])},setScale(s){At.update(e=>[e[0],s])},setKeyAndScale(s,e){At.set([s,e])},setTarget(s=[]){an.set(s)},getNote(s){return{...Ce(vt).notesMap.get(s%12),midi:s}},pushPlayed(s,e,t){const l={...Ce(vt).notesMap.get(s%12),midi:s},r=Date.now(),o=e===void 0?"default":e?"correct":"wrong";if(wt.update(a=>{const i=a.findIndex(c=>c.midi===s);return i>=0&&a.splice(i,1),[...a,{...l,color:o,started:r}]}),!at&&t!==-1){const a=t??Ce(nt).keyFadeTimeout;at=setTimeout(()=>{at=void 0,wt.update(i=>Os(i,a))},a)}},setPlayed(s,e,t){const n=Date.now(),l=e===void 0?"default":e?"correct":"wrong";if(wt.update(r=>[...s.map(o=>({...o,color:l,started:n}))]),!at&&t!==-1){const r=t??Ce(nt).keyFadeTimeout;at=setTimeout(()=>{at=void 0,wt.update(o=>Os(o,r))},r)}},clearPlayed(){wt.set([]),clearTimeout(at),at=void 0},clearScore(s=!1){s&&At.set(["C","Major"]),an.set([]),wt.set([])}};class Us{constructor(e,t,n){this.guesses=[],this.times=[],this.correct=0,this.guessed=0,this.idx=0,this.type=e,this.data=t,this.baseOptions=n;const l=[],{count:r}=n,o=t.map(i=>typeof i=="object"&&i!==null?{...i}:i);let a=n.duplicates;!n.duplicates&&r>o.length&&(console.warn(`Trying to create game with count ${r} larger than available unique values ${t.length}`),a=!0);for(let i=0;i<r;i+=1){const c=Math.floor(Math.random()*o.length);if(a)l.push(o[c]);else{const u=o.splice(c,1);u.length>0&&l.push(u[0])}}this.sampled=l,this.timing=performance.now()}get current(){return this.sampled[this.idx]}get latestGuess(){const e=this.sampled[this.idx-1],t=this.guesses[this.idx-1];return{target:e,guessed:t}}get ended(){return this.sampled.length<this.idx+1}get avgTime(){let e=0;for(let t=0;t<this.times.length;t+=1)e+=this.times[t];return Math.round(e/10/this.times.length)/100}addGuessed(e,t){return this.guesses.push(e),t&&(this.correct+=1),this.idx+=1,this.times.push(performance.now()-this.timing),t}guess(e){return!1}startTime(){this.timing=performance.now()}}function go(s,e,t){let n=e<0?s.flats-e:s.flats,l=e>0?s.sharps+e:s.sharps;if(n>0&&l>0){const o=Math.min(n,l);n-=o,l-=o}const r=(s.semitones+e)%12;return{...s,semitones:r<0?r+12:r,note:`${s.note.charAt(0)}${"♭".repeat(n)}${"♯".repeat(l)}`,flats:n,sharps:l,midi:t}}function vo(s,e,t){const n=[];for(let l=0;l<t.length;l+=1){const r=t[l],o=s+r.semitones,a=e.scaleNotes.find(g=>g.semitones===o%12),i=r.flats>0,c=r.sharps>0,u=(i?o+1:c?o-1:o)%12,d=i?-1:c?1:0;n.push(go(a??e.notesMap.get(u),a?0:d,o))}return n}const bo=[{note:"C",semitones:0,sharps:0,flats:0},{note:"C♯",semitones:1,sharps:1,flats:0},{note:"D",semitones:2,sharps:0,flats:0},{note:"E♭",semitones:3,sharps:0,flats:1},{note:"E",semitones:4,sharps:0,flats:0},{note:"F",semitones:5,sharps:0,flats:0},{note:"F♯",semitones:6,sharps:1,flats:0},{note:"G",semitones:7,sharps:0,flats:0},{note:"G♯",semitones:8,sharps:1,flats:0},{note:"A",semitones:9,sharps:0,flats:0},{note:"B♭",semitones:10,sharps:0,flats:1},{note:"B",semitones:11,sharps:0,flats:0}];function yo(s){const t=(s-12)%12;return{...bo[t],semitones:t,midi:s}}function ko(s){return`${s.note.trim().charAt(0).toUpperCase()}${"♭".repeat(s.flats)}${"♯".repeat(s.sharps)}`}class pt extends Us{constructor(e,t,n){const l=t.range[0],r=t.range[1],o=new Set(t.scale.scaleNotes.map(i=>i.semitones)),a=n.chords.flatMap(i=>{const c=[],u=i.intervals.reduce((d,g)=>g.semitones>d?g.semitones:d,0);for(let d=l;d<=r-u;d+=1)if((!n.onlyScale||o.has(d%12))&&(!i.allowed||i.allowed.has(d%12))){const g=vo(d,t.scale,i.intervals);c.push({...i,rootNote:g[0].note,chord:`${g[0].note}${i.suffixes[0]}`,notes:g})}return c});super(e,a,t),this.played=new Set,this.opts=n}addPlayedNote(e){this.played.add(e)}guessWrittenChord(e){const t={chord:`${ko(e)}${e.chord.toLowerCase()}`,notes:[]};let n=this.current.chord===t.chord;return this.current.chord.slice(-3)==="maj"&&!n&&(n=this.current.chord.slice(0,-3)===t.chord),this.addGuessed(t,n)}guess(){const e=Array.from(this.played.values()).map(l=>yo(l)).sort((l,r)=>l.midi-r.midi);this.played.clear();const t={chord:"",notes:e},n=this.current.notes.every(l=>e.find(r=>r.midi%12===l.midi%12));return this.addGuessed(t,n)}}const wo={major:{C:{num:0},F:{acc:"b",num:1},Bb:{acc:"b",num:2},Eb:{acc:"b",num:3},Ab:{acc:"b",num:4},Db:{acc:"b",num:5},Gb:{acc:"b",num:6},Cb:{acc:"b",num:7},G:{acc:"#",num:1},D:{acc:"#",num:2},A:{acc:"#",num:3},E:{acc:"#",num:4},B:{acc:"#",num:5},"F#":{acc:"#",num:6},"C#":{acc:"#",num:7}},minor:{A:{num:0},D:{acc:"b",num:1},G:{acc:"b",num:2},C:{acc:"b",num:3},F:{acc:"b",num:4},Bb:{acc:"b",num:5},Eb:{acc:"b",num:6},Ab:{acc:"b",num:7},E:{acc:"#",num:1},B:{acc:"#",num:2},"F#":{acc:"#",num:3},"C#":{acc:"#",num:4},"G#":{acc:"#",num:5},"D#":{acc:"#",num:6},"A#":{acc:"#",num:7}}};class zt extends Us{constructor(e,t){const n=e==="keys-major"?"major":"minor";super(e,Object.keys(wo[n]),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}class Pt extends Us{constructor(e,t){const n=t.range[0],l=t.range[1];super(e,Array.from(new Array(l-n+1)).map((r,o)=>n+o),t)}guess(e){const t=this.current===e;return this.addGuessed(e,t)}}const El={count:10,duplicates:!0,autoplay:!0,waitSeconds:3},_t=Ve("waiting"),gt=bt(Ve(El),{key:"game-options"}),It=Ve(void 0),xs=Ve(kl().map(s=>({...s,selected:!0}))),De={play(...[s,e]){var i,c,u;let t;const n=Ce(vt),l=Ce(ys),r=Ce(gt),o={scale:n,range:l,duplicates:r.duplicates,count:r.count};let a=[n.key,n.scale];if(s==="notes")t=new Pt(s,o),Se.setTarget([Se.getNote(t.current)]),(i=Ce(st))==null||i.noteOn(t.current);else if(s==="pitches")t=new Pt(s,o),Se.setTarget(),Pe.setInputValue("useSound",!0),(c=Ce(st))==null||c.noteOn(t.current);else if(s==="keys-major"||s=="keys-minor")t=new zt(s,o),a=[t.current,s==="keys-major"?"major":"minor"];else if(s==="chords-play"||s==="chords-write")t=new pt(s,o,e);else if(s==="chords-diatonic"){const d=wl(n.triads).map((g,m)=>({...g,allowed:new Set([n.scaleNotes[m].semitones])}));t=new pt(s,o,{chords:d})}else throw Error("Unknown game type: "+s);return typeof t.current!="number"&&typeof t.current!="string"&&((u=Ce(st))==null||u.playChord(t.current.notes.map(d=>d.midi)),Se.setTarget(t.current.notes)),Se.setKeyAndScale(a[0],a[1]),Se.clearPlayed(),_t.set("waiting"),It.set(t),t},updateState(s){_t.set(s)},setOptionValue(s,e){gt.update(t=>({...t,[s]:e}))},toggleChords(s){xs.update(e=>e.map(t=>({...t,selected:s(t)})))},nextGuess(){var e,t;const s=Ce(It);s!=null&&s.ended?_t.set("ended"):s instanceof Pt?(s.type==="notes"?Se.setTarget([Se.getNote(s.current)]):Se.setTarget(),Se.clearPlayed(),(e=Ce(st))==null||e.noteOn(s.current),De.updateState("waiting"),s.startTime()):s instanceof pt?(Se.setTarget(s.current.notes),Se.clearPlayed(),(t=Ce(st))==null||t.playChord(s==null?void 0:s.current.notes.map(n=>n.midi)),_t.set("waiting"),s.startTime()):s instanceof zt&&(Se.setKey(s.current),_t.set("waiting"),s.startTime())},clearGame(s=!1){const e=Ce(It);e&&Se.setKeyAndScale(e.baseOptions.scale.key,e.baseOptions.scale.scale),s&&gt.set(El),It.set(void 0),_t.set("waiting"),Se.clearScore()}};function cn(s,e,t){const n=s.slice();return n[35]=e[t],n[37]=t,n}function un(s,e,t){const n=s.slice();return n[40]=e[t],n}function fn(s,e,t){const n=s.slice();return n[9]=e[t],n}function dn(s,e,t){const n=s.slice();return n[35]=e[t],n[37]=t,n}function hn(s,e,t){const n=s.slice();return n[40]=e[t],n}function mn(s,e,t){const n=s.slice();return n[9]=e[t],n}function Eo(s){let e,t=_e(s[35].intervals),n=[];for(let l=0;l<t.length;l+=1)n[l]=_n(hn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let r=0;r<n.length;r+=1)n[r].l(l);e=Le()},m(l,r){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(l,r);M(l,e,r)},p(l,r){if(r[0]&128){t=_e(l[35].intervals);let o;for(o=0;o<t.length;o+=1){const a=hn(l,t,o);n[o]?n[o].p(a,r):(n[o]=_n(a),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Co(s){let e,t=_e(s[3][s[37]]),n=[];for(let l=0;l<t.length;l+=1)n[l]=pn(mn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let r=0;r<n.length;r+=1)n[r].l(l);e=Le()},m(l,r){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(l,r);M(l,e,r)},p(l,r){if(r[0]&8){t=_e(l[3][l[37]]);let o;for(o=0;o<t.length;o+=1){const a=mn(l,t,o);n[o]?n[o].p(a,r):(n[o]=pn(a),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function _n(s){let e,t=s[40].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var r=C(e);n=te(r,t),r.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,r){M(l,e,r),f(e,n)},p(l,r){r[0]&128&&t!==(t=l[40].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function pn(s){let e,t=s[9].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var r=C(e);n=te(r,t),r.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,r){M(l,e,r),f(e,n)},p(l,r){r[0]&8&&t!==(t=l[9].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function gn(s){let e,t,n,l,r,o,a=s[35].suffixes[0]+"",i,c,u,d,g,m,h,v=s[35].name+"",S,k,E,P,T;l=new Me({props:{icon:s[35].selected?ms:_s,width:12}});function R(){return s[25](s[35])}function O(D,N){return D[3][D[37]]&&D[3][D[37]].length>0?Co:Eo}let V=O(s),I=V(s);function w(){return s[26](s[35])}return{c(){e=b("li"),t=b("button"),n=b("span"),ue(l.$$.fragment),r=j(),o=b("div"),i=ee(a),c=j(),u=b("li"),I.c(),g=j(),m=b("li"),h=b("button"),S=ee(v),k=j(),this.h()},l(D){e=y(D,"LI",{});var N=C(e);t=y(N,"BUTTON",{class:!0});var L=C(t);n=y(L,"SPAN",{class:!0});var A=C(n);fe(l.$$.fragment,A),A.forEach(_),r=B(L),o=y(L,"DIV",{class:!0});var G=C(o);i=te(G,a),G.forEach(_),L.forEach(_),N.forEach(_),c=B(D),u=y(D,"LI",{class:!0,title:!0});var x=C(u);I.l(x),x.forEach(_),g=B(D),m=y(D,"LI",{class:!0});var $=C(m);h=y($,"BUTTON",{class:!0});var Q=C(h);S=te(Q,v),Q.forEach(_),k=B($),$.forEach(_),this.h()},h(){p(n,"class","px-1 py-1 rounded"),W(n,"text-green-500",s[35].selected),W(n,"text-gray-400",!s[35].selected),p(o,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),p(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),W(t,"hidden",s[8]),p(u,"class","intervals svelte-1rg0xw5"),p(u,"title",d=s[35].intervals.map(kn).join("-")),p(h,"class","text-start"),p(m,"class","text-xs")},m(D,N){M(D,e,N),f(e,t),f(t,n),de(l,n,null),f(t,r),f(t,o),f(o,i),M(D,c,N),M(D,u,N),I.m(u,null),M(D,g,N),M(D,m,N),f(m,h),f(h,S),f(m,k),E=!0,P||(T=[Y(t,"click",R),Y(h,"click",w)],P=!0)},p(D,N){s=D;const L={};N[0]&128&&(L.icon=s[35].selected?ms:_s),l.$set(L),(!E||N[0]&128)&&W(n,"text-green-500",s[35].selected),(!E||N[0]&128)&&W(n,"text-gray-400",!s[35].selected),(!E||N[0]&128)&&a!==(a=s[35].suffixes[0]+"")&&ye(i,a),(!E||N[0]&256)&&W(t,"hidden",s[8]),V===(V=O(s))&&I?I.p(s,N):(I.d(1),I=V(s),I&&(I.c(),I.m(u,null))),(!E||N[0]&128&&d!==(d=s[35].intervals.map(kn).join("-")))&&p(u,"title",d),(!E||N[0]&128)&&v!==(v=s[35].name+"")&&ye(S,v)},i(D){E||(U(l.$$.fragment,D),E=!0)},o(D){z(l.$$.fragment,D),E=!1},d(D){D&&(_(e),_(c),_(u),_(g),_(m)),he(l),I.d(),P=!1,Ye(T)}}}function Io(s){let e,t=_e(s[35].intervals),n=[];for(let l=0;l<t.length;l+=1)n[l]=vn(un(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let r=0;r<n.length;r+=1)n[r].l(l);e=Le()},m(l,r){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(l,r);M(l,e,r)},p(l,r){if(r[0]&64){t=_e(l[35].intervals);let o;for(o=0;o<t.length;o+=1){const a=un(l,t,o);n[o]?n[o].p(a,r):(n[o]=vn(a),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function To(s){let e,t=_e(s[4][s[37]]),n=[];for(let l=0;l<t.length;l+=1)n[l]=bn(fn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let r=0;r<n.length;r+=1)n[r].l(l);e=Le()},m(l,r){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(l,r);M(l,e,r)},p(l,r){if(r[0]&16){t=_e(l[4][l[37]]);let o;for(o=0;o<t.length;o+=1){const a=fn(l,t,o);n[o]?n[o].p(a,r):(n[o]=bn(a),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function vn(s){let e,t=s[40].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var r=C(e);n=te(r,t),r.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,r){M(l,e,r),f(e,n)},p(l,r){r[0]&64&&t!==(t=l[40].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function bn(s){let e,t=s[9].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var r=C(e);n=te(r,t),r.forEach(_),this.h()},h(){p(e,"class","svelte-1rg0xw5")},m(l,r){M(l,e,r),f(e,n)},p(l,r){r[0]&16&&t!==(t=l[9].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function yn(s){let e,t,n,l,r,o,a=s[35].suffixes[0]+"",i,c,u,d,g,m,h,v=s[35].name+"",S,k,E,P,T;l=new Me({props:{icon:s[35].selected?ms:_s,width:12}});function R(){return s[27](s[35])}function O(D,N){return D[4][D[37]]&&D[4][D[37]].length>0?To:Io}let V=O(s),I=V(s);function w(){return s[28](s[35])}return{c(){e=b("li"),t=b("button"),n=b("span"),ue(l.$$.fragment),r=j(),o=b("div"),i=ee(a),c=j(),u=b("li"),I.c(),g=j(),m=b("li"),h=b("button"),S=ee(v),k=j(),this.h()},l(D){e=y(D,"LI",{});var N=C(e);t=y(N,"BUTTON",{class:!0});var L=C(t);n=y(L,"SPAN",{class:!0});var A=C(n);fe(l.$$.fragment,A),A.forEach(_),r=B(L),o=y(L,"DIV",{class:!0});var G=C(o);i=te(G,a),G.forEach(_),L.forEach(_),N.forEach(_),c=B(D),u=y(D,"LI",{class:!0,title:!0});var x=C(u);I.l(x),x.forEach(_),g=B(D),m=y(D,"LI",{class:!0});var $=C(m);h=y($,"BUTTON",{class:!0});var Q=C(h);S=te(Q,v),Q.forEach(_),k=B($),$.forEach(_),this.h()},h(){p(n,"class","px-1 py-1 rounded"),W(n,"text-green-500",s[35].selected),W(n,"text-gray-400",!s[35].selected),p(o,"class","ml-1 px-1 w-full bg-gray-200 svelte-1rg0xw5"),p(t,"class","flex items-center justify-center w-full select-btn svelte-1rg0xw5"),W(t,"hidden",s[8]),p(u,"class","intervals svelte-1rg0xw5"),p(u,"title",d=s[35].intervals.map(wn).join("-")),p(h,"class","text-start"),p(m,"class","text-xs")},m(D,N){M(D,e,N),f(e,t),f(t,n),de(l,n,null),f(t,r),f(t,o),f(o,i),M(D,c,N),M(D,u,N),I.m(u,null),M(D,g,N),M(D,m,N),f(m,h),f(h,S),f(m,k),E=!0,P||(T=[Y(t,"click",R),Y(h,"click",w)],P=!0)},p(D,N){s=D;const L={};N[0]&64&&(L.icon=s[35].selected?ms:_s),l.$set(L),(!E||N[0]&64)&&W(n,"text-green-500",s[35].selected),(!E||N[0]&64)&&W(n,"text-gray-400",!s[35].selected),(!E||N[0]&64)&&a!==(a=s[35].suffixes[0]+"")&&ye(i,a),(!E||N[0]&256)&&W(t,"hidden",s[8]),V===(V=O(s))&&I?I.p(s,N):(I.d(1),I=V(s),I&&(I.c(),I.m(u,null))),(!E||N[0]&64&&d!==(d=s[35].intervals.map(wn).join("-")))&&p(u,"title",d),(!E||N[0]&64)&&v!==(v=s[35].name+"")&&ye(S,v)},i(D){E||(U(l.$$.fragment,D),E=!0)},o(D){z(l.$$.fragment,D),E=!1},d(D){D&&(_(e),_(c),_(u),_(g),_(m)),he(l),I.d(),P=!1,Ye(T)}}}function Ao(s){let e,t,n,l,r="Chords",o,a,i,c,u,d,g,m,h,v,S,k,E,P,T,R,O,V="Key",I,w,D,N,L="Scale",A,G,x,$,Q="Note",F,X,Z,K,J,H,me,pe,Re,ie;c=new Me({props:{icon:Ml,width:20}}),g=new Me({props:{icon:Rl,width:16}}),v=new Me({props:{icon:s[5]?Ws:Js,width:16}}),E=new Me({props:{icon:Wt,width:16}}),G=new vl({props:{id:"chords-scale",class:"bg-gray-100 w-48",containerClass:"input w-48",selected:s[1],options:s[10],onSelect:s[14]}});let ce=_e(s[7]),le=[];for(let q=0;q<ce.length;q+=1)le[q]=gn(dn(s,ce,q));const re=q=>z(le[q],1,1,()=>{le[q]=null});let ge=_e(s[6]),we=[];for(let q=0;q<ge.length;q+=1)we[q]=yn(cn(s,ge,q));const tt=q=>z(we[q],1,1,()=>{we[q]=null});return{c(){e=b("div"),t=b("fieldset"),n=b("legend"),l=b("button"),l.textContent=r,o=j(),a=b("div"),i=b("button"),ue(c.$$.fragment),u=j(),d=b("button"),ue(g.$$.fragment),m=j(),h=b("button"),ue(v.$$.fragment),S=j(),k=b("button"),ue(E.$$.fragment),P=j(),T=b("div"),R=b("div"),O=b("label"),O.textContent=V,I=j(),w=b("input"),D=j(),N=b("label"),N.textContent=L,A=j(),ue(G.$$.fragment),x=j(),$=b("label"),$.textContent=Q,F=j(),X=b("input"),Z=j(),K=b("ul");for(let q=0;q<le.length;q+=1)le[q].c();J=j(),H=b("ul");for(let q=0;q<we.length;q+=1)we[q].c();this.h()},l(q){e=y(q,"DIV",{class:!0});var oe=C(e);t=y(oe,"FIELDSET",{class:!0});var Ee=C(t);n=y(Ee,"LEGEND",{class:!0});var Ue=C(n);l=y(Ue,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1knqzl6"&&(l.textContent=r),Ue.forEach(_),o=B(Ee),a=y(Ee,"DIV",{class:!0});var ne=C(a);i=y(ne,"BUTTON",{class:!0});var qe=C(i);fe(c.$$.fragment,qe),qe.forEach(_),u=B(ne),d=y(ne,"BUTTON",{class:!0});var je=C(d);fe(g.$$.fragment,je),je.forEach(_),m=B(ne),h=y(ne,"BUTTON",{class:!0});var ut=C(h);fe(v.$$.fragment,ut),ut.forEach(_),S=B(ne),k=y(ne,"BUTTON",{class:!0});var et=C(k);fe(E.$$.fragment,et),et.forEach(_),ne.forEach(_),P=B(Ee),T=y(Ee,"DIV",{class:!0});var Qe=C(T);R=y(Qe,"DIV",{class:!0});var We=C(R);O=y(We,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(O)!=="svelte-4jiw22"&&(O.textContent=V),I=B(We),w=y(We,"INPUT",{class:!0,id:!0}),D=B(We),N=y(We,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(N)!=="svelte-162gpi4"&&(N.textContent=L),A=B(We),fe(G.$$.fragment,We),x=B(We),$=y(We,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae($)!=="svelte-nkwohg"&&($.textContent=Q),F=B(We),X=y(We,"INPUT",{class:!0,id:!0}),We.forEach(_),Z=B(Qe),K=y(Qe,"UL",{class:!0});var St=C(K);for(let xe=0;xe<le.length;xe+=1)le[xe].l(St);St.forEach(_),J=B(Qe),H=y(Qe,"UL",{class:!0});var ft=C(H);for(let xe=0;xe<we.length;xe+=1)we[xe].l(ft);ft.forEach(_),Qe.forEach(_),Ee.forEach(_),oe.forEach(_),this.h()},h(){p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(i,"class","flex items-center justify-center rounded px-0.5 hover:bg-gray-200"),W(i,"hidden",s[8]),p(d,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(d,"hidden",s[8]),p(h,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(h,"hidden",s[8]),p(k,"class","flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(k,"hidden",s[8]),p(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex"),p(O,"class","mr-4 font-bold svelte-1rg0xw5"),p(O,"for","chords-key"),p(w,"class","input bg-gray-100 w-12 px-1 rounded"),p(w,"id","chords-key"),w.value=s[0],p(N,"class","font-bold svelte-1rg0xw5"),p(N,"for","chords-scale"),p($,"class","font-bold svelte-1rg0xw5"),p($,"for","chords-note"),p(X,"class","input bg-gray-100 w-12 px-1 rounded"),p(X,"id","chords-note"),X.value=s[2],p(R,"class","flex mb-2 options svelte-1rg0xw5"),p(K,"class","chord-list w-full svelte-1rg0xw5"),p(H,"class","chord-list w-full svelte-1rg0xw5"),p(T,"class","body svelte-1rg0xw5"),W(T,"hidden",s[8]),p(t,"class","flex flex-col relative rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1rg0xw5"),W(t,"collapsed",s[8]),p(e,"class",me=Te(`${s[22].class||""}`)+" svelte-1rg0xw5")},m(q,oe){M(q,e,oe),f(e,t),f(t,n),f(n,l),f(t,o),f(t,a),f(a,i),de(c,i,null),f(a,u),f(a,d),de(g,d,null),f(a,m),f(a,h),de(v,h,null),f(a,S),f(a,k),de(E,k,null),f(t,P),f(t,T),f(T,R),f(R,O),f(R,I),f(R,w),f(R,D),f(R,N),f(R,A),de(G,R,null),f(R,x),f(R,$),f(R,F),f(R,X),f(T,Z),f(T,K);for(let Ee=0;Ee<le.length;Ee+=1)le[Ee]&&le[Ee].m(K,null);f(T,J),f(T,H);for(let Ee=0;Ee<we.length;Ee+=1)we[Ee]&&we[Ee].m(H,null);pe=!0,Re||(ie=[Y(l,"click",s[12]),Y(i,"click",s[17]),Y(d,"click",s[18]),Y(h,"click",s[19]),Y(k,"click",s[20]),Y(w,"input",s[13]),Y(X,"input",s[15])],Re=!0)},p(q,oe){(!pe||oe[0]&256)&&W(i,"hidden",q[8]),(!pe||oe[0]&256)&&W(d,"hidden",q[8]);const Ee={};oe[0]&32&&(Ee.icon=q[5]?Ws:Js),v.$set(Ee),(!pe||oe[0]&256)&&W(h,"hidden",q[8]),(!pe||oe[0]&256)&&W(k,"hidden",q[8]),(!pe||oe[0]&1&&w.value!==q[0])&&(w.value=q[0]);const Ue={};if(oe[0]&2&&(Ue.selected=q[1]),G.$set(Ue),(!pe||oe[0]&4&&X.value!==q[2])&&(X.value=q[2]),oe[0]&2163080){ce=_e(q[7]);let ne;for(ne=0;ne<ce.length;ne+=1){const qe=dn(q,ce,ne);le[ne]?(le[ne].p(qe,oe),U(le[ne],1)):(le[ne]=gn(qe),le[ne].c(),U(le[ne],1),le[ne].m(K,null))}for(Ke(),ne=ce.length;ne<le.length;ne+=1)re(ne);$e()}if(oe[0]&2163024){ge=_e(q[6]);let ne;for(ne=0;ne<ge.length;ne+=1){const qe=cn(q,ge,ne);we[ne]?(we[ne].p(qe,oe),U(we[ne],1)):(we[ne]=yn(qe),we[ne].c(),U(we[ne],1),we[ne].m(H,null))}for(Ke(),ne=ge.length;ne<we.length;ne+=1)tt(ne);$e()}(!pe||oe[0]&256)&&W(T,"hidden",q[8]),(!pe||oe[0]&256)&&W(t,"collapsed",q[8]),(!pe||oe[0]&4194304&&me!==(me=Te(`${q[22].class||""}`)+" svelte-1rg0xw5"))&&p(e,"class",me)},i(q){if(!pe){U(c.$$.fragment,q),U(g.$$.fragment,q),U(v.$$.fragment,q),U(E.$$.fragment,q),U(G.$$.fragment,q);for(let oe=0;oe<ce.length;oe+=1)U(le[oe]);for(let oe=0;oe<ge.length;oe+=1)U(we[oe]);pe=!0}},o(q){z(c.$$.fragment,q),z(g.$$.fragment,q),z(v.$$.fragment,q),z(E.$$.fragment,q),z(G.$$.fragment,q),le=le.filter(Boolean);for(let oe=0;oe<le.length;oe+=1)z(le[oe]);we=we.filter(Boolean);for(let oe=0;oe<we.length;oe+=1)z(we[oe]);pe=!1},d(q){q&&_(e),he(c),he(g),he(v),he(E),he(G),Oe(le,q),Oe(we,q),Re=!1,Ye(ie)}}}const kn=s=>s.interval,wn=s=>s.interval;function No(s,e,t){let n,l,r,o,a,i,c,u,d;be(s,nt,K=>t(30,a=K)),be(s,st,K=>t(31,i=K)),be(s,Mt,K=>t(32,c=K)),be(s,xs,K=>t(24,u=K));let g="C",m="Major",h=Ht(g,m),v="",S,k=[],E=[];const T=bs().map(K=>({key:K.names[0],value:K.names[0]})),R=bt(Ve(!0),{key:"chords-hidden"});be(s,R,K=>t(8,d=K));function O(){R.update(K=>!K)}function V(){const K=S&&60+S.semitones;if("err"in h||!K)t(3,k=[]),t(4,E=[]);else{const J=h.data;t(3,k=l.map(H=>is(K,J,H.intervals))),t(4,E=r.map(H=>is(K,J,H.intervals)))}}function I({currentTarget:{value:K}}){t(0,g=`${K.charAt(0).toUpperCase()}${K.charAt(1).toLowerCase()}`),h=Ht(g,m),V()}function w(K){var J;return t(1,m=(J=T.find(H=>K===H.key))==null?void 0:J.value),h=Ht(g,m),V(),!1}function D({currentTarget:{value:K}}){t(2,v=`${K.charAt(0).toUpperCase()}${K.charAt(1).toLowerCase()}`),t(9,S=Rs(v)),V()}function N(K){De.toggleChords(J=>J.name===K.name?!J.selected:J.selected)}function L(){const K=H=>H.suffixes[0]==="maj"||H.suffixes[0]==="m",J=u.filter(K).every(H=>H.selected);De.toggleChords(H=>K(H)?!J:H.selected)}function A(){const K=H=>H.suffixes[0]==="maj7"||H.suffixes[0]==="m7"||H.suffixes[0]==="7"||H.suffixes[0]==="dim7"||H.suffixes[0]==="aug7",J=u.filter(K).every(H=>H.selected);De.toggleChords(H=>K(H)?!J:H.selected)}function G(){De.toggleChords(K=>!o)}function x(){De.toggleChords(K=>!0)}function $(K){if("err"in h)return;const J=c[0].midi+((S==null?void 0:S.semitones)||0),H=is(J,h.data,K.intervals);i==null||i.playChord(H.map(me=>me.midi),a.fixedVelocity)}const Q=K=>N(K),F=K=>$(K),X=K=>N(K),Z=K=>$(K);return s.$$set=K=>{t(22,e=Ae(Ae({},e),Ne(K)))},s.$$.update=()=>{s.$$.dirty[0]&16777216&&t(23,n=u),s.$$.dirty[0]&8388608&&t(7,l=n.filter((K,J)=>J<n.length/2)),s.$$.dirty[0]&8388608&&t(6,r=n.filter((K,J)=>J>=n.length/2)),s.$$.dirty[0]&8388608&&t(5,o=n.every(K=>K.selected))},e=Ne(e),[g,m,v,k,E,o,r,l,d,S,T,R,O,I,w,D,N,L,A,G,x,$,e,n,u,Q,F,X,Z]}class So extends Fe{constructor(e){super(),He(this,e,No,Ao,ze,{},null,[-1,-1])}}function En(s,e,t){const n=s.slice();return n[12]=e[t],n}function Do(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){M(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&_(e)}}}function Lo(s){let e,t,n="Played:",l,r=_e(s[2]),o=[];for(let a=0;a<r.length;a+=1)o[a]=Cn(En(s,r,a));return{c(){e=b("div"),t=b("span"),t.textContent=n,l=j();for(let a=0;a<o.length;a+=1)o[a].c()},l(a){e=y(a,"DIV",{});var i=C(e);t=y(i,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1g6xxhn"&&(t.textContent=n),l=B(i);for(let c=0;c<o.length;c+=1)o[c].l(i);i.forEach(_)},m(a,i){M(a,e,i),f(e,t),f(e,l);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(e,null)},p(a,i){if(i&4){r=_e(a[2]);let c;for(c=0;c<r.length;c+=1){const u=En(a,r,c);o[c]?o[c].p(u,i):(o[c]=Cn(u),o[c].c(),o[c].m(e,null))}for(;c<o.length;c+=1)o[c].d(1);o.length=r.length}},i:ve,o:ve,d(a){a&&_(e),Oe(o,a)}}}function Oo(s){let e,t,n="Result:",l,r,o,a=s[0].correct+"",i,c,u=s[0].sampled.length+"",d,g,m,h,v,S=s[0].avgTime+"",k,E;return{c(){e=b("div"),t=b("span"),t.textContent=n,l=j(),r=b("span"),o=ee("["),i=ee(a),c=ee(" / "),d=ee(u),g=ee("]"),m=j(),h=b("span"),v=ee("avg "),k=ee(S),E=ee("s"),this.h()},l(P){e=y(P,"DIV",{class:!0});var T=C(e);t=y(T,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1eqfbgx"&&(t.textContent=n),l=B(T),r=y(T,"SPAN",{class:!0});var R=C(r);o=te(R,"["),i=te(R,a),c=te(R," / "),d=te(R,u),g=te(R,"]"),R.forEach(_),m=B(T),h=y(T,"SPAN",{});var O=C(h);v=te(O,"avg "),k=te(O,S),E=te(O,"s"),O.forEach(_),T.forEach(_),this.h()},h(){p(r,"class","mx-2"),p(e,"class","flex")},m(P,T){M(P,e,T),f(e,t),f(e,l),f(e,r),f(r,o),f(r,i),f(r,c),f(r,d),f(r,g),f(e,m),f(e,h),f(h,v),f(h,k),f(h,E)},p(P,T){T&1&&a!==(a=P[0].correct+"")&&ye(i,a),T&1&&u!==(u=P[0].sampled.length+"")&&ye(d,u),T&1&&S!==(S=P[0].avgTime+"")&&ye(k,S)},i:ve,o:ve,d(P){P&&_(e)}}}function Vo(s){var D,N,L,A;let e,t,n="Target:",l,r,o=((D=s[0].latestGuess.target)==null?void 0:D.chord)+"",a,i,c,u=((N=s[0].latestGuess.target)==null?void 0:N.notes.map(In).join(" "))+"",d,g,m,h,v,S,k,E,P=((L=s[0].latestGuess.guessed)==null?void 0:L.chord)+"",T,R,O,V=((A=s[0].latestGuess.guessed)==null?void 0:A.notes.map(Tn).join(" "))+"",I,w;return v=new Me({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=n,l=j(),r=b("span"),a=ee(o),i=j(),c=b("span"),d=ee(u),g=j(),m=b("span"),h=b("div"),ue(v.$$.fragment),S=ee(`
        Guessed:`),k=j(),E=b("span"),T=ee(P),R=j(),O=b("span"),I=ee(V),this.h()},l(G){e=y(G,"DIV",{class:!0});var x=C(e);t=y(x,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1pddpsb"&&(t.textContent=n),l=B(x),r=y(x,"SPAN",{});var $=C(r);a=te($,o),$.forEach(_),i=B(x),c=y(x,"SPAN",{});var Q=C(c);d=te(Q,u),Q.forEach(_),g=B(x),m=y(x,"SPAN",{class:!0});var F=C(m);h=y(F,"DIV",{class:!0});var X=C(h);fe(v.$$.fragment,X),X.forEach(_),S=te(F,`
        Guessed:`),F.forEach(_),k=B(x),E=y(x,"SPAN",{});var Z=C(E);T=te(Z,P),Z.forEach(_),R=B(x),O=y(x,"SPAN",{});var K=C(O);I=te(K,V),K.forEach(_),x.forEach(_),this.h()},h(){p(h,"class","absolute left-[-2rem] p-1"),p(m,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(G,x){M(G,e,x),f(e,t),f(e,l),f(e,r),f(r,a),f(e,i),f(e,c),f(c,d),f(e,g),f(e,m),f(m,h),de(v,h,null),f(m,S),f(e,k),f(e,E),f(E,T),f(e,R),f(e,O),f(O,I),w=!0},p(G,x){var Q,F,X,Z;(!w||x&1)&&o!==(o=((Q=G[0].latestGuess.target)==null?void 0:Q.chord)+"")&&ye(a,o),(!w||x&1)&&u!==(u=((F=G[0].latestGuess.target)==null?void 0:F.notes.map(In).join(" "))+"")&&ye(d,u);const $={};x&2&&($.icon=G[1]==="correct"?Bt:Gt),v.$set($),(!w||x&1)&&P!==(P=((X=G[0].latestGuess.guessed)==null?void 0:X.chord)+"")&&ye(T,P),(!w||x&1)&&V!==(V=((Z=G[0].latestGuess.guessed)==null?void 0:Z.notes.map(Tn).join(" "))+"")&&ye(I,V)},i(G){w||(U(v.$$.fragment,G),w=!0)},o(G){z(v.$$.fragment,G),w=!1},d(G){G&&_(e),he(v)}}}function Po(s){let e,t,n="Target:",l,r,o=s[0].latestGuess.target+"",a,i,c,u,d,g,m,h,v,S,k=s[0].latestGuess.guessed+"",E,P,T,R;return m=new Me({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=n,l=j(),r=b("span"),a=ee(o),i=j(),c=b("span"),u=j(),d=b("span"),g=b("div"),ue(m.$$.fragment),h=ee(`
        Guessed:`),v=j(),S=b("span"),E=ee(k),P=j(),T=b("span"),this.h()},l(O){e=y(O,"DIV",{class:!0});var V=C(e);t=y(V,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=n),l=B(V),r=y(V,"SPAN",{});var I=C(r);a=te(I,o),I.forEach(_),i=B(V),c=y(V,"SPAN",{}),C(c).forEach(_),u=B(V),d=y(V,"SPAN",{class:!0});var w=C(d);g=y(w,"DIV",{class:!0});var D=C(g);fe(m.$$.fragment,D),D.forEach(_),h=te(w,`
        Guessed:`),w.forEach(_),v=B(V),S=y(V,"SPAN",{});var N=C(S);E=te(N,k),N.forEach(_),P=B(V),T=y(V,"SPAN",{}),C(T).forEach(_),V.forEach(_),this.h()},h(){p(g,"class","absolute left-[-2rem] p-1"),p(d,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(O,V){M(O,e,V),f(e,t),f(e,l),f(e,r),f(r,a),f(e,i),f(e,c),f(e,u),f(e,d),f(d,g),de(m,g,null),f(d,h),f(e,v),f(e,S),f(S,E),f(e,P),f(e,T),R=!0},p(O,V){(!R||V&1)&&o!==(o=O[0].latestGuess.target+"")&&ye(a,o);const I={};V&2&&(I.icon=O[1]==="correct"?Bt:Gt),m.$set(I),(!R||V&1)&&k!==(k=O[0].latestGuess.guessed+"")&&ye(E,k)},i(O){R||(U(m.$$.fragment,O),R=!0)},o(O){z(m.$$.fragment,O),R=!1},d(O){O&&_(e),he(m)}}}function jo(s){let e,t,n="Target:",l,r,o=s[8](s[0].latestGuess.target||0)+"",a,i,c,u,d,g,m,h,v,S,k=s[8](s[0].latestGuess.guessed||0)+"",E,P,T,R="",O;return m=new Me({props:{icon:s[1]==="correct"?Bt:Gt,width:16}}),{c(){e=b("div"),t=b("span"),t.textContent=n,l=j(),r=b("span"),a=ee(o),i=j(),c=b("span"),u=j(),d=b("span"),g=b("div"),ue(m.$$.fragment),h=ee(`
        Guessed:`),v=j(),S=b("span"),E=ee(k),P=j(),T=b("span"),T.innerHTML=R,this.h()},l(V){e=y(V,"DIV",{class:!0});var I=C(e);t=y(I,"SPAN",{"data-svelte-h":!0}),ae(t)!=="svelte-1s5czg5"&&(t.textContent=n),l=B(I),r=y(I,"SPAN",{});var w=C(r);a=te(w,o),w.forEach(_),i=B(I),c=y(I,"SPAN",{}),C(c).forEach(_),u=B(I),d=y(I,"SPAN",{class:!0});var D=C(d);g=y(D,"DIV",{class:!0});var N=C(g);fe(m.$$.fragment,N),N.forEach(_),h=te(D,`
        Guessed:`),D.forEach(_),v=B(I),S=y(I,"SPAN",{});var L=C(S);E=te(L,k),L.forEach(_),P=B(I),T=y(I,"SPAN",{"data-svelte-h":!0}),ae(T)!=="svelte-1qufua2"&&(T.innerHTML=R),I.forEach(_),this.h()},h(){p(g,"class","absolute left-[-2rem] p-1"),p(d,"class","relative"),p(e,"class","guessed svelte-1lxfpqs")},m(V,I){M(V,e,I),f(e,t),f(e,l),f(e,r),f(r,a),f(e,i),f(e,c),f(e,u),f(e,d),f(d,g),de(m,g,null),f(d,h),f(e,v),f(e,S),f(S,E),f(e,P),f(e,T),O=!0},p(V,I){(!O||I&1)&&o!==(o=V[8](V[0].latestGuess.target||0)+"")&&ye(a,o);const w={};I&2&&(w.icon=V[1]==="correct"?Bt:Gt),m.$set(w),(!O||I&1)&&k!==(k=V[8](V[0].latestGuess.guessed||0)+"")&&ye(E,k)},i(V){O||(U(m.$$.fragment,V),O=!0)},o(V){z(m.$$.fragment,V),O=!1},d(V){V&&_(e),he(m)}}}function Cn(s){let e,t=mt(s[12])+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var r=C(e);n=te(r,t),r.forEach(_),this.h()},h(){p(e,"class","mx-1")},m(l,r){M(l,e,r),f(e,n)},p(l,r){r&4&&t!==(t=mt(l[12])+"")&&ye(n,t)},d(l){l&&_(e)}}}function Bo(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){M(t,e,n)},p:ve,d(t){t&&_(e)}}}function Go(s){let e,t="Next",n,l,r="Autoplay",o,a;return{c(){e=b("button"),e.textContent=t,n=j(),l=b("button"),l.textContent=r,this.h()},l(i){e=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-uy473n"&&(e.textContent=t),n=B(i),l=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1cfj1sl"&&(l.textContent=r),this.h()},h(){p(e,"class","btn primary mr-1"),p(l,"class","btn primary")},m(i,c){M(i,e,c),M(i,n,c),M(i,l,c),o||(a=[Y(e,"click",s[4]),Y(l,"click",s[5])],o=!0)},p:ve,d(i){i&&(_(e),_(n),_(l)),o=!1,Ye(a)}}}function Mo(s){let e,t="Stop autoplay",n,l;return{c(){e=b("button"),e.textContent=t,this.h()},l(r){e=y(r,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-1xxta1i"&&(e.textContent=t),this.h()},h(){p(e,"class","btn primary")},m(r,o){M(r,e,o),n||(l=Y(e,"click",s[10]),n=!0)},p:ve,d(r){r&&_(e),n=!1,l()}}}function Ro(s){let e,t="Try Again",n,l,r="Clear",o,a;return{c(){e=b("button"),e.textContent=t,n=j(),l=b("button"),l.textContent=r,this.h()},l(i){e=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-15zs1cu"&&(e.textContent=t),n=B(i),l=y(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-11mnk9v"&&(l.textContent=r),this.h()},h(){p(e,"class","btn primary mr-1"),p(l,"class","btn primary")},m(i,c){M(i,e,c),M(i,n,c),M(i,l,c),o||(a=[Y(e,"click",s[6]),Y(l,"click",s[7])],o=!0)},p:ve,d(i){i&&(_(e),_(n),_(l)),o=!1,Ye(a)}}}function Uo(s){let e,t,n,l,r,o,a;const i=[jo,Po,Vo,Oo,Lo,Do],c=[];function u(h,v){return h[0]instanceof Pt&&(h[1]==="correct"||h[1]==="wrong")?0:h[0]instanceof zt&&(h[1]==="correct"||h[1]==="wrong")?1:h[0]instanceof pt&&(h[1]==="correct"||h[1]==="wrong")?2:h[0]&&h[1]==="ended"?3:h[2].length>0?4:5}t=u(s),n=c[t]=i[t](s);function d(h,v){return h[0]&&h[1]==="ended"?Ro:h[0]&&h[3].autoplay?Mo:h[0]?Go:Bo}let g=d(s),m=g(s);return{c(){e=b("div"),n.c(),r=j(),o=b("div"),m.c(),this.h()},l(h){e=y(h,"DIV",{class:!0});var v=C(e);n.l(v),v.forEach(_),r=B(h),o=y(h,"DIV",{class:!0});var S=C(o);m.l(S),S.forEach(_),this.h()},h(){p(e,"class",l=Te(`${s[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"),p(o,"class","mt-2 h-8 flex items-center")},m(h,v){M(h,e,v),c[t].m(e,null),M(h,r,v),M(h,o,v),m.m(o,null),a=!0},p(h,[v]){let S=t;t=u(h),t===S?c[t].p(h,v):(Ke(),z(c[S],1,1,()=>{c[S]=null}),$e(),n=c[t],n?n.p(h,v):(n=c[t]=i[t](h),n.c()),U(n,1),n.m(e,null)),(!a||v&512&&l!==(l=Te(`${h[9].class||""} min-h-[3.25rem]`)+" svelte-1lxfpqs"))&&p(e,"class",l),g===(g=d(h))&&m?m.p(h,v):(m.d(1),m=g(h),m&&(m.c(),m.m(o,null)))},i(h){a||(U(n),a=!0)},o(h){z(n),a=!1},d(h){h&&(_(e),_(r),_(o)),c[t].d(),m.d()}}}const In=s=>s.note,Tn=s=>s.note;function xo(s,e,t){let n,l,r,o;be(s,vt,h=>t(11,n=h)),be(s,_t,h=>t(1,l=h)),be(s,wt,h=>t(2,r=h)),be(s,gt,h=>t(3,o=h));let{game:a}=e;function i(){De.nextGuess()}function c(){De.setOptionValue("autoplay",!0),De.nextGuess()}function u(){a instanceof pt?De.play(a.type,a.opts):a&&De.play(a.type,void 0)}function d(){De.clearGame()}function g(h){const v=n.notesMap.get(h%12);return mt({midi:h,...v})}const m=()=>De.setOptionValue("autoplay",!1);return s.$$set=h=>{t(9,e=Ae(Ae({},e),Ne(h))),"game"in h&&t(0,a=h.game)},e=Ne(e),[a,l,r,o,i,c,u,d,g,e,m]}class Ko extends Fe{constructor(e){super(),He(this,e,xo,Uo,ze,{game:0})}}function $o(s){let e,t,n,l,r=[{class:t=`${s[2].class||""}`},{type:"checkbox"},s[2]],o={};for(let a=0;a<r.length;a+=1)o=Ae(o,r[a]);return{c(){e=b("input"),this.h()},l(a){e=y(a,"INPUT",{class:!0,type:!0}),this.h()},h(){ds(e,o),W(e,"svelte-mzrxuq",!0)},m(a,i){M(a,e,i),e.autofocus&&e.focus(),s[5](e),n||(l=[Y(e,"change",s[3]),Y(e,"input",s[4]),Y(e,"keydown",s[1])],n=!0)},p(a,[i]){ds(e,o=pl(r,[i&4&&t!==(t=`${a[2].class||""}`)&&{class:t},{type:"checkbox"},i&4&&a[2]])),W(e,"svelte-mzrxuq",!0)},i:ve,o:ve,d(a){a&&_(e),s[5](null),n=!1,Ye(l)}}}function Fo(s,e,t){let n;function l(i){i.key==="Enter"&&n.click()}function r(i){jt.call(this,s,i)}function o(i){jt.call(this,s,i)}function a(i){vs[i?"unshift":"push"](()=>{n=i,t(0,n)})}return s.$$set=i=>{t(2,e=Ae(Ae({},e),Ne(i)))},e=Ne(e),[n,l,e,r,o,a]}class Nt extends Fe{constructor(e){super(),He(this,e,Fo,$o,ze,{})}}const Vs={ar:{name:"Arabic",import:Ie(()=>import("./arabic-TJdw9TqS.cd2ea0d3.js"),[],import.meta.url)},hye:{name:"Armenian Eastern",import:Ie(()=>import("./armenianEastern-LNw2V_Kb.e28a3752.js"),[],import.meta.url)},hyw:{name:"Armenian Western",import:Ie(()=>import("./armenianWestern-zmIyLd1o.38785f27.js"),[],import.meta.url)},be:{name:"Belarusian",import:Ie(()=>import("./belarusian--mjombxK.1fcd2897.js"),[],import.meta.url)},bn:{name:"Bengali",import:Ie(()=>import("./bengali-2-qmZ9ZL.b883376f.js"),[],import.meta.url)},pt:{name:"Brazilian",import:Ie(()=>import("./brazilian-_aUR_EdS.2b1b1fd9.js"),[],import.meta.url)},my:{name:"Burmese",import:Ie(()=>import("./burmese-DNLMDG0C.87e404a2.js"),[],import.meta.url)},zh:{name:"Chinese",import:Ie(()=>import("./chinese-Vv6o_huT.c292fc41.js"),[],import.meta.url)},cs:{name:"Czech",import:Ie(()=>import("./czech-AAz70GMU.0cffa7b5.js"),[],import.meta.url)},en:{name:"English",import:Promise.resolve().then(()=>zo)},fa:{name:"Farsi",import:Ie(()=>import("./farsi-akNUiiy1.62727da0.js"),[],import.meta.url)},fr:{name:"French",import:Ie(()=>import("./french-GKHnJmdK.94658ac4.js"),[],import.meta.url)},ka:{name:"Georgian",import:Ie(()=>import("./georgian-SQFgQD3n.89ef2935.js"),[],import.meta.url)},de:{name:"German",import:Ie(()=>import("./german-Wy-4wNPv.fa6f994f.js"),[],import.meta.url)},el:{name:"Greek",import:Ie(()=>import("./greek-lay7OJjb.9c2c2556.js"),[],import.meta.url)},he:{name:"Hebrew",import:Ie(()=>import("./hebrew-V6ZtD_jG.48875cb9.js"),[],import.meta.url)},hi:{name:"Hindi",import:Ie(()=>import("./hindi-uNDpRlqm.76d6c741.js"),[],import.meta.url)},hu:{name:"Hungarian",import:Ie(()=>import("./hungarian-Wnxix6n4.45652951.js"),[],import.meta.url)},it:{name:"Italian",import:Ie(()=>import("./italian-eDgp6wHT.50798155.js"),[],import.meta.url)},ja:{name:"Japanese",import:Ie(()=>import("./japanese-Zv_Q1DDl.d78f358a.js"),[],import.meta.url)},mk:{name:"Macedonian",import:Ie(()=>import("./macedonian-Dot-tKLH.04517113.js"),[],import.meta.url)},yo:{name:"Nigerian",import:Ie(()=>import("./nigerian-IYPkF_j3.5b26cce3.js"),[],import.meta.url)},nko:{name:"Nko",import:Ie(()=>import("./nko-EI8QPheE.3268d6cd.js"),[],import.meta.url)},no:{name:"Norwegian",import:Ie(()=>import("./norwegian-sal6SH2s.847bc0b5.js"),[],import.meta.url)},pl:{name:"Polish",import:Ie(()=>import("./polish-yYQdl0aw.936f6a15.js"),[],import.meta.url)},pa:{name:"Punjabi",import:Ie(()=>import("./punjabi-0AIiTj_p.01c98b73.js"),[],import.meta.url)},ru:{name:"Russian",import:Ie(()=>import("./russian-sQ885m4A.ff7543fb.js"),[],import.meta.url)},es:{name:"Spanish",import:Ie(()=>import("./spanish-Ww3zYGV_.0ed27470.js"),[],import.meta.url)},sv:{name:"Swedish",import:Ie(()=>import("./swedish-RpPWxHx_.af07bd5e.js"),[],import.meta.url)},te:{name:"Telugu",import:Ie(()=>import("./telugu-WPb3GXn5.f8d401d9.js"),[],import.meta.url)},th:{name:"Thai",import:Ie(()=>import("./thai-Q-LTk3Id.1148f3d0.js"),[],import.meta.url)},tr:{name:"Turkish",import:Ie(()=>import("./turkish-qQEi80RS.cb967a2e.js"),[],import.meta.url)},uk:{name:"Ukrainian",import:Ie(()=>import("./ukrainian-CLoogq0p.3e4781c0.js"),[],import.meta.url)},ug:{name:"Uyghur",import:Ie(()=>import("./uyghur-eF-99IjK.066cbfdb.js"),[],import.meta.url)}};function Cl(s){if(!("default"in s.layout)||!("shift"in s.layout))throw console.error(s),Error("Invalid layout import");return{default:s.layout.default.slice(0,4)}}async function Ho(s=["en"]){let e={code:"en",layout:Vs.en,index:99};Object.entries(Vs).forEach(([n,l])=>{for(let r=0;r<s.length;r+=1)n===s[r]&&(!e||e.index>r)&&(e={code:n,layout:l,index:r})});const t=await e.layout.import;return{code:e.code,name:e.layout.name,imported:Cl(t.default)}}const Il={layout:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]}},zo=Object.freeze(Object.defineProperty({__proto__:null,default:Il},Symbol.toStringTag,{value:"Module"})),Tl=[0,2,4,5,7,9,11],Al=[1,3,-1,6,8,10,-1];function qo(s,e,t){const n=s.keyType==="white"?Tl:Al,l=n[t%n.length];let r;if(l>=0){r=e[l];const o=Math.floor(t/n.length);return{...r,semitones:r.semitones+(o>0?o:0)*12}}}function Vt(s,e,t=0,n=0){const l=s.keyType==="white"?Tl:Al;let r=-1,o=0,a=0;return s.keys.forEach((i,c)=>{if(i.key.charAt(0)!=="{"&&c>=t&&r===-1?r=c:r!==-1&&i.key==="{empty}"&&(o+=1),r!==-1&&i.key.charAt(0)!=="{"){const u=c-o-r+n,d=l[u%l.length];if(d>=0){const g=e[d],m=Math.floor(u/l.length);i.note={...g,semitones:g.semitones+(m>0?m:0)*12},a=c-r}}}),{firstIndex:r,lastIndex:a}}const Nl=[["IntlBackslash","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Enter"],["Capslock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash"],["ShiftLeft","Backquote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight"]];function Wo(s,e){let t=[];const n=s.default.map((o,a)=>{if(a===0){const i=o.split(" ").filter(c=>c!=="{bksp}");for(;i.length!==13;)i.length<13?i.unshift("{empty}"):i.shift();return[...i,"{bksp}"]}else if(a===1){const i=o.split(" ");return t=i.slice(13),[...i.slice(0,13),"{enter}"]}else{if(a===2)return[...o.split(" ").slice(0,13).filter(i=>i!=="{enter}"),...t].slice(0,13);if(a===3){const i=["{shift}",...o.split(" ").slice(1,12).filter(u=>u!=="{shift}"),"{shift}"];let c=1;for(;i.length<13;)i.splice(c,0,"{empty}"),c=c===1?-1:1;return i}else return o.split(" ")}});let l;s.codes?l=s.codes.map(o=>o.split(" ")):l=Nl;const r=[0,1,2,3].map(o=>n[o].map((a,i)=>({key:a,code:l[o][i]})));return[{keyType:e==="two-rows"?"black":null,startNoteOffset:2,availableNotes:11,keys:r[0]},{keyType:e==="two-rows"?"white":"black",startNoteOffset:e==="two-rows"?1:2,availableNotes:12,keys:r[1]},{keyType:e==="two-rows"?"black":"white",startNoteOffset:1,availableNotes:12,keys:r[2]},{keyType:e==="two-rows"?"white":null,startNoteOffset:1,availableNotes:11,keys:r[3]}]}const An=[{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]},{keyType:null,startNoteOffset:0,availableNotes:0,keys:[]}];class Sl{constructor(e){return this.rows=An,this.setCustomRow={row:An[0],rowIndex:0,nextKeyIdx:-1,nextNoteOffset:0},this.opts={hotkeydRows:"middle-row",isCustom:!1,layout:{code:"en",name:"English",imported:Cl(Il)},...e},this.loadRowsFromImport(this.opts.layout.imported)}setOptions(e){this.opts={...this.opts,...e}}loadRowsFromImport(e){return this.rows=Wo(e,this.opts.hotkeydRows),this}setRows(e){return this.rows=e,this}setNotes(e){if(this.opts.hotkeydRows==="middle-row"){const{firstIndex:t}=Vt(this.rows[2],e);Vt(this.rows[1],e,1+t)}else{const{firstIndex:t,lastIndex:n}=Vt(this.rows[3],e);Vt(this.rows[2],e,t);const{firstIndex:l}=Vt(this.rows[1],e,0,n+1);Vt(this.rows[0],e,1+l,n+1)}}startSetCustomRow(e){const t={...this.rows[e],keys:this.rows[e].keys.map(a=>({...a}))},{availableNotes:n,startNoteOffset:l}=t,r=this.opts.hotkeydRows==="two-rows"&&(e===0||e===1)?3:-1,o=r!==-1?this.rows[r].keys.reduce((a,i)=>(a===-1&&i.note?a=0:a!==-1&&(i.key[0]!=="{"||i.key==="{empty}")&&(a+=1),a),-1)+1:0;return this.setCustomRow={row:t,rowIndex:e,nextKeyIdx:l,nextNoteOffset:o},{first:l,count:n}}setNextCustomNote(e,t,n){let l;const{nextKeyIdx:r,nextNoteOffset:o,row:a}=this.setCustomRow,i=r+o-a.startNoteOffset,c=qo(a,n,i);return c?l={key:e,code:t,note:c}:l={key:e,code:t},this.setCustomRow.nextKeyIdx+=1,{index:this.setCustomRow.nextKeyIdx,key:l}}skipNextCustomNote(){return this.setCustomRow.nextKeyIdx+=1,this.setCustomRow.nextNoteOffset-=1,{index:this.setCustomRow.nextKeyIdx,key:{code:"EMPTY",key:"{empty}"}}}}function Jo(s){const e=[...s.map(l=>l.keys.map(r=>r.key).join(" "))],t=["","","",""];let n=!1;return s.forEach((l,r)=>{const o=[];for(let a=0;a<l.keys.length;a+=1)o.push(l.keys[a].code),n=n||l.keys[a].code!==Nl[r][a];t[r]=o.join(" ")}),n?{default:e,codes:t}:{default:e}}function Nn(s,e,t){const n=s.slice();return n[15]=e[t].key,n[16]=e[t].value,n[17]=e[t].icon,n[19]=t,n}const Yo=s=>({}),Sn=s=>({}),Qo=s=>({}),Dn=s=>({});function Ln(s){let e,t,n,l,r,o,a,i,c,u,d;const g=s[12].header,m=js(g,s,s[11],Sn);let h=_e(s[0]),v=[];for(let k=0;k<h.length;k+=1)v[k]=On(Nn(s,h,k));const S=k=>z(v[k],1,1,()=>{v[k]=null});return{c(){e=b("button"),n=j(),l=b("ul"),r=b("li"),m&&m.c(),o=j();for(let k=0;k<v.length;k+=1)v[k].c();this.h()},l(k){e=y(k,"BUTTON",{class:!0,tabindex:!0}),C(e).forEach(_),n=B(k),l=y(k,"UL",{class:!0});var E=C(l);r=y(E,"LI",{});var P=C(r);m&&m.l(P),P.forEach(_),o=B(E);for(let T=0;T<v.length;T+=1)v[T].l(E);E.forEach(_),this.h()},h(){p(e,"class","fixed z-20 inset-0 h-full w-full outline-none cursor-default"),p(e,"tabindex","-1"),p(l,"class",a=Te(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg")},m(k,E){M(k,e,E),M(k,n,E),M(k,l,E),f(l,r),m&&m.m(r,null),f(l,o);for(let P=0;P<v.length;P+=1)v[P]&&v[P].m(l,null);c=!0,u||(d=Y(e,"click",s[7]),u=!0)},p(k,E){if(s=k,m&&m.p&&(!c||E&2048)&&Bs(m,g,s,s[11],c?Ms(g,s[11],E,Yo):Gs(s[11]),Sn),E&265){h=_e(s[0]);let P;for(P=0;P<h.length;P+=1){const T=Nn(s,h,P);v[P]?(v[P].p(T,E),U(v[P],1)):(v[P]=On(T),v[P].c(),U(v[P],1),v[P].m(l,null))}for(Ke(),P=h.length;P<v.length;P+=1)S(P);$e()}(!c||E&4&&a!==(a=Te(`items-list bg-white py-1.5 py-2 h-64 overflow-y-scroll text-sm absolute left-0 z-30 rounded-b shadow-xl ${s[2]||""}`)+" svelte-h65upg"))&&p(l,"class",a)},i(k){if(!c){k&&cs(()=>{c&&(t||(t=Ct(e,us,{duration:as},!0)),t.run(1))}),U(m,k);for(let E=0;E<h.length;E+=1)U(v[E]);k&&cs(()=>{c&&(i||(i=Ct(l,fs,{duration:as},!0)),i.run(1))}),c=!0}},o(k){k&&(t||(t=Ct(e,us,{duration:as},!1)),t.run(0)),z(m,k),v=v.filter(Boolean);for(let E=0;E<v.length;E+=1)z(v[E]);k&&(i||(i=Ct(l,fs,{duration:as},!1)),i.run(0)),c=!1},d(k){k&&(_(e),_(n),_(l)),k&&t&&t.end(),m&&m.d(k),Oe(v,k),k&&i&&i.end(),u=!1,d()}}}function Xo(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","w-[24px]")},m(t,n){M(t,e,n)},p:ve,i:ve,o:ve,d(t){t&&_(e)}}}function Zo(s){let e,t;return e=new Me({props:{class:"mr-2",icon:s[17],width:16}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p(n,l){const r={};l&1&&(r.icon=n[17]),e.$set(r)},i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function On(s){let e,t,n,l,r,o,a=s[16]+"",i,c,u,d,g;const m=[Zo,Xo],h=[];function v(k,E){return k[17]?0:1}n=v(s),l=h[n]=m[n](s);function S(){return s[13](s[15])}return{c(){e=b("li"),t=b("button"),l.c(),r=j(),o=b("div"),i=ee(a),c=j(),this.h()},l(k){e=y(k,"LI",{});var E=C(e);t=y(E,"BUTTON",{class:!0});var P=C(t);l.l(P),r=B(P),o=y(P,"DIV",{});var T=C(o);i=te(T,a),T.forEach(_),P.forEach(_),c=B(E),E.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 text-justify w-full h-full hover:bg-[#eee] svelte-h65upg"),W(t,"selected",s[15]===s[3])},m(k,E){M(k,e,E),f(e,t),h[n].m(t,null),f(t,r),f(t,o),f(o,i),f(e,c),u=!0,d||(g=Y(t,"click",S),d=!0)},p(k,E){s=k;let P=n;n=v(s),n===P?h[n].p(s,E):(Ke(),z(h[P],1,1,()=>{h[P]=null}),$e(),l=h[n],l?l.p(s,E):(l=h[n]=m[n](s),l.c()),U(l,1),l.m(t,r)),(!u||E&1)&&a!==(a=s[16]+"")&&ye(i,a),(!u||E&9)&&W(t,"selected",s[15]===s[3])},i(k){u||(U(l),u=!0)},o(k){z(l),u=!1},d(k){k&&_(e),h[n].d(),d=!1,g()}}}function er(s){let e,t,n,l,r,o,a,i,c;const u=s[12].value,d=js(u,s,s[11],Dn);let g=s[6]&&Ln(s);return{c(){e=b("div"),t=b("button"),d&&d.c(),r=j(),g&&g.c(),this.h()},l(m){e=y(m,"DIV",{class:!0,id:!0});var h=C(e);t=y(h,"BUTTON",{class:!0,title:!0});var v=C(t);d&&d.l(v),v.forEach(_),r=B(h),g&&g.l(h),h.forEach(_),this.h()},h(){p(t,"class",n=Te(`${s[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"),p(t,"title",l=s[9].title||""),W(t,"disabled",s[4]),W(t,"open",s[6]),p(e,"class",o=Te(`relative ${s[2]||""}`)+" svelte-h65upg"),p(e,"id",s[1])},m(m,h){M(m,e,h),f(e,t),d&&d.m(t,null),f(e,r),g&&g.m(e,null),s[14](e),a=!0,i||(c=Y(t,"click",s[7]),i=!0)},p(m,[h]){d&&d.p&&(!a||h&2048)&&Bs(d,u,m,m[11],a?Ms(u,m[11],h,Qo):Gs(m[11]),Dn),(!a||h&512&&n!==(n=Te(`${m[9].class||""} open-btn w-full text-justify text-sm rounded hover:bg-[#eee]`)+" svelte-h65upg"))&&p(t,"class",n),(!a||h&512&&l!==(l=m[9].title||""))&&p(t,"title",l),(!a||h&528)&&W(t,"disabled",m[4]),(!a||h&576)&&W(t,"open",m[6]),m[6]?g?(g.p(m,h),h&64&&U(g,1)):(g=Ln(m),g.c(),U(g,1),g.m(e,null)):g&&(Ke(),z(g,1,1,()=>{g=null}),$e()),(!a||h&4&&o!==(o=Te(`relative ${m[2]||""}`)+" svelte-h65upg"))&&p(e,"class",o),(!a||h&2)&&p(e,"id",m[1])},i(m){a||(U(d,m),U(g),a=!0)},o(m){z(d,m),z(g),a=!1},d(m){m&&_(e),d&&d.d(m),g&&g.d(),s[14](null),i=!1,c()}}}const as=400;function tr(s,e,t){let{$$slots:n={},$$scope:l}=e,{options:r,id:o=void 0,containerClass:a=void 0,selected:i=void 0,disabled:c=void 0,onSelect:u}=e,d,g=!1;function m(){c||t(6,g=!g)}function h(k){t(6,g=u(k))}const v=k=>h(k);function S(k){vs[k?"unshift":"push"](()=>{d=k,t(5,d)})}return s.$$set=k=>{t(9,e=Ae(Ae({},e),Ne(k))),"options"in k&&t(0,r=k.options),"id"in k&&t(1,o=k.id),"containerClass"in k&&t(2,a=k.containerClass),"selected"in k&&t(3,i=k.selected),"disabled"in k&&t(4,c=k.disabled),"onSelect"in k&&t(10,u=k.onSelect),"$$scope"in k&&t(11,l=k.$$scope)},e=Ne(e),[r,o,a,i,c,d,g,m,h,e,u,l,n,v,S]}class sr extends Fe{constructor(e){super(),He(this,e,tr,er,ze,{options:0,id:1,containerClass:2,selected:3,disabled:4,onSelect:10})}}function nr(s){let e,t,n,l,r,o,a,i=[s[2],{type:"checkbox"}],c={};for(let u=0;u<i.length;u+=1)c=Ae(c,i[u]);return{c(){e=b("label"),t=b("input"),n=j(),l=b("div"),this.h()},l(u){e=y(u,"LABEL",{class:!0});var d=C(e);t=y(d,"INPUT",{type:!0}),n=B(d),l=y(d,"DIV",{class:!0}),C(l).forEach(_),d.forEach(_),this.h()},h(){ds(t,c),W(t,"svelte-k5zciy",!0),p(l,"class","slider svelte-k5zciy"),p(e,"class",r=Te(`${s[2].class||""} toggle`)+" svelte-k5zciy")},m(u,d){M(u,e,d),f(e,t),t.autofocus&&t.focus(),s[4](t),f(e,n),f(e,l),o||(a=[Y(t,"change",s[3]),Y(t,"keydown",s[1])],o=!0)},p(u,[d]){ds(t,c=pl(i,[d&4&&u[2],{type:"checkbox"}])),W(t,"svelte-k5zciy",!0),d&4&&r!==(r=Te(`${u[2].class||""} toggle`)+" svelte-k5zciy")&&p(e,"class",r)},i:ve,o:ve,d(u){u&&_(e),s[4](null),o=!1,Ye(a)}}}function lr(s,e,t){let n;function l(a){a.key==="Enter"&&n.click()}function r(a){jt.call(this,s,a)}function o(a){vs[a?"unshift":"push"](()=>{n=a,t(0,n)})}return s.$$set=a=>{t(2,e=Ae(Ae({},e),Ne(a)))},e=Ne(e),[n,l,e,r,o]}class or extends Fe{constructor(e){super(),He(this,e,lr,nr,ze,{})}}function rr(s,e,t){return e==="Escape"?{e:"hotkeys-cancel"}:e==="Space"?{e:"hotkeys-skip-key"}:s.has(e)?{e:"hotkeys-no-key"}:(s.add(e),{e:"hotkeys-captured-key",data:{code:e,key:t}})}const Ks=/^[a-gA-G]$/,Dl=/^[♭Bb#♯sS]$/,ar=/^[0-9]$/;let se="",Je;function ir(s,e){const{useHotkeys:t}=Ce(nt),n=Ce(Ol).get(s);if(t&&se.length===0&&n&&n.note)return se="",{e:"guessed-key",data:n.note.note};if(!t&&se.length===0&&Ks.test(e))return se+=e.toUpperCase(),{e:"string",data:se};if(!t&&se.length>0&&Dl.test(e))return e==="b"||e==="B"?se+="♭":se+="♯",{e:"string",data:se};if(s==="Backspace"&&se.length>0)return se=se.slice(0,-1),{e:"string",data:se};if(s==="Enter"&&se.length>0){const l=se;return se="",{e:"guessed-key",data:l}}return!1}function cr(s,e){if(s==="Enter"&&se.length>0){const t={note:"",flats:0,sharps:0,chord:""};for(let n=0;n<se.length;n+=1)n===0?t.note+=se[n]:t.chord.length>0?t.chord+=se[n].toLowerCase():se[n]==="♭"?(t.note+=se[n],t.flats+=1):se[n]==="♯"?(t.note+=se[n],t.sharps+=1):t.chord+=se[n].toLowerCase();return se="",{e:"guessed-chord",data:t}}else{if(s==="Backspace"&&se.length>0)return se=se.slice(0,-1),{e:"string",data:se};if(se.length===0&&Ks.test(e))return se+=e.toUpperCase(),{e:"string",data:se};if(se.length>0&&e.length===1)return se.length===1&&(e==="b"||e==="B")?se+="♭":se.length===1&&e==="#"?se+="♯":se+=e,{e:"string",data:se}}return!1}function ur(s,e,t){const{useAutoOctave:n,useHotkeys:l}=Ce(nt);let r;const a=Ce(Ol).get(s),i=(a==null?void 0:a.key)||"";let c=!1;if(!Je&&l&&(a!=null&&a.note)?(Je=a.note,n&&(r=ps({midi:Ce(Mt)[0].midi,flats:0,sharps:0})),c="note"):!l&&se.length===0&&Ks.test(e)?(se+=e.toUpperCase(),c="input"):!l&&se.length>0&&Dl.test(e)?(e==="b"||e==="B"?se+="♭":se+="♯",c="input"):!l&&se.length>0&&s==="Enter"&&n&&(r=ps({midi:Ce(Mt)[0].midi,flats:0,sharps:0}),c="octave"),!c&&ar.test(i))try{r=parseInt(i),c="octave"}catch{}if(c&&(Je||se)&&r!==void 0){const u=(Je==null?void 0:Je.note)??se;return t&&(r+=1),Je&&(Je==null?void 0:Je.semitones)>=12&&(r+=Math.floor(Je.semitones/12)),Je=void 0,se="",{e:"guessed-note",data:{note:u,octave:r}}}else if(s==="Backspace"&&(Je||se.length>0))return Je=void 0,se=se.slice(0,-1),{e:"string",data:se};return c==="note"?{e:"note",data:Je}:c==="input"?{e:"string",data:se}:!1}const $s={code:"en",name:"English",imported:{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}"]}},Ft=new Set,Ll=new Sl({layout:$s}),ht=Ve(void 0);qt(ht,s=>s?[s.rowIndex,s.nextIndex]:[-1,-1]);const Et=bt(Ve({isCustom:!1,layout:$s,hotkeydRows:"middle-row"}),{key:"keyboard-options"}),Rt=Ve(Ll.rows),Tt=Ve(Ll);vt.subscribe(s=>{const e=Ce(Tt);e.setNotes(Array.from(s.notesMap.values())),Rt.set(e.rows),Tt.set(e)});Et.subscribe(s=>{const e=new Sl(s),t=Ce(vt);e.setNotes(Array.from(t.notesMap.values())),Rt.set(e.rows),Tt.set(e)});const Ol=qt(Tt,s=>new Map(s.rows.flatMap(e=>e.keys.map(t=>[t.code,t])))),fr=qt(Tt,s=>s.rows.flatMap(e=>e.keys).map(e=>e.note).filter(e=>e!==void 0).sort((e,t)=>e.semitones-t.semitones)),ct={async setLayout(s){const e=await Ho(s),t=Ce(Et);e.code!==t.layout.code&&Et.update(n=>({...n,isCustom:!1,layout:e}))},async setCustomLayout(s){s?Et.update(e=>({...e,isCustom:s,layout:{code:"custom",name:"Custom",imported:e.layout.imported}})):this.setLayout(navigator.languages)},toggleRows(s){Et.update(e=>({...e,hotkeydRows:s??(e.hotkeydRows==="middle-row"?"two-rows":"middle-row")}))},captureHotkeyRow(s){const e=Ce(Tt),t=Ce(vt),{first:n,count:l}=e.startSetCustomRow(s);ht.set({nextIndex:n,rowIndex:s,count:l,scaleNotes:Array.from(t.notesMap.values())})},findNote(s){return Ce(fr).find(e=>{if(e.note.charAt(0)===s.charAt(0)){const t=s.slice(1).split("").reduce((n,l)=>n+(l.toLowerCase()==="b"||l==="♭"?-1:l.toLowerCase()==="s"||l==="#"||l==="♯"?1:0),0);return t>0?e.sharps===t:t<0?e.flats===t*-1:e.flats===0&&e.sharps===0}})},handleHotkeyInput(s,e,t){const n=rr(Ft,e,t),l=Ce(Tt);let r;const o=l.setCustomRow.nextKeyIdx;n.e==="hotkeys-cancel"?(ht.set(void 0),Ft.clear()):n.e==="hotkeys-skip-key"?r=l.skipNextCustomNote():n.e==="hotkeys-captured-key"&&(r=l.setNextCustomNote(n.data.key,n.data.code,s.scaleNotes));const a=Ce(Rt);if(r&&(a[s.rowIndex].keys[o]=r.key,Rt.set(a),ht.update(i=>i?{...i,nextIndex:r.index}:void 0)),s.count===o){const i=Jo(a);Et.update(c=>({...c,layout:{...c.layout,imported:i}})),ht.set(void 0),Ft.clear()}return n},handleInput(s,e,t=!1){const n=Ce(It),l=Ce(ht);return l?this.handleHotkeyInput(l,s,e):n instanceof zt?ir(s,e.toUpperCase()):n instanceof pt&&n.type==="chords-write"?cr(s,e):Ce(nt).useKeyboard?ur(s,e.toUpperCase(),t):!1},cancelCapture(){ht.set(void 0),Ft.clear()},reset(){Et.set({isCustom:!1,layout:$s,hotkeydRows:"middle-row"}),ht.set(void 0),Ft.clear()}};function Vn(s){let e;return{c(){e=b("li"),this.h()},l(t){e=y(t,"LI",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","m-[0.175rem] mr-0")},m(t,n){M(t,e,n)},d(t){t&&_(e)}}}function Pn(s){let e;return{c(){e=b("div"),this.h()},l(t){e=y(t,"DIV",{class:!0}),C(e).forEach(_),this.h()},h(){p(e,"class","enter-part bg-[#ececf1] rounded-l absolute top-[-2px] left-[-12px] w-[13px] h-[2.8rem] svelte-1479mcy")},m(t,n){M(t,e,n)},d(t){t&&_(e)}}}function jn(s){let e,t=s[0].note.note+"",n,l;return{c(){e=b("div"),n=ee(t),l=ee(s[3]),this.h()},l(r){e=y(r,"DIV",{class:!0});var o=C(e);n=te(o,t),l=te(o,s[3]),o.forEach(_),this.h()},h(){p(e,"class","absolute top-0 left-0")},m(r,o){M(r,e,o),f(e,n),f(e,l)},p(r,o){o&1&&t!==(t=r[0].note.note+"")&&ye(n,t),o&8&&ye(l,r[3])},d(r){r&&_(e)}}}function dr(s){let e,t,n,l,r,o,a=Gn(s[0].key)+"",i,c,u,d,g=s[0].key==="{enter}"&&Vn(),m=s[0].key==="{enter}"&&Pn(),h=s[0].note&&jn(s);return{c(){g&&g.c(),e=j(),t=b("li"),n=b("button"),m&&m.c(),l=j(),h&&h.c(),r=j(),o=b("div"),i=ee(a),this.h()},l(v){g&&g.l(v),e=B(v),t=y(v,"LI",{class:!0});var S=C(t);n=y(S,"BUTTON",{class:!0});var k=C(n);m&&m.l(k),l=B(k),h&&h.l(k),r=B(k),o=y(k,"DIV",{});var E=C(o);i=te(E,a),E.forEach(_),k.forEach(_),S.forEach(_),this.h()},h(){p(n,"class","relative w-full h-full shadow bg-[#ececf1] rounded flex justify-center svelte-1479mcy"),W(n,"items-center",!s[0].note),W(n,"items-end",s[0].note),p(t,"class",c=Te(`${s[4].class||""} m-[0.175rem] ${Bn(s[1])} min-w-[32px]`)+" svelte-1479mcy"),W(t,"enter",s[0].key==="{enter}"),W(t,"captured",s[2])},m(v,S){g&&g.m(v,S),M(v,e,S),M(v,t,S),f(t,n),m&&m.m(n,null),f(n,l),h&&h.m(n,null),f(n,r),f(n,o),f(o,i),u||(d=Y(n,"click",s[10]),u=!0)},p(v,[S]){v[0].key==="{enter}"?g||(g=Vn(),g.c(),g.m(e.parentNode,e)):g&&(g.d(1),g=null),v[0].key==="{enter}"?m||(m=Pn(),m.c(),m.m(n,l)):m&&(m.d(1),m=null),v[0].note?h?h.p(v,S):(h=jn(v),h.c(),h.m(n,r)):h&&(h.d(1),h=null),S&1&&a!==(a=Gn(v[0].key)+"")&&ye(i,a),S&1&&W(n,"items-center",!v[0].note),S&1&&W(n,"items-end",v[0].note),S&18&&c!==(c=Te(`${v[4].class||""} m-[0.175rem] ${Bn(v[1])} min-w-[32px]`)+" svelte-1479mcy")&&p(t,"class",c),S&19&&W(t,"enter",v[0].key==="{enter}"),S&22&&W(t,"captured",v[2])},i:ve,o:ve,d(v){v&&(_(e),_(t)),g&&g.d(v),m&&m.d(),h&&h.d(),u=!1,d()}}}function Bn(s){return s&&Number.isInteger(s)?`size-${s}`:s?`size-${Math.floor(s)}-${Math.floor(s*10)-Math.floor(s)*10}`:"size-1"}function Gn(s){return s==="{empty}"?"":s==="{bksp}"?"Backspace":s==="{tab}"?"Tab":s==="{enter}"?"Enter":s==="{lock}"?"Capslock":s==="{shift}"?"Shift":s}function hr(s,e,t){let n,l,r,o,a,i;be(s,ht,m=>t(7,o=m)),be(s,ys,m=>t(8,a=m)),be(s,Rt,m=>t(9,i=m));let{rowIndex:c,keyIndex:u}=e,d;function g(m){jt.call(this,s,m)}return s.$$set=m=>{t(4,e=Ae(Ae({},e),Ne(m))),"rowIndex"in m&&t(5,c=m.rowIndex),"keyIndex"in m&&t(6,u=m.keyIndex)},s.$$.update=()=>{s.$$.dirty&608&&t(0,n=i[c].keys[u]),s.$$.dirty&257&&t(3,l=n.note?ps({midi:n.note.semitones+a[0],flats:0,sharps:0}):0),s.$$.dirty&224&&t(2,r=o&&o.rowIndex===c&&o.nextIndex===u),s.$$.dirty&65&&(n.key==="{bksp}"?t(1,d=2):n.key==="{tab}"?t(1,d=1.5):n.key==="{enter}"?t(1,d=2):n.key==="{lock}"?t(1,d=1.75):n.key==="{shift}"&&u===0?t(1,d=1.5):n.key==="{shift}"?t(1,d=2.5):t(1,d=1))},e=Ne(e),[n,d,r,l,e,c,u,o,a,i,g]}class mr extends Fe{constructor(e){super(),He(this,e,hr,dr,ze,{rowIndex:5,keyIndex:6})}}function Mn(s,e,t){const n=s.slice();return n[13]=e[t],n[15]=t,n}function Rn(s,e,t){const n=s.slice();return n[16]=e[t],n[18]=t,n}function _r(s){let e,t=s[0].layout.name+"",n;return{c(){e=b("div"),n=ee(t),this.h()},l(l){e=y(l,"DIV",{slot:!0});var r=C(e);n=te(r,t),r.forEach(_),this.h()},h(){p(e,"slot","value")},m(l,r){M(l,e,r),f(e,n)},p(l,r){r&1&&t!==(t=l[0].layout.name+"")&&ye(n,t)},d(l){l&&_(e)}}}function Un(s){let e,t,n,l,r;t=new Me({props:{icon:Ul,width:20}});function o(){return s[12](s[15])}return{c(){e=b("button"),ue(t.$$.fragment),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var i=C(e);fe(t.$$.fragment,i),i.forEach(_),this.h()},h(){p(e,"class","flex items-center justify-center rounded w-full h-full hover:bg-gray-300")},m(a,i){M(a,e,i),de(t,e,null),n=!0,l||(r=Y(e,"click",o),l=!0)},p(a,i){s=a},i(a){n||(U(t.$$.fragment,a),n=!0)},o(a){z(t.$$.fragment,a),n=!1},d(a){a&&_(e),he(t),l=!1,r()}}}function xn(s){let e,t;return e=new mr({props:{rowIndex:s[15],keyIndex:s[18]}}),{c(){ue(e.$$.fragment)},l(n){fe(e.$$.fragment,n)},m(n,l){de(e,n,l),t=!0},p:ve,i(n){t||(U(e.$$.fragment,n),t=!0)},o(n){z(e.$$.fragment,n),t=!1},d(n){he(e,n)}}}function Kn(s){let e,t,n,l,r=s[2][s[15]]&&s[0].isCustom&&Un(s),o=_e(s[13].keys),a=[];for(let c=0;c<o.length;c+=1)a[c]=xn(Rn(s,o,c));const i=c=>z(a[c],1,1,()=>{a[c]=null});return{c(){e=b("li"),r&&r.c(),t=j();for(let c=0;c<a.length;c+=1)a[c].c();n=Le(),this.h()},l(c){e=y(c,"LI",{class:!0});var u=C(e);r&&r.l(u),u.forEach(_),t=B(c);for(let d=0;d<a.length;d+=1)a[d].l(c);n=Le(),this.h()},h(){p(e,"class","col-span-2 svelte-1av9wwd")},m(c,u){M(c,e,u),r&&r.m(e,null),M(c,t,u);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(c,u);M(c,n,u),l=!0},p(c,u){if(c[2][c[15]]&&c[0].isCustom?r?(r.p(c,u),u&5&&U(r,1)):(r=Un(c),r.c(),U(r,1),r.m(e,null)):r&&(Ke(),z(r,1,1,()=>{r=null}),$e()),u&8){o=_e(c[13].keys);let d;for(d=0;d<o.length;d+=1){const g=Rn(c,o,d);a[d]?(a[d].p(g,u),U(a[d],1)):(a[d]=xn(g),a[d].c(),U(a[d],1),a[d].m(n.parentNode,n))}for(Ke(),d=o.length;d<a.length;d+=1)i(d);$e()}},i(c){if(!l){U(r);for(let u=0;u<o.length;u+=1)U(a[u]);l=!0}},o(c){z(r),a=a.filter(Boolean);for(let u=0;u<a.length;u+=1)z(a[u]);l=!1},d(c){c&&(_(e),_(t),_(n)),r&&r.d(),Oe(a,c)}}}function pr(s){let e,t,n,l,r,o="Layout",a,i,c,u,d,g="Custom",m,h,v,S,k,E="One row",P,T,R,O,V="Two rows",I,w,D,N,L,A,G,x,$,Q,F;i=new sr({props:{id:"keyboard-lang",containerClass:"w-36",class:"p-1 w-36",options:s[4],onSelect:s[6],$$slots:{value:[_r]},$$scope:{ctx:s}}}),h=new Nt({props:{id:"custom-layout",checked:s[0].isCustom}}),h.$on("change",s[7]),T=new or({props:{checked:!s[1]}}),T.$on("change",s[9]),N=new Me({props:{icon:Wt,width:16}});let X=_e(s[3].rows),Z=[];for(let J=0;J<X.length;J+=1)Z[J]=Kn(Mn(s,X,J));const K=J=>z(Z[J],1,1,()=>{Z[J]=null});return{c(){e=b("div"),t=b("div"),n=b("div"),l=b("div"),r=b("label"),r.textContent=o,a=j(),ue(i.$$.fragment),c=j(),u=b("div"),d=b("label"),d.textContent=g,m=j(),ue(h.$$.fragment),v=j(),S=b("div"),k=b("label"),k.textContent=E,P=j(),ue(T.$$.fragment),R=j(),O=b("label"),O.textContent=V,I=j(),w=b("div"),D=b("button"),ue(N.$$.fragment),L=j(),A=b("div"),G=b("ul");for(let J=0;J<Z.length;J+=1)Z[J].c();this.h()},l(J){e=y(J,"DIV",{class:!0});var H=C(e);t=y(H,"DIV",{class:!0});var me=C(t);n=y(me,"DIV",{class:!0});var pe=C(n);l=y(pe,"DIV",{class:!0});var Re=C(l);r=y(Re,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(r)!=="svelte-1xsr9lq"&&(r.textContent=o),a=B(Re),fe(i.$$.fragment,Re),Re.forEach(_),c=B(pe),u=y(pe,"DIV",{class:!0});var ie=C(u);d=y(ie,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(d)!=="svelte-11aw8ub"&&(d.textContent=g),m=B(ie),fe(h.$$.fragment,ie),ie.forEach(_),v=B(pe),S=y(pe,"DIV",{class:!0});var ce=C(S);k=y(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(k)!=="svelte-17p0yvw"&&(k.textContent=E),P=B(ce),fe(T.$$.fragment,ce),R=B(ce),O=y(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(O)!=="svelte-1wr3nwv"&&(O.textContent=V),ce.forEach(_),pe.forEach(_),I=B(me),w=y(me,"DIV",{class:!0});var le=C(w);D=y(le,"BUTTON",{class:!0});var re=C(D);fe(N.$$.fragment,re),re.forEach(_),le.forEach(_),me.forEach(_),L=B(H),A=y(H,"DIV",{class:!0});var ge=C(A);G=y(ge,"UL",{class:!0});var we=C(G);for(let tt=0;tt<Z.length;tt+=1)Z[tt].l(we);we.forEach(_),ge.forEach(_),H.forEach(_),this.h()},h(){p(r,"class","font-bold mr-4"),p(r,"for","middle-row"),p(l,"class","my-1 flex items-center justify-between mr-2"),p(d,"class","font-bold mr-4"),p(d,"for","custom-layout"),p(u,"class","my-1 flex items-center"),p(k,"class","font-bold mr-4"),p(k,"for","two-rows"),p(O,"class","font-bold ml-4"),p(O,"for","two-rows"),p(S,"class","my-1 flex items-center"),p(n,"class","options svelte-1av9wwd"),p(D,"class","rounded px-1 py-1 hover:bg-gray-200"),p(w,"class","flex items-center justify-center"),p(t,"class","flex justify-between"),p(G,"class","keyboard svelte-1av9wwd"),p(A,"class","flex flex-col"),p(e,"class",x=Te(`${s[10].class||""} relative`)+" svelte-1av9wwd")},m(J,H){M(J,e,H),f(e,t),f(t,n),f(n,l),f(l,r),f(l,a),de(i,l,null),f(n,c),f(n,u),f(u,d),f(u,m),de(h,u,null),f(n,v),f(n,S),f(S,k),f(S,P),de(T,S,null),f(S,R),f(S,O),f(t,I),f(t,w),f(w,D),de(N,D,null),f(e,L),f(e,A),f(A,G);for(let me=0;me<Z.length;me+=1)Z[me]&&Z[me].m(G,null);$=!0,Q||(F=Y(D,"click",s[5]),Q=!0)},p(J,[H]){const me={};H&524289&&(me.$$scope={dirty:H,ctx:J}),i.$set(me);const pe={};H&1&&(pe.checked=J[0].isCustom),h.$set(pe);const Re={};if(H&2&&(Re.checked=!J[1]),T.$set(Re),H&269){X=_e(J[3].rows);let ie;for(ie=0;ie<X.length;ie+=1){const ce=Mn(J,X,ie);Z[ie]?(Z[ie].p(ce,H),U(Z[ie],1)):(Z[ie]=Kn(ce),Z[ie].c(),U(Z[ie],1),Z[ie].m(G,null))}for(Ke(),ie=X.length;ie<Z.length;ie+=1)K(ie);$e()}(!$||H&1024&&x!==(x=Te(`${J[10].class||""} relative`)+" svelte-1av9wwd"))&&p(e,"class",x)},i(J){if(!$){U(i.$$.fragment,J),U(h.$$.fragment,J),U(T.$$.fragment,J),U(N.$$.fragment,J);for(let H=0;H<X.length;H+=1)U(Z[H]);$=!0}},o(J){z(i.$$.fragment,J),z(h.$$.fragment,J),z(T.$$.fragment,J),z(N.$$.fragment,J),Z=Z.filter(Boolean);for(let H=0;H<Z.length;H+=1)z(Z[H]);$=!1},d(J){J&&_(e),he(i),he(h),he(T),he(N),Oe(Z,J),Q=!1,F()}}}function gr(s,e,t){let n,l,r,o,a;be(s,Et,v=>t(0,r=v)),be(s,Rt,v=>t(11,o=v)),be(s,Tt,v=>t(3,a=v)),gl(()=>{a.opts.isCustom||ct.setLayout(navigator.languages)});const i=Object.entries(Vs).map(([v,S])=>({key:v,value:S.name}));function c(){ct.reset(),ct.setLayout(navigator.languages)}function u(v){return ct.setLayout([v]),!1}function d(v){ct.setCustomLayout(v.currentTarget.checked)}function g(v){ct.captureHotkeyRow(v)}function m(){ct.toggleRows()}const h=v=>g(v);return s.$$set=v=>{t(10,e=Ae(Ae({},e),Ne(v)))},s.$$.update=()=>{s.$$.dirty&2049&&t(2,n=o.map((v,S)=>r.hotkeydRows==="middle-row"?S===1||S===2:!0)),s.$$.dirty&1&&t(1,l=r.hotkeydRows==="middle-row")},e=Ne(e),[r,l,n,a,i,c,u,d,g,m,e,o,h]}class vr extends Fe{constructor(e){super(),He(this,e,gr,pr,ze,{})}}function $n(s){let e,t="Hotkey Map",n,l,r;return l=new vr({}),{c(){e=b("h4"),e.textContent=t,n=j(),ue(l.$$.fragment),this.h()},l(o){e=y(o,"H4",{class:!0,"data-svelte-h":!0}),ae(e)!=="svelte-qx6hm8"&&(e.textContent=t),n=B(o),fe(l.$$.fragment,o),this.h()},h(){p(e,"class","mt-4 text-lg")},m(o,a){M(o,e,a),M(o,n,a),de(l,o,a),r=!0},i(o){r||(U(l.$$.fragment,o),r=!0)},o(o){z(l.$$.fragment,o),r=!1},d(o){o&&(_(e),_(n)),he(l,o)}}}function br(s){let e,t,n,l,r="I/O",o,a,i,c,u,d,g,m,h="Device",v,S,k,E,P,T,R="Prompt",O,V,I="Disable",w,D,N,L,A="Sound",G,x,$,Q,F,X="Fixed velocity",Z,K,J,H,me,pe,Re="Keyboard",ie,ce,le,re,ge,we="Hotkeys",tt,q,oe,Ee,Ue,ne="Auto-octave",qe,je,ut,et,Qe,We=" ",St,ft,xe,ks,Jt,ws,yt,kt,Fs="Fade timeout",Es,dt,Cs,Yt,lt,Is,Hs;c=new Me({props:{icon:Wt,width:16}}),x=new Nt({props:{id:"sound",checked:s[3].useSound}}),x.$on("change",s[13]),ce=new Nt({props:{id:"keyboard",checked:s[3].useKeyboard}}),ce.$on("change",s[15]),q=new Nt({props:{id:"hotkeys",checked:s[3].useHotkeys}}),q.$on("change",s[9]),je=new Nt({props:{id:"auto-octave",checked:s[3].useAutoOctave}}),je.$on("change",s[16]);let Be=s[2]&&!s[4]&&$n();return{c(){e=b("div"),t=b("fieldset"),n=b("legend"),l=b("button"),l.textContent=r,o=j(),a=b("div"),i=b("button"),ue(c.$$.fragment),u=j(),d=b("div"),g=b("div"),m=b("label"),m.textContent=h,v=j(),S=b("input"),E=j(),P=b("div"),T=b("button"),T.textContent=R,O=j(),V=b("button"),V.textContent=I,w=j(),D=b("div"),N=b("div"),L=b("label"),L.textContent=A,G=j(),ue(x.$$.fragment),$=j(),Q=b("div"),F=b("label"),F.textContent=X,Z=j(),K=b("input"),J=j(),H=b("div"),me=b("div"),pe=b("label"),pe.textContent=Re,ie=j(),ue(ce.$$.fragment),le=j(),re=b("div"),ge=b("label"),ge.textContent=we,tt=j(),ue(q.$$.fragment),oe=j(),Ee=b("div"),Ue=b("label"),Ue.textContent=ne,qe=j(),ue(je.$$.fragment),ut=j(),et=b("div"),Qe=b("div"),Qe.textContent=We,St=j(),ft=b("div"),xe=b("button"),ks=ee("Set hotkeys"),ws=j(),yt=b("div"),kt=b("label"),kt.textContent=Fs,Es=j(),dt=b("input"),Cs=j(),Be&&Be.c(),this.h()},l(ke){e=y(ke,"DIV",{class:!0});var Ge=C(e);t=y(Ge,"FIELDSET",{class:!0});var ot=C(t);n=y(ot,"LEGEND",{class:!0});var Ut=C(n);l=y(Ut,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-1jbbsti"&&(l.textContent=r),Ut.forEach(_),o=B(ot),a=y(ot,"DIV",{class:!0});var xt=C(a);i=y(xt,"BUTTON",{class:!0});var Kt=C(i);fe(c.$$.fragment,Kt),Kt.forEach(_),xt.forEach(_),u=B(ot),d=y(ot,"DIV",{class:!0});var rt=C(d);g=y(rt,"DIV",{class:!0});var Dt=C(g);m=y(Dt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(m)!=="svelte-crpa7y"&&(m.textContent=h),v=B(Dt),S=y(Dt,"INPUT",{class:!0,id:!0}),E=B(Dt),P=y(Dt,"DIV",{class:!0});var Qt=C(P);T=y(Qt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(T)!=="svelte-mj6mct"&&(T.textContent=R),O=B(Qt),V=y(Qt,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(V)!=="svelte-1sl6oxh"&&(V.textContent=I),Qt.forEach(_),Dt.forEach(_),w=B(rt),D=y(rt,"DIV",{class:!0});var Xt=C(D);N=y(Xt,"DIV",{class:!0});var Zt=C(N);L=y(Zt,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(L)!=="svelte-wgxtkw"&&(L.textContent=A),G=B(Zt),fe(x.$$.fragment,Zt),Zt.forEach(_),$=B(Xt),Q=y(Xt,"DIV",{class:!0});var es=C(Q);F=y(es,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(F)!=="svelte-1tm2bth"&&(F.textContent=X),Z=B(es),K=y(es,"INPUT",{class:!0,id:!0,placeholder:!0}),es.forEach(_),Xt.forEach(_),J=B(rt),H=y(rt,"DIV",{class:!0});var Lt=C(H);me=y(Lt,"DIV",{class:!0});var ts=C(me);pe=y(ts,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(pe)!=="svelte-1js269u"&&(pe.textContent=Re),ie=B(ts),fe(ce.$$.fragment,ts),ts.forEach(_),le=B(Lt),re=y(Lt,"DIV",{class:!0});var ss=C(re);ge=y(ss,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(ge)!=="svelte-21h39k"&&(ge.textContent=we),tt=B(ss),fe(q.$$.fragment,ss),ss.forEach(_),oe=B(Lt),Ee=y(Lt,"DIV",{class:!0});var ns=C(Ee);Ue=y(ns,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Ue)!=="svelte-33lczu"&&(Ue.textContent=ne),qe=B(ns),fe(je.$$.fragment,ns),ns.forEach(_),Lt.forEach(_),ut=B(rt),et=y(rt,"DIV",{class:!0});var Ot=C(et);Qe=y(Ot,"DIV",{class:!0,"data-svelte-h":!0}),ae(Qe)!=="svelte-dgefms"&&(Qe.textContent=We),St=B(Ot),ft=y(Ot,"DIV",{class:!0});var zs=C(ft);xe=y(zs,"BUTTON",{class:!0});var qs=C(xe);ks=te(qs,"Set hotkeys"),qs.forEach(_),zs.forEach(_),ws=B(Ot),yt=y(Ot,"DIV",{class:!0});var ls=C(yt);kt=y(ls,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(kt)!=="svelte-vd5i27"&&(kt.textContent=Fs),Es=B(ls),dt=y(ls,"INPUT",{class:!0,id:!0}),ls.forEach(_),Ot.forEach(_),rt.forEach(_),Cs=B(ot),Be&&Be.l(ot),ot.forEach(_),Ge.forEach(_),this.h()},h(){var ke;p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(i,"class","rounded px-1 py-1 hover:bg-gray-200"),p(a,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center"),W(a,"hidden",s[4]),p(m,"class","font-bold"),p(m,"for","device"),p(S,"class","px-1 my-1 rounded w-50"),p(S,"id","device"),S.disabled=!0,S.value=k=((ke=s[5])==null?void 0:ke.name)??"No device",p(T,"class","btn-sm primary mr-2"),p(V,"class","btn-sm primary"),p(P,"class","flex my-[auto]"),p(g,"class","h-full flex flex-col"),p(L,"class","font-bold"),p(L,"for","sound"),p(N,"class","my-1 flex justify-between items-center mr-12"),p(F,"class","font-bold"),p(F,"for","fixed-velocity"),p(K,"class","h-[20px] w-16"),p(K,"id","fixed-velocity"),p(K,"placeholder","0-127"),p(Q,"class","flex justify-between"),p(D,"class","flex flex-col h-full"),p(pe,"class","font-bold"),p(pe,"for","keyboard"),p(me,"class","my-1 flex justify-between items-center mr-12"),p(ge,"class","font-bold"),p(ge,"for","hotkeys"),p(re,"class","my-1 flex justify-between items-center mr-12"),p(Ue,"class","font-bold"),p(Ue,"for","auto-octave"),p(Ee,"class","my-1 flex justify-between items-center mr-12"),p(H,"class","flex flex-col h-full"),p(Qe,"class","h-[28px]"),p(xe,"class","w-full btn-sm primary"),xe.disabled=Jt=!s[3].useHotkeys,p(ft,"class","my-[2px] flex justify-between"),p(kt,"class","font-bold"),p(kt,"for","fade-timeout"),p(dt,"class","h-[20px] w-16"),p(dt,"id","fade-timeout"),dt.value=s[1],p(yt,"class","my-1 flex justify-between"),p(et,"class","flex flex-col h-full"),p(d,"class","body svelte-1bpw69s"),W(d,"hidden",s[4]),p(t,"class","relative flex flex-col max-w-full rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-1bpw69s"),W(t,"collapsed",s[4]),p(e,"class",Yt=Te(`${s[12].class||""}`)+" svelte-1bpw69s")},m(ke,Ge){M(ke,e,Ge),f(e,t),f(t,n),f(n,l),f(t,o),f(t,a),f(a,i),de(c,i,null),f(t,u),f(t,d),f(d,g),f(g,m),f(g,v),f(g,S),f(g,E),f(g,P),f(P,T),f(P,O),f(P,V),f(d,w),f(d,D),f(D,N),f(N,L),f(N,G),de(x,N,null),f(D,$),f(D,Q),f(Q,F),f(Q,Z),f(Q,K),Ze(K,s[0]),f(d,J),f(d,H),f(H,me),f(me,pe),f(me,ie),de(ce,me,null),f(H,le),f(H,re),f(re,ge),f(re,tt),de(q,re,null),f(H,oe),f(H,Ee),f(Ee,Ue),f(Ee,qe),de(je,Ee,null),f(d,ut),f(d,et),f(et,Qe),f(et,St),f(et,ft),f(ft,xe),f(xe,ks),f(et,ws),f(et,yt),f(yt,kt),f(yt,Es),f(yt,dt),f(t,Cs),Be&&Be.m(t,null),lt=!0,Is||(Hs=[Y(l,"click",s[7]),Y(i,"click",s[11]),Y(T,"click",Pe.openMidi),Y(V,"click",Pe.disableMidi),Y(K,"input",s[14]),Y(K,"change",s[8]),Y(xe,"click",s[17]),Y(dt,"input",s[10])],Is=!0)},p(ke,[Ge]){var rt;(!lt||Ge&16)&&W(a,"hidden",ke[4]),(!lt||Ge&32&&k!==(k=((rt=ke[5])==null?void 0:rt.name)??"No device")&&S.value!==k)&&(S.value=k);const ot={};Ge&8&&(ot.checked=ke[3].useSound),x.$set(ot),Ge&1&&K.value!==ke[0]&&Ze(K,ke[0]);const Ut={};Ge&8&&(Ut.checked=ke[3].useKeyboard),ce.$set(Ut);const xt={};Ge&8&&(xt.checked=ke[3].useHotkeys),q.$set(xt);const Kt={};Ge&8&&(Kt.checked=ke[3].useAutoOctave),je.$set(Kt),(!lt||Ge&8&&Jt!==(Jt=!ke[3].useHotkeys))&&(xe.disabled=Jt),(!lt||Ge&2&&dt.value!==ke[1])&&(dt.value=ke[1]),(!lt||Ge&16)&&W(d,"hidden",ke[4]),ke[2]&&!ke[4]?Be?Ge&20&&U(Be,1):(Be=$n(),Be.c(),U(Be,1),Be.m(t,null)):Be&&(Ke(),z(Be,1,1,()=>{Be=null}),$e()),(!lt||Ge&16)&&W(t,"collapsed",ke[4]),(!lt||Ge&4096&&Yt!==(Yt=Te(`${ke[12].class||""}`)+" svelte-1bpw69s"))&&p(e,"class",Yt)},i(ke){lt||(U(c.$$.fragment,ke),U(x.$$.fragment,ke),U(ce.$$.fragment,ke),U(q.$$.fragment,ke),U(je.$$.fragment,ke),U(Be),lt=!0)},o(ke){z(c.$$.fragment,ke),z(x.$$.fragment,ke),z(ce.$$.fragment,ke),z(q.$$.fragment,ke),z(je.$$.fragment,ke),z(Be),lt=!1},d(ke){ke&&_(e),he(c),he(x),he(ce),he(q),he(je),Be&&Be.d(),Is=!1,Ye(Hs)}}}function yr(s,e,t){let n,l,r;be(s,nt,T=>t(3,n=T)),be(s,gs,T=>t(5,r=T));const o=bt(Ve(!1),{key:"inputs-hidden"});be(s,o,T=>t(4,l=T));let a=n.fixedVelocity??"",i=n.keyFadeTimeout,c=!1;nt.subscribe(T=>{t(0,a=T.fixedVelocity??""),t(1,i=T.keyFadeTimeout)});function u(){o.update(T=>!T)}function d(T){const{value:R}=T.currentTarget;let O;if(R)try{O=parseInt(R)}catch{}O!==void 0&&O>=0&&O<=127?Pe.setInputValue("fixedVelocity",O):R?t(0,a=n.fixedVelocity||""):Pe.setInputValue("fixedVelocity",void 0)}function g(T){Pe.setInputValue("useHotkeys",T.currentTarget.checked),T.currentTarget.checked||(t(2,c=!1),ct.cancelCapture())}function m(T){try{const R=parseInt(T.currentTarget.value);Pe.setInputValue("keyFadeTimeout",R)}catch{t(1,i=n.keyFadeTimeout)}}function h(){Pe.setInputValue("useSound",!0),Pe.setInputValue("fixedVelocity",void 0),Pe.setInputValue("useKeyboard",!0),Pe.setInputValue("useHotkeys",!0),Pe.setInputValue("useAutoOctave",!0),Pe.setInputValue("keyFadeTimeout",1500)}const v=T=>Pe.setInputValue("useSound",T.currentTarget.checked);function S(){a=this.value,t(0,a)}const k=T=>Pe.setInputValue("useKeyboard",T.currentTarget.checked),E=T=>Pe.setInputValue("useAutoOctave",T.currentTarget.checked),P=()=>t(2,c=!c);return s.$$set=T=>{t(12,e=Ae(Ae({},e),Ne(T)))},e=Ne(e),[a,i,c,n,l,r,o,u,d,g,m,h,e,v,S,k,E,P]}class kr extends Fe{constructor(e){super(),He(this,e,yr,br,ze,{})}}function wr(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){M(t,e,n)},p:ve,d(t){t&&_(e)}}}function Er(s){let e,t=s[1].note+"",n;return{c(){e=ee("Input: "),n=ee(t)},l(l){e=te(l,"Input: "),n=te(l,t)},m(l,r){M(l,e,r),M(l,n,r)},p(l,r){r&2&&t!==(t=l[1].note+"")&&ye(n,t)},d(l){l&&(_(e),_(n))}}}function Cr(s){let e,t;return{c(){e=ee("Input: "),t=ee(s[0])},l(n){e=te(n,"Input: "),t=te(n,s[0])},m(n,l){M(n,e,l),M(n,t,l)},p(n,l){l&1&&ye(t,n[0])},d(n){n&&(_(e),_(t))}}}function Ir(s){let e;return{c(){e=ee(Ps)},l(t){e=te(t,Ps)},m(t,n){M(t,e,n)},p:ve,d(t){t&&_(e)}}}function Tr(s){let e,t,n,l;function r(i,c){return i[2].useKeyboard&&Ps?Ir:i[2].useKeyboard&&i[0]?Cr:i[2].useKeyboard&&i[1]?Er:wr}let o=r(s),a=o(s);return{c(){e=b("div"),a.c(),this.h()},l(i){e=y(i,"DIV",{class:!0});var c=C(e);a.l(c),c.forEach(_),this.h()},h(){p(e,"class",t=`${s[4].class||""}`)},m(i,c){M(i,e,c),a.m(e,null),n||(l=Y(window,"keydown",s[3]),n=!0)},p(i,[c]){o===(o=r(i))&&a?a.p(i,c):(a.d(1),a=o(i),a&&(a.c(),a.m(e,null))),c&16&&t!==(t=`${i[4].class||""}`)&&p(e,"class",t)},i:ve,o:ve,d(i){i&&_(e),a.d(),n=!1,l()}}}let Ps="";function Ar(s,e,t){let n;be(s,nt,c=>t(2,n=c));let{debounced:l}=e,r="",o;const a=jl();function i(c){const u=c.target;if(l||!(u instanceof HTMLElement)||u.tagName==="INPUT")return;const d=ct.handleInput(c.code,c.key,c.shiftKey);d&&d.e==="note"?t(1,o=d.data):d&&d.e==="string"?t(0,r=d.data):d&&(d.e==="guessed-key"||d.e==="guessed-chord"||d.e==="guessed-note")?(t(0,r=""),t(1,o=void 0),a(d.e,d.data),c.code==="Enter"&&c.preventDefault()):d&&c.preventDefault()}return s.$$set=c=>{t(4,e=Ae(Ae({},e),Ne(c))),"debounced"in c&&t(5,l=c.debounced)},e=Ne(e),[r,o,n,i,e,l]}class Nr extends Fe{constructor(e){super(),He(this,e,Ar,Tr,ze,{debounced:5})}}function Sr(s){let e,t,n,l="Count",r,o,a,i,c,u="Duplicates",d,g,m,h,v,S="Autoplay",k,E,P,T,R,O="Wait seconds",V,I,w,D,N,L;return g=new Nt({props:{id:"duplicates",checked:s[2].duplicates}}),g.$on("input",s[7]),E=new Nt({props:{id:"autoplay",checked:s[2].autoplay}}),E.$on("input",s[8]),{c(){e=b("ul"),t=b("li"),n=b("label"),n.textContent=l,r=j(),o=b("input"),a=j(),i=b("li"),c=b("label"),c.textContent=u,d=j(),ue(g.$$.fragment),m=j(),h=b("li"),v=b("label"),v.textContent=S,k=j(),ue(E.$$.fragment),P=j(),T=b("li"),R=b("label"),R.textContent=O,V=j(),I=b("input"),this.h()},l(A){e=y(A,"UL",{class:!0});var G=C(e);t=y(G,"LI",{class:!0});var x=C(t);n=y(x,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(n)!=="svelte-wgq9fc"&&(n.textContent=l),r=B(x),o=y(x,"INPUT",{class:!0,id:!0,type:!0}),x.forEach(_),a=B(G),i=y(G,"LI",{class:!0});var $=C(i);c=y($,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(c)!=="svelte-hcg9dq"&&(c.textContent=u),d=B($),fe(g.$$.fragment,$),$.forEach(_),m=B(G),h=y(G,"LI",{class:!0});var Q=C(h);v=y(Q,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(v)!=="svelte-lr68n2"&&(v.textContent=S),k=B(Q),fe(E.$$.fragment,Q),Q.forEach(_),P=B(G),T=y(G,"LI",{class:!0});var F=C(T);R=y(F,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(R)!=="svelte-1qj2vcy"&&(R.textContent=O),V=B(F),I=y(F,"INPUT",{class:!0,id:!0,type:!0}),F.forEach(_),G.forEach(_),this.h()},h(){p(n,"class","font-bold"),p(n,"for","guess-count"),p(o,"class","h-[20px] w-10"),p(o,"id","guess-count"),p(o,"type","number"),p(t,"class","flex items-center justify-between svelte-1elvih2"),p(c,"class","font-bold"),p(c,"for","duplicates"),p(i,"class","flex items-center justify-between items-center mr-6 svelte-1elvih2"),p(v,"class","font-bold"),p(v,"for","autoplay"),p(h,"class","flex items-center justify-between items-center mr-6 svelte-1elvih2"),p(R,"class","font-bold"),p(R,"for","wait-ms"),p(I,"class","h-[20px] w-10"),p(I,"id","wait-ms"),p(I,"type","number"),p(T,"class","flex items-center justify-between svelte-1elvih2"),p(e,"class",w=Te(`${s[5].class||""}`)+" svelte-1elvih2")},m(A,G){M(A,e,G),f(e,t),f(t,n),f(t,r),f(t,o),Ze(o,s[0]),f(e,a),f(e,i),f(i,c),f(i,d),de(g,i,null),f(e,m),f(e,h),f(h,v),f(h,k),de(E,h,null),f(e,P),f(e,T),f(T,R),f(T,V),f(T,I),Ze(I,s[1]),D=!0,N||(L=[Y(o,"input",s[6]),Y(o,"input",s[3]),Y(I,"input",s[9]),Y(I,"input",s[4])],N=!0)},p(A,[G]){G&1&&hs(o.value)!==A[0]&&Ze(o,A[0]);const x={};G&4&&(x.checked=A[2].duplicates),g.$set(x);const $={};G&4&&($.checked=A[2].autoplay),E.$set($),G&2&&hs(I.value)!==A[1]&&Ze(I,A[1]),(!D||G&32&&w!==(w=Te(`${A[5].class||""}`)+" svelte-1elvih2"))&&p(e,"class",w)},i(A){D||(U(g.$$.fragment,A),U(E.$$.fragment,A),D=!0)},o(A){z(g.$$.fragment,A),z(E.$$.fragment,A),D=!1},d(A){A&&_(e),he(g),he(E),N=!1,Ye(L)}}}function Dr(s,e,t){let n;be(s,gt,g=>t(2,n=g));let l=n.count||"",r=n.waitSeconds||"";gt.subscribe(g=>{t(0,l=g.count||""),t(1,r=g.waitSeconds||"")});function o({currentTarget:{value:g}}){let m;try{m=parseInt(g),m<=0&&(m=1),De.setOptionValue("count",m)}catch{t(0,l=n.count)}}function a({currentTarget:{value:g}}){let m;try{m=parseInt(g),m<0&&(m=0),De.setOptionValue("waitSeconds",m)}catch{t(1,r=n.waitSeconds)}}function i(){l=hs(this.value),t(0,l)}const c=g=>De.setOptionValue("duplicates",g.currentTarget.checked),u=g=>De.setOptionValue("autoplay",g.currentTarget.checked);function d(){r=hs(this.value),t(1,r)}return s.$$set=g=>{t(5,e=Ae(Ae({},e),Ne(g)))},e=Ne(e),[l,r,n,o,a,e,i,c,u,d]}class Lr extends Fe{constructor(e){super(),He(this,e,Dr,Sr,ze,{})}}function Fn(s,e,t){const n=s.slice();return n[22]=e[t].key,n[23]=e[t].value,n}function Hn(s,e,t){const n=s.slice();return n[22]=e[t].key,n[23]=e[t].value,n}function zn(s){let e,t,n=s[23]+"",l,r,o,a,i,c,u,d;function g(){return s[15](s[22])}a=new Me({props:{icon:Ss,width:20}});function m(...h){return s[16](s[22],...h)}return{c(){e=b("li"),t=b("button"),l=ee(n),r=j(),o=b("button"),ue(a.$$.fragment),i=j(),this.h()},l(h){e=y(h,"LI",{class:!0});var v=C(e);t=y(v,"BUTTON",{class:!0});var S=C(t);l=te(S,n),S.forEach(_),r=B(v),o=y(v,"BUTTON",{class:!0});var k=C(o);fe(a.$$.fragment,k),k.forEach(_),i=B(v),v.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),W(t,"selected",s[22]===s[0]),p(o,"class","px-1 py-1 flex items-center justify-center rounded text-[#222] hover:bg-blue-500 hover:text-white"),p(e,"class","flex svelte-1okhpct")},m(h,v){M(h,e,v),f(e,t),f(t,l),f(e,r),f(e,o),de(a,o,null),f(e,i),c=!0,u||(d=[Y(t,"click",g),Y(o,"click",m)],u=!0)},p(h,v){s=h,(!c||v&17)&&W(t,"selected",s[22]===s[0])},i(h){c||(U(a.$$.fragment,h),c=!0)},o(h){z(a.$$.fragment,h),c=!1},d(h){h&&_(e),he(a),u=!1,Ye(d)}}}function qn(s){let e,t=_e(s[3]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Wn(Fn(s,t,l));return{c(){e=b("ul");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=y(l,"UL",{class:!0});var r=C(e);for(let o=0;o<n.length;o+=1)n[o].l(r);r.forEach(_),this.h()},h(){p(e,"class","svelte-1okhpct")},m(l,r){M(l,e,r);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(l,r){if(r&138){t=_e(l[3]);let o;for(o=0;o<t.length;o+=1){const a=Fn(l,t,o);n[o]?n[o].p(a,r):(n[o]=Wn(a),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Wn(s){let e,t,n=s[23]+"",l,r,o,a;function i(){return s[17](s[22])}return{c(){e=b("li"),t=b("button"),l=ee(n),r=j(),this.h()},l(c){e=y(c,"LI",{class:!0});var u=C(e);t=y(u,"BUTTON",{class:!0});var d=C(t);l=te(d,n),d.forEach(_),r=B(u),u.forEach(_),this.h()},h(){p(t,"class","px-2 py-1 mr-1 flex items-center w-full h-full rounded hover:bg-[#eee] svelte-1okhpct"),W(t,"selected",s[22]===s[1]),p(e,"class","svelte-1okhpct")},m(c,u){M(c,e,u),f(e,t),f(t,l),f(e,r),o||(a=Y(t,"click",i),o=!0)},p(c,u){s=c,u&8&&n!==(n=s[23]+"")&&ye(l,n),u&10&&W(t,"selected",s[22]===s[1])},d(c){c&&_(e),o=!1,a()}}}function Or(s){let e,t,n="Play",l,r,o,a,i,c,u,d,g,m,h="Reset",v,S,k,E,P=s[2]?"Quit":"Play",T,R,O,V,I,w=_e(s[4]),D=[];for(let A=0;A<w.length;A+=1)D[A]=zn(Hn(s,w,A));const N=A=>z(D[A],1,1,()=>{D[A]=null});let L=(s[0]==="chords-write"||s[0]==="chords-play")&&qn(s);return u=new Lr({props:{class:"game-options"}}),k=new Me({props:{class:"mr-1",icon:s[2]?Ys:Ss,width:20}}),{c(){e=b("fieldset"),t=b("legend"),t.textContent=n,l=j(),r=b("div"),o=b("ul");for(let A=0;A<D.length;A+=1)D[A].c();a=j(),i=b("div"),L&&L.c(),c=j(),ue(u.$$.fragment),d=j(),g=b("div"),m=b("button"),m.textContent=h,v=j(),S=b("button"),ue(k.$$.fragment),E=j(),T=ee(P),this.h()},l(A){e=y(A,"FIELDSET",{class:!0});var G=C(e);t=y(G,"LEGEND",{class:!0,"data-svelte-h":!0}),ae(t)!=="svelte-1409tnk"&&(t.textContent=n),l=B(G),r=y(G,"DIV",{class:!0});var x=C(r);o=y(x,"UL",{class:!0});var $=C(o);for(let Z=0;Z<D.length;Z+=1)D[Z].l($);$.forEach(_),a=B(x),i=y(x,"DIV",{class:!0});var Q=C(i);L&&L.l(Q),Q.forEach(_),c=B(x),fe(u.$$.fragment,x),d=B(x),g=y(x,"DIV",{class:!0});var F=C(g);m=y(F,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(m)!=="svelte-10rv0bu"&&(m.textContent=h),v=B(F),S=y(F,"BUTTON",{class:!0});var X=C(S);fe(k.$$.fragment,X),E=B(X),T=te(X,P),X.forEach(_),F.forEach(_),x.forEach(_),G.forEach(_),this.h()},h(){p(t,"class","px-1 text-base"),p(o,"class","games svelte-1okhpct"),p(i,"class","options svelte-1okhpct"),p(m,"class","w-full btn hover:bg-gray-200"),p(S,"class","w-full mt-2 flex items-center justify-center btn primary"),p(g,"class","h-full flex flex-col justify-end"),p(r,"class","body pb-2 h-full svelte-1okhpct"),p(e,"class",R=Te(`${s[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct")},m(A,G){M(A,e,G),f(e,t),f(e,l),f(e,r),f(r,o);for(let x=0;x<D.length;x+=1)D[x]&&D[x].m(o,null);f(r,a),f(r,i),L&&L.m(i,null),f(r,c),de(u,r,null),f(r,d),f(r,g),f(g,m),f(g,v),f(g,S),de(k,S,null),f(S,E),f(S,T),O=!0,V||(I=[Y(m,"click",s[8]),Y(S,"click",s[9])],V=!0)},p(A,[G]){if(G&113){w=_e(A[4]);let $;for($=0;$<w.length;$+=1){const Q=Hn(A,w,$);D[$]?(D[$].p(Q,G),U(D[$],1)):(D[$]=zn(Q),D[$].c(),U(D[$],1),D[$].m(o,null))}for(Ke(),$=w.length;$<D.length;$+=1)N($);$e()}A[0]==="chords-write"||A[0]==="chords-play"?L?L.p(A,G):(L=qn(A),L.c(),L.m(i,null)):L&&(L.d(1),L=null);const x={};G&4&&(x.icon=A[2]?Ys:Ss),k.$set(x),(!O||G&4)&&P!==(P=A[2]?"Quit":"Play")&&ye(T,P),(!O||G&1024&&R!==(R=Te(`${A[10].class||""} flex flex-col rounded border-2 px-4 py-2 text-sm`)+" svelte-1okhpct"))&&p(e,"class",R)},i(A){if(!O){for(let G=0;G<w.length;G+=1)U(D[G]);U(u.$$.fragment,A),U(k.$$.fragment,A),O=!0}},o(A){D=D.filter(Boolean);for(let G=0;G<D.length;G+=1)z(D[G]);z(u.$$.fragment,A),z(k.$$.fragment,A),O=!1},d(A){A&&_(e),Oe(D,A),L&&L.d(),he(u),he(k),V=!1,Ye(I)}}}function Vr(s,e,t){let n,l,r,o,a,i,c;be(s,xs,O=>t(12,o=O)),be(s,gt,O=>t(20,a=O)),be(s,_t,O=>t(13,i=O)),be(s,It,O=>t(14,c=O));const u=[{key:"notes",value:"Play Notes"},{key:"pitches",value:"Guess Pitches"},{key:"keys-major",value:"Guess Major Keys"},{key:"keys-minor",value:"Guess Minor Keys"},{key:"chords-write",value:"Write Chords"},{key:"chords-play",value:"Play Chords"},{key:"chords-diatonic",value:"Play Diatonic Triads"}];let d=u[4].key,g="maj-m";a.count,a.waitSeconds,gt.subscribe(O=>{O.count,O.waitSeconds});function m(O,V){if(V==="chords-write"||V==="chords-play"||V==="chords-diatonic"){let I=[];g==="selected"?I=o.filter(w=>w.selected):g==="all"?I=o:g==="maj-m"?I=o.filter(w=>w.suffixes[0]==="maj"||w.suffixes[0]==="m"):g==="seventh"&&(I=o.filter(w=>w.suffixes[0]==="maj7"||w.suffixes[0]==="m7"||w.suffixes[0]==="7"||w.suffixes[0]==="dim7"||w.suffixes[0]==="aug7")),De.play(V,{chords:I})}else De.play(V,void 0);O.currentTarget instanceof HTMLElement&&O.currentTarget.blur(),setTimeout(()=>{window.scrollTo(0,document.body.scrollHeight)})}function h(O){t(0,d=O)}function v(O,V){t(0,d=V),m(O,V)}function S(O){t(1,g=O)}function k(){De.clearGame(!0)}function E(O){n?De.clearGame():m(O,d)}const P=O=>h(O),T=(O,V)=>v(V,O),R=O=>S(O);return s.$$set=O=>{t(10,e=Ae(Ae({},e),Ne(O)))},s.$$.update=()=>{s.$$.dirty&24576&&t(2,n=!!c&&i!=="ended"),s.$$.dirty&4096&&t(11,l=o.reduce((O,V)=>V.selected?O+1:O,0)),s.$$.dirty&2048&&t(3,r=[{key:"maj-m",value:"Major/Minor"},{key:"seventh",value:"Seventh"},{key:"selected",value:`Selected ${l} chords`},{key:"all",value:"All"}])},e=Ne(e),[d,g,n,r,u,h,v,S,k,E,e,l,o,i,c,P,T,R]}class Pr extends Fe{constructor(e){super(),He(this,e,Vr,Or,ze,{})}}function Jn(s,e,t){const n=s.slice();return n[7]=e[t],n}function Yn(s,e,t){const n=s.slice();return n[4]=e[t],n}function jr(s){let e,t=_e(s[1]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Qn(Jn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let r=0;r<n.length;r+=1)n[r].l(l);e=Le()},m(l,r){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(l,r);M(l,e,r)},p(l,r){if(r&2){t=_e(l[1]);let o;for(o=0;o<t.length;o+=1){const a=Jn(l,t,o);n[o]?n[o].p(a,r):(n[o]=Qn(a),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Br(s){let e,t=_e(s[0].scaleNotes||[]),n=[];for(let l=0;l<t.length;l+=1)n[l]=Xn(Yn(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let r=0;r<n.length;r+=1)n[r].l(l);e=Le()},m(l,r){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(l,r);M(l,e,r)},p(l,r){if(r&1){t=_e(l[0].scaleNotes||[]);let o;for(o=0;o<t.length;o+=1){const a=Yn(l,t,o);n[o]?n[o].p(a,r):(n[o]=Xn(a),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Qn(s){let e,t=s[7].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var r=C(e);n=te(r,t),r.forEach(_),this.h()},h(){p(e,"class","svelte-my4m0t")},m(l,r){M(l,e,r),f(e,n)},p(l,r){r&2&&t!==(t=l[7].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function Xn(s){let e,t=s[4].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var r=C(e);n=te(r,t),r.forEach(_),this.h()},h(){p(e,"class","svelte-my4m0t")},m(l,r){M(l,e,r),f(e,n)},p(l,r){r&1&&t!==(t=l[4].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function Gr(s){let e,t,n,l,r,o;function a(u,d){return u[0]?Br:jr}let i=a(s),c=i(s);return{c(){e=b("div"),t=b("button"),c.c(),this.h()},l(u){e=y(u,"DIV",{class:!0,title:!0});var d=C(e);t=y(d,"BUTTON",{class:!0});var g=C(t);c.l(g),g.forEach(_),d.forEach(_),this.h()},h(){p(t,"class","intervals svelte-my4m0t"),p(e,"class",n=`${s[2].class||""} `),p(e,"title",l=s[1].map(Zn).join("-"))},m(u,d){M(u,e,d),f(e,t),c.m(t,null),r||(o=Y(t,"click",s[3]),r=!0)},p(u,[d]){i===(i=a(u))&&c?c.p(u,d):(c.d(1),c=i(u),c&&(c.c(),c.m(t,null))),d&4&&n!==(n=`${u[2].class||""} `)&&p(e,"class",n),d&2&&l!==(l=u[1].map(Zn).join("-"))&&p(e,"title",l)},i:ve,o:ve,d(u){u&&_(e),c.d(),r=!1,o()}}}const Zn=s=>s.interval;function Mr(s,e,t){let{scale:n,intervals:l}=e;function r(o){jt.call(this,s,o)}return s.$$set=o=>{t(2,e=Ae(Ae({},e),Ne(o))),"scale"in o&&t(0,n=o.scale),"intervals"in o&&t(1,l=o.intervals)},e=Ne(e),[n,l,e,r]}class Vl extends Fe{constructor(e){super(),He(this,e,Mr,Gr,ze,{scale:0,intervals:1})}}function el(s,e,t){const n=s.slice();return n[7]=e[t],n}function tl(s,e,t){const n=s.slice();return n[4]=e[t],n}function Rr(s){let e,t=_e(s[0]),n=[];for(let l=0;l<t.length;l+=1)n[l]=sl(el(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let r=0;r<n.length;r+=1)n[r].l(l);e=Le()},m(l,r){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(l,r);M(l,e,r)},p(l,r){if(r&1){t=_e(l[0]);let o;for(o=0;o<t.length;o+=1){const a=el(l,t,o);n[o]?n[o].p(a,r):(n[o]=sl(a),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function Ur(s){let e,t=_e(s[1]),n=[];for(let l=0;l<t.length;l+=1)n[l]=nl(tl(s,t,l));return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=Le()},l(l){for(let r=0;r<n.length;r+=1)n[r].l(l);e=Le()},m(l,r){for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(l,r);M(l,e,r)},p(l,r){if(r&2){t=_e(l[1]);let o;for(o=0;o<t.length;o+=1){const a=tl(l,t,o);n[o]?n[o].p(a,r):(n[o]=nl(a),n[o].c(),n[o].m(e.parentNode,e))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function sl(s){let e,t,n=s[7].roman+"",l,r,o,a=s[7].suffix+"",i,c;return{c(){e=b("span"),t=b("span"),l=ee(n),r=j(),o=b("sup"),i=ee(a),c=j(),this.h()},l(u){e=y(u,"SPAN",{class:!0});var d=C(e);t=y(d,"SPAN",{class:!0});var g=C(t);l=te(g,n),g.forEach(_),r=B(d),o=y(d,"SUP",{class:!0});var m=C(o);i=te(m,a),m.forEach(_),c=B(d),d.forEach(_),this.h()},h(){p(t,"class","block"),p(o,"class","block text-sm leading-none top-[-0.3rem] svelte-1roj1mi"),W(o,"super-text",s[7].suffix.length>2),p(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(u,d){M(u,e,d),f(e,t),f(t,l),f(e,r),f(e,o),f(o,i),f(e,c)},p(u,d){d&1&&n!==(n=u[7].roman+"")&&ye(l,n),d&1&&a!==(a=u[7].suffix+"")&&ye(i,a),d&1&&W(o,"super-text",u[7].suffix.length>2)},d(u){u&&_(e)}}}function nl(s){let e,t,n=s[4]+"",l,r;return{c(){e=b("span"),t=b("span"),l=ee(n),r=j(),this.h()},l(o){e=y(o,"SPAN",{class:!0});var a=C(e);t=y(a,"SPAN",{});var i=C(t);l=te(i,n),i.forEach(_),r=B(a),a.forEach(_),this.h()},h(){p(e,"class","inline-flex items-baseline svelte-1roj1mi")},m(o,a){M(o,e,a),f(e,t),f(t,l),f(e,r)},p(o,a){a&2&&n!==(n=o[4]+"")&&ye(l,n)},d(o){o&&_(e)}}}function xr(s){let e,t,n,l,r,o;function a(u,d){return u[1].length>0?Ur:Rr}let i=a(s),c=i(s);return{c(){e=b("div"),t=b("button"),c.c(),this.h()},l(u){e=y(u,"DIV",{class:!0,title:!0});var d=C(e);t=y(d,"BUTTON",{class:!0});var g=C(t);c.l(g),g.forEach(_),d.forEach(_),this.h()},h(){p(t,"class","triads flex flex-wrap svelte-1roj1mi"),p(e,"class",n=Te(`${s[2].class||""} `)+" svelte-1roj1mi"),p(e,"title",l=s[0].map(ll).join("-"))},m(u,d){M(u,e,d),f(e,t),c.m(t,null),r||(o=Y(t,"click",s[3]),r=!0)},p(u,[d]){i===(i=a(u))&&c?c.p(u,d):(c.d(1),c=i(u),c&&(c.c(),c.m(t,null))),d&4&&n!==(n=Te(`${u[2].class||""} `)+" svelte-1roj1mi")&&p(e,"class",n),d&1&&l!==(l=u[0].map(ll).join("-"))&&p(e,"title",l)},i:ve,o:ve,d(u){u&&_(e),c.d(),r=!1,o()}}}const ll=s=>s.roman+s.suffix;function Kr(s,e,t){let{triads:n,chords:l}=e;function r(o){jt.call(this,s,o)}return s.$$set=o=>{t(2,e=Ae(Ae({},e),Ne(o))),"triads"in o&&t(0,n=o.triads),"chords"in o&&t(1,l=o.chords)},e=Ne(e),[n,l,e,r]}class Pl extends Fe{constructor(e){super(),He(this,e,Kr,xr,ze,{triads:0,chords:1})}}function ol(s,e,t){const n=s.slice();return n[23]=e[t],n}function rl(s,e,t){const n=s.slice();return n[23]=e[t],n}function al(s){let e,t,n=s[23].raw.names[0]+"",l,r,o,a,i,c,u;function d(){return s[11](s[23])}o=new Vl({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),o.$on("click",d);function g(){return s[12](s[23])}return i=new Pl({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",g),{c(){e=b("li"),t=b("div"),l=ee(n),r=j(),ue(o.$$.fragment),a=j(),ue(i.$$.fragment),c=j(),this.h()},l(m){e=y(m,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);l=te(v,n),v.forEach(_),r=B(h),fe(o.$$.fragment,h),a=B(h),fe(i.$$.fragment,h),c=B(h),h.forEach(_),this.h()},h(){p(t,"class","text-xs font-bold"),p(e,"class","svelte-4hctsl")},m(m,h){M(m,e,h),f(e,t),f(t,l),f(e,r),de(o,e,null),f(e,a),de(i,e,null),f(e,c),u=!0},p(m,h){s=m,(!u||h&4)&&n!==(n=s[23].raw.names[0]+"")&&ye(l,n);const v={};h&4&&(v.scale=s[23].scale),h&4&&(v.intervals=s[23].raw.intervals),o.$set(v);const S={};h&4&&(S.triads=s[23].triads),h&4&&(S.chords=s[23].triadChords),i.$set(S)},i(m){u||(U(o.$$.fragment,m),U(i.$$.fragment,m),u=!0)},o(m){z(o.$$.fragment,m),z(i.$$.fragment,m),u=!1},d(m){m&&_(e),he(o),he(i)}}}function il(s){let e,t,n=s[23].raw.names[0]+"",l,r,o,a,i,c,u;function d(){return s[13](s[23])}o=new Vl({props:{scale:s[23].scale,intervals:s[23].raw.intervals}}),o.$on("click",d);function g(){return s[14](s[23])}return i=new Pl({props:{triads:s[23].triads,chords:s[23].triadChords}}),i.$on("click",g),{c(){e=b("li"),t=b("div"),l=ee(n),r=j(),ue(o.$$.fragment),a=j(),ue(i.$$.fragment),c=j(),this.h()},l(m){e=y(m,"LI",{class:!0});var h=C(e);t=y(h,"DIV",{class:!0});var v=C(t);l=te(v,n),v.forEach(_),r=B(h),fe(o.$$.fragment,h),a=B(h),fe(i.$$.fragment,h),c=B(h),h.forEach(_),this.h()},h(){p(t,"class","text-xs font-bold"),p(e,"class","svelte-4hctsl")},m(m,h){M(m,e,h),f(e,t),f(t,l),f(e,r),de(o,e,null),f(e,a),de(i,e,null),f(e,c),u=!0},p(m,h){s=m,(!u||h&2)&&n!==(n=s[23].raw.names[0]+"")&&ye(l,n);const v={};h&2&&(v.scale=s[23].scale),h&2&&(v.intervals=s[23].raw.intervals),o.$set(v);const S={};h&2&&(S.triads=s[23].triads),h&2&&(S.chords=s[23].triadChords),i.$set(S)},i(m){u||(U(o.$$.fragment,m),U(i.$$.fragment,m),u=!0)},o(m){z(o.$$.fragment,m),z(i.$$.fragment,m),u=!1},d(m){m&&_(e),he(o),he(i)}}}function $r(s){let e,t,n,l,r="Scales",o,a,i,c="Key",u,d,g,m,h,v,S,k,E,P,T,R=_e(s[2]),O=[];for(let N=0;N<R.length;N+=1)O[N]=al(rl(s,R,N));const V=N=>z(O[N],1,1,()=>{O[N]=null});let I=_e(s[1]),w=[];for(let N=0;N<I.length;N+=1)w[N]=il(ol(s,I,N));const D=N=>z(w[N],1,1,()=>{w[N]=null});return{c(){e=b("div"),t=b("fieldset"),n=b("legend"),l=b("button"),l.textContent=r,o=j(),a=b("div"),i=b("label"),i.textContent=c,u=j(),d=b("input"),g=j(),m=b("div"),h=b("ul");for(let N=0;N<O.length;N+=1)O[N].c();v=j(),S=b("ul");for(let N=0;N<w.length;N+=1)w[N].c();this.h()},l(N){e=y(N,"DIV",{class:!0});var L=C(e);t=y(L,"FIELDSET",{class:!0});var A=C(t);n=y(A,"LEGEND",{class:!0});var G=C(n);l=y(G,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(l)!=="svelte-lhx60e"&&(l.textContent=r),G.forEach(_),o=B(A),a=y(A,"DIV",{class:!0});var x=C(a);i=y(x,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(i)!=="svelte-14m38zf"&&(i.textContent=c),u=B(x),d=y(x,"INPUT",{class:!0,id:!0}),x.forEach(_),g=B(A),m=y(A,"DIV",{class:!0});var $=C(m);h=y($,"UL",{class:!0});var Q=C(h);for(let X=0;X<O.length;X+=1)O[X].l(Q);Q.forEach(_),v=B($),S=y($,"UL",{class:!0});var F=C(S);for(let X=0;X<w.length;X+=1)w[X].l(F);F.forEach(_),$.forEach(_),A.forEach(_),L.forEach(_),this.h()},h(){p(l,"class","px-1 rounded hover:bg-gray-100"),p(n,"class","text-base"),p(i,"class","mr-4 font-bold"),p(i,"for","scale-key"),p(d,"class","bg-gray-100 w-16 px-1 rounded"),p(d,"id","scale-key"),d.value=s[0],p(a,"class","flex mb-2 input svelte-4hctsl"),W(a,"hidden",s[3]),p(h,"class","list odd w-full svelte-4hctsl"),p(S,"class","list even w-full svelte-4hctsl"),p(m,"class","body max-h-[30rem] overflow-scroll svelte-4hctsl"),W(m,"hidden",s[3]),p(t,"class","flex flex-col rounded border-2 px-4 pt-2 pb-4 my-4 text-sm svelte-4hctsl"),W(t,"collapsed",s[3]),p(e,"class",k=Te(`${s[9].class||""}`)+" svelte-4hctsl")},m(N,L){M(N,e,L),f(e,t),f(t,n),f(n,l),f(t,o),f(t,a),f(a,i),f(a,u),f(a,d),f(t,g),f(t,m),f(m,h);for(let A=0;A<O.length;A+=1)O[A]&&O[A].m(h,null);f(m,v),f(m,S);for(let A=0;A<w.length;A+=1)w[A]&&w[A].m(S,null);E=!0,P||(T=[Y(l,"click",s[5]),Y(d,"input",s[6])],P=!0)},p(N,[L]){if((!E||L&1&&d.value!==N[0])&&(d.value=N[0]),(!E||L&8)&&W(a,"hidden",N[3]),L&388){R=_e(N[2]);let A;for(A=0;A<R.length;A+=1){const G=rl(N,R,A);O[A]?(O[A].p(G,L),U(O[A],1)):(O[A]=al(G),O[A].c(),U(O[A],1),O[A].m(h,null))}for(Ke(),A=R.length;A<O.length;A+=1)V(A);$e()}if(L&386){I=_e(N[1]);let A;for(A=0;A<I.length;A+=1){const G=ol(N,I,A);w[A]?(w[A].p(G,L),U(w[A],1)):(w[A]=il(G),w[A].c(),U(w[A],1),w[A].m(S,null))}for(Ke(),A=I.length;A<w.length;A+=1)D(A);$e()}(!E||L&8)&&W(m,"hidden",N[3]),(!E||L&8)&&W(t,"collapsed",N[3]),(!E||L&512&&k!==(k=Te(`${N[9].class||""}`)+" svelte-4hctsl"))&&p(e,"class",k)},i(N){if(!E){for(let L=0;L<R.length;L+=1)U(O[L]);for(let L=0;L<I.length;L+=1)U(w[L]);E=!0}},o(N){O=O.filter(Boolean);for(let L=0;L<O.length;L+=1)z(O[L]);w=w.filter(Boolean);for(let L=0;L<w.length;L+=1)z(w[L]);E=!1},d(N){N&&_(e),Oe(O,N),Oe(w,N),P=!1,Ye(T)}}}function Fr(s,e,t){let n,l,r,o,a,i,c;be(s,Mt,w=>t(17,r=w)),be(s,vt,w=>t(18,o=w)),be(s,nt,w=>t(19,a=w)),be(s,st,w=>t(20,i=w));let d=bs().map(w=>({key:w.names[0],raw:w,scale:void 0,triads:w.triads,triadChords:[]})),g="",m=[o.key,o.scale],h;const v=bt(Ve(!0),{key:"scales-hidden"});be(s,v,w=>t(3,c=w));function S(){v.update(w=>!w)}function k({currentTarget:{value:w}}){t(0,g=`${w.charAt(0).toUpperCase()}${w.charAt(1).toLowerCase()}`),t(10,d=d.map(D=>{const N=Ht(g,D.key),L=g&&"data"in N?N.data:void 0;let A=[];return L&&(A=D.triads.map((G,x)=>`${L.scaleNotes[x].note}${!G.suffix.includes("°")&&G.minor?"m":""}${G.suffix}`)),{...D,scale:L,triadChords:A}}))}function E(w,D,N){if(w<D.length){const L=D[w++];Se.setPlayed(L),i==null||i.playChord(L.map(A=>A.midi),a.fixedVelocity),h=setTimeout(()=>E(w,D,N),N)}else Se.setPlayed([]),Se.setKeyAndScale(m[0],m[1])}function P(w){clearTimeout(h);let D,N;w.scale?(N=w.scale,m=[o.key,o.scale],Se.setKeyAndScale(w.scale.key,w.scale.scale)):N=o;const L=r[0].midi+N.scaleNotes[0].semitones;D=w.raw.intervals.map(A=>[{...N.notesMap.get(A.semitones%12),midi:L+A.semitones}]),D[0][0].semitones!==D[D.length-1][0].semitones&&D.push(D[0].map(A=>({...A,midi:A.midi+12}))),E(0,D,500)}function T(w){clearTimeout(h);const{intervals:D}=w.raw;let N,L;w.scale?(L=w.scale,m=[o.key,o.scale],Se.setKeyAndScale(w.scale.key,w.scale.scale)):L=o;const A=r[0].midi+L.scaleNotes[0].semitones;N=wl(w.triads).map((x,$)=>is(A+L.intervals[$].semitones,L,x.intervals)),D[D.length-1].interval_seq!==1&&N.push(N[0].map(x=>({...x,midi:x.midi+12}))),E(0,N,750)}const R=w=>P(w),O=w=>T(w),V=w=>P(w),I=w=>T(w);return s.$$set=w=>{t(9,e=Ae(Ae({},e),Ne(w)))},s.$$.update=()=>{s.$$.dirty&1024&&t(2,n=d.filter((w,D)=>D<d.length/2)),s.$$.dirty&1024&&t(1,l=d.filter((w,D)=>D>=d.length/2))},e=Ne(e),[g,l,n,c,v,S,k,P,T,e,d,R,O,V,I]}class Hr extends Fe{constructor(e){super(),He(this,e,Fr,$r,ze,{})}}function cl(s,e,t){const n=s.slice();return n[26]=e[t],n}function ul(s,e,t){const n=s.slice();return n[29]=e[t],n}function fl(s){let e,t;return{c(){e=b("div"),t=ee(s[3]),this.h()},l(n){e=y(n,"DIV",{class:!0});var l=C(e);t=te(l,s[3]),l.forEach(_),this.h()},h(){p(e,"class","error svelte-1u7ze7x")},m(n,l){M(n,e,l),f(e,t)},p(n,l){l[0]&8&&ye(t,n[3])},d(n){n&&_(e)}}}function dl(s){let e,t=_e(s[5]),n=[];for(let l=0;l<t.length;l+=1)n[l]=hl(ul(s,t,l));return{c(){e=b("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=y(l,"DIV",{class:!0});var r=C(e);for(let o=0;o<n.length;o+=1)n[o].l(r);r.forEach(_),this.h()},h(){p(e,"class","intervals my-1 svelte-1u7ze7x")},m(l,r){M(l,e,r);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(l,r){if(r[0]&32){t=_e(l[5]);let o;for(o=0;o<t.length;o+=1){const a=ul(l,t,o);n[o]?n[o].p(a,r):(n[o]=hl(a),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function hl(s){let e,t=s[29].interval+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var r=C(e);n=te(r,t),r.forEach(_),this.h()},h(){p(e,"class","svelte-1u7ze7x")},m(l,r){M(l,e,r),f(e,n)},p(l,r){r[0]&32&&t!==(t=l[29].interval+"")&&ye(n,t)},d(l){l&&_(e)}}}function ml(s){let e,t=_e(s[8].scaleNotes),n=[];for(let l=0;l<t.length;l+=1)n[l]=_l(cl(s,t,l));return{c(){e=b("div");for(let l=0;l<n.length;l+=1)n[l].c();this.h()},l(l){e=y(l,"DIV",{class:!0});var r=C(e);for(let o=0;o<n.length;o+=1)n[o].l(r);r.forEach(_),this.h()},h(){p(e,"class","intervals my-1 svelte-1u7ze7x")},m(l,r){M(l,e,r);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(l,r){if(r[0]&256){t=_e(l[8].scaleNotes);let o;for(o=0;o<t.length;o+=1){const a=cl(l,t,o);n[o]?n[o].p(a,r):(n[o]=_l(a),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(l){l&&_(e),Oe(n,l)}}}function _l(s){let e,t=s[26].note+"",n;return{c(){e=b("span"),n=ee(t),this.h()},l(l){e=y(l,"SPAN",{class:!0});var r=C(e);n=te(r,t),r.forEach(_),this.h()},h(){p(e,"class","svelte-1u7ze7x")},m(l,r){M(l,e,r),f(e,n)},p(l,r){r[0]&256&&t!==(t=l[26].note+"")&&ye(n,t)},d(l){l&&_(e)}}}function zr(s){let e,t,n,l="Score",r,o,a,i,c,u,d,g="Range",m,h,v,S,k,E="—",P,T,R,O,V,I,w,D="Scale",N,L,A,G,x,$,Q,F="Key",X,Z,K,J,H,me,pe,Re;a=new Me({props:{icon:Wt,width:16}});let ie=s[3]&&fl(s);A=new vl({props:{class:"p-1 pl-[2px] w-48",containerClass:"w-48",selected:s[0],options:s[10],onSelect:s[14]}});let ce=!s[7]&&dl(s),le=!s[7]&&ml(s);return{c(){e=b("fieldset"),t=b("legend"),n=b("button"),n.textContent=l,r=j(),o=b("button"),ue(a.$$.fragment),i=j(),c=b("div"),u=b("div"),d=b("label"),d.textContent=g,m=j(),h=b("div"),v=b("input"),S=j(),k=b("span"),k.textContent=E,P=j(),T=b("input"),R=j(),O=b("div"),ie&&ie.c(),V=j(),I=b("div"),w=b("label"),w.textContent=D,N=j(),L=b("div"),ue(A.$$.fragment),G=j(),ce&&ce.c(),x=j(),$=b("div"),Q=b("label"),Q.textContent=F,X=j(),Z=b("div"),K=b("input"),J=j(),le&&le.c(),this.h()},l(re){e=y(re,"FIELDSET",{class:!0});var ge=C(e);t=y(ge,"LEGEND",{class:!0});var we=C(t);n=y(we,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(n)!=="svelte-lqyol"&&(n.textContent=l),we.forEach(_),r=B(ge),o=y(ge,"BUTTON",{class:!0});var tt=C(o);fe(a.$$.fragment,tt),tt.forEach(_),i=B(ge),c=y(ge,"DIV",{class:!0});var q=C(c);u=y(q,"DIV",{class:!0});var oe=C(u);d=y(oe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(d)!=="svelte-10u0679"&&(d.textContent=g),m=B(oe),h=y(oe,"DIV",{class:!0});var Ee=C(h);v=y(Ee,"INPUT",{class:!0,id:!0}),S=B(Ee),k=y(Ee,"SPAN",{class:!0,"data-svelte-h":!0}),ae(k)!=="svelte-8q1xz4"&&(k.textContent=E),P=B(Ee),T=y(Ee,"INPUT",{class:!0,id:!0}),Ee.forEach(_),R=B(oe),O=y(oe,"DIV",{class:!0});var Ue=C(O);ie&&ie.l(Ue),Ue.forEach(_),oe.forEach(_),V=B(q),I=y(q,"DIV",{class:!0});var ne=C(I);w=y(ne,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(w)!=="svelte-ld2d07"&&(w.textContent=D),N=B(ne),L=y(ne,"DIV",{class:!0});var qe=C(L);fe(A.$$.fragment,qe),qe.forEach(_),G=B(ne),ce&&ce.l(ne),ne.forEach(_),x=B(q),$=y(q,"DIV",{class:!0});var je=C($);Q=y(je,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),ae(Q)!=="svelte-17pcm6g"&&(Q.textContent=F),X=B(je),Z=y(je,"DIV",{class:!0});var ut=C(Z);K=y(ut,"INPUT",{class:!0,id:!0}),ut.forEach(_),J=B(je),le&&le.l(je),je.forEach(_),q.forEach(_),ge.forEach(_),this.h()},h(){p(n,"class","px-1 rounded hover:bg-gray-100"),p(t,"class","text-base"),p(o,"class","absolute top-[-0.25rem] right-[0.5rem] flex items-center justify-center rounded px-1 py-1 hover:bg-gray-200"),W(o,"hidden",s[6]),p(d,"class","font-bold"),p(d,"for","range_min"),p(v,"class","h-[28px] w-full"),p(v,"id","range_min"),p(k,"class","mx-2 mt-1"),p(T,"class","h-[28px] w-full"),p(T,"id","range_max"),p(h,"class","my-1 flex w-full"),p(O,"class","flex justify-between my-1"),p(u,"class","flex flex-col h-full"),p(w,"class","font-bold"),p(w,"for","scales"),p(L,"class","my-1 w-full"),p(I,"class","flex flex-col h-full"),p(Q,"class","font-bold"),p(Q,"for","key"),p(K,"class","h-[28px]"),p(K,"id","key"),p(Z,"class","my-1 flex"),p($,"class","flex flex-col h-full"),p(c,"class","options svelte-1u7ze7x"),W(c,"hidden",s[6]),p(e,"class",H=Te(`${s[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"),W(e,"collapsed",s[6])},m(re,ge){M(re,e,ge),f(e,t),f(t,n),f(e,r),f(e,o),de(a,o,null),f(e,i),f(e,c),f(c,u),f(u,d),f(u,m),f(u,h),f(h,v),Ze(v,s[1]),f(h,S),f(h,k),f(h,P),f(h,T),Ze(T,s[2]),f(u,R),f(u,O),ie&&ie.m(O,null),f(c,V),f(c,I),f(I,w),f(I,N),f(I,L),de(A,L,null),f(I,G),ce&&ce.m(I,null),f(c,x),f(c,$),f($,Q),f($,X),f($,Z),f(Z,K),Ze(K,s[4]),f($,J),le&&le.m($,null),me=!0,pe||(Re=[Y(n,"click",s[15]),Y(o,"click",s[16]),Y(v,"input",s[18]),Y(v,"change",s[19]),Y(v,"focus",s[12]),Y(T,"input",s[20]),Y(T,"change",s[21]),Y(T,"focus",s[12]),Y(K,"input",s[22]),Y(K,"input",s[13])],pe=!0)},p(re,ge){(!me||ge[0]&64)&&W(o,"hidden",re[6]),ge[0]&2&&v.value!==re[1]&&Ze(v,re[1]),ge[0]&4&&T.value!==re[2]&&Ze(T,re[2]),re[3]?ie?ie.p(re,ge):(ie=fl(re),ie.c(),ie.m(O,null)):ie&&(ie.d(1),ie=null);const we={};ge[0]&1&&(we.selected=re[0]),A.$set(we),re[7]?ce&&(ce.d(1),ce=null):ce?ce.p(re,ge):(ce=dl(re),ce.c(),ce.m(I,null)),ge[0]&16&&K.value!==re[4]&&Ze(K,re[4]),re[7]?le&&(le.d(1),le=null):le?le.p(re,ge):(le=ml(re),le.c(),le.m($,null)),(!me||ge[0]&64)&&W(c,"hidden",re[6]),(!me||ge[0]&131072&&H!==(H=Te(`${re[17].class||""} flex flex-col rounded border-2 px-4 py-2 w-[224px] relative text-sm`)+" svelte-1u7ze7x"))&&p(e,"class",H),(!me||ge[0]&131136)&&W(e,"collapsed",re[6])},i(re){me||(U(a.$$.fragment,re),U(A.$$.fragment,re),me=!0)},o(re){z(a.$$.fragment,re),z(A.$$.fragment,re),me=!1},d(re){re&&_(e),he(a),ie&&ie.d(),he(A),ce&&ce.d(),le&&le.d(),pe=!1,Ye(Re)}}}function qr(s,e,t){let n,l,r,o,a,i;be(s,Mt,L=>t(23,l=L)),be(s,At,L=>t(24,r=L)),be(s,It,L=>t(7,a=L)),be(s,vt,L=>t(8,i=L));let c=mt(l[0]),u=mt(l[1]),d="";const g=bt(Ve(!1),{key:"score-options-hidden"});be(s,g,L=>t(6,o=L));let m=r[0],h=r[1];const v=bs(),S=v.map(L=>({key:L.names[0],value:L.names[0]}));Mt.subscribe(L=>{t(1,c=mt(L[0])),t(2,u=mt(L[1]))}),At.subscribe(L=>{t(4,m=L[0]),t(0,h=L[1])});function k(L,A){const G=lo(A.currentTarget.value,!0,!0);if("data"in G){const{midi:x}=G.data,$=l,Q=[L==="min"?x:$[0].midi,L==="max"?x:$[1].midi];Pe.setMidiRange(Q),t(3,d="")}else t(3,d=G.err),L==="min"?t(1,c=mt(l[0])):t(2,u=mt(l[1]))}function E(){t(3,d="")}function P({currentTarget:{value:L}}){t(4,m=`${L.charAt(0).toUpperCase()}${L.charAt(1).toLowerCase()}`),Se.setKey(m)}function T(L){var A;return t(0,h=(A=S.find(G=>L===G.key))==null?void 0:A.value),Se.setScale(h),!1}function R(){g.update(L=>!L)}function O(){Se.clearScore(!0),Pe.setMidiRange([60,84])}function V(){c=this.value,t(1,c)}const I=L=>k("min",L);function w(){u=this.value,t(2,u)}const D=L=>k("max",L);function N(){m=this.value,t(4,m)}return s.$$set=L=>{t(17,e=Ae(Ae({},e),Ne(L)))},s.$$.update=()=>{var L;s.$$.dirty[0]&1&&t(5,n=((L=v.find(A=>A.names[0]===h))==null?void 0:L.intervals)||[])},e=Ne(e),[h,c,u,d,m,n,o,a,i,g,S,k,E,P,T,R,O,e,V,I,w,D,N]}class Wr extends Fe{constructor(e){super(),He(this,e,qr,zr,ze,{},null,[-1,-1])}}function Jr(s){s[21]=s[22].default}function Yr(s){return{c:ve,l:ve,m:ve,i:ve,o:ve,d:ve}}function Qr(s){Jr(s);let e,t,n;var l=s[21];function r(o,a){return{props:{class:"mx-4 md:mx-0"}}}return l&&(e=Gl(l,r())),{c(){e&&ue(e.$$.fragment),t=Le()},l(o){e&&fe(e.$$.fragment,o),t=Le()},m(o,a){e&&de(e,o,a),M(o,t,a),n=!0},i(o){n||(e&&U(e.$$.fragment,o),n=!0)},o(o){e&&z(e.$$.fragment,o),n=!1},d(o){o&&_(t),e&&he(e,o)}}}function Xr(s){let e;return{c(){e=ee(" ")},l(t){e=te(t," ")},m(t,n){M(t,e,n)},i:ve,o:ve,d(t){t&&_(e)}}}function Zr(s){let e,t,n="MIDI Note Trainer",l,r,o,a,i,c,u,d="Introduction",g,m,h,v,S,k,E,P,T,R,O,V,I,w,D,N,L,A,G,x,$;a=new Me({props:{icon:Wt,width:24}}),h=new kr({}),S=new Hr({}),E=new So({}),R=new Wr({props:{class:"score-options mr-4"}}),V=new Pr({props:{class:"play-form"}});let Q={ctx:s,current:null,token:null,hasCatch:!1,pending:Xr,then:Qr,catch:Yr,value:22,blocks:[,,,]};return Bl(Ie(()=>import("./Score.13b899c6.js"),["./Score.13b899c6.js","./vendor_svelte.7bc09af0.js","./vendor.e9b0235c.js","./vendor_vexflow.2dfca40b.js","../assets/Score.04e240b8.css"],import.meta.url),Q),N=new Nr({props:{class:"min-h-32",debounced:!!s[0]}}),N.$on("guessed-chord",s[2]),N.$on("guessed-key",s[3]),N.$on("guessed-note",s[4]),A=new Ko({props:{game:s[1]}}),{c(){e=b("h1"),t=b("a"),t.textContent=n,l=j(),r=b("div"),o=b("button"),ue(a.$$.fragment),i=j(),c=b("div"),u=b("button"),u.textContent=d,g=j(),m=b("section"),ue(h.$$.fragment),v=j(),ue(S.$$.fragment),k=j(),ue(E.$$.fragment),P=j(),T=b("div"),ue(R.$$.fragment),O=j(),ue(V.$$.fragment),I=j(),Q.block.c(),w=j(),D=b("section"),ue(N.$$.fragment),L=j(),ue(A.$$.fragment),this.h()},l(F){e=y(F,"H1",{class:!0});var X=C(e);t=y(X,"A",{class:!0,href:!0,"data-svelte-h":!0}),ae(t)!=="svelte-km4jns"&&(t.textContent=n),l=B(X),r=y(X,"DIV",{class:!0});var Z=C(r);o=y(Z,"BUTTON",{class:!0});var K=C(o);fe(a.$$.fragment,K),K.forEach(_),Z.forEach(_),X.forEach(_),i=B(F),c=y(F,"DIV",{class:!0});var J=C(c);u=y(J,"BUTTON",{class:!0,"data-svelte-h":!0}),ae(u)!=="svelte-f34gar"&&(u.textContent=d),J.forEach(_),g=B(F),m=y(F,"SECTION",{class:!0});var H=C(m);fe(h.$$.fragment,H),v=B(H),fe(S.$$.fragment,H),k=B(H),fe(E.$$.fragment,H),P=B(H),T=y(H,"DIV",{class:!0});var me=C(T);fe(R.$$.fragment,me),O=B(me),fe(V.$$.fragment,me),me.forEach(_),H.forEach(_),I=B(F),Q.block.l(F),w=B(F),D=y(F,"SECTION",{class:!0});var pe=C(D);fe(N.$$.fragment,pe),L=B(pe),fe(A.$$.fragment,pe),pe.forEach(_),this.h()},h(){p(t,"class","hover:underline"),p(t,"href","https://github.com/TeemuKoivisto/midi-note-trainer"),p(o,"class","rounded p-2 hover:bg-gray-200"),p(r,"class","flex items-center justify-center"),p(e,"class","my-8 md:text-5xl mt-12 px-4 md:px-0 text-3xl font-cursive tracking-tight flex items-center justify-between"),p(u,"class","btn-pill border-2 border-gray-300 hover:bg-gray-200"),p(c,"class","px-4 md:px-0"),p(T,"class","play svelte-qjpqy3"),p(m,"class","mx-4 md:mx-0"),p(D,"class","mb-8 ml-16 flex flex-col")},m(F,X){M(F,e,X),f(e,t),f(e,l),f(e,r),f(r,o),de(a,o,null),M(F,i,X),M(F,c,X),f(c,u),M(F,g,X),M(F,m,X),de(h,m,null),f(m,v),de(S,m,null),f(m,k),de(E,m,null),f(m,P),f(m,T),de(R,T,null),f(T,O),de(V,T,null),M(F,I,X),Q.block.m(F,Q.anchor=X),Q.mount=()=>w.parentNode,Q.anchor=w,M(F,w,X),M(F,D,X),de(N,D,null),f(D,L),de(A,D,null),G=!0,x||($=[Y(o,"click",s[5]),Y(u,"click",s[6])],x=!0)},p(F,[X]){s=F;const Z={};X&1&&(Z.debounced=!!s[0]),N.$set(Z);const K={};X&2&&(K.game=s[1]),A.$set(K)},i(F){G||(U(a.$$.fragment,F),U(h.$$.fragment,F),U(S.$$.fragment,F),U(E.$$.fragment,F),U(R.$$.fragment,F),U(V.$$.fragment,F),U(Q.block),U(N.$$.fragment,F),U(A.$$.fragment,F),G=!0)},o(F){z(a.$$.fragment,F),z(h.$$.fragment,F),z(S.$$.fragment,F),z(E.$$.fragment,F),z(R.$$.fragment,F),z(V.$$.fragment,F);for(let X=0;X<3;X+=1){const Z=Q.blocks[X];z(Z)}z(N.$$.fragment,F),z(A.$$.fragment,F),G=!1},d(F){F&&(_(e),_(i),_(c),_(g),_(m),_(I),_(w),_(D)),he(a),he(h),he(S),he(E),he(R),he(V),Q.block.d(F),Q.token=null,Q=null,he(N),he(A),x=!1,Ye($)}}}function ea(s,e,t){let n,l,r,o,a,i;be(s,_t,V=>t(9,n=V)),be(s,It,V=>t(1,l=V)),be(s,gt,V=>t(10,r=V)),be(s,nt,V=>t(11,o=V)),be(s,st,V=>t(12,a=V)),be(s,Ls,V=>t(13,i=V));let c,u;gl(()=>(i&&T(),window.addEventListener("keydown",d),window.addEventListener("mousedown",d),window.addEventListener("touchstart",d),()=>{window.removeEventListener("keydown",d),window.removeEventListener("mousedown",d),window.removeEventListener("touchstart",d)})),gs.subscribe(V=>{V&&V.channels[1].addListener("noteon",g)});function d(){Pe.initAudio(),window.removeEventListener("keydown",d),window.removeEventListener("mousedown",d),window.removeEventListener("touchstart",d)}function g(V){if(c)return;const I=V.rawData;m(I[1],I[2])}function m(V,I){const w=l;w instanceof Pt&&!(w!=null&&w.ended)&&n==="waiting"?S(V):w instanceof pt&&!(w!=null&&w.ended)&&n==="waiting"?(w.addPlayedNote(V),u||(u=setTimeout(v,2e3))):w||Se.pushPlayed(V),a&&a.noteOn(V,o.fixedVelocity??I)}function h(){r.autoplay&&r.waitSeconds>0?t(0,c=setTimeout(()=>{r.autoplay&&De.nextGuess(),t(0,c=void 0)},r.waitSeconds*1e3)):r.autoplay?De.nextGuess():t(0,c=void 0)}function v(){var I;const V=l;if(V instanceof pt){const w=V.guess();Se.setPlayed(((I=V.latestGuess.guessed)==null?void 0:I.notes)||[],w,-1),De.updateState(w?"correct":"wrong"),h()}u=void 0}function S(V){const I=l;if(I instanceof Pt&&n==="waiting"){Se.setTarget([Se.getNote(I.current)]);const w=I.guess(V);De.updateState(w?"correct":"wrong"),Se.pushPlayed(V,w,4e3),h()}}function k(V){const I=l;if(I instanceof pt&&n==="waiting"){const w=I.guessWrittenChord(V.detail);De.updateState(w?"correct":"wrong"),h()}}function E(V){const I=l;if(I instanceof zt&&n==="waiting"){const w=V.detail.replaceAll("♭","b").replaceAll("♯","#"),D=I.guess(w);De.updateState(D?"correct":"wrong"),h()}}function P(V){const I=ct.findNote(V.detail.note)??Rs(V.detail.note);I&&m(I.semitones+12+V.detail.octave*12,80)}async function T(){const V=await Pe.openMidi();"data"in V?V.data.name:(V.err,console.error(V.err))}function R(){uo(),window.location.reload()}return[c,l,k,E,P,R,()=>xl.open("introduction",void 0)]}class oa extends Fe{constructor(e){super(),He(this,e,ea,Zr,ze,{})}}export{nn as F,pt as G,oa as P,Jl as S,Pt as a,De as b,It as c,wt as d,ps as e,_t as g,st as p,vt as s,an as t};
